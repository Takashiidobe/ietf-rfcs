  RFC 8755   CNSA Suite for S/MIME   March 2020
  ---------- ----------------------- ------------
  Jenkins    Informational           \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [8755](https://www.rfc-editor.org/rfc/rfc8755){.eref}

Category:
:   Informational

Published:
:   March 2020

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    M. Jenkins
    :::

    ::: org
    NSA
    :::
    :::
:::

# RFC 8755 {#rfcnum}

# Using Commercial National Security Algorithm Suite Algorithms in Secure/⁠Multipurpose Internet Mail Extensions {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The United States Government has published the National Security Agency
(NSA) Commercial National Security Algorithm (CNSA) Suite, which defines
cryptographic algorithm policy for national security applications. This
document specifies the conventions for using the United States National
Security Agency\'s CNSA Suite algorithms in Secure/Multipurpose Internet
Mail Extensions (S/MIME) as specified in RFC 8551. It applies to the
capabilities, configuration, and operation of all components of US
National Security Systems that employ S/MIME messaging. US National
Security Systems are described in NIST Special Publication 800-59. It is
also appropriate for all other US Government systems that process
high-value information. It is made publicly available for use by
developers and operators of these and any other system
deployments.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8755>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [The Commercial National Security Algorithm
    Suite](#name-the-commercial-national-sec){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Requirements and
    Assumptions](#name-requirements-and-assumption){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [SHA-384 Message Digest
    Algorithm](#name-sha-384-message-digest-algo){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Digital
    Signature](#name-digital-signature){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [ECDSA
        Signature](#name-ecdsa-signature){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [RSA
        Signature](#name-rsa-signature){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Key
    Establishment](#name-key-establishment){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Elliptic Curve Key
        Agreement](#name-elliptic-curve-key-agreemen){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [RSA Key
        Transport](#name-rsa-key-transport){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Content
    Encryption](#name-content-encryption){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [AES-GCM Content
        Encryption](#name-aes-gcm-content-encryption){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [AES-CBC Content
        Encryption](#name-aes-cbc-content-encryption){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [](#section-appendix.a){.xref}[Author\'s
    Address](#name-authors-address){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document specifies the conventions for using the United States
National Security Agency\'s Commercial National Security Algorithm
(CNSA) Suite algorithms \[[CNSA](#CNSA){.xref}\] in Secure/Multipurpose
Internet Mail Extensions (S/MIME) \[[RFC8551](#RFC8551){.xref}\]. It
applies to the capabilities, configuration, and operation of all
components of US National Security Systems that employ S/MIME messaging.
US National Security Systems are described in NIST Special Publication
800-59 \[[SP80059](#SP80059){.xref}\]. It is also appropriate for all
other US Government systems that process high-value information. It is
made publicly available for use by developers and operators of these and
any other system deployments.[¶](#section-1-1){.pilcrow}

S/MIME makes use of the Cryptographic Message Syntax (CMS)
\[[RFC5652](#RFC5652){.xref}\] \[[RFC5083](#RFC5083){.xref}\]. In
particular, the signed-data, enveloped-data, and
authenticated-enveloped-data content types are used. This document only
addresses CNSA Suite compliance for S/MIME. Other applications of CMS
are outside the scope of this document.[¶](#section-1-2){.pilcrow}

This document does not define any new cryptographic algorithm suites;
instead, it defines a CNSA-compliant profile of S/MIME. Since many of
the CNSA Suite algorithms enjoy uses in other environments as well, the
majority of the conventions needed for these algorithms are already
specified in other documents. This document references the source of
these conventions, with some relevant details repeated to aid developers
that choose to support the CNSA Suite. Where details have been repeated,
the cited documents are authoritative.[¶](#section-1-3){.pilcrow}

::: {#terminology}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}
:::
:::
:::
:::

::: {#cnsa}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [The Commercial National Security Algorithm Suite](#name-the-commercial-national-sec){.section-name .selfRef} {#name-the-commercial-national-sec}

The National Security Agency (NSA) profiles commercial cryptographic
algorithms and protocols as part of its mission to support secure,
interoperable communications for US Government National Security
Systems. To this end, it publishes guidance both to assist with the US
Government transition to new algorithms and to provide vendors \-- and
the Internet community in general \-- with information concerning their
proper use and configuration.[¶](#section-2-1){.pilcrow}

Recently, cryptographic transition plans have become overshadowed by the
prospect of the development of a cryptographically relevant quantum
computer. The NSA has established the Commercial National Security
Algorithm (CNSA) Suite to provide vendors and IT users near-term
flexibility in meeting their cybersecurity interoperability
requirements. The purpose behind this flexibility is to avoid having
vendors and customers make two major transitions in a relatively short
timeframe, as we anticipate a need to shift to quantum-resistant
cryptography in the near future.[¶](#section-2-2){.pilcrow}

The NSA is authoring a set of RFCs, including this one, to provide
updated guidance concerning the use of certain commonly available
commercial algorithms in IETF protocols. These RFCs can be used in
conjunction with other RFCs and cryptographic guidance (e.g., NIST
Special Publications) to properly protect Internet traffic and
data-at-rest for US Government National Security
Systems.[¶](#section-2-3){.pilcrow}
:::
:::

::: {#reqts}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Requirements and Assumptions](#name-requirements-and-assumption){.section-name .selfRef} {#name-requirements-and-assumption}

CMS values are generated using ASN.1 \[[X208](#X208){.xref}\], the Basic
Encoding Rules (BER) \[[X209](#X209){.xref}\], and the Distinguished
Encoding Rules (DER)
\[[X509](#X509){.xref}\].[¶](#section-3-1){.pilcrow}

The elliptic curve used in the CNSA Suite is specified in
\[[FIPS186](#FIPS186){.xref}\] and appears in the literature under two
different names. For the sake of clarity, we list both names
below:[¶](#section-3-2){.pilcrow}

::: {#curve}
  Curve      NIST Name   SECG Name   OID \[FIPS186\]
  ---------- ----------- ----------- -----------------
  nistp384   P-384       secp384r1   1.3.132.0.34

  : [Table 1](#table-1){.selfRef}
:::

For CNSA Suite applications, public key certificates used to verify
S/MIME signatures [MUST]{.bcp14} be compliant with the CNSA Suite
Certificate and Certificate Revocation List (CRL) profile specified in
\[[RFC8603](#RFC8603){.xref}\].[¶](#section-3-4){.pilcrow}

Within the CMS signed-data content type, signature algorithm identifiers
are located in the signatureAlgorithm field of SignerInfo structures
contained within the SignedData. In addition, signature algorithm
identifiers are located in the SignerInfo signatureAlgorithm field of
countersignature attributes. Specific requirements for digital
signatures are given in [Section 5](#digital-signature){.xref};
compliant implementations [MUST]{.bcp14} consider signatures not meeting
these requirements as invalid.[¶](#section-3-5){.pilcrow}

Implementations based on Elliptic Curve Cryptography (ECC) also require
specification of schemes for key derivation and key wrap. Requirements
for these schemes are in Sections [6.1.1](#kdf){.xref} and
[6.1.2](#keywrap){.xref}, respectively.[¶](#section-3-6){.pilcrow}

RSA key pairs (public, private) are identified by the modulus size
expressed in bits; RSA-3072 and RSA-4096 are computed using moduli of
3072 bits and 4096 bits, respectively.[¶](#section-3-7){.pilcrow}

RSA signature key pairs used in CNSA Suite-compliant implementations are
either RSA-3072 or RSA-4096. The RSA exponent e [MUST]{.bcp14} satisfy
2^16^ \< e \< 2^256^ and be odd per
\[[FIPS186](#FIPS186){.xref}\].[¶](#section-3-8){.pilcrow}

It is recognized that, while the vast majority of RSA signatures are
currently made using the RSASSA-PKCS1-v1_5 algorithm, the preferred RSA
signature scheme for new applications is RSASSA-PSS. CNSA
Suite-compliant X.509 certificates will be issued in accordance with
\[[RFC8603](#RFC8603){.xref}\], and while those certificates must be
signed and validated using RSASSA-PKCS1-v1_5, the subject\'s RSA key
pair can be used to generate and validate signatures appropriate for
either signing scheme. Where use of RSASSA-PSS is indicated in this
document, the parameters in [Section 5.2.2](#rsa-pss){.xref}
apply.[¶](#section-3-9){.pilcrow}

This document assumes that the required trust anchors have been securely
provisioned to the client.[¶](#section-3-10){.pilcrow}

All implementations use SHA-384 for hashing and either AES-CBC or
AES-GCM for encryption, the requirements for which are given in [Section
4](#message-digest){.xref} and [Section 7](#content-enc){.xref},
respectively.[¶](#section-3-11){.pilcrow}
:::
:::

::: {#message-digest}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [SHA-384 Message Digest Algorithm](#name-sha-384-message-digest-algo){.section-name .selfRef} {#name-sha-384-message-digest-algo}

SHA-384 is the sole CNSA Suite message digest algorithm.
\[[RFC5754](#RFC5754){.xref}\] specifies the conventions for using
SHA-384 with the Cryptographic Message Syntax (CMS). CNSA
Suite-compliant S/MIME implementations [MUST]{.bcp14} follow the
conventions in
\[[RFC5754](#RFC5754){.xref}\].[¶](#section-4-1){.pilcrow}

Within the CMS signed-data content type, message digest algorithm
identifiers are located in the SignedData digestAlgorithms field and the
SignerInfo digestAlgorithm field.[¶](#section-4-2){.pilcrow}

The SHA-384 message digest algorithm is defined in FIPS Pub 180
\[[FIPS180](#FIPS180){.xref}\]. The algorithm identifier for SHA-384 is
defined in \[[RFC5754](#RFC5754){.xref}\] as
follows:[¶](#section-4-3){.pilcrow}

::: {#section-4-4}
``` {.sourcecode .lang-asn.1}
      id-sha384  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2)
          country(16) us(840) organization(1) gov(101) csor(3)
          nistalgorithm(4) hashalgs(2) 2 }
```

[¶](#section-4-4){.pilcrow}
:::

For SHA-384, the AlgorithmIdentifier parameters field is
[OPTIONAL]{.bcp14}, and if present, the parameters field [MUST]{.bcp14}
contain a NULL. As specified in \[[RFC5754](#RFC5754){.xref}\],
implementations [MUST]{.bcp14} generate SHA-384 AlgorithmIdentifiers
with absent parameters. Implementations [MUST]{.bcp14} accept SHA-384
AlgorithmIdentifiers with absent parameters or with NULL
parameters.[¶](#section-4-5){.pilcrow}
:::
:::

::: {#digital-signature}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Digital Signature](#name-digital-signature){.section-name .selfRef} {#name-digital-signature}

::: {#ecc-dig-sig}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [ECDSA Signature](#name-ecdsa-signature){.section-name .selfRef} {#name-ecdsa-signature}

The Elliptic Curve Digital Signature Algorithm (ECDSA) is the CNSA Suite
digital signature algorithm based on ECC. \[[RFC5753](#RFC5753){.xref}\]
specifies the conventions for using ECDSA with the Cryptographic Message
Syntax (CMS). CNSA Suite-compliant S/MIME implementations [MUST]{.bcp14}
follow the conventions in
\[[RFC5753](#RFC5753){.xref}\].[¶](#section-5.1-1){.pilcrow}

\[[RFC5480](#RFC5480){.xref}\] defines the signature algorithm
identifier used in CMS for ECDSA with SHA-384 as
follows:[¶](#section-5.1-2){.pilcrow}

::: {#section-5.1-3}
``` {.sourcecode .lang-asn.1}
      ecdsa-with-SHA384  OBJECT IDENTIFIER  ::=  { iso(1)
         member-body(2) us(840) ansi-X9-62(10045) signatures(4)
         ecdsa-with-sha2(3) 3 }
```

[¶](#section-5.1-3){.pilcrow}
:::

When the ecdsa-with-SHA384 algorithm identifier is used, the
AlgorithmIdentifier parameters field [MUST]{.bcp14} be
absent.[¶](#section-5.1-4){.pilcrow}

When signing, the ECDSA algorithm generates two values, commonly called
r and s. These two values [MUST]{.bcp14} be encoded using the
ECDSA-Sig-Value type specified in
\[[RFC5480](#RFC5480){.xref}\]:[¶](#section-5.1-5){.pilcrow}

::: {#section-5.1-6}
``` {.sourcecode .lang-asn.1}
      ECDSA-Sig-Value  ::=  SEQUENCE {
         r  INTEGER,
         s  INTEGER }
```

[¶](#section-5.1-6){.pilcrow}
:::
:::
:::

::: {#rsa-dig-sig}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [RSA Signature](#name-rsa-signature){.section-name .selfRef} {#name-rsa-signature}

The RSA signature generation process and the encoding of the result is
either RSASSA-PKCS1-v1_5 or RSA-PSS, as described in detail in PKCS #1
version 2.2 \[[RFC8017](#RFC8017){.xref}\].[¶](#section-5.2-1){.pilcrow}

::: {#rsa-pkcs1}
::: {#section-5.2.1 .section}
#### [5.2.1.](#section-5.2.1){.section-number .selfRef} [RSA-PKCS1-v1_5](#name-rsa-pkcs1-v1_5){.section-name .selfRef} {#name-rsa-pkcs1-v1_5}

\[[RFC5754](#RFC5754){.xref}\] defines the signature algorithm
identifier used in CMS for an RSA signature with SHA-384 as
follows:[¶](#section-5.2.1-1){.pilcrow}

::: {#section-5.2.1-2}
``` {.sourcecode .lang-asn.1}
      sha384WithRSAEncryption  OBJECT IDENTIFIER  ::= { iso(1)
        member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-1(1) 12 }
```

[¶](#section-5.2.1-2){.pilcrow}
:::

When the sha384WithRSAEncryption algorithm identifier is used, the
parameters [MUST]{.bcp14} be NULL. Implementations [MUST]{.bcp14} accept
the parameters being absent as well as
present.[¶](#section-5.2.1-3){.pilcrow}
:::
:::

::: {#rsa-pss}
::: {#section-5.2.2 .section}
#### [5.2.2.](#section-5.2.2){.section-number .selfRef} [RSA-PSS](#name-rsa-pss){.section-name .selfRef} {#name-rsa-pss}

\[[RFC4056](#RFC4056){.xref}\] defines the signature algorithm
identifier used in CMS for an RSA-PSS signature as follows (presented
here in expanded form):[¶](#section-5.2.2-1){.pilcrow}

::: {#section-5.2.2-2}
``` {.sourcecode .lang-asn.1}
      RSASSA-PSS  OBJECT IDENTIFIER  ::= { iso(1)
        member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-1(1) 10 }
```

[¶](#section-5.2.2-2){.pilcrow}
:::

The parameters field of an AlgorithmIdentifier that identifies
RSASSA-PSS is defined in \[[RFC4055](#RFC4055){.xref}\] as
follows:[¶](#section-5.2.2-3){.pilcrow}

::: {#section-5.2.2-4}
``` {.sourcecode .lang-asn.1}
       RSASSA-PSS-params  ::=  SEQUENCE  {
          hashAlgorithm      [0] HashAlgorithm DEFAULT
                                    sha1Identifier,
          maskGenAlgorithm   [1] MaskGenAlgorithm DEFAULT
                                    mgf1SHA1Identifier,
          saltLength         [2] INTEGER DEFAULT 20,
          trailerField       [3] INTEGER DEFAULT 1  }
```

[¶](#section-5.2.2-4){.pilcrow}
:::

The AlgorithmIdentifier parameters field [MUST]{.bcp14} contain
RSASSA-PSS-params with the following
values:[¶](#section-5.2.2-5){.pilcrow}

-   [The hash algorithm [MUST]{.bcp14} be id-sha384 as defined in
    \[[RFC8017](#RFC8017){.xref}\];[¶](#section-5.2.2-6.1){.pilcrow}]{#section-5.2.2-6.1}
-   [The mask generation function [MUST]{.bcp14} use the algorithm
    identifier mfg1SHA384Identifier as defined in
    \[[RFC4055](#RFC4055){.xref}\];[¶](#section-5.2.2-6.2){.pilcrow}]{#section-5.2.2-6.2}
-   [The salt length [MUST]{.bcp14} be 48 octets (the same length as the
    SHA-384 output);
    and[¶](#section-5.2.2-6.3){.pilcrow}]{#section-5.2.2-6.3}
-   [The trailerField [MUST]{.bcp14} have value
    1.[¶](#section-5.2.2-6.4){.pilcrow}]{#section-5.2.2-6.4}
:::
:::
:::
:::
:::
:::

::: {#key-establishment}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Key Establishment](#name-key-establishment){.section-name .selfRef} {#name-key-establishment}

::: {#ecc-ka}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Elliptic Curve Key Agreement](#name-elliptic-curve-key-agreemen){.section-name .selfRef} {#name-elliptic-curve-key-agreemen}

Elliptic Curve Diffie-Hellman (ECDH) is the CNSA Suite key agreement
algorithm. Since S/MIME is used in store-and-forward communications,
ephemeral-static ECDH is always employed. This means that the message
originator possesses an ephemeral ECDH key pair and that the message
recipient possesses a static ECDH key pair whose public key is provided
in an X.509 certificate. The certificate used to obtain the recipient\'s
public key [MUST]{.bcp14} be compliant with
\[[RFC8603](#RFC8603){.xref}\].[¶](#section-6.1-1){.pilcrow}

When a key agreement algorithm is used, the following steps are
performed:[¶](#section-6.1-2){.pilcrow}

1.  [A content-encryption key (CEK) for a particular content-encryption
    algorithm is generated at
    random.[¶](#section-6.1-3.1){.pilcrow}]{#section-6.1-3.1}
2.  [The recipient\'s public key and sender\'s private key are used with
    a key agreement scheme to generate a shared secret
    (Z).[¶](#section-6.1-3.2){.pilcrow}]{#section-6.1-3.2}
3.  [The shared secret is used with a key derivation function (KDF) to
    produce a key-encryption key
    (KEK).[¶](#section-6.1-3.3){.pilcrow}]{#section-6.1-3.3}
4.  [The KEK is used with a key wrap algorithm to encrypt the
    CEK.[¶](#section-6.1-3.4){.pilcrow}]{#section-6.1-3.4}

Key derivation is discussed in [Section 6.1.1](#kdf){.xref}. Key
wrapping is discussed in [Section
6.1.2](#keywrap){.xref}.[¶](#section-6.1-4){.pilcrow}

[Section
3.1](https://www.rfc-editor.org/rfc/rfc5753#section-3.1){.relref} of
\[[RFC5753](#RFC5753){.xref}\] specifies the conventions for using ECDH
with the CMS. CNSA Suite-compliant S/MIME implementations [MUST]{.bcp14}
follow these conventions.[¶](#section-6.1-5){.pilcrow}

Within the CMS enveloped-data and authenticated-enveloped-data content
types, key agreement algorithm identifiers are located in the
EnvelopedData RecipientInfos KeyAgreeRecipientInfo
keyEncryptionAlgorithm field.[¶](#section-6.1-6){.pilcrow}

The keyEncryptionAlgorithm field comprises two fields, an algorithm
field and a parameter field. The algorithm field [MUST]{.bcp14} identify
dhSinglePass-stdDH-sha384kdf-scheme. The algorithm identifier for the
dhSinglePass-stdDH-sha384kdf-scheme, repeated from [Section
7.1.4](https://www.rfc-editor.org/rfc/rfc5753#section-7.1.4){.relref} of
\[[RFC5753](#RFC5753){.xref}\], is (presented here in expanded
form):[¶](#section-6.1-7){.pilcrow}

::: {#section-6.1-8}
``` {.sourcecode .lang-asn.1}
      dhSinglePass-stdDH-sha384kdf-scheme  OBJECT IDENTIFIER  ::=
          { iso(1) identified-organization(3) certicom(132)
            schemes(1) 11 2 }
```

[¶](#section-6.1-8){.pilcrow}
:::

The keyEncryptionAlgorithm parameter field [MUST]{.bcp14} be constructed
as described in [Section
6.1.2](#keywrap){.xref}.[¶](#section-6.1-9){.pilcrow}

::: {#kdf}
::: {#section-6.1.1 .section}
#### [6.1.1.](#section-6.1.1){.section-number .selfRef} [Key Derivation Functions](#name-key-derivation-functions){.section-name .selfRef} {#name-key-derivation-functions}

KDFs based on SHA-384 are used to derive a pairwise key-encryption key
from the shared secret produced by ephemeral-static ECDH. Sections
[7.1.8](https://www.rfc-editor.org/rfc/rfc5753#section-7.1.8){.relref}
and [7.2](https://www.rfc-editor.org/rfc/rfc5753#section-7.2){.relref}
in \[[RFC5753](#RFC5753){.xref}\] specify the CMS conventions for using
a KDF with the shared secret generated during ephemeral-static ECDH.
CNSA Suite-compliant S/MIME implementations [MUST]{.bcp14} follow these
conventions.[¶](#section-6.1.1-1){.pilcrow}

As specified in [Section
7.1.8](https://www.rfc-editor.org/rfc/rfc5753#section-7.1.8){.relref} of
\[[RFC5753](#RFC5753){.xref}\], the ANSI-X9.63-KDF described in Section
3.6.1 of \[[SEC1](#SEC1){.xref}\] and based on SHA-384 [MUST]{.bcp14} be
used.[¶](#section-6.1.1-2){.pilcrow}

As specified in [Section
7.2](https://www.rfc-editor.org/rfc/rfc5753#section-7.2){.relref} of
\[[RFC5753](#RFC5753){.xref}\], when using ECDH with the CMS
enveloped-data or authenticated-enveloped-data content type, the
derivation of key-encryption keys makes use of the ECC-CMS-SharedInfo
type:[¶](#section-6.1.1-3){.pilcrow}

::: {#section-6.1.1-4}
``` {.sourcecode .lang-asn.1}
      ECC-CMS-SharedInfo  ::=  SEQUENCE {
         keyInfo      AlgorithmIdentifier,
         entityUInfo  [0] EXPLICIT OCTET STRING OPTIONAL,
         suppPubInfo  [2] EXPLICIT OCTET STRING }
```

[¶](#section-6.1.1-4){.pilcrow}
:::

In the CNSA Suite for S/MIME, the fields of ECC-CMS-SharedInfo are used
as follows:[¶](#section-6.1.1-5){.pilcrow}

-   [keyInfo contains the object identifier of the key-encryption
    algorithm used to wrap the content-encryption key. If AES-256 Key
    Wrap is used, then the keyInfo will contain id-aes256-wrap-pad, and
    the parameters will be
    absent.[¶](#section-6.1.1-6.1){.pilcrow}]{#section-6.1.1-6.1}
-   [entityUInfo optionally contains a random value provided by the
    message originator. If user keying material (ukm) is included in the
    KeyAgreeRecipientInfo, then the entityUInfo [MUST]{.bcp14} be
    present, and it [MUST]{.bcp14} contain the ukm value. If the ukm is
    not present, then the entityUInfo [MUST]{.bcp14} be
    absent.[¶](#section-6.1.1-6.2){.pilcrow}]{#section-6.1.1-6.2}
-   [suppPubInfo contains the length of the generated key-encryption key
    in bits, represented as a 32-bit unsigned number, as described in
    \[[RFC2631](#RFC2631){.xref}\]. When a 256-bit AES key is used, the
    length [MUST]{.bcp14} be
    0x00000100.[¶](#section-6.1.1-6.3){.pilcrow}]{#section-6.1.1-6.3}

ECC-CMS-SharedInfo is DER encoded and is used as input to the key
derivation function, as specified in Section 3.6.1 of
\[[SEC1](#SEC1){.xref}\]. Note that ECC-CMS-SharedInfo differs from the
OtherInfo specified in \[[RFC2631](#RFC2631){.xref}\]. Here, a counter
value is not included in the keyInfo field because the KDF specified in
\[[SEC1](#SEC1){.xref}\] ensures that sufficient keying data is
provided.[¶](#section-6.1.1-7){.pilcrow}

The KDF specified in Section 3.6.1 of \[[SEC1](#SEC1){.xref}\] describes
how to generate an essentially arbitrary amount of keying material from
a shared secret, Z, produced by ephemeral-static ECDH. To generate an
L-bit key-encryption key (KEK), blocks of key material (KM) are computed
by incrementing Counter appropriately until enough material has been
generated:[¶](#section-6.1.1-8){.pilcrow}

::: {#section-6.1.1-9}
``` {.sourcecode .lang-pseudocode}
      KM(Counter) = Hash ( Z || Counter || ECC-CMS-SharedInfo )
```

[¶](#section-6.1.1-9){.pilcrow}
:::

The KM blocks are concatenated left to right as they are generated, and
the first (leftmost) L bits are used as the
KEK:[¶](#section-6.1.1-10){.pilcrow}

::: {#section-6.1.1-11}
``` {.sourcecode .lang-pseudocode}
      KEK = the leftmost L bits of
               [KM ( counter=1 ) || KM ( counter=2 ) ...]
```

[¶](#section-6.1.1-11){.pilcrow}
:::

In the CNSA Suite for S/MIME, the elements of the KDF are defined as
follows:[¶](#section-6.1.1-12){.pilcrow}

-   [Hash is a one-way hash function. The SHA-384 hash [MUST]{.bcp14} be
    used.[¶](#section-6.1.1-13.1){.pilcrow}]{#section-6.1.1-13.1}
-   [Z is the shared secret value generated during ephemeral-static
    ECDH. Z [MUST]{.bcp14} be exactly 384 bits, i.e., leading zero bits
    [MUST]{.bcp14} be
    preserved.[¶](#section-6.1.1-13.2){.pilcrow}]{#section-6.1.1-13.2}
-   [Counter is a 32-bit unsigned number represented in network byte
    order. Its initial value [MUST]{.bcp14} be 0x00000001 for any key
    derivation
    operation.[¶](#section-6.1.1-13.3){.pilcrow}]{#section-6.1.1-13.3}
-   [ECC-CMS-SharedInfo is composed as described above. It
    [MUST]{.bcp14} be DER
    encoded.[¶](#section-6.1.1-13.4){.pilcrow}]{#section-6.1.1-13.4}

In the CNSA Suite for S/MIME, exactly one iteration is needed; the
Counter is not incremented. The key-encryption key (KEK) [MUST]{.bcp14}
be the first (leftmost) 256 bits of the SHA-384 output
value:[¶](#section-6.1.1-14){.pilcrow}

::: {#section-6.1.1-15}
``` {.sourcecode .lang-pseudocode}
      KEK = the leftmost 256 bits of
               SHA-384 ( Z || 0x00000001 || ECC-CMS-SharedInfo )
```

[¶](#section-6.1.1-15){.pilcrow}
:::

Note that the only source of secret entropy in this computation is
Z.[¶](#section-6.1.1-16){.pilcrow}
:::
:::

::: {#keywrap}
::: {#section-6.1.2 .section}
#### [6.1.2.](#section-6.1.2){.section-number .selfRef} [AES Key Wrap](#name-aes-key-wrap){.section-name .selfRef} {#name-aes-key-wrap}

The AES Key Wrap with Padding key-encryption algorithm, as specified in
\[[RFC5649](#RFC5649){.xref}\] and \[[SP80038F](#SP80038F){.xref}\], is
used to encrypt the content-encryption key with a pairwise
key-encryption key that is generated using ephemeral-static ECDH.
[Section 8](https://www.rfc-editor.org/rfc/rfc5753#section-8){.relref}
of \[[RFC5753](#RFC5753){.xref}\] specifies the CMS conventions for
using AES Key Wrap with a pairwise key generated through
ephemeral-static ECDH. CNSA Suite-compliant S/MIME implementations
[MUST]{.bcp14} follow these conventions.[¶](#section-6.1.2-1){.pilcrow}

Within the CMS enveloped-data content type, key wrap algorithm
identifiers are located in the KeyWrapAlgorithm parameters within the
EnvelopedData RecipientInfos KeyAgreeRecipientInfo
keyEncryptionAlgorithm field.[¶](#section-6.1.2-2){.pilcrow}

The KeyWrapAlgorithm [MUST]{.bcp14} be id-aes256-wrap-pad. The required
algorithm identifier, specified in \[[RFC5649](#RFC5649){.xref}\],
is:[¶](#section-6.1.2-3){.pilcrow}

::: {#section-6.1.2-4}
``` {.sourcecode .lang-asn.1}
      id-aes256-wrap-pad  OBJECT IDENTIFIER ::=  { joint-iso-itu-t(2)
         country(16) us(840) organization(1) gov(101) csor(3)
         nistAlgorithm(4) aes(1) 48 }
```

[¶](#section-6.1.2-4){.pilcrow}
:::
:::
:::
:::
:::

::: {#rsa-kt}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [RSA Key Transport](#name-rsa-key-transport){.section-name .selfRef} {#name-rsa-key-transport}

RSA encryption (RSA) is the CNSA Suite key transport algorithm. The RSA
key transport algorithm is the RSA encryption scheme defined in
\[[RFC8017](#RFC8017){.xref}\], where the message to be encrypted is the
content-encryption key.[¶](#section-6.2-1){.pilcrow}

The recipient of an S/MIME message possesses an RSA key pair whose
public key is represented by an X.509 certificate. The certificate used
to obtain the recipient\'s public key [MUST]{.bcp14} be compliant with
\[[RFC8603](#RFC8603){.xref}\]. These certificates are suitable for use
with either RSAES-OAEP or RSAES-PKCS1-v1_5.[¶](#section-6.2-2){.pilcrow}

::: {#rsaes-PKCS1}
::: {#section-6.2.1 .section}
#### [6.2.1.](#section-6.2.1){.section-number .selfRef} [RSAES-PKCS1-v1_5](#name-rsaes-pkcs1-v1_5){.section-name .selfRef} {#name-rsaes-pkcs1-v1_5}

[Section
4.2](https://www.rfc-editor.org/rfc/rfc3370#section-4.2){.relref} of
\[[RFC3370](#RFC3370){.xref}\] specifies the conventions for using
RSAES-PKCS1-v1_5 with the CMS. S/MIME implementations employing this
form of key transport [MUST]{.bcp14} follow these
conventions.[¶](#section-6.2.1-1){.pilcrow}

Within the CMS enveloped-data and authenticated-enveloped-data content
types, key transport algorithm identifiers are located in the
EnvelopedData RecipientInfos KeyTransRecipientInfo
keyEncryptionAlgorithm field.[¶](#section-6.2.1-2){.pilcrow}

The algorithm identifier for RSA (PKCS #1 v1.5)
is:[¶](#section-6.2.1-3){.pilcrow}

::: {#section-6.2.1-4}
``` {.sourcecode .lang-asn.1}
      rsaEncryption OBJECT IDENTIFIER ::= { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs-1(1) 1 }
```

[¶](#section-6.2.1-4){.pilcrow}
:::

The AlgorithmIdentifier parameters field [MUST]{.bcp14} be present, and
the parameters field [MUST]{.bcp14} contain
NULL.[¶](#section-6.2.1-5){.pilcrow}
:::
:::

::: {#rsaes-OAEP}
::: {#section-6.2.2 .section}
#### [6.2.2.](#section-6.2.2){.section-number .selfRef} [RSAES-OAEP](#name-rsaes-oaep){.section-name .selfRef} {#name-rsaes-oaep}

\[[RFC3560](#RFC3560){.xref}\] specifies the conventions for using
RSAES-OAEP with the CMS. CNSA Suite-compliant S/MIME implementations
employing this form of key transport [MUST]{.bcp14} follow these
conventions.[¶](#section-6.2.2-1){.pilcrow}

Within the CMS enveloped-data and authenticated-enveloped-data content
types, key transport algorithm identifiers are located in the
EnvelopedData RecipientInfos KeyTransRecipientInfo
keyEncryptionAlgorithm field.[¶](#section-6.2.2-2){.pilcrow}

The algorithm identifier for RSA (OAEP)
is:[¶](#section-6.2.2-3){.pilcrow}

::: {#section-6.2.2-4}
``` {.sourcecode .lang-asn.1}
      id-RSAES-OAEP  OBJECT IDENTIFIER  ::=  { iso(1) member-body(2)
          us(840) rsadsi(113549) pkcs(1) pkcs-1(1) 7 }
```

[¶](#section-6.2.2-4){.pilcrow}
:::

The parameters field of an AlgorithmIdentifier that identifies
RSAES-OAEP is defined in \[[RFC4055](#RFC4055){.xref}\] as
follows:[¶](#section-6.2.2-5){.pilcrow}

::: {#section-6.2.2-6}
``` {.sourcecode .lang-asn.1}
       RSAES-OAEP-params  ::=  SEQUENCE  {
          hashFunc          [0] AlgorithmIdentifier DEFAULT
                                   sha1Identifier,
          maskGenFunc       [1] AlgorithmIdentifier DEFAULT
                                   mgf1SHA1Identifier,
          pSourceFunc       [2] AlgorithmIdentifier DEFAULT
                                   pSpecifiedEmptyIdentifier  }

       pSpecifiedEmptyIdentifier  AlgorithmIdentifier  ::=
                            { id-pSpecified, nullOctetString }

       nullOctetString  OCTET STRING (SIZE (0))  ::=  { ''H }
```

[¶](#section-6.2.2-6){.pilcrow}
:::

The AlgorithmIdentifier parameters field [MUST]{.bcp14} be present, and
the parameters field [MUST]{.bcp14} contain RSAES-OAEP-params with
values as follows:[¶](#section-6.2.2-7){.pilcrow}

-   [The hashFunc algorithm must be id-sha384 as defined in
    \[[RFC8017](#RFC8017){.xref}\];[¶](#section-6.2.2-8.1){.pilcrow}]{#section-6.2.2-8.1}
-   [The mask generation function must use the algorithm identifier
    mfg1SHA384Identifier as defined in
    \[[RFC4055](#RFC4055){.xref}\];[¶](#section-6.2.2-8.2){.pilcrow}]{#section-6.2.2-8.2}
-   [The pSourceFunc field must be
    absent.[¶](#section-6.2.2-8.3){.pilcrow}]{#section-6.2.2-8.3}

The SMIMECapabilities signed attribute is used to specify a partial list
of algorithms that the software announcing the SMIMECapabilities can
support. If the SMIMECapabilities signed attribute is included to
announce support for the RSAES-OAEP algorithm, it [MUST]{.bcp14} be
constructed as defined in [Section
5](https://www.rfc-editor.org/rfc/rfc3560#section-5){.relref} of
\[[RFC3560](#RFC3560){.xref}\], with the sequence representing the
rSAES-OAEP-SHA384-Identifier.[¶](#section-6.2.2-9){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#content-enc}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Content Encryption](#name-content-encryption){.section-name .selfRef} {#name-content-encryption}

AES-GCM is the preferred mode for CNSA Suite applications, as described
in the [Security Considerations](#sec-considerations){.xref} ([Section
8](#sec-considerations){.xref}). AES-CBC is acceptable where AES-GCM is
not yet available.[¶](#section-7-1){.pilcrow}

::: {#aes-gcm-enc}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [AES-GCM Content Encryption](#name-aes-gcm-content-encryption){.section-name .selfRef} {#name-aes-gcm-content-encryption}

CNSA Suite-compliant S/MIME implementations using the
authenticated-enveloped-data content type \[[RFC5083](#RFC5083){.xref}\]
[MUST]{.bcp14} use AES \[[FIPS197](#FIPS197){.xref}\] in Galois Counter
Mode (GCM) \[[SP80038D](#SP80038D){.xref}\] as the content-authenticated
encryption algorithm and [MUST]{.bcp14} follow the conventions for using
AES-GCM with the CMS defined in
\[[RFC5084](#RFC5084){.xref}\].[¶](#section-7.1-1){.pilcrow}

Within the CMS authenticated-enveloped-data content type,
content-authenticated encryption algorithm identifiers are located in
the AuthEnvelopedData EncryptedContentInfo contentEncryptionAlgorithm
field. The content-authenticated encryption algorithm is used to
encipher the content located in the AuthEnvelopedData
EncryptedContentInfo encryptedContent
field.[¶](#section-7.1-2){.pilcrow}

The AES-GCM content-authenticated encryption algorithm is described in
\[[FIPS197](#FIPS197){.xref}\] and \[[SP80038D](#SP80038D){.xref}\]. The
algorithm identifier for AES-256 in GCM mode
is:[¶](#section-7.1-3){.pilcrow}

::: {#section-7.1-4}
``` {.sourcecode .lang-asn.1}
         id-aes256-GCM  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2)
            country(16) us(840) organization(1) gov(101) csor(3)
            nistAlgorithm(4) aes(1) 46 }
```

[¶](#section-7.1-4){.pilcrow}
:::

The AlgorithmIdentifier parameters field [MUST]{.bcp14} be present, and
the parameters field must contain
GCMParameters:[¶](#section-7.1-5){.pilcrow}

::: {#section-7.1-6}
``` {.sourcecode .lang-asn.1}
      GCMParameters ::= SEQUENCE {
        aes-nonce        OCTET STRING,
        aes-ICVlen       AES-GCM-ICVlen DEFAULT 12 }
```

[¶](#section-7.1-6){.pilcrow}
:::

The authentication tag length (aes-ICVlen) [SHALL]{.bcp14} be 16
(indicating a tag length of 128 bits).[¶](#section-7.1-7){.pilcrow}

The initialization vector (aes-nonce) [MUST]{.bcp14} be generated in
accordance with Section 8.2 of \[[SP80038D](#SP80038D){.xref}\]. AES-GCM
loses security catastrophically if a nonce is reused with a given key on
more than one distinct set of input data. Therefore, a fresh
content-authenticated encryption key [MUST]{.bcp14} be generated for
each message.[¶](#section-7.1-8){.pilcrow}
:::
:::

::: {#aes-cbc-enc}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [AES-CBC Content Encryption](#name-aes-cbc-content-encryption){.section-name .selfRef} {#name-aes-cbc-content-encryption}

CNSA Suite-compliant S/MIME implementations using the enveloped-data
content type [MUST]{.bcp14} use AES-256 \[[FIPS197](#FIPS197){.xref}\]
in Cipher Block Chaining (CBC) mode \[[SP80038A](#SP80038A){.xref}\] as
the content-encryption algorithm and [MUST]{.bcp14} follow the
conventions for using AES with the CMS defined in
\[[RFC3565](#RFC3565){.xref}\].[¶](#section-7.2-1){.pilcrow}

Within the CMS enveloped-data content type, content-encryption algorithm
identifiers are located in the EnvelopedData EncryptedContentInfo
contentEncryptionAlgorithm field. The content-encryption algorithm is
used to encipher the content located in the EnvelopedData
EncryptedContentInfo encryptedContent
field.[¶](#section-7.2-2){.pilcrow}

The AES-CBC content-encryption algorithm is described in
\[[FIPS197](#FIPS197){.xref}\] and \[[SP80038A](#SP80038A){.xref}\]. The
algorithm identifier for AES-256 in CBC mode
is:[¶](#section-7.2-3){.pilcrow}

::: {#section-7.2-4}
``` {.sourcecode .lang-asn.1}
      id-aes256-CBC  OBJECT IDENTIFIER  ::=  { joint-iso-itu-t(2)
         country(16) us(840) organization(1) gov(101) csor(3)
         nistAlgorithm(4) aes(1) 42 }
```

[¶](#section-7.2-4){.pilcrow}
:::

The AlgorithmIdentifier parameters field [MUST]{.bcp14} be present, and
the parameters field must contain AES-IV:[¶](#section-7.2-5){.pilcrow}

::: {#section-7.2-6}
``` {.sourcecode .lang-asn.1}
      AES-IV  ::=  OCTET STRING (SIZE(16))
```

[¶](#section-7.2-6){.pilcrow}
:::

The 16-octet initialization vector is generated at random by the
originator. See \[[RFC4086](#RFC4086){.xref}\] for guidance on
generation of random values.[¶](#section-7.2-7){.pilcrow}
:::
:::
:::
:::

::: {#sec-considerations}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document specifies the conventions for using the NSA\'s CNSA Suite
algorithms in S/MIME. All of the algorithms and algorithm identifiers
have been specified in previous documents.[¶](#section-8-1){.pilcrow}

See \[[RFC4086](#RFC4086){.xref}\] for guidance on generation of random
values.[¶](#section-8-2){.pilcrow}

The security considerations in \[[RFC5652](#RFC5652){.xref}\] discuss
the CMS as a method for digitally signing data and encrypting
data.[¶](#section-8-3){.pilcrow}

The security considerations in \[[RFC3370](#RFC3370){.xref}\] discuss
cryptographic algorithm implementation concerns in the context of the
CMS.[¶](#section-8-4){.pilcrow}

The security considerations in \[[RFC5753](#RFC5753){.xref}\] discuss
the use of elliptic curve cryptography (ECC) in the
CMS.[¶](#section-8-5){.pilcrow}

The security considerations in \[[RFC3565](#RFC3565){.xref}\] discuss
the use of AES in the CMS.[¶](#section-8-6){.pilcrow}

The security considerations in \[[RFC8551](#RFC8551){.xref}\] apply to
this profile, particularly the recommendation to use authenticated
encryption modes (i.e., use authenticated-enveloped-data with AES-GCM
rather than enveloped-data with AES-CBC).[¶](#section-8-7){.pilcrow}
:::
:::

::: {#iana-considerations}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-9-1){.pilcrow}
:::
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[CNSA\]
:   [Committee for National Security Systems]{.refAuthor}, [\"Use of
    Public Standards for Secure Information Sharing\"]{.refTitle}, [CNSS
    Policy 15]{.seriesInfo}, October 2016,
    \<<https://www.cnss.gov/CNSS/Issuances/Policies.cfm>\>.

\[FIPS180\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Secure Hash Standard (SHS)\"]{.refTitle}, [Federal Information
    Processing Standard 180-4]{.seriesInfo}, August 2015,
    \<<https://csrc.nist.gov/publications/detail/fips/180/4/final>\>.

\[FIPS186\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Digital Signature Standard (DSS)\"]{.refTitle}, [DOI
    10.6028/NIST.FIPS.186-4]{.seriesInfo}, [FIPS PUB
    186-4]{.seriesInfo}, July 2013,
    \<<https://csrc.nist.gov/publications/detail/fips/186/4/final>\>.

\[FIPS197\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Advanced Encryption Standard (AES)\"]{.refTitle}, [DOI
    10.6028/NIST.FIPS.197]{.seriesInfo}, [FIPS PUB 197]{.seriesInfo},
    November 2001,
    \<<https://csrc.nist.gov/publications/detail/fips/197/final>\>.

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.

\[RFC2631\]
:   [Rescorla, E.]{.refAuthor}, [\"Diffie-Hellman Key Agreement
    Method\"]{.refTitle}, [RFC 2631]{.seriesInfo}, [DOI
    10.17487/RFC2631]{.seriesInfo}, June 1999,
    \<<https://www.rfc-editor.org/info/rfc2631>\>.

\[RFC3370\]
:   [Housley, R.]{.refAuthor}, [\"Cryptographic Message Syntax (CMS)
    Algorithms\"]{.refTitle}, [RFC 3370]{.seriesInfo}, [DOI
    10.17487/RFC3370]{.seriesInfo}, August 2002,
    \<<https://www.rfc-editor.org/info/rfc3370>\>.

\[RFC3560\]
:   [Housley, R.]{.refAuthor}, [\"Use of the RSAES-OAEP Key Transport
    Algorithm in Cryptographic Message Syntax (CMS)\"]{.refTitle}, [RFC
    3560]{.seriesInfo}, [DOI 10.17487/RFC3560]{.seriesInfo}, July 2003,
    \<<https://www.rfc-editor.org/info/rfc3560>\>.

\[RFC3565\]
:   [Schaad, J.]{.refAuthor}, [\"Use of the Advanced Encryption Standard
    (AES) Encryption Algorithm in Cryptographic Message Syntax
    (CMS)\"]{.refTitle}, [RFC 3565]{.seriesInfo}, [DOI
    10.17487/RFC3565]{.seriesInfo}, July 2003,
    \<<https://www.rfc-editor.org/info/rfc3565>\>.

\[RFC4055\]
:   [Schaad, J.]{.refAuthor}[, Kaliski, B.]{.refAuthor}[, and R.
    Housley]{.refAuthor}, [\"Additional Algorithms and Identifiers for
    RSA Cryptography for use in the Internet X.509 Public Key
    Infrastructure Certificate and Certificate Revocation List (CRL)
    Profile\"]{.refTitle}, [RFC 4055]{.seriesInfo}, [DOI
    10.17487/RFC4055]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4055>\>.

\[RFC4056\]
:   [Schaad, J.]{.refAuthor}, [\"Use of the RSASSA-PSS Signature
    Algorithm in Cryptographic Message Syntax (CMS)\"]{.refTitle}, [RFC
    4056]{.seriesInfo}, [DOI 10.17487/RFC4056]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4056>\>.

\[RFC5083\]
:   [Housley, R.]{.refAuthor}, [\"Cryptographic Message Syntax (CMS)
    Authenticated-Enveloped-Data Content Type\"]{.refTitle}, [RFC
    5083]{.seriesInfo}, [DOI 10.17487/RFC5083]{.seriesInfo}, November
    2007, \<<https://www.rfc-editor.org/info/rfc5083>\>.

\[RFC5084\]
:   [Housley, R.]{.refAuthor}, [\"Using AES-CCM and AES-GCM
    Authenticated Encryption in the Cryptographic Message Syntax
    (CMS)\"]{.refTitle}, [RFC 5084]{.seriesInfo}, [DOI
    10.17487/RFC5084]{.seriesInfo}, November 2007,
    \<<https://www.rfc-editor.org/info/rfc5084>\>.

\[RFC5480\]
:   [Turner, S.]{.refAuthor}[, Brown, D.]{.refAuthor}[,
    Yiu, K.]{.refAuthor}[, Housley, R.]{.refAuthor}[, and T.
    Polk]{.refAuthor}, [\"Elliptic Curve Cryptography Subject Public Key
    Information\"]{.refTitle}, [RFC 5480]{.seriesInfo}, [DOI
    10.17487/RFC5480]{.seriesInfo}, March 2009,
    \<<https://www.rfc-editor.org/info/rfc5480>\>.

\[RFC5649\]
:   [Housley, R.]{.refAuthor}[ and M. Dworkin]{.refAuthor}, [\"Advanced
    Encryption Standard (AES) Key Wrap with Padding
    Algorithm\"]{.refTitle}, [RFC 5649]{.seriesInfo}, [DOI
    10.17487/RFC5649]{.seriesInfo}, September 2009,
    \<<https://www.rfc-editor.org/info/rfc5649>\>.

\[RFC5652\]
:   [Housley, R.]{.refAuthor}, [\"Cryptographic Message Syntax
    (CMS)\"]{.refTitle}, [STD 70]{.seriesInfo}, [RFC 5652]{.seriesInfo},
    [DOI 10.17487/RFC5652]{.seriesInfo}, September 2009,
    \<<https://www.rfc-editor.org/info/rfc5652>\>.

\[RFC5753\]
:   [Turner, S.]{.refAuthor}[ and D. Brown]{.refAuthor}, [\"Use of
    Elliptic Curve Cryptography (ECC) Algorithms in Cryptographic
    Message Syntax (CMS)\"]{.refTitle}, [RFC 5753]{.seriesInfo}, [DOI
    10.17487/RFC5753]{.seriesInfo}, January 2010,
    \<<https://www.rfc-editor.org/info/rfc5753>\>.

\[RFC5754\]
:   [Turner, S.]{.refAuthor}, [\"Using SHA2 Algorithms with
    Cryptographic Message Syntax\"]{.refTitle}, [RFC 5754]{.seriesInfo},
    [DOI 10.17487/RFC5754]{.seriesInfo}, January 2010,
    \<<https://www.rfc-editor.org/info/rfc5754>\>.

\[RFC8017\]
:   [Moriarty, K., Ed.]{.refAuthor}[, Kaliski, B.]{.refAuthor}[,
    Jonsson, J.]{.refAuthor}[, and A. Rusch]{.refAuthor}, [\"PKCS #1:
    RSA Cryptography Specifications Version 2.2\"]{.refTitle}, [RFC
    8017]{.seriesInfo}, [DOI 10.17487/RFC8017]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8017>\>.

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.

\[RFC8551\]
:   [Schaad, J.]{.refAuthor}[, Ramsdell, B.]{.refAuthor}[, and S.
    Turner]{.refAuthor}, [\"Secure/Multipurpose Internet Mail Extensions
    (S/MIME) Version 4.0 Message Specification\"]{.refTitle}, [RFC
    8551]{.seriesInfo}, [DOI 10.17487/RFC8551]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8551>\>.

\[RFC8603\]
:   [Jenkins, M.]{.refAuthor}[ and L. Zieglar]{.refAuthor},
    [\"Commercial National Security Algorithm (CNSA) Suite Certificate
    and Certificate Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    8603]{.seriesInfo}, [DOI 10.17487/RFC8603]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8603>\>.

\[SEC1\]
:   [Standards for Efficient Cryptography Group]{.refAuthor}, [\"SEC1:
    Elliptic Curve Cryptography\"]{.refTitle}, May 2009,
    \<<https://www.secg.org/sec1-v2.pdf>\>.

\[SP80038A\]
:   [Dworkin, M.]{.refAuthor}, [\"Recommendation for Block Cipher Modes
    of Operation: Methods and Techniques\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-38A]{.seriesInfo}, [Special Publication
    800-38A]{.seriesInfo}, December 2001,
    \<<https://csrc.nist.gov/publications/detail/sp/800-38a/final>\>.

\[SP80038D\]
:   [Dworkin, M.]{.refAuthor}, [\"Recommendation for Block Cipher Modes
    of Operation: Galois/Counter Mode (GCM) and GMAC\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-38D]{.seriesInfo}, [Special Publication
    800-38D]{.seriesInfo}, November 2007,
    \<<https://csrc.nist.gov/publications/detail/sp/800-38d/final>\>.

\[SP80038F\]
:   [Dworkin, M.]{.refAuthor}, [\"Recommendation for Block Cipher Modes
    of Operation: Methods for Key Wrapping\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-38F]{.seriesInfo}, [Special Publication
    800-38F]{.seriesInfo}, December 2012,
    \<<https://csrc.nist.gov/publications/detail/sp/800-38f/final>\>.

\[X208\]
:   [CCITT]{.refAuthor}, [\"Specification of Abstract Syntax Notation
    One (ASN.1)\"]{.refTitle}, [CCITT Recommendation
    X.208]{.seriesInfo}, 1988,
    \<<https://www.itu.int/rec/T-REC-X.208-198811-W/en>\>.

\[X209\]
:   [CCITT]{.refAuthor}, [\"Specification of Basic Encoding Rules for
    Abstract Syntax Notation One (ASN.1)\"]{.refTitle}, [CCITT
    Recommendation X.209]{.seriesInfo}, 1988,
    \<<https://www.itu.int/rec/T-REC-X.209-198811-W/en>\>.

\[X509\]
:   [CCITT]{.refAuthor}, [\"The Directory - Authentication
    Framework\"]{.refTitle}, [CCITT Recommendation X.509]{.seriesInfo},
    1988, \<<https://www.itu.int/rec/T-REC-X.509-198811-S>\>.
:::

::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC4086\]
:   [Eastlake 3rd, D.]{.refAuthor}[, Schiller, J.]{.refAuthor}[, and S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.

\[SP80059\]
:   [Barker, W.]{.refAuthor}, [\"Guideline for Identifying an
    Information System as a National Security System\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-59]{.seriesInfo}, [Special Publication
    800-59]{.seriesInfo}, August 2003,
    \<<https://csrc.nist.gov/publications/detail/sp/800-59/final>\>.
:::
:::

::: {#authors-addresses}
::: {#section-appendix.a .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Michael Jenkins]{.fn .nameRole}
:::

::: {.left dir="auto"}
[National Security Agency]{.org}
:::

::: email
Email: <mjjenki@nsa.gov>
:::
:::
:::
