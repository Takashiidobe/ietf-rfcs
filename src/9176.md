  RFC 9176         CoRE Resource Directory   April 2022
  ---------------- ------------------------- ------------
  Amsüss, et al.   Standards Track           \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9176](https://www.rfc-editor.org/rfc/rfc9176){.eref}

Category:
:   Standards Track

Published:
:   April 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    C. Amsüss, [Ed.]{.editor}
    :::
    :::

    ::: author
    ::: author-name
    Z. Shelby
    :::

    ::: org
    Edge Impulse
    :::
    :::

    ::: author
    ::: author-name
    M. Koster
    :::

    ::: org
    PassiveLogic
    :::
    :::

    ::: author
    ::: author-name
    C. Bormann
    :::

    ::: org
    Universität Bremen TZI
    :::
    :::

    ::: author
    ::: author-name
    P. van der Stok
    :::

    ::: org
    vanderstok consultancy
    :::
    :::
:::

# RFC 9176 {#rfcnum}

# Constrained RESTful Environments (CoRE) Resource Directory {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

In many Internet of Things (IoT) applications, direct discovery of
resources is not practical due to sleeping nodes or networks where
multicast traffic is inefficient. These problems can be solved by
employing an entity called a Resource Directory (RD), which contains
information about resources held on other servers, allowing lookups to
be performed for those resources. The input to an RD is composed of
links, and the output is composed of links constructed from the
information stored in the RD. This document specifies the web interfaces
that an RD supports for web servers to discover the RD and to register,
maintain, look up, and remove information on resources. Furthermore, new
target attributes useful in conjunction with an RD are
defined.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9176>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Architecture and Use
    Cases](#name-architecture-and-use-cases){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Principles](#name-principles){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Architecture](#name-architecture){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [RD Content
        Model](#name-rd-content-model){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Link-Local Addresses and Zone
        Identifiers](#name-link-local-addresses-and-zo){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Use Case: Cellular
        M2M](#name-use-case-cellular-m2m){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [Use Case: Home and Building
        Automation](#name-use-case-home-and-building-){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Use Case: Link
        Catalogues](#name-use-case-link-catalogues){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [RD Discovery and Other
    Interface-Independent
    Components](#name-rd-discovery-and-other-inte){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Finding a Resource
        Directory](#name-finding-a-resource-director){.xref}

        -   ::: {#section-toc.1-1.4.2.1.2.1}
            [4.1.1](#section-4.1.1){.xref}.  [Resource Directory Address
            Option (RDAO)](#name-resource-directory-address-){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.1.2.2}
            [4.1.2](#section-4.1.2){.xref}.  [Using DNS-SD to Discover a
            Resource
            Directory](#name-using-dns-sd-to-discover-a-){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Payload Content
        Formats](#name-payload-content-formats){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [URI
        Discovery](#name-uri-discovery){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Registration](#name-registration){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Simple
        Registration](#name-simple-registration){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Third-Party
        Registration](#name-third-party-registration){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Operations on the Registration
        Resource](#name-operations-on-the-registrat){.xref}

        -   ::: {#section-toc.1-1.5.2.3.2.1}
            [5.3.1](#section-5.3.1){.xref}.  [Registration
            Update](#name-registration-update){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.2}
            [5.3.2](#section-5.3.2){.xref}.  [Registration
            Removal](#name-registration-removal){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.3}
            [5.3.3](#section-5.3.3){.xref}.  [Further
            Operations](#name-further-operations){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.4}
            [5.3.4](#section-5.3.4){.xref}.  [Request
            Freshness](#name-request-freshness){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [RD Lookup](#name-rd-lookup){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Resource
        Lookup](#name-resource-lookup){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Lookup
        Filtering](#name-lookup-filtering){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Resource Lookup
        Examples](#name-resource-lookup-examples){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [Endpoint
        Lookup](#name-endpoint-lookup){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Policies](#name-security-policies){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Endpoint
        Name](#name-endpoint-name){.xref}

        -   ::: {#section-toc.1-1.7.2.1.2.1}
            [7.1.1](#section-7.1.1){.xref}.  [Random Endpoint
            Names](#name-random-endpoint-names){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Entered
        Links](#name-entered-links){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Link
        Confidentiality](#name-link-confidentiality){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [Segmentation](#name-segmentation){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.5}
        [7.5](#section-7.5){.xref}.  [\"First Come First Remembered\": A
        Default Policy](#name-first-come-first-remembered){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Discovery](#name-discovery){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Endpoint Identification and
        Authentication](#name-endpoint-identification-and){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [Access
        Control](#name-access-control){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [8.4](#section-8.4){.xref}.  [Denial-of-Service
        Attacks](#name-denial-of-service-attacks){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.5}
        [8.5](#section-8.5){.xref}.  [Skipping Freshness
        Checks](#name-skipping-freshness-checks){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Resource
        Types](#name-resource-types){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [IPv6 ND Resource Directory Address
        Option](#name-ipv6-nd-resource-directory-){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [9.3](#section-9.3){.xref}.  [RD Parameters
        Registry](#name-rd-parameters-registry){.xref}

        -   ::: {#section-toc.1-1.9.2.3.2.1}
            [9.3.1](#section-9.3.1){.xref}.  [Full Description of the
            \"Endpoint Type\" RD
            Parameter](#name-full-description-of-the-end){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.4}
        [9.4](#section-9.4){.xref}.  [Endpoint Type (et=) RD Parameter
        Values](#name-endpoint-type-et-rd-paramet){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.5}
        [9.5](#section-9.5){.xref}.  [Multicast Address
        Registration](#name-multicast-address-registrat){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.6}
        [9.6](#section-9.6){.xref}.  [Well-Known
        URIs](#name-well-known-uris){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.7}
        [9.7](#section-9.7){.xref}.  [Service Name and Transport
        Protocol Port Number
        Registry](#name-service-name-and-transport-){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Examples](#name-examples){.xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Lighting
        Installation](#name-lighting-installation){.xref}

        -   ::: {#section-toc.1-1.10.2.1.2.1}
            [10.1.1](#section-10.1.1){.xref}.  [Installation
            Characteristics](#name-installation-characteristic){.xref}
            :::

        -   ::: {#section-toc.1-1.10.2.1.2.2}
            [10.1.2](#section-10.1.2){.xref}.  [RD
            Entries](#name-rd-entries){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [OMA Lightweight M2M
        (LwM2M)](#name-oma-lightweight-m2m-lwm2m){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix A](#appendix-A){.xref}.  [Groups Registration and
    Lookup](#name-groups-registration-and-loo){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [Appendix B](#appendix-B){.xref}.  [Web Links and the Resource
    Directory](#name-web-links-and-the-resource-){.xref}

    -   ::: {#section-toc.1-1.13.2.1}
        [B.1](#appendix-B.1){.xref}.  [A Simple
        Example](#name-a-simple-example){.xref}

        -   ::: {#section-toc.1-1.13.2.1.2.1}
            [B.1.1](#appendix-B.1.1){.xref}.  [Resolving the
            URIs](#name-resolving-the-uris){.xref}
            :::

        -   ::: {#section-toc.1-1.13.2.1.2.2}
            [B.1.2](#appendix-B.1.2){.xref}.  [Interpreting Attributes
            and Relations](#name-interpreting-attributes-and){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.13.2.2}
        [B.2](#appendix-B.2){.xref}.  [A Slightly More Complex
        Example](#name-a-slightly-more-complex-exa){.xref}
        :::

    -   ::: {#section-toc.1-1.13.2.3}
        [B.3](#appendix-B.3){.xref}.  [Enter the Resource
        Directory](#name-enter-the-resource-director){.xref}
        :::

    -   ::: {#section-toc.1-1.13.2.4}
        [B.4](#appendix-B.4){.xref}.  [A Note on Differences between
        Link-Format and Link Header
        Fields](#name-a-note-on-differences-betwe){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.14}
    [Appendix C](#appendix-C){.xref}.  [Limited Link
    Format](#name-limited-link-format){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [](#appendix-D){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.16}
    [](#appendix-E){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

In the work on Constrained RESTful Environments (CoRE), a
Representational State Transfer (REST) architecture suitable for
constrained nodes (e.g., with limited RAM and ROM
\[[RFC7228](#RFC7228){.xref}\]) and networks (e.g., IPv6 over Low-Power
Wireless Personal Area Network (6LoWPAN) \[[RFC4944](#RFC4944){.xref}\])
has been established and is used in Internet of Things (IoT) or
machine-to-machine (M2M) applications, such as smart energy and building
automation.[¶](#section-1-1){.pilcrow}

The discovery of resources offered by a constrained server is very
important in machine-to-machine applications where there are no humans
in the loop and static interfaces result in fragility. The discovery of
resources provided by an HTTP web server is typically called web linking
\[[RFC8288](#RFC8288){.xref}\]. The use of web linking for the
description and discovery of resources hosted by constrained web servers
is specified by the CoRE Link Format \[[RFC6690](#RFC6690){.xref}\].
However, \[[RFC6690](#RFC6690){.xref}\] only describes how to discover
resources from the web server that hosts them by querying
`/.well-known/core`. In many constrained scenarios, direct discovery of
resources is not practical due to sleeping nodes or networks where
multicast traffic is inefficient. These problems can be solved by
employing an entity called a Resource Directory (RD), which contains
information about resources held on other servers, allowing lookups to
be performed for those resources.[¶](#section-1-2){.pilcrow}

This document specifies the web interfaces that an RD supports for web
servers to discover the RD and to register, maintain, look up, and
remove information on resources. Furthermore, new target attributes
useful in conjunction with an RD are defined. Although the examples in
this document show the use of these interfaces with the Constrained
Application Protocol (CoAP) \[[RFC7252](#RFC7252){.xref}\], they can be
applied in an equivalent manner to HTTP
\[[RFC7230](#RFC7230){.xref}\].[¶](#section-1-3){.pilcrow}
:::
:::

::: {#terminology}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

The term \"byte\" is used in its now customary sense as a synonym for
\"octet\".[¶](#section-2-2){.pilcrow}

This specification requires readers to be familiar with all the terms
and concepts that are discussed in \[[RFC3986](#RFC3986){.xref}\],
\[[RFC8288](#RFC8288){.xref}\], and \[[RFC6690](#RFC6690){.xref}\].
Readers should also be familiar with the terms and concepts discussed in
\[[RFC7252](#RFC7252){.xref}\]. To describe the REST interfaces defined
in this specification, the URI Template format is used
\[[RFC6570](#RFC6570){.xref}\].[¶](#section-2-3){.pilcrow}

This specification makes use of the following additional
terminology:[¶](#section-2-4){.pilcrow}

[]{.break}

Resolve Against
:   The expression \"a URI reference is *resolved against* a base URI\"
    is used to describe the process of \[[RFC3986](#RFC3986){.xref}\],
    [Section
    5.2](https://www.rfc-editor.org/rfc/rfc3986#section-5.2){.relref}.
    Noteworthy corner cases include the following: (1) if the URI
    reference is a (full) URI, resolving against any base URI gives the
    original full URI and (2) resolving an empty URI reference gives the
    base URI without any fragment
    identifier.[¶](#section-2-5.2){.pilcrow}
:   

Resource Directory (RD)

:   A web entity that stores information about web resources and
    implements the REST interfaces defined in this specification for
    discovery, for the creation, maintenance, and removal of
    registrations, and for lookup of the registered
    resources.[¶](#section-2-5.4.1){.pilcrow}

:   

Sector

:   In the context of an RD, a sector is a logical grouping of
    endpoints.[¶](#section-2-5.6.1){.pilcrow}

    The abbreviation \"d=\" is used for the sector in query parameters
    for compatibility with deployed
    implementations.[¶](#section-2-5.6.2){.pilcrow}

:   

Endpoint (EP)

:   Endpoint (EP) is a term used to describe a web server or client in
    \[[RFC7252](#RFC7252){.xref}\]. In the context of this
    specification, an endpoint is used to describe a web server that
    registers resources to the RD. An endpoint is identified by its
    endpoint name, which is included during registration, and has a
    unique name within the associated sector of the
    registration.[¶](#section-2-5.8.1){.pilcrow}

:   

Registration Base URI

:   The base URI of a registration is a URI that typically gives scheme
    and authority information about an endpoint. The registration base
    URI is provided at registration time and is used by the RD to
    resolve relative references of the registration into
    URIs.[¶](#section-2-5.10.1){.pilcrow}

:   

Target

:   The target of a link is the destination address (URI) of the link.
    It is sometimes identified with \"href=\" or displayed as
    `<target>`. Relative targets need resolving with respect to the base
    URI ([Section
    5.2](https://www.rfc-editor.org/rfc/rfc3986#section-5.2){.relref} of
    \[[RFC3986](#RFC3986){.xref}\]).[¶](#section-2-5.12.1){.pilcrow}

    This use of the term \"target\" is consistent with the use in
    \[[RFC8288](#RFC8288){.xref}\].[¶](#section-2-5.12.2){.pilcrow}

:   

Context

:   The context of a link is the source address (URI) of the link and
    describes which resource is linked to the target. A link\'s context
    is made explicit in serialized links as the \"anchor=\"
    attribute.[¶](#section-2-5.14.1){.pilcrow}

    This use of the term \"context\" is consistent with the use in
    \[[RFC8288](#RFC8288){.xref}\].[¶](#section-2-5.14.2){.pilcrow}

:   

Directory Resource

:   A directory resource is a resource in the RD containing registration
    resources.[¶](#section-2-5.16.1){.pilcrow}

:   

Registration Resource

:   A registration resource is a resource in the RD that contains
    information about an endpoint and its
    links.[¶](#section-2-5.18.1){.pilcrow}

:   

Commissioning Tool (CT)

:   A Commissioning Tool (CT) is a device that assists during
    installation events by assigning values to parameters, naming
    endpoints and groups, or adapting the installation to the needs of
    the applications.[¶](#section-2-5.20.1){.pilcrow}

:   

Registrant-EP

:   A registrant-EP is the endpoint that is registered into the RD. The
    registrant-EP can register itself, or a CT registers the
    registrant-EP.[¶](#section-2-5.22.1){.pilcrow}

:   

Resource Directory Address Option (RDAO)

:   A Resource Directory Address Option (RDAO) is a new IPv6 Neighbor
    Discovery option defined for announcing an RD\'s
    address.[¶](#section-2-5.24.1){.pilcrow}

:   
:::
:::

::: {#arch}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Architecture and Use Cases](#name-architecture-and-use-cases){.section-name .selfRef} {#name-architecture-and-use-cases}

::: {#principles}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Principles](#name-principles){.section-name .selfRef} {#name-principles}

The RD is primarily a tool to make discovery operations more efficient
than querying `/.well-known/core` on all connected devices or across
boundaries that would limit those
operations.[¶](#section-3.1-1){.pilcrow}

It provides information about resources hosted by other devices that
could otherwise only be obtained by directly querying the
`/.well-known/core` resource on these other devices, either by a unicast
request or a multicast request.[¶](#section-3.1-2){.pilcrow}

Information [SHOULD]{.bcp14} only be stored in the RD if it can be
obtained by querying the described device\'s `/.well-known/core`
resource directly.[¶](#section-3.1-3){.pilcrow}

Data in the RD can only be provided by the device that hosts the data or
a dedicated Commissioning Tool (CT). These CTs act on behalf of
endpoints too constrained, or generally unable, to present that
information themselves. No other client can modify data in the RD.
Changes to the information in the RD do not propagate automatically back
to the web servers from where the information
originated.[¶](#section-3.1-4){.pilcrow}
:::
:::

::: {#architecture}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Architecture](#name-architecture){.section-name .selfRef} {#name-architecture}

The RD architecture is illustrated in [Figure 1](#fig-arch){.xref}. An
RD is used as a repository of registrations describing resources hosted
on other web servers, also called endpoints (EPs). An endpoint is a web
server associated with a scheme, IP address, and port. A physical node
may host one or more endpoints. The RD implements a set of REST
interfaces for endpoints to register and maintain RD registrations and
for endpoints to look up resources from the RD. An RD can be logically
segmented by the use of sectors.[¶](#section-3.2-1){.pilcrow}

A mechanism to discover an RD using CoRE Link Format
\[[RFC6690](#RFC6690){.xref}\] is defined.[¶](#section-3.2-2){.pilcrow}

Registrations in the RD are soft state and need to be periodically
refreshed.[¶](#section-3.2-3){.pilcrow}

An endpoint uses specific interfaces to register, update, and remove a
registration. It is also possible for an RD to fetch web links from
endpoints and add their contents to its
registrations.[¶](#section-3.2-4){.pilcrow}

At the first registration of an endpoint, a \"registration resource\" is
created, the location of which is returned to the registering endpoint.
The registering endpoint uses this registration resource to manage the
contents of registrations.[¶](#section-3.2-5){.pilcrow}

A lookup interface for discovering any of the web links stored in the RD
is provided using the CoRE Link Format.[¶](#section-3.2-6){.pilcrow}

[]{#name-the-rd-architecture}

::: {#fig-arch}
::: {#section-3.2-7.1 .alignLeft .art-ascii-art .art-text .artwork}
               Registration         Lookup
                Interface         Interface
    +----+          |                 |
    | EP |----      |                 |
    +----+    ----  |                 |
                  --|-    +------+    |
    +----+          | ----|      |    |     +--------+
    | EP | ---------|-----|  RD  |----|-----| Client |
    +----+          | ----|      |    |     +--------+
                  --|-    +------+    |
    +----+    ----  |                 |
    | CT |----      |                 |
    +----+
:::

[Figure 1](#figure-1){.selfRef}: [The RD
Architecture](#name-the-rd-architecture){.selfRef}
:::

A registrant-EP [MAY]{.bcp14} keep concurrent registrations to more than
one RD at the same time if explicitly configured to do so, but that is
not expected to be supported by typical EP implementations. Any such
registrations are independent of each other. The usual expectation when
multiple discovery mechanisms or addresses are configured is that they
constitute a fall-back path for a single
registration.[¶](#section-3.2-8){.pilcrow}
:::
:::

::: {#ER-model}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [RD Content Model](#name-rd-content-model){.section-name .selfRef} {#name-rd-content-model}

The Entity-Relationship (ER) models shown in Figures
[2](#fig-ER-WKC){.xref} and [3](#fig-ER-RD){.xref} model the contents of
`/.well-known/core` and the RD respectively, with entity-relationship
diagrams \[[ER](#ER){.xref}\]. Entities (rectangles) are used for
concepts that exist independently. Attributes (ovals) are used for
concepts that exist only in connection with a related entity. Relations
(diamonds) give a semantic meaning to the relation between entities.
Numbers specify the cardinality of the
relations.[¶](#section-3.3-1){.pilcrow}

Some of the attribute values are URIs. Those values are always full URIs
and never relative references in the information model. However, they
can be expressed as relative references in serializations, and they
often are.[¶](#section-3.3-2){.pilcrow}

These models provide an abstract view of the information expressed in
link-format documents and an RD. They cover the concepts but not
necessarily all details of an RD\'s operation; they are meant to give an
overview and not be a template for
implementations.[¶](#section-3.3-3){.pilcrow}

[]{#name-er-model-of-the-content-of-}

::: {#fig-ER-WKC}
::: {#section-3.3-4.1 .alignLeft .art-ascii-art .art-text .artwork}
               +----------------------+
               |   /.well-known/core  |
               +----------------------+
                          |
                          | 1
                  ////////\\\\\\\
                 <    contains   >
                  \\\\\\\\///////
                          |
                          | 0+
                +--------------------+
                |      link          |
                +--------------------+
                          |
                          |  1   oooooooo
                          +-----o target o
                          |      oooooooo
     oooooooooooo   0+    |
    o    target  o--------+
    o  attribute o        | 0+   oooooo
     oooooooooooo         +-----o rel  o
                          |      oooooo
                          |
                          | 1    ooooooooo
                          +-----o context o
                                 ooooooooo
:::

[Figure 2](#figure-2){.selfRef}: [ER Model of the Content of
`/.well-known/core`](#name-er-model-of-the-content-of-){.selfRef}
:::

[Figure 2](#fig-ER-WKC){.xref} models the contents of
`/.well-known/core`, which contains a set of links belonging to the
hosting web server.[¶](#section-3.3-5){.pilcrow}

The web server is free to choose links it deems appropriate to be
exposed in its `/.well-known/core`. Typically, the links describe
resources that are served by the host, but the set can also contain
links to resources on other servers (see examples in [Section
5](https://www.rfc-editor.org/rfc/rfc6690#section-5){.relref} of
\[[RFC6690](#RFC6690){.xref}\]). The set does not necessarily contain
links to all resources served by the host.[¶](#section-3.3-6){.pilcrow}

A link has the following attributes (see [Section
5](https://www.rfc-editor.org/rfc/rfc8288#section-5){.relref} of
\[[RFC8288](#RFC8288){.xref}\]):[¶](#section-3.3-7){.pilcrow}

-   ::: {#section-3.3-8.1}
    Zero or more link relations: They describe relations between the
    link context and the link target.[¶](#section-3.3-8.1.1){.pilcrow}

    In link-format serialization, they are expressed as space-separated
    values in the \"rel\" attribute and default to
    \"hosts\".[¶](#section-3.3-8.1.2){.pilcrow}
    :::

-   ::: {#section-3.3-8.2}
    A link context URI: It defines the source of the relation, e.g.,
    *who* \"hosts\" something.[¶](#section-3.3-8.2.1){.pilcrow}

    In link-format serialization, it is expressed in the \"anchor\"
    attribute and defaults to the Origin of the target (practically, the
    target with its path and later components
    removed).[¶](#section-3.3-8.2.2){.pilcrow}
    :::

-   ::: {#section-3.3-8.3}
    A link target URI: It defines the destination of the relation (e.g.,
    *what* is hosted) and is the topic of all target
    attributes.[¶](#section-3.3-8.3.1){.pilcrow}

    In link-format serialization, it is expressed between angular
    brackets and sometimes called the
    \"href\".[¶](#section-3.3-8.3.2){.pilcrow}
    :::

-   [Other target attributes (e.g., resource type (rt), interface (if),
    or content format (ct)): These provide additional information about
    the target URI.[¶](#section-3.3-8.4){.pilcrow}]{#section-3.3-8.4}

[]{#name-er-model-of-the-content-of-t}

::: {#fig-ER-RD}
::: {#section-3.3-9.1 .alignLeft .art-ascii-art .art-text .artwork}
                     +--------------+
                     +      RD      +
                     +--------------+
                            | 1
                            |
                            |
                            |
                            |
                       //////\\\\
                      < contains >
                       \\\\\/////
                            |
                         0+ |
     ooooooo     1  +---------------+
    o  base o-------|  registration |
     ooooooo        +---------------+
                        |       | 1
                        |       +--------------+
           oooooooo   1 |                      |
          o  href  o----+                 /////\\\\
           oooooooo     |                < contains >
                        |                 \\\\\/////
           oooooooo   1 |                      |
          o   ep   o----+                      | 0+
           oooooooo     |             +------------------+
                        |             |      link        |
           oooooooo 0-1 |             +------------------+
          o    d   o----+                      |
           oooooooo     |                      |  1   oooooooo
                        |                      +-----o target o
           oooooooo   1 |                      |      oooooooo
          o   lt   o----+     ooooooooooo   0+ |
           oooooooo     |    o  target   o-----+
                        |    o attribute o     | 0+   oooooo
        ooooooooooo 0+  |     ooooooooooo      +-----o rel  o
       o  endpoint o----+                      |      oooooo
       o attribute o                           |
        ooooooooooo                            | 1   ooooooooo
                                               +----o context o
                                                     ooooooooo
:::

[Figure 3](#figure-3){.selfRef}: [ER Model of the Content of the
RD](#name-er-model-of-the-content-of-t){.selfRef}
:::

[Figure 3](#fig-ER-RD){.xref} models the contents of the RD, which
contains, in addition to `/.well-known/core`, 0 to n registrations of
endpoints.[¶](#section-3.3-10){.pilcrow}

A registration is associated with one endpoint. A registration defines a
set of links, as defined for `/.well-known/core`. A registration has six
types of attributes:[¶](#section-3.3-11){.pilcrow}

-   [an endpoint name (\"ep\", a Unicode string) unique within a
    sector[¶](#section-3.3-12.1){.pilcrow}]{#section-3.3-12.1}
-   [a registration base URI (\"base\", a URI typically describing the
    scheme://authority
    part)[¶](#section-3.3-12.2){.pilcrow}]{#section-3.3-12.2}
-   [a lifetime
    (\"lt\")[¶](#section-3.3-12.3){.pilcrow}]{#section-3.3-12.3}
-   [a registration resource location inside the RD
    (\"href\")[¶](#section-3.3-12.4){.pilcrow}]{#section-3.3-12.4}
-   [optionally, a sector (\"d\", a Unicode
    string)[¶](#section-3.3-12.5){.pilcrow}]{#section-3.3-12.5}
-   [optional additional endpoint attributes (from [Section
    9.3](#iana-registry){.xref})[¶](#section-3.3-12.6){.pilcrow}]{#section-3.3-12.6}

The cardinality of \"base\" is currently 1; future documents are invited
to extend the RD specification to support multiple values (e.g.,
\[[COAP-PROT-NEG](#I-D.silverajan-core-coap-protocol-negotiation){.xref}\]).
Its value is used as a base URI when resolving URIs in the links
contained in the endpoint.[¶](#section-3.3-13){.pilcrow}

Links are modeled as they are in [Figure
2](#fig-ER-WKC){.xref}.[¶](#section-3.3-14){.pilcrow}
:::
:::

::: {#linklocal}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Link-Local Addresses and Zone Identifiers](#name-link-local-addresses-and-zo){.section-name .selfRef} {#name-link-local-addresses-and-zo}

Registration base URIs can contain link-local IP addresses. To be usable
across hosts, those cannot be serialized to contain zone identifiers
(see \[[RFC6874](#RFC6874){.xref}\], [Section
1](https://www.rfc-editor.org/rfc/rfc6874#section-1){.relref}).[¶](#section-3.4-1){.pilcrow}

Link-local addresses can only be used on a single link (therefore, RD
servers cannot announce them when queried on a different link), and
lookup clients using them need to keep track of which interface they got
them from.[¶](#section-3.4-2){.pilcrow}

Therefore, it is advisable in many scenarios to use addresses with
larger scopes, if available.[¶](#section-3.4-3){.pilcrow}
:::
:::

::: {#cellular}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Use Case: Cellular M2M](#name-use-case-cellular-m2m){.section-name .selfRef} {#name-use-case-cellular-m2m}

Over the last few years, mobile operators around the world have focused
on development of M2M solutions in order to expand the business to the
new type of users: machines. The machines are connected directly to a
mobile network using an appropriate embedded wireless interface
(GSM/General Packet Radio Service (GPRS), Wideband Code Division
Multiple Access (W-CDMA), LTE, etc.) or via a gateway providing short-
and wide-range wireless interfaces. The ambition in such systems is to
build them from reusable components. These speed up development and
deployment and enable shared use of machines across different
applications. One crucial component of such systems is the discovery of
resources (and thus the endpoints they are hosted on) capable of
providing required information at a given time or acting on instructions
from the end users.[¶](#section-3.5-1){.pilcrow}

Imagine a scenario where endpoints installed on vehicles enable tracking
of the position of these vehicles for fleet management purposes and
allow monitoring of environment parameters. During the boot-up process,
endpoints register with an RD, which is hosted by the mobile operator or
somewhere in the cloud. Periodically, these endpoints update their
registration and may modify resources they
offer.[¶](#section-3.5-2){.pilcrow}

When endpoints are not always connected, for example, because they enter
a sleep mode, a remote server is usually used to provide proxy access to
the endpoints. Mobile apps or web applications for environment
monitoring contact the RD, look up the endpoints capable of providing
information about the environment using an appropriate set of link
parameters, obtain information on how to contact them (URLs of the proxy
server), and then initiate interaction to obtain information that is
finally processed, displayed on the screen, and usually stored in a
database. Similarly, fleet management systems provide the appropriate
link parameters to the RD to look up for EPs deployed on the vehicles
the application is responsible for.[¶](#section-3.5-3){.pilcrow}
:::
:::

::: {#automation}
::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [Use Case: Home and Building Automation](#name-use-case-home-and-building-){.section-name .selfRef} {#name-use-case-home-and-building-}

Home and commercial building automation systems can benefit from the use
of IoT web services. The discovery requirements of these applications
are demanding. Home automation usually relies on run-time discovery to
commission the system, whereas, in building automation, a combination of
professional commissioning and run-time discovery is used. Both home and
building automation involve peer-to-peer interactions between endpoints
and involve battery-powered sleeping devices. Both can use the common RD
infrastructure to establish device interactions efficiently but can pick
security policies suitable for their needs.[¶](#section-3.6-1){.pilcrow}

Two phases can be discerned for a network servicing the system: (1)
installation and (2) operation. During the operational phase, the
network is connected to the Internet with a border router (e.g., a
6LoWPAN Border Router (6LBR) \[[RFC6775](#RFC6775){.xref}\]), and the
nodes connected to the network can use the Internet services that are
provided by the IP or network administrator. During the installation
phase, the network is completely stand-alone, no border router is
connected, and the network only supports the IP communication between
the connected nodes. The installation phase is usually followed by the
operational phase. As an RD\'s operations work without hard dependencies
on names or addresses, it can be used for discovery across both
phases.[¶](#section-3.6-2){.pilcrow}
:::
:::

::: {#usecase-catalogues}
::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Use Case: Link Catalogues](#name-use-case-link-catalogues){.section-name .selfRef} {#name-use-case-link-catalogues}

Resources may be shared through data brokers that have no knowledge
beforehand of who is going to consume the data. An RD can be used to
hold links about resources and services hosted anywhere to make them
discoverable by a general class of
applications.[¶](#section-3.7-1){.pilcrow}

For example, environmental and weather sensors that generate data for
public consumption may provide data to an intermediary server or broker.
Sensor data are published to the intermediary upon changes or at regular
intervals. Descriptions of the sensors that resolve to links to sensor
data may be published to an RD. Applications wishing to consume the data
can use RD lookup to discover and resolve links to the desired resources
and endpoints. The RD service need not be coupled with the data
intermediary service. Mapping of RDs to data intermediaries may be
many-to-many.[¶](#section-3.7-2){.pilcrow}

Metadata in web link formats, such as the one defined in
\[[RFC6690](#RFC6690){.xref}\], which may be internally stored as
triples or relation/attribute pairs providing metadata about resource
links, need to be supported by RDs. External catalogues that are
represented in other formats may be converted to common web linking
formats for storage and access by RDs. Since it is common practice for
these to be encoded in URNs \[[RFC8141](#RFC8141){.xref}\], simple and
lossless structural transforms should generally be sufficient to store
external metadata in RDs.[¶](#section-3.7-3){.pilcrow}

The additional features of an RD allow sectors to be defined to enable
access to a particular set of resources from particular applications.
This provides isolation and protection of sensitive data when needed.
Application groups with multicast addresses may be defined to support
efficient data transport.[¶](#section-3.7-4){.pilcrow}
:::
:::
:::
:::

::: {#rd-discovery-and-other-interface-independent-components}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [RD Discovery and Other Interface-Independent Components](#name-rd-discovery-and-other-inte){.section-name .selfRef} {#name-rd-discovery-and-other-inte}

This and the following sections define the required set of REST
interfaces between an RD, endpoints, and lookup clients. Although the
examples throughout these sections assume the use of CoAP
\[[RFC7252](#RFC7252){.xref}\], these REST interfaces can also be
realized using HTTP \[[RFC7230](#RFC7230){.xref}\]. The multicast
discovery and simple registration operations are exceptions to that, as
they rely on mechanisms unavailable in HTTP. In all definitions in these
sections, both CoAP response codes (with dot notation) and HTTP response
codes (without dot notation) are shown. An RD implementing this
specification [MUST]{.bcp14} support the discovery, registration,
update, lookup, and removal interfaces.[¶](#section-4-1){.pilcrow}

All operations on the contents of the RD [MUST]{.bcp14} be atomic and
idempotent.[¶](#section-4-2){.pilcrow}

For several operations, interface templates are given in list form;
those describe the operation participants, request codes, URIs, content
formats, and outcomes. Sections of those templates contain normative
content about Interaction, Method, URI Template, and URI Template
Variables, as well as the details of the Success condition. The
additional sections for options (such as Content-Format) and for Failure
codes give typical cases that an implementation of the RD should deal
with. Those serve to illustrate the typical responses to readers who are
not yet familiar with all the details of CoAP-based interfaces; they do
not limit how a server may respond under atypical
circumstances.[¶](#section-4-3){.pilcrow}

REST clients (registrant-EPs and CTs during registration and
maintenance, lookup clients, and RD servers during simple registrations)
must be prepared to receive any unsuccessful code and act upon it
according to its definition, options, and/or payload to the best of
their capabilities, falling back to failing the operation if recovery is
not possible. In particular, they [SHOULD]{.bcp14} retry the request
upon 5.03 (Service Unavailable; 503 in HTTP) according to the Max-Age
(Retry-After in HTTP) option and [SHOULD]{.bcp14} fall back to link
format when receiving 4.15 (Unsupported Content-Format; 415 in
HTTP).[¶](#section-4-4){.pilcrow}

An RD [MAY]{.bcp14} make the information submitted to it available to
further directories (subject to security policies on link
confidentiality) if it can ensure that a loop does not form. The
protocol used between directories to ensure loop-free operation is
outside the scope of this document.[¶](#section-4-5){.pilcrow}

::: {#finding_an_rd}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Finding a Resource Directory](#name-finding-a-resource-director){.section-name .selfRef} {#name-finding-a-resource-director}

A (re)starting device may want to find one or more RDs before it can
discover their URIs. Dependent on the operational conditions, one or
more of the techniques below apply.[¶](#section-4.1-1){.pilcrow}

The device may be preconfigured to exercise specific mechanisms for
finding the RD:[¶](#section-4.1-2){.pilcrow}

1.  [It may be configured with a specific IP address for the RD. That IP
    address may also be an anycast address, allowing the network to
    forward RD requests to an RD that is topologically close; each
    target network environment in which some of these preconfigured
    nodes are to be brought up is then configured with a route for this
    anycast address that leads to an appropriate RD. (Instead of using
    an anycast address, a multicast address can also be preconfigured.
    The RD servers then need to configure one of their interfaces with
    this multicast
    address.)[¶](#section-4.1-3.1){.pilcrow}]{#section-4.1-3.1}
2.  [It may be configured with a DNS name for the RD and use DNS to
    return the IP address of the RD; it can find a DNS server to perform
    the lookup using the usual mechanisms for finding DNS
    servers.[¶](#section-4.1-3.2){.pilcrow}]{#section-4.1-3.2}
3.  [It may be configured to use a service discovery mechanism, such as
    DNS-based Service Discovery (DNS-SD), as outlined in [Section
    4.1.2](#rd-using-dnssd){.xref}.[¶](#section-4.1-3.3){.pilcrow}]{#section-4.1-3.3}

For cases where the device is not specifically configured with a way to
find an RD, the network may want to provide a suitable
default.[¶](#section-4.1-4){.pilcrow}

1.  [The IPv6 Neighbor Discovery option RDAO ([Section
    4.1.1](#rdao){.xref}) can do
    that.[¶](#section-4.1-5.1){.pilcrow}]{#section-4.1-5.1}
2.  [When DHCP is in use, this could be provided via a DHCP option (no
    such option is defined at the time of
    writing).[¶](#section-4.1-5.2){.pilcrow}]{#section-4.1-5.2}

Finally, if neither the device nor the network offers any specific
configuration, the device may want to employ heuristics to find a
suitable RD.[¶](#section-4.1-6){.pilcrow}

The present specification does not fully define these heuristics but
suggests a number of candidates:[¶](#section-4.1-7){.pilcrow}

1.  [In a 6LoWPAN, just assume the 6LBR can act as an RD (using the
    Authoritative Border Router Option (ABRO) to find that
    \[[RFC6775](#RFC6775){.xref}\]). Confirmation can be obtained by
    sending a unicast GET to
    `coap://[6LBR]/.well-known/core?rt=core.rd*`.[¶](#section-4.1-8.1){.pilcrow}]{#section-4.1-8.1}
2.  [In a network that supports multicast well, discover the RD using a
    multicast query for `/.well-known/core`, as specified in CoRE Link
    Format \[[RFC6690](#RFC6690){.xref}\], and send a Multicast GET to
    `coap://[ff0x::fe]/.well-known/core?rt=core.rd*`. RDs within the
    multicast scope will answer the
    query.[¶](#section-4.1-8.2){.pilcrow}]{#section-4.1-8.2}

When answering a multicast request directed at a link-local group, the
RD may want to respond from a routable address; this makes it easier for
registrants to use one of their own routable addresses for registration.
When source addresses are selected using the mechanism described in
\[[RFC6724](#RFC6724){.xref}\], this can be achieved by applying the
changes of its Section
[10.4](https://www.rfc-editor.org/rfc/rfc6724#section-10.4){.relref},
picking public addresses in Rule 7 of its Section
[5](https://www.rfc-editor.org/rfc/rfc6724#section-5){.relref}, and
superseding Rule 8 with preferring the source address\'s
precedence.[¶](#section-4.1-9){.pilcrow}

As some of the RD addresses obtained by the methods listed here are just
(more or less educated) guesses, endpoints [MUST]{.bcp14} make use of
any error messages to very strictly rate-limit requests to candidate IP
addresses that don\'t work out. For example, an ICMP Destination
Unreachable message (and, in particular, the port unreachable code for
this message) may indicate the lack of a CoAP server on the candidate
host, or a CoAP error response code, such as 4.05 (Method Not Allowed),
may indicate unwillingness of a CoAP server to act as a directory
server.[¶](#section-4.1-10){.pilcrow}

The following RD discovery mechanisms are
recommended:[¶](#section-4.1-11){.pilcrow}

-   [In managed networks with border routers that need stand-alone
    operation, the RDAO is recommended (e.g., the operational phase
    described in [Section
    3.6](#automation){.xref}).[¶](#section-4.1-12.1){.pilcrow}]{#section-4.1-12.1}
-   [In managed networks without border routers (no Internet services
    available), the use of a preconfigured anycast address is
    recommended (e.g., the installation phase described in [Section
    3.6](#automation){.xref}).[¶](#section-4.1-12.2){.pilcrow}]{#section-4.1-12.2}
-   [In networks managed using DNS-SD, the use of DNS-SD for discovery,
    as described in [Section 4.1.2](#rd-using-dnssd){.xref}, is
    recommended.[¶](#section-4.1-12.3){.pilcrow}]{#section-4.1-12.3}

The use of multicast discovery in mesh networks is [NOT
RECOMMENDED]{.bcp14}.[¶](#section-4.1-13){.pilcrow}

::: {#rdao}
::: {#section-4.1.1 .section}
#### [4.1.1.](#section-4.1.1){.section-number .selfRef} [Resource Directory Address Option (RDAO)](#name-resource-directory-address-){.section-name .selfRef} {#name-resource-directory-address-}

The Resource Directory Address Option (RDAO) carries information about
the address of the RD in RAs (Router Advertisements) of IPv6 Neighbor
Discovery (ND), similar to how Recursive DNS Server (RDNSS) options
\[[RFC8106](#RFC8106){.xref}\] are sent. This information is needed when
endpoints cannot discover the RD with a link-local or realm-local scope
multicast address, for instance, because the endpoint and the RD are
separated by a 6LBR. In many circumstances, the availability of DHCP
cannot be guaranteed during commissioning of the network either. The
presence and the use of the RD is essential during
commissioning.[¶](#section-4.1.1-1){.pilcrow}

It is possible to send multiple RDAOs in one message, indicating as many
RD addresses.[¶](#section-4.1.1-2){.pilcrow}

The RDAO format is:[¶](#section-4.1.1-3){.pilcrow}

[]{#name-resource-directory-address-o}

::: {#fig-rdao}
::: {#section-4.1.1-4.1 .alignLeft .art-ascii-art .art-text .artwork}
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Type      |  Length = 3   |          Reserved             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Valid Lifetime                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    +                                                               +
    |                                                               |
    +                          RD Address                           +
    |                                                               |
    +                                                               +
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 4](#figure-4){.selfRef}: [Resource Directory Address
Option](#name-resource-directory-address-o){.selfRef}
:::

Fields:[¶](#section-4.1.1-5){.pilcrow}

[]{.break}

Type:
:   41[¶](#section-4.1.1-6.2){.pilcrow}
:   

Length:
:   8-bit unsigned integer. The length of the option in units of 8
    bytes. Always 3.[¶](#section-4.1.1-6.4){.pilcrow}
:   

Reserved:
:   This field is unused. It [MUST]{.bcp14} be initialized to zero by
    the sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.1.1-6.6){.pilcrow}
:   

Valid Lifetime:
:   32-bit unsigned integer. The length of time in seconds (relative to
    the time the packet is received) that this RD address is valid. A
    value of all zero bits (0x0) indicates that this RD address is not
    valid anymore.[¶](#section-4.1.1-6.8){.pilcrow}
:   

RD Address:
:   IPv6 address of the RD.[¶](#section-4.1.1-6.10){.pilcrow}
:   
:::
:::

::: {#rd-using-dnssd}
::: {#section-4.1.2 .section}
#### [4.1.2.](#section-4.1.2){.section-number .selfRef} [Using DNS-SD to Discover a Resource Directory](#name-using-dns-sd-to-discover-a-){.section-name .selfRef} {#name-using-dns-sd-to-discover-a-}

An RD can advertise its presence in DNS-SD
\[[RFC6763](#RFC6763){.xref}\] using the service names defined in this
document: `_core-rd._udp` (for CoAP), `_core-rd-dtls._udp` (for CoAP
over DTLS), `_core-rd._tcp` (for CoAP over TCP), or `_core-rd-tls._tcp`
(for CoAP over TLS). (For the WebSocket transports of CoAP, no service
is defined, as DNS-SD is typically unavailable in environments where
CoAP over WebSockets is used.)[¶](#section-4.1.2-1){.pilcrow}

The selection of the service indicates the protocol used, and the SRV
record points the client to a host name and port to use as a starting
point for the \"URI discovery\" steps of [Section
4.3](#discovery){.xref}.[¶](#section-4.1.2-2){.pilcrow}

This section is a simplified, concrete application of the more generic
mechanism specified in
\[[CORE-RD-DNS-SD](#I-D.ietf-core-rd-dns-sd){.xref}\].[¶](#section-4.1.2-3){.pilcrow}
:::
:::
:::
:::

::: {#payload-content-formats}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Payload Content Formats](#name-payload-content-formats){.section-name .selfRef} {#name-payload-content-formats}

RDs implementing this specification [MUST]{.bcp14} support the
`application/link-format` content format
(ct=40).[¶](#section-4.2-1){.pilcrow}

RDs implementing this specification [MAY]{.bcp14} support additional
content formats.[¶](#section-4.2-2){.pilcrow}

Any additional content format supported by an RD implementing this
specification [SHOULD]{.bcp14} be able to express all the information
expressible in link format. It [MAY]{.bcp14} be able to express
information that is inexpressible in link format, but those expressions
[SHOULD]{.bcp14} be avoided where possible.[¶](#section-4.2-3){.pilcrow}
:::
:::

::: {#discovery}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [URI Discovery](#name-uri-discovery){.section-name .selfRef} {#name-uri-discovery}

Before an endpoint can make use of an RD, it must first know the RD\'s
address and port and the URI path information for its REST APIs. This
section defines discovery of the RD and its URIs using the well-known
interface of the CoRE Link Format \[[RFC6690](#RFC6690){.xref}\] after
having discovered a host, as described in [Section
4.1](#finding_an_rd){.xref}.[¶](#section-4.3-1){.pilcrow}

Discovery of the RD registration URI is performed by sending either a
multicast or unicast GET request to `/.well-known/core` and including a
resource type (rt) parameter \[[RFC6690](#RFC6690){.xref}\] with the
value \"core.rd\" in the query string. Likewise, a resource type
parameter value of \"core.rd-lookup\*\" is used to discover the URIs for
RD lookup operations, and \"core.rd\*\" is used to discover all URIs for
RD operations. Upon success, the response will contain a payload with a
link format entry for each RD function discovered, indicating the URI of
the RD function returned and the corresponding resource type. When
performing multicast discovery, the multicast IP address used will
depend on the scope required and the multicast capabilities of the
network (see [Section
9.5](#mc-registration){.xref}).[¶](#section-4.3-2){.pilcrow}

An RD [MAY]{.bcp14} provide hints about the content formats it supports
in the links it exposes or registers, using the \"ct\" target attribute,
as shown in the example below. Clients [MAY]{.bcp14} use these hints to
select alternate content formats for interaction with the
RD.[¶](#section-4.3-3){.pilcrow}

HTTP does not support multicast, and, consequently, only unicast
discovery can be supported using the HTTP `/.well-known/core`
resource.[¶](#section-4.3-4){.pilcrow}

RDs implementing this specification [MUST]{.bcp14} support query
filtering for the rt parameter, as defined in
\[[RFC6690](#RFC6690){.xref}\].[¶](#section-4.3-5){.pilcrow}

While the link targets in this discovery step are often expressed in
path-absolute form, this is not a requirement. Clients of the RD
[SHOULD]{.bcp14} therefore accept URIs of all schemes they support, both
as URIs and relative references, and not limit the set of discovered
URIs to those hosted at the address used for URI
discovery.[¶](#section-4.3-6){.pilcrow}

With security policies where the client requires the RD to be authorized
to act as an RD, that authorization may be limited to resources on which
the authorized RD advertises the adequate resource types. Clients that
have obtained links they cannot rely on yet can repeat the \"URI
discovery\" step at the `/.well-known/core` resource of the indicated
host to obtain the resource type information from an authorized
source.[¶](#section-4.3-7){.pilcrow}

The URI discovery operation can yield multiple URIs of a given resource
type. The client of the RD can try out any of the discovered
addresses.[¶](#section-4.3-8){.pilcrow}

The discovery request interface is specified as follows (this is exactly
the well-known interface of \[[RFC6690](#RFC6690){.xref}\], [Section
4](https://www.rfc-editor.org/rfc/rfc6690#section-4){.relref}, with the
additional requirement that the server [MUST]{.bcp14} support query
filtering):[¶](#section-4.3-9){.pilcrow}

[]{.break}

Interaction:
:   EP, CT, or Client -\> RD[¶](#section-4.3-10.2){.pilcrow}
:   

Method:
:   GET[¶](#section-4.3-10.4){.pilcrow}
:   

URI Template:
:   `/.well-known/core{?rt}`[¶](#section-4.3-10.6){.pilcrow}
:   

URI Template Variables:

:   \

    []{.break}

    rt :=
    :   Resource Type. [SHOULD]{.bcp14} contain one of the values
        \"core.rd\", \"core.rd-lookup\*\", \"core.rd-lookup-res\",
        \"core.rd-lookup-ep\", or
        \"core.rd\*\"[¶](#section-4.3-10.8.2.2){.pilcrow}
    :   

:   

Accept:
:   absent, `application/link-format`, or any other media type
    representing web links[¶](#section-4.3-10.10){.pilcrow}
:   

The following response is expected on this
interface:[¶](#section-4.3-11){.pilcrow}

[]{.break}

Success:
:   2.05 (Content) or 200 (OK) with an `application/link-format` or
    other web link payload containing one or more matching entries for
    the RD resource.[¶](#section-4.3-12.2){.pilcrow}
:   

The following example shows an endpoint discovering an RD using this
interface, thus learning that the directory resource location in this
example is /rd and that the content format delivered by the server
hosting the resource is `application/link-format` (ct=40). Note that it
is up to the RD to choose its RD
locations.[¶](#section-4.3-13){.pilcrow}

[]{#name-example-discovery-exchange}

::: {#example-discovery}
::: {#section-4.3-14.1}
``` sourcecode
Req: GET coap://[ff02::fe]/.well-known/core?rt=core.rd*

Res: 2.05 Content
Payload:
</rd>;rt=core.rd;ct=40,
</rd-lookup/ep>;rt=core.rd-lookup-ep;ct=40,
</rd-lookup/res>;rt=core.rd-lookup-res;ct=40
```
:::

[Figure 5](#figure-5){.selfRef}: [Example Discovery
Exchange](#name-example-discovery-exchange){.selfRef}
:::

The following example shows the way of indicating that a client may
request alternate content formats. The Content-Format code attribute
\"ct\" [MAY]{.bcp14} include a space-separated sequence of
Content-Format codes, as specified in [Section
7.2.1](https://www.rfc-editor.org/rfc/rfc7252#section-7.2.1){.relref} of
\[[RFC7252](#RFC7252){.xref}\], indicating that multiple content formats
are available. The example below shows the required Content-Format 40
(`application/link-format`) indicated, as well as Concise Binary Object
Representation (CBOR) and JSON representations in the style of
\[[CORE-LINKS-JSON](#I-D.ietf-core-links-json){.xref}\] (for which the
experimental values 65060 and 65050 are used in this example). The RD
resource locations /rd and /rd-lookup are example values. The server in
this example also indicates that it is capable of providing observation
on resource lookups.[¶](#section-4.3-15){.pilcrow}

[]{#name-example-discovery-exchange-}

::: {#example-discovery-ct}
::: {#section-4.3-16.1}
``` sourcecode
Req: GET coap://[ff02::fe]/.well-known/core?rt=core.rd*

Res: 2.05 Content
Payload:
</rd>;rt=core.rd;ct=40,
</rd-lookup/res>;rt=core.rd-lookup-res;ct="40 65060 65050";obs,
</rd-lookup/ep>;rt=core.rd-lookup-ep;ct="40 65060 65050"
```
:::

[Figure 6](#figure-6){.selfRef}: [Example Discovery Exchange Indicating
Additional Content-Formats](#name-example-discovery-exchange-){.selfRef}
:::

For maintenance, management, and debugging, it can be useful to identify
the components that constitute the RD server. The identification can be
used to find client-server incompatibilities, supported features,
required updates, and other aspects. The well-known interface described
in [Section
4](https://www.rfc-editor.org/rfc/rfc6690#section-4){.relref} of
\[[RFC6690](#RFC6690){.xref}\] can be used to find such
data.[¶](#section-4.3-17){.pilcrow}

It would typically be stored in an implementation information link (as
described in
\[[T2TRG-REL-IMPL](#I-D.bormann-t2trg-rel-impl){.xref}\]).[¶](#section-4.3-18){.pilcrow}

[]{#name-example-exchange-of-obtaini}

::: {#example-impl-discovery}
::: {#section-4.3-19.1}
``` sourcecode
Req: GET /.well-known/core?rel=impl-info

Res: 2.05 Content
Payload:
<http://software.example.com/shiny-resource-directory/1.0beta1>;
    rel=impl-info
```
:::

[Figure 7](#figure-7){.selfRef}: [Example Exchange of Obtaining
Implementation Information Using the Relation Type Currently Proposed in
*\[T2TRG-REL-IMPL\]*](#name-example-exchange-of-obtaini){.selfRef}
:::

Note that, depending on the particular server\'s architecture, such a
link could be anchored at the RD server\'s root (as in this example) or
at individual RD components. The latter is to be expected when different
applications are run on the same server.[¶](#section-4.3-20){.pilcrow}
:::
:::
:::
:::

::: {#registration}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Registration](#name-registration){.section-name .selfRef} {#name-registration}

After discovering the location of an RD, a registrant-EP or CT
[MAY]{.bcp14} register the resources of the registrant-EP using the
registration interface. This interface accepts a POST from an endpoint
containing the list of resources to be added to the directory as the
message payload in the CoRE Link Format \[[RFC6690](#RFC6690){.xref}\]
or other representations of web links, along with query parameters
indicating the name of the endpoint and, optionally, the sector,
lifetime, and base URI of the registration. It is expected that other
specifications will define further parameters (see [Section
9.3](#iana-registry){.xref}). The RD then creates a new registration
resource in the RD and returns its location. The receiving endpoint
[MUST]{.bcp14} use that location when refreshing registrations using
this interface. Registration resources in the RD are kept active for the
period indicated by the lifetime parameter. The creating endpoint is
responsible for refreshing the registration resource within this period,
using either the registration or update interface. The registration
interface [MUST]{.bcp14} be implemented to be idempotent, so that
registering twice with the same endpoint parameters ep and d (sector)
does not create multiple registration
resources.[¶](#section-5-1){.pilcrow}

The following rules apply for a registration request targeting a given
(ep, d) value pair:[¶](#section-5-2){.pilcrow}

-   [When the (ep, d) value pair of the registration request is
    different from any existing registration, a new registration is
    generated.[¶](#section-5-3.1){.pilcrow}]{#section-5-3.1}
-   [When the (ep, d) value pair of the registration request is equal to
    an existing registration, the content and parameters of the existing
    registration are replaced with the content of the registration
    request. As with changes to registration resources, security
    policies ([Section 7](#policies){.xref}) usually require such
    requests to come from the same
    device.[¶](#section-5-3.2){.pilcrow}]{#section-5-3.2}

The posted link-format document can (and typically does) contain
relative references both in its link targets and in its anchors; it can
also contain empty anchors. The RD server needs to resolve these
references in order to faithfully represent them in lookups. They are
resolved against the base URI of the registration, which is provided
either explicitly in the `base` parameter or constructed implicitly from
the requester\'s URI, as constructed from its network address and
scheme.[¶](#section-5-4){.pilcrow}

For media types to which [Appendix C](#limitedlinkformat){.xref} applies
(i.e., documents in `application/link-format`), request bodies
[MUST]{.bcp14} be expressed in Limited Link
Format.[¶](#section-5-5){.pilcrow}

The registration request interface is specified as
follows:[¶](#section-5-6){.pilcrow}

[]{.break}

Interaction:
:   EP or CT -\> RD[¶](#section-5-7.2){.pilcrow}
:   

Method:
:   POST[¶](#section-5-7.4){.pilcrow}
:   

URI Template:
:   {+rd}{?ep,d,lt,base,extra-attrs\*}[¶](#section-5-7.6){.pilcrow}
:   

URI Template Variables:

:   \

    []{.break}

    rd :=
    :   RD registration URI (mandatory). This is the location of the RD,
        as obtained from discovery.[¶](#section-5-7.8.2.2){.pilcrow}
    :   

    ep :=

    :   Endpoint name (mostly mandatory). The endpoint name is an
        identifier that [MUST]{.bcp14} be unique within a
        sector.[¶](#section-5-7.8.2.4.1){.pilcrow}

        As the endpoint name is a Unicode string, it is encoded in UTF-8
        (and possibly percent encoded) during variable expansion (see
        \[[RFC6570](#RFC6570){.xref}\], [Section
        3.2.1](https://www.rfc-editor.org/rfc/rfc6570#section-3.2.1){.relref}).
        The endpoint name [MUST NOT]{.bcp14} contain any character in
        the inclusive ranges 0-31 or
        127-159.[¶](#section-5-7.8.2.4.2){.pilcrow}

        The maximum length of this parameter is 63 bytes encoded in
        UTF-8.[¶](#section-5-7.8.2.4.3){.pilcrow}

        If the RD is configured to recognize the endpoint that is to be
        authorized to use exactly one endpoint name, the RD assigns that
        name. In that case, giving the endpoint name becomes optional
        for the client; if the client gives any other endpoint name, it
        is not authorized to perform the
        registration.[¶](#section-5-7.8.2.4.4){.pilcrow}

    :   

    d :=

    :   Sector (optional). This is the sector to which this endpoint
        belongs. When this parameter is not present, the RD
        [MAY]{.bcp14} associate the endpoint with a configured default
        sector (possibly based on the endpoint\'s authorization) or
        leave it empty.[¶](#section-5-7.8.2.6.1){.pilcrow}

        The sector is encoded like the ep parameter and is limited to 63
        bytes encoded in UTF-8 as
        well.[¶](#section-5-7.8.2.6.2){.pilcrow}

    :   

    lt :=
    :   Lifetime (optional). This is the lifetime of the registration in
        seconds, with a range of 1-4294967295. If no lifetime is
        included in the initial registration, a default value of 90000
        (25 hours) [SHOULD]{.bcp14} be
        assumed.[¶](#section-5-7.8.2.8){.pilcrow}
    :   

    base :=

    :   Base URI (optional). This parameter sets the base URI of the
        registration, under which the relative links in the payload are
        to be interpreted. The specified URI typically does not have a
        path component of its own and [MUST]{.bcp14} be suitable as a
        base URI to resolve any relative references given in the
        registration. The parameter is therefore usually of the shape
        \"scheme://authority\" for HTTP and CoAP URIs. The URI [SHOULD
        NOT]{.bcp14} have a query or fragment component, as any
        non-empty relative part in a reference would remove those parts
        from the resulting URI.[¶](#section-5-7.8.2.10.1){.pilcrow}

        In the absence of this parameter, the scheme of the protocol,
        the source address, and the source port of the registration
        request are assumed. The base URI is consecutively constructed
        by concatenating the used protocol\'s scheme with the characters
        \"://\", the requester\'s source address as an address literal,
        and \":\" followed by its port (if it was not the protocol\'s
        default one). This is analogous to the process described in
        \[[RFC7252](#RFC7252){.xref}\], [Section
        6.5](https://www.rfc-editor.org/rfc/rfc7252#section-6.5){.relref}.[¶](#section-5-7.8.2.10.2){.pilcrow}

        This parameter is mandatory when the directory is filled by a
        third party, such as a commissioning
        tool.[¶](#section-5-7.8.2.10.3){.pilcrow}

        If the registrant-EP uses an ephemeral port to register with, it
        [MUST]{.bcp14} include the base parameter in the registration to
        provide a valid network
        path.[¶](#section-5-7.8.2.10.4){.pilcrow}

        A registrant that cannot be reached by potential lookup clients
        at the address it registers from (e.g., because it is behind
        some form of Network Address Translation (NAT)) [MUST]{.bcp14}
        provide a reachable base address with its
        registration.[¶](#section-5-7.8.2.10.5){.pilcrow}

        If the base URI contains a link-local IP literal, it [MUST
        NOT]{.bcp14} contain a Zone Identifier and [MUST]{.bcp14} be
        local to the link on which the registration request is
        received.[¶](#section-5-7.8.2.10.6){.pilcrow}

        Endpoints that register with a base that contains a path
        component cannot efficiently express their registrations in
        Limited Link Format ([Appendix C](#limitedlinkformat){.xref}).
        Those applications should use different representations of links
        to which [Appendix C](#limitedlinkformat){.xref} is not
        applicable (e.g.,
        \[[CORE-CORAL](#I-D.ietf-core-coral){.xref}\]).[¶](#section-5-7.8.2.10.7){.pilcrow}

    :   

    extra-attrs :=
    :   Additional registration attributes (optional). The endpoint can
        pass any parameter registered in [Section
        9.3](#iana-registry){.xref} to the directory. If the RD is aware
        of the parameter\'s specified semantics, it processes the
        parameter accordingly. Otherwise, it [MUST]{.bcp14} store the
        unknown key and its value(s) as an endpoint attribute for
        further lookup.[¶](#section-5-7.8.2.12){.pilcrow}
    :   

:   

Content-Format:
:   `application/link-format` or any other indicated media type
    representing web links[¶](#section-5-7.10){.pilcrow}
:   

The following response is expected on this
interface:[¶](#section-5-8){.pilcrow}

[]{.break}

Success:

:   2.01 (Created) or 201 (Created). The Location-Path option or
    Location header field [MUST]{.bcp14} be included in the response.
    This location [MUST]{.bcp14} be a stable identifier generated by the
    RD, as it is used for all subsequent operations on this registration
    resource. The registration resource location thus returned is for
    the purpose of updating the lifetime of the registration and for
    maintaining the content of the registered links, including updating
    and deleting links.[¶](#section-5-9.2.1){.pilcrow}

    A registration with an already-registered ep and d value pair
    responds with the same success code and location as the original
    registration; the set of links registered with the endpoint is
    replaced with the links from the
    payload.[¶](#section-5-9.2.2){.pilcrow}

    The location [MUST NOT]{.bcp14} have a query or fragment component,
    as that could conflict with query parameters during the registration
    update operation. Therefore, the Location-Query option [MUST
    NOT]{.bcp14} be present in a successful
    response.[¶](#section-5-9.2.3){.pilcrow}

:   

If the registration fails, including request timeouts, or if delays from
Service Unavailable responses with Max-Age or Retry-After accumulate to
exceed the registrant\'s configured timeouts, it [SHOULD]{.bcp14} pick
another registration URI from the \"URI discovery\" step of [Section
4.3](#discovery){.xref}, and, if there is only one or the list is
exhausted, pick other choices from the \"finding a resource directory\"
step of [Section 4.1](#finding_an_rd){.xref}. Care has to be taken to
consider the freshness of results obtained earlier, e.g., the result of
a `/.well-known/core` response, the lifetime of an RDAO, and DNS
responses. Any rate limits and persistent errors from the \"finding a
resource directory\" step must be considered for the whole registration
time, not only for a single operation.[¶](#section-5-10){.pilcrow}

The following example shows a registrant-EP with the name \"node1\"
registering two resources to an RD using this interface. The location
\"/rd\" is an example RD location discovered in a request similar to
[Figure 5](#example-discovery){.xref}.[¶](#section-5-11){.pilcrow}

[]{#name-example-registration-payloa}

::: {#example-payload}
::: {#section-5-12.1}
``` sourcecode
Req: POST coap://rd.example.com/rd?ep=node1
Content-Format: 40
Payload:
</sensors/temp>;rt=temperature-c;if=sensor,
<http://www.example.com/sensors/temp>;
  anchor="/sensors/temp";rel=describedby

Res: 2.01 Created
Location-Path: /rd/4521
```
:::

[Figure 8](#figure-8){.selfRef}: [Example Registration
Payload](#name-example-registration-payloa){.selfRef}
:::

An RD may optionally support HTTP. Here is an example of almost the same
registration operation above when done using
HTTP.[¶](#section-5-13){.pilcrow}

[]{#name-example-registration-payload}

::: {#example-payload-http}
::: {#section-5-14.1}
``` sourcecode
Req:
POST /rd?ep=node1&base=http://[2001:db8:1::1] HTTP/1.1
Host: rd.example.com
Content-Type: application/link-format

</sensors/temp>;rt=temperature-c;if=sensor,
<http://www.example.com/sensors/temp>;
  anchor="/sensors/temp";rel=describedby

Res:
HTTP/1.1 201 Created
Location: /rd/4521
```
:::

[Figure 9](#figure-9){.selfRef}: [Example Registration Payload as
Expressed Using HTTP](#name-example-registration-payload){.selfRef}
:::

::: {#simple}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Simple Registration](#name-simple-registration){.section-name .selfRef} {#name-simple-registration}

Not all endpoints hosting resources are expected to know how to upload
links to an RD, as described in [Section 5](#registration){.xref}.
Instead, simple endpoints can implement the simple registration approach
described in this section. An RD implementing this specification
[MUST]{.bcp14} implement simple registration. However, there may be
security reasons why this form of directory discovery would be
disabled.[¶](#section-5.1-1){.pilcrow}

This approach requires that the registrant-EP makes available the hosted
resources that it wants to be discovered as links on its
`/.well-known/core` interface, as specified in
\[[RFC6690](#RFC6690){.xref}\]. The links in that document are subject
to the same limitations as the payload of a registration (with respect
to [Appendix
C](#limitedlinkformat){.xref}).[¶](#section-5.1-2){.pilcrow}

-   [The registrant-EP finds one or more addresses of the directory
    server, as described in [Section
    4.1](#finding_an_rd){.xref}.[¶](#section-5.1-3.1){.pilcrow}]{#section-5.1-3.1}

-   ::: {#section-5.1-3.2}
    The registrant-EP sends (and regularly refreshes with) a POST
    request to the `/.well-known/rd` URI of the directory server of
    choice. The body of the POST request is empty and triggers the
    resource directory server to perform GET requests (redone before
    lifetime expiry) at the requesting registrant-EP\'s
    `/.well-known/core` to obtain the link-format payload to
    register.[¶](#section-5.1-3.2.1){.pilcrow}

    The registrant-EP includes the same registration parameters in the
    POST request as it would with a regular registration, per [Section
    5](#registration){.xref}. The registration base URI of the
    registration is taken from the registrant-EP\'s network address (as
    is default with regular
    registrations).[¶](#section-5.1-3.2.2){.pilcrow}

    The following is an example request from the registrant-EP to the RD
    (unanswered until the next step):[¶](#section-5.1-3.2.3){.pilcrow}

    []{#name-first-half-example-exchange}
    ::: {#example-simple1}
    ::: {#section-5.1-3.2.4.1}
    ``` sourcecode
    Req: POST /.well-known/rd?lt=6000&ep=node1
    (No payload)
    ```
    :::

    [Figure 10](#figure-10){.selfRef}: [First-Half Example Exchange of a
    Simple Registration](#name-first-half-example-exchange){.selfRef}
    :::
    :::

-   ::: {#section-5.1-3.3}
    The RD queries the registrant-EP\'s discovery resource to determine
    the success of the operation. It [SHOULD]{.bcp14} keep a cache of
    the discovery resource and not query it again as long as it is
    fresh.[¶](#section-5.1-3.3.1){.pilcrow}

    The following is an example request from the RD to the
    registrant-EP:[¶](#section-5.1-3.3.2){.pilcrow}

    []{#name-example-exchange-of-the-rd-}
    ::: {#example-simple2}
    ::: {#section-5.1-3.3.3.1}
    ``` sourcecode
    Req: GET /.well-known/core
    Accept: 40

    Res: 2.05 Content
    Content-Format: 40
    Payload:
    </sen/temp>
    ```
    :::

    [Figure 11](#figure-11){.selfRef}: [Example Exchange of the RD
    Querying the Simple
    Endpoint](#name-example-exchange-of-the-rd-){.selfRef}
    :::
    :::

With this response, the RD would answer the previous step\'s
request:[¶](#section-5.1-4){.pilcrow}

[]{#name-second-half-example-exchang}

::: {#example-simple3}
::: {#section-5.1-5.1}
``` sourcecode
Res: 2.04 Changed
```
:::

[Figure 12](#figure-12){.selfRef}: [Second-Half Example Exchange of a
Simple Registration](#name-second-half-example-exchang){.selfRef}
:::

The sequence of fetching the registration content before sending a
successful response was chosen to make responses reliable, and the point
about caching was chosen to still allow very constrained registrants.
Registrants [MUST]{.bcp14} be able to serve a GET request to
`/.well-known/core` after having requested registration. Constrained
devices [MAY]{.bcp14} regard the initial request as temporarily failed
when they need RAM occupied by their own request to serve the RD\'s GET
and retry later when the RD already has a cached representation of their
discovery resources. Then, the RD can reply immediately, and the
registrant can receive the response.[¶](#section-5.1-6){.pilcrow}

The simple registration request interface is specified as
follows:[¶](#section-5.1-7){.pilcrow}

[]{.break}

Interaction:
:   EP -\> RD[¶](#section-5.1-8.2){.pilcrow}
:   

Method:
:   POST[¶](#section-5.1-8.4){.pilcrow}
:   

URI Template:
:   `/.well-known/rd{?ep,d,lt,extra-attrs*}`[¶](#section-5.1-8.6){.pilcrow}
:   

URI Template Variables are the same as for registration in [Section
5](#registration){.xref}. The base attribute is not accepted to keep the
registration interface simple; that rules out registration over
CoAP-over-TCP or HTTP that would need to specify one. For some time
during this document\'s development, the URI Template
`/.well-known/core{?ep,...}` was in use
instead.[¶](#section-5.1-9){.pilcrow}

The following response is expected on this
interface:[¶](#section-5.1-10){.pilcrow}

[]{.break}

Success:
:   2.04 (Changed)[¶](#section-5.1-11.2){.pilcrow}
:   

For the second interaction triggered by the above, the registrant-EP
takes the role of server and the RD takes the role of client. (Note that
this is exactly the well-known interface of
\[[RFC6690](#RFC6690){.xref}\], [Section
4](https://www.rfc-editor.org/rfc/rfc6690#section-4){.relref}):[¶](#section-5.1-12){.pilcrow}

[]{.break}

Interaction:
:   RD -\> EP[¶](#section-5.1-13.2){.pilcrow}
:   

Method:
:   GET[¶](#section-5.1-13.4){.pilcrow}
:   

URI Template:
:   `/.well-known/core`[¶](#section-5.1-13.6){.pilcrow}
:   

The following response is expected on this
interface:[¶](#section-5.1-14){.pilcrow}

[]{.break}

Success:
:   2.05 (Content)[¶](#section-5.1-15.2){.pilcrow}
:   

When the RD uses any authorization credentials to access the endpoint\'s
discovery resource or when it is deployed in a location where third
parties might reach it but not the endpoint, it [SHOULD]{.bcp14} verify
that the apparent registrant-EP intends to register with the given
registration parameters before revealing the obtained discovery
information to lookup clients. An easy way to do that is to verify the
simple registration request\'s sender address using the Echo option, as
described in \[[RFC9175](#RFC9175){.xref}\], [Section
2.4](https://www.rfc-editor.org/rfc/rfc9175#section-2.4){.relref}.[¶](#section-5.1-16){.pilcrow}

The RD [MUST]{.bcp14} delete registrations created by simple
registration after the expiration of their lifetime. Additional
operations on the registration resource cannot be executed because no
registration location is returned.[¶](#section-5.1-17){.pilcrow}
:::
:::

::: {#third-party-registration}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Third-Party Registration](#name-third-party-registration){.section-name .selfRef} {#name-third-party-registration}

For some applications, even simple registration may be too taxing for
some very constrained devices, in particular, if the security
requirements become too onerous.[¶](#section-5.2-1){.pilcrow}

In a controlled environment (e.g., building control), the RD can be
filled by a third-party device, called a Commissioning Tool (CT). The CT
can fill the RD from a database or other means. For that purpose scheme,
the IP address and port of the URI of the registered device is the value
of the \"base\" parameter of the registration described in [Section
5](#registration){.xref}.[¶](#section-5.2-2){.pilcrow}

It should be noted that the value of the \"base\" parameter applies to
all the links of the registration and has consequences for the anchor
value of the individual links, as exemplified in [Appendix
B](#weblink){.xref}. A potential (currently nonexistent) \"base\"
attribute of the link is not affected by the value of \"base\" parameter
in the registration.[¶](#section-5.2-3){.pilcrow}
:::
:::

::: {#operations-on-the-registration-resource}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Operations on the Registration Resource](#name-operations-on-the-registrat){.section-name .selfRef} {#name-operations-on-the-registrat}

This section describes how the registering endpoint can maintain the
registrations that it created. The registering endpoint can be the
registrant-EP or the CT. The registrations are resources of the
RD.[¶](#section-5.3-1){.pilcrow}

An endpoint should not use this interface for registrations that it did
not create. This is usually enforced by security policies, which, in
general, require equivalent credentials for creation of and operations
on a registration.[¶](#section-5.3-2){.pilcrow}

After the initial registration, the registering endpoint retains the
returned location of the registration resource for further operations,
including refreshing the registration in order to extend the lifetime
and \"keep-alive\" the registration. When the lifetime of the
registration has expired, the RD [SHOULD NOT]{.bcp14} respond to
discovery queries concerning this endpoint. The RD [SHOULD]{.bcp14}
continue to provide access to the registration resource after a
registration timeout occurs in order to enable the registering endpoint
to eventually refresh the registration. The RD [MAY]{.bcp14} eventually
remove the registration resource for the purpose of garbage collection.
If the registration resource is removed, the corresponding endpoint will
need to be reregistered.[¶](#section-5.3-3){.pilcrow}

The registration resource may also be used to cancel the registration
using DELETE and to perform further operations beyond the scope of this
specification.[¶](#section-5.3-4){.pilcrow}

Operations on the registration resource are sensitive to reordering;
[Section 5.3.4](#freshness){.xref} describes how order is
restored.[¶](#section-5.3-5){.pilcrow}

The operations on the registration resource are described
below.[¶](#section-5.3-6){.pilcrow}

::: {#update}
::: {#section-5.3.1 .section}
#### [5.3.1.](#section-5.3.1){.section-number .selfRef} [Registration Update](#name-registration-update){.section-name .selfRef} {#name-registration-update}

The update interface is used by the registering endpoint to refresh or
update its registration with an RD. To use the interface, the
registering endpoint sends a POST request to the registration resource
returned by the initial registration
operation.[¶](#section-5.3.1-1){.pilcrow}

An update [MAY]{.bcp14} update registration parameters, such as
lifetime, base URI, or others. Parameters that are not being changed
should not be included in an update. Adding parameters that have not
changed increases the size of the message but does not have any other
implications. Parameters are included as query parameters in an update
operation, as in [Section
5](#registration){.xref}.[¶](#section-5.3.1-2){.pilcrow}

A registration update resets the timeout of the registration to the
(possibly updated) lifetime of the registration, independent of whether
an `lt` parameter was given.[¶](#section-5.3.1-3){.pilcrow}

If the base URI of the registration is changed in an update, relative
references submitted in the original registration or later updates are
resolved anew against the new base.[¶](#section-5.3.1-4){.pilcrow}

The registration update operation only describes the use of POST with an
empty payload. Future standards might describe the semantics of using
content formats and payloads with the POST method to update the links of
a registration (see [Section
5.3.3](#link-up){.xref}).[¶](#section-5.3.1-5){.pilcrow}

The update registration request interface is specified as
follows:[¶](#section-5.3.1-6){.pilcrow}

[]{.break}

Interaction:
:   EP or CT -\> RD[¶](#section-5.3.1-7.2){.pilcrow}
:   

Method:
:   POST[¶](#section-5.3.1-7.4){.pilcrow}
:   

URI Template:
:   {+location}{?lt,base,extra-attrs\*}[¶](#section-5.3.1-7.6){.pilcrow}
:   

URI Template Variables:

:   \

    []{.break}

    location :=
    :   This is the location returned by the RD as a result of a
        successful earlier
        registration.[¶](#section-5.3.1-7.8.2.2){.pilcrow}
    :   

    lt :=
    :   Lifetime (optional). This is the lifetime of the registration in
        seconds, with a range of 1-4294967295. If no lifetime is
        included, the previous last lifetime set on a previous update or
        the original registration (falling back to 90000)
        [SHOULD]{.bcp14} be used.[¶](#section-5.3.1-7.8.2.4){.pilcrow}
    :   

    base :=

    :   Base URI (optional). This parameter updates the base URI
        established in the original registration to a new value and is
        subject to the same restrictions as in the
        registration.[¶](#section-5.3.1-7.8.2.6.1){.pilcrow}

        If the parameter is set in an update, it is stored by the RD as
        the new base URI under which to interpret the relative links
        present in the payload of the original
        registration.[¶](#section-5.3.1-7.8.2.6.2){.pilcrow}

        If the parameter is not set in the request but was set before,
        the previous base URI value is kept
        unmodified.[¶](#section-5.3.1-7.8.2.6.3){.pilcrow}

        If the parameter is not set in the request and was not set
        before either, the source address and source port of the update
        request are stored as the base
        URI.[¶](#section-5.3.1-7.8.2.6.4){.pilcrow}

    :   

    extra-attrs :=

    :   Additional registration attributes (optional). As with the
        registration, the RD processes them if it knows their semantics.
        Otherwise, unknown attributes are stored as endpoint attributes,
        overriding any previously stored endpoint attributes of the same
        key.[¶](#section-5.3.1-7.8.2.8.1){.pilcrow}

        Note that this default behavior does not allow removing an
        endpoint attribute in an update. For attributes whose
        functionality depends on the endpoints\' ability to remove them
        in an update, it can make sense to define a value whose presence
        is equivalent to the absence of a value. As an alternative, an
        extension can define different updating rules for their
        attributes. That necessitates either discovering whether the RD
        is aware of that extension or tolerating the default
        behavior.[¶](#section-5.3.1-7.8.2.8.2){.pilcrow}

    :   

:   

Content-Format:
:   none (no payload)[¶](#section-5.3.1-7.10){.pilcrow}
:   

The following responses are expected on this
interface:[¶](#section-5.3.1-8){.pilcrow}

[]{.break}

Success:
:   2.04 (Changed) or 204 (No Content) if the update was successfully
    processed.[¶](#section-5.3.1-9.2){.pilcrow}
:   

Failure:
:   4.04 (Not Found) or 404 (Not Found). Registration does not exist
    (e.g., may have been removed).[¶](#section-5.3.1-9.4){.pilcrow}
:   

If the registration update fails in any way, including \"Not Found\" and
request timeouts, or if the time indicated in a Service Unavailable
Max-Age/Retry-After exceeds the remaining lifetime, the registering
endpoint [SHOULD]{.bcp14} attempt registration
again.[¶](#section-5.3.1-10){.pilcrow}

The following example shows how the registering endpoint resets the
timeout on its registration resource at an RD using this interface with
the example location value /rd/4521:[¶](#section-5.3.1-11){.pilcrow}

[]{#name-example-update-of-a-registr}

::: {#example-update}
::: {#section-5.3.1-12.1}
``` sourcecode
Req: POST /rd/4521

Res: 2.04 Changed
```
:::

[Figure 13](#figure-13){.selfRef}: [Example Update of a
Registration](#name-example-update-of-a-registr){.selfRef}
:::

The following example shows the registering endpoint updating its
registration resource at an RD using this interface with the example
location value /rd/4521. The initial registration by the registering
endpoint set the following values:[¶](#section-5.3.1-13){.pilcrow}

-   [endpoint name
    (ep)=endpoint1[¶](#section-5.3.1-14.1){.pilcrow}]{#section-5.3.1-14.1}
-   [lifetime
    (lt)=500[¶](#section-5.3.1-14.2){.pilcrow}]{#section-5.3.1-14.2}
-   [base URI
    (base)=coap://local-proxy-old.example.com[¶](#section-5.3.1-14.3){.pilcrow}]{#section-5.3.1-14.3}
-   [payload of [Figure
    8](#example-payload){.xref}[¶](#section-5.3.1-14.4){.pilcrow}]{#section-5.3.1-14.4}

The initial state of the RD is reflected in the following
request:[¶](#section-5.3.1-15){.pilcrow}

[]{#name-example-lookup-before-a-cha}

::: {#example-update-base-lookup-pre}
::: {#section-5.3.1-16.1}
``` sourcecode
Req: GET /rd-lookup/res?ep=endpoint1

Res: 2.05 Content
Payload:
<coap://local-proxy-old.example.com/sensors/temp>;
    rt=temperature-c;if=sensor,
<http://www.example.com/sensors/temp>;
    anchor="coap://local-proxy-old.example.com/sensors/temp";
    rel=describedby
```
:::

[Figure 14](#figure-14){.selfRef}: [Example Lookup Before a Change to
the Base Address](#name-example-lookup-before-a-cha){.selfRef}
:::

The following example shows the registering endpoint changing the base
URI to `coaps://new.example.com:5684`:[¶](#section-5.3.1-17){.pilcrow}

[]{#name-example-registration-update}

::: {#example-update-base}
::: {#section-5.3.1-18.1}
``` sourcecode
Req: POST /rd/4521?base=coaps://new.example.com

Res: 2.04 Changed
```
:::

[Figure 15](#figure-15){.selfRef}: [Example Registration Update that
Changes the Base Address](#name-example-registration-update){.selfRef}
:::

The consecutive query returns:[¶](#section-5.3.1-19){.pilcrow}

[]{#name-example-lookup-after-a-chan}

::: {#example-update-base-lookup-post}
::: {#section-5.3.1-20.1}
``` sourcecode
Req: GET /rd-lookup/res?ep=endpoint1

Res: 2.05 Content
Payload:
<coaps://new.example.com/sensors/temp>;
    rt=temperature-c;if=sensor,
<http://www.example.com/sensors/temp>;
    anchor="coaps://new.example.com/sensors/temp";
    rel=describedby
```
:::

[Figure 16](#figure-16){.selfRef}: [Example Lookup After a Change to the
Base Address](#name-example-lookup-after-a-chan){.selfRef}
:::
:::
:::

::: {#removal}
::: {#section-5.3.2 .section}
#### [5.3.2.](#section-5.3.2){.section-number .selfRef} [Registration Removal](#name-registration-removal){.section-name .selfRef} {#name-registration-removal}

Although RD registrations have soft state and will eventually time out
after their lifetime, the registering endpoint [SHOULD]{.bcp14}
explicitly remove an entry from the RD if it knows it will no longer be
available (for example, on shutdown). This is accomplished using a
removal interface on the RD by performing a DELETE on the endpoint
resource.[¶](#section-5.3.2-1){.pilcrow}

The removal request interface is specified as
follows:[¶](#section-5.3.2-2){.pilcrow}

[]{.break}

Interaction:
:   EP or CT -\> RD[¶](#section-5.3.2-3.2){.pilcrow}
:   

Method:
:   DELETE[¶](#section-5.3.2-3.4){.pilcrow}
:   

URI Template:
:   {+location}[¶](#section-5.3.2-3.6){.pilcrow}
:   

URI Template Variables:

:   \

    []{.break}

    location :=
    :   This is the location returned by the RD as a result of a
        successful earlier
        registration.[¶](#section-5.3.2-3.8.2.2){.pilcrow}
    :   

:   

The following responses are expected on this
interface:[¶](#section-5.3.2-4){.pilcrow}

[]{.break}

Success:
:   2.02 (Deleted) or 204 (No Content) upon successful
    deletion.[¶](#section-5.3.2-5.2){.pilcrow}
:   

Failure:
:   4.04 (Not Found) or 404 (Not Found). Registration does not exist
    (e.g., may already have been
    removed).[¶](#section-5.3.2-5.4){.pilcrow}
:   

The following example shows successful removal of the endpoint from the
RD with example location value /rd/4521:[¶](#section-5.3.2-6){.pilcrow}

[]{#name-example-of-a-registration-r}

::: {#example-removal}
::: {#section-5.3.2-7.1}
``` sourcecode
Req: DELETE /rd/4521

Res: 2.02 Deleted
```
:::

[Figure 17](#figure-17){.selfRef}: [Example of a Registration
Removal](#name-example-of-a-registration-r){.selfRef}
:::
:::
:::

::: {#link-up}
::: {#section-5.3.3 .section}
#### [5.3.3.](#section-5.3.3){.section-number .selfRef} [Further Operations](#name-further-operations){.section-name .selfRef} {#name-further-operations}

Additional operations on the registration can be specified in future
documents, for example:[¶](#section-5.3.3-1){.pilcrow}

-   [Send iPATCH (or PATCH) updates \[[RFC8132](#RFC8132){.xref}\] to
    add, remove, or change the links of a
    registration.[¶](#section-5.3.3-2.1){.pilcrow}]{#section-5.3.3-2.1}
-   [Use GET to read the currently stored set of links in a registration
    resource.[¶](#section-5.3.3-2.2){.pilcrow}]{#section-5.3.3-2.2}

Those operations are out of scope of this document and will require
media types suitable for modifying sets of
links.[¶](#section-5.3.3-3){.pilcrow}
:::
:::

::: {#freshness}
::: {#section-5.3.4 .section}
#### [5.3.4.](#section-5.3.4){.section-number .selfRef} [Request Freshness](#name-request-freshness){.section-name .selfRef} {#name-request-freshness}

Some security mechanisms usable with an RD allow out-of-order request
processing or do not even mandate replay protection at all. The RD needs
to ensure that operations on the registration resource are executed in
an order that does not distort the client\'s
intentions.[¶](#section-5.3.4-1){.pilcrow}

This ordering of operations is expressed in terms of freshness, as
defined in \[[RFC9175](#RFC9175){.xref}\]. Requests that alter a
resource\'s state need to be fresh relative to the latest request that
altered that state in a conflicting way.[¶](#section-5.3.4-2){.pilcrow}

An RD [SHOULD]{.bcp14} determine a request\'s freshness and
[MUST]{.bcp14} use the Echo option if it requires request freshness and
cannot determine it in any other way. An endpoint [MUST]{.bcp14} support
the use of the Echo option. (One reason why an RD would not require
freshness is when no relevant registration properties are covered by its
security policies.)[¶](#section-5.3.4-3){.pilcrow}

::: {#efficient-use-of-echo-by-an-rd}
::: {#section-5.3.4.1 .section}
##### [5.3.4.1.](#section-5.3.4.1){.section-number .selfRef} [Efficient Use of Echo by an RD](#name-efficient-use-of-echo-by-an){.section-name .selfRef} {#name-efficient-use-of-echo-by-an}

To keep latency and traffic added by the freshness requirements to a
minimum, RDs should avoid naive (sufficient but inefficient) freshness
criteria.[¶](#section-5.3.4.1-1){.pilcrow}

Some simple mechanisms the RD can employ
are:[¶](#section-5.3.4.1-2){.pilcrow}

-   ::: {#section-5.3.4.1-3.1}
    State counter. The RD can keep a monotonous counter that increments
    whenever a registration changes. For every registration resource, it
    stores the post-increment value of that resource\'s last change.
    Requests altering them need to have at least that value encoded in
    their Echo option and are otherwise rejected with a 4.01
    (Unauthorized) and the current counter value as the Echo value. If
    other applications on the same server use Echo as well, that
    encoding may include a prefix indicating that it pertains to the
    RD\'s counter.[¶](#section-5.3.4.1-3.1.1){.pilcrow}

    The value associated with a resource needs to be kept across the
    removal of registrations if the same registration resource is to be
    reused.[¶](#section-5.3.4.1-3.1.2){.pilcrow}

    The counter can be reset (and the values of removed resources
    forgotten) when all previous security associations are
    reset.[¶](#section-5.3.4.1-3.1.3){.pilcrow}

    This is the \"Persistent Counter\" method of
    \[[RFC9175](#RFC9175){.xref}\], [Appendix
    A](https://www.rfc-editor.org/rfc/rfc9175#appendix-A){.relref}.[¶](#section-5.3.4.1-3.1.4){.pilcrow}
    :::

-   ::: {#section-5.3.4.1-3.2}
    Preemptive Echo values. The current state counter can be sent in an
    Echo option not only when requests are rejected with 4.01
    (Unauthorized) but also with successful responses. Thus, clients can
    be provided with Echo values sufficient for their next request on a
    regular basis. This is also described in [Section
    2.3](https://www.rfc-editor.org/rfc/rfc9175#section-2.3){.relref} of
    \[[RFC9175](#RFC9175){.xref}\][¶](#section-5.3.4.1-3.2.1){.pilcrow}

    While endpoints may discard received Echo values at leisure between
    requests, they are encouraged to retain these values for the next
    request to avoid additional round
    trips.[¶](#section-5.3.4.1-3.2.2){.pilcrow}
    :::

-   [If the RD can ensure that only one security association has
    modifying access to any registration at any given time and that
    security association provides order on the requests, that order is
    sufficient to show request
    freshness.[¶](#section-5.3.4.1-3.3){.pilcrow}]{#section-5.3.4.1-3.3}
:::
:::

::: {#examples-of-echo-usage}
::: {#section-5.3.4.2 .section}
##### [5.3.4.2.](#section-5.3.4.2){.section-number .selfRef} [Examples of Echo Usage](#name-examples-of-echo-usage){.section-name .selfRef} {#name-examples-of-echo-usage}

[Figure 18](#example-freshness){.xref} shows the interactions of an
endpoint that has forgotten the server\'s latest Echo value and
temporarily reduces its registration
lifetime:[¶](#section-5.3.4.2-1){.pilcrow}

[]{#name-example-update-of-a-registra}

::: {#example-freshness}
::: {#section-5.3.4.2-2.1}
``` sourcecode
Req: POST /rd/4521?lt=7200

Res: 4.01 Unauthorized
Echo: 0x0123

(EP tries again immediately.)

Req: POST /rd/4521?lt=7200
Echo: 0x0123

Res: 2.04 Changed
Echo: 0x0124

(Later, the EP regains its confidence in its long-term reachability.)

Req: POST /rd/4521?lt=90000
Echo: 0x0124

Res: 2.04 Changed
Echo: 0x0247
```
:::

[Figure 18](#figure-18){.selfRef}: [Example Update of a
Registration](#name-example-update-of-a-registra){.selfRef}
:::

The other examples do not show Echo options for two reasons: (1) for
simplicity and (2) because they lack the context for any example values
to have meaning.[¶](#section-5.3.4.2-3){.pilcrow}
:::
:::
:::
:::
:::
:::
:::
:::

::: {#lookup}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [RD Lookup](#name-rd-lookup){.section-name .selfRef} {#name-rd-lookup}

To discover the resources registered with the RD, a lookup interface
must be provided. This lookup interface is defined as a default, and it
is assumed that RDs may also support lookups to return resource
descriptions in alternative formats (e.g., JSON or CBOR link format
\[[CORE-LINKS-JSON](#I-D.ietf-core-links-json){.xref}\]) or use more
advanced interfaces (e.g., supporting context- or semantic-based lookup)
on different resources that are discovered
independently.[¶](#section-6-1){.pilcrow}

RD lookup allows lookups for endpoints and resources using attributes
defined in this document and for use with the CoRE Link Format. The
result of a lookup request is the list of links (if any) corresponding
to the type of lookup. Thus, an endpoint lookup [MUST]{.bcp14} return a
list of endpoints, and a resource lookup [MUST]{.bcp14} return a list of
links to resources.[¶](#section-6-2){.pilcrow}

The lookup type implemented by a lookup resource is indicated by a
resource type, as per [Table
1](#lookup-types){.xref}:[¶](#section-6-3){.pilcrow}

[]{#name-lookup-types}

::: {#lookup-types}
  Lookup Type   Resource Type        Mandatory
  ------------- -------------------- -----------
  Resource      core.rd-lookup-res   Mandatory
  Endpoint      core.rd-lookup-ep    Mandatory

  : [Table 1](#table-1){.selfRef}: [Lookup
  Types](#name-lookup-types){.selfRef}
:::

::: {#resource-lookup}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Resource Lookup](#name-resource-lookup){.section-name .selfRef} {#name-resource-lookup}

Resource lookup results in links that are semantically equivalent to the
links submitted to the RD by the registrant. The links and link
parameters returned by the lookup are equal to the originally submitted
ones, except that the target reference is fully resolved and that the
anchor reference is fully resolved if it is present in the lookup result
at all.[¶](#section-6.1-1){.pilcrow}

Links that did not have an anchor attribute in the registration are
returned without an anchor attribute. Links of which href or anchor was
submitted as a (full) URI are returned with the respective attribute
unmodified.[¶](#section-6.1-2){.pilcrow}

The above rules allow the client to interpret the response as links
without any further knowledge of the storage conventions of the RD. The
RD [MAY]{.bcp14} replace the registration base URIs with a configured
intermediate proxy, e.g., in the case of an HTTP lookup interface for
CoAP endpoints.[¶](#section-6.1-3){.pilcrow}

If the base URI of a registration contains a link-local address, the RD
[MUST NOT]{.bcp14} show its links unless the lookup was made from the
link on which the registered endpoint can be reached. The RD [MUST
NOT]{.bcp14} include zone identifiers in the resolved
URIs.[¶](#section-6.1-4){.pilcrow}
:::
:::

::: {#lookup-filtering}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Lookup Filtering](#name-lookup-filtering){.section-name .selfRef} {#name-lookup-filtering}

Using the Accept option, the requester can control whether the returned
list is returned in CoRE Link Format (`application/link-format`,
default) or in alternate content formats (e.g., from
\[[CORE-LINKS-JSON](#I-D.ietf-core-links-json){.xref}\]).[¶](#section-6.2-1){.pilcrow}

Multiple search criteria [MAY]{.bcp14} be included in a lookup. All
included criteria [MUST]{.bcp14} match for a link to be returned. The RD
[MUST]{.bcp14} support matching with multiple search
criteria.[¶](#section-6.2-2){.pilcrow}

A link matches a search criterion if it has an attribute of the same
name and the same value, allowing for a trailing \"\*\" wildcard
operator, as in [Section
4.1](https://www.rfc-editor.org/rfc/rfc6690#section-4.1){.relref} of
\[[RFC6690](#RFC6690){.xref}\]. Attributes that are defined as
`relation-types` (in the link-format ABNF) match if the search value
matches any of their values (see [Section
4.1](https://www.rfc-editor.org/rfc/rfc6690#section-4.1){.relref} of
\[[RFC6690](#RFC6690){.xref}\]; for example,
`?if=tag:example.net,2020:sensor` matches
`;if="example.regname tag:example.net,2020:sensor";`. A resource link
also matches a search criterion if its endpoint would match the
criterion, and vice versa, an endpoint link matches a search criterion
if any of its resource links matches it.[¶](#section-6.2-3){.pilcrow}

Note that `href` is a valid search criterion and matches target
references. Like all search criteria, on a resource lookup, it can match
the target reference of the resource link itself but also the
registration resource of the endpoint that registered it. Queries for
resource link targets [MUST]{.bcp14} be in URI form (i.e., not relative
references) and are matched against a resolved link target. Queries for
endpoints [SHOULD]{.bcp14} be expressed in path-absolute form if
possible and [MUST]{.bcp14} be expressed in URI form otherwise; the RD
[SHOULD]{.bcp14} recognize either. The `anchor` attribute is usable for
resource lookups and, if queried, [MUST]{.bcp14} be in URI form as
well.[¶](#section-6.2-4){.pilcrow}

Additional query parameters \"page\" and \"count\" are used to obtain
lookup results in specified increments using pagination, where count
specifies how many links to return and page specifies which subset of
links organized in sequential pages, each containing \'count\' links,
starting with link zero and page zero. Thus, specifying a count of 10
and page of 0 will return the first 10 links in the result set (links
0-9). Specifying a count of 10 and page of 1 will return the next
\'page\' containing links 10-19, and so on. Unlike block-wise transfer
of a complete result set, these parameters ensure that each chunk of
results can be interpreted on its own. This simplifies the processing
but can result in duplicate or missed items when coinciding with changes
from the registration interface.[¶](#section-6.2-5){.pilcrow}

Endpoints that are interested in a lookup result repeatedly or
continuously can use mechanisms such as ETag caching, resource
observation \[[RFC7641](#RFC7641){.xref}\], or any future mechanism that
might allow more efficient observations of collections. These are
advertised, detected, and used according to their own specifications and
can be used with the lookup interface as with any other
resource.[¶](#section-6.2-6){.pilcrow}

When resource observation is used, every time the set of matching links
changes or the content of a matching link changes, the RD sends a
notification with the matching link set. The notification contains the
successful current response to the given request, especially with
respect to representing zero matching links (see \"Success\" item
below).[¶](#section-6.2-7){.pilcrow}

The lookup interface is specified as
follows:[¶](#section-6.2-8){.pilcrow}

[]{.break}

Interaction:
:   Client -\> RD[¶](#section-6.2-9.2){.pilcrow}
:   

Method:
:   GET[¶](#section-6.2-9.4){.pilcrow}
:   

URI Template:
:   {+type-lookup-location}{?page,count,search\*}[¶](#section-6.2-9.6){.pilcrow}
:   

URI Template Variables:

:   \

    []{.break}

    type-lookup-location :=
    :   RD lookup URI for a given lookup type (mandatory). The address
        is discovered as described in [Section
        4.3](#discovery){.xref}.[¶](#section-6.2-9.8.2.2){.pilcrow}
    :   

    search :=

    :   Search criteria for limiting the number of results (optional).
        The search criteria are an associative array, expressed in a
        form-style query, as per the URI Template (see
        \[[RFC6570](#RFC6570){.xref}\], Sections
        [2.4.2](https://www.rfc-editor.org/rfc/rfc6570#section-2.4.2){.relref}
        and
        [3.2.8](https://www.rfc-editor.org/rfc/rfc6570#section-3.2.8){.relref}).[¶](#section-6.2-9.8.2.4.1){.pilcrow}

    :   

    page :=
    :   Page (optional). This parameter cannot be used without the count
        parameter. Results are returned from result set in pages that
        contain \'count\' links starting from index (page \* count).
        Page numbering starts with
        zero.[¶](#section-6.2-9.8.2.6){.pilcrow}
    :   

    count :=
    :   Count (optional). The number of results is limited to this
        parameter value. If the page parameter is also present, the
        response [MUST]{.bcp14} only include \'count\' links starting
        with the (page \* count) link in the result set from the query.
        If the count parameter is not present, then the response
        [MUST]{.bcp14} return all matching links in the result set. Link
        numbering starts with zero.[¶](#section-6.2-9.8.2.8){.pilcrow}
    :   

:   

Accept:
:   absent, `application/link-format`, or any other indicated media type
    representing web links[¶](#section-6.2-9.10){.pilcrow}
:   

The following responses codes are defined for this
interface:[¶](#section-6.2-10){.pilcrow}

[]{.break}

Success:

:   2.05 (Content) or 200 (OK) with an `application/link-format` or
    other web link payload containing matching entries for the
    lookup.[¶](#section-6.2-11.2.1){.pilcrow}

    The payload can contain zero links (which is an empty payload in the
    link format described in \[[RFC6690](#RFC6690){.xref}\] but could
    also be `[]` in JSON-based formats), indicating that no entities
    matched the request.[¶](#section-6.2-11.2.2){.pilcrow}

:   
:::
:::

::: {#resource-lookup-examples}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Resource Lookup Examples](#name-resource-lookup-examples){.section-name .selfRef} {#name-resource-lookup-examples}

The examples in this section assume the existence of CoAP hosts with a
default CoAP port 61616. HTTP hosts are possible and do not change the
nature of the examples.[¶](#section-6.3-1){.pilcrow}

The following example shows a client performing a resource lookup with
the example resource lookup locations discovered in [Figure
5](#example-discovery){.xref}:[¶](#section-6.3-2){.pilcrow}

[]{#name-example-of-a-resource-looku}

::: {#example-lookup-res}
::: {#section-6.3-3.1}
``` sourcecode
Req: GET /rd-lookup/res?rt=tag:example.org,2020:temperature

Res: 2.05 Content
Payload:
<coap://[2001:db8:3::123]:61616/temp>;
    rt="tag:example.org,2020:temperature"
```
:::

[Figure 19](#figure-19){.selfRef}: [Example of a Resource
Lookup](#name-example-of-a-resource-looku){.selfRef}
:::

A client that wants to be notified of new resources as they show up can
use this observation:[¶](#section-6.3-4){.pilcrow}

[]{#name-example-of-an-observing-res}

::: {#example-lookup-obs}
::: {#section-6.3-5.1}
``` sourcecode
Req: GET /rd-lookup/res?rt=tag:example.org,2020:light
Observe: 0

Res: 2.05 Content
Observe: 23
Payload: empty

(at a later point in time)

Res: 2.05 Content
Observe: 24
Payload:
<coap://[2001:db8:3::124]/west>;rt="tag:example.org,2020:light",
<coap://[2001:db8:3::124]/south>;rt="tag:example.org,2020:light",
<coap://[2001:db8:3::124]/east>;rt="tag:example.org,2020:light"
```
:::

[Figure 20](#figure-20){.selfRef}: [Example of an Observing Resource
Lookup](#name-example-of-an-observing-res){.selfRef}
:::

The following example shows a client performing a paginated resource
lookup:[¶](#section-6.3-6){.pilcrow}

[]{#name-example-of-paginated-resour}

::: {#example-lookup-page}
::: {#section-6.3-7.1}
``` sourcecode
Req: GET /rd-lookup/res?page=0&count=5

Res: 2.05 Content
Payload:
<coap://[2001:db8:3::123]:61616/res/0>;ct=60,
<coap://[2001:db8:3::123]:61616/res/1>;ct=60,
<coap://[2001:db8:3::123]:61616/res/2>;ct=60,
<coap://[2001:db8:3::123]:61616/res/3>;ct=60,
<coap://[2001:db8:3::123]:61616/res/4>;ct=60

Req: GET /rd-lookup/res?page=1&count=5

Res: 2.05 Content
Payload:
<coap://[2001:db8:3::123]:61616/res/5>;ct=60,
<coap://[2001:db8:3::123]:61616/res/6>;ct=60,
<coap://[2001:db8:3::123]:61616/res/7>;ct=60,
<coap://[2001:db8:3::123]:61616/res/8>;ct=60,
<coap://[2001:db8:3::123]:61616/res/9>;ct=60
```
:::

[Figure 21](#figure-21){.selfRef}: [Example of Paginated Resource
Lookup](#name-example-of-paginated-resour){.selfRef}
:::

The following example shows a client performing a lookup of all
resources of all endpoints of a given endpoint type. It assumes that two
endpoints (with endpoint names `sensor1` and `sensor2`) have previously
registered with their respective addresses (`coap://sensor1.example.com`
and `coap://sensor2.example.com`) and posted the very payload of the 6th
response of [Section
5](https://www.rfc-editor.org/rfc/rfc6690#section-5){.relref} of
\[[RFC6690](#RFC6690){.xref}\].[¶](#section-6.3-8){.pilcrow}

It demonstrates how absolute link targets stay unmodified, while
relative ones are resolved:[¶](#section-6.3-9){.pilcrow}

[]{#name-example-of-a-resource-lookup}

::: {#example-lookup-multiple}
::: {#section-6.3-10.1}
``` sourcecode
Req: GET /rd-lookup/res?et=tag:example.com,2020:platform

Res: 2.05 Content
Payload:
<coap://sensor1.example.com/sensors>;ct=40;title="Sensor Index",
<coap://sensor1.example.com/sensors/temp>;rt=temperature-c;if=sensor,
<coap://sensor1.example.com/sensors/light>;rt=light-lux;if=sensor,
<http://www.example.com/sensors/t123>;rel=describedby;
    anchor="coap://sensor1.example.com/sensors/temp",
<coap://sensor1.example.com/t>;rel=alternate;
    anchor="coap://sensor1.example.com/sensors/temp",
<coap://sensor2.example.com/sensors>;ct=40;title="Sensor Index",
<coap://sensor2.example.com/sensors/temp>;rt=temperature-c;if=sensor,
<coap://sensor2.example.com/sensors/light>;rt=light-lux;if=sensor,
<http://www.example.com/sensors/t123>;rel=describedby;
    anchor="coap://sensor2.example.com/sensors/temp",
<coap://sensor2.example.com/t>;rel=alternate;
    anchor="coap://sensor2.example.com/sensors/temp"
```
:::

[Figure 22](#figure-22){.selfRef}: [Example of a Resource Lookup from
Multiple Endpoints](#name-example-of-a-resource-lookup){.selfRef}
:::
:::
:::

::: {#ep-lookup}
::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [Endpoint Lookup](#name-endpoint-lookup){.section-name .selfRef} {#name-endpoint-lookup}

The endpoint lookup returns links to and information about registration
resources, which themselves can only be manipulated by the registering
endpoint.[¶](#section-6.4-1){.pilcrow}

Endpoint registration resources are annotated with their endpoint names
(ep), sectors (d, if present), and registration base URI (base; reports
the registrant-EP\'s address if no explicit base was given), as well as
a constant resource type (rt=\"core.rd-ep\"); the lifetime (lt) is not
reported. Additional endpoint attributes are added as target attributes
to their endpoint link unless their specification says
otherwise.[¶](#section-6.4-2){.pilcrow}

Links to endpoints [SHOULD]{.bcp14} be presented in path-absolute form
or, if required, as (full) URIs. (This ensures that the output conforms
to Limited Link Format, as described in [Appendix
C](#limitedlinkformat){.xref}.)[¶](#section-6.4-3){.pilcrow}

Base addresses that contain link-local addresses [MUST NOT]{.bcp14}
include zone identifiers, and such registrations [MUST NOT]{.bcp14} be
shown unless the lookup was made from the same link from which the
registration was made.[¶](#section-6.4-4){.pilcrow}

While the endpoint lookup does expose the registration resources, the RD
does not need to make them accessible to clients. Clients [SHOULD
NOT]{.bcp14} attempt to dereference or manipulate
them.[¶](#section-6.4-5){.pilcrow}

An RD can report registrations in lookup whose URI scheme and authority
differ from that of the lookup resource. Lookup clients [MUST]{.bcp14}
be prepared to see arbitrary URIs as registration resources in the
results and treat them as opaque identifiers; the precise semantics of
such links are left to future
specifications.[¶](#section-6.4-6){.pilcrow}

The following example shows a client performing an endpoint lookup that
is limited to endpoints of endpoint type
`tag:example.com,2020:platform`:[¶](#section-6.4-7){.pilcrow}

[]{#name-example-of-endpoint-lookup}

::: {#example-lookup-ep}
::: {#section-6.4-8.1}
``` sourcecode
Req: GET /rd-lookup/ep?et=tag:example.com,2020:platform

Res: 2.05 Content
Payload:
</rd/1234>;base="coap://[2001:db8:3::127]:61616";ep=node5;
    et="tag:example.com,2020:platform";ct=40;rt=core.rd-ep,
</rd/4521>;base="coap://[2001:db8:3::129]:61616";ep=node7;
    et="tag:example.com,2020:platform";ct=40;d=floor-3;
    rt=core.rd-ep
```
:::

[Figure 23](#figure-23){.selfRef}: [Example of Endpoint
Lookup](#name-example-of-endpoint-lookup){.selfRef}
:::
:::
:::
:::
:::

::: {#policies}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Policies](#name-security-policies){.section-name .selfRef} {#name-security-policies}

The security policies that are applicable to an RD strongly depend on
the application and are not set out normatively
here.[¶](#section-7-1){.pilcrow}

This section provides a list of aspects that applications should
consider when describing their use of the RD, without claiming to cover
all cases. It uses terminology of
\[[ACE-OAUTH-AUTHZ](#I-D.ietf-ace-oauth-authz){.xref}\], in which the RD
acts as the Resource Server (RS), and both registrant-EPs and lookup
clients act as Clients (C) with support from an Authorization Server
(AS), without the intention of ruling out other schemes (e.g., those
based on certificates/Public Key Infrastructures
(PKIs)).[¶](#section-7-2){.pilcrow}

Any, all, or none of the below can apply to an application. Which are
relevant depends on its protection
objectives.[¶](#section-7-3){.pilcrow}

Security policies are set by configuration of the RD or by choice of the
implementation. Lookup clients (and, where relevant, endpoints) can only
trust an RD to uphold them if it is authenticated and authorized to
serve as an RD according to the application\'s
requirements.[¶](#section-7-4){.pilcrow}

::: {#secure-ep}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Endpoint Name](#name-endpoint-name){.section-name .selfRef} {#name-endpoint-name}

Whenever an RD needs to provide trustworthy results to clients doing
endpoint lookup or resource lookup with filtering on the endpoint name,
the RD must ensure that the registrant is authorized to use the given
endpoint name. This applies both to registration and later to operations
on the registration resource. It is immaterial whether the client is the
registrant-EP itself or a CT is doing the registration. The RD cannot
tell the difference, and CTs may use authorization credentials
authorizing only operations on that particular endpoint name or a wider
range of endpoint names.[¶](#section-7.1-1){.pilcrow}

It is up to the concrete security policy to describe how the endpoint
name and sector are transported when certificates are used. For example,
it may describe how SubjectAltName dNSName entries are mapped to
endpoint and domain names.[¶](#section-7.1-2){.pilcrow}

::: {#arbitrary-ep}
::: {#section-7.1.1 .section}
#### [7.1.1.](#section-7.1.1){.section-number .selfRef} [Random Endpoint Names](#name-random-endpoint-names){.section-name .selfRef} {#name-random-endpoint-names}

Conversely, in applications where the RD does not check the endpoint
name, the authorized registering endpoint can generate a random number
(or string) that identifies the endpoint. The RD should then remember
unique properties of the registrant, associate them with the
registration for as long as its registration resource is active (which
may be longer than the registration\'s lifetime), and require the same
properties for operations on the registration
resource.[¶](#section-7.1.1-1){.pilcrow}

Registrants that are prepared to pick a different identifier when their
initial attempt (or attempts, in the unlikely case of two subsequent
collisions) at registration is unauthorized should pick an identifier at
least twice as long as would be needed to enumerate the expected number
of registrants; registrants without any such recovery options should
pick significantly longer endpoint names (e.g., using Universally Unique
Identifier (UUID) URNs
\[[RFC4122](#RFC4122){.xref}\]).[¶](#section-7.1.1-2){.pilcrow}
:::
:::
:::
:::

::: {#entered-links}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Entered Links](#name-entered-links){.section-name .selfRef} {#name-entered-links}

When lookup clients expect that certain types of links can only
originate from certain endpoints, then the RD needs to apply filtering
to the links an endpoint may register.[¶](#section-7.2-1){.pilcrow}

For example, if clients use an RD to find a server that provides
firmware updates, then any registrant that wants to register (or update)
links to firmware sources will need to provide suitable credentials to
do so, independently of its endpoint name.[¶](#section-7.2-2){.pilcrow}

Note that the impact of having undesirable links in the RD depends on
the application. If the client requires the firmware server to present
credentials as a firmware server, a fraudulent link\'s impact is limited
to the client revealing its intention to obtain updates and slowing down
the client until it finds a legitimate firmware server; if the client
accepts any credentials from the server as long as they fit the provided
URI, the impact is larger.[¶](#section-7.2-3){.pilcrow}

An RD may also require that links are only registered if the registrant
is authorized to publish information about the anchor (or even target)
of the link. One way to do this is to demand that the registrant present
the same credentials in its role as a registering client that it would
need to present in its role as a server when contacted at the
resources\' URI. These credentials may include using the address and
port that are part of the URI. Such a restriction places severe
practical limitations on the links that can be
registered.[¶](#section-7.2-4){.pilcrow}

As above, the impact of undesirable links depends on the extent to which
the lookup client relies on the RD. To avoid the limitations, RD
applications should consider prescribing that lookup clients only use
the discovered information as hints and describe which pieces of
information need to be verified because they impact the application\'s
security. A straightforward way to verify such information is to request
it again from an authorized server, typically the one that hosts the
target resource. That is similar to what happens in [Section
4.3](#discovery){.xref} when the \"URI discovery\" step is
repeated.[¶](#section-7.2-5){.pilcrow}
:::
:::

::: {#link-confidentiality}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Link Confidentiality](#name-link-confidentiality){.section-name .selfRef} {#name-link-confidentiality}

When registrants publish information in the RD that is not available to
any client that would query the registrant\'s `/.well-known/core`
interface, or when lookups to that interface are subject to stricter
firewalling than lookups to the RD, the RD may need to limit which
lookup clients may access the information.[¶](#section-7.3-1){.pilcrow}

In this case, the endpoint (and not the lookup clients) needs to be
careful to check the RD\'s authorization. The RD needs to check any
lookup client\'s authorization before revealing information directly (in
resource lookup) or indirectly (when using it to satisfy a resource
lookup search criterion).[¶](#section-7.3-2){.pilcrow}
:::
:::

::: {#segmentation}
::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [Segmentation](#name-segmentation){.section-name .selfRef} {#name-segmentation}

Within a single RD, different security policies can
apply.[¶](#section-7.4-1){.pilcrow}

One example of this are multi-tenant deployments separated by the sector
(d) parameter. Some sectors might apply limitations on the endpoint
names available, while others use a random identifier approach to
endpoint names and place limits on the entered links based on their
attributes instead.[¶](#section-7.4-2){.pilcrow}

Care must be taken in such setups to determine the applicable access
control measures to each operation. One easy way to do that is to
mandate the use of the sector parameter on all operations, as no
credentials are suitable for operations across sector borders
anyway.[¶](#section-7.4-3){.pilcrow}
:::
:::

::: {#first-come-first-remembered-a-default-policy}
::: {#section-7.5 .section}
### [7.5.](#section-7.5){.section-number .selfRef} [\"First Come First Remembered\": A Default Policy](#name-first-come-first-remembered){.section-name .selfRef} {#name-first-come-first-remembered}

The \"First Come First Remembered\" policy is provided both as a
reference example for a security policy definition and as a policy that
implementations may choose to use as default policy in the absence of
any other configuration. It is designed to enable efficient discovery
operations even in ad hoc settings.[¶](#section-7.5-1){.pilcrow}

Under this policy, the RD accepts registrations for any endpoint name
that is not assigned to an active registration resource and only accepts
registration updates from the same endpoint. The policy is minimal in
that it does not make any promises to lookup clients about the claims of
Sections [7.2](#entered-links){.xref} and
[7.3](#link-confidentiality){.xref}, and promises about the claims in
[Section 7.1](#secure-ep){.xref} are limited to the lifetime of that
endpoint\'s registration. It does however promise the endpoint that, for
the duration of its registration, its links will be discoverable on the
RD.[¶](#section-7.5-2){.pilcrow}

When a registration or operation is attempted, the RD [MUST]{.bcp14}
determine the client\'s subject name or public
key:[¶](#section-7.5-3){.pilcrow}

-   [If the client\'s credentials indicate any subject name that is
    certified by any authority that the RD recognizes (which may be the
    system\'s trust anchor store), all such subject names are stored.
    With credentials based on CWT or JWT (as common with Authentication
    and Authorization for Constrained Environments (ACE)), the Subject
    (sub) claim is stored as a single name, if it exists. With X.509
    certificates, the Common Name (CN) and the complete list of
    SubjectAltName entries are stored. In both cases, the authority that
    certified the claim is stored along with the subject, as the latter
    may only be locally
    unique.[¶](#section-7.5-4.1){.pilcrow}]{#section-7.5-4.1}
-   [Otherwise, if the client proves possession of a private key, the
    matching public key is stored. This applies both to raw public keys
    and to the public keys indicated in certificates that failed the
    above authority
    check.[¶](#section-7.5-4.2){.pilcrow}]{#section-7.5-4.2}
-   [If neither is present, a reference to the security session itself
    is stored. With (D)TLS, that is the connection itself or the session
    resumption information, if available. With OSCORE, that is the
    security context.[¶](#section-7.5-4.3){.pilcrow}]{#section-7.5-4.3}

As part of the registration operation, that information is stored along
with the registration resource.[¶](#section-7.5-5){.pilcrow}

The RD [MUST]{.bcp14} accept all registrations whose registration
resource is not already active, as long as they are made using a
security layer supported by the RD.[¶](#section-7.5-6){.pilcrow}

Any operation on a registration resource, including registrations that
lead to an existing registration resource, [MUST]{.bcp14} be rejected by
the RD unless all the stored information is found in the new request\'s
credentials.[¶](#section-7.5-7){.pilcrow}

Note that, even though subject names are compared in this policy, they
are never directly compared to endpoint names, and an endpoint cannot
expect to \"own\" any particular endpoint name outside of an active
registration \-- even if a certificate says so. It is an accepted
shortcoming of this approach that the endpoint has no indication of
whether the RD remembers it by its subject name or public key;
recognition by subject happens on a best-effort basis (given the RD may
not recognize any authority). Clients [MUST]{.bcp14} be prepared to pick
a different endpoint name when rejected by the RD initially or after a
change in their credentials; picking an endpoint name, as per [Section
7.1.1](#arbitrary-ep){.xref}, is an easy option for
that.[¶](#section-7.5-8){.pilcrow}

For this policy to be usable without configuration, clients should not
set a sector name in their registrations. An RD can set a default sector
name for registrations accepted under this policy, which is especially
useful in a segmented setup where different policies apply to different
sectors. The configuration of such a behavior, as well as any other
configuration applicable to such an RD (i.e., the set of recognized
authorities), is out of scope for this
document.[¶](#section-7.5-9){.pilcrow}
:::
:::
:::
:::

::: {#security-considerations}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations as described in [Section
5](https://www.rfc-editor.org/rfc/rfc8288#section-5){.relref} of
\[[RFC8288](#RFC8288){.xref}\] and [Section
6](https://www.rfc-editor.org/rfc/rfc6690#section-6){.relref} of
\[[RFC6690](#RFC6690){.xref}\] apply. The `/.well-known/core` resource
may be protected, e.g., using DTLS when hosted on a CoAP server, as
described in \[[RFC7252](#RFC7252){.xref}\].[¶](#section-8-1){.pilcrow}

Access that is limited or affects sensitive data [SHOULD]{.bcp14} be
protected, e.g., using (D)TLS or OSCORE \[[RFC8613](#RFC8613){.xref}\];
which aspects of the RD this affects depends on the security policies of
the application (see [Section
7](#policies){.xref}).[¶](#section-8-2){.pilcrow}

::: {#seccons-discovery}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Discovery](#name-discovery){.section-name .selfRef} {#name-discovery}

Most steps in discovery of the RD, and possibly its resources, are not
covered by CoAP\'s security mechanisms. This will not endanger the
security properties of the registrations and lookup itself (where the
client requires authorization of the RD if it expects any security
properties of the operation) but may leak the client\'s intention to
third parties and allow them to slow down the
process.[¶](#section-8.1-1){.pilcrow}

To mitigate that, clients can retain the RD\'s address, use secure
discovery options (such as configured addresses), and send queries for
RDs in a very general form (e.g., `?rt=core.rd*` rather than
`?rt=core.rd-lookup-ep`).[¶](#section-8.1-2){.pilcrow}
:::
:::

::: {#endpoint_identification}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Endpoint Identification and Authentication](#name-endpoint-identification-and){.section-name .selfRef} {#name-endpoint-identification-and}

An endpoint (name, sector) pair is unique within the set of endpoints
registered by the RD. An endpoint [MUST NOT]{.bcp14} be identified by
its protocol, port, or IP address, as these may change over the lifetime
of an endpoint.[¶](#section-8.2-1){.pilcrow}

Every operation performed by an endpoint on an RD [SHOULD]{.bcp14} be
mutually authenticated using a pre-shared key, a raw public key, or
certificate-based security.[¶](#section-8.2-2){.pilcrow}

Consider the following threat: two devices, A and B, are registered at a
single server. Both devices have unique, per-device credentials for use
with DTLS to make sure that only parties with authorization to access A
or B can do so.[¶](#section-8.2-3){.pilcrow}

Now, imagine that a malicious device A wants to sabotage the device B.
It uses its credentials during the DTLS exchange. Then, it specifies the
endpoint name of device B as the name of its own endpoint in device A.
If the server does not check whether the identifier provided in the DTLS
handshake matches the identifier used at the CoAP layer, then it may be
inclined to use the endpoint name for looking up what information to
provision to the malicious device.[¶](#section-8.2-4){.pilcrow}

Endpoint authorization needs to be checked on registration and
registration resource operations independently of whether there are
configured requirements on the credentials for a given endpoint name and
sector ([Section 7.1](#secure-ep){.xref}) or whether arbitrary names are
accepted ([Section
7.1.1](#arbitrary-ep){.xref}).[¶](#section-8.2-5){.pilcrow}

Simple registration could be used to circumvent address-based access
control. An attacker would send a simple registration request with the
victim\'s address as the source address and later look up the victim\'s
`/.well-known/core` content in the RD. Mitigation for this is
recommended in [Section
5.1](#simple){.xref}.[¶](#section-8.2-6){.pilcrow}

The registration resource path is visible to any client that is allowed
endpoint lookup and can be extracted by resource lookup clients as well.
The same goes for registration attributes that are shown as target
attributes or lookup attributes. The RD needs to consider this in the
choice of registration resource paths, as do administrators or endpoints
in their choice of attributes.[¶](#section-8.2-7){.pilcrow}
:::
:::

::: {#access-control}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [Access Control](#name-access-control){.section-name .selfRef} {#name-access-control}

Access control [SHOULD]{.bcp14} be performed separately for the RD
registration and lookup API paths, as different endpoints may be
authorized to register with an RD from those authorized to look up
endpoints from the RD. Such access control [SHOULD]{.bcp14} be performed
in as fine-grained a level as possible. For example, access control for
lookups could be performed either at the sector, endpoint, or resource
level.[¶](#section-8.3-1){.pilcrow}

The precise access controls necessary (and the consequences of failure
to enforce them) depend on the protection objectives of the application
and the security policies ([Section 7](#policies){.xref}) derived from
them.[¶](#section-8.3-2){.pilcrow}
:::
:::

::: {#denial-of-service-attacks}
::: {#section-8.4 .section}
### [8.4.](#section-8.4){.section-number .selfRef} [Denial-of-Service Attacks](#name-denial-of-service-attacks){.section-name .selfRef} {#name-denial-of-service-attacks}

Services that run over UDP unprotected are vulnerable to unknowingly
amplify and distribute a DoS attack, as UDP does not require a return
routability check. Since RD lookup responses can be significantly larger
than requests, RDs are prone to this.[¶](#section-8.4-1){.pilcrow}

\[[RFC7252](#RFC7252){.xref}\] describes this at length in its Section
[11.3](https://www.rfc-editor.org/rfc/rfc7252#section-11.3){.relref},
including some mitigation by using small block sizes in responses.
\[[RFC9175](#RFC9175){.xref}\] updates that by describing a source
address verification mechanism using the Echo
option.[¶](#section-8.4-2){.pilcrow}
:::
:::

::: {#skipping-freshness-checks}
::: {#section-8.5 .section}
### [8.5.](#section-8.5){.section-number .selfRef} [Skipping Freshness Checks](#name-skipping-freshness-checks){.section-name .selfRef} {#name-skipping-freshness-checks}

When RD-based applications are built in which request freshness checks
are not performed, these concerns need to be
balanced:[¶](#section-8.5-1){.pilcrow}

-   ::: {#section-8.5-2.1}
    When alterations to registration attributes are reordered, an
    attacker may create any combination of attributes ever set, with the
    attack difficulty determined by the security layer\'s replay
    properties.[¶](#section-8.5-2.1.1){.pilcrow}

    For example, if [Figure 18](#example-freshness){.xref} were
    conducted without freshness assurances, an attacker could later
    reset the lifetime back to 7200. Thus, the device is made
    unreachable to lookup clients.[¶](#section-8.5-2.1.2){.pilcrow}
    :::

-   ::: {#section-8.5-2.2}
    When registration updates without query parameters (which just serve
    to restart the lifetime) can be reordered, an attacker can use
    intercepted messages to give the appearance of the device being
    alive to the RD.[¶](#section-8.5-2.2.1){.pilcrow}

    This is unacceptable when the RD\'s security policy promises
    reachability of endpoints (e.g., when disappearing devices would
    trigger further investigation) but may be acceptable with other
    policies.[¶](#section-8.5-2.2.2){.pilcrow}
    :::
:::
:::
:::
:::

::: {#iana-considerations}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#iana-rt}
::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Resource Types](#name-resource-types){.section-name .selfRef} {#name-resource-types}

IANA has added the following values to the \"Resource Type (rt=) Link
Target Attribute Values\" subregistry of the \"Constrained RESTful
Environments (CoRE) Parameters\" registry defined in
\[[RFC6690](#RFC6690){.xref}\]:[¶](#section-9.1-1){.pilcrow}

[]{#name-additions-to-resource-type-}

  Value                Description                   Reference
  -------------------- ----------------------------- --------------------------------------------
  core.rd              Directory resource of an RD   RFC 9176, [Section 4.3](#discovery){.xref}
  core.rd-lookup-res   Resource lookup of an RD      RFC 9176, [Section 4.3](#discovery){.xref}
  core.rd-lookup-ep    Endpoint lookup of an RD      RFC 9176, [Section 4.3](#discovery){.xref}
  core.rd-ep           Endpoint resource of an RD    RFC 9176, [Section 6](#lookup){.xref}

  : [Table 2](#table-2){.selfRef}: [Additions to Resource Type (rt=)
  Link Target Attribute Values
  Subregistry](#name-additions-to-resource-type-){.selfRef}
:::
:::

::: {#ipv6-nd-resource-directory-address-option}
::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [IPv6 ND Resource Directory Address Option](#name-ipv6-nd-resource-directory-){.section-name .selfRef} {#name-ipv6-nd-resource-directory-}

IANA has registered one new ND option type in the \"IPv6 Neighbor
Discovery Option Formats\" subregistry of the \"Internet Control Message
Protocol version 6 (ICMPv6) Parameters\"
registry:[¶](#section-9.2-1){.pilcrow}

[]{#name-addition-to-ipv6-neighbor-d}

  Type   Description                         Reference
  ------ ----------------------------------- -----------
  41     Resource Directory Address Option   RFC 9176

  : [Table 3](#table-3){.selfRef}: [Addition to IPv6 Neighbor Discovery
  Option Formats
  Subregistry](#name-addition-to-ipv6-neighbor-d){.selfRef}
:::
:::

::: {#iana-registry}
::: {#section-9.3 .section}
### [9.3.](#section-9.3){.section-number .selfRef} [RD Parameters Registry](#name-rd-parameters-registry){.section-name .selfRef} {#name-rd-parameters-registry}

This specification defines a new subregistry for registration and lookup
parameters called \"RD Parameters\" within the \"Constrained RESTful
Environments (CoRE) Parameters\" registry. Although this specification
defines a basic set of parameters, it is expected that other standards
that make use of this interface will define new
ones.[¶](#section-9.3-1){.pilcrow}

Each entry in the registry must include:[¶](#section-9.3-2){.pilcrow}

-   [the human-readable name of the
    parameter,[¶](#section-9.3-3.1){.pilcrow}]{#section-9.3-3.1}
-   [the short name, as used in query parameters or target
    attributes,[¶](#section-9.3-3.2){.pilcrow}]{#section-9.3-3.2}
-   [syntax and validity requirements (if
    any),[¶](#section-9.3-3.3){.pilcrow}]{#section-9.3-3.3}
-   [indication of whether it can be passed as a query parameter at
    registration of endpoints, passed as a query parameter in lookups,
    or expressed as a target
    attribute,[¶](#section-9.3-3.4){.pilcrow}]{#section-9.3-3.4}
-   [a description,
    and[¶](#section-9.3-3.5){.pilcrow}]{#section-9.3-3.5}
-   [a link to reference
    documentation.[¶](#section-9.3-3.6){.pilcrow}]{#section-9.3-3.6}

The query parameter [MUST]{.bcp14} be both a valid URI query key
\[[RFC3986](#RFC3986){.xref}\] and a token as used in
\[[RFC8288](#RFC8288){.xref}\].[¶](#section-9.3-4){.pilcrow}

The reference documentation must give details on whether the parameter
can be updated and how it is to be processed in
lookups.[¶](#section-9.3-5){.pilcrow}

The mechanisms around new RD parameters should be designed in such a way
that they tolerate RD implementations that are unaware of the parameter
and expose any parameter passed at registration or updates in endpoint
lookups. (For example, if a parameter used at registration were to be
confidential, the registering endpoint should be instructed to only set
that parameter if the RD advertises support for keeping it confidential
at the discovery step.)[¶](#section-9.3-6){.pilcrow}

Initial entries in this subregistry are as
follows:[¶](#section-9.3-7){.pilcrow}

[]{#name-new-rd-parameters-registry}

::: {#tab-registry}
  Name                    Short   Validity                                            Use   Description
  ----------------------- ------- --------------------------------------------------- ----- ----------------------------------------------------------------------------------
  Endpoint Name           ep      Unicode\*                                           RLA   Name of the endpoint
  Lifetime                lt      1-4294967295                                        R     Lifetime of the registration in seconds
  Sector                  d       Unicode\*                                           RLA   Sector to which this endpoint belongs
  Registration Base URI   base    URI                                                 RLA   The scheme, address, port, and path at which this server is available
  Page                    page    Integer                                             L     Used for pagination
  Count                   count   Integer                                             L     Used for pagination
  Endpoint Type           et      RFC 9176, [Section 9.3.1](#et-description){.xref}   RLA   Semantic type of the endpoint (see RFC 9176, [Section 9.4](#et-registry){.xref})

  : [Table 4](#table-4){.selfRef}: [New RD Parameters
  Registry](#name-new-rd-parameters-registry){.selfRef}
:::

Where:[¶](#section-9.3-9){.pilcrow}

[]{.break}

Short:
:   Short name used in query parameters or target
    attributes[¶](#section-9.3-10.2){.pilcrow}
:   

Validity:

:   \

    []{.break}

    Unicode\* =
    :   up to 63 bytes of UTF-8-encoded Unicode, with no control
        characters as per [Section
        5](#registration){.xref}[¶](#section-9.3-10.4.2.2){.pilcrow}
    :   

:   

Use:

:   \

    []{.break}

    R =
    :   used at registration[¶](#section-9.3-10.6.2.2){.pilcrow}
    :   

    L =
    :   used at lookup[¶](#section-9.3-10.6.2.4){.pilcrow}
    :   

    A =
    :   expressed in the target
        attribute[¶](#section-9.3-10.6.2.6){.pilcrow}
    :   

:   

The descriptions for the options defined in this document are only
summarized here. To which registrations they apply and when they are to
be shown are described in the respective sections of this document. All
their reference documentation entries point to this
document.[¶](#section-9.3-11){.pilcrow}

The IANA policy for future additions to the subregistry is Expert
Review, as described in \[[RFC8126](#RFC8126){.xref}\]. The evaluation
should consider formal criteria, duplication of functionality (i.e., is
the new entry redundant with an existing one?), topical suitability
(e.g., is the described property actually a property of the endpoint and
not a property of a particular resource, in which case it should go into
the payload of the registration and need not be registered?), and the
potential for conflict with commonly used target attributes (e.g., `if`
could be used as a parameter for conditional registration if it were not
to be used in lookup or attributes but would make a bad parameter for
lookup because a resource lookup with an `if` query parameter could
ambiguously filter by the registered endpoint property or the target
attribute \[[RFC6690](#RFC6690){.xref}\]).[¶](#section-9.3-12){.pilcrow}

::: {#et-description}
::: {#section-9.3.1 .section}
#### [9.3.1.](#section-9.3.1){.section-number .selfRef} [Full Description of the \"Endpoint Type\" RD Parameter](#name-full-description-of-the-end){.section-name .selfRef} {#name-full-description-of-the-end}

An endpoint registering at an RD can describe itself with endpoint
types, similar to how resources are described with resource types in
\[[RFC6690](#RFC6690){.xref}\]. An endpoint type is expressed as a
string, which can be either a URI or one of the values defined in the
\"Endpoint Type (et=) RD Parameter Values\" subregistry. Endpoint types
can be passed in the `et` query parameter as part of extra-attrs at the
\"registration\" step of [Section 5](#registration){.xref}, are shown on
endpoint lookups using the `et` target attribute, and can be filtered
for using `et` as a search criterion in resource and endpoint lookup.
Multiple endpoint types are given as separate query parameters or link
attributes.[¶](#section-9.3.1-1){.pilcrow}

Note that the endpoint type differs from the resource type in that it
uses multiple attributes rather than space-separated values. As a
result, RDs implementing this specification automatically support
correct filtering in the lookup interfaces from the rules for unknown
endpoint attributes.[¶](#section-9.3.1-2){.pilcrow}
:::
:::
:::
:::

::: {#et-registry}
::: {#section-9.4 .section}
### [9.4.](#section-9.4){.section-number .selfRef} [Endpoint Type (et=) RD Parameter Values](#name-endpoint-type-et-rd-paramet){.section-name .selfRef} {#name-endpoint-type-et-rd-paramet}

This specification establishes a new subregistry called \"Endpoint Type
(et=) RD Parameter Values\" within the \"Constrained RESTful
Environments (CoRE) Parameters\" registry. The registry properties
(required policy, requirements, and template) are identical to those of
the \"Resource Type (rt=) Link Target Attribute Values\" subregistry
defined in \[[RFC6690](#RFC6690){.xref}\]; in short, the review policy
is IETF Review for values starting with \"core\" and Specification
Required for others.[¶](#section-9.4-1){.pilcrow}

The requirements to be enforced are:[¶](#section-9.4-2){.pilcrow}

-   [The values [MUST]{.bcp14} be related to the purpose described in
    [Section
    9.3.1](#et-description){.xref}.[¶](#section-9.4-3.1){.pilcrow}]{#section-9.4-3.1}
-   [The registered values [MUST]{.bcp14} conform to the ABNF
    reg-rel-type definition of \[[RFC6690](#RFC6690){.xref}\] and [MUST
    NOT]{.bcp14} be a
    URI.[¶](#section-9.4-3.2){.pilcrow}]{#section-9.4-3.2}
-   [It is recommended to use the period \".\" character for
    segmentation.[¶](#section-9.4-3.3){.pilcrow}]{#section-9.4-3.3}

The initial contents of the registry are as
follows:[¶](#section-9.4-4){.pilcrow}

[]{#name-new-endpoint-type-et-rd-par}

  Value           Description                                                                     Reference
  --------------- ------------------------------------------------------------------------------- -----------
  core.rd-group   An application group, as described in RFC 9176, [Appendix A](#groups){.xref}.   RFC 9176

  : [Table 5](#table-5){.selfRef}: [New Endpoint Type (et=) RD Parameter
  Values Registry](#name-new-endpoint-type-et-rd-par){.selfRef}
:::
:::

::: {#mc-registration}
::: {#section-9.5 .section}
### [9.5.](#section-9.5){.section-number .selfRef} [Multicast Address Registration](#name-multicast-address-registrat){.section-name .selfRef} {#name-multicast-address-registrat}

IANA has assigned the following multicast addresses for use by CoAP
nodes:[¶](#section-9.5-1){.pilcrow}

[]{.break}

IPv4
:   \-- \"All CoRE Resource Directories\" address 224.0.1.190, in the
    \"Internetwork Control Block (224.0.1.0 - 224.0.1.255
    (224.0.1/24))\" subregistry within the \"IPv4 Multicast Address
    Space Registry\". As the address is used for discovery that may span
    beyond a single network, it has come from the Internetwork Control
    Block (224.0.1.x)
    \[[RFC5771](#RFC5771){.xref}\].[¶](#section-9.5-2.2){.pilcrow}
:   

IPv6
:   \-- \"All CoRE Resource Directories\" address ff0x::fe, in the
    \"Variable Scope Multicast Addresses\" subregistry within the \"IPv6
    Multicast Address Space Registry\" \[[RFC3307](#RFC3307){.xref}\].
    Note that there is a distinct multicast address for each scope that
    interested CoAP nodes should listen to; CoAP needs the link-local
    and site-local scopes only.[¶](#section-9.5-2.4){.pilcrow}
:   
:::
:::

::: {#well-known-uris}
::: {#section-9.6 .section}
### [9.6.](#section-9.6){.section-number .selfRef} [Well-Known URIs](#name-well-known-uris){.section-name .selfRef} {#name-well-known-uris}

IANA has registered the URI suffix \"rd\" in the \"Well-Known URIs\"
registry as follows:[¶](#section-9.6-1){.pilcrow}

[]{#name-addition-to-well-known-uris}

  URI Suffix   Change Controller   Reference   Status
  ------------ ------------------- ----------- -----------
  rd           IETF                RFC 9176    permanent

  : [Table 6](#table-6){.selfRef}: [Addition to Well-Known URIs
  Registry](#name-addition-to-well-known-uris){.selfRef}
:::
:::

::: {#service-names-and-transport-protocol-port-number-registry}
::: {#section-9.7 .section}
### [9.7.](#section-9.7){.section-number .selfRef} [Service Name and Transport Protocol Port Number Registry](#name-service-name-and-transport-){.section-name .selfRef} {#name-service-name-and-transport-}

IANA has added four new items to the \"Service Name and Transport
Protocol Port Number Registry\" as follows:[¶](#section-9.7-1){.pilcrow}

[]{#name-additions-to-service-name-a}

  Service Name   Transport Protocol   Description                                        Reference
  -------------- -------------------- -------------------------------------------------- -----------
  core-rd        udp                  Resource Directory accessed using CoAP             RFC 9176
  core-rd-dtls   udp                  Resource Directory accessed using CoAP over DTLS   RFC 9176
  core-rd        tcp                  Resource Directory accessed using CoAP over TCP    RFC 9176
  core-rd-tls    tcp                  Resource Directory accessed using CoAP over TLS    RFC 9176

  : [Table 7](#table-7){.selfRef}: [Additions to Service Name and
  Transport Protocol Port Number
  Registry](#name-additions-to-service-name-a){.selfRef}
:::
:::
:::
:::

::: {#examples}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Examples](#name-examples){.section-name .selfRef} {#name-examples}

Two examples are presented: a lighting installation example in [Section
10.1](#lt-ex){.xref} and a Lightweight M2M (LwM2M) example in [Section
10.2](#lwm2m-ex){.xref}.[¶](#section-10-1){.pilcrow}

::: {#lt-ex}
::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Lighting Installation](#name-lighting-installation){.section-name .selfRef} {#name-lighting-installation}

This example shows a simplified lighting installation that makes use of
the RD with a CoAP interface to facilitate the installation and startup
of the application code in the lights and sensors. In particular, the
example leads to the definition of a group and the enabling of the
corresponding multicast address, as described in [Appendix
A](#groups){.xref}. No conclusions must be drawn on the realization of
actual installation or naming procedures, because the example only
emphasizes some of the issues that may influence the use of the RD and
does not pretend to be normative.[¶](#section-10.1-1){.pilcrow}

::: {#lt-in-ch}
::: {#section-10.1.1 .section}
#### [10.1.1.](#section-10.1.1){.section-number .selfRef} [Installation Characteristics](#name-installation-characteristic){.section-name .selfRef} {#name-installation-characteristic}

The example assumes that the installation is managed. That means that a
Commissioning Tool (CT) is used to authorize the addition of nodes, name
them, and name their services. The CT can be connected to the
installation in many ways: the CT can be part of the installation
network, connected by Wi-Fi to the installation network, connected via
GPRS link, or connected by another
method.[¶](#section-10.1.1-1){.pilcrow}

It is assumed that there are two naming authorities for the
installation: (1) the network manager that is responsible for the
correct operation of the network and the connected interfaces and (2)
the lighting manager that is responsible for the correct functioning of
networked lights and sensors. The result is the existence of two naming
schemes coming from the two managing
entities.[¶](#section-10.1.1-2){.pilcrow}

The example installation consists of one presence sensor and two
luminaries, luminary1 and luminary2, each with their own wireless
interface. Each luminary contains three lamps: left, right, and middle.
Each luminary is accessible through one endpoint. For each lamp, a
resource exists to modify the settings of a lamp in a luminary. The
purpose of the installation is that the presence sensor notifies the
presence of persons to a group of lamps. The group of lamps consists of
the middle and left lamps of luminary1 and the right lamp of
luminary2.[¶](#section-10.1.1-3){.pilcrow}

Before commissioning by the lighting manager, the network is installed,
and access to the interfaces is proven to work by the network
manager.[¶](#section-10.1.1-4){.pilcrow}

At the moment of installation, the network under installation is not
necessarily connected to the DNS infrastructure. Therefore, Stateless
Address Autoconfiguration (SLAAC) IPv6 addresses are assigned to CT, RD,
luminaries, and the sensor. The addresses shown in [Table
8](#interface-S){.xref} below stand in for these in the following
examples.[¶](#section-10.1.1-5){.pilcrow}

[]{#name-addresses-used-in-the-examp}

::: {#interface-S}
  Name              IPv6 address
  ----------------- ----------------
  luminary1         2001:db8:4::1
  luminary2         2001:db8:4::2
  Presence sensor   2001:db8:4::3
  RD                2001:db8:4::ff

  : [Table 8](#table-8){.selfRef}: [Addresses Used in the
  Examples](#name-addresses-used-in-the-examp){.selfRef}
:::

In [Section 10.1.2](#rd-en){.xref}, the use of RD during installation is
presented.[¶](#section-10.1.1-7){.pilcrow}
:::
:::

::: {#rd-en}
::: {#section-10.1.2 .section}
#### [10.1.2.](#section-10.1.2){.section-number .selfRef} [RD Entries](#name-rd-entries){.section-name .selfRef} {#name-rd-entries}

It is assumed that access to the DNS infrastructure is not always
possible during installation. Therefore, the SLAAC addresses are used in
this section.[¶](#section-10.1.2-1){.pilcrow}

For discovery, the resource types (rt) of the devices are important. The
lamps in the luminaries have rt=tag:example.com,2020:light, and the
presence sensor has rt=tag:example.com,2020:p-sensor. The endpoints have
names that are relevant to the light installation manager. In this case,
luminary1, luminary2, and the presence sensor are located in room
2-4-015, where luminary1 is located at the window and luminary2 and the
presence sensor are located at the door. The endpoint names reflect this
physical location. The middle, left, and right lamps are accessed via
path /light/middle, /light/left, and /light/right, respectively. The
identifiers relevant to the RD are shown in [Table
9](#endpoint){.xref}.[¶](#section-10.1.2-2){.pilcrow}

[]{#name-rd-identifiers}

::: {#endpoint}
  Name              Endpoint           Resource Path   Resource Type
  ----------------- ------------------ --------------- -------------------------------
  luminary1         lm_R2-4-015_wndw   /light/left     tag:example.com,2020:light
  luminary1         lm_R2-4-015_wndw   /light/middle   tag:example.com,2020:light
  luminary1         lm_R2-4-015_wndw   /light/right    tag:example.com,2020:light
  luminary2         lm_R2-4-015_door   /light/left     tag:example.com,2020:light
  luminary2         lm_R2-4-015_door   /light/middle   tag:example.com,2020:light
  luminary2         lm_R2-4-015_door   /light/right    tag:example.com,2020:light
  Presence sensor   ps_R2-4-015_door   /ps             tag:example.com,2020:p-sensor

  : [Table 9](#table-9){.selfRef}: [RD
  Identifiers](#name-rd-identifiers){.selfRef}
:::

It is assumed that the CT has performed RD discovery and has received a
response like the one in the example in [Section
4.3](#discovery){.xref}.[¶](#section-10.1.2-4){.pilcrow}

The CT inserts the endpoints of the luminaries and the sensor in the RD
using the registration base URI parameter (base) to specify the
interface address:[¶](#section-10.1.2-5){.pilcrow}

[]{#name-example-of-registrations-a-}

::: {#example-lighting-1}
::: {#section-10.1.2-6.1}
``` sourcecode
Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=lm_R2-4-015_wndw&base=coap://[2001:db8:4::1]&d=R2-4-015
Payload:
</light/left>;rt="tag:example.com,2020:light",
</light/middle>;rt="tag:example.com,2020:light",
</light/right>;rt="tag:example.com,2020:light"

Res: 2.01 Created
Location-Path: /rd/4521

Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=lm_R2-4-015_door&base=coap://[2001:db8:4::2]&d=R2-4-015
Payload:
</light/left>;rt="tag:example.com,2020:light",
</light/middle>;rt="tag:example.com,2020:light",
</light/right>;rt="tag:example.com,2020:light"

Res: 2.01 Created
Location-Path: /rd/4522

Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=ps_R2-4-015_door&base=coap://[2001:db8:4::3]&d=R2-4-015
Payload:
</ps>;rt="tag:example.com,2020:p-sensor"

Res: 2.01 Created
Location-Path: /rd/4523
```
:::

[Figure 24](#figure-24){.selfRef}: [Example of Registrations a CT Enters
into an RD](#name-example-of-registrations-a-){.selfRef}
:::

The sector name d=R2-4-015 has been added for an efficient lookup
because filtering on the \"ep\" name is more awkward. The same sector
name is communicated to the two luminaries and the presence sensor by
the CT.[¶](#section-10.1.2-7){.pilcrow}

The group is specified in the RD. The base parameter is set to the
site-local multicast address allocated to the group. In the POST in the
example below, the resources supported by all group members are
published.[¶](#section-10.1.2-8){.pilcrow}

[]{#name-example-of-a-multicast-grou}

::: {#example-lighting-2}
::: {#section-10.1.2-9.1}
``` sourcecode
Req: POST coap://[2001:db8:4::ff]/rd
  ?ep=grp_R2-4-015&et=core.rd-group&base=coap://[ff05::1]
Payload:
</light/left>;rt="tag:example.com,2020:light",
</light/middle>;rt="tag:example.com,2020:light",
</light/right>;rt="tag:example.com,2020:light"

Res: 2.01 Created
Location-Path: /rd/501
```
:::

[Figure 25](#figure-25){.selfRef}: [Example of a Multicast Group a CT
Enters into an RD](#name-example-of-a-multicast-grou){.selfRef}
:::

After the filling of the RD by the CT, the application in the luminaries
can learn to which groups they belong and enable their interface for the
multicast address.[¶](#section-10.1.2-10){.pilcrow}

The luminary, knowing its sector and being configured to join any group
containing lights, searches for candidate groups and joins
them:[¶](#section-10.1.2-11){.pilcrow}

[]{#name-example-of-a-lookup-exchang}

::: {#example-lighting-3}
::: {#section-10.1.2-12.1}
``` sourcecode
Req: GET coap://[2001:db8:4::ff]/rd-lookup/ep
  ?d=R2-4-015&et=core.rd-group&rt=light

Res: 2.05 Content
Payload:
</rd/501>;ep=grp_R2-4-015;et=core.rd-group;
          base="coap://[ff05::1]";rt=core.rd-ep
```
:::

[Figure 26](#figure-26){.selfRef}: [Example of a Lookup Exchange to Find
Suitable Multicast
Addresses](#name-example-of-a-lookup-exchang){.selfRef}
:::

From the returned base parameter value, the luminary learns the
multicast address of the multicast
group.[¶](#section-10.1.2-13){.pilcrow}

The presence sensor can learn the presence of groups that support
resources with rt=tag:example.com,2020:light in its own sector by
sending the same request, as used by the luminary. The presence sensor
learns the multicast address to use for sending messages to the
luminaries.[¶](#section-10.1.2-14){.pilcrow}
:::
:::
:::
:::

::: {#lwm2m-ex}
::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [OMA Lightweight M2M (LwM2M)](#name-oma-lightweight-m2m-lwm2m){.section-name .selfRef} {#name-oma-lightweight-m2m-lwm2m}

OMA LwM2M is a profile for device services based on CoAP, providing
interfaces and operations for device management and device service
enablement.[¶](#section-10.2-1){.pilcrow}

An LwM2M server is an instance of an LwM2M middleware service layer,
containing an RD (\[[LwM2M](#LwM2M){.xref}\], starting at page
36).[¶](#section-10.2-2){.pilcrow}

That RD only implements the registration interface, and no lookup is
implemented. Instead, the LwM2M server provides access to the registered
resources in a similar way to a reverse
proxy.[¶](#section-10.2-3){.pilcrow}

The location of the LwM2M server and RD URI path is provided by the
LwM2M bootstrap process, so no dynamic discovery of the RD is used.
LwM2M servers and endpoints are not required to implement the
`/.well-known/core` resource.[¶](#section-10.2-4){.pilcrow}
:::
:::
:::
:::

::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3986\]
:   [Berners-Lee, T.]{.refAuthor}, [Fielding, R.]{.refAuthor}, and [L.
    Masinter]{.refAuthor}, [\"Uniform Resource Identifier (URI): Generic
    Syntax\"]{.refTitle}, [STD 66]{.seriesInfo}, [RFC
    3986]{.seriesInfo}, [DOI 10.17487/RFC3986]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3986>\>.
:   

\[RFC6570\]
:   [Gregorio, J.]{.refAuthor}, [Fielding, R.]{.refAuthor},
    [Hadley, M.]{.refAuthor}, [Nottingham, M.]{.refAuthor}, and [D.
    Orchard]{.refAuthor}, [\"URI Template\"]{.refTitle}, [RFC
    6570]{.seriesInfo}, [DOI 10.17487/RFC6570]{.seriesInfo}, March 2012,
    \<<https://www.rfc-editor.org/info/rfc6570>\>.
:   

\[RFC6690\]
:   [Shelby, Z.]{.refAuthor}, [\"Constrained RESTful Environments (CoRE)
    Link Format\"]{.refTitle}, [RFC 6690]{.seriesInfo}, [DOI
    10.17487/RFC6690]{.seriesInfo}, August 2012,
    \<<https://www.rfc-editor.org/info/rfc6690>\>.
:   

\[RFC6763\]
:   [Cheshire, S.]{.refAuthor} and [M. Krochmal]{.refAuthor},
    [\"DNS-Based Service Discovery\"]{.refTitle}, [RFC
    6763]{.seriesInfo}, [DOI 10.17487/RFC6763]{.seriesInfo}, February
    2013, \<<https://www.rfc-editor.org/info/rfc6763>\>.
:   

\[RFC7230\]
:   [Fielding, R., Ed.]{.refAuthor} and [J. Reschke, Ed.]{.refAuthor},
    [\"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and
    Routing\"]{.refTitle}, [RFC 7230]{.seriesInfo}, [DOI
    10.17487/RFC7230]{.seriesInfo}, June 2014,
    \<<https://www.rfc-editor.org/info/rfc7230>\>.
:   

\[RFC7252\]
:   [Shelby, Z.]{.refAuthor}, [Hartke, K.]{.refAuthor}, and [C.
    Bormann]{.refAuthor}, [\"The Constrained Application Protocol
    (CoAP)\"]{.refTitle}, [RFC 7252]{.seriesInfo}, [DOI
    10.17487/RFC7252]{.seriesInfo}, June 2014,
    \<<https://www.rfc-editor.org/info/rfc7252>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8288\]
:   [Nottingham, M.]{.refAuthor}, [\"Web Linking\"]{.refTitle}, [RFC
    8288]{.seriesInfo}, [DOI 10.17487/RFC8288]{.seriesInfo}, October
    2017, \<<https://www.rfc-editor.org/info/rfc8288>\>.
:   

\[RFC9175\]
:   [Amsüss, C.]{.refAuthor}, [Preuß Mattsson, J.]{.refAuthor}, and [G.
    Selander]{.refAuthor}, [\"Constrained Application Protocol (CoAP):
    Echo, Request-Tag, and Token Processing\"]{.refTitle}, [RFC
    9175]{.seriesInfo}, [DOI 10.17487/RFC9175]{.seriesInfo}, February
    2022, \<<https://www.rfc-editor.org/info/rfc9175>\>.
:   
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ACE-OAUTH-AUTHZ\]
:   [Seitz, L.]{.refAuthor}, [Selander, G.]{.refAuthor},
    [Wahlstroem, E.]{.refAuthor}, [Erdtman, S.]{.refAuthor}, and [H.
    Tschofenig]{.refAuthor}, [\"Authentication and Authorization for
    Constrained Environments (ACE) using the OAuth 2.0 Framework
    (ACE-OAuth)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-ace-oauth-authz-46]{.seriesInfo}, 8
    November 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46>\>.
:   

\[COAP-PROT-NEG\]
:   [Silverajan, B.]{.refAuthor} and [M. Ocak]{.refAuthor}, [\"CoAP
    Protocol Negotiation\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-silverajan-core-coap-protocol-negotiation-09]{.seriesInfo}, 2
    July 2018,
    \<<https://datatracker.ietf.org/doc/html/draft-silverajan-core-coap-protocol-negotiation-09>\>.
:   

\[CORE-CORAL\]
:   [Amsüss, C.]{.refAuthor} and [T. Fossati]{.refAuthor}, [\"The
    Constrained RESTful Application Language (CoRAL)\"]{.refTitle},
    [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-core-coral-05]{.seriesInfo}, 7 March 2022,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-core-coral-05>\>.
:   

\[CORE-LINKS-JSON\]
:   [Li, K.]{.refAuthor}, [Rahman, A.]{.refAuthor}, and [C. Bormann,
    Ed.]{.refAuthor}, [\"Representing Constrained RESTful Environments
    (CoRE) Link Format in JSON and CBOR\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-core-links-json-10]{.seriesInfo}, 26 February 2018,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-core-links-json-10>\>.
:   

\[CORE-RD-DNS-SD\]
:   [van der Stok, P.]{.refAuthor}, [Koster, M.]{.refAuthor}, and [C.
    Amsuess]{.refAuthor}, [\"CoRE Resource Directory: DNS-SD
    mapping\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-core-rd-dns-sd-05]{.seriesInfo}, 7 July
    2019,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-core-rd-dns-sd-05>\>.
:   

\[ER\]
:   [Chen, P.]{.refAuthor}, [\"The entity-relationship model\--toward a
    unified view of data\"]{.refTitle}, [ACM Transactions on Database
    Systems, Vol. 1, pp. 9-36]{.refContent}, [DOI
    10.1145/320434.320440]{.seriesInfo}, March 1976,
    \<<https://doi.org/10.1145/320434.320440>\>.
:   

\[LwM2M\]
:   [Open Mobile Alliance]{.refAuthor}, [\"Lightweight Machine to
    Machine Technical Specification: Transport Bindings (Candidate
    Version 1.1)\"]{.refTitle}, June 2018,
    \<<https://openmobilealliance.org/RELEASE/LightweightM2M/V1_1-20180612-C/OMA-TS-LightweightM2M_Transport-V1_1-20180612-C.pdf>\>.
:   

\[RFC3306\]
:   [Haberman, B.]{.refAuthor} and [D. Thaler]{.refAuthor},
    [\"Unicast-Prefix-based IPv6 Multicast Addresses\"]{.refTitle}, [RFC
    3306]{.seriesInfo}, [DOI 10.17487/RFC3306]{.seriesInfo}, August
    2002, \<<https://www.rfc-editor.org/info/rfc3306>\>.
:   

\[RFC3307\]
:   [Haberman, B.]{.refAuthor}, [\"Allocation Guidelines for IPv6
    Multicast Addresses\"]{.refTitle}, [RFC 3307]{.seriesInfo}, [DOI
    10.17487/RFC3307]{.seriesInfo}, August 2002,
    \<<https://www.rfc-editor.org/info/rfc3307>\>.
:   

\[RFC3849\]
:   [Huston, G.]{.refAuthor}, [Lord, A.]{.refAuthor}, and [P.
    Smith]{.refAuthor}, [\"IPv6 Address Prefix Reserved for
    Documentation\"]{.refTitle}, [RFC 3849]{.seriesInfo}, [DOI
    10.17487/RFC3849]{.seriesInfo}, July 2004,
    \<<https://www.rfc-editor.org/info/rfc3849>\>.
:   

\[RFC4122\]
:   [Leach, P.]{.refAuthor}, [Mealling, M.]{.refAuthor}, and [R.
    Salz]{.refAuthor}, [\"A Universally Unique IDentifier (UUID) URN
    Namespace\"]{.refTitle}, [RFC 4122]{.seriesInfo}, [DOI
    10.17487/RFC4122]{.seriesInfo}, July 2005,
    \<<https://www.rfc-editor.org/info/rfc4122>\>.
:   

\[RFC4944\]
:   [Montenegro, G.]{.refAuthor}, [Kushalnagar, N.]{.refAuthor},
    [Hui, J.]{.refAuthor}, and [D. Culler]{.refAuthor}, [\"Transmission
    of IPv6 Packets over IEEE 802.15.4 Networks\"]{.refTitle}, [RFC
    4944]{.seriesInfo}, [DOI 10.17487/RFC4944]{.seriesInfo}, September
    2007, \<<https://www.rfc-editor.org/info/rfc4944>\>.
:   

\[RFC5771\]
:   [Cotton, M.]{.refAuthor}, [Vegoda, L.]{.refAuthor}, and [D.
    Meyer]{.refAuthor}, [\"IANA Guidelines for IPv4 Multicast Address
    Assignments\"]{.refTitle}, [BCP 51]{.seriesInfo}, [RFC
    5771]{.seriesInfo}, [DOI 10.17487/RFC5771]{.seriesInfo}, March 2010,
    \<<https://www.rfc-editor.org/info/rfc5771>\>.
:   

\[RFC6724\]
:   [Thaler, D., Ed.]{.refAuthor}, [Draves, R.]{.refAuthor},
    [Matsumoto, A.]{.refAuthor}, and [T. Chown]{.refAuthor}, [\"Default
    Address Selection for Internet Protocol Version 6
    (IPv6)\"]{.refTitle}, [RFC 6724]{.seriesInfo}, [DOI
    10.17487/RFC6724]{.seriesInfo}, September 2012,
    \<<https://www.rfc-editor.org/info/rfc6724>\>.
:   

\[RFC6775\]
:   [Shelby, Z., Ed.]{.refAuthor}, [Chakrabarti, S.]{.refAuthor},
    [Nordmark, E.]{.refAuthor}, and [C. Bormann]{.refAuthor},
    [\"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless
    Personal Area Networks (6LoWPANs)\"]{.refTitle}, [RFC
    6775]{.seriesInfo}, [DOI 10.17487/RFC6775]{.seriesInfo}, November
    2012, \<<https://www.rfc-editor.org/info/rfc6775>\>.
:   

\[RFC6874\]
:   [Carpenter, B.]{.refAuthor}, [Cheshire, S.]{.refAuthor}, and [R.
    Hinden]{.refAuthor}, [\"Representing IPv6 Zone Identifiers in
    Address Literals and Uniform Resource Identifiers\"]{.refTitle},
    [RFC 6874]{.seriesInfo}, [DOI 10.17487/RFC6874]{.seriesInfo},
    February 2013, \<<https://www.rfc-editor.org/info/rfc6874>\>.
:   

\[RFC7228\]
:   [Bormann, C.]{.refAuthor}, [Ersue, M.]{.refAuthor}, and [A.
    Keranen]{.refAuthor}, [\"Terminology for Constrained-Node
    Networks\"]{.refTitle}, [RFC 7228]{.seriesInfo}, [DOI
    10.17487/RFC7228]{.seriesInfo}, May 2014,
    \<<https://www.rfc-editor.org/info/rfc7228>\>.
:   

\[RFC7641\]
:   [Hartke, K.]{.refAuthor}, [\"Observing Resources in the Constrained
    Application Protocol (CoAP)\"]{.refTitle}, [RFC 7641]{.seriesInfo},
    [DOI 10.17487/RFC7641]{.seriesInfo}, September 2015,
    \<<https://www.rfc-editor.org/info/rfc7641>\>.
:   

\[RFC8106\]
:   [Jeong, J.]{.refAuthor}, [Park, S.]{.refAuthor},
    [Beloeil, L.]{.refAuthor}, and [S. Madanapalli]{.refAuthor}, [\"IPv6
    Router Advertisement Options for DNS Configuration\"]{.refTitle},
    [RFC 8106]{.seriesInfo}, [DOI 10.17487/RFC8106]{.seriesInfo}, March
    2017, \<<https://www.rfc-editor.org/info/rfc8106>\>.
:   

\[RFC8132\]
:   [van der Stok, P.]{.refAuthor}, [Bormann, C.]{.refAuthor}, and [A.
    Sehgal]{.refAuthor}, [\"PATCH and FETCH Methods for the Constrained
    Application Protocol (CoAP)\"]{.refTitle}, [RFC 8132]{.seriesInfo},
    [DOI 10.17487/RFC8132]{.seriesInfo}, April 2017,
    \<<https://www.rfc-editor.org/info/rfc8132>\>.
:   

\[RFC8141\]
:   [Saint-Andre, P.]{.refAuthor} and [J. Klensin]{.refAuthor},
    [\"Uniform Resource Names (URNs)\"]{.refTitle}, [RFC
    8141]{.seriesInfo}, [DOI 10.17487/RFC8141]{.seriesInfo}, April 2017,
    \<<https://www.rfc-editor.org/info/rfc8141>\>.
:   

\[RFC8613\]
:   [Selander, G.]{.refAuthor}, [Mattsson, J.]{.refAuthor},
    [Palombini, F.]{.refAuthor}, and [L. Seitz]{.refAuthor}, [\"Object
    Security for Constrained RESTful Environments
    (OSCORE)\"]{.refTitle}, [RFC 8613]{.seriesInfo}, [DOI
    10.17487/RFC8613]{.seriesInfo}, July 2019,
    \<<https://www.rfc-editor.org/info/rfc8613>\>.
:   

\[T2TRG-REL-IMPL\]
:   [Bormann, C.]{.refAuthor}, [\"impl-info: A link relation type for
    disclosing implementation information\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-bormann-t2trg-rel-impl-02]{.seriesInfo}, 27 September 2020,
    \<<https://datatracker.ietf.org/doc/html/draft-bormann-t2trg-rel-impl-02>\>.
:   
:::
:::

::: {#groups}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Groups Registration and Lookup](#name-groups-registration-and-loo){.section-name .selfRef} {#name-groups-registration-and-loo}

The RD-Group\'s usage pattern allows announcing application groups
inside an RD.[¶](#appendix-A-1){.pilcrow}

Groups are represented by endpoint registrations. Their base address is
a multicast address, and they [SHOULD]{.bcp14} be entered with the
endpoint type `core.rd-group`. The endpoint name can also be referred to
as a group name in this context.[¶](#appendix-A-2){.pilcrow}

The registration is inserted into the RD by a Commissioning Tool, which
might also be known as a group manager here. It performs third-party
registration and registration updates.[¶](#appendix-A-3){.pilcrow}

The links it registers [SHOULD]{.bcp14} be available on all members that
join the group. Depending on the application, members that lack some
resources [MAY]{.bcp14} be permissible if requests to them fail
gracefully.[¶](#appendix-A-4){.pilcrow}

The following example shows a CT registering a group with the name
\"lights\", which provides two resources. The directory resource path
/rd is an example RD location discovered in a request similar to [Figure
5](#example-discovery){.xref}. The group address in the example is
constructed from the reserved 2001:db8:: prefix in
\[[RFC3849](#RFC3849){.xref}\] as a unicast-prefix-based site-local
address (see
\[[RFC3306](#RFC3306){.xref}\]).[¶](#appendix-A-5){.pilcrow}

[]{#name-example-registration-of-a-g}

::: {#example-group-registration}
::: {#appendix-A-6.1}
``` sourcecode
Req: POST coap://rd.example.com/rd?ep=lights&et=core.rd-group
                           &base=coap://[ff35:30:2001:db8:f1::8000:1]
Content-Format: 40
Payload:
</light>;rt="tag:example.com,2020:light";
     if="tag:example.net,2020:actuator",
</color-temperature>;if="tag:example.net,2020:parameter";u=K

Res: 2.01 Created
Location-Path: /rd/12
```
:::

[Figure 27](#figure-27){.selfRef}: [Example Registration of a
Group](#name-example-registration-of-a-g){.selfRef}
:::

In this example, the group manager can easily permit devices that have
no writable color-temperature to join, as they would still respond to
brightness-changing commands. Had the group instead contained a single
resource that sets brightness and color-temperature atomically,
endpoints would need to support both
properties.[¶](#appendix-A-7){.pilcrow}

The resources of a group can be looked up like any other resource, and
the group registrations (along with any additional registration
parameters) can be looked up using the endpoint lookup
interface.[¶](#appendix-A-8){.pilcrow}

The following example shows a client performing an endpoint lookup for
all groups:[¶](#appendix-A-9){.pilcrow}

[]{#name-example-lookup-of-groups}

::: {#example-group-lookup}
::: {#appendix-A-10.1}
``` sourcecode
Req: GET /rd-lookup/ep?et=core.rd-group

Res: 2.05 Content
Payload:
</rd/12>;ep=lights&et=core.rd-group;
         base="coap://[ff35:30:2001:f1:db8::8000:1]";rt=core.rd-ep
```
:::

[Figure 28](#figure-28){.selfRef}: [Example Lookup of
Groups](#name-example-lookup-of-groups){.selfRef}
:::

The following example shows a client performing a lookup of all
resources of all endpoints (groups) with
et=core.rd-group:[¶](#appendix-A-11){.pilcrow}

[]{#name-example-lookup-of-resources}

::: {#example-group-lookup-res}
::: {#appendix-A-12.1}
``` sourcecode
Req: GET /rd-lookup/res?et=core.rd-group

Res: 2.05 Content
Payload:
<coap://[ff35:30:2001:db8:f1::8000:1]/light>;
     rt="tag:example.com,2020:light";
     if="tag:example.net,2020:actuator",
<coap://[ff35:30:2001:db8:f1::8000:1]/color-temperature>;
     if="tag:example.net,2020:parameter";u=K,
```
:::

[Figure 29](#figure-29){.selfRef}: [Example Lookup of Resources Inside
Groups](#name-example-lookup-of-resources){.selfRef}
:::
:::
:::

::: {#weblink}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [Web Links and the Resource Directory](#name-web-links-and-the-resource-){.section-name .selfRef} {#name-web-links-and-the-resource-}

Understanding the semantics of a link-format document and its URI
references is a journey through different documents
(\[[RFC3986](#RFC3986){.xref}\] defining URIs,
\[[RFC6690](#RFC6690){.xref}\] defining link-format documents based on
\[[RFC8288](#RFC8288){.xref}\], which defines Link header fields, and
\[[RFC7252](#RFC7252){.xref}\] providing the transport). This appendix
summarizes the mechanisms and semantics at play from an entry in
`/.well-known/core` to a resource lookup.[¶](#appendix-B-1){.pilcrow}

This text is primarily aimed at people entering the field of Constrained
Restful Environments from applications that previously did not use web
mechanisms.[¶](#appendix-B-2){.pilcrow}

::: {#a-simple-example}
::: {#appendix-B.1 .section}
### [B.1.](#appendix-B.1){.section-number .selfRef} [A Simple Example](#name-a-simple-example){.section-name .selfRef} {#name-a-simple-example}

Let\'s start this example with a very simple host, `2001:db8:f0::1`. A
client that follows classical CoAP discovery
(\[[RFC7252](#RFC7252){.xref}\], [Section
7](https://www.rfc-editor.org/rfc/rfc7252#section-7){.relref}) sends the
following multicast request to learn about neighbors supporting
resources with resource-type
\"temperature\".[¶](#appendix-B.1-1){.pilcrow}

The client sends a link-local multicast:[¶](#appendix-B.1-2){.pilcrow}

[]{#name-example-of-direct-resource-}

::: {#example-weblink-wkc}
::: {#appendix-B.1-3.1}
``` sourcecode
Req: GET coap://[ff02::fd]:5683/.well-known/core?rt=temperature

Res: 2.05 Content
Payload:
</sensors/temp>;rt=temperature;ct=0
```
:::

[Figure 30](#figure-30){.selfRef}: [Example of Direct Resource
Discovery](#name-example-of-direct-resource-){.selfRef}
:::

where the response is sent by the server,
`[2001:db8:f0::1]:5683`.[¶](#appendix-B.1-4){.pilcrow}

While a practical client side implementation might just go ahead and
create a new request to `[2001:db8:f0::1]:5683` with Uri-Path `sensors`
and `temp`, the full resolution steps for insertion into and retrieval
from the RD without any shortcuts are as
follows.[¶](#appendix-B.1-5){.pilcrow}

::: {#resolveURI}
::: {#appendix-B.1.1 .section}
#### [B.1.1.](#appendix-B.1.1){.section-number .selfRef} [Resolving the URIs](#name-resolving-the-uris){.section-name .selfRef} {#name-resolving-the-uris}

The client parses the single returned link. Its target (sometimes called
\"href\") is `/sensors/temp`, which is a relative URI that needs
resolving. The base URI `coap://[ff02::fd]:5683/.well-known/core` is
used to resolve the reference against
`/sensors/temp`.[¶](#appendix-B.1.1-1){.pilcrow}

The base URI of the requested resource can be composed from the options
of the CoAP GET request by following the steps of
\[[RFC7252](#RFC7252){.xref}\], [Section
6.5](https://www.rfc-editor.org/rfc/rfc7252#section-6.5){.relref} (with
an addition at the end of Section
[8.2](https://www.rfc-editor.org/rfc/rfc7252#section-8.2){.relref}) into
`coap://[2001:db8:f0::1]/.well-known/core`.[¶](#appendix-B.1.1-2){.pilcrow}

Because `/sensors/temp` starts with a single slash, the link\'s target
is resolved by replacing the path `/.well-known/core` from the base URI
(\[[RFC3986](#RFC3986){.xref}\], [Section
5.2](https://www.rfc-editor.org/rfc/rfc3986#section-5.2){.relref}) with
the relative target URI `/sensors/temp` into
`coap://[2001:db8:f0::1]/sensors/temp`.[¶](#appendix-B.1.1-3){.pilcrow}
:::
:::

::: {#interpreting-attributes-and-relations}
::: {#appendix-B.1.2 .section}
#### [B.1.2.](#appendix-B.1.2){.section-number .selfRef} [Interpreting Attributes and Relations](#name-interpreting-attributes-and){.section-name .selfRef} {#name-interpreting-attributes-and}

Some more information about the link\'s target can be obtained from the
payload: the resource type of the target is \"temperature\", and its
content format is text/plain (ct=0).[¶](#appendix-B.1.2-1){.pilcrow}

A relation in a web link is a three-part statement that specifies a
named relation between the so-called \"context resource\" and the target
resource, like \"*This page* has *its table of contents* at
*/toc.html*\". In link-format documents, there is an implicit \"host
relation\" specified with default parameter
rel=\"hosts\".[¶](#appendix-B.1.2-2){.pilcrow}

In our example, the context resource of the link is implied to be
`coap:://[2001:db8:f0::1]` by the default value of the anchor (see
[Appendix B.4](#resolution-rules){.xref}). A full English expression of
the \"host relation\" is:[¶](#appendix-B.1.2-3){.pilcrow}

`coap://[2001:db8:f0::1]` is hosting the resource
`coap://[2001:db8:f0::1]/sensors/temp`, which is of the resource type
\"temperature\" and can be read in the text/plain content
format.[¶](#appendix-B.1.2-4){.pilcrow}
:::
:::
:::
:::

::: {#a-slightly-more-complex-example}
::: {#appendix-B.2 .section}
### [B.2.](#appendix-B.2){.section-number .selfRef} [A Slightly More Complex Example](#name-a-slightly-more-complex-exa){.section-name .selfRef} {#name-a-slightly-more-complex-exa}

Omitting the `rt=temperature` filter, the discovery query would have
given some more links in the payload:[¶](#appendix-B.2-1){.pilcrow}

[]{#name-extended-example-of-direct-}

::: {#example-weblink-wkc-extended}
::: {#appendix-B.2-2.1}
``` sourcecode
Req: GET coap://[ff02::fd]:5683/.well-known/core

Res: 2.05 Content
Payload:
</sensors/temp>;rt=temperature;ct=0,
</sensors/light>;rt=light-lux;ct=0,
</t>;anchor="/sensors/temp";rel=alternate,
<http://www.example.com/sensors/t123>;anchor="/sensors/temp";
    rel=describedby
```
:::

[Figure 31](#figure-31){.selfRef}: [Extended Example of Direct Resource
Discovery](#name-extended-example-of-direct-){.selfRef}
:::

Parsing the third link, the client encounters the \"anchor\" parameter.
It is a URI relative to the base URI of the request and is thus resolved
to `coap://[2001:db8:f0::1]/sensors/temp`. That is the context resource
of the link, so the \"rel\" statement is not about the target and the
base URI any more but about the target and the resolved URI. Thus, the
third link could be read as:[¶](#appendix-B.2-3){.pilcrow}

`coap://[2001:db8:f0::1]/sensors/temp` has an alternate representation
at `coap://[2001:db8:f0::1]/t`.[¶](#appendix-B.2-4){.pilcrow}

Following the same resolution steps, the fourth link can be read as
`coap://[2001:db8:f0::1]/sensors/temp` is described by
`http://www.example.com/sensors/t123`.[¶](#appendix-B.2-5){.pilcrow}
:::
:::

::: {#enter-the-resource-directory}
::: {#appendix-B.3 .section}
### [B.3.](#appendix-B.3){.section-number .selfRef} [Enter the Resource Directory](#name-enter-the-resource-director){.section-name .selfRef} {#name-enter-the-resource-director}

The RD tries to carry the semantics obtainable by classical CoAP
discovery over to the resource lookup interface as faithfully as
possible.[¶](#appendix-B.3-1){.pilcrow}

For the following queries, we will assume that the simple host has used
simple registration to register at the RD that was announced to it,
sending this request from its UDP port
`[2001:db8:f0::1]:6553`:[¶](#appendix-B.3-2){.pilcrow}

[]{#name-example-of-a-simple-registr}

::: {#example-weblink-simple}
::: {#appendix-B.3-3.1}
``` sourcecode
Req: POST coap://[2001:db8:f0::ff]/.well-known/rd?ep=simple-host1

Res: 2.04 Changed
```
:::

[Figure 32](#figure-32){.selfRef}: [Example of a Simple
Registration](#name-example-of-a-simple-registr){.selfRef}
:::

The RD would have accepted the registration and queried the simple
host\'s `/.well-known/core` by itself. As a result, the host is
registered as an endpoint in the RD with the name \"simple-host1\". The
registration is active for 90000 seconds, and the endpoint registration
base URI is `coap://[2001:db8:f0::1]`, following the resolution steps
described in [Appendix B.1.1](#resolveURI){.xref}. It should be remarked
that the base URI constructed that way always yields a URI of the form
scheme://authority without path suffix.[¶](#appendix-B.3-4){.pilcrow}

If the client now queries the RD as it would previously have issued a
multicast request, it would go through the RD discovery steps by
fetching
`coap://[2001:db8:f0::ff]/.well-known/core?rt=core.rd-lookup-res`,
obtain `coap://[2001:db8:f0::ff]/rd-lookup/res` as the resource lookup
endpoint, and ask it for all temperature
resources:[¶](#appendix-B.3-5){.pilcrow}

[]{#name-example-exchange-performing}

::: {#example-weblink-lookup-result}
::: {#appendix-B.3-6.1}
``` sourcecode
Req: GET coap://[2001:db8:f0::ff]/rd-lookup/res?rt=temperature

Res: 2.05 Content
Payload:
<coap://[2001:db8:f0::1]/sensors/temp>;rt=temperature;ct=0
```
:::

[Figure 33](#figure-33){.selfRef}: [Example Exchange Performing Resource
Lookup](#name-example-exchange-performing){.selfRef}
:::

This is not *literally* the same response that it would have received
from a multicast request, but it contains the equivalent
statement:[¶](#appendix-B.3-7){.pilcrow}

`coap://[2001:db8:f0::1]` is hosting the resource
`coap://[2001:db8:f0::1]/sensors/temp`, which is of the resource type
\"temperature\" and can be accessed using the text/plain content
format.[¶](#appendix-B.3-8){.pilcrow}

To complete the examples, the client could also query all resources
hosted at the endpoint with the known endpoint name
\"simple-host1\":[¶](#appendix-B.3-9){.pilcrow}

[]{#name-extended-example-exchange-p}

::: {#example-weblink-lookup-result-extended}
::: {#appendix-B.3-10.1}
``` sourcecode
Req: GET coap://[2001:db8:f0::ff]/rd-lookup/res?ep=simple-host1

Res: 2.05 Content
Payload:
<coap://[2001:db8:f0::1]/sensors/temp>;rt=temperature;ct=0,
<coap://[2001:db8:f0::1]/sensors/light>;rt=light-lux;ct=0,
<coap://[2001:db8:f0::1]/t>;
    anchor="coap://[2001:db8:f0::1]/sensors/temp";rel=alternate,
<http://www.example.com/sensors/t123>;
    anchor="coap://[2001:db8:f0::1]/sensors/temp";rel=describedby
```
:::

[Figure 34](#figure-34){.selfRef}: [Extended Example Exchange Performing
Resource Lookup](#name-extended-example-exchange-p){.selfRef}
:::

All the target and anchor references are already in absolute form there,
which don\'t need to be resolved any
further.[¶](#appendix-B.3-11){.pilcrow}

Had the simple host done an equivalent full registration with a base=
parameter (e.g., `?ep=simple-host1&base=coap+tcp://sh1.example.com`),
that context would have been used to resolve the relative anchor values
instead, giving the following and analogous
links:[¶](#appendix-B.3-12){.pilcrow}

[]{#name-example-payload-of-a-respon}

::: {#example-weblink-lookup-result-base}
::: {#appendix-B.3-13.1}
``` sourcecode
<coap+tcp://sh1.example.com/sensors/temp>;rt=temperature;ct=0
```
:::

[Figure 35](#figure-35){.selfRef}: [Example Payload of a Response to a
Resource Lookup with a Dedicated Base
URI](#name-example-payload-of-a-respon){.selfRef}
:::
:::
:::

::: {#resolution-rules}
::: {#appendix-B.4 .section}
### [B.4.](#appendix-B.4){.section-number .selfRef} [A Note on Differences between Link-Format and Link Header Fields](#name-a-note-on-differences-betwe){.section-name .selfRef} {#name-a-note-on-differences-betwe}

While link-format and Link header fields look very similar and are based
on the same model of typed links, there are some differences between
\[[RFC6690](#RFC6690){.xref}\] and \[[RFC8288](#RFC8288){.xref}\]. When
implementing an RD or interacting with an RD, care must be taken to
follow the behavior described in \[[RFC6690](#RFC6690){.xref}\] whenever
`application/link-format` representations are
used.[¶](#appendix-B.4-1){.pilcrow}

-   ::: {#appendix-B.4-2.1}
    \"Default value of anchor\": Under both
    \[[RFC6690](#RFC6690){.xref}\] and \[[RFC8288](#RFC8288){.xref}\],
    relative references in the term inside the angle brackets (the
    target) and the anchor attribute are resolved against the relevant
    base URI (which usually is the URI used to retrieve the entity) and
    independent of each other.[¶](#appendix-B.4-2.1.1){.pilcrow}

    When, in a Link header \[[RFC8288](#RFC8288){.xref}\], the anchor
    attribute is absent, the link\'s context is the URI of the selected
    representation (and usually equal to the base
    URI).[¶](#appendix-B.4-2.1.2){.pilcrow}

    In links per \[[RFC6690](#RFC6690){.xref}\], if the anchor attribute
    is absent, the default value is the Origin of (for all relevant
    cases, the URI reference `/` resolved against) the link\'s
    target.[¶](#appendix-B.4-2.1.3){.pilcrow}
    :::

-   ::: {#appendix-B.4-2.2}
    There is no percent encoding in link-format
    documents.[¶](#appendix-B.4-2.2.1){.pilcrow}

    A link-format document is a UTF-8-encoded string of Unicode
    characters and does not have percent encoding, while Link header
    fields are practically ASCII strings that use percent encoding for
    non-ASCII characters, stating the encoding explicitly when
    required.[¶](#appendix-B.4-2.2.2){.pilcrow}

    For example, while a Link header field in a page about a Swedish
    city might read:[¶](#appendix-B.4-2.2.3){.pilcrow}

    ::: {#appendix-B.4-2.2.4}
    ``` {.lang-http-message .sourcecode}
    Link: </temperature/Malm%C3%B6>;rel=live-environment-data
    ```

    [¶](#appendix-B.4-2.2.4){.pilcrow}
    :::

    a link-format document from the same source might describe the link
    as:[¶](#appendix-B.4-2.2.5){.pilcrow}

    ::: {#appendix-B.4-2.2.6}
    ``` sourcecode
    </temperature/Malmö>;rel=live-environment-data
    ```

    [¶](#appendix-B.4-2.2.6){.pilcrow}
    :::
    :::
:::
:::
:::
:::

::: {#limitedlinkformat}
::: {#appendix-C .section}
## [Appendix C.](#appendix-C){.section-number .selfRef} [Limited Link Format](#name-limited-link-format){.section-name .selfRef} {#name-limited-link-format}

The CoRE Link Format, as described in \[[RFC6690](#RFC6690){.xref}\],
has been interpreted differently by implementers, and a strict
implementation rules out some use cases of an RD (e.g., base values with
path components in combination with absent
anchors).[¶](#appendix-C-1){.pilcrow}

This appendix describes a subset of link format documents called the
Limited Link Format. The one rule herein is not very limiting in
practice \-- all examples in \[[RFC6690](#RFC6690){.xref}\] and all
deployments the authors are aware of already stick to them \-- but eases
the implementation of RD servers.[¶](#appendix-C-2){.pilcrow}

It is applicable to representations in the `application/link-format`
media type and any other media types that inherit
\[[RFC6690](#RFC6690){.xref}\], [Section
2.1](https://www.rfc-editor.org/rfc/rfc6690#section-2.1){.relref}.[¶](#appendix-C-3){.pilcrow}

A link format representation is in the Limited Link Format if, for each
link in it, the following applies:[¶](#appendix-C-4){.pilcrow}

All URI references either follow the URI or the path-absolute ABNF rule
of \[[RFC3986](#RFC3986){.xref}\] (i.e., the target and anchor each
either start with a scheme or with a single
slash).[¶](#appendix-C-5){.pilcrow}
:::
:::

::: {#acknowledgments}
::: {#appendix-D .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

[Oscar Novo]{.contact-name}, [Srdjan Krco]{.contact-name}, [Szymon
Sasin]{.contact-name}, [Kerry Lynn]{.contact-name}, [Esko
Dijk]{.contact-name}, [Anders Brandt]{.contact-name}, [Matthieu
Vial]{.contact-name}, [Jim Schaad]{.contact-name}, [Mohit
Sethi]{.contact-name}, [Hauke Petersen]{.contact-name}, [Hannes
Tschofenig]{.contact-name}, [Sampo Ukkola]{.contact-name}, [Linyi
Tian]{.contact-name}, [Jan Newmarch]{.contact-name}, [Matthias
Kovatsch]{.contact-name}, [Jaime Jimenez]{.contact-name}, and [Ted
Lemon]{.contact-name} have provided helpful comments, discussions, and
ideas to improve and shape this document. Zach would also like to thank
his colleagues from the EU FP7 SENSEI project, where many of the RD
concepts were originally developed.[¶](#appendix-D-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-E .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Christian Amsüss ([editor]{.role})]{.fn .nameRole}
:::

::: email
Email: <christian@amsuess.com>
:::

::: {.left dir="auto"}
[Zach Shelby]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Edge Impulse]{.org}
:::

::: {.left dir="auto"}
[3031 Tisch Way]{.street-address}
:::

::: {.left dir="auto"}
[San Jose]{.locality}, [95128]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <zach@edgeimpulse.com>
:::

::: {.left dir="auto"}
[Michael Koster]{.fn .nameRole}
:::

::: {.left dir="auto"}
[PassiveLogic]{.org}
:::

::: {.left dir="auto"}
[524 H Street]{.street-address}
:::

::: {.left dir="auto"}
[Antioch]{.locality}, [CA]{.region} [94509]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1-707-502-5136](tel:+1-707-502-5136){.tel}
:::

::: email
Email: <michaeljohnkoster@gmail.com>
:::

::: {.left dir="auto"}
[Carsten Bormann]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Universität Bremen TZI]{.org}
:::

::: {.left dir="auto"}
[Postfach 330440]{.street-address}
:::

::: {.left dir="auto"}
[D-28359]{.postal-code} [Bremen]{.locality}
:::

::: {.left dir="auto"}
[Germany]{.country-name}
:::

::: tel
Phone: [+49-421-218-63921](tel:+49-421-218-63921){.tel}
:::

::: email
Email: <cabo@tzi.org>
:::

::: {.left dir="auto"}
[Peter van der Stok]{.fn .nameRole}
:::

::: {.left dir="auto"}
[vanderstok consultancy]{.org}
:::

::: email
Email: <stokcons@bbhmail.nl>
:::
:::
:::
