  RFC 9300            LISP              October 2022
  ------------------- ----------------- --------------
  Farinacci, et al.   Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9300](https://www.rfc-editor.org/rfc/rfc9300){.eref}

Obsoletes:
:   [6830](https://www.rfc-editor.org/rfc/rfc6830){.eref}

Category:
:   Standards Track

Published:
:   October 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    D. Farinacci
    :::

    ::: org
    lispers.net
    :::
    :::

    ::: author
    ::: author-name
    V. Fuller
    :::

    ::: org
    vaf.net Internet Consulting
    :::
    :::

    ::: author
    ::: author-name
    D. Meyer
    :::

    ::: org
    1-4-5.net
    :::
    :::

    ::: author
    ::: author-name
    D. Lewis
    :::

    ::: org
    Cisco Systems
    :::
    :::

    ::: author
    ::: author-name
    A. Cabellos, [Ed.]{.editor}
    :::

    ::: org
    Universitat Politecnica de Catalunya
    :::
    :::
:::

# RFC 9300 {#rfcnum}

# The Locator/ID Separation Protocol (LISP) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes the data plane protocol for the Locator/ID
Separation Protocol (LISP). LISP defines two namespaces: Endpoint
Identifiers (EIDs), which identify end hosts; and Routing Locators
(RLOCs), which identify network attachment points. With this, LISP
effectively separates control from data and allows routers to create
overlay networks. LISP-capable routers exchange encapsulated packets
according to EID-to-RLOC mappings stored in a local
Map-Cache.[¶](#section-abstract-1){.pilcrow}

LISP requires no change to either host protocol stacks or underlay
routers and offers Traffic Engineering (TE), multihoming, and mobility,
among other features.[¶](#section-abstract-2){.pilcrow}

This document obsoletes RFC 6830.[¶](#section-abstract-3){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9300>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.auto .internal
    .xref}.  [Introduction](#name-introduction){.internal .xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.auto .internal .xref}.  [Scope of
        Applicability](#name-scope-of-applicability){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.auto .internal .xref}.  [Requirements
    Notation](#name-requirements-notation){.internal .xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.auto .internal .xref}.  [Definitions of
    Terms](#name-definitions-of-terms){.internal .xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.auto .internal .xref}.  [Basic
    Overview](#name-basic-overview){.internal .xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.auto .internal .xref}.  [Deployment on the
        Public Internet](#name-deployment-on-the-public-in){.internal
        .xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.auto .internal .xref}.  [Packet Flow
        Sequence](#name-packet-flow-sequence){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.auto .internal .xref}.  [LISP Encapsulation
    Details](#name-lisp-encapsulation-details){.internal .xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.auto .internal .xref}.  [LISP IPv4-in-IPv4
        Header Format](#name-lisp-ipv4-in-ipv4-header-fo){.internal
        .xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.auto .internal .xref}.  [LISP IPv6-in-IPv6
        Header Format](#name-lisp-ipv6-in-ipv6-header-fo){.internal
        .xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.auto .internal .xref}.  [Tunnel Header
        Field Descriptions](#name-tunnel-header-field-descrip){.internal
        .xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.auto .internal .xref}.  [LISP EID-to-RLOC
    Map-Cache](#name-lisp-eid-to-rloc-map-cache){.internal .xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.auto .internal .xref}.  [Dealing with Large
    Encapsulated Packets](#name-dealing-with-large-encapsul){.internal
    .xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.auto .internal .xref}.  [A Stateless
        Solution to MTU
        Handling](#name-a-stateless-solution-to-mtu){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.auto .internal .xref}.  [A Stateful
        Solution to MTU
        Handling](#name-a-stateful-solution-to-mtu-){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.auto .internal .xref}.  [Using Virtualization and
    Segmentation with LISP](#name-using-virtualization-and-se){.internal
    .xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.auto .internal .xref}.  [Routing Locator
    Selection](#name-routing-locator-selection){.internal .xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.auto .internal .xref}. [Routing Locator
    Reachability](#name-routing-locator-reachabilit){.internal .xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.auto .internal .xref}.  [Echo-Nonce
        Algorithm](#name-echo-nonce-algorithm){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.auto .internal .xref}. [EID Reachability within a
    LISP Site](#name-eid-reachability-within-a-l){.internal .xref}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.auto .internal .xref}. [Routing Locator
    Hashing](#name-routing-locator-hashing){.internal .xref}
    :::

-   ::: {#section-toc.1-1.13}
    [13](#section-13){.auto .internal .xref}. [Changing the Contents of
    EID-to-RLOC Mappings](#name-changing-the-contents-of-ei){.internal
    .xref}

    -   ::: {#section-toc.1-1.13.2.1}
        [13.1](#section-13.1){.auto .internal
        .xref}.  [Locator-Status-Bits](#name-locator-status-bits){.internal
        .xref}
        :::

    -   ::: {#section-toc.1-1.13.2.2}
        [13.2](#section-13.2){.auto .internal .xref}.  [Database
        Map-Versioning](#name-database-map-versioning){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.14}
    [14](#section-14){.auto .internal .xref}. [Multicast
    Considerations](#name-multicast-considerations){.internal .xref}
    :::

-   ::: {#section-toc.1-1.15}
    [15](#section-15){.auto .internal .xref}. [Router Performance
    Considerations](#name-router-performance-consider){.internal .xref}
    :::

-   ::: {#section-toc.1-1.16}
    [16](#section-16){.auto .internal .xref}. [Security
    Considerations](#name-security-considerations){.internal .xref}
    :::

-   ::: {#section-toc.1-1.17}
    [17](#section-17){.auto .internal .xref}. [Network Management
    Considerations](#name-network-management-consider){.internal .xref}
    :::

-   ::: {#section-toc.1-1.18}
    [18](#section-18){.auto .internal .xref}. [Changes since RFC
    6830](#name-changes-since-rfc-6830){.internal .xref}
    :::

-   ::: {#section-toc.1-1.19}
    [19](#section-19){.auto .internal .xref}. [IANA
    Considerations](#name-iana-considerations){.internal .xref}

    -   ::: {#section-toc.1-1.19.2.1}
        [19.1](#section-19.1){.auto .internal .xref}.  [LISP UDP Port
        Numbers](#name-lisp-udp-port-numbers){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.20}
    [20](#section-20){.auto .internal
    .xref}. [References](#name-references){.internal .xref}

    -   ::: {#section-toc.1-1.20.2.1}
        [20.1](#section-20.1){.auto .internal .xref}.  [Normative
        References](#name-normative-references){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.20.2.2}
        [20.2](#section-20.2){.auto .internal .xref}.  [Informative
        References](#name-informative-references){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.21}
    [](#appendix-A){.auto .internal
    .xref}[Acknowledgments](#name-acknowledgments){.internal .xref}
    :::

-   ::: {#section-toc.1-1.22}
    [](#appendix-B){.auto .internal .xref}[Authors\'
    Addresses](#name-authors-addresses){.internal .xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document describes the Locator/ID Separation Protocol (LISP). LISP
is an encapsulation protocol built around the fundamental idea of
separating the topological location of a network attachment point from
the node\'s identity \[[CHIAPPA](#CHIAPPA){.cite .xref}\]. As a result,
LISP creates two namespaces: Endpoint Identifiers (EIDs), which are used
to identify end hosts (e.g., nodes or Virtual Machines); and routable
Routing Locators (RLOCs), which are used to identify network attachment
points. LISP then defines functions for mapping between the two
namespaces and for encapsulating traffic originated by devices using
non-routable EIDs for transport across a network infrastructure that
routes and forwards using RLOCs. LISP encapsulation uses a dynamic form
of tunneling where no static provisioning is required or
necessary.[¶](#section-1-1){.pilcrow}

LISP is an overlay protocol that separates control from data; this
document specifies the data plane as well as how LISP-capable routers
(Tunnel Routers) exchange packets by encapsulating them to the
appropriate location. Tunnel Routers are equipped with a cache, called
the Map-Cache, that contains EID-to-RLOC mappings. The Map-Cache is
populated using the LISP control plane protocol
\[[RFC9301](#RFC9301){.cite .xref}\].[¶](#section-1-2){.pilcrow}

LISP does not require changes to either the host protocol stack or
underlay routers. By separating the EID from the RLOC space, LISP offers
native Traffic Engineering (TE), multihoming, and mobility, among other
features.[¶](#section-1-3){.pilcrow}

Creation of LISP was initially motivated by discussions during the
IAB-sponsored Routing and Addressing Workshop held in Amsterdam in
October 2006 (see \[[RFC4984](#RFC4984){.cite
.xref}\]).[¶](#section-1-4){.pilcrow}

This document specifies the LISP data plane encapsulation and other LISP
forwarding node functionality while \[[RFC9301](#RFC9301){.cite .xref}\]
specifies the LISP control plane. LISP deployment guidelines can be
found in \[[RFC7215](#RFC7215){.cite .xref}\], and
\[[RFC6835](#RFC6835){.cite .xref}\] describes considerations for
network operational management. Finally, \[[RFC9299](#RFC9299){.cite
.xref}\] describes the LISP architecture.[¶](#section-1-5){.pilcrow}

This document obsoletes RFC 6830.[¶](#section-1-6){.pilcrow}

::: {#soa}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Scope of Applicability](#name-scope-of-applicability){.section-name .selfRef} {#name-scope-of-applicability}

LISP was originally developed to address the Internet-wide route scaling
problem \[[RFC4984](#RFC4984){.cite .xref}\]. While there are a number
of approaches of interest for that problem, as LISP has been developed
and refined, a large number of other ways to use LISP have been found
and are being implemented. As such, the design and development of LISP
have changed so as to focus on these use cases. The common property of
these uses is a large set of cooperating entities seeking to communicate
over the public Internet or other large underlay IP infrastructures
while keeping the addressing and topology of the cooperating entities
separate from the underlay and Internet topology, routing, and
addressing.[¶](#section-1.1-1){.pilcrow}
:::
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Requirements Notation](#name-requirements-notation){.section-name .selfRef} {#name-requirements-notation}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.cite .xref}\]
\[[RFC8174](#RFC8174){.cite .xref}\] when, and only when, they appear in
all capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::

::: {#DEFINITIONS}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Definitions of Terms](#name-definitions-of-terms){.section-name .selfRef} {#name-definitions-of-terms}

[]{.break}

Address Family Identifier (AFI):
:   \"AFI\" is a term used to describe an address encoding in a packet.
    An address family is an address format found in data plane packet
    headers, for example, an IPv4 address or an IPv6 address. See
    \[[AFN](#AFN){.cite .xref}\], \[[RFC2453](#RFC2453){.cite .xref}\],
    \[[RFC2677](#RFC2677){.cite .xref}\], and
    \[[RFC4760](#RFC4760){.cite .xref}\] for details. An AFI value of 0
    used in this specification indicates an unspecified encoded address
    where the length of the address is 0 octets following the 16-bit AFI
    value of 0.[¶](#section-3-1.2){.pilcrow}
:   

Anycast Address:
:   \"Anycast address\" refers to the same IPv4 or IPv6 address
    configured and used on multiple systems at the same time. An EID or
    RLOC can be an anycast address in each of their own address
    spaces.[¶](#section-3-1.4){.pilcrow}
:   

Client-side:
:   \"Client-side\" is a term used in this document to indicate a
    connection initiation attempt by an end-system represented by an
    EID.[¶](#section-3-1.6){.pilcrow}
:   

Egress Tunnel Router (ETR):
:   An ETR is a router that accepts an IP packet where the destination
    address in the \"outer\" IP header is one of its own RLOCs. The
    router strips the \"outer\" header and forwards the packet based on
    the next IP header found. In general, an ETR receives
    LISP-encapsulated IP packets from the Internet on one side and sends
    decapsulated IP packets to site end-systems on the other side. ETR
    functionality does not have to be limited to a router device. A
    server host can be the endpoint of a LISP tunnel as
    well.[¶](#section-3-1.8){.pilcrow}
:   

EID-to-RLOC Database:
:   The EID-to-RLOC Database is a distributed database that contains all
    known EID-Prefix-to-RLOC mappings. Each potential ETR typically
    contains a small piece of the database: the EID-to-RLOC mappings for
    the EID-Prefixes \"behind\" the router. These map to one of the
    router\'s own IP addresses that are routable on the underlay. Note
    that there [MAY]{.bcp14} be transient conditions when the EID-Prefix
    for the LISP site and Locator-Set for each EID-Prefix may not be the
    same on all ETRs. This has no negative implications, since a partial
    set of Locators can be used.[¶](#section-3-1.10){.pilcrow}
:   

EID-to-RLOC Map-Cache:
:   The EID-to-RLOC Map-Cache is a generally short-lived, on-demand
    table in an Ingress Tunnel Router (ITR) that stores, tracks, and is
    responsible for timing out and otherwise validating EID-to-RLOC
    mappings. This cache is distinct from the full \"database\" of
    EID-to-RLOC mappings; it is dynamic, local to the ITR(s), and
    relatively small, while the database is distributed, relatively
    static, and much more widely scoped to LISP
    nodes.[¶](#section-3-1.12){.pilcrow}
:   

EID-Prefix:
:   An EID-Prefix is a power-of-two block of EIDs that are allocated to
    a site by an address allocation authority. EID-Prefixes are
    associated with a set of RLOC addresses. EID-Prefix allocations can
    be broken up into smaller blocks when an RLOC-Set is to be
    associated with the larger EID-Prefix
    block.[¶](#section-3-1.14){.pilcrow}
:   

End-System:
:   An end-system is an IPv4 or IPv6 device that originates packets with
    a single IPv4 or IPv6 header. The end-system supplies an EID value
    for the destination address field of the IP header when
    communicating outside of its routing domain. An end-system can be a
    host computer, a switch or router device, or any network
    appliance.[¶](#section-3-1.16){.pilcrow}
:   

Endpoint ID (EID):
:   An EID is a 32-bit (for IPv4) or 128-bit (for IPv6) value that
    identifies a host. EIDs are generally only found in the source and
    destination address fields of the first (innermost) LISP header of a
    packet. The host obtains a destination EID through a Domain Name
    System (DNS) \[[RFC1034](#RFC1034){.cite .xref}\] lookup or Session
    Initiation Protocol (SIP) \[[RFC3261](#RFC3261){.cite .xref}\]
    exchange. This behavior does not change when LISP is in use. The
    source EID is obtained via existing mechanisms used to set a host\'s
    \"local\" IP address. An EID used on the public Internet
    [MUST]{.bcp14} have the same properties as any other IP address used
    in that manner; this means, among other things, that it
    [MUST]{.bcp14} be unique. An EID is allocated to a host from an
    EID-Prefix block associated with the site where the host is located.
    An EID can be used by a host to refer to other hosts. Note that EID
    blocks [MAY]{.bcp14} be assigned in a hierarchical manner,
    independent of the network topology, to facilitate scaling of the
    mapping database. In addition, an EID block assigned to a site
    [MAY]{.bcp14} have site-local structure (subnetting) for routing
    within the site; this structure is not visible to the underlay
    routing system. In theory, the bit string that represents an EID for
    one device can represent an RLOC for a different device. When
    discussing other Locator/ID separation proposals, any references to
    an EID in this document will refer to a LISP
    EID.[¶](#section-3-1.18){.pilcrow}
:   

Ingress Tunnel Router (ITR):
:   An ITR is a router that resides in a LISP site. Packets sent by
    sources inside of the LISP site to destinations outside of the site
    are candidates for encapsulation by the ITR. The ITR treats the IP
    destination address as an EID and performs an EID-to-RLOC mapping
    lookup. The router then prepends an \"outer\" IP header with one of
    its routable RLOCs (in the RLOC space) in the source address field
    and the result of the mapping lookup in the destination address
    field. Note that this destination RLOC may be an intermediate, proxy
    device that has better knowledge of the EID-to-RLOC mapping closer
    to the destination EID. In general, an ITR receives IP packets from
    site end-systems on one side and sends LISP-encapsulated IP packets
    toward the Internet on the other side.[¶](#section-3-1.20){.pilcrow}
:   

LISP Header:
:   \"LISP header\" is a term used in this document to refer to the
    outer IPv4 or IPv6 header, a UDP header, and a LISP- specific
    8-octet header, all of which follow the UDP header. An ITR prepends
    LISP headers on packets, and an ETR strips
    them.[¶](#section-3-1.22){.pilcrow}
:   

LISP Router:
:   A LISP router is a router that performs the functions of any or all
    of the following: ITRs, ETRs, Re-encapsulating Tunneling Routers
    (RTRs), Proxy-ITRs (PITRs), or Proxy-ETRs
    (PETRs).[¶](#section-3-1.24){.pilcrow}
:   

LISP Site:
:   A LISP site is a set of routers in an edge network that are under a
    single technical administration. LISP routers that reside in the
    edge network are the demarcation points to separate the edge network
    from the core network.[¶](#section-3-1.26){.pilcrow}
:   

Locator-Status-Bits (LSBs):
:   Locator-Status-Bits are present in the LISP header. They are used by
    ITRs to inform ETRs about the up/down status of all ETRs at the
    local site. These bits are used as a hint to convey up/down router
    status and not path reachability status. The LSBs can be verified by
    use of one of the Locator reachability algorithms described in
    [Section 10](#loc-reach){.auto .internal .xref}. An ETR
    [MUST]{.bcp14} rate limit the action it takes when it detects
    changes in the Locator-Status-Bits.[¶](#section-3-1.28){.pilcrow}
:   

Proxy-ETR (PETR):
:   A PETR is defined and described in \[[RFC6832](#RFC6832){.cite
    .xref}\]. A PETR acts like an ETR but does so on behalf of LISP
    sites that send packets to destinations at non-LISP
    sites.[¶](#section-3-1.30){.pilcrow}
:   

Proxy-ITR (PITR):
:   A PITR is defined and described in \[[RFC6832](#RFC6832){.cite
    .xref}\]. A PITR acts like an ITR but does so on behalf of non-LISP
    sites that send packets to destinations at LISP
    sites.[¶](#section-3-1.32){.pilcrow}
:   

Recursive Tunneling:
:   Recursive Tunneling occurs when a packet has more than one LISP IP
    header. Additional layers of tunneling [MAY]{.bcp14} be employed to
    implement Traffic Engineering or other rerouting as needed. When
    this is done, an additional \"outer\" LISP header is added, and the
    original RLOCs are preserved in the \"inner\"
    header.[¶](#section-3-1.34){.pilcrow}
:   

Re-encapsulating Tunneling Router (RTR):
:   An RTR acts like an ETR to remove a LISP header, then acts as an ITR
    to prepend a new LISP header. This is known as Re-encapsulating
    Tunneling. Doing this allows a packet to be rerouted by the RTR
    without adding the overhead of additional tunnel headers. When using
    multiple mapping database systems, care must be taken to not create
    re-encapsulation loops through
    misconfiguration.[¶](#section-3-1.36){.pilcrow}
:   

Route-Returnability:
:   Route-returnability is an assumption that the underlying routing
    system will deliver packets to the destination. When combined with a
    nonce that is provided by a sender and returned by a receiver, this
    limits off-path data insertion. A route-returnability check is
    verified when a message is sent with a nonce, another message is
    returned with the same nonce, and the destination of the original
    message appears as the source of the returned
    message.[¶](#section-3-1.38){.pilcrow}
:   

Routing Locator (RLOC):
:   An RLOC is an IPv4 address \[[RFC0791](#RFC0791){.cite .xref}\] or
    IPv6 address \[[RFC8200](#RFC8200){.cite .xref}\] of an Egress
    Tunnel Router (ETR). An RLOC is the output of an EID-to-RLOC mapping
    lookup. An EID maps to zero or more RLOCs. Typically, RLOCs are
    numbered from blocks that are assigned to a site at each point to
    which it attaches to the underlay network, where the topology is
    defined by the connectivity of provider networks. Multiple RLOCs can
    be assigned to the same ETR device or to multiple ETR devices at a
    site.[¶](#section-3-1.40){.pilcrow}
:   

Server-side:
:   \"Server-side\" is a term used in this document to indicate that a
    connection initiation attempt is being accepted for a destination
    EID.[¶](#section-3-1.42){.pilcrow}
:   

xTR:
:   An xTR is a reference to an ITR or ETR when direction of data flow
    is not part of the context description. \"xTR\" refers to the router
    that is the tunnel endpoint and is used synonymously with the term
    \"Tunnel Router\". For example, \"An xTR can be located at the
    Customer Edge (CE) router\" indicates both ITR and ETR functionality
    at the CE router.[¶](#section-3-1.44){.pilcrow}
:   
:::
:::

::: {#OVERVIEW}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Basic Overview](#name-basic-overview){.section-name .selfRef} {#name-basic-overview}

One key concept of LISP is that end-systems operate the same way when
LISP is not in use as well as when LISP is in use. The IP addresses that
hosts use for tracking sockets and connections, and for sending and
receiving packets, do not change. In LISP terminology, these IP
addresses are called Endpoint Identifiers
(EIDs).[¶](#section-4-1){.pilcrow}

Routers continue to forward packets based on IP destination addresses.
When a packet is LISP encapsulated, these addresses are referred to as
RLOCs. Most routers along a path between two hosts will not change; they
continue to perform routing/forwarding lookups on the destination
addresses. For routers between the source host and the ITR as well as
routers from the ETR to the destination host, the destination address is
an EID. For the routers between the ITR and the ETR, the destination
address is an RLOC.[¶](#section-4-2){.pilcrow}

Another key LISP concept is the \"Tunnel Router\". A Tunnel Router
prepends LISP headers on host-originated packets and strips them prior
to final delivery to their destination. The IP addresses in this \"outer
header\" are RLOCs. During end-to-end packet exchange between two
Internet hosts, an ITR prepends a new LISP header to each packet, and an
ETR strips the new header. The ITR performs EID-to-RLOC lookups to
determine the routing path to the ETR, which has the RLOC as one of its
IP addresses.[¶](#section-4-3){.pilcrow}

Some basic rules governing LISP are:[¶](#section-4-4){.pilcrow}

-   [End-systems only send to addresses that are EIDs. EIDs are
    typically IP addresses assigned to hosts (other types of EIDs are
    supported by LISP; see \[[RFC8060](#RFC8060){.cite .xref}\] for
    further information). End-systems don\'t know that addresses are
    EIDs versus RLOCs but assume that packets get to their intended
    destinations. In a system where LISP is deployed, LISP routers
    intercept EID-addressed packets and assist in delivering them across
    the network core where EIDs cannot be routed. The procedure a host
    uses to send IP packets does not
    change.[¶](#section-4-5.1){.pilcrow}]{#section-4-5.1}
-   [LISP routers prepend and strip outer headers with RLOC addresses.
    See [Section 4.2](#MOSTLY){.auto .internal .xref} for
    details.[¶](#section-4-5.2){.pilcrow}]{#section-4-5.2}
-   [RLOCs are always IP addresses assigned to routers, preferably
    topologically oriented addresses from provider Classless
    Inter-Domain Routing (CIDR)
    blocks.[¶](#section-4-5.3){.pilcrow}]{#section-4-5.3}
-   [When a router originates packets, it [MAY]{.bcp14} use as a source
    address either an EID or RLOC. When acting as a host (e.g., when
    terminating a transport session such as Secure Shell (SSH), TELNET,
    or the Simple Network Management Protocol (SNMP)), it [MAY]{.bcp14}
    use an EID that is explicitly assigned for that purpose. An EID that
    identifies the router as a host [MUST NOT]{.bcp14} be used as an
    RLOC; an EID is only routable within the scope of a site. A typical
    BGP configuration might demonstrate this \"hybrid\" EID/RLOC usage
    where a router could use its \"host-like\" EID to terminate internal
    BGP (iBGP) sessions to other routers in a site while at the same
    time using RLOCs to terminate external BGP (eBGP) sessions to
    routers outside the
    site.[¶](#section-4-5.4){.pilcrow}]{#section-4-5.4}
-   [Packets with EIDs in them are not expected to be delivered end to
    end in the absence of an EID-to-RLOC mapping operation. They are
    expected to be used locally for intra-site communication or to be
    encapsulated for inter-site
    communication.[¶](#section-4-5.5){.pilcrow}]{#section-4-5.5}
-   [EIDs [MAY]{.bcp14} also be structured (subnetted) in a manner
    suitable for local routing within an Autonomous System
    (AS).[¶](#section-4-5.6){.pilcrow}]{#section-4-5.6}

An additional LISP header [MAY]{.bcp14} be prepended to packets by a
TE-ITR when rerouting of the path for a packet is desired. A potential
use case for this would be an ISP router that needs to perform Traffic
Engineering for packets flowing through its network. In such a
situation, termed \"Recursive Tunneling\", an ISP transit acts as an
additional ITR, and the destination RLOC it uses for the new prepended
header would be either a TE-ETR within the ISP (along an intra-ISP
traffic-engineered path) or a TE-ETR within another ISP (an inter-ISP
traffic-engineered path, where an agreement to build such a path
exists).[¶](#section-4-6){.pilcrow}

In order to avoid excessive packet overhead as well as possible
encapsulation loops, it is [RECOMMENDED]{.bcp14} that a maximum of two
LISP headers can be prepended to a packet. For initial LISP deployments,
it is assumed that two headers is sufficient, where the first prepended
header is used at a site for separation of location and identity and the
second prepended header is used inside a service provider for Traffic
Engineering purposes.[¶](#section-4-7){.pilcrow}

Tunnel Routers can be placed fairly flexibly in a multi-AS topology. For
example, the ITR for a particular end-to-end packet exchange might be
the first-hop or default router within a site for the source host.
Similarly, the ETR might be the last-hop router directly connected to
the destination host. As another example, perhaps for a VPN service
outsourced to an ISP by a site, the ITR could be the site\'s border
router at the service provider attachment point. Mixing and matching of
site-operated, ISP-operated, and other Tunnel Routers is allowed for
maximum flexibility.[¶](#section-4-8){.pilcrow}

::: {#DPI}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Deployment on the Public Internet](#name-deployment-on-the-public-in){.section-name .selfRef} {#name-deployment-on-the-public-in}

Several of the mechanisms in this document are intended for deployment
in controlled, trusted environments and are insecure for use over the
public Internet. In particular, on the public Internet,
xTRs:[¶](#section-4.1-1){.pilcrow}

-   [[MUST]{.bcp14} set the N-, L-, E-, and V-bits in the LISP header
    ([Section 5.1](#header){.auto .internal .xref}) to
    zero.[¶](#section-4.1-2.1){.pilcrow}]{#section-4.1-2.1}
-   [[MUST NOT]{.bcp14} use Locator-Status-Bits and Echo-Nonce, as
    described in [Section 10](#loc-reach){.auto .internal .xref}, for
    RLOC reachability. Instead, they [MUST]{.bcp14} rely solely on
    control plane
    methods.[¶](#section-4.1-2.2){.pilcrow}]{#section-4.1-2.2}
-   [[MUST NOT]{.bcp14} use gleaning or Locator-Status-Bits and
    Map-Versioning, as described in [Section 13](#update_mapping){.auto
    .internal .xref}, to update the EID-to-RLOC mappings. Instead, they
    [MUST]{.bcp14} rely solely on control plane
    methods.[¶](#section-4.1-2.3){.pilcrow}]{#section-4.1-2.3}
:::
:::

::: {#MOSTLY}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Packet Flow Sequence](#name-packet-flow-sequence){.section-name .selfRef} {#name-packet-flow-sequence}

This section provides an example of the unicast packet flow, also
including control plane information as specified in
\[[RFC9301](#RFC9301){.cite .xref}\]. The example also assumes the
following conditions:[¶](#section-4.2-1){.pilcrow}

-   [Source host \"host1.abc.example.com\" is sending a packet to
    \"host2.xyz.example.com\", exactly as it would if the site was not
    using LISP.[¶](#section-4.2-2.1){.pilcrow}]{#section-4.2-2.1}
-   [Each site is multihomed, so each Tunnel Router has an address
    (RLOC) assigned from the service provider address block for each
    provider to which that particular Tunnel Router is
    attached.[¶](#section-4.2-2.2){.pilcrow}]{#section-4.2-2.2}
-   [The ITR(s) and ETR(s) are directly connected to the source and
    destination, respectively, but the source and destination can be
    located anywhere in the LISP
    site.[¶](#section-4.2-2.3){.pilcrow}]{#section-4.2-2.3}
-   [A Map-Request is sent for an external destination when the
    destination is not found in the forwarding table or matches a
    default route. Map-Requests are sent to the mapping database system
    by using the LISP control plane protocol documented in
    \[[RFC9301](#RFC9301){.cite
    .xref}\].[¶](#section-4.2-2.4){.pilcrow}]{#section-4.2-2.4}
-   [Map-Replies are sent on the underlying routing system topology,
    using the control plane protocol \[[RFC9301](#RFC9301){.cite
    .xref}\].[¶](#section-4.2-2.5){.pilcrow}]{#section-4.2-2.5}

Client host1.abc.example.com wants to communicate with server
host2.xyz.example.com:[¶](#section-4.2-3){.pilcrow}

1.  [host1.abc.example.com wants to open a TCP connection to
    host2.xyz.example.com. It does a DNS lookup on
    host2.xyz.example.com. An A/AAAA record is returned. This address is
    the destination EID. The locally assigned address of
    host1.abc.example.com is used as the source EID. An IPv4 or IPv6
    packet is built and forwarded through the LISP site as a normal IP
    packet until it reaches a LISP
    ITR.[¶](#section-4.2-4.1){.pilcrow}]{#section-4.2-4.1}
2.  [The LISP ITR must be able to map the destination EID to an RLOC of
    one of the ETRs at the destination site. A method for doing this is
    to send a LISP Map-Request, as specified in
    \[[RFC9301](#RFC9301){.cite
    .xref}\].[¶](#section-4.2-4.2){.pilcrow}]{#section-4.2-4.2}
3.  [The Mapping System helps forward the Map-Request to the
    corresponding ETR. When the Map-Request arrives at one of the ETRs
    at the destination site, it will process the packet as a control
    message.[¶](#section-4.2-4.3){.pilcrow}]{#section-4.2-4.3}
4.  [The ETR looks at the destination EID of the Map-Request and matches
    it against the prefixes in the ETR\'s configured EID-to-RLOC mapping
    database. This is the list of EID-Prefixes the ETR is supporting for
    the site it resides in. If there is no match, the Map-Request is
    dropped. Otherwise, a LISP Map-Reply is returned to the
    ITR.[¶](#section-4.2-4.4){.pilcrow}]{#section-4.2-4.4}
5.  [The ITR receives the Map-Reply message, parses the message, and
    stores the mapping information from the packet. This information is
    stored in the ITR\'s EID-to-RLOC Map-Cache. Note that the Map-Cache
    is an on-demand cache. An ITR will manage its Map-Cache in such a
    way that optimizes for its resource
    constraints.[¶](#section-4.2-4.5){.pilcrow}]{#section-4.2-4.5}
6.  [Subsequent packets from host1.abc.example.com to
    host2.xyz.example.com will have a LISP header prepended by the ITR
    using the appropriate RLOC as the LISP header destination address
    learned from the ETR. Note that the packet [MAY]{.bcp14} be sent to
    a different ETR than the one that returned the Map-Reply due to the
    source site\'s hashing policy or the destination site\'s Locator-Set
    policy.[¶](#section-4.2-4.6){.pilcrow}]{#section-4.2-4.6}
7.  [The ETR receives these packets directly (since the destination
    address is one of its assigned IP addresses), checks the validity of
    the addresses, strips the LISP header, and forwards packets to the
    attached destination
    host.[¶](#section-4.2-4.7){.pilcrow}]{#section-4.2-4.7}
8.  [In order to defer the need for a mapping lookup in the reverse
    direction, it is [OPTIONAL]{.bcp14} for an ETR to create a cache
    entry that maps the source EID (inner-header source IP address) to
    the source RLOC (outer-header source IP address) in a received LISP
    packet. Such a cache entry is termed a \"glean mapping\" and only
    contains a single RLOC for the EID in question. More complete
    information about additional RLOCs [SHOULD]{.bcp14} be verified by
    sending a LISP Map-Request for that EID. Both the ITR and the ETR
    [MAY]{.bcp14} also influence the decision the other makes in
    selecting an RLOC.[¶](#section-4.2-4.8){.pilcrow}]{#section-4.2-4.8}
:::
:::
:::
:::

::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [LISP Encapsulation Details](#name-lisp-encapsulation-details){.section-name .selfRef} {#name-lisp-encapsulation-details}

Since additional tunnel headers are prepended, the packet becomes larger
and can exceed the MTU of any link traversed from the ITR to the ETR. It
is [RECOMMENDED]{.bcp14} in IPv4 that packets do not get fragmented as
they are encapsulated by the ITR. Instead, the packet is dropped and an
ICMPv4 Unreachable / Fragmentation Needed message is returned to the
source.[¶](#section-5-1){.pilcrow}

In the case when fragmentation is needed, it is [RECOMMENDED]{.bcp14}
that implementations provide support for one of the proposed
fragmentation and reassembly schemes. Two existing schemes are detailed
in [Section 7](#fragment){.auto .internal
.xref}.[¶](#section-5-2){.pilcrow}

Since IPv4 or IPv6 addresses can be either EIDs or RLOCs, the LISP
architecture supports IPv4 EIDs with IPv6 RLOCs (where the inner header
is in IPv4 packet format and the outer header is in IPv6 packet format)
or IPv6 EIDs with IPv4 RLOCs (where the inner header is in IPv6 packet
format and the outer header is in IPv4 packet format). The next
sub-sections illustrate packet formats for the homogeneous case
(IPv4-in-IPv4 and IPv6-in-IPv6), but all 4 combinations [MUST]{.bcp14}
be supported. Additional types of EIDs are defined in
\[[RFC8060](#RFC8060){.cite .xref}\].[¶](#section-5-3){.pilcrow}

As LISP uses UDP encapsulation to carry traffic between xTRs across the
Internet, implementors should be aware of the provisions of
\[[RFC8085](#RFC8085){.cite .xref}\], especially those given in its
Section
[3.1.11](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.11){.relref}
on congestion control for UDP tunneling.[¶](#section-5-4){.pilcrow}

Implementors are encouraged to consider UDP checksum usage guidelines in
[Section
3.4](https://www.rfc-editor.org/rfc/rfc8085#section-3.4){.relref} of
\[[RFC8085](#RFC8085){.cite .xref}\] when it is desirable to protect UDP
and LISP headers against corruption.[¶](#section-5-5){.pilcrow}

::: {#header}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [LISP IPv4-in-IPv4 Header Format](#name-lisp-ipv4-in-ipv4-header-fo){.section-name .selfRef} {#name-lisp-ipv4-in-ipv4-header-fo}

::: {#section-5.1-1 .alignLeft .art-text .artwork}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      / |Version|  IHL  |    DSCP   |ECN|          Total Length         |
     /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   |         Identification        |Flags|      Fragment Offset    |
    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    OH  |  Time to Live | Protocol = 17 |         Header Checksum       |
    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   |                    Source Routing Locator                     |
     \  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      \ |                 Destination Routing Locator                   |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      / |       Source Port = xxxx      |       Dest Port = 4341        |
    UDP +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      \ |           UDP Length          |        UDP Checksum           |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    L   |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
    I \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    S / |                 Instance ID/Locator-Status-Bits               |
    P   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      / |Version|  IHL  |    DSCP   |ECN|          Total Length         |
     /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   |         Identification        |Flags|      Fragment Offset    |
    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    IH  |  Time to Live |    Protocol   |         Header Checksum       |
    |   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   |                           Source EID                          |
     \  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      \ |                         Destination EID                       |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

        IHL = IP-Header-Length

[¶](#section-5.1-1){.pilcrow}
:::
:::
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [LISP IPv6-in-IPv6 Header Format](#name-lisp-ipv6-in-ipv6-header-fo){.section-name .selfRef} {#name-lisp-ipv6-in-ipv6-header-fo}

::: {#section-5.2-1 .alignLeft .art-text .artwork}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      / |Version|    DSCP   |ECN|           Flow Label                  |
     /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   |         Payload Length        | Next Header=17|   Hop Limit   |
    v   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
    O   +                                                               +
    u   |                                                               |
    t   +                     Source Routing Locator                    +
    e   |                                                               |
    r   +                                                               +
        |                                                               |
    H   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    d   |                                                               |
    r   +                                                               +
        |                                                               |
    ^   +                  Destination Routing Locator                  +
    |   |                                                               |
     \  +                                                               +
      \ |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      / |       Source Port = xxxx      |       Dest Port = 4341        |
    UDP +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      \ |           UDP Length          |        UDP Checksum           |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    L   |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
    I \ +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    S / |                 Instance ID/Locator-Status-Bits               |
    P   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      / |Version|    DSCP   |ECN|           Flow Label                  |
     /  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    /   |         Payload Length        |  Next Header  |   Hop Limit   |
    v   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                                                               |
    I   +                                                               +
    n   |                                                               |
    n   +                          Source EID                           +
    e   |                                                               |
    r   +                                                               +
        |                                                               |
    H   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    d   |                                                               |
    r   +                                                               +
        |                                                               |
    ^   +                        Destination EID                        +
    \   |                                                               |
     \  +                                                               +
      \ |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-5.2-1){.pilcrow}
:::
:::

::: {#LRB}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Tunnel Header Field Descriptions](#name-tunnel-header-field-descrip){.section-name .selfRef} {#name-tunnel-header-field-descrip}

[]{.break}

Inner Header (IH):
:   The inner header is the header on the datagram received from the
    originating host \[[RFC0791](#RFC0791){.cite .xref}\]
    \[[RFC8200](#RFC8200){.cite .xref}\] \[[RFC2474](#RFC2474){.cite
    .xref}\]. The source and destination IP addresses are
    EIDs.[¶](#section-5.3-1.2){.pilcrow}
:   

Outer Header (OH):
:   The outer header is a new header prepended by an ITR. The address
    fields contain RLOCs obtained from the ingress router\'s EID-to-RLOC
    Map-Cache. The IP protocol number is \"UDP (17)\" from
    \[[RFC0768](#RFC0768){.cite .xref}\]. The setting of the Don\'t
    Fragment (DF) bit \'Flags\' field is according to rules listed in
    Sections [7.1](#MTU-STATELESS){.auto .internal .xref} and
    [7.2](#MTU-STATEFUL){.auto .internal
    .xref}.[¶](#section-5.3-1.4){.pilcrow}
:   

UDP Header:
:   The UDP header contains an ITR-selected source port when
    encapsulating a packet. See [Section 12](#loc-hash){.auto .internal
    .xref} for details on the hash algorithm used to select a source
    port based on the 5-tuple of the inner header. The destination port
    [MUST]{.bcp14} be set to the well-known IANA-assigned port value
    4341.[¶](#section-5.3-1.6){.pilcrow}
:   

UDP Checksum:
:   The \'UDP Checksum\' field [SHOULD]{.bcp14} be transmitted as zero
    by an ITR for either IPv4 \[[RFC0768](#RFC0768){.cite .xref}\] or
    IPv6 encapsulation \[[RFC6935](#RFC6935){.cite .xref}\]
    \[[RFC6936](#RFC6936){.cite .xref}\]. When a packet with a zero UDP
    checksum is received by an ETR, the ETR [MUST]{.bcp14} accept the
    packet for decapsulation. When an ITR transmits a non-zero value for
    the UDP checksum, it [MUST]{.bcp14} send a correctly computed value
    in this field. When an ETR receives a packet with a non-zero UDP
    checksum, it [MAY]{.bcp14} choose to verify the checksum value. If
    it chooses to perform such verification and the verification fails,
    the packet [MUST]{.bcp14} be silently dropped. If the ETR either
    chooses not to perform the verification or performs the verification
    successfully, the packet [MUST]{.bcp14} be accepted for
    decapsulation. The handling of UDP zero checksums over IPv6 for all
    tunneling protocols, including LISP, is subject to the applicability
    statement in \[[RFC6936](#RFC6936){.cite
    .xref}\].[¶](#section-5.3-1.8){.pilcrow}
:   

UDP Length:
:   The \'UDP Length\' field is set for an IPv4-encapsulated packet to
    be the sum of the inner-header IPv4 Total Length plus the UDP and
    LISP header lengths. For an IPv6-encapsulated packet, the \'UDP
    Length\' field is the sum of the inner-header IPv6 Payload Length,
    the size of the IPv6 header (40 octets), and the size of the UDP and
    LISP headers.[¶](#section-5.3-1.10){.pilcrow}
:   

N:
:   The N-bit is the nonce-present bit. When this bit is set to 1, the
    low-order 24 bits of the first 32 bits of the LISP header contain a
    nonce. See [Section 10.1](#echo-nonce){.auto .internal .xref} for
    details. Both N- and V-bits [MUST NOT]{.bcp14} be set in the same
    packet. If they are, a decapsulating ETR [MUST]{.bcp14} treat the
    \'Nonce/Map-Version\' field as having a nonce value
    present.[¶](#section-5.3-1.12){.pilcrow}
:   

L:
:   The L-bit is the \'Locator-Status-Bits\' field enabled bit. When
    this bit is set to 1, the Locator-Status-Bits in the second 32 bits
    of the LISP header are in use.[¶](#section-5.3-1.14){.pilcrow}
:   

::: {#section-5.3-2 .alignLeft .art-text .artwork}
     x 1 x x 0 x x x
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Locator-Status-Bits                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-5.3-2){.pilcrow}
:::

[]{.break}

E:
:   The E-bit is the Echo-Nonce-request bit. This bit [MUST]{.bcp14} be
    ignored and has no meaning when the N-bit is set to 0. When the
    N-bit is set to 1 and this bit is set to 1, an ITR is requesting
    that the nonce value in the \'Nonce\' field be echoed back in
    LISP-encapsulated packets when the ITR is also an ETR. See [Section
    10.1](#echo-nonce){.auto .internal .xref} for
    details.[¶](#section-5.3-3.2){.pilcrow}
:   

V:
:   The V-bit is the Map-Version present bit. When this bit is set to 1,
    the N-bit [MUST]{.bcp14} be 0. Refer to \[[RFC9302](#RFC9302){.cite
    .xref}\] for more details on Database Map-Versioning. This bit
    indicates that the LISP header is encoded in this
    case as:[¶](#section-5.3-3.4){.pilcrow}
:   

::: {#section-5.3-4 .alignLeft .art-text .artwork}
     0 x 0 1 x x x x
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |N|L|E|V|I|R|K|K|  Source Map-Version   |   Dest Map-Version    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                 Instance ID/Locator-Status-Bits               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-5.3-4){.pilcrow}
:::

[]{.break}

I:
:   The I-bit is the Instance ID bit. See [Section 8](#instance){.auto
    .internal .xref} for more details. When this bit is set to 1, the
    \'Locator-Status-Bits\' field is reduced to 8 bits and the
    high-order 24 bits are used as an Instance ID. If the L-bit is set
    to 0, then the low-order 8 bits are transmitted as zero and ignored
    on receipt. The format of the LISP header would look like
    this:[¶](#section-5.3-5.2){.pilcrow}
:   

::: {#section-5.3-6 .alignLeft .art-text .artwork}
     x x x x 1 x x x
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |N|L|E|V|I|R|K|K|            Nonce/Map-Version                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                 Instance ID                   |     LSBs      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-5.3-6){.pilcrow}
:::

[]{.break}

R:
:   The R-bit is a reserved and unassigned bit for future use. It
    [MUST]{.bcp14} be set to 0 on transmit and [MUST]{.bcp14} be ignored
    on receipt.[¶](#section-5.3-7.2){.pilcrow}
:   

KK:
:   The KK-bits are a 2-bit field used when encapsulated packets are
    encrypted. The field is set to 00 when the packet is not encrypted.
    See \[[RFC8061](#RFC8061){.cite .xref}\] for further
    information.[¶](#section-5.3-7.4){.pilcrow}
:   

LISP Nonce:
:   The LISP \'Nonce\' field is a 24-bit value that is randomly
    generated by an ITR when the N-bit is set to 1. Nonce generation
    algorithms are an implementation matter but are required to generate
    different nonces when sending to different RLOCs. The nonce is also
    used when the E-bit is set to request the nonce value to be echoed
    by the other side when packets are returned. When the E-bit is clear
    but the N-bit is set, a remote ITR is either echoing a previously
    requested Echo-Nonce or providing a random nonce. See [Section
    10.1](#echo-nonce){.auto .internal .xref} for more details. Finally,
    when both the N- and V-bits are not set (N=0, V=0), then both the
    \'Nonce\' and \'Map-Version\' fields are set to 0 and ignored on
    receipt.[¶](#section-5.3-7.6){.pilcrow}
:   

LISP Locator-Status-Bits (LSBs):
:   When the L-bit is also set, the \'Locator-Status-Bits\' field in the
    LISP header is set by an ITR to indicate to an ETR the up/down
    status of the Locators in the source site. Each RLOC in a Map-Reply
    is assigned an ordinal value from 0 to n-1 (when there are n RLOCs
    in a mapping entry). The Locator-Status-Bits are numbered from 0 to
    n-1 from the least significant bit of the field. The field is 32
    bits when the I-bit is set to 0 and is 8 bits when the I-bit is set
    to 1. When a Locator-Status-Bit is set to 1, the ITR is indicating
    to the ETR that the RLOC associated with the bit ordinal has up
    status. See [Section 10](#loc-reach){.auto .internal .xref} for
    details on how an ITR can determine the status of the ETRs at the
    same site. When a site has multiple EID-Prefixes that result in
    multiple mappings (where each could have a different Locator-Set),
    the Locator-Status-Bits setting in an encapsulated packet
    [MUST]{.bcp14} reflect the mapping for the EID-Prefix that the
    inner-header source EID address matches (longest-match). If the LSB
    for an anycast Locator is set to 1, then there is at least one RLOC
    with that address, and the ETR is considered
    \'up\'.[¶](#section-5.3-7.8){.pilcrow}
:   

When doing ITR/PITR encapsulation:[¶](#section-5.3-8){.pilcrow}

-   [The outer-header \'Time to Live\' field (or \'Hop Limit\' field, in
    the case of IPv6) [SHOULD]{.bcp14} be copied from the inner-header
    \'Time to Live\'
    field.[¶](#section-5.3-9.1){.pilcrow}]{#section-5.3-9.1}
-   [The outer-header IPv4 \'Differentiated Services Code Point (DSCP)\'
    field (or \'Traffic Class\' field, in the case of IPv6)
    [SHOULD]{.bcp14} be copied from the inner-header IPv4 \'DSCP\' field
    (or \'Traffic Class\' field, in the case of IPv6) to the outer
    header. Guidelines for this can be found in
    \[[RFC2983](#RFC2983){.cite
    .xref}\].[¶](#section-5.3-9.2){.pilcrow}]{#section-5.3-9.2}
-   [The IPv4 \'Explicit Congestion Notification (ECN)\' field and bits
    6 and 7 of the IPv6 \'Traffic Class\' field require special
    treatment in order to avoid discarding indications of congestion as
    specified in \[[RFC6040](#RFC6040){.cite
    .xref}\].[¶](#section-5.3-9.3){.pilcrow}]{#section-5.3-9.3}

When doing ETR/PETR decapsulation:[¶](#section-5.3-10){.pilcrow}

-   [The inner-header IPv4 \'Time to Live\' field (or \'Hop Limit\'
    field, in the case of IPv6) [MUST]{.bcp14} be copied from the
    outer-header \'Time to Live\'/\'Hop Limit\' field when the Time to
    Live / Hop Limit value of the outer header is less than the Time to
    Live / Hop Limit value of the inner header. Failing to perform this
    check can cause the Time to Live / Hop Limit of the inner header to
    increment across encapsulation/decapsulation cycles. This check is
    also performed when doing initial encapsulation, when a packet comes
    to an ITR or PITR destined for a LISP
    site.[¶](#section-5.3-11.1){.pilcrow}]{#section-5.3-11.1}
-   [The outer-header IPv4 \'Differentiated Services Code Point (DSCP)\'
    field (or \'Traffic Class\' field, in the case of IPv6)
    [SHOULD]{.bcp14} be copied from the outer-header \'IPv4 DSCP\' field
    (or \'Traffic Class\' field, in the case of IPv6) to the inner
    header. Guidelines for this can be found in
    \[[RFC2983](#RFC2983){.cite
    .xref}\].[¶](#section-5.3-11.2){.pilcrow}]{#section-5.3-11.2}
-   [The IPv4 \'Explicit Congestion Notification (ECN)\' field and bits
    6 and 7 of the IPv6 \'Traffic Class\' field require special
    treatment in order to avoid discarding indications of congestion as
    specified in \[[RFC6040](#RFC6040){.cite .xref}\]. Note that
    implementations exist that copy the \'ECN\' field from the outer
    header to the inner header, even though \[[RFC6040](#RFC6040){.cite
    .xref}\] does not recommend this behavior. It is
    [RECOMMENDED]{.bcp14} that implementations change to support the
    behavior discussed in \[[RFC6040](#RFC6040){.cite
    .xref}\].[¶](#section-5.3-11.3){.pilcrow}]{#section-5.3-11.3}

Note that if an ETR/PETR is also an ITR/PITR and chooses to
re-encapsulate after decapsulating, the net effect of this is that the
new outer header will carry the same Time to Live as the old outer
header minus 1.[¶](#section-5.3-12){.pilcrow}

Copying the Time to Live serves two purposes: first, it preserves the
distance the host intended the packet to travel; second, and more
importantly, it provides for suppression of looping packets in the event
there is a loop of concatenated tunnels due to
misconfiguration.[¶](#section-5.3-13){.pilcrow}

Some xTRs, PETRs, and PITRs perform re-encapsulation operations and need
to treat ECN functions in a special way. Because the re-encapsulation
operation is a sequence of two operations, namely a decapsulation
followed by an encapsulation, the ECN bits [MUST]{.bcp14} be treated as
described above for these two operations.[¶](#section-5.3-14){.pilcrow}

The LISP data plane protocol is not backwards compatible with
\[[RFC6830](#RFC6830){.cite .xref}\] and does not have explicit support
for introducing future protocol changes (e.g., an explicit version
field). However, the LISP control plane \[[RFC9301](#RFC9301){.cite
.xref}\] allows an ETR to register data plane capabilities by means of
new LISP Canonical Address Format (LCAF) types
\[[RFC8060](#RFC8060){.cite .xref}\]. In this way, an ITR can be made
aware of the data plane capabilities of an ETR and encapsulate
accordingly. The specification of the new LCAF types, the new LCAF
mechanisms, and their use are out of the scope of this
document.[¶](#section-5.3-15){.pilcrow}
:::
:::
:::

::: {#Map-Cache}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [LISP EID-to-RLOC Map-Cache](#name-lisp-eid-to-rloc-map-cache){.section-name .selfRef} {#name-lisp-eid-to-rloc-map-cache}

ITRs and PITRs maintain an on-demand cache, referred to as the LISP
EID-to-RLOC Map-Cache, that contains mappings from EID-Prefixes to
Locator-Sets. The cache is used to encapsulate packets from the EID
space to the corresponding RLOC network attachment
point.[¶](#section-6-1){.pilcrow}

When an ITR/PITR receives a packet from inside of the LISP site to
destinations outside of the site, a longest-prefix match lookup of the
EID is done to the Map-Cache.[¶](#section-6-2){.pilcrow}

When the lookup succeeds, the Locator-Set retrieved from the Map-Cache
is used to send the packet to the EID\'s topological
location.[¶](#section-6-3){.pilcrow}

If the lookup fails, the ITR/PITR needs to retrieve the mapping using
the LISP control plane protocol \[[RFC9301](#RFC9301){.cite .xref}\].
While the mapping is being retrieved, the ITR/PITR can either drop or
buffer the packets. This document does not have specific recommendations
about the action to be taken. It is up to the deployer to consider
whether or not it is desirable to buffer packets and deploy a LISP
implementation that offers the desired behavior. Once the mapping is
resolved, it is then stored in the local Map-Cache to forward subsequent
packets addressed to the same EID-Prefix.[¶](#section-6-4){.pilcrow}

The Map-Cache is a local cache of mappings; entries are expired based on
the associated Time to Live. In addition, entries can be updated with
more current information; see [Section 13](#update_mapping){.auto
.internal .xref} for further information on this. Finally, the Map-Cache
also contains reachability information about EIDs and RLOCs and uses
LISP reachability information mechanisms to determine the reachability
of RLOCs; see [Section 10](#loc-reach){.auto .internal .xref} for the
specific mechanisms.[¶](#section-6-5){.pilcrow}
:::
:::

::: {#fragment}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Dealing with Large Encapsulated Packets](#name-dealing-with-large-encapsul){.section-name .selfRef} {#name-dealing-with-large-encapsul}

This section proposes two mechanisms to deal with packets that exceed
the Path MTU (PMTU) between the ITR and ETR.[¶](#section-7-1){.pilcrow}

It is left to the implementor to decide if the stateless or stateful
mechanism [SHOULD]{.bcp14} be implemented. Both or neither can be used,
since it is a local decision in the ITR regarding how to deal with MTU
issues, and sites can interoperate with differing
mechanisms.[¶](#section-7-2){.pilcrow}

Both stateless and stateful mechanisms also apply to Re-encapsulating
and Recursive Tunneling, so any actions below referring to an ITR also
apply to a TE-ITR.[¶](#section-7-3){.pilcrow}

::: {#MTU-STATELESS}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [A Stateless Solution to MTU Handling](#name-a-stateless-solution-to-mtu){.section-name .selfRef} {#name-a-stateless-solution-to-mtu}

An ITR stateless solution to handle MTU issues is described as
follows:[¶](#section-7.1-1){.pilcrow}

1.  [Define H to be the size, in octets, of the outer header an ITR
    prepends to a packet. This includes the UDP and LISP header
    lengths.[¶](#section-7.1-2.1){.pilcrow}]{#section-7.1-2.1}
2.  [Define L to be the size, in octets, of the maximum-sized packet an
    ITR can send to an ETR without the need for the ITR or any
    intermediate routers to fragment the packet. The network
    administrator of the LISP deployment has to determine what the
    suitable value of L is, so as to make sure that no MTU issues
    arise.[¶](#section-7.1-2.2){.pilcrow}]{#section-7.1-2.2}
3.  [Define an architectural constant S for the maximum size of a
    packet, in octets, an ITR [MUST]{.bcp14} receive from the source so
    the effective MTU can be met. That is, L = S +
    H.[¶](#section-7.1-2.3){.pilcrow}]{#section-7.1-2.3}

When an ITR receives a packet from a site-facing interface and adds H
octets worth of encapsulation to yield a packet size greater than L
octets (meaning the received packet size was greater than S octets from
the source), it resolves the MTU issue by first splitting the original
packet into 2 equal-sized fragments. A LISP header is then prepended to
each fragment. The size of the encapsulated fragments is then (S/2 + H),
which is less than the ITR\'s estimate of the PMTU between the ITR and
its correspondent ETR.[¶](#section-7.1-3){.pilcrow}

When an ETR receives encapsulated fragments, it treats them as two
individually encapsulated packets. It strips the LISP headers and then
forwards each fragment to the destination host of the destination site.
The two fragments are reassembled at the destination host into the
single IP datagram that was originated by the source host. Note that
reassembly can happen at the ETR if the encapsulated packet was
fragmented at or after the ITR.[¶](#section-7.1-4){.pilcrow}

This behavior [MUST]{.bcp14} be implemented by the ITR only when the
source host originates a packet with the \'DF\' field of the IP header
set to 0. When the \'DF\' field of the IP header is set to 1 or the
packet is an IPv6 packet originated by the source host, the ITR will
drop the packet when the size (adding in the size of the encapsulation
header) is greater than L and send an ICMPv4 Unreachable / Fragmentation
Needed or ICMPv6 Packet Too Big (PTB) message to the source with a value
of S, where S is (L - H).[¶](#section-7.1-5){.pilcrow}

When the outer-header encapsulation uses an IPv4 header, an
implementation [SHOULD]{.bcp14} set the DF bit to 1 so ETR fragment
reassembly can be avoided. An implementation [MAY]{.bcp14} set the DF
bit in such headers to 0 if it has good reason to believe there are
unresolvable PMTU issues between the sending ITR and the receiving
ETR.[¶](#section-7.1-6){.pilcrow}

It is [RECOMMENDED]{.bcp14} that L be defined as 1500. Additional
information about in-network MTU and fragmentation issues can be found
in \[[RFC4459](#RFC4459){.cite .xref}\].[¶](#section-7.1-7){.pilcrow}
:::
:::

::: {#MTU-STATEFUL}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [A Stateful Solution to MTU Handling](#name-a-stateful-solution-to-mtu-){.section-name .selfRef} {#name-a-stateful-solution-to-mtu-}

An ITR stateful solution to handle MTU issues is described as
follows:[¶](#section-7.2-1){.pilcrow}

1.  [The ITR will keep state of the effective MTU for each Locator per
    Map-Cache entry. The effective MTU is what the core network can
    deliver along the path between the ITR and
    ETR.[¶](#section-7.2-2.1){.pilcrow}]{#section-7.2-2.1}
2.  [When an IPv4-encapsulated packet with the DF bit set to 1 exceeds
    what the core network can deliver, one of the intermediate routers
    on the path will send an ICMPv4 Unreachable / Fragmentation Needed
    message to the ITR. The ITR will parse the ICMP message to determine
    which Locator is affected by the effective MTU change and then
    record the new effective MTU value in the Map-Cache
    entry.[¶](#section-7.2-2.2){.pilcrow}]{#section-7.2-2.2}
3.  [When a packet is received by the ITR from a source inside of the
    site and the size of the packet is greater than the effective MTU
    stored with the Map-Cache entry associated with the destination EID
    the packet is for, the ITR will send an ICMPv4 Unreachable /
    Fragmentation Needed message back to the source. The packet size
    advertised by the ITR in the ICMP message is the effective MTU minus
    the LISP encapsulation
    length.[¶](#section-7.2-2.3){.pilcrow}]{#section-7.2-2.3}

Even though this mechanism is stateful, it has advantages over the
stateless IP fragmentation mechanism, by not involving the destination
host with reassembly of ITR fragmented
packets.[¶](#section-7.2-3){.pilcrow}

Please note that using ICMP packets for PMTU discovery, as described in
\[[RFC1191](#RFC1191){.cite .xref}\] and \[[RFC8201](#RFC8201){.cite
.xref}\], can result in suboptimal behavior in the presence of ICMP
packet losses or off-path attackers that spoof ICMP. Possible
mitigations include ITRs and ETRs cooperating on MTU probe packets
\[[RFC4821](#RFC4821){.cite .xref}\] \[[RFC8899](#RFC8899){.cite
.xref}\] or ITRs storing the beginning of large packets to verify that
they match the echoed packet in an ICMP Fragmentation Needed / PTB
message.[¶](#section-7.2-4){.pilcrow}
:::
:::
:::
:::

::: {#instance}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Using Virtualization and Segmentation with LISP](#name-using-virtualization-and-se){.section-name .selfRef} {#name-using-virtualization-and-se}

There are several cases where segregation is needed at the EID level.
For instance, this is the case for deployments containing overlapping
addresses, traffic isolation policies, or multi-tenant virtualization.
For these and other scenarios where segregation is needed, Instance IDs
are used.[¶](#section-8-1){.pilcrow}

An Instance ID can be carried in a LISP-encapsulated packet. An ITR that
prepends a LISP header will copy a 24-bit value used by the LISP router
to uniquely identify the address space. The value is copied to the
\'Instance ID\' field of the LISP header, and the I-bit is set
to 1.[¶](#section-8-2){.pilcrow}

When an ETR decapsulates a packet, the Instance ID from the LISP header
is used as a table identifier to locate the forwarding table to use for
the inner destination EID lookup.[¶](#section-8-3){.pilcrow}

For example, an 802.1Q VLAN tag or VPN identifier could be used as a
24-bit Instance ID. See \[[LISP-VPN](#I-D.ietf-lisp-vpn){.cite .xref}\]
for details regarding LISP VPN use cases. Please note that the Instance
ID is not protected; an on-path attacker can modify the tags and, for
instance, allow communications between logically isolated
VLANs.[¶](#section-8-4){.pilcrow}

Participants within a LISP deployment must agree on the meaning of
Instance ID values. The source and destination EIDs [MUST]{.bcp14}
belong to the same Instance ID.[¶](#section-8-5){.pilcrow}

The Instance ID [SHOULD NOT]{.bcp14} be used with overlapping IPv6 EID
addresses.[¶](#section-8-6){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Routing Locator Selection](#name-routing-locator-selection){.section-name .selfRef} {#name-routing-locator-selection}

The Map-Cache contains the state used by ITRs and PITRs to encapsulate
packets. When an ITR/PITR receives a packet from inside the LISP site to
a destination outside of the site, a longest-prefix match lookup of the
EID is done to the Map-Cache (see [Section 6](#Map-Cache){.auto
.internal .xref}). The lookup returns a single Locator-Set containing a
list of RLOCs corresponding to the EID\'s topological location. Each
RLOC in the Locator-Set is associated with a Priority and Weight; this
information is used to select the RLOC to
encapsulate.[¶](#section-9-1){.pilcrow}

The RLOC with the lowest Priority is selected. An RLOC with Priority 255
means that it [MUST NOT]{.bcp14} be used for forwarding. When multiple
RLOCs have the same Priority, then the Weight states how to load-balance
traffic among them. The value of the Weight represents the relative
weight of the total packets that match the mapping
entry.[¶](#section-9-2){.pilcrow}

The following are different scenarios for choosing RLOCs and the
controls that are available:[¶](#section-9-3){.pilcrow}

-   [The server-side returns one RLOC. The client-side can only use one
    RLOC. The server-side has complete control of the
    selection.[¶](#section-9-4.1){.pilcrow}]{#section-9-4.1}
-   [The server-side returns a list of RLOCs where a subset of the list
    has the same best Priority. The client can only use the subset list
    according to the weighting assigned by the server-side. In this
    case, the server-side controls both the subset list and load
    splitting across its members. The client-side can use RLOCs outside
    of the subset list if it determines that the subset list is
    unreachable (unless RLOCs are set to a Priority of 255). Some
    sharing of control exists: the server-side determines the
    destination RLOC list and load distribution while the client-side
    has the option of using alternatives to this list if RLOCs in the
    list are unreachable.[¶](#section-9-4.2){.pilcrow}]{#section-9-4.2}
-   [The server-side sets a Weight of zero for the RLOC subset list. In
    this case, the client-side can choose how the traffic load is spread
    across the subset list. See [Section 12](#loc-hash){.auto .internal
    .xref} for details on load-sharing mechanisms. Control is shared by
    the server-side determining the list and the client-side determining
    load distribution. Again, the client can use alternative RLOCs if
    the server-provided list of RLOCs is
    unreachable.[¶](#section-9-4.3){.pilcrow}]{#section-9-4.3}
-   [Either side (more likely the server-side ETR) decides to \"glean\"
    the RLOCs. For example, if the server-side ETR gleans RLOCs, then
    the client-side ITR gives the server-side ETR responsibility for
    bidirectional RLOC reachability and preferability. Server-side ETR
    gleaning of the client-side ITR RLOC is done by caching the
    inner-header source EID and the outer-header source RLOC of received
    packets. The client-side ITR controls how traffic is returned and
    can, as an alternative, use an outer-header source RLOC, which then
    can be added to the list the server-side ETR uses to return traffic.
    Since no Priority or Weights are provided using this method, the
    server-side ETR [MUST]{.bcp14} assume that each client-side ITR RLOC
    uses the same best Priority with a Weight of zero. In addition,
    since EID-Prefix encoding cannot be conveyed in data packets, the
    EID-to-RLOC Map-Cache on Tunnel Routers can grow very large.
    Gleaning has several important considerations. A \"gleaned\"
    Map-Cache entry is only stored and used for a [RECOMMENDED]{.bcp14}
    period of 3 seconds, pending verification. Verification
    [MUST]{.bcp14} be performed by sending a Map-Request to the source
    EID (the inner-header IP source address) of the received
    encapsulated packet. A reply to this \"verifying Map-Request\" is
    used to fully populate the Map-Cache entry for the \"gleaned\" EID
    and is stored and used for the time indicated in the \'Time to
    Live\' field of a received Map-Reply. When a verified Map-Cache
    entry is stored, data gleaning no longer occurs for subsequent
    packets that have a source EID that matches the EID-Prefix of the
    verified entry. This \"gleaning\" mechanism [MUST NOT]{.bcp14} be
    used over the public Internet and [SHOULD]{.bcp14} only be used in
    trusted and closed deployments. Refer to [Section
    16](#SECURITY){.auto .internal .xref} for security issues regarding
    this mechanism.[¶](#section-9-4.4){.pilcrow}]{#section-9-4.4}

RLOCs that appear in EID-to-RLOC Map-Reply messages are assumed to be
reachable when the R-bit \[[RFC9301](#RFC9301){.cite .xref}\] for the
Locator record is set to 1. When the R-bit is set to 0, an ITR or PITR
[MUST NOT]{.bcp14} encapsulate to the RLOC. Neither the information
contained in a Map-Reply nor that stored in the mapping database system
provides reachability information for RLOCs. Note that reachability is
not part of the Mapping System and is determined using one or more of
the RLOC reachability algorithms described in the next
section.[¶](#section-9-5){.pilcrow}
:::

::: {#loc-reach}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Routing Locator Reachability](#name-routing-locator-reachabilit){.section-name .selfRef} {#name-routing-locator-reachabilit}

Several data plane mechanisms for determining RLOC reachability are
currently defined. Please note that additional reachability mechanisms
based on the control plane are defined in \[[RFC9301](#RFC9301){.cite
.xref}\].[¶](#section-10-1){.pilcrow}

1.  [An ETR [MAY]{.bcp14} examine the Locator-Status-Bits in the LISP
    header of an encapsulated data packet received from an ITR. If the
    ETR is also acting as an ITR and has traffic to return to the
    original ITR site, it can use this status information to help select
    an RLOC.[¶](#section-10-2.1){.pilcrow}]{#section-10-2.1}
2.  [When an ETR receives an encapsulated packet from an ITR, the source
    RLOC from the outer header of the packet is likely to be reachable.
    Please note that in some scenarios the RLOC from the outer header
    can be a spoofable
    field.[¶](#section-10-2.2){.pilcrow}]{#section-10-2.2}
3.  [An ITR/ETR pair can use the Echo-Noncing Locator reachability
    algorithms described in this
    section.[¶](#section-10-2.3){.pilcrow}]{#section-10-2.3}

When determining Locator up/down reachability by examining the
Locator-Status-Bits from the LISP-encapsulated data packet, an ETR will
receive an up-to-date status from an encapsulating ITR about
reachability for all ETRs at the site. CE-based ITRs at the source site
can determine reachability relative to each other using the site IGP as
follows:[¶](#section-10-3){.pilcrow}

-   [Under normal circumstances, each ITR will advertise a default route
    into the site IGP.[¶](#section-10-4.1){.pilcrow}]{#section-10-4.1}
-   [If an ITR fails or if the upstream link to its Provider Edge fails,
    its default route will either time out or be
    withdrawn.[¶](#section-10-4.2){.pilcrow}]{#section-10-4.2}

Each ITR can thus observe the presence or lack of a default route
originated by the others to determine the Locator-Status-Bits it sets
for them.[¶](#section-10-5){.pilcrow}

When ITRs at the site are not deployed in CE routers, the IGP can still
be used to determine the reachability of Locators, provided they are
injected into the IGP. This is typically done when a /32 address is
configured on a loopback interface.[¶](#section-10-6){.pilcrow}

RLOCs listed in a Map-Reply are numbered with ordinals 0 to n-1. The
Locator-Status-Bits in a LISP-encapsulated packet are numbered from 0 to
n-1 starting with the least significant bit. For example, if an RLOC
listed in the 3rd position of the Map-Reply goes down (ordinal value 2),
then all ITRs at the site will clear the 3rd least significant bit (xxxx
x0xx) of the \'Locator-Status-Bits\' field for the packets they
encapsulate.[¶](#section-10-7){.pilcrow}

When an xTR decides to use Locator-Status-Bits to affect reachability
information, it acts as follows: ETRs decapsulating a packet will check
for any change in the \'Locator-Status-Bits\' field. When a bit goes
from 1 to 0, the ETR, if also acting as an ITR, will refrain from
encapsulating packets to an RLOC that is indicated as down. It will only
resume using that RLOC if the corresponding Locator-Status-Bit returns
to a value of 1. Locator-Status-Bits are associated with a Locator-Set
per EID-Prefix. Therefore, when a Locator becomes unreachable, the
Locator-Status-Bit that corresponds to that Locator\'s position in the
list returned by the last Map-Reply will be set to zero for that
particular EID-Prefix.[¶](#section-10-8){.pilcrow}

Locator-Status-Bits [MUST NOT]{.bcp14} be used over the public Internet
and [SHOULD]{.bcp14} only be used in trusted and closed deployments. In
addition, Locator-Status-Bits [SHOULD]{.bcp14} be coupled with
Map-Versioning \[[RFC9302](#RFC9302){.cite .xref}\] to prevent race
conditions where Locator-Status-Bits are interpreted as referring to
different RLOCs than intended. Refer to [Section 16](#SECURITY){.auto
.internal .xref} for security issues regarding this
mechanism.[¶](#section-10-9){.pilcrow}

If an ITR encapsulates a packet to an ETR and the packet is received and
decapsulated by the ETR, it is implied, but not confirmed by the ITR,
that the ETR\'s RLOC is reachable. In most cases, the ETR can also reach
the ITR but cannot assume this to be true, due to the possibility of
path asymmetry. In the presence of unidirectional traffic flow from an
ITR to an ETR, the ITR [SHOULD NOT]{.bcp14} use the lack of return
traffic as an indication that the ETR is unreachable. Instead, it
[MUST]{.bcp14} use an alternate mechanism to determine
reachability.[¶](#section-10-10){.pilcrow}

The security considerations of [Section 16](#SECURITY){.auto .internal
.xref} related to data plane reachability apply to the data plane RLOC
reachability mechanisms described in this
section.[¶](#section-10-11){.pilcrow}

::: {#echo-nonce}
::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Echo-Nonce Algorithm](#name-echo-nonce-algorithm){.section-name .selfRef} {#name-echo-nonce-algorithm}

When data flows bidirectionally between Locators from different sites, a
data plane mechanism called \"nonce echoing\" can be used to determine
reachability between an ITR and ETR. When an ITR wants to solicit a
nonce echo, it sets the N- and E-bits and places a 24-bit nonce
\[[RFC4086](#RFC4086){.cite .xref}\] in the LISP header of the next
encapsulated data packet.[¶](#section-10.1-1){.pilcrow}

When this packet is received by the ETR, the encapsulated packet is
forwarded as normal. When the ETR is an xTR (co-located as an ITR), it
then sends a data packet to the ITR (when it is an xTR co-located as an
ETR) and includes the nonce received earlier with the N-bit set and
E-bit cleared. The ITR sees this \"echoed nonce\" and knows that the
path to and from the ETR is up.[¶](#section-10.1-2){.pilcrow}

The ITR will set the E-bit and N-bit for every packet it sends while in
the Echo-Nonce-request state. The time the ITR waits to process the
echoed nonce before it determines that the path is unreachable is
variable and is a choice left for the
implementation.[¶](#section-10.1-3){.pilcrow}

If the ITR is receiving packets from the ETR but does not see the nonce
echoed while being in the Echo-Nonce-request state, then the path to the
ETR is unreachable. This decision [MAY]{.bcp14} be overridden by other
Locator reachability algorithms. Once the ITR determines that the path
to the ETR is down, it can switch to another Locator for that
EID-Prefix.[¶](#section-10.1-4){.pilcrow}

Note that \"ITR\" and \"ETR\" are relative terms here. Both devices
[MUST]{.bcp14} be implementing both ITR and ETR functionality for the
Echo-Nonce mechanism to operate.[¶](#section-10.1-5){.pilcrow}

The ITR and ETR [MAY]{.bcp14} both go into the Echo-Nonce-request state
at the same time. The number of packets sent or the time during which
Echo-Nonce request packets are sent is an implementation-specific
setting. In this case, an xTR receiving the Echo-Nonce request packets
will suspend the Echo-Nonce state and set up an
\'Echo-Nonce-request-state\' timer. After the
\'Echo-Nonce-request-state\' timer expires, it will resume the
Echo-Nonce state.[¶](#section-10.1-6){.pilcrow}

This mechanism does not completely solve the forward path reachability
problem, as traffic may be unidirectional. That is, the ETR receiving
traffic at a site [MAY]{.bcp14} not be the same device as an ITR that
transmits traffic from that site, or the site-to-site traffic is
unidirectional so there is no ITR returning
traffic.[¶](#section-10.1-7){.pilcrow}

The Echo-Nonce algorithm is bilateral. That is, if one side sets the
E-bit and the other side is not enabled for Echo-Noncing, then the
echoing of the nonce does not occur and the requesting side may
erroneously consider the Locator unreachable. An ITR [SHOULD]{.bcp14}
set the E-bit in an encapsulated data packet when it knows the ETR is
enabled for Echo-Noncing. This is conveyed by the E-bit in the Map-Reply
message.[¶](#section-10.1-8){.pilcrow}

Many implementations default to not advertising that they are Echo-Nonce
capable in Map-Reply messages, and so RLOC-Probing tends to be used for
RLOC reachability.[¶](#section-10.1-9){.pilcrow}

The Echo-Nonce mechanism [MUST NOT]{.bcp14} be used over the public
Internet and [MUST]{.bcp14} only be used in trusted and closed
deployments. Refer to [Section 16](#SECURITY){.auto .internal .xref} for
security issues regarding this mechanism.[¶](#section-10.1-10){.pilcrow}
:::
:::
:::
:::

::: {#eid-reach}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [EID Reachability within a LISP Site](#name-eid-reachability-within-a-l){.section-name .selfRef} {#name-eid-reachability-within-a-l}

A site [MAY]{.bcp14} be multihomed using two or more ETRs. The hosts and
infrastructure within a site will be addressed using one or more
EID-Prefixes that are mapped to the RLOCs of the relevant ETRs in the
Mapping System. One possible failure mode is for an ETR to lose
reachability to one or more of the EID-Prefixes within its own site.
When this occurs when the ETR sends Map-Replies, it can clear the R-bit
associated with its own Locator. And when the ETR is also an ITR, it can
clear its Locator-Status-Bit in the encapsulation data
header.[¶](#section-11-1){.pilcrow}

It is recognized that there are no simple solutions to the site
partitioning problem because it is hard to know which part of the
EID-Prefix range is partitioned and which Locators can reach any
sub-ranges of the EID-Prefixes. Note that this is not a new problem
introduced by the LISP architecture. At the time of this writing, this
problem exists when a multihomed site uses BGP to advertise its
reachability upstream.[¶](#section-11-2){.pilcrow}
:::
:::

::: {#loc-hash}
::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [Routing Locator Hashing](#name-routing-locator-hashing){.section-name .selfRef} {#name-routing-locator-hashing}

When an ETR provides an EID-to-RLOC mapping in a Map-Reply message that
is stored in the Map-Cache of a requesting ITR, the Locator-Set for the
EID-Prefix [MAY]{.bcp14} contain different Priority and Weight values
for each Routing Locator Address. When more than one best Priority
Locator exists, the ITR can decide how to load-share traffic against the
corresponding Locators.[¶](#section-12-1){.pilcrow}

The following hash algorithm [MAY]{.bcp14} be used by an ITR to select a
Locator for a packet destined to an EID for the EID-to-RLOC
mapping:[¶](#section-12-2){.pilcrow}

1.  [Either a source and destination address hash or the commonly used
    5-tuple hash can be used. The commonly used 5-tuple hash includes
    the source and destination addresses; source and destination TCP,
    UDP, or Stream Control Transmission Protocol (SCTP) port numbers;
    and the IP protocol number field or IPv6 next-protocol fields of a
    packet that a host originates from within a LISP site. When a packet
    is not a TCP, UDP, or SCTP packet, the source and destination
    addresses only from the header are used to compute the
    hash.[¶](#section-12-3.1){.pilcrow}]{#section-12-3.1}
2.  [Take the hash value and divide it by the number of Locators stored
    in the Locator-Set for the EID-to-RLOC
    mapping.[¶](#section-12-3.2){.pilcrow}]{#section-12-3.2}
3.  [The remainder will yield a value of 0 to \"number of Locators minus
    1\". Use the remainder to select the Locator in the
    Locator-Set.[¶](#section-12-3.3){.pilcrow}]{#section-12-3.3}

The specific hash algorithm the ITR uses for load-sharing is out of
scope for this document and does not prevent
interoperability.[¶](#section-12-4){.pilcrow}

The source port [SHOULD]{.bcp14} be the same for all packets belonging
to the same flow. Also note that when a packet is LISP encapsulated, the
source port number in the outer UDP header needs to be set. Selecting a
hashed value allows core routers that are attached to Link Aggregation
Groups (LAGs) to load-split the encapsulated packets across member links
of such LAGs. Otherwise, core routers would see a single flow, since
packets have a source address of the ITR, for packets that are
originated by different EIDs at the source site. A suggested setting for
the source port number computed by an ITR is a 5-tuple hash function on
the inner header, as described above. The source port [SHOULD]{.bcp14}
be the same for all packets belonging to the same
flow.[¶](#section-12-5){.pilcrow}

Many core router implementations use a 5-tuple hash to decide how to
balance packet load across members of a LAG. The 5-tuple hash includes
the source and destination addresses of the packet and the source and
destination ports when the protocol number in the packet is TCP or UDP.
For this reason, UDP encoding is used for LISP encapsulation. In this
scenario, when the outer header is IPv6, the flow label [MAY]{.bcp14}
also be set following the procedures specified in
\[[RFC6438](#RFC6438){.cite .xref}\]. When the inner header is IPv6 and
the flow label is not zero, it [MAY]{.bcp14} be used to compute the
hash.[¶](#section-12-6){.pilcrow}
:::
:::

::: {#update_mapping}
::: {#section-13 .section}
## [13.](#section-13){.section-number .selfRef} [Changing the Contents of EID-to-RLOC Mappings](#name-changing-the-contents-of-ei){.section-name .selfRef} {#name-changing-the-contents-of-ei}

Since the LISP architecture uses a caching scheme to retrieve and store
EID-to-RLOC mappings, the only way an ITR can get a more up-to-date
mapping is to re-request the mapping. However, the ITRs do not know when
the mappings change, and the ETRs do not keep track of which ITRs
requested their mappings. For scalability reasons, it is desirable to
maintain this approach, but implementors need to provide a way for ETRs
to change their mappings and inform the sites that are currently
communicating with the ETR site using such
mappings.[¶](#section-13-1){.pilcrow}

This section defines two data plane mechanism for updating EID-to-RLOC
mappings. Additionally, the Solicit-Map-Request (SMR) control plane
updating mechanism is specified in \[[RFC9301](#RFC9301){.cite
.xref}\].[¶](#section-13-2){.pilcrow}

::: {#lsb-changing}
::: {#section-13.1 .section}
### [13.1.](#section-13.1){.section-number .selfRef} [Locator-Status-Bits](#name-locator-status-bits){.section-name .selfRef} {#name-locator-status-bits}

Locator-Status-Bits (LSBs) can also be used to keep track of the Locator
status (up or down) when EID-to-RLOC mappings are changing. When LSBs
are used in a LISP deployment, all LISP Tunnel Routers [MUST]{.bcp14}
implement both ITR and ETR capabilities (therefore, all Tunnel Routers
are effectively xTRs). In this section, the term \"source xTR\" is used
to refer to the xTR setting the LSB and \"destination xTR\" is used to
refer to the xTR receiving the LSB. The procedure is as
follows:[¶](#section-13.1-1){.pilcrow}

1.  [When a Locator record is added or removed from the Locator-Set, the
    source xTR will signal this by sending an SMR control plane message
    \[[RFC9301](#RFC9301){.cite .xref}\] to the destination xTR. At this
    point, the source xTR [MUST NOT]{.bcp14} use the LSB field, when the
    L-bit is 0, since the destination xTR site has outdated information.
    The source xTR will set up a \'use-LSB\'
    timer.[¶](#section-13.1-2.1){.pilcrow}]{#section-13.1-2.1}
2.  [As defined in \[[RFC9301](#RFC9301){.cite .xref}\], upon reception
    of the SMR message, the destination xTR will retrieve the updated
    EID-to-RLOC mappings by sending a
    Map-Request.[¶](#section-13.1-2.2){.pilcrow}]{#section-13.1-2.2}
3.  [When the \'use-LSB\' timer expires, the source xTR can use the LSB
    again with the destination xTR to signal the Locator status (up or
    down). The specific value for the \'use-LSB\' timer depends on the
    LISP deployment; the \'use-LSB\' timer needs to be large enough for
    the destination xTR to retrieve the updated EID-to-RLOC mappings. A
    [RECOMMENDED]{.bcp14} value for the \'use-LSB\' timer is 5
    minutes.[¶](#section-13.1-2.3){.pilcrow}]{#section-13.1-2.3}
:::
:::

::: {#map-versioning}
::: {#section-13.2 .section}
### [13.2.](#section-13.2){.section-number .selfRef} [Database Map-Versioning](#name-database-map-versioning){.section-name .selfRef} {#name-database-map-versioning}

When there is unidirectional packet flow between an ITR and ETR, and the
EID-to-RLOC mappings change on the ETR, it needs to inform the ITR so
encapsulation to a removed Locator can stop and can instead be started
to a new Locator in the Locator-Set.[¶](#section-13.2-1){.pilcrow}

An ETR can send Map-Reply messages carrying a Map-Version Number
\[[RFC9302](#RFC9302){.cite .xref}\] in an EID-Record. This is known as
the Destination Map-Version Number. ITRs include the Destination
Map-Version Number in packets they encapsulate to the
site.[¶](#section-13.2-2){.pilcrow}

An ITR, when it encapsulates packets to ETRs, can convey its own Map-
Version Number. This is known as the Source Map-Version
Number.[¶](#section-13.2-3){.pilcrow}

When presented in EID-Records of Map-Register messages
\[[RFC9301](#RFC9301){.cite .xref}\], a Map-Version Number is a good way
for the Map-Server \[[RFC9301](#RFC9301){.cite .xref}\] to assure that
all ETRs for a site registering to it are synchronized according to the
Map-Version Number.[¶](#section-13.2-4){.pilcrow}

See \[[RFC9302](#RFC9302){.cite .xref}\] for a more detailed analysis
and description of Database
Map-Versioning.[¶](#section-13.2-5){.pilcrow}
:::
:::
:::
:::

::: {#multicast}
::: {#section-14 .section}
## [14.](#section-14){.section-number .selfRef} [Multicast Considerations](#name-multicast-considerations){.section-name .selfRef} {#name-multicast-considerations}

A multicast group address, as defined in the original Internet
architecture, is an identifier of a grouping of topologically
independent receiver host locations. The address encoding itself does
not determine the location of the receiver(s). The multicast routing
protocol and the network-based state the protocol creates determine
where the receivers are located.[¶](#section-14-1){.pilcrow}

In the context of LISP, a multicast group address is both an EID and an
RLOC. Therefore, no specific semantic or action needs to be taken for a
destination address, as it would appear in an IP header. Therefore, a
group address that appears in an inner IP header built by a source host
will be used as the destination EID. The outer IP header (the
destination RLOC address), prepended by a LISP router, can use the same
group address as the destination RLOC, use a multicast or unicast RLOC
obtained from a Mapping System lookup, or use other means to determine
the group address mapping.[¶](#section-14-2){.pilcrow}

With respect to the source RLOC address, the ITR prepends its own IP
address as the source address of the outer IP header, just like it would
if the destination EID was a unicast address. This source RLOC address,
like any other RLOC address, [MUST]{.bcp14} be routable on the
underlay.[¶](#section-14-3){.pilcrow}

There are two approaches for LISP-Multicast \[[RFC6831](#RFC6831){.cite
.xref}\]: one that uses native multicast routing in the underlay with no
support from the Mapping System and another that uses only unicast
routing in the underlay with support from the Mapping System. See
\[[RFC6831](#RFC6831){.cite .xref}\] and \[[RFC8378](#RFC8378){.cite
.xref}\], respectively, for details. Details for LISP-Multicast and
interworking with non-LISP sites are described in
\[[RFC6831](#RFC6831){.cite .xref}\] and \[[RFC6832](#RFC6832){.cite
.xref}\], respectively.[¶](#section-14-4){.pilcrow}
:::
:::

::: {#PUNT}
::: {#section-15 .section}
## [15.](#section-15){.section-number .selfRef} [Router Performance Considerations](#name-router-performance-consider){.section-name .selfRef} {#name-router-performance-consider}

LISP is designed to be very \"hardware based and forwarding friendly\".
A few implementation techniques can be used to incrementally implement
LISP:[¶](#section-15-1){.pilcrow}

-   [When a tunnel-encapsulated packet is received by an ETR, the outer
    destination address may not be the address of the router. This makes
    it challenging for the control plane to get packets from the
    hardware. This may be mitigated by creating special Forwarding
    Information Base (FIB) entries for the EID-Prefixes of EIDs served
    by the ETR (those for which the router provides an RLOC
    translation). These FIB entries are marked with a flag indicating
    that control plane processing [SHOULD]{.bcp14} be performed. The
    forwarding logic of testing for particular IP protocol number values
    is not necessary. There are a few proven cases where no changes to
    existing deployed hardware were needed to support the LISP data
    plane.[¶](#section-15-2.1){.pilcrow}]{#section-15-2.1}
-   [On an ITR, prepending a new IP header consists of adding more
    octets to a Message Authentication Code (MAC) rewrite string and
    prepending the string as part of the outgoing encapsulation
    procedure. Routers that support Generic Routing Encapsulation (GRE)
    tunneling \[[RFC2784](#RFC2784){.cite .xref}\] or 6to4 tunneling
    \[[RFC3056](#RFC3056){.cite .xref}\] may already support this
    action.[¶](#section-15-2.2){.pilcrow}]{#section-15-2.2}
-   [A packet\'s source address or the interface on which the packet was
    received can be used to select Virtual Routing and Forwarding (VRF).
    The VRF system\'s routing table can be used to find EID-to-RLOC
    mappings.[¶](#section-15-2.3){.pilcrow}]{#section-15-2.3}

For performance issues related to Map-Cache management, see [Section
16](#SECURITY){.auto .internal .xref}.[¶](#section-15-3){.pilcrow}
:::
:::

::: {#SECURITY}
::: {#section-16 .section}
## [16.](#section-16){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

In what follows, we highlight security considerations that apply when
LISP is deployed in environments such as those specified in [Section
1.1](#soa){.auto .internal .xref}.[¶](#section-16-1){.pilcrow}

The optional gleaning mechanism is offered to directly obtain a mapping
from the LISP-encapsulated packets. Specifically, an xTR can learn the
EID-to-RLOC mapping by inspecting the source RLOC and source EID of an
encapsulated packet and insert this new mapping into its Map-Cache. An
off-path attacker can spoof the source EID address to divert the traffic
sent to the victim\'s spoofed EID. If the attacker spoofs the source
RLOC, it can mount a DoS attack by redirecting traffic to the spoofed
victim\'s RLOC, potentially overloading it.[¶](#section-16-2){.pilcrow}

The LISP data plane defines several mechanisms to monitor RLOC data
plane reachability; in this context, Locator-Status-Bits, nonce-present
bits, and Echo-Nonce bits of the LISP encapsulation header can be
manipulated by an attacker to mount a DoS attack. An off-path attacker
able to spoof the RLOC and/or nonce of a victim\'s xTR can manipulate
such mechanisms to declare false information about the RLOC\'s
reachability status.[¶](#section-16-3){.pilcrow}

An example of such attacks is when an off-path attacker can exploit the
Echo-Nonce mechanism by sending data packets to an ITR with a random
nonce from an ETR\'s spoofed RLOC. Note that the attacker only has a
small window of time within which to guess a valid nonce that the ITR is
requesting to be echoed. The goal is to convince the ITR that the ETR\'s
RLOC is reachable even when it may not be reachable. If the attack is
successful, the ITR believes the wrong reachability status of the ETR\'s
RLOC until RLOC-Probing detects the correct status. This time frame is
on the order of tens of seconds. This specific attack can be mitigated
by preventing RLOC spoofing in the network by deploying Unicast Reverse
Path Forwarding (uRPF) per [BCP 84](#RFC8704){.internal .xref}
\[[RFC8704](#RFC8704){.cite .xref}\]. In order to exploit this
vulnerability, the off-path attacker must also send Echo-Nonce packets
at a high rate. If the nonces have never been requested by the ITR, it
can protect itself from erroneous reachability
attacks.[¶](#section-16-4){.pilcrow}

A LISP-specific uRPF check is also possible. When decapsulating, an ETR
can check that the source EID and RLOC are valid EID-to-RLOC mappings by
checking the Mapping System.[¶](#section-16-5){.pilcrow}

Map-Versioning is a data plane mechanism used to signal to a peering xTR
that a local EID-to-RLOC mapping has been updated so that the peering
xTR uses a LISP control plane signaling message to retrieve a fresh
mapping. This can be used by an attacker to forge the \'Map-Version\'
field of a LISP-encapsulated header and force an excessive amount of
signaling between xTRs that may overload them. Further security
considerations on Map-Versioning can be found in
\[[RFC9302](#RFC9302){.cite .xref}\].[¶](#section-16-6){.pilcrow}

Locator-Status-Bits, the Echo-Nonce mechanism, and Map-Versioning [MUST
NOT]{.bcp14} be used over the public Internet and [SHOULD]{.bcp14} only
be used in trusted and closed deployments. In addition,
Locator-Status-Bits [SHOULD]{.bcp14} be coupled with Map-Versioning to
prevent race conditions where Locator-Status-Bits are interpreted as
referring to different RLOCs than intended.[¶](#section-16-7){.pilcrow}

LISP implementations and deployments that permit outer header fragments
of IPv6 LISP-encapsulated packets as a means of dealing with MTU issues
should also use implementation techniques in ETRs to prevent this from
being a DoS attack vector. Limits on the number of fragments awaiting
reassembly at an ETR, RTR, or PETR, and the rate of admitting such
fragments, may be used.[¶](#section-16-8){.pilcrow}
:::
:::

::: {#section-17 .section}
## [17.](#section-17){.section-number .selfRef} [Network Management Considerations](#name-network-management-consider){.section-name .selfRef} {#name-network-management-consider}

Considerations for network management tools exist so the LISP protocol
suite can be operationally managed. These mechanisms can be found in
\[[RFC7052](#RFC7052){.cite .xref}\] and \[[RFC6835](#RFC6835){.cite
.xref}\].[¶](#section-17-1){.pilcrow}
:::

::: {#section-18 .section}
## [18.](#section-18){.section-number .selfRef} [Changes since RFC 6830](#name-changes-since-rfc-6830){.section-name .selfRef} {#name-changes-since-rfc-6830}

For implementation considerations, the following changes have been made
to this document since \[[RFC6830](#RFC6830){.cite .xref}\] was
published:[¶](#section-18-1){.pilcrow}

-   [It is no longer mandated that a maximum number of 2 LISP headers be
    prepended to a packet. If there is an application need for more than
    2 LISP headers, an implementation can support more. However, it is
    [RECOMMENDED]{.bcp14} that a maximum of 2 LISP headers can be
    prepended to a
    packet.[¶](#section-18-2.1){.pilcrow}]{#section-18-2.1}
-   [The 3 reserved flag bits in the LISP header have been allocated for
    \[[RFC8061](#RFC8061){.cite .xref}\]. The low-order 2 bits of the
    3-bit field (now named the KK-bits) are used as a key identifier.
    The 1 remaining bit is still documented as reserved and
    unassigned.[¶](#section-18-2.2){.pilcrow}]{#section-18-2.2}
-   [Data plane gleaning for creating Map-Cache entries has been made
    optional. Any ITR implementations that depend on or assume that the
    remote ETR is gleaning should not do so. This does not create any
    interoperability problems, since the control plane Map-Cache
    population procedures are unilateral and are the typical method for
    populating the
    Map-Cache.[¶](#section-18-2.3){.pilcrow}]{#section-18-2.3}
-   [Most of the changes to this document, which reduce its length, are
    due to moving the LISP control plane messaging and procedures to
    \[[RFC9301](#RFC9301){.cite
    .xref}\].[¶](#section-18-2.4){.pilcrow}]{#section-18-2.4}
:::

::: {#IANA}
::: {#section-19 .section}
## [19.](#section-19){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This section provides guidance to the Internet Assigned Numbers
Authority (IANA) regarding registration of values related to this data
plane LISP specification, in accordance with [BCP
26](#RFC8126){.internal .xref} \[[RFC8126](#RFC8126){.cite
.xref}\].[¶](#section-19-1){.pilcrow}

::: {#section-19.1 .section}
### [19.1.](#section-19.1){.section-number .selfRef} [LISP UDP Port Numbers](#name-lisp-udp-port-numbers){.section-name .selfRef} {#name-lisp-udp-port-numbers}

IANA has allocated UDP port number 4341 for the LISP data plane. IANA
has updated the description for UDP port 4341 as
follows:[¶](#section-19.1-1){.pilcrow}

::: {#iana-port-number}
  Service Name   Port Number   Transport Protocol   Description         Reference
  -------------- ------------- -------------------- ------------------- -----------
  lisp-data      4341          udp                  LISP Data Packets   RFC 9300

  : [Table 1](#table-1){.selfRef}
:::
:::
:::
:::

::: {#section-20 .section}
## [20.](#section-20){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-20.1 .section}
### [20.1.](#section-20.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0768\]
:   [Postel, J.]{.refAuthor}, [\"User Datagram Protocol\"]{.refTitle},
    [STD 6]{.seriesInfo}, [RFC 768]{.seriesInfo}, [DOI
    10.17487/RFC0768]{.seriesInfo}, August 1980,
    \<<https://www.rfc-editor.org/info/rfc768>\>.
:   

\[RFC0791\]
:   [Postel, J.]{.refAuthor}, [\"Internet Protocol\"]{.refTitle}, [STD
    5]{.seriesInfo}, [RFC 791]{.seriesInfo}, [DOI
    10.17487/RFC0791]{.seriesInfo}, September 1981,
    \<<https://www.rfc-editor.org/info/rfc791>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2474\]
:   [Nichols, K.]{.refAuthor}, [Blake, S.]{.refAuthor},
    [Baker, F.]{.refAuthor}, and [D. Black]{.refAuthor}, [\"Definition
    of the Differentiated Services Field (DS Field) in the IPv4 and IPv6
    Headers\"]{.refTitle}, [RFC 2474]{.seriesInfo}, [DOI
    10.17487/RFC2474]{.seriesInfo}, December 1998,
    \<<https://www.rfc-editor.org/info/rfc2474>\>.
:   

\[RFC2983\]
:   [Black, D.]{.refAuthor}, [\"Differentiated Services and
    Tunnels\"]{.refTitle}, [RFC 2983]{.seriesInfo}, [DOI
    10.17487/RFC2983]{.seriesInfo}, October 2000,
    \<<https://www.rfc-editor.org/info/rfc2983>\>.
:   

\[RFC6040\]
:   [Briscoe, B.]{.refAuthor}, [\"Tunnelling of Explicit Congestion
    Notification\"]{.refTitle}, [RFC 6040]{.seriesInfo}, [DOI
    10.17487/RFC6040]{.seriesInfo}, November 2010,
    \<<https://www.rfc-editor.org/info/rfc6040>\>.
:   

\[RFC6438\]
:   [Carpenter, B.]{.refAuthor} and [S. Amante]{.refAuthor}, [\"Using
    the IPv6 Flow Label for Equal Cost Multipath Routing and Link
    Aggregation in Tunnels\"]{.refTitle}, [RFC 6438]{.seriesInfo}, [DOI
    10.17487/RFC6438]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6438>\>.
:   

\[RFC6830\]
:   [Farinacci, D.]{.refAuthor}, [Fuller, V.]{.refAuthor},
    [Meyer, D.]{.refAuthor}, and [D. Lewis]{.refAuthor}, [\"The
    Locator/ID Separation Protocol (LISP)\"]{.refTitle}, [RFC
    6830]{.seriesInfo}, [DOI 10.17487/RFC6830]{.seriesInfo}, January
    2013, \<<https://www.rfc-editor.org/info/rfc6830>\>.
:   

\[RFC6831\]
:   [Farinacci, D.]{.refAuthor}, [Meyer, D.]{.refAuthor},
    [Zwiebel, J.]{.refAuthor}, and [S. Venaas]{.refAuthor}, [\"The
    Locator/ID Separation Protocol (LISP) for Multicast
    Environments\"]{.refTitle}, [RFC 6831]{.seriesInfo}, [DOI
    10.17487/RFC6831]{.seriesInfo}, January 2013,
    \<<https://www.rfc-editor.org/info/rfc6831>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8200\]
:   [Deering, S.]{.refAuthor} and [R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [STD
    86]{.seriesInfo}, [RFC 8200]{.seriesInfo}, [DOI
    10.17487/RFC8200]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8200>\>.
:   

\[RFC8378\]
:   [Moreno, V.]{.refAuthor} and [D. Farinacci]{.refAuthor},
    [\"Signal-Free Locator/ID Separation Protocol (LISP)
    Multicast\"]{.refTitle}, [RFC 8378]{.seriesInfo}, [DOI
    10.17487/RFC8378]{.seriesInfo}, May 2018,
    \<<https://www.rfc-editor.org/info/rfc8378>\>.
:   

\[RFC8704\]
:   [Sriram, K.]{.refAuthor}, [Montgomery, D.]{.refAuthor}, and [J.
    Haas]{.refAuthor}, [\"Enhanced Feasible-Path Unicast Reverse Path
    Forwarding\"]{.refTitle}, [BCP 84]{.seriesInfo}, [RFC
    8704]{.seriesInfo}, [DOI 10.17487/RFC8704]{.seriesInfo}, February
    2020, \<<https://www.rfc-editor.org/info/rfc8704>\>.
:   

\[RFC9301\]
:   [Farinacci, D.]{.refAuthor}, [Maino, F.]{.refAuthor},
    [Fuller, V.]{.refAuthor}, and [A. Cabellos, Ed.]{.refAuthor},
    [\"Locator/ID Separation Protocol (LISP) Control
    Plane\"]{.refTitle}, [RFC 9301]{.seriesInfo}, [DOI
    10.17487/RFC9301]{.seriesInfo}, October 2022,
    \<<https://www.rfc-editor.org/info/rfc9301>\>.
:   

\[RFC9302\]
:   [Iannone, L.]{.refAuthor}, [Saucez, D.]{.refAuthor}, and [O.
    Bonaventure]{.refAuthor}, [\"Locator/ID Separation Protocol (LISP)
    Map-Versioning\"]{.refTitle}, [RFC 9302]{.seriesInfo}, [DOI
    10.17487/RFC9302]{.seriesInfo}, October 2022,
    \<<https://www.rfc-editor.org/info/rfc9302>\>.
:   
:::

::: {#section-20.2 .section}
### [20.2.](#section-20.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[AFN\]
:   [IANA]{.refAuthor}, [\"Address Family Numbers\"]{.refTitle},
    \<[http://www.iana.org/assignments/address-family-numbers](https://www.iana.org/assignments/address-family-numbers)\>.
:   

\[CHIAPPA\]
:   [Chiappa, J.]{.refAuthor}, [\"Endpoints and Endpoint Names: A
    Proposed Enhancement to the Internet Architecture\"]{.refTitle},
    1999, \<<http://mercury.lcs.mit.edu/~jnc/tech/endpoints.txt>\>.
:   

\[LISP-VPN\]
:   [Moreno, V.]{.refAuthor} and [D. Farinacci]{.refAuthor}, [\"LISP
    Virtual Private Networks (VPNs)\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-lisp-vpn-10]{.seriesInfo}, 3 October 2022,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-lisp-vpn-10>\>.
:   

\[RFC1034\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - concepts and
    facilities\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1034]{.seriesInfo}, [DOI 10.17487/RFC1034]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1034>\>.
:   

\[RFC1191\]
:   [Mogul, J.]{.refAuthor} and [S. Deering]{.refAuthor}, [\"Path MTU
    discovery\"]{.refTitle}, [RFC 1191]{.seriesInfo}, [DOI
    10.17487/RFC1191]{.seriesInfo}, November 1990,
    \<<https://www.rfc-editor.org/info/rfc1191>\>.
:   

\[RFC2453\]
:   [Malkin, G.]{.refAuthor}, [\"RIP Version 2\"]{.refTitle}, [STD
    56]{.seriesInfo}, [RFC 2453]{.seriesInfo}, [DOI
    10.17487/RFC2453]{.seriesInfo}, November 1998,
    \<<https://www.rfc-editor.org/info/rfc2453>\>.
:   

\[RFC2677\]
:   [Greene, M.]{.refAuthor}, [Cucchiara, J.]{.refAuthor}, and [J.
    Luciani]{.refAuthor}, [\"Definitions of Managed Objects for the NBMA
    Next Hop Resolution Protocol (NHRP)\"]{.refTitle}, [RFC
    2677]{.seriesInfo}, [DOI 10.17487/RFC2677]{.seriesInfo}, August
    1999, \<<https://www.rfc-editor.org/info/rfc2677>\>.
:   

\[RFC2784\]
:   [Farinacci, D.]{.refAuthor}, [Li, T.]{.refAuthor},
    [Hanks, S.]{.refAuthor}, [Meyer, D.]{.refAuthor}, and [P.
    Traina]{.refAuthor}, [\"Generic Routing Encapsulation
    (GRE)\"]{.refTitle}, [RFC 2784]{.seriesInfo}, [DOI
    10.17487/RFC2784]{.seriesInfo}, March 2000,
    \<<https://www.rfc-editor.org/info/rfc2784>\>.
:   

\[RFC3056\]
:   [Carpenter, B.]{.refAuthor} and [K. Moore]{.refAuthor},
    [\"Connection of IPv6 Domains via IPv4 Clouds\"]{.refTitle}, [RFC
    3056]{.seriesInfo}, [DOI 10.17487/RFC3056]{.seriesInfo}, February
    2001, \<<https://www.rfc-editor.org/info/rfc3056>\>.
:   

\[RFC3261\]
:   [Rosenberg, J.]{.refAuthor}, [Schulzrinne, H.]{.refAuthor},
    [Camarillo, G.]{.refAuthor}, [Johnston, A.]{.refAuthor},
    [Peterson, J.]{.refAuthor}, [Sparks, R.]{.refAuthor},
    [Handley, M.]{.refAuthor}, and [E. Schooler]{.refAuthor}, [\"SIP:
    Session Initiation Protocol\"]{.refTitle}, [RFC 3261]{.seriesInfo},
    [DOI 10.17487/RFC3261]{.seriesInfo}, June 2002,
    \<<https://www.rfc-editor.org/info/rfc3261>\>.
:   

\[RFC4086\]
:   [Eastlake 3rd, D.]{.refAuthor}, [Schiller, J.]{.refAuthor}, and [S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.
:   

\[RFC4459\]
:   [Savola, P.]{.refAuthor}, [\"MTU and Fragmentation Issues with
    In-the-Network Tunneling\"]{.refTitle}, [RFC 4459]{.seriesInfo},
    [DOI 10.17487/RFC4459]{.seriesInfo}, April 2006,
    \<<https://www.rfc-editor.org/info/rfc4459>\>.
:   

\[RFC4760\]
:   [Bates, T.]{.refAuthor}, [Chandra, R.]{.refAuthor},
    [Katz, D.]{.refAuthor}, and [Y. Rekhter]{.refAuthor},
    [\"Multiprotocol Extensions for BGP-4\"]{.refTitle}, [RFC
    4760]{.seriesInfo}, [DOI 10.17487/RFC4760]{.seriesInfo}, January
    2007, \<<https://www.rfc-editor.org/info/rfc4760>\>.
:   

\[RFC4821\]
:   [Mathis, M.]{.refAuthor} and [J. Heffner]{.refAuthor},
    [\"Packetization Layer Path MTU Discovery\"]{.refTitle}, [RFC
    4821]{.seriesInfo}, [DOI 10.17487/RFC4821]{.seriesInfo}, March 2007,
    \<<https://www.rfc-editor.org/info/rfc4821>\>.
:   

\[RFC4984\]
:   [Meyer, D., Ed.]{.refAuthor}, [Zhang, L., Ed.]{.refAuthor}, and [K.
    Fall, Ed.]{.refAuthor}, [\"Report from the IAB Workshop on Routing
    and Addressing\"]{.refTitle}, [RFC 4984]{.seriesInfo}, [DOI
    10.17487/RFC4984]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4984>\>.
:   

\[RFC6832\]
:   [Lewis, D.]{.refAuthor}, [Meyer, D.]{.refAuthor},
    [Farinacci, D.]{.refAuthor}, and [V. Fuller]{.refAuthor},
    [\"Interworking between Locator/ID Separation Protocol (LISP) and
    Non-LISP Sites\"]{.refTitle}, [RFC 6832]{.seriesInfo}, [DOI
    10.17487/RFC6832]{.seriesInfo}, January 2013,
    \<<https://www.rfc-editor.org/info/rfc6832>\>.
:   

\[RFC6835\]
:   [Farinacci, D.]{.refAuthor} and [D. Meyer]{.refAuthor}, [\"The
    Locator/ID Separation Protocol Internet Groper (LIG)\"]{.refTitle},
    [RFC 6835]{.seriesInfo}, [DOI 10.17487/RFC6835]{.seriesInfo},
    January 2013, \<<https://www.rfc-editor.org/info/rfc6835>\>.
:   

\[RFC6935\]
:   [Eubanks, M.]{.refAuthor}, [Chimento, P.]{.refAuthor}, and [M.
    Westerlund]{.refAuthor}, [\"IPv6 and UDP Checksums for Tunneled
    Packets\"]{.refTitle}, [RFC 6935]{.seriesInfo}, [DOI
    10.17487/RFC6935]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6935>\>.
:   

\[RFC6936\]
:   [Fairhurst, G.]{.refAuthor} and [M. Westerlund]{.refAuthor},
    [\"Applicability Statement for the Use of IPv6 UDP Datagrams with
    Zero Checksums\"]{.refTitle}, [RFC 6936]{.seriesInfo}, [DOI
    10.17487/RFC6936]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6936>\>.
:   

\[RFC7052\]
:   [Schudel, G.]{.refAuthor}, [Jain, A.]{.refAuthor}, and [V.
    Moreno]{.refAuthor}, [\"Locator/ID Separation Protocol (LISP)
    MIB\"]{.refTitle}, [RFC 7052]{.seriesInfo}, [DOI
    10.17487/RFC7052]{.seriesInfo}, October 2013,
    \<<https://www.rfc-editor.org/info/rfc7052>\>.
:   

\[RFC7215\]
:   [Jakab, L.]{.refAuthor}, [Cabellos-Aparicio, A.]{.refAuthor},
    [Coras, F.]{.refAuthor}, [Domingo-Pascual, J.]{.refAuthor}, and [D.
    Lewis]{.refAuthor}, [\"Locator/Identifier Separation Protocol (LISP)
    Network Element Deployment Considerations\"]{.refTitle}, [RFC
    7215]{.seriesInfo}, [DOI 10.17487/RFC7215]{.seriesInfo}, April 2014,
    \<<https://www.rfc-editor.org/info/rfc7215>\>.
:   

\[RFC8060\]
:   [Farinacci, D.]{.refAuthor}, [Meyer, D.]{.refAuthor}, and [J.
    Snijders]{.refAuthor}, [\"LISP Canonical Address Format
    (LCAF)\"]{.refTitle}, [RFC 8060]{.seriesInfo}, [DOI
    10.17487/RFC8060]{.seriesInfo}, February 2017,
    \<<https://www.rfc-editor.org/info/rfc8060>\>.
:   

\[RFC8061\]
:   [Farinacci, D.]{.refAuthor} and [B. Weis]{.refAuthor}, [\"Locator/ID
    Separation Protocol (LISP) Data-Plane Confidentiality\"]{.refTitle},
    [RFC 8061]{.seriesInfo}, [DOI 10.17487/RFC8061]{.seriesInfo},
    February 2017, \<<https://www.rfc-editor.org/info/rfc8061>\>.
:   

\[RFC8085\]
:   [Eggert, L.]{.refAuthor}, [Fairhurst, G.]{.refAuthor}, and [G.
    Shepherd]{.refAuthor}, [\"UDP Usage Guidelines\"]{.refTitle}, [BCP
    145]{.seriesInfo}, [RFC 8085]{.seriesInfo}, [DOI
    10.17487/RFC8085]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8085>\>.
:   

\[RFC8201\]
:   [McCann, J.]{.refAuthor}, [Deering, S.]{.refAuthor},
    [Mogul, J.]{.refAuthor}, and [R. Hinden, Ed.]{.refAuthor}, [\"Path
    MTU Discovery for IP version 6\"]{.refTitle}, [STD 87]{.seriesInfo},
    [RFC 8201]{.seriesInfo}, [DOI 10.17487/RFC8201]{.seriesInfo}, July
    2017, \<<https://www.rfc-editor.org/info/rfc8201>\>.
:   

\[RFC8899\]
:   [Fairhurst, G.]{.refAuthor}, [Jones, T.]{.refAuthor},
    [Tüxen, M.]{.refAuthor}, [Rüngeler, I.]{.refAuthor}, and [T.
    Völker]{.refAuthor}, [\"Packetization Layer Path MTU Discovery for
    Datagram Transports\"]{.refTitle}, [RFC 8899]{.seriesInfo}, [DOI
    10.17487/RFC8899]{.seriesInfo}, September 2020,
    \<<https://www.rfc-editor.org/info/rfc8899>\>.
:   

\[RFC9299\]
:   [Cabellos, A.]{.refAuthor} and [D. Saucez, Ed.]{.refAuthor}, [\"An
    Architectural Introduction to the Locator/ID Separation Protocol
    (LISP)\"]{.refTitle}, [RFC 9299]{.seriesInfo}, [DOI
    10.17487/RFC9299]{.seriesInfo}, October 2022,
    \<<https://www.rfc-editor.org/info/rfc9299>\>.
:   
:::
:::

::: {#appendix-A .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

An initial thank you goes to [Dave Oran]{.contact-name} for planting the
seeds for the initial ideas for LISP. His consultation continues to
provide value to the LISP authors.[¶](#appendix-A-1){.pilcrow}

A special and appreciative thank you goes to [Noel
Chiappa]{.contact-name} for providing architectural impetus over the
past decades on separation of location and identity, as well as detailed
reviews of the LISP architecture and documents, coupled with enthusiasm
for making LISP a practical and incremental transition for the
Internet.[¶](#appendix-A-2){.pilcrow}

The original authors would like to gratefully acknowledge many people
who have contributed discussions and ideas to the making of this
proposal. They include [Scott Brim]{.contact-name}, [Andrew
Partan]{.contact-name}, [John Zwiebel]{.contact-name}, [Jason
Schiller]{.contact-name}, [Lixia Zhang]{.contact-name}, [Dorian
Kim]{.contact-name}, [Peter Schoenmaker]{.contact-name}, [Vijay
Gill]{.contact-name}, [Geoff Huston]{.contact-name}, [David
Conrad]{.contact-name}, [Mark Handley]{.contact-name}, [Ron
Bonica]{.contact-name}, [Ted Seely]{.contact-name}, [Mark
Townsley]{.contact-name}, [Chris Morrow]{.contact-name}, [Brian
Weis]{.contact-name}, [Dave McGrew]{.contact-name}, [Peter
Lothberg]{.contact-name}, [Dave Thaler]{.contact-name}, [Eliot
Lear]{.contact-name}, [Shane Amante]{.contact-name}, [Ved
Kafle]{.contact-name}, [Olivier Bonaventure]{.contact-name}, [Luigi
Iannone]{.contact-name}, [Robin Whittle]{.contact-name}, [Brian
Carpenter]{.contact-name}, [Joel Halpern]{.contact-name}, [Terry
Manderson]{.contact-name}, [Roger Jorgensen]{.contact-name}, [Ran
Atkinson]{.contact-name}, [Stig Venaas]{.contact-name}, [Iljitsch van
Beijnum]{.contact-name}, [Roland Bless]{.contact-name}, [Dana
Blair]{.contact-name}, [Bill Lynch]{.contact-name}, [Marc
Woolward]{.contact-name}, [Damien Saucez]{.contact-name}, [Damian
Lezama]{.contact-name}, [Attilla De Groot]{.contact-name}, [Parantap
Lahiri]{.contact-name}, [David Black]{.contact-name}, [Roque
Gagliano]{.contact-name}, [Isidor Kouvelas]{.contact-name}, [Jesper
Skriver]{.contact-name}, [Fred Templin]{.contact-name}, [Margaret
Wasserman]{.contact-name}, [Sam Hartman]{.contact-name}, [Michael
Hofling]{.contact-name}, [Pedro Marques]{.contact-name}, [Jari
Arkko]{.contact-name}, [Gregg Schudel]{.contact-name}, [Srinivas
Subramanian]{.contact-name}, [Amit Jain]{.contact-name}, [Xu
Xiaohu]{.contact-name}, [Dhirendra Trivedi]{.contact-name}, [Yakov
Rekhter]{.contact-name}, [John Scudder]{.contact-name}, [John
Drake]{.contact-name}, [Dimitri Papadimitriou]{.contact-name}, [Ross
Callon]{.contact-name}, [Selina Heimlich]{.contact-name}, [Job
Snijders]{.contact-name}, [Vina Ermagan]{.contact-name}, [Fabio
Maino]{.contact-name}, [Victor Moreno]{.contact-name}, [Chris
White]{.contact-name}, [Clarence Filsfils]{.contact-name}, [Alia
Atlas]{.contact-name}, [Florin Coras]{.contact-name}, and [Alberto
Rodriguez]{.contact-name}.[¶](#appendix-A-3){.pilcrow}

This work originated in the Routing Research Group (RRG) of the IRTF. An
individual submission was converted into the IETF LISP Working Group
document that became this RFC.[¶](#appendix-A-4){.pilcrow}

The LISP Working Group would like to give a special thanks to [Jari
Arkko]{.contact-name}, the Internet Area AD at the time that the set of
LISP documents was being prepared for IESG Last Call, for his meticulous
reviews and detailed commentaries on the 7 Working Group Last Call
documents progressing toward Standards Track
RFCs.[¶](#appendix-A-5){.pilcrow}

The current authors would like to give a sincere thank you to the people
who helped put LISP on the Standards Track in the IETF. They include
[Joel Halpern]{.contact-name}, [Luigi Iannone]{.contact-name}, [Deborah
Brungard]{.contact-name}, [Fabio Maino]{.contact-name}, [Scott
Bradner]{.contact-name}, [Kyle Rose]{.contact-name}, [Takeshi
Takahashi]{.contact-name}, [Sarah Banks]{.contact-name}, [Pete
Resnick]{.contact-name}, [Colin Perkins]{.contact-name}, [Mirja
Kühlewind]{.contact-name}, [Francis Dupont]{.contact-name}, [Benjamin
Kaduk]{.contact-name}, [Eric Rescorla]{.contact-name}, [Alvaro
Retana]{.contact-name}, [Alexey Melnikov]{.contact-name}, [Alissa
Cooper]{.contact-name}, [Suresh Krishnan]{.contact-name}, [Alberto
Rodriguez-Natal]{.contact-name}, [Vina Ermagan]{.contact-name}, [Mohamed
Boucadair]{.contact-name}, [Brian Trammell]{.contact-name}, [Sabrina
Tanamal]{.contact-name}, and [John Drake]{.contact-name}. The
contributions they offered greatly added to the security, scale, and
robustness of the LISP architecture and
protocols.[¶](#appendix-A-6){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Dino Farinacci]{.fn .nameRole}
:::

::: {.left dir="auto"}
[lispers.net]{.org}
:::

::: {.left dir="auto"}
[San Jose]{.locality}, [CA]{.region}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <farinacci@gmail.com>
:::

::: {.left dir="auto"}
[Vince Fuller]{.fn .nameRole}
:::

::: {.left dir="auto"}
[vaf.net Internet Consulting]{.org}
:::

::: email
Email: <vince.fuller@gmail.com>
:::

::: {.left dir="auto"}
[Dave Meyer]{.fn .nameRole}
:::

::: {.left dir="auto"}
[1-4-5.net]{.org}
:::

::: email
Email: <dmm@1-4-5.net>
:::

::: {.left dir="auto"}
[Darrel Lewis]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems]{.org}
:::

::: {.left dir="auto"}
[San Jose]{.locality}, [CA]{.region}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <darlewis@cisco.com>
:::

::: {.left dir="auto"}
[Albert Cabellos ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Universitat Politecnica de Catalunya]{.org}
:::

::: {.left dir="auto"}
[c/ Jordi Girona s/n]{.street-address}
:::

::: {.left dir="auto"}
[08034]{.postal-code} [Barcelona]{.locality}
:::

::: {.left dir="auto"}
[Spain]{.country-name}
:::

::: email
Email: <acabello@ac.upc.edu>
:::
:::
:::
