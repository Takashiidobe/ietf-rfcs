  RFC 8803              Convert Protocol   July 2020
  --------------------- ------------------ -----------
  Bonaventure, et al.   Experimental       \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8803](https://www.rfc-editor.org/rfc/rfc8803){.eref}

Category:
:   Experimental

Published:
:   July 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    O. Bonaventure, [Ed.]{.editor}
    :::

    ::: org
    Tessares
    :::
    :::

    ::: author
    ::: author-name
    M. Boucadair, [Ed.]{.editor}
    :::

    ::: org
    Orange
    :::
    :::

    ::: author
    ::: author-name
    S. Gundavelli
    :::

    ::: org
    Cisco
    :::
    :::

    ::: author
    ::: author-name
    S. Seo
    :::

    ::: org
    Korea Telecom
    :::
    :::

    ::: author
    ::: author-name
    B. Hesmans
    :::

    ::: org
    Tessares
    :::
    :::
:::

# RFC 8803 {#rfcnum}

# 0-RTT TCP Convert Protocol {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies an application proxy, called Transport
Converter, to assist the deployment of TCP extensions such as Multipath
TCP. A Transport Converter may provide conversion service for one or
more TCP extensions. The conversion service is provided by means of the
0-RTT TCP Convert Protocol (Convert).[¶](#section-abstract-1){.pilcrow}

This protocol provides 0-RTT (Zero Round-Trip Time) conversion service
since no extra delay is induced by the protocol compared to connections
that are not proxied. Also, the Convert Protocol does not require any
encapsulation (no tunnels whatsoever).[¶](#section-abstract-2){.pilcrow}

This specification assumes an explicit model, where the Transport
Converter is explicitly configured on hosts. As a sample applicability
use case, this document specifies how the Convert Protocol applies for
Multipath TCP.[¶](#section-abstract-3){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for examination, experimental implementation, and
evaluation.[¶](#section-boilerplate.1-1){.pilcrow}

This document defines an Experimental Protocol for the Internet
community. This document is a product of the Internet Engineering Task
Force (IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Not all documents approved
by the IESG are candidates for any level of Internet Standard; see
Section 2 of RFC 7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8803>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [The
        Problem](#name-the-problem){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Network-Assisted Connections: The
        Rationale](#name-network-assisted-connection){.xref}[¶](#section-toc.1-1.1.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.3}
        [1.3](#section-1.3){.xref}.  [Applicability
        Scope](#name-applicability-scope){.xref}[¶](#section-toc.1-1.1.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions and
    Definitions](#name-conventions-and-definitions){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Differences with
    SOCKSv5](#name-differences-with-socksv5){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Architecture and
    Behaviors](#name-architecture-and-behaviors){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Functional
        Elements](#name-functional-elements){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Theory of
        Operation](#name-theory-of-operation){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Data Processing at the Transport
        Converter](#name-data-processing-at-the-tran){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Address Preservation vs. Address
        Sharing](#name-address-preservation-vs-add){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.4.2.1}
            [4.4.1](#section-4.4.1){.xref}.  [Address
            Preservation](#name-address-preservation){.xref}[¶](#section-toc.1-1.4.2.4.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.2}
            [4.4.2](#section-4.4.2){.xref}.  [Address/Prefix
            Sharing](#name-address-prefix-sharing){.xref}[¶](#section-toc.1-1.4.2.4.2.2.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Sample
    Examples](#name-sample-examples){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Outgoing Converter-Assisted
        Multipath TCP
        Connections](#name-outgoing-converter-assisted){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Incoming Converter-Assisted
        Multipath TCP
        Connection](#name-incoming-converter-assisted){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [The Convert Protocol
    (Convert)](#name-the-convert-protocol-conver){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [The Convert Fixed
        Header](#name-the-convert-fixed-header){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Convert
        TLVs](#name-convert-tlvs){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.6.2.2.2.1}
            [6.2.1](#section-6.2.1){.xref}.  [Generic Convert TLV
            Format](#name-generic-convert-tlv-format){.xref}[¶](#section-toc.1-1.6.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.2}
            [6.2.2](#section-6.2.2){.xref}.  [Summary of Supported
            Convert
            TLVs](#name-summary-of-supported-conver){.xref}[¶](#section-toc.1-1.6.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.3}
            [6.2.3](#section-6.2.3){.xref}.  [The Info
            TLV](#name-the-info-tlv){.xref}[¶](#section-toc.1-1.6.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.4}
            [6.2.4](#section-6.2.4){.xref}.  [Supported TCP Extensions
            TLV](#name-supported-tcp-extensions-tl){.xref}[¶](#section-toc.1-1.6.2.2.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.5}
            [6.2.5](#section-6.2.5){.xref}.  [Connect
            TLV](#name-connect-tlv){.xref}[¶](#section-toc.1-1.6.2.2.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.6}
            [6.2.6](#section-6.2.6){.xref}.  [Extended TCP Header
            TLV](#name-extended-tcp-header-tlv){.xref}[¶](#section-toc.1-1.6.2.2.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.7}
            [6.2.7](#section-6.2.7){.xref}.  [The Cookie
            TLV](#name-the-cookie-tlv){.xref}[¶](#section-toc.1-1.6.2.2.2.7.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.8}
            [6.2.8](#section-6.2.8){.xref}.  [Error
            TLV](#name-error-tlv){.xref}[¶](#section-toc.1-1.6.2.2.2.8.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Compatibility of Specific TCP Options with
    the Conversion
    Service](#name-compatibility-of-specific-t){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Base TCP
        Options](#name-base-tcp-options){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Window Scale
        (WS)](#name-window-scale-ws){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Selective
        Acknowledgments](#name-selective-acknowledgments){.xref}[¶](#section-toc.1-1.7.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [Timestamp](#name-timestamp){.xref}[¶](#section-toc.1-1.7.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.5}
        [7.5](#section-7.5){.xref}.  [Multipath
        TCP](#name-multipath-tcp){.xref}[¶](#section-toc.1-1.7.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.6}
        [7.6](#section-7.6){.xref}.  [TCP Fast
        Open](#name-tcp-fast-open){.xref}[¶](#section-toc.1-1.7.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.7}
        [7.7](#section-7.7){.xref}.  [TCP-AO](#name-tcp-ao){.xref}[¶](#section-toc.1-1.7.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Interactions with
    Middleboxes](#name-interactions-with-middlebox){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Privacy & Ingress
        Filtering](#name-privacy-ingress-filtering){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Authentication and Authorization
        Considerations](#name-authentication-and-authoriz){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [9.3](#section-9.3){.xref}.  [Denial of
        Service](#name-denial-of-service){.xref}[¶](#section-toc.1-1.9.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.4}
        [9.4](#section-9.4){.xref}.  [Traffic
        Theft](#name-traffic-theft){.xref}[¶](#section-toc.1-1.9.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.5}
        [9.5](#section-9.5){.xref}.  [Logging](#name-logging){.xref}[¶](#section-toc.1-1.9.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Convert Service
        Name](#name-convert-service-name){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [The Convert Protocol (Convert)
        Parameters](#name-the-convert-protocol-convert){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.10.2.2.2.1}
            [10.2.1](#section-10.2.1){.xref}.  [Convert
            Versions](#name-convert-versions){.xref}[¶](#section-toc.1-1.10.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.10.2.2.2.2}
            [10.2.2](#section-10.2.2){.xref}.  [Convert
            TLVs](#name-convert-tlvs-2){.xref}[¶](#section-toc.1-1.10.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.10.2.2.2.3}
            [10.2.3](#section-10.2.3){.xref}.  [Convert Error
            Messages](#name-convert-error-messages){.xref}[¶](#section-toc.1-1.10.2.2.2.3.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix A](#section-appendix.a){.xref}.  [Example Socket API
    Changes to Support the 0-RTT TCP Convert
    Protocol](#name-example-socket-api-changes-){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}

    -   ::: {#section-toc.1-1.12.2.1}
        [A.1](#section-a.1){.xref}.  [Active Open (Client
        Side)](#name-active-open-client-side){.xref}[¶](#section-toc.1-1.12.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [A.2](#section-a.2){.xref}.  [Passive Open (Converter
        Side)](#name-passive-open-converter-side){.xref}[¶](#section-toc.1-1.12.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.b){.xref}[Acknowledgments](#name-acknowledgments){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.c){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.15}
    [](#section-appendix.d){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.15.1){.pilcrow}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

::: {#pb}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [The Problem](#name-the-problem){.section-name .selfRef} {#name-the-problem}

Transport protocols like TCP evolve regularly
\[[RFC7414](#RFC7414){.xref}\]. TCP has been improved in different ways.
Some improvements such as changing the initial window size
\[[RFC6928](#RFC6928){.xref}\] or modifying the congestion control
scheme can be applied independently on Clients and Servers. Other
improvements such as Selective Acknowledgments
\[[RFC2018](#RFC2018){.xref}\] or large windows
\[[RFC7323](#RFC7323){.xref}\] require a new TCP option or changing the
semantics of some fields in the TCP header. These modifications must be
deployed on both Clients and Servers to be actually used on the
Internet. Experience with the latter class of TCP extensions reveals
that their deployment can require many years. Fukuda reports in
\[[Fukuda2011](#Fukuda2011){.xref}\] results of a decade of measurements
showing the deployment of Selective Acknowledgments, Window Scale, and
TCP Timestamps. \[[ANRW17](#ANRW17){.xref}\] describes measurements
showing that TCP Fast Open (TFO) \[[RFC7413](#RFC7413){.xref}\] is still
not widely deployed.[¶](#section-1.1-1){.pilcrow}

There are some situations where the transport stack used on Clients (or
Servers) can be upgraded at a faster pace than the transport stack
running on Servers (or Clients). In those situations, Clients (or
Servers) would typically want to benefit from the features of an
improved transport protocol even if the Servers (or Clients) have not
yet been upgraded. Some assistance from the network to make use of these
features is valuable. For example, Performance Enhancing Proxies
\[[RFC3135](#RFC3135){.xref}\] and other service functions have been
deployed as solutions to improve TCP performance over links with
specific characteristics.[¶](#section-1.1-2){.pilcrow}

Recent examples of TCP extensions include Multipath TCP (MPTCP)
\[[RFC8684](#RFC8684){.xref}\] or tcpcrypt
\[[RFC8548](#RFC8548){.xref}\]. Those extensions provide features that
are interesting for Clients such as wireless devices. With Multipath
TCP, those devices could seamlessly use Wireless Local Area Network
(WLAN) and cellular networks for bonding purposes, faster hand-overs, or
better resiliency. Unfortunately, deploying those extensions on both a
wide range of Clients and Servers remains
difficult.[¶](#section-1.1-3){.pilcrow}

More recently, 5G bonding experimentation has been conducted into global
range of the incumbent 4G (LTE) connectivity using newly devised Clients
and a Multipath TCP proxy. Even if the 5G and 4G bonding (that relies
upon Multipath TCP) increases the bandwidth, it is also crucial to
minimize latency entirely between end hosts regardless of whether
intermediate nodes are inside or outside of the mobile core. In order to
handle Ultra-Reliable Low Latency Communication (URLLC) for the
next-generation mobile network, Multipath TCP and its proxy mechanism
such as the one used to provide Access Traffic Steering, Switching, and
Splitting (ATSSS) must be optimized to reduce latency
\[[TS23501](#TS23501){.xref}\].[¶](#section-1.1-4){.pilcrow}
:::
:::

::: {#network-assisted-connections-the-rationale}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Network-Assisted Connections: The Rationale](#name-network-assisted-connection){.section-name .selfRef} {#name-network-assisted-connection}

This document specifies an application proxy called Transport Converter.
A Transport Converter is a function that is installed by a network
operator to aid the deployment of TCP extensions and to provide the
benefits of such extensions to Clients in particular. A Transport
Converter may provide conversion service for one or more TCP extensions.
Which TCP extensions are eligible for the conversion service is
deployment specific. The conversion service is provided by means of the
0-RTT TCP Convert Protocol (Convert), which is an application-layer
protocol that uses a specific TCP port number on the
Converter.[¶](#section-1.2-1){.pilcrow}

The Convert Protocol provides Zero Round-Trip Time (0-RTT) conversion
service since no extra delay is induced by the protocol compared to
connections that are not proxied. Particularly, the Convert Protocol
does not require extra signaling setup delays before making use of the
conversion service. The Convert Protocol does not require any
encapsulation (no tunnels, whatsoever).[¶](#section-1.2-2){.pilcrow}

The Transport Converter adheres to the main steps drawn in [Section
3](https://www.rfc-editor.org/rfc/rfc1919#section-3){.relref} of
\[[RFC1919](#RFC1919){.xref}\]. In particular, a Transport Converter
achieves the following:[¶](#section-1.2-3){.pilcrow}

-   [Listening for Client
    sessions;[¶](#section-1.2-4.1){.pilcrow}]{#section-1.2-4.1}
-   [Receiving the address of the Server from the
    Client;[¶](#section-1.2-4.2){.pilcrow}]{#section-1.2-4.2}
-   [Setting up a session to the
    Server;[¶](#section-1.2-4.3){.pilcrow}]{#section-1.2-4.3}
-   [Relaying control messages and data between the Client and the
    Server;[¶](#section-1.2-4.4){.pilcrow}]{#section-1.2-4.4}
-   [Performing access controls according to local
    policies.[¶](#section-1.2-4.5){.pilcrow}]{#section-1.2-4.5}

The main advantage of network-assisted conversion services is that they
enable new TCP extensions to be used on a subset of the path between
endpoints, which encourages the deployment of these extensions.
Furthermore, the Transport Converter allows the Client and the Server to
directly negotiate TCP extensions for the sake of native support along
the full path.[¶](#section-1.2-5){.pilcrow}

The Convert Protocol is a generic mechanism to provide 0-RTT conversion
service. As a sample applicability use case, this document specifies how
the Convert Protocol applies for Multipath TCP. It is out of scope of
this document to provide a comprehensive list of all potential
conversion services. Applicability documents may be defined in the
future.[¶](#section-1.2-6){.pilcrow}

This document does not assume that all the traffic is eligible for the
network-assisted conversion service. Only a subset of the traffic will
be forwarded to a Transport Converter according to a set of policies.
These policies, and how they are communicated to endpoints, are out of
scope. Furthermore, it is possible to bypass the Transport Converter to
connect directly to the Servers that already support the required TCP
extension(s).[¶](#section-1.2-7){.pilcrow}

This document assumes an explicit model in which a Client is configured
with one or a list of Transport Converters (statically or through
protocols such as
\[[DHC-CONVERTER](#I-D.boucadair-tcpm-dhc-converter){.xref}\]).
Configuration means are outside the scope of this
document.[¶](#section-1.2-8){.pilcrow}

The use of a Transport Converter means that there is no end-to-end
transport connection between the Client and Server. This could
potentially create problems in some scenarios such as those discussed in
[Section 4](https://www.rfc-editor.org/rfc/rfc3135#section-4){.relref}
of \[[RFC3135](#RFC3135){.xref}\]. Some of these problems may not be
applicable. For example, a Transport Converter can inform a Client by
means of Network Failure (65) or Destination Unreachable (97) error
messages ([Section 6.2.8](#sec-error){.xref}) that it encounters a
failure problem; the Client can react accordingly. An endpoint, or its
network administrator, can assess the benefit provided by the Transport
Converter service versus the risk. This is one reason why the Transport
Converter functionality has to be explicitly requested by an
endpoint.[¶](#section-1.2-9){.pilcrow}

This document is organized as follows:[¶](#section-1.2-10){.pilcrow}

-   [[Section 3](#sec-socks){.xref} provides a brief overview of the
    differences between the well-known SOCKS protocol and the 0-RTT TCP
    Convert
    Protocol.[¶](#section-1.2-11.1){.pilcrow}]{#section-1.2-11.1}
-   [[Section 4](#sec-arch){.xref} provides a brief explanation of the
    operation of Transport
    Converters.[¶](#section-1.2-11.2){.pilcrow}]{#section-1.2-11.2}
-   [[Section 5](#sample-examples){.xref} includes a set of sample
    examples to illustrate the overall
    behavior.[¶](#section-1.2-11.3){.pilcrow}]{#section-1.2-11.3}
-   [[Section 6](#sec-protocol){.xref} describes the Convert
    Protocol.[¶](#section-1.2-11.4){.pilcrow}]{#section-1.2-11.4}
-   [[Section 7](#sec-tcpoptions){.xref} discusses how Transport
    Converters can be used to support different TCP
    extensions.[¶](#section-1.2-11.5){.pilcrow}]{#section-1.2-11.5}
-   [[Section 8](#sec-middleboxes){.xref} then discusses the
    interactions with
    middleboxes.[¶](#section-1.2-11.6){.pilcrow}]{#section-1.2-11.6}
-   [[Section 9](#sec-security){.xref} focuses on security
    considerations.[¶](#section-1.2-11.7){.pilcrow}]{#section-1.2-11.7}
-   [[Appendix A](#sec-api){.xref} describes how a TCP stack would need
    to support the protocol described in this
    document.[¶](#section-1.2-11.8){.pilcrow}]{#section-1.2-11.8}
:::
:::

::: {#section-1.3 .section}
### [1.3.](#section-1.3){.section-number .selfRef} [Applicability Scope](#name-applicability-scope){.section-name .selfRef} {#name-applicability-scope}

The 0-RTT TCP Convert Protocol specified in this document [MUST]{.bcp14}
be used in a single administrative domain deployment model. That is, the
entity offering the connectivity service to a Client is also the entity
that owns and operates the Transport Converter, with no transit over a
third-party network.[¶](#section-1.3-1){.pilcrow}

Future deployment of Transport Converters by third parties
[MUST]{.bcp14} adhere to the mutual authentication requirements in
[Section 9.2](#authorization){.xref} to prevent illegitimate traffic
interception ([Section 9.4](#traffic-theft){.xref}) in
particular.[¶](#section-1.3-2){.pilcrow}
:::
:::
:::

::: {#conventions-and-definitions}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions and Definitions](#name-conventions-and-definitions){.section-name .selfRef} {#name-conventions-and-definitions}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::
:::

::: {#sec-socks}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Differences with SOCKSv5](#name-differences-with-socksv5){.section-name .selfRef} {#name-differences-with-socksv5}

Several IETF protocols provide proxy services, the closest to the 0-RTT
TCP Convert Protocol being the SOCKSv5 protocol
\[[RFC1928](#RFC1928){.xref}\]. This protocol is already used to deploy
Multipath TCP in some cellular networks ([Section
2.2](https://www.rfc-editor.org/rfc/rfc8041#section-2.2){.relref} of
\[[RFC8041](#RFC8041){.xref}\]).[¶](#section-3-1){.pilcrow}

A SOCKS Client creates a connection to a SOCKS Proxy, exchanges
authentication information, and indicates the IP address and port number
of the target Server. At this point, the SOCKS Proxy creates a
connection towards the target Server and relays all data between the two
proxied connections. The operation of an implementation based on SOCKSv5
(without authentication) is illustrated in [Figure
1](#fig-socks5){.xref}.[¶](#section-3-2){.pilcrow}

[]{#name-establishment-of-a-tcp-conn}

::: {#fig-socks5}
::: {#section-3-3.1 .artwork .art-text .alignLeft}
    Client                SOCKS Proxy               Server
       |                       |                       |
       | --------------------> |                       |
       |         SYN           |                       |
       | <-------------------- |                       |
       |       SYN+ACK         |                       |
       | --------------------> |                       |
       |         ACK           |                       |
       |                       |                       |
       | --------------------> |                       |
       |Version=5, Auth Methods|                       |
       | <-------------------- |                       |
       |       Method          |                       |
       | --------------------> |                       |
       |Auth Request (unless "No auth" method negotiated)
       | <-------------------- |                       |
       |     Auth Response     |                       |
       | --------------------> |                       |
       | Connect Server:Port   | --------------------> |
       |                       |          SYN          |
       |                       | <-------------------- |
       |                       |        SYN+ACK        |
       | <-------------------- |                       |
       |      Succeeded        |                       |
       | --------------------> |                       |
       |       Data1           |                       |
       |                       | --------------------> |
       |                       |         Data1         |
       |                       | <-------------------- |
       |                       |         Data2         |
       | <-------------------- |                       |
       |          Data2        |                       |
                             ...
:::

[Figure 1](#figure-1){.selfRef}: [Establishment of a TCP Connection
through a SOCKS Proxy without
Authentication](#name-establishment-of-a-tcp-conn){.selfRef}
:::

When SOCKS is used, an \"end-to-end\" connection between a Client and a
Server becomes a sequence of two TCP connections that are glued together
on the SOCKS Proxy. The SOCKS Client and Server exchange control
information at the beginning of the bytestream on the Client-Proxy
connection. The SOCKS Proxy then creates the connection with the target
Server and then glues the two connections together so that all bytes
sent by the application (Client) to the SOCKS Proxy are relayed to the
Server and vice versa.[¶](#section-3-4){.pilcrow}

The Convert Protocol is also used on TCP proxies that relay data between
an upstream and a downstream connection, but there are important
differences with SOCKSv5. A first difference is that the 0-RTT TCP
Convert Protocol exchanges all the control information during the
initial RTT. This reduces the connection establishment delay compared to
SOCKS, which requires two or more round-trip times before the
establishment of the downstream connection towards the final
destination. In today\'s Internet, latency is an important metric, and
various protocols have been tuned to reduce their latency
\[[LOW-LATENCY](#I-D.arkko-arch-low-latency){.xref}\]. A recently
proposed extension to SOCKS leverages the TCP Fast Open (TFO) option
\[[INTAREA-SOCKS](#I-D.olteanu-intarea-socks-6){.xref}\] to reduce this
delay.[¶](#section-3-5){.pilcrow}

A second difference is that the Convert Protocol explicitly takes the
TCP extensions into account. By using the Convert Protocol, the Client
can learn whether a given TCP extension is supported by the destination
Server. This enables the Client to bypass the Transport Converter when
the Server supports the required TCP extension(s). Neither SOCKSv5
\[[RFC1928](#RFC1928){.xref}\] nor the proposed SOCKSv6
\[[INTAREA-SOCKS](#I-D.olteanu-intarea-socks-6){.xref}\] provide such a
feature.[¶](#section-3-6){.pilcrow}

A third difference is that a Transport Converter will only confirm the
establishment of the connection initiated by the Client provided that
the downstream connection has already been accepted by the Server. If
the Server refuses the connection establishment attempt from the
Transport Converter, then the upstream connection from the Client is
rejected as well. This feature is important for applications that check
the availability of a Server or use the time to connect as a hint on the
selection of a Server
\[[RFC8305](#RFC8305){.xref}\].[¶](#section-3-7){.pilcrow}

A fourth difference is that the 0-RTT TCP Convert Protocol only allows
the Client to specify the IP address/port number of the destination
Server and not a DNS name. We evaluated an alternate design that
included the DNS name of the remote peer instead of its IP address as in
SOCKS \[[RFC1928](#RFC1928){.xref}\]. However, that design was not
adopted because it induces both an extra load and increased delays on
the Transport Converter to handle and manage DNS resolution requests.
Note that the name resolution at the Converter may fail (e.g., private
names discussed in [Section
2.1](https://www.rfc-editor.org/rfc/rfc6731#section-2.1){.relref} of
\[[RFC6731](#RFC6731){.xref}\]) or may not match the one that would be
returned by a Client\'s resolution library (e.g., [Section
2.2](https://www.rfc-editor.org/rfc/rfc6731#section-2.2){.relref} of
\[[RFC6731](#RFC6731){.xref}\]).[¶](#section-3-8){.pilcrow}
:::
:::

::: {#sec-arch}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Architecture and Behaviors](#name-architecture-and-behaviors){.section-name .selfRef} {#name-architecture-and-behaviors}

::: {#functional-elements}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Functional Elements](#name-functional-elements){.section-name .selfRef} {#name-functional-elements}

The Convert Protocol considers three functional
elements:[¶](#section-4.1-1){.pilcrow}

-   [Clients[¶](#section-4.1-2.1){.pilcrow}]{#section-4.1-2.1}
-   [Transport
    Converters[¶](#section-4.1-2.2){.pilcrow}]{#section-4.1-2.2}
-   [Servers[¶](#section-4.1-2.3){.pilcrow}]{#section-4.1-2.3}

A Transport Converter is a network function that proxies all data
exchanged over one upstream connection to one downstream connection and
vice versa ([Figure 2](#figtc){.xref}). Thus, the Transport Converter
maintains state that associates one upstream connection to a
corresponding downstream connection.[¶](#section-4.1-3){.pilcrow}

A connection can be initiated from both sides of the Transport Converter
(External realm, Internal realm).[¶](#section-4.1-4){.pilcrow}

[]{#name-a-transport-converter-proxi}

::: {#figtc}
::: {#section-4.1-5.1 .artwork .art-text .alignLeft}
                               |
                               :
                               |
                         +------------+
    Client <- upstream ->| Transport  |<- downstream -> Server
             connection  | Converter  |   connection
                         +------------+
                               |
                Internal realm : External realm
                               |
:::

[Figure 2](#figure-2){.selfRef}: [A Transport Converter Proxies Data
between Pairs of TCP
Connections](#name-a-transport-converter-proxi){.selfRef}
:::

\"Client\" refers to a software instance embedded on a host that can
reach a Transport Converter in the internal realm. The \"Client\" can
initiate connections via a Transport Converter (referred to as outgoing
connections). Also, the \"Client\" can accept incoming connections via a
Transport Converter (referred to as incoming
connections).[¶](#section-4.1-6){.pilcrow}

A Transport Converter can be embedded in a standalone device or be
activated as a service on a router. How such a function is enabled is
deployment specific.[¶](#section-4.1-7){.pilcrow}

The architecture assumes that new software will be installed on the
Client hosts to interact with one or more Transport Converters.
Furthermore, the architecture allows for making use of new TCP
extensions even if those are not supported by a given
Server.[¶](#section-4.1-8){.pilcrow}

A Client is configured, through means that are outside the scope of this
document, with the names and/or addresses of one or more Transport
Converters and the TCP extensions that they support. The procedure for
selecting a Transport Converter among a list of configured Transport
Converters is outside the scope of this
document.[¶](#section-4.1-9){.pilcrow}

One of the benefits of this design is that different transport protocol
extensions can be used on the upstream and the downstream connections.
This encourages the deployment of new TCP extensions until they are
widely supported, in particular, by
Servers.[¶](#section-4.1-10){.pilcrow}

The architecture does not mandate anything on the Server
side.[¶](#section-4.1-11){.pilcrow}

Similar to SOCKS, the architecture does not interfere with end-to-end
TLS connections \[[RFC8446](#RFC8446){.xref}\] between the Client and
the Server ([Figure 3](#figtls){.xref}). In other words, end-to-end TLS
is supported in the presence of a
Converter.[¶](#section-4.1-12){.pilcrow}

[]{#name-end-to-end-tls-via-a-transp}

::: {#figtls}
::: {#section-4.1-13.1 .artwork .art-text .alignLeft}
        Client             Transport                Server
           |               Converter                  |
           |                   |                      |
           /==========================================\
          |            End-to-end TLS                  |
           \==========================================/

        * TLS messages exchanged between the Client
          and the Server are not shown.
:::

[Figure 3](#figure-3){.selfRef}: [End-to-end TLS via a Transport
Converter](#name-end-to-end-tls-via-a-transp){.selfRef}
:::

It is out of scope of this document to elaborate on specific
considerations related to the use of TLS in the Client-Converter
connection leg to exchange Convert messages (in addition to the
end-to-end TLS connection). In particular, (1) assessment of whether
0-RTT data mode discussed in [Section
2.3](https://www.rfc-editor.org/rfc/rfc8446#section-2.3){.relref} of
\[[RFC8446](#RFC8446){.xref}\] is safe under replay and (2)
specification of a profile for its use ([Appendix
E.5](https://www.rfc-editor.org/rfc/rfc8446#appendix-E.5){.relref} of
\[[RFC8446](#RFC8446){.xref}\]) are out of
scope.[¶](#section-4.1-14){.pilcrow}
:::
:::

::: {#sec-to}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Theory of Operation](#name-theory-of-operation){.section-name .selfRef} {#name-theory-of-operation}

At a high level, the objective of the Transport Converter is to allow
the use a specific extension, e.g., Multipath TCP, on a subset of the
path even if the peer does not support this extension. This is
illustrated in [Figure 4](#fig-highlevel){.xref} where the Client
initiates a Multipath TCP connection with the Transport Converter
(packets belonging to the Multipath TCP connection are shown with
\"===\") while the Transport Converter uses a TCP connection with the
Server.[¶](#section-4.2-1){.pilcrow}

[]{#name-an-example-of-0-rtt-network}

::: {#fig-highlevel}
::: {#section-4.2-2.1 .artwork .art-text .alignLeft}
        Client             Transport                Server
           |               Converter                  |
           |                   |                      |
           |==================>|--------------------->|
           |                   |                      |
           |<==================|<---------------------|
           |                   |                      |
          Multipath TCP packets     TCP packets
:::

[Figure 4](#figure-4){.selfRef}: [An Example of 0-RTT Network-Assisted
Outgoing MPTCP Connection](#name-an-example-of-0-rtt-network){.selfRef}
:::

The packets belonging to a connection established through a Transport
Converter may follow a different path than the packets directly
exchanged between the Client and the Server. Deployments should minimize
the possible additional delay by carefully selecting the location of the
Transport Converter used to reach a given
destination.[¶](#section-4.2-3){.pilcrow}

When establishing a connection, the Client can, depending on local
policies, either contact the Server directly (e.g., by sending a TCP SYN
towards the Server) or create the connection via a Transport Converter.
In the latter case (that is, the conversion service is used), the Client
initiates a connection towards the Transport Converter and indicates the
IP address and port number of the Server within the connection
establishment packet. Doing so enables the Transport Converter to
immediately initiate a connection towards that Server without
experiencing an extra delay. The Transport Converter waits until the
receipt of the confirmation that the Server agrees to establish the
connection before confirming it to the
Client.[¶](#section-4.2-4){.pilcrow}

The Client places the destination address and port number of the Server
in the payload of the SYN sent to the Transport Converter to minimize
connection establishment delays. The Transport Converter maintains two
connections that are combined together:[¶](#section-4.2-5){.pilcrow}

-   [The upstream connection is the one between the Client and the
    Transport
    Converter.[¶](#section-4.2-6.1){.pilcrow}]{#section-4.2-6.1}
-   [The downstream connection is the one between the Transport
    Converter and the
    Server.[¶](#section-4.2-6.2){.pilcrow}]{#section-4.2-6.2}

Any user data received by the Transport Converter over the upstream (or
downstream) connection is proxied over the downstream (or upstream)
connection.[¶](#section-4.2-7){.pilcrow}

[Figure 5](#fig-estab){.xref} illustrates the establishment of an
outgoing TCP connection by a Client through a Transport
Converter.[¶](#section-4.2-8){.pilcrow}

Note: The information shown between brackets in [Figure
5](#fig-estab){.xref} (and other figures in the document) refers to
Convert Protocol messages described in [Section
6](#sec-protocol){.xref}.[¶](#section-4.2-9.1){.pilcrow}

[]{#name-establishment-of-an-outgoin}

::: {#fig-estab}
::: {#section-4.2-10.1 .artwork .art-text .alignLeft}
                            Transport
        Client              Converter              Server
           |                   |                      |
           |SYN [->Server:port]|         SYN          |
           |------------------>|--------------------->|
           |<------------------|<---------------------|
           |    SYN+ACK [ ]    |        SYN+ACK       |
           |        ...        |          ...         |
:::

[Figure 5](#figure-5){.selfRef}: [Establishment of an Outgoing TCP
Connection through a Transport
Converter](#name-establishment-of-an-outgoin){.selfRef}
:::

The Client sends a SYN destined to the Transport Converter. The payload
of this SYN contains the address and port number of the Server. The
Transport Converter does not reply immediately to this SYN. It first
tries to create a TCP connection towards the target Server. If this
upstream connection succeeds, the Transport Converter confirms the
establishment of the connection to the Client by returning a SYN+ACK and
the first bytes of the bytestream contain information about the TCP
options that were negotiated with the Server. Also, a state entry is
instantiated for this connection. This state entry is used by the
Converter to handle subsequent messages belonging to the
connection.[¶](#section-4.2-11){.pilcrow}

The connection can also be established from the Internet towards a
Client via a Transport Converter ([Figure 6](#fig-estab2){.xref}). This
is typically the case when the Client hosts an application Server that
listens to a specific port number. When the Converter receives an
incoming SYN from a remote host, it checks if it can provide the
conversion service for the destination IP address and destination port
number of that SYN. The Transport Converter receives this SYN because it
is, for example, on the path between the remote host and the Client or
it provides address-sharing service for the Client ([Section
2](https://www.rfc-editor.org/rfc/rfc6269#section-2){.relref} of
\[[RFC6269](#RFC6269){.xref}\]). If the check fails, the packet is
silently ignored by the Converter. If the check is successful, the
Converter tries to initiate a TCP connection towards the Client from its
own address and using its configured TCP options. In the SYN that
corresponds to this connection attempt, the Transport Convert inserts a
TLV message that indicates the source address and port number of the
remote host. A transport session entry is created by the Converter for
this connection. SYN+ACK and ACK will then be exchanged between the
Client, the Converter, and remote host to confirm the establishment of
the connection. The Converter uses the transport session entry to proxy
packets belonging to the connection.[¶](#section-4.2-12){.pilcrow}

[]{#name-establishment-of-an-incomin}

::: {#fig-estab2}
::: {#section-4.2-13.1 .artwork .art-text .alignLeft}
      Transport              Remote
        Client              Converter             Host (RH)
           |                   |                      |
           |SYN [<-RH IP@:port]|         SYN          |
           |<------------------|<---------------------|
           |------------------>|--------------------->|
           |    SYN+ACK [ ]    |        SYN+ACK       |
           |        ...        |          ...         |
:::

[Figure 6](#figure-6){.selfRef}: [Establishment of an Incoming TCP
Connection through a Transport
Converter](#name-establishment-of-an-incomin){.selfRef}
:::

Standard TCP ([Section
3.4](https://www.rfc-editor.org/rfc/rfc793#section-3.4){.relref} of
\[[RFC0793](#RFC0793){.xref}\]) allows a SYN packet to carry data inside
its payload but forbids the receiver from delivering it to the
application until completion of the three-way-handshake. To enable
applications to exchange data in a TCP handshake, this specification
follows an approach similar to TCP Fast Open
\[[RFC7413](#RFC7413){.xref}\] and thus, removes the constraint by
allowing data in SYN packets to be delivered to the Transport Converter
application.[¶](#section-4.2-14){.pilcrow}

As discussed in \[[RFC7413](#RFC7413){.xref}\], such change to TCP
semantics raises two issues. First, duplicate SYNs can cause problems
for applications that rely on TCP; whether or not a given application is
affected depends on the details of that application protocol. Second,
TCP suffers from SYN flooding attacks \[[RFC4987](#RFC4987){.xref}\].
TFO solves these two problems for applications that can tolerate replays
by using the TCP Fast Open option that includes a cookie. However, the
utilization of this option consumes space in the limited TCP header.
Furthermore, there are situations, as noted in [Section
7.3](https://www.rfc-editor.org/rfc/rfc7413#section-7.3){.relref} of
\[[RFC7413](#RFC7413){.xref}\], where it is possible to accept the
payload of SYN packets without creating additional security risks such
as a network where addresses cannot be spoofed and the Transport
Converter only serves a set of hosts that are identified by these
addresses.[¶](#section-4.2-15){.pilcrow}

For these reasons, this specification does not mandate the use of the
TCP Fast Open option when the Client sends a connection establishment
packet towards a Transport Converter. The Convert Protocol includes an
optional Cookie TLV that provides similar protection as the TCP Fast
Open option without consuming space in the TCP header. Furthermore, this
design allows for the use of longer cookies than
\[[RFC7413](#RFC7413){.xref}\].[¶](#section-4.2-16){.pilcrow}

If the downstream (or upstream) connection fails for some reason
(excessive retransmissions, reception of an RST segment, etc.), then the
Converter reacts by forcing the teardown of the upstream (or downstream)
connection. In particular, if an ICMP error message that indicates a
hard error is received on the downstream connection, the Converter
echoes the Code field of that ICMP message in a Destination Unreachable
Error TLV (see [Section 6.2.8](#sec-error){.xref}) that it transmits to
the Client. Note that if an ICMP error message that indicates a soft
error is received on the downstream connection, the Converter will
retransmit the corresponding data until it is acknowledged or the
connection times out. A classification of ICMP soft and hard errors is
provided in Table 1 of
\[[RFC5461](#RFC5461){.xref}\].[¶](#section-4.2-17){.pilcrow}

The same reasoning applies when the upstream connection ends with an
exchange of FIN segments. In this case, the Converter will also
terminate the downstream connection by using FIN segments. If the
downstream connection terminates with the exchange of FIN segments, the
Converter should initiate a graceful termination of the upstream
connection.[¶](#section-4.2-18){.pilcrow}
:::
:::

::: {#sec-dbb}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Data Processing at the Transport Converter](#name-data-processing-at-the-tran){.section-name .selfRef} {#name-data-processing-at-the-tran}

As mentioned in [Section 4.2](#sec-to){.xref}, the Transport Converter
acts as a TCP proxy between the upstream connection (i.e., between the
Client and the Transport Converter) and the downstream connection (i.e.,
between the Transport Converter and the
Server).[¶](#section-4.3-1){.pilcrow}

The control messages (i.e., the Convert messages discussed in [Section
6](#sec-protocol){.xref}) establish state (called transport session
entry) in the Transport Converter that will enable it to proxy between
the two TCP connections.[¶](#section-4.3-2){.pilcrow}

The Transport Converter uses the transport session entry to proxy
packets belonging to the connection. An implementation example of a
transport session entry for TCP connections is shown in [Figure
7](#fig-dbt){.xref}.[¶](#section-4.3-3){.pilcrow}

[]{#name-an-example-of-transport-ses}

::: {#fig-dbt}
::: {#section-4.3-4.1 .artwork .art-text .alignLeft}
                       (C,c) <--> (T,t), (S,s), Lifetime
:::

[Figure 7](#figure-7){.selfRef}: [An Example of Transport Session
Entry](#name-an-example-of-transport-ses){.selfRef}
:::

Where:[¶](#section-4.3-5){.pilcrow}

-   [C and c are the source IP address and source port number used by
    the Client for the upstream
    connection.[¶](#section-4.3-6.1){.pilcrow}]{#section-4.3-6.1}
-   [S and s are the Server\'s IP address and port
    number.[¶](#section-4.3-6.2){.pilcrow}]{#section-4.3-6.2}
-   [T and t are the source IP address and source port number used by
    the Transport Converter to proxy the
    connection.[¶](#section-4.3-6.3){.pilcrow}]{#section-4.3-6.3}
-   [Lifetime is a timer that tracks the remaining lifetime of the entry
    as assigned by the Converter. When the timer expires, the entry is
    deleted.[¶](#section-4.3-6.4){.pilcrow}]{#section-4.3-6.4}

Clients send packets bound to connections eligible for the conversion
service to the provisioned Transport Converter and destination port
number. This applies for both control messages and data. Additional
information is supplied by Clients to the Transport Converter by means
of Convert messages as detailed in [Section 6](#sec-protocol){.xref}.
User data can be included in SYN or non-SYN messages. User data is
unambiguously distinguished from Convert TLVs by a Transport Converter
owing to the Convert Fixed Header in the Convert messages ([Section
6.1](#sec-header){.xref}). These Convert TLVs are destined to the
Transport Convert and are, thus, removed by the Transport Converter when
proxying between the two connections.[¶](#section-4.3-7){.pilcrow}

Upon receipt of a packet that belongs to an existing connection between
a Client and the Transport Converter, the Converter proxies the user
data to the Server using the information stored in the corresponding
transport session entry. For example, in reference to [Figure
7](#fig-dbt){.xref}, the Transport Converter proxies the data received
from (C,⁠c) downstream using (T,t) as source transport address and (S,s)
as destination transport address.[¶](#section-4.3-8){.pilcrow}

A similar process happens for data sent from the Server. The Converter
acts as a TCP proxy and sends the data to the Client relying upon the
information stored in a transport session entry. The Converter
associates a lifetime with state entries used to bind an upstream
connection with its downstream connection.[¶](#section-4.3-9){.pilcrow}

When Multipath TCP is used between the Client and the Transport
Converter, the Converter maintains more state (e.g., information about
the subflows) for each Multipath TCP connection. The procedure described
above continues to apply except that the Converter needs to manage the
establishment/termination of subflows and schedule packets among the
established ones. These operations are part of the Multipath TCP
implementation. They are independent of the Convert Protocol that only
processes the Convert messages in the beginning of the
bytestream.[¶](#section-4.3-10){.pilcrow}

A Transport Converter may operate in address preservation mode (that is,
the Converter does not rewrite the source IP address (i.e., C==T)) or
address-sharing mode (that is, an address pool is shared among all
Clients serviced by the Converter (i.e., C!=T)); refer to [Section
4.4](#sec-add){.xref} for more details. Which behavior to use by a
Transport Converter is deployment specific. If address-sharing mode is
enabled, the Transport Converter [MUST]{.bcp14} adhere to REQ-2 of
\[[RFC6888](#RFC6888){.xref}\], which implies a default \"IP address
pooling\" behavior of \"Paired\" (as defined in [Section
4.1](https://www.rfc-editor.org/rfc/rfc4787#section-4.1){.relref} of
\[[RFC4787](#RFC4787){.xref}\]) [MUST]{.bcp14} be supported. This
behavior is meant to avoid breaking applications that depend on the
source address remaining constant.[¶](#section-4.3-11){.pilcrow}
:::
:::

::: {#sec-add}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Address Preservation vs. Address Sharing](#name-address-preservation-vs-add){.section-name .selfRef} {#name-address-preservation-vs-add}

The Transport Converter is provided with instructions about the behavior
to adopt with regard to the processing of source addresses of outgoing
packets. The following subsections discuss two deployment models for
illustration purposes. It is out of the scope of this document to make a
recommendation.[¶](#section-4.4-1){.pilcrow}

::: {#sec-addp}
::: {#section-4.4.1 .section}
#### [4.4.1.](#section-4.4.1){.section-number .selfRef} [Address Preservation](#name-address-preservation){.section-name .selfRef} {#name-address-preservation}

In this model, the visible source IP address of a packet proxied by a
Transport Converter to a Server is an IP address of the end host
(Client). No dedicated IP address pool is provisioned to the Transport
Converter, but the Transport Converter is located on the path between
the Client and the Server.[¶](#section-4.4.1-1){.pilcrow}

For Multipath TCP, the Transport Converter preserves the source IP
address used by the Client when establishing the initial subflow. Data
conveyed in secondary subflows will be proxied by the Transport
Converter using the source IP address of the initial subflow. An example
of a proxied Multipath TCP connection with address preservation is shown
in [Figure 8](#fig-addp){.xref}.[¶](#section-4.4.1-2){.pilcrow}

[]{#name-example-of-address-preserva}

::: {#fig-addp}
::: {#section-4.4.1-3.1 .artwork .art-text .alignLeft}
                                          Transport
           Client                        Converter          Server

            @:C1,C2                        @:Tc                @:S
               ||                            |                  |
               |src:C1     SYN         dst:Tc|src:C1       dst:S|
               |-------MPC [->S:port]------->|-------SYN------->|
               ||                            |                  |
               ||dst:C1                src:Tc|dst:C1       src:S|
               |<---------SYN/ACK------------|<-----SYN/ACK-----|
               ||                            |                  |
               |src:C1                 dst:Tc|src:C1       dst:S|
               |------------ACK------------->|-------ACK------->|
               |                             |                  |
               |src:C2          ...    dst:Tc|       ...        |
               ||<-----Secondary Subflow---->|src:C1       dst:S|
               ||                            |-------data------>|
               |               ..            |    ...           |

    Legend:
      Tc: IP address used by the Transport Converter on the internal
          realm.
:::

[Figure 8](#figure-8){.selfRef}: [Example of Address
Preservation](#name-example-of-address-preserva){.selfRef}
:::

The Transport Converter must be on the forwarding path of incoming
traffic. Because the same (destination) IP address is used for both
proxied and non-proxied connections, the Transport Converter should not
drop incoming packets it intercepts if no matching entry is found for
the packets. Unless explicitly configured otherwise, such packets are
forwarded according to the instructions of a local forwarding
table.[¶](#section-4.4.1-4){.pilcrow}
:::
:::

::: {#sec-adds}
::: {#section-4.4.2 .section}
#### [4.4.2.](#section-4.4.2){.section-number .selfRef} [Address/Prefix Sharing](#name-address-prefix-sharing){.section-name .selfRef} {#name-address-prefix-sharing}

A pool of global IPv4 addresses is provisioned to the Transport
Converter along with possible instructions about the address-sharing
ratio to apply (see [Appendix
B](https://www.rfc-editor.org/rfc/rfc6269#appendix-B){.relref} of
\[[RFC6269](#RFC6269){.xref}\]). An address is thus shared among
multiple Clients.[¶](#section-4.4.2-1){.pilcrow}

Likewise, rewriting the source IPv6 prefix
\[[RFC6296](#RFC6296){.xref}\] may be used to ease redirection of
incoming IPv6 traffic towards the appropriate Transport Converter. A
pool of IPv6 prefixes is then provisioned to the Transport Converter for
this purpose.[¶](#section-4.4.2-2){.pilcrow}

Adequate forwarding policies are enforced so that traffic destined to an
address of such a pool is intercepted by the appropriate Transport
Converter. Unlike [Section 4.4.1](#sec-addp){.xref}, the Transport
Converter drops incoming packets that do not match an active transport
session entry.[¶](#section-4.4.2-3){.pilcrow}

An example is shown in [Figure
9](#fig-adds){.xref}.[¶](#section-4.4.2-4){.pilcrow}

[]{#name-address-sharing}

::: {#fig-adds}
::: {#section-4.4.2-5.1 .artwork .art-text .alignLeft}
                                         Transport
          Client                         Converter          Server

             @:C                        @:Tc|Te                @:S
              |                             |                  |
              |src:C                  dst:Tc|src:Te       dst:S|
              |-------SYN [->S:port]------->|-------SYN------->|
              |                             |                  |
              |dst:C                  src:Tc|dst:Te       src:S|
              |<---------SYN/ACK------------|<-----SYN/ACK-----|
              |                             |                  |
              |src:C                  dst:Tc|src:Te       dst:S|
              |------------ACK------------->|-------ACK------->|
              |                             |                  |
              |              ...            |    ...           |

    Legend:
      Tc: IP address used by the Transport Converter on the internal
          realm.
      Te: IP address used by the Transport Converter on the external
          realm.
:::

[Figure 9](#figure-9){.selfRef}: [Address
Sharing](#name-address-sharing){.selfRef}
:::
:::
:::
:::
:::
:::
:::

::: {#sample-examples}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Sample Examples](#name-sample-examples){.section-name .selfRef} {#name-sample-examples}

::: {#outgoing-converter-assisted-multipath-tcp-connections}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Outgoing Converter-Assisted Multipath TCP Connections](#name-outgoing-converter-assisted){.section-name .selfRef} {#name-outgoing-converter-assisted}

As an example, let us consider how the Convert Protocol can help the
deployment of Multipath TCP. We assume that both the Client and the
Transport Converter support Multipath TCP but consider two different
cases depending on whether or not the Server supports Multipath
TCP.[¶](#section-5.1-1){.pilcrow}

As a reminder, a Multipath TCP connection is created by placing the
MP_CAPABLE (MPC) option in the SYN sent by the
Client.[¶](#section-5.1-2){.pilcrow}

[Figure 10](#fig-mpestab){.xref} describes the operation of the
Transport Converter if the Server does not support Multipath
TCP.[¶](#section-5.1-3){.pilcrow}

[]{#name-establishment-of-a-multipat}

::: {#fig-mpestab}
::: {#section-5.1-4.1 .artwork .art-text .alignLeft}
                            Transport
        Client              Converter              Server
           |SYN, MPC           |                      |
           |[->Server:port]    |         SYN, MPC     |
           |------------------>|--------------------->|
           |<------------------|<---------------------|
           |  SYN+ACK,MPC [.]  |      SYN+ACK         |
           |------------------>|--------------------->|
           |     ACK, MPC      |          ACK         |
           |        ...        |          ...         |
:::

[Figure 10](#figure-10){.selfRef}: [Establishment of a Multipath TCP
Connection through a Transport Converter towards a Server That Does Not
support Multipath TCP](#name-establishment-of-a-multipat){.selfRef}
:::

The Client tries to initiate a Multipath TCP connection by sending a SYN
with the MP_CAPABLE option (MPC in [Figure 10](#fig-mpestab){.xref}).
The SYN includes the address and port number of the target Server, that
are extracted and used by the Transport Converter to initiate a
Multipath TCP connection towards this Server. Since the Server does not
support Multipath TCP, it replies with a SYN+ACK that does not contain
the MP_CAPABLE option. The Transport Converter notes that the connection
with the Server does not support Multipath TCP and returns the extended
TCP header received from the Server to the
Client.[¶](#section-5.1-5){.pilcrow}

Note that, if the TCP connection is reset for some reason, the Converter
tears down the Multipath TCP connection by transmitting an MP_FASTCLOSE.
Likewise, if the Multipath TCP connection ends with the transmission of
DATA_FINs, the Converter terminates the TCP connection by using FIN
segments. As a side note, given that with Multipath TCP, RST only has
the scope of the subflow and will only close the concerned subflow but
not affect the remaining subflows, the Converter does not terminate the
downstream TCP connection upon receipt of an RST over a Multipath
subflow.[¶](#section-5.1-6){.pilcrow}

[Figure 11](#fig-mpestabok){.xref} considers a Server that supports
Multipath TCP. In this case, it replies to the SYN sent by the Transport
Converter with the MP_CAPABLE option. Upon reception of this SYN+ACK,
the Transport Converter confirms the establishment of the connection to
the Client and indicates to the Client that the Server supports
Multipath TCP. With this information, the Client has discovered that the
Server supports Multipath TCP. This will enable the Client to bypass the
Transport Converter for the subsequent Multipath TCP connections that it
will initiate towards this Server.[¶](#section-5.1-7){.pilcrow}

[]{#name-establishment-of-a-multipath}

::: {#fig-mpestabok}
::: {#section-5.1-8.1 .artwork .art-text .alignLeft}
                            Transport
        Client              Converter              Server
           |SYN, MPC           |                      |
           |[->Server:port]    |         SYN, MPC     |
           |------------------>|--------------------->|
           |<------------------|<---------------------|
           |SYN+ACK, MPC       |      SYN+ACK, MPC    |
           |[MPC supported]    |                      |
           |------------------>|--------------------->|
           |     ACK, MPC      |        ACK, MPC      |
           |        ...        |          ...         |
:::

[Figure 11](#figure-11){.selfRef}: [Establishment of a Multipath TCP
Connection through a Converter towards an MPTCP-Capable
Server](#name-establishment-of-a-multipath){.selfRef}
:::
:::
:::

::: {#incoming-converter-assisted-multipath-tcp-connection}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Incoming Converter-Assisted Multipath TCP Connection](#name-incoming-converter-assisted){.section-name .selfRef} {#name-incoming-converter-assisted}

An example of an incoming Converter-assisted Multipath TCP connection is
depicted in [Figure 12](#fig-inestab){.xref}. In order to support
incoming connections from remote hosts, the Client may use the Port
Control Protocol (PCP) \[[RFC6887](#RFC6887){.xref}\] to instruct the
Transport Converter to create dynamic mappings. Those mappings will be
used by the Transport Converter to intercept an incoming TCP connection
destined to the Client and convert it into a Multipath TCP
connection.[¶](#section-5.2-1){.pilcrow}

Typically, the Client sends a PCP request to the Converter asking to
create an explicit TCP mapping for the internal IP address and internal
port number. The Converter accepts the request by creating a TCP mapping
for the internal IP address, internal port number, external IP address,
and external port number. The external IP address, external port number,
and assigned lifetime are returned back to the Client in the PCP
response. The external IP address and external port number will then be
advertised by the Client (or the user) using an out-of-band mechanism so
that remote hosts can initiate TCP connections to the Client via the
Converter. Note that the external and internal information may be the
same.[¶](#section-5.2-2){.pilcrow}

Then, when the Converter receives an incoming SYN, it checks its mapping
table to verify if there is an active mapping matching the destination
IP address and destination port of that SYN. If no entry is found, the
Converter silently ignores the message. If an entry is found, the
Converter inserts an MP_CAPABLE option and Connect TLV in the SYN
packet, and rewrites the source IP address to one of its IP addresses
and, eventually, the destination IP address and port number in
accordance with the information stored in the mapping. SYN+ACK and ACK
will then be exchanged between the Client and the Converter to confirm
the establishment of the initial subflow. The Client can add new
subflows following normal Multipath TCP
procedures.[¶](#section-5.2-3){.pilcrow}

[]{#name-establishment-of-an-incoming}

::: {#fig-inestab}
::: {#section-5.2-4.1 .artwork .art-text .alignLeft}
                            Transport             Remote
        Client              Converter              Host
          |                     |                    |
          |<--------------------|<-------------------|
          |SYN, MPC             |         SYN        |
          |[Remote Host:port]   |                    |
          |-------------------->|------------------->|
          |      SYN+ACK, MPC   |       SYN+ACK      |
          |<--------------------|<-------------------|
          |       ACK, MPC      |           ACK      |
          |        ...          |          ...       |
:::

[Figure 12](#figure-12){.selfRef}: [Establishment of an Incoming
Multipath TCP Connection through a Transport
Converter](#name-establishment-of-an-incoming){.selfRef}
:::

It is out of scope of this document to define specific Convert TLVs to
manage incoming connections (that is, TLVs that mimic PCP messages).
These TLVs can be defined in a separate
document.[¶](#section-5.2-5){.pilcrow}
:::
:::
:::
:::

::: {#sec-protocol}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [The Convert Protocol (Convert)](#name-the-convert-protocol-conver){.section-name .selfRef} {#name-the-convert-protocol-conver}

This section defines the Convert Protocol (Convert, for short) messages
that are exchanged between a Client and a Transport
Converter.[¶](#section-6-1){.pilcrow}

The Transport Converter listens on a specific TCP port number for
Convert messages from Clients. That port number is configured by an
administrator. Absent any policy, the Transport Converter
[SHOULD]{.bcp14} silently ignore SYNs with no Convert
TLVs.[¶](#section-6-2){.pilcrow}

Convert messages may appear only in SYN, SYN+ACK, or
ACK.[¶](#section-6-3){.pilcrow}

Convert messages [MUST]{.bcp14} be included as the first bytes of the
bytestream. All Convert messages start with a fixed header that is 32
bits long ([Section 6.1](#sec-header){.xref}) followed by one or more
Convert TLVs (Type, Length, Value) ([Section
6.2](#sec-tlv){.xref}).[¶](#section-6-4){.pilcrow}

If the initial SYN message contains user data in its payload (e.g., see
\[[RFC7413](#RFC7413){.xref}\]), that data [MUST]{.bcp14} be placed
right after the Convert TLVs when generating the
SYN.[¶](#section-6-5){.pilcrow}

The protocol can be extended by defining new TLVs or bumping the version
number if a different message format is needed. If a future version is
defined but with a different message format, the version negotiation
procedure defined in [Section 6.2.8](#sec-error){.xref} (see
\"Unsupported Version\") is meant to agree on a version that is
supported by both peers.[¶](#section-6-6){.pilcrow}

Implementation note 1: Several implementers expressed concerns about the
use of TFO. As a reminder, the Fast Open Cookie protects from some
attack scenarios that affect open servers like web servers. The Convert
Protocol is different and, as discussed in
\[[RFC7413](#RFC7413){.xref}\], there are different ways to protect from
such attacks. Instead of using a Fast Open Cookie inside the TCP
options, which consumes precious space in the extended TCP header, the
Convert Protocol supports the utilization of a Cookie that is placed in
the SYN payload. This provides the same level of protection as a Fast
Open Cookie in environments were such protection is
required.[¶](#section-6-7.1){.pilcrow}

Implementation note 2: Error messages are not included in RST but sent
in the bytestream. Implementers have indicated that processing RST on
Clients was difficult on some platforms. This design simplifies Client
implementations.[¶](#section-6-7.2){.pilcrow}

::: {#sec-header}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [The Convert Fixed Header](#name-the-convert-fixed-header){.section-name .selfRef} {#name-the-convert-fixed-header}

The Convert Protocol uses a fixed header that is 32 bits long sent by
both the Client and the Transport Converter over each established
connection. This header indicates both the version of the protocol used
and the length of the Convert message.[¶](#section-6.1-1){.pilcrow}

The Client and the Transport Converter [MUST]{.bcp14} send the
fixed-sized header, shown in [Figure 13](#fig-header){.xref}, as the
first four bytes of the bytestream.[¶](#section-6.1-2){.pilcrow}

[]{#name-the-convert-fixed-header-2}

::: {#fig-header}
::: {#section-6.1-3.1 .artwork .art-text .alignLeft}
                         1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +---------------+---------------+-------------------------------+
    |  Version      |  Total Length |          Magic Number         |
    +---------------+---------------+-------------------------------+
:::

[Figure 13](#figure-13){.selfRef}: [The Convert Fixed
Header](#name-the-convert-fixed-header-2){.selfRef}
:::

The version is encoded as an 8-bit unsigned integer value. This document
specifies version 1. Version 0 is reserved by this document and [MUST
NOT]{.bcp14} be used.[¶](#section-6.1-4){.pilcrow}

Note: Early versions of this specification don\'t use a dedicated port
number but only rely upon the IP address of the Converter. Having a bit
set in the Version field together with the Total Length field avoids
misinterpreting data in a SYN as Convert TLVs. Since the design was
updated to use a specific service port, that constraint was relaxed.
Version 0 would work, but given existing implementations already use
Version 1, the use of Version 0 is maintained as
reserved.[¶](#section-6.1-5.1){.pilcrow}

The Total Length is the number of 32-bit words, including the header, of
the bytestream that are consumed by the Convert messages. Since Total
Length is also an 8-bit unsigned integer, those messages cannot consume
more than 1020 bytes of data. This limits the number of bytes that a
Transport Converter needs to process. A Total Length of zero is invalid
and the connection [MUST]{.bcp14} be reset upon reception of a header
with such a total length.[¶](#section-6.1-6){.pilcrow}

The Magic Number field [MUST]{.bcp14} be set to 0x2263. This field is
meant to further strengthen the protocol to unambiguously distinguish
any data supplied by an application from Convert
TLVs.[¶](#section-6.1-7){.pilcrow}

The Total Length field unambiguously marks the number of 32-bit words
that carry Convert TLVs in the beginning of the
bytestream.[¶](#section-6.1-8){.pilcrow}
:::
:::

::: {#sec-tlv}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Convert TLVs](#name-convert-tlvs){.section-name .selfRef} {#name-convert-tlvs}

::: {#generic-convert-tlv-format}
::: {#section-6.2.1 .section}
#### [6.2.1.](#section-6.2.1){.section-number .selfRef} [Generic Convert TLV Format](#name-generic-convert-tlv-format){.section-name .selfRef} {#name-generic-convert-tlv-format}

The Convert Protocol uses variable length messages that are encoded
using the generic TLV format depicted in [Figure
14](#fi-generictlv){.xref}.[¶](#section-6.2.1-1){.pilcrow}

The length of all TLVs used by the Convert Protocol is always a multiple
of four bytes. All TLVs are aligned on 32-bit boundaries. All TLV fields
are encoded using the network byte order.[¶](#section-6.2.1-2){.pilcrow}

[]{#name-convert-generic-tlv-format}

::: {#fi-generictlv}
::: {#section-6.2.1-3.1 .artwork .art-text .alignLeft}
                            1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +---------------+---------------+-------------------------------+
       |     Type      |     Length    |             Value  ...        |
       +---------------+---------------+-------------------------------+
       //              ...   (optional) Value                         //
       +---------------------------------------------------------------+
:::

[Figure 14](#figure-14){.selfRef}: [Convert Generic TLV
Format](#name-convert-generic-tlv-format){.selfRef}
:::

The Length field covers Type, Length, and Value fields. It is expressed
in units of 32-bit words. If necessary, Value [MUST]{.bcp14} be padded
with zeroes so that the length of the TLV is a multiple of 32
bits.[¶](#section-6.2.1-4){.pilcrow}

A given TLV [MUST]{.bcp14} only appear once on a connection. If a Client
receives two or more instances of the same TLV over a Convert
connection, it [MUST]{.bcp14} reset the associated TCP connection. If a
Converter receives two or more instances of the same TLV over a Convert
connection, it [MUST]{.bcp14} return a Malformed Message Error TLV and
close the associated TCP connection.[¶](#section-6.2.1-5){.pilcrow}
:::
:::

::: {#summary-of-supported-convert-tlvs}
::: {#section-6.2.2 .section}
#### [6.2.2.](#section-6.2.2){.section-number .selfRef} [Summary of Supported Convert TLVs](#name-summary-of-supported-conver){.section-name .selfRef} {#name-summary-of-supported-conver}

This document specifies the following Convert
TLVs:[¶](#section-6.2.2-1){.pilcrow}

[]{#name-the-tlvs-used-by-the-conver}

::: {#tab-converter-tlv}
  Type   Hex    Length     Description
  ------ ------ ---------- ------------------------------
  1      0x1    1          Info TLV
  10     0xA    Variable   Connect TLV
  20     0x14   Variable   Extended TCP Header TLV
  21     0x15   Variable   Supported TCP Extensions TLV
  22     0x16   Variable   Cookie TLV
  30     0x1E   Variable   Error TLV

  : [Table 1](#table-1){.selfRef}: [The TLVs Used by the Convert
  Protocol](#name-the-tlvs-used-by-the-conver){.selfRef}
:::

Type 0x0 is a reserved value. If a Client receives a TLV of type 0x0, it
[MUST]{.bcp14} reset the associated TCP connection. If a Converter
receives a TLV of type 0x0, it [MUST]{.bcp14} return an Unsupported
Message Error TLV and close the associated TCP
connection.[¶](#section-6.2.2-3){.pilcrow}

The Client typically sends, in the first connection it established with
a Transport Converter, the Info TLV ([Section
6.2.3](#sec-bootstrap-tlv){.xref}) to learn its capabilities. Assuming
the Client is authorized to invoke the Transport Converter, the latter
replies with the Supported TCP Extensions TLV ([Section
6.2.4](#sec-supported){.xref}).[¶](#section-6.2.2-4){.pilcrow}

The Client can request the establishment of connections to Servers by
using the Connect TLV ([Section 6.2.5](#sec-connect){.xref}). If the
connection can be established with the final Server, the Transport
Converter replies with the Extended TCP Header TLV ([Section
6.2.6](#sec-ext-header){.xref}). If not, the Transport Converter
[MUST]{.bcp14} return an Error TLV ([Section 6.2.8](#sec-error){.xref})
and then close the connection. The Transport Converter [MUST
NOT]{.bcp14} send an RST immediately after the detection of an error to
let the Error TLV reach the Client. As explained later, the Client will
send an RST regardless upon reception of the Error
TLV.[¶](#section-6.2.2-5){.pilcrow}
:::
:::

::: {#sec-bootstrap-tlv}
::: {#section-6.2.3 .section}
#### [6.2.3.](#section-6.2.3){.section-number .selfRef} [The Info TLV](#name-the-info-tlv){.section-name .selfRef} {#name-the-info-tlv}

The Info TLV ([Figure 15](#fig-bootstrap){.xref}) is an optional TLV
that can be sent by a Client to request the TCP extensions that are
supported by a Transport Converter. It is typically sent on the first
connection that a Client establishes with a Transport Converter to learn
its capabilities. Assuming a Client is entitled to invoke the Transport
Converter, the latter replies with the Supported TCP Extensions TLV
described in [Section
6.2.4](#sec-supported){.xref}.[¶](#section-6.2.3-1){.pilcrow}

[]{#name-the-info-tlv-2}

::: {#fig-bootstrap}
::: {#section-6.2.3-2.1 .artwork .art-text .alignLeft}
                         1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +---------------+---------------+-------------------------------+
    |     Type=0x1  |     Length    |             Zero              |
    +---------------+---------------+-------------------------------+
:::

[Figure 15](#figure-15){.selfRef}: [The Info
TLV](#name-the-info-tlv-2){.selfRef}
:::
:::
:::

::: {#sec-supported}
::: {#section-6.2.4 .section}
#### [6.2.4.](#section-6.2.4){.section-number .selfRef} [Supported TCP Extensions TLV](#name-supported-tcp-extensions-tl){.section-name .selfRef} {#name-supported-tcp-extensions-tl}

The Supported TCP Extensions TLV ([Figure 16](#fig-supported){.xref}) is
used by a Transport Converter to announce the TCP options for which it
provides a conversion service. A Transport Converter [SHOULD]{.bcp14}
include in this list the TCP options that it supports in outgoing
SYNs.[¶](#section-6.2.4-1){.pilcrow}

Each supported TCP option is encoded with its TCP option Kind listed in
the \"Transmission Control Protocol (TCP) Parameters\" registry
maintained by IANA \[[IANA-CONVERT](#IANA-CONVERT){.xref}\]. The
Unassigned field [MUST]{.bcp14} be set to zero by the Transport
Converter and ignored by the Client.[¶](#section-6.2.4-2){.pilcrow}

[]{#name-the-supported-tcp-extension}

::: {#fig-supported}
::: {#section-6.2.4-3.1 .artwork .art-text .alignLeft}
                          1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+-------------------------------+
     |     Type=0x15 |     Length    |           Unassigned          |
     +---------------+---------------+-------------------------------+
     |     Kind #1   |     Kind #2   |           ...                 |
     +---------------+---------------+-------------------------------+
     /                              ...                              /
     /                                                               /
     +---------------------------------------------------------------+
:::

[Figure 16](#figure-16){.selfRef}: [The Supported TCP Extensions
TLV](#name-the-supported-tcp-extension){.selfRef}
:::

TCP option Kinds 1 and 2 defined in \[[RFC0793](#RFC0793){.xref}\] are
supported by all TCP implementations and thus, [MUST NOT]{.bcp14} appear
in this list.[¶](#section-6.2.4-4){.pilcrow}

The list of Supported TCP Extensions is padded with 0 to end on a 32-bit
boundary.[¶](#section-6.2.4-5){.pilcrow}

For example, if the Transport Converter supports Multipath TCP, Kind=30
will be present in the Supported TCP Extensions TLV that it returns in
response to the Info TLV.[¶](#section-6.2.4-6){.pilcrow}
:::
:::

::: {#sec-connect}
::: {#section-6.2.5 .section}
#### [6.2.5.](#section-6.2.5){.section-number .selfRef} [Connect TLV](#name-connect-tlv){.section-name .selfRef} {#name-connect-tlv}

The Connect TLV ([Figure 17](#fig-connect){.xref}) is used to request
the establishment of a connection via a Transport Converter. This
connection can be from or to a Client.[¶](#section-6.2.5-1){.pilcrow}

The Remote Peer Port and Remote Peer IP Address fields contain the
destination port number and IP address of the Server, for outgoing
connections. For incoming connections destined to a Client serviced via
a Transport Converter, these fields convey the source port number and IP
address of the SYN packet received by the Transport Converter from the
Server.[¶](#section-6.2.5-2){.pilcrow}

The Remote Peer IP Address [MUST]{.bcp14} be encoded as an IPv6 address.
IPv4 addresses [MUST]{.bcp14} be encoded using the IPv4-mapped IPv6
address format defined in \[[RFC4291](#RFC4291){.xref}\]. Further, the
Remote Peer IP Address field [MUST NOT]{.bcp14} include multicast,
broadcast, or host loopback addresses \[[RFC6890](#RFC6890){.xref}\]. If
a Converter receives a Connect TLV with such invalid addresses, it
[MUST]{.bcp14} reply with a Malformed Message Error TLV and close the
associated TCP connection.[¶](#section-6.2.5-3){.pilcrow}

We distinguish two types of Connect TLV based on their length: (1) the
Base Connect TLV has a length set to 5 (i.e., 20 bytes) and contains a
remote address and a remote port ([Figure 17](#fig-connect){.xref}), and
(2) the Extended Connect TLV spans more than 20 bytes and also includes
the optional TCP Options field ([Figure 18](#fig-econnect){.xref}). This
field is used to request the advertisement of specific TCP options to
the Server.[¶](#section-6.2.5-4){.pilcrow}

[]{#name-the-base-connect-tlv}

::: {#fig-connect}
::: {#section-6.2.5-5.1 .artwork .art-text .alignLeft}
                          1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+-------------------------------+
     |     Type=0xA  |     Length    |      Remote Peer Port         |
     +---------------+---------------+-------------------------------+
     |                                                               |
     |         Remote Peer IP Address (128 bits)                     |
     |                                                               |
     |                                                               |
     +---------------------------------------------------------------+
:::

[Figure 17](#figure-17){.selfRef}: [The Base Connect
TLV](#name-the-base-connect-tlv){.selfRef}
:::

[]{#name-the-extended-connect-tlv}

::: {#fig-econnect}
::: {#section-6.2.5-6.1 .artwork .art-text .alignLeft}
                          1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+-------------------------------+
     |     Type=0xA  |     Length    |      Remote Peer Port         |
     +---------------+---------------+-------------------------------+
     |                                                               |
     |         Remote Peer IP Address (128 bits)                     |
     |                                                               |
     |                                                               |
     +---------------------------------------------------------------+
     /                          TCP Options (Variable)               /
     /                              ...                              /
     +---------------------------------------------------------------+
:::

[Figure 18](#figure-18){.selfRef}: [The Extended Connect
TLV](#name-the-extended-connect-tlv){.selfRef}
:::

The TCP Options field is a variable length field that carries a list of
TCP option fields ([Figure 19](#fig-tcpopt){.xref}). Each TCP option
field is encoded as a block of 2+n bytes where the first byte is the TCP
option Kind and the second byte is the length of the TCP option as
specified in \[[RFC0793](#RFC0793){.xref}\]. The minimum value for the
TCP option Length is 2. The TCP options that do not include a length
sub-field, i.e., option types 0 (EOL) and 1 (NOP) defined in
\[[RFC0793](#RFC0793){.xref}\] [MUST NOT]{.bcp14} be placed inside the
TCP options field of the Connect TLV. The optional Value field contains
the variable-length part of the TCP option. A length of 2 indicates the
absence of the Value field. The TCP options field always ends on a
32-bit boundary after being padded with
zeros.[¶](#section-6.2.5-7){.pilcrow}

[]{#name-the-tcp-options-field}

::: {#fig-tcpopt}
::: {#section-6.2.5-8.1 .artwork .art-text .alignLeft}
                         1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+---------------+---------------+
     |  TCPOpt kind  | TCPOpt Length | Value  (opt)  |  ....         |
     +---------------+---------------+---------------+---------------+
     |                             ....                              |
     +---------------------------------------------------------------+
     |                              ...                              |
     +---------------------------------------------------------------+
:::

[Figure 19](#figure-19){.selfRef}: [The TCP Options
Field](#name-the-tcp-options-field){.selfRef}
:::

Upon reception of a Base Connect TLV, and absent any policy (e.g.,
rate-limit) or resource exhaustion conditions, a Transport Converter
attempts to establish a connection to the address and port that it
contains. The Transport Converter [MUST]{.bcp14} use by default the TCP
options that correspond to its local policy to establish this
connection.[¶](#section-6.2.5-9){.pilcrow}

Upon reception of an Extended Connect TLV, a Transport Converter first
checks whether or not it supports the TCP Options listed in the TCP
Options field. If not, it returns an error TLV set to \"Unsupported TCP
Option\" ([Section 6.2.8](#sec-error){.xref}). If the above check
succeeded, and absent any rate-limit policy or resource exhaustion
conditions, a Transport Converter [MUST]{.bcp14} attempt to establish a
connection to the address and port that it contains. It [MUST]{.bcp14}
include in the SYN that it sends to the Server the options listed in the
TCP Options subfield and the TCP options that it would have used
according to its local policies. For the TCP options that are included
in the TCP Options field without an optional value, the Transport
Converter [MUST]{.bcp14} generate its own value. For the TCP options
that are included in the TCP Options field with an optional value, it
[MUST]{.bcp14} copy the entire option in the SYN sent to the remote
Server. This procedure is designed with TFO in mind. Particularly, this
procedure allows to successfully exchange a Fast Open Cookie between the
Client and the Server. See [Section 7](#sec-tcpoptions){.xref} for a
detailed discussion of the different types of TCP
options.[¶](#section-6.2.5-10){.pilcrow}

The Transport Converter may refuse a Connect TLV request for various
reasons (e.g., authorization failed, out of resources, invalid address
type, or unsupported TCP option). An error message indicating the
encountered error is returned to the requesting Client ([Section
6.2.8](#sec-error){.xref}). In order to prevent denial-of-service
attacks, error messages sent to a Client [SHOULD]{.bcp14} be
rate-limited.[¶](#section-6.2.5-11){.pilcrow}
:::
:::

::: {#sec-ext-header}
::: {#section-6.2.6 .section}
#### [6.2.6.](#section-6.2.6){.section-number .selfRef} [Extended TCP Header TLV](#name-extended-tcp-header-tlv){.section-name .selfRef} {#name-extended-tcp-header-tlv}

The Extended TCP Header TLV ([Figure 20](#fig-tcpheader){.xref}) is used
by the Transport Converter to return to the Client the TCP options that
were returned by the Server in the SYN+ACK packet. A Transport Converter
[MUST]{.bcp14} return this TLV if the Client sent an Extended Connect
TLV and the connection was accepted by the
Server.[¶](#section-6.2.6-1){.pilcrow}

[]{#name-the-extended-tcp-header-tlv}

::: {#fig-tcpheader}
::: {#section-6.2.6-2.1 .artwork .art-text .alignLeft}
                          1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+-------------------------------+
     |     Type=0x14 |     Length    |           Unassigned          |
     +---------------+---------------+-------------------------------+
     /               Returned Extended TCP header                    /
     /                              ...                              /
     +---------------------------------------------------------------+
:::

[Figure 20](#figure-20){.selfRef}: [The Extended TCP Header
TLV](#name-the-extended-tcp-header-tlv){.selfRef}
:::

The Returned Extended TCP header field is a copy of the TCP Options that
were included in the SYN+ACK received by the Transport
Converter.[¶](#section-6.2.6-3){.pilcrow}

The Unassigned field [MUST]{.bcp14} be set to zero by the sender and
ignored by the receiver.[¶](#section-6.2.6-4){.pilcrow}
:::
:::

::: {#sec-cookie-tlv}
::: {#section-6.2.7 .section}
#### [6.2.7.](#section-6.2.7){.section-number .selfRef} [The Cookie TLV](#name-the-cookie-tlv){.section-name .selfRef} {#name-the-cookie-tlv}

The Cookie TLV ([Figure 21](#fig-cookie){.xref}) is an optional TLV that
is similar to the TCP Fast Open Cookie \[[RFC7413](#RFC7413){.xref}\]. A
Transport Converter may want to verify that a Client can receive the
packets that it sends to prevent attacks from spoofed addresses. This
verification can be done by using a Cookie that is bound to, for
example, the IP address(es) of the Client. This Cookie can be configured
on the Client by means that are outside of this document or provided by
the Transport Converter.[¶](#section-6.2.7-1){.pilcrow}

A Transport Converter that has been configured to use the optional
Cookie TLV [MUST]{.bcp14} verify the presence of this TLV in the payload
of the received SYN. If this TLV is present, the Transport Converter
[MUST]{.bcp14} validate the Cookie by means similar to those in [Section
4.1.2](https://www.rfc-editor.org/rfc/rfc7413#section-4.1.2){.relref} of
\[[RFC7413](#RFC7413){.xref}\] (i.e., IsCookieValid). If the Cookie is
valid, the connection establishment procedure can continue. Otherwise,
the Transport Converter [MUST]{.bcp14} return an Error TLV set to \"Not
Authorized\" and close the connection.[¶](#section-6.2.7-2){.pilcrow}

If the received SYN did not contain a Cookie TLV, and cookie validation
is required, the Transport Converter [MAY]{.bcp14} compute a Cookie
bound to this Client address. In such case, the Transport Converter
[MUST]{.bcp14} return an Error TLV set to \"Missing Cookie\" and the
computed Cookie and close the connection. The Client will react to this
error by first issuing a reset to terminate the connection. It also
stores the received Cookie in its cache and attempts to reestablish a
new connection to the Transport Converter that includes the Cookie
TLV.[¶](#section-6.2.7-3){.pilcrow}

The format of the Cookie TLV is shown in [Figure
21](#fig-cookie){.xref}.[¶](#section-6.2.7-4){.pilcrow}

[]{#name-the-cookie-tlv-2}

::: {#fig-cookie}
::: {#section-6.2.7-5.1 .artwork .art-text .alignLeft}
                          1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+-------------------------------+
     |     Type=0x16 |     Length    |             Zero              |
     +---------------+---------------+-------------------------------+
     /                        Opaque  Cookie                         /
     /                              ...                              /
     +---------------------------------------------------------------+
:::

[Figure 21](#figure-21){.selfRef}: [The Cookie
TLV](#name-the-cookie-tlv-2){.selfRef}
:::
:::
:::

::: {#sec-error}
::: {#section-6.2.8 .section}
#### [6.2.8.](#section-6.2.8){.section-number .selfRef} [Error TLV](#name-error-tlv){.section-name .selfRef} {#name-error-tlv}

The Error TLV ([Figure 22](#fig-error){.xref}) is meant to provide
information about some errors that occurred during the processing of a
Convert message. This TLV has a variable length. Upon reception of an
Error TLV, a Client [MUST]{.bcp14} reset the associated
connection.[¶](#section-6.2.8-1){.pilcrow}

An Error TLV can be included in the SYN+ACK or an
ACK.[¶](#section-6.2.8-2){.pilcrow}

[]{#name-the-error-tlv}

::: {#fig-error}
::: {#section-6.2.8-3.1 .artwork .art-text .alignLeft}
                          1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +---------------+---------------+----------------+--------------+
     |     Type=0x1E |     Length    |    Error Code  |  Value       |
     +---------------+---------------+----------------+--------------+
     //              ...   (optional) Value                         //
     +---------------------------------------------------------------+
:::

[Figure 22](#figure-22){.selfRef}: [The Error
TLV](#name-the-error-tlv){.selfRef}
:::

Different types of errors can occur while processing Convert messages.
Each error is identified by an Error Code represented as an unsigned
integer. Four classes of error codes are
defined:[¶](#section-6.2.8-4){.pilcrow}

[]{.break}

Message validation and processing errors (0-31 range):
:   Returned upon reception of an invalid message (including valid
    messages but with invalid or unknown
    TLVs).[¶](#section-6.2.8-5.2){.pilcrow}
:   

Client-side errors (32-63 range):
:   The Client sent a request that could not be accepted by the
    Transport Converter (e.g., unsupported
    operation).[¶](#section-6.2.8-5.4){.pilcrow}
:   

Converter-side errors (64-95 range):
:   Problems encountered on the Transport Converter (e.g., lack of
    resources) that prevent it from fulfilling the Client\'s
    request.[¶](#section-6.2.8-5.6){.pilcrow}
:   

Errors caused by the destination Server (96-127 range):
:   The final destination could not be reached or it replied with a
    reset.[¶](#section-6.2.8-5.8){.pilcrow}
:   

The following error codes are defined in this
document:[¶](#section-6.2.8-6){.pilcrow}

[]{.break}

Unsupported Version (0):

:   The version number indicated in the fixed header of a message
    received from a peer is not
    supported.[¶](#section-6.2.8-7.2.1){.pilcrow}

    This error code [MUST]{.bcp14} be generated by a peer (e.g.,
    Transport Converter) when it receives a request having a version
    number that it does not support.[¶](#section-6.2.8-7.2.2){.pilcrow}

    The Value field [MUST]{.bcp14} be set to the version supported by
    the peer. When multiple versions are supported by the peer, it
    includes the list of supported versions in the Value field; each
    version is encoded in 8 bits. The list of supported versions
    [MUST]{.bcp14} be padded with zeros to end on a 32-bit
    boundary.[¶](#section-6.2.8-7.2.3){.pilcrow}

    Upon receipt of this error code, the remote peer (e.g., Client)
    checks whether it supports one of the versions returned by the peer.
    The highest commonly supported version number [MUST]{.bcp14} be used
    by the remote peer in subsequent exchanges with the
    peer.[¶](#section-6.2.8-7.2.4){.pilcrow}

:   

Malformed Message (1):

:   This error code is sent to indicate that a message received from a
    peer cannot be successfully parsed and
    validated.[¶](#section-6.2.8-7.4.1){.pilcrow}

    Typically, this error code is sent by the Transport Converter if it
    receives a Connect TLV enclosing a multicast, broadcast, or loopback
    IP address.[¶](#section-6.2.8-7.4.2){.pilcrow}

    To ease troubleshooting, the Value field [MUST]{.bcp14} echo the
    received message using the format depicted in [Figure
    23](#shift){.xref}. This format allows keeping the original
    alignment of the message that triggered the
    error.[¶](#section-6.2.8-7.4.3){.pilcrow}

    []{#name-error-tlv-to-ease-message-c}

    ::: {#shift}
    ::: {#section-6.2.8-7.4.4.1 .artwork .art-text .alignLeft}
                              1                   2                   3
          0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
         +---------------+---------------+----------------+--------------+
         |     Type=0x1E |     Length    |    Error Code  |  Zeros       |
         +---------------+---------------+----------------+--------------+
         //        Echo the message that triggered the error            //
         +---------------------------------------------------------------+
    :::

    [Figure 23](#figure-23){.selfRef}: [Error TLV to Ease Message
    Correlation](#name-error-tlv-to-ease-message-c){.selfRef}
    :::

:   

Unsupported Message (2):

:   This error code is sent to indicate that a message type received
    from a Client is not supported.[¶](#section-6.2.8-7.6.1){.pilcrow}

    To ease troubleshooting, the Value field [MUST]{.bcp14} echo the
    received message using the format shown in [Figure
    23](#shift){.xref}.[¶](#section-6.2.8-7.6.2){.pilcrow}

:   

Missing Cookie (3):

:   If a Transport Converter requires the utilization of Cookies to
    prevent spoofing attacks and a Cookie TLV was not included in the
    Convert message, the Transport Converter [MUST]{.bcp14} return this
    error to the requesting Client only if it computes a cookie for this
    Client. The first byte of the Value field [MUST]{.bcp14} be set to
    zero and the remaining bytes of the Error TLV contain the Cookie
    computed by the Transport Converter for this
    Client.[¶](#section-6.2.8-7.8.1){.pilcrow}

    A Client that receives this error code [SHOULD]{.bcp14} cache the
    received Cookie and include it in subsequent Convert messages sent
    to that Transport Converter.[¶](#section-6.2.8-7.8.2){.pilcrow}

:   

Not Authorized (32):

:   This error code indicates that the Transport Converter refused to
    create a connection because of a lack of authorization (e.g.,
    administratively prohibited, authorization failure, or invalid
    Cookie TLV). The Value field [MUST]{.bcp14} be set to
    zero.[¶](#section-6.2.8-7.10.1){.pilcrow}

    This error code [MUST]{.bcp14} be sent by the Transport Converter
    when a request cannot be successfully processed because the
    authorization failed.[¶](#section-6.2.8-7.10.2){.pilcrow}

:   

Unsupported TCP Option (33):

:   A TCP option that the Client requested to advertise to the final
    Server cannot be safely used.[¶](#section-6.2.8-7.12.1){.pilcrow}

    The Value field is set to the type of the unsupported TCP option. If
    several unsupported TCP options were specified in the Connect TLV,
    then the list of unsupported TCP options is returned. The list of
    unsupported TCP options [MUST]{.bcp14} be padded with zeros to end
    on a 32-bit boundary.[¶](#section-6.2.8-7.12.2){.pilcrow}

:   

Resource Exceeded (64):

:   This error indicates that the Transport Converter does not have
    enough resources to perform the
    request.[¶](#section-6.2.8-7.14.1){.pilcrow}

    This error [MUST]{.bcp14} be sent by the Transport Converter when it
    does not have sufficient resources to handle a new connection. The
    Transport Converter may indicate in the Value field the suggested
    delay (in seconds) that the Client [SHOULD]{.bcp14} wait before
    soliciting the Transport Converter for a new proxied connection. A
    Value of zero corresponds to a default delay of at least 30
    seconds.[¶](#section-6.2.8-7.14.2){.pilcrow}

:   

Network Failure (65):

:   This error indicates that the Transport Converter is experiencing a
    network failure to proxy the
    request.[¶](#section-6.2.8-7.16.1){.pilcrow}

    The Transport Converter [MUST]{.bcp14} send this error code when it
    experiences forwarding issues to proxy a connection. The Transport
    Converter may indicate in the Value field the suggested delay (in
    seconds) that the Client [SHOULD]{.bcp14} wait before soliciting the
    Transport Converter for a new proxied connection. A Value of zero
    corresponds to a default delay of at least 30
    seconds.[¶](#section-6.2.8-7.16.2){.pilcrow}

:   

Connection Reset (96):
:   This error indicates that the final destination responded with an
    RST segment. The Value field [MUST]{.bcp14} be set to
    zero.[¶](#section-6.2.8-7.18){.pilcrow}
:   

Destination Unreachable (97):

:   This error indicates that an ICMP message indicating a hard error
    (e.g., destination unreachable, port unreachable, or network
    unreachable) was received by the Transport Converter. The Value
    field [MUST]{.bcp14} echo the Code field of the received ICMP
    message.[¶](#section-6.2.8-7.20.1){.pilcrow}

    As a reminder, TCP implementations are supposed to act on an ICMP
    error message passed up from the IP layer, directing it to the
    connection that triggered the error using the demultiplexing
    information included in the payload of that ICMP message. Such a
    demultiplexing issue does not apply for handling the \"Destination
    Unreachable\" Error TLV because the error is sent in-band. For this
    reason, the payload of the ICMP message is not echoed in the
    Destination Unreachable Error
    TLV.[¶](#section-6.2.8-7.20.2){.pilcrow}

:   

[Table 2](#tab-error-types){.xref} summarizes the different error
codes.[¶](#section-6.2.8-8){.pilcrow}

[]{#name-convert-error-values}

::: {#tab-error-types}
  Error   Hex    Description
  ------- ------ -------------------------
  0       0x00   Unsupported Version
  1       0x01   Malformed Message
  2       0x02   Unsupported Message
  3       0x03   Missing Cookie
  32      0x20   Not Authorized
  33      0x21   Unsupported TCP Option
  64      0x40   Resource Exceeded
  65      0x41   Network Failure
  96      0x60   Connection Reset
  97      0x61   Destination Unreachable

  : [Table 2](#table-2){.selfRef}: [Convert Error
  Values](#name-convert-error-values){.selfRef}
:::
:::
:::
:::
:::
:::
:::

::: {#sec-tcpoptions}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Compatibility of Specific TCP Options with the Conversion Service](#name-compatibility-of-specific-t){.section-name .selfRef} {#name-compatibility-of-specific-t}

In this section, we discuss how several deployed Standards Track TCP
options can be supported through the Convert Protocol. The other TCP
options will be discussed in other documents.[¶](#section-7-1){.pilcrow}

::: {#base-tcp-options}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Base TCP Options](#name-base-tcp-options){.section-name .selfRef} {#name-base-tcp-options}

Three TCP options were initially defined in
\[[RFC0793](#RFC0793){.xref}\]: End-of-Option List (Kind=0),
No-Operation (Kind=1), and Maximum Segment Size (Kind=2). The first two
options are mainly used to pad the TCP header. There is no reason for a
Client to request a Transport Converter to specifically send these
options towards the final destination.[¶](#section-7.1-1){.pilcrow}

The Maximum Segment Size option (Kind=2) is used by a host to indicate
the largest segment that it can receive over each connection. This value
is a function of the stack that terminates the TCP connection. There is
no reason for a Client to request a Transport Converter to advertise a
specific Maximum Segment Size (MSS) value to a remote
Server.[¶](#section-7.1-2){.pilcrow}

A Transport Converter [MUST]{.bcp14} ignore options with Kind=0, 1, or 2
if they appear in a Connect TLV. It [MUST NOT]{.bcp14} announce them in
a Supported TCP Extensions TLV.[¶](#section-7.1-3){.pilcrow}
:::
:::

::: {#window-scale-ws}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Window Scale (WS)](#name-window-scale-ws){.section-name .selfRef} {#name-window-scale-ws}

The Window Scale (WS) option (Kind=3) is defined in
\[[RFC7323](#RFC7323){.xref}\]. As for the MSS option, the window scale
factor that is used for a connection strongly depends on the TCP stack
that handles the connection. When a Transport Converter opens a TCP
connection towards a remote Server on behalf of a Client, it
[SHOULD]{.bcp14} use a WS option with a scaling factor that corresponds
to the configuration of its stack. A local configuration [MAY]{.bcp14}
allow for a WS option in the proxied message to be a function of the
scaling factor of the incoming connection.[¶](#section-7.2-1){.pilcrow}

From a deployment viewpoint, there is no benefit in enabling a Client of
a Transport Converter to specifically request the utilization of the WS
option (Kind=3) with a specific scaling factor towards a remote Server.
For this reason, a Transport Converter [MUST]{.bcp14} ignore option
Kind=3 if it appears in a Connect TLV. The Transport Converter [MUST
NOT]{.bcp14} announce a WS option (Kind=3) in a Supported TCP Extensions
TLV.[¶](#section-7.2-2){.pilcrow}
:::
:::

::: {#selective-acknowledgments}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Selective Acknowledgments](#name-selective-acknowledgments){.section-name .selfRef} {#name-selective-acknowledgments}

Two distinct TCP options were defined to support Selective
Acknowledgment (SACK) in \[[RFC2018](#RFC2018){.xref}\]. This first one,
SACK-Permitted (Kind=4), is used to negotiate the utilization of
Selective Acknowledgments during the three-way handshake. The second
one, SACK (Kind=5), carries the Selective Acknowledgments inside regular
segments.[¶](#section-7.3-1){.pilcrow}

The SACK-Permitted option (Kind=4) [MAY]{.bcp14} be advertised by a
Transport Converter in the Supported TCP Extensions TLV. Clients
connected to this Transport Converter [MAY]{.bcp14} include the
SACK-Permitted option in the Connect TLV.[¶](#section-7.3-2){.pilcrow}

The SACK option (Kind=5) cannot be used during the three-way handshake.
For this reason, a Transport Converter [MUST]{.bcp14} ignore option
Kind=5 if it appears in a Connect TLV. It [MUST NOT]{.bcp14} announce it
in a TCP Supported Extensions TLV.[¶](#section-7.3-3){.pilcrow}
:::
:::

::: {#timestamp}
::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [Timestamp](#name-timestamp){.section-name .selfRef} {#name-timestamp}

The Timestamp option \[[RFC7323](#RFC7323){.xref}\] can be used during
the three-way handshake to negotiate the utilization of timestamps
during the TCP connection. It is notably used to improve round-trip-time
estimations and to provide Protection Against Wrapped Sequences (PAWS).
As for the WS option, the timestamps are a property of a connection and
there is limited benefit in enabling a Client to request a Transport
Converter to use the timestamp option when establishing a connection to
a remote Server. Furthermore, the timestamps that are used by TCP stacks
are specific to each stack and there is no benefit in enabling a Client
to specify the timestamp value that a Transport Converter could use to
establish a connection to a remote Server.[¶](#section-7.4-1){.pilcrow}

A Transport Converter [MAY]{.bcp14} advertise the Timestamp option
(Kind=8) in the TCP Supported Extensions TLV. The Clients connected to
this Transport Converter [MAY]{.bcp14} include the Timestamp option in
the Connect TLV but without any timestamp.[¶](#section-7.4-2){.pilcrow}
:::
:::

::: {#multipath-tcp}
::: {#section-7.5 .section}
### [7.5.](#section-7.5){.section-number .selfRef} [Multipath TCP](#name-multipath-tcp){.section-name .selfRef} {#name-multipath-tcp}

The Multipath TCP options are defined in \[[RFC8684](#RFC8684){.xref}\],
which defines one variable length TCP option (Kind=30) that includes a
sub-type field to support several Multipath TCP options. There are
several operational use cases where Clients would like to use Multipath
TCP through a Transport Converter \[[IETFJ16](#IETFJ16){.xref}\].
However, none of these use cases require the Client to specify the
content of the Multipath TCP option that the Transport Converter should
send to a remote Server.[¶](#section-7.5-1){.pilcrow}

A Transport Converter that supports Multipath TCP conversion service
[MUST]{.bcp14} advertise the Multipath TCP option (Kind=30) in the
Supported TCP Extensions TLV. Clients serviced by this Transport
Converter may include the Multipath TCP option in the Connect TLV but
without any content.[¶](#section-7.5-2){.pilcrow}
:::
:::

::: {#tcp-fast-open}
::: {#section-7.6 .section}
### [7.6.](#section-7.6){.section-number .selfRef} [TCP Fast Open](#name-tcp-fast-open){.section-name .selfRef} {#name-tcp-fast-open}

The TCP Fast Open Cookie option (Kind=34) is defined in
\[[RFC7413](#RFC7413){.xref}\]. There are two different usages of this
option that need to be supported by Transport Converters. The first
utilization of the TCP Fast Open Cookie option is to request a cookie
from the Server. In this case, the option is sent with an empty cookie
by the Client, and the Server returns the cookie. The second utilization
of the TCP Fast Open Cookie option is to send a cookie to the Server. In
this case, the option contains a cookie.[¶](#section-7.6-1){.pilcrow}

A Transport Converter [MAY]{.bcp14} advertise the TCP Fast Open Cookie
option (Kind=34) in the Supported TCP Extensions TLV. If a Transport
Converter has advertised the support for TCP Fast Open in its Supported
TCP Extensions TLV, it needs to be able to process two types of Connect
TLV.[¶](#section-7.6-2){.pilcrow}

If such a Transport Converter receives a Connect TLV with the TCP Fast
Open Cookie option that does not contain a cookie, it [MUST]{.bcp14} add
an empty TCP Fast Open Cookie option in the SYN sent to the remote
Server. If the remote Server supports TFO, it responds with a SYN-ACK
according to the procedure in [Section
4.1.2](https://www.rfc-editor.org/rfc/rfc7413#section-4.1.2){.relref} of
\[[RFC7413](#RFC7413){.xref}\]. This SYN-ACK may contain a Fast Open
option with a cookie. Upon receipt of the SYN-ACK by the Converter, it
relays the Fast Open option with the cookie to the
Client.[¶](#section-7.6-3){.pilcrow}

If such a Transport Converter receives a Connect TLV with the TCP Fast
Open Cookie option that contains a cookie, it [MUST]{.bcp14} copy the
TCP Fast Open Cookie option in the SYN sent to the remote
Server.[¶](#section-7.6-4){.pilcrow}
:::
:::

::: {#tcp-ao}
::: {#section-7.7 .section}
### [7.7.](#section-7.7){.section-number .selfRef} [TCP-AO](#name-tcp-ao){.section-name .selfRef} {#name-tcp-ao}

The TCP Authentication Option (TCP-AO) \[[RFC5925](#RFC5925){.xref}\]
provides a technique to authenticate all the packets exchanged over a
TCP connection. Given the nature of this extension, it is unlikely that
the applications that require their packets to be authenticated end to
end would want their connections to pass through a converter. For this
reason, we do not recommend the support of the TCP-AO by Transport
Converters. The only use cases where it could make sense to combine
TCP-AO and the solution in this document are those where the TCP-AO-NAT
extension \[[RFC6978](#RFC6978){.xref}\] is in
use.[¶](#section-7.7-1){.pilcrow}

A Transport Converter [MUST NOT]{.bcp14} advertise the TCP-AO (Kind=29)
in the Supported TCP Extensions TLV. If a Transport Converter receives a
Connect TLV that contains the TCP-AO, it [MUST]{.bcp14} reject the
establishment of the connection with error code set to \"Unsupported TCP
Option\", except if the TCP-AO-NAT option is used. Nevertheless, given
that TCP-AO-NAT is Experimental, its usage is not currently defined and
must be specified by some other document before it can be
used.[¶](#section-7.7-2){.pilcrow}
:::
:::
:::
:::

::: {#sec-middleboxes}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Interactions with Middleboxes](#name-interactions-with-middlebox){.section-name .selfRef} {#name-interactions-with-middlebox}

The Convert Protocol is designed to be used in networks that do not
contain middleboxes that interfere with TCP. Under such conditions, it
is assumed that the network provider ensures that all involved on-path
nodes are not breaking TCP signals (e.g., strip TCP options, discard
some SYNs, etc.).[¶](#section-8-1){.pilcrow}

Nevertheless, and in order to allow for a robust service, this section
describes how a Client can detect middlebox interference and stop using
the Transport Converter affected by this
interference.[¶](#section-8-2){.pilcrow}

Internet measurements \[[IMC11](#IMC11){.xref}\] have shown that
middleboxes can affect the deployment of TCP extensions. In this
section, we focus the middleboxes that modify the payload since the
Convert Protocol places its messages at the beginning of the
bytestream.[¶](#section-8-3){.pilcrow}

Consider a middlebox that removes the SYN payload. The Client can detect
this problem by looking at the acknowledgment number field of the
SYN+ACK if returned by the Transport Converter. The Client
[MUST]{.bcp14} stop to use this Transport Converter given the middlebox
interference.[¶](#section-8-4){.pilcrow}

Consider now a middlebox that drops SYN/ACKs with a payload. The Client
won\'t be able to establish a connection via the Transport Converter.
The case of a middlebox that removes the payload of SYN+ACKs or from the
packet that follows the SYN+ACK (but not the payload of SYN) can be
detected by a Client. This is hinted by the absence of a valid Convert
message in the response.[¶](#section-8-5){.pilcrow}

As explained in \[[RFC7413](#RFC7413){.xref}\], some Carrier Grade NATs
(CGNs) can affect the operation of TFO if they assign different IP
addresses to the same end host. Such CGNs could affect the operation of
the cookie validation used by the Convert Protocol. As a reminder, CGNs
that are enabled on the path between a Client and a Transport Converter
must adhere to the address preservation defined in
\[[RFC6888](#RFC6888){.xref}\]. See also the discussion in [Section
7.1](https://www.rfc-editor.org/rfc/rfc7413#section-7.1){.relref} of
\[[RFC7413](#RFC7413){.xref}\].[¶](#section-8-6){.pilcrow}
:::
:::

::: {#sec-security}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

An implementation [MUST]{.bcp14} check that the Convert TLVs are
properly framed within the boundary indicated by the Total Length in the
fixed header ([Section
6.1](#sec-header){.xref}).[¶](#section-9-1){.pilcrow}

Additional security considerations are discussed in the following
subsections.[¶](#section-9-2){.pilcrow}

::: {#privacy-ingress-filtering}
::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Privacy & Ingress Filtering](#name-privacy-ingress-filtering){.section-name .selfRef} {#name-privacy-ingress-filtering}

The Transport Converter may have access to privacy-related information
(e.g., subscriber credentials). The Transport Converter is designed to
not leak such sensitive information outside a local
domain.[¶](#section-9.1-1){.pilcrow}

Given its function and location in the network, a Transport Converter is
in a position to observe all packets that it processes, to include
payloads and metadata, and has the ability to profile and conduct some
traffic analysis of user behavior. The Transport Converter
[MUST]{.bcp14} be as protected as a core IP router (e.g., [Section
10](https://www.rfc-editor.org/rfc/rfc1812#section-10){.relref} of
\[[RFC1812](#RFC1812){.xref}\]).[¶](#section-9.1-2){.pilcrow}

Furthermore, ingress filtering policies [MUST]{.bcp14} be enforced at
the network boundaries
\[[RFC2827](#RFC2827){.xref}\].[¶](#section-9.1-3){.pilcrow}

This document assumes that all network attachments are managed by the
same administrative entity. Therefore, enforcing anti-spoofing filters
at these networks is a guard that hosts are not sending traffic with
spoofed source IP addresses.[¶](#section-9.1-4){.pilcrow}
:::
:::

::: {#authorization}
::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Authentication and Authorization Considerations](#name-authentication-and-authoriz){.section-name .selfRef} {#name-authentication-and-authoriz}

The Convert Protocol is [RECOMMENDED]{.bcp14} for use in a managed
network where end hosts can be securely identified by their IP address.
If such control is not exerted and there is a more open network
environment, a strong mutual authentication scheme [MUST]{.bcp14} be
defined to use the Convert Protocol.[¶](#section-9.2-1){.pilcrow}

One possibility for mutual authentication is to use TLS to perform
mutual authentication between the Client and the Converter. That is, use
TLS when a Client retrieves a Cookie from the Converter and rely on
certificate-based, pre-shared key-based \[[RFC4279](#RFC4279){.xref}\],
or raw public key-based Client authentication
\[[RFC7250](#RFC7250){.xref}\] to secure this connection. If the
authentication succeeds, the Converter returns a cookie to the Client.
Subsequent Connect messages will be authorized as a function of the
content of the Cookie TLV. An attacker from within the network between a
Client and a Transport Converter may intercept the Cookie and use it to
be granted access to the conversion service. Such an attack is only
possible if the attacker spoofs the IP address of the Client and the
network does not filter packets with source-spoofed IP
addresses.[¶](#section-9.2-2){.pilcrow}

The operator that manages the various network attachments (including the
Transport Converters) has various options for enforcing authentication
and authorization policies. For example, a non-exhaustive list of
methods to achieve authorization is provided
hereafter:[¶](#section-9.2-3){.pilcrow}

-   [The network provider may enforce a policy based on the
    International Mobile Subscriber Identity (IMSI) to verify that a
    user is allowed to benefit from the TCP converter service. If that
    authorization fails, the Packet Data Protocol (PDP) context/bearer
    will not be mounted. This method does not require any interaction
    with the Transport Converter for authorization
    matters.[¶](#section-9.2-4.1){.pilcrow}]{#section-9.2-4.1}
-   [The network provider may enforce a policy based upon Access Control
    Lists (ACLs), e.g., at a Broadband Network Gateway (BNG) to control
    the hosts that are authorized to communicate with a Transport
    Converter. These ACLs may be installed as a result of RADIUS
    exchanges, e.g.,
    \[[TCPM-CONVERTER](#I-D.boucadair-opsawg-tcpm-converter){.xref}\].
    This method does not require any interaction with the Transport
    Converter for authorization
    matters.[¶](#section-9.2-4.2){.pilcrow}]{#section-9.2-4.2}
-   [A device that embeds a Transport Converter may also host a RADIUS
    Client that will solicit a AAA Server to check whether or not
    connections received from a given source IP address are authorized
    \[[TCPM-CONVERTER](#I-D.boucadair-opsawg-tcpm-converter){.xref}\].[¶](#section-9.2-4.3){.pilcrow}]{#section-9.2-4.3}

A first safeguard against the misuse of Transport Converter resources by
illegitimate users (e.g., users with access networks that are not
managed by the same provider that operates the Transport Converter) is
the Transport Converter to reject Convert connections received in the
external realm. Only Convert connections received in the internal realm
of a Transport Converter will be accepted.[¶](#section-9.2-5){.pilcrow}

In deployments where network-assisted connections are not allowed
between hosts of a domain (i.e., hairpinning), the Converter may be
instructed to discard such connections. Hairpinned connections are thus
rejected by the Transport Converter by returning an Error TLV set to
\"Not Authorized\". Otherwise, absent explicit configuration,
hairpinning is enabled by the Converter (see [Figure
24](#fig-hairp){.xref}).[¶](#section-9.2-6){.pilcrow}

[]{#name-hairpinning-example}

::: {#fig-hairp}
::: {#section-9.2-7.1 .artwork .art-text .alignLeft}
              <===Network Provider===>

       +----+ from X1:x1 to X2':x2'   +-----+ X1':x1'
       | C1 |>>>>>>>>>>>>>>>>>>>>>>>>>>>>>--+---
       +----+                         |  v  |
                                      |  v  |
                                      |  v  |
                                      |  v  |
       +----+ from X1':x1' to X2:x2   |  v  | X2':x2'
       | C2 |<<<<<<<<<<<<<<<<<<<<<<<<<<<<<--+---
       +----+                         +-----+
                                     Converter

       Note: X2':x2' may be equal to
             X2:x2
:::

[Figure 24](#figure-24){.selfRef}: [Hairpinning
Example](#name-hairpinning-example){.selfRef}
:::
:::
:::

::: {#denial-of-service}
::: {#section-9.3 .section}
### [9.3.](#section-9.3){.section-number .selfRef} [Denial of Service](#name-denial-of-service){.section-name .selfRef} {#name-denial-of-service}

Another possible risk is amplification attacks, since a Transport
Converter sends a SYN towards a remote Server upon reception of a SYN
from a Client. This could lead to amplification attacks if the SYN sent
by the Transport Converter were larger than the SYN received from the
Client, or if the Transport Converter retransmits the SYN. To mitigate
such attacks, the Transport Converter [SHOULD]{.bcp14} rate-limit the
number of pending requests for a given Client. It [SHOULD]{.bcp14} also
avoid sending SYNs that are significantly longer than the SYN received
from the Client, to remote Servers. Finally, the Transport Converter
[SHOULD]{.bcp14} only retransmit a SYN to a Server after having received
a retransmitted SYN from the corresponding Client. Means to protect
against SYN flooding attacks should also be enabled (e.g., [Section
3](https://www.rfc-editor.org/rfc/rfc4987#section-3){.relref} of
\[[RFC4987](#RFC4987){.xref}\]).[¶](#section-9.3-1){.pilcrow}

Attacks from within the network between a Client and a Transport
Converter (including attacks that change the protocol version) are yet
another threat. Means to ensure that illegitimate nodes cannot connect
to a network should be implemented.[¶](#section-9.3-2){.pilcrow}
:::
:::

::: {#traffic-theft}
::: {#section-9.4 .section}
### [9.4.](#section-9.4){.section-number .selfRef} [Traffic Theft](#name-traffic-theft){.section-name .selfRef} {#name-traffic-theft}

Traffic theft is a risk if an illegitimate Converter is inserted in the
path. Indeed, inserting an illegitimate Converter in the forwarding path
allows traffic interception and can therefore provide access to
sensitive data issued by or destined to a host. Converter discovery and
configuration are out of scope of this
document.[¶](#section-9.4-1){.pilcrow}
:::
:::

::: {#section-9.5 .section}
### [9.5.](#section-9.5){.section-number .selfRef} [Logging](#name-logging){.section-name .selfRef} {#name-logging}

If the Converter is configured to behave in the address-sharing mode
([Section 4.4.2](#sec-adds){.xref}), the logging recommendations
discussed in [Section
4](https://www.rfc-editor.org/rfc/rfc6888#section-4){.relref} of
\[[RFC6888](#RFC6888){.xref}\] need to be considered. Security-related
issues encountered in address-sharing environments are documented in
[Section 13](https://www.rfc-editor.org/rfc/rfc6269#section-13){.relref}
of \[[RFC6269](#RFC6269){.xref}\].[¶](#section-9.5-1){.pilcrow}
:::
:::
:::

::: {#sec-iana}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#sec-service}
::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Convert Service Name](#name-convert-service-name){.section-name .selfRef} {#name-convert-service-name}

IANA has assigned a service name for the Convert Protocol from the
\"Service Name and Transport Protocol Port Number Registry\" available
at
\<<https://www.iana.org/assignments/service-names-port-numbers>\>.[¶](#section-10.1-1){.pilcrow}

[]{.break}

Service Name:
:   convert[¶](#section-10.1-2.2){.pilcrow}
:   

Port Number:
:   N/A[¶](#section-10.1-2.4){.pilcrow}
:   

Transport Protocol(s):
:   TCP[¶](#section-10.1-2.6){.pilcrow}
:   

Description:
:   0-RTT TCP Convert Protocol[¶](#section-10.1-2.8){.pilcrow}
:   

Assignee:
:   IESG \<iesg\@ietf.org>[¶](#section-10.1-2.10){.pilcrow}
:   

Contact:
:   IETF Chair \<chair\@ietf.org>[¶](#section-10.1-2.12){.pilcrow}
:   

Reference:
:   RFC 8803[¶](#section-10.1-2.14){.pilcrow}
:   

Clients may use this service name to feed the procedure defined in
\[[RFC2782](#RFC2782){.xref}\] to discover the IP address(es) and the
port number used by the Transport Converters of a
domain.[¶](#section-10.1-3){.pilcrow}
:::
:::

::: {#the-convert-protocol-convert-parameters}
::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [The Convert Protocol (Convert) Parameters](#name-the-convert-protocol-convert){.section-name .selfRef} {#name-the-convert-protocol-convert}

IANA has created a new \"TCP Convert Protocol (Convert) Parameters\"
registry.[¶](#section-10.2-1){.pilcrow}

The following subsections detail new registries within the \"Convert
Protocol (Convert) Parameters\" registry.[¶](#section-10.2-2){.pilcrow}

The designated expert is expected to ascertain the existence of suitable
documentation as described in [Section
4.6](https://www.rfc-editor.org/rfc/rfc8126#section-4.6){.relref} of
\[[RFC8126](#RFC8126){.xref}\] and to verify that the document is
permanently and publicly available. The designated expert is also
expected to check the clarity of purpose and use of the requested code
points.[¶](#section-10.2-3){.pilcrow}

Also, criteria that should be applied by the designated experts includes
determining whether the proposed registration duplicates existing
functionality, whether it is likely to be of general applicability or
useful only for private use, and whether the registration description is
clear. All requests should be directed to the review mailing list. For
both the \"Convert TLVs\" and \"Convert Errors\" subregistries, IANA
must only accept registry updates in the 128-191 range from the
designated experts. It is suggested that multiple designated experts be
appointed. In cases where a registration decision could be perceived as
creating a conflict of interest for a particular expert, that expert
should defer to the judgment of the other
experts.[¶](#section-10.2-4){.pilcrow}

::: {#convert-versions}
::: {#section-10.2.1 .section}
#### [10.2.1.](#section-10.2.1){.section-number .selfRef} [Convert Versions](#name-convert-versions){.section-name .selfRef} {#name-convert-versions}

IANA has created the \"Convert Versions\" subregistry. New values are
assigned via IETF Review ([Section
4.8](https://www.rfc-editor.org/rfc/rfc8126#section-4.8){.relref} of
\[[RFC8126](#RFC8126){.xref}\]).[¶](#section-10.2.1-1){.pilcrow}

The initial values of the registry are as
follows:[¶](#section-10.2.1-2){.pilcrow}

[]{#name-current-convert-versions}

::: {#ver}
  Version   Description   Reference
  --------- ------------- -----------
  0         Reserved      RFC 8803
  1         Assigned      RFC 8803

  : [Table 3](#table-3){.selfRef}: [Current Convert
  Versions](#name-current-convert-versions){.selfRef}
:::
:::
:::

::: {#convert-tlvs}
::: {#section-10.2.2 .section}
#### [10.2.2.](#section-10.2.2){.section-number .selfRef} [Convert TLVs](#name-convert-tlvs-2){.section-name .selfRef} {#name-convert-tlvs-2}

IANA has created the \"Convert TLVs\" subregistry. The procedures for
assigning values from this registry are as
follows:[¶](#section-10.2.2-1){.pilcrow}

[]{.break}

1-127:
:   IETF Review[¶](#section-10.2.2-2.2){.pilcrow}
:   

128-191:
:   Specification Required[¶](#section-10.2.2-2.4){.pilcrow}
:   

192-255:
:   Private Use[¶](#section-10.2.2-2.6){.pilcrow}
:   

The initial values of the registry are as
follows:[¶](#section-10.2.2-3){.pilcrow}

[]{#name-initial-convert-tlvs}

::: {#tlvs}
  Code   Name                          Reference
  ------ ----------------------------- -----------
  0      Reserved                      RFC 8803
  1      Info TLV                      RFC 8803
  10     Connect TLV                   RFC 8803
  20     Extended TCP Header TLV       RFC 8803
  21     Supported TCP Extension TLV   RFC 8803
  22     Cookie TLV                    RFC 8803
  30     Error TLV                     RFC 8803

  : [Table 4](#table-4){.selfRef}: [Initial Convert
  TLVs](#name-initial-convert-tlvs){.selfRef}
:::
:::
:::

::: {#convert-error-messages}
::: {#section-10.2.3 .section}
#### [10.2.3.](#section-10.2.3){.section-number .selfRef} [Convert Error Messages](#name-convert-error-messages){.section-name .selfRef} {#name-convert-error-messages}

IANA has created the \"Convert Errors\" subregistry. Codes in this
registry are assigned as a function of the error type. Four types are
defined; the following ranges are reserved for each of these
types:[¶](#section-10.2.3-1){.pilcrow}

[]{.break}

0-31:
:   Message validation and processing
    errors[¶](#section-10.2.3-2.2){.pilcrow}
:   

32-63:
:   Client-side errors[¶](#section-10.2.3-2.4){.pilcrow}
:   

64-95:
:   Transport Converter-side errors[¶](#section-10.2.3-2.6){.pilcrow}
:   

96-127:
:   Errors caused by destination
    Server[¶](#section-10.2.3-2.8){.pilcrow}
:   

The procedures for assigning values from this subregistry are as
follows:[¶](#section-10.2.3-3){.pilcrow}

[]{.break}

0-127:
:   IETF Review[¶](#section-10.2.3-4.2){.pilcrow}
:   

128-191:
:   Specification Required[¶](#section-10.2.3-4.4){.pilcrow}
:   

192-255:
:   Private Use[¶](#section-10.2.3-4.6){.pilcrow}
:   

The initial values of the registry are as
follows:[¶](#section-10.2.3-5){.pilcrow}

[]{#name-initial-convert-error-codes}

::: {#tab-error-summary}
  Error   Description               Reference
  ------- ------------------------- -----------
  0       Unsupported Version       RFC 8803
  1       Malformed Message         RFC 8803
  2       Unsupported Message       RFC 8803
  3       Missing Cookie            RFC 8803
  32      Not Authorized            RFC 8803
  33      Unsupported TCP Option    RFC 8803
  64      Resource Exceeded         RFC 8803
  65      Network Failure           RFC 8803
  96      Connection Reset          RFC 8803
  97      Destination Unreachable   RFC 8803

  : [Table 5](#table-5){.selfRef}: [Initial Convert Error
  Codes](#name-initial-convert-error-codes){.selfRef}
:::
:::
:::
:::
:::
:::
:::

::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0793\]
:   [Postel, J.]{.refAuthor}, [\"Transmission Control
    Protocol\"]{.refTitle}, [STD 7]{.seriesInfo}, [RFC
    793]{.seriesInfo}, [DOI 10.17487/RFC0793]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc793>\>.
:   

\[RFC2018\]
:   [Mathis, M.]{.refAuthor}[, Mahdavi, J.]{.refAuthor}[,
    Floyd, S.]{.refAuthor}[, and A. Romanow]{.refAuthor}, [\"TCP
    Selective Acknowledgment Options\"]{.refTitle}, [RFC
    2018]{.seriesInfo}, [DOI 10.17487/RFC2018]{.seriesInfo}, October
    1996, \<<https://www.rfc-editor.org/info/rfc2018>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2827\]
:   [Ferguson, P.]{.refAuthor}[ and D. Senie]{.refAuthor}, [\"Network
    Ingress Filtering: Defeating Denial of Service Attacks which employ
    IP Source Address Spoofing\"]{.refTitle}, [BCP 38]{.seriesInfo},
    [RFC 2827]{.seriesInfo}, [DOI 10.17487/RFC2827]{.seriesInfo}, May
    2000, \<<https://www.rfc-editor.org/info/rfc2827>\>.
:   

\[RFC4291\]
:   [Hinden, R.]{.refAuthor}[ and S. Deering]{.refAuthor}, [\"IP Version
    6 Addressing Architecture\"]{.refTitle}, [RFC 4291]{.seriesInfo},
    [DOI 10.17487/RFC4291]{.seriesInfo}, February 2006,
    \<<https://www.rfc-editor.org/info/rfc4291>\>.
:   

\[RFC4787\]
:   [Audet, F., Ed.]{.refAuthor}[ and C. Jennings]{.refAuthor},
    [\"Network Address Translation (NAT) Behavioral Requirements for
    Unicast UDP\"]{.refTitle}, [BCP 127]{.seriesInfo}, [RFC
    4787]{.seriesInfo}, [DOI 10.17487/RFC4787]{.seriesInfo}, January
    2007, \<<https://www.rfc-editor.org/info/rfc4787>\>.
:   

\[RFC4987\]
:   [Eddy, W.]{.refAuthor}, [\"TCP SYN Flooding Attacks and Common
    Mitigations\"]{.refTitle}, [RFC 4987]{.seriesInfo}, [DOI
    10.17487/RFC4987]{.seriesInfo}, August 2007,
    \<<https://www.rfc-editor.org/info/rfc4987>\>.
:   

\[RFC5925\]
:   [Touch, J.]{.refAuthor}[, Mankin, A.]{.refAuthor}[, and R.
    Bonica]{.refAuthor}, [\"The TCP Authentication Option\"]{.refTitle},
    [RFC 5925]{.seriesInfo}, [DOI 10.17487/RFC5925]{.seriesInfo}, June
    2010, \<<https://www.rfc-editor.org/info/rfc5925>\>.
:   

\[RFC6888\]
:   [Perreault, S., Ed.]{.refAuthor}[, Yamagata, I.]{.refAuthor}[,
    Miyakawa, S.]{.refAuthor}[, Nakagawa, A.]{.refAuthor}[, and H.
    Ashida]{.refAuthor}, [\"Common Requirements for Carrier-Grade NATs
    (CGNs)\"]{.refTitle}, [BCP 127]{.seriesInfo}, [RFC
    6888]{.seriesInfo}, [DOI 10.17487/RFC6888]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6888>\>.
:   

\[RFC6890\]
:   [Cotton, M.]{.refAuthor}[, Vegoda, L.]{.refAuthor}[, Bonica, R.,
    Ed.]{.refAuthor}[, and B. Haberman]{.refAuthor}, [\"Special-Purpose
    IP Address Registries\"]{.refTitle}, [BCP 153]{.seriesInfo}, [RFC
    6890]{.seriesInfo}, [DOI 10.17487/RFC6890]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6890>\>.
:   

\[RFC7323\]
:   [Borman, D.]{.refAuthor}[, Braden, B.]{.refAuthor}[,
    Jacobson, V.]{.refAuthor}[, and R. Scheffenegger, Ed.]{.refAuthor},
    [\"TCP Extensions for High Performance\"]{.refTitle}, [RFC
    7323]{.seriesInfo}, [DOI 10.17487/RFC7323]{.seriesInfo}, September
    2014, \<<https://www.rfc-editor.org/info/rfc7323>\>.
:   

\[RFC7413\]
:   [Cheng, Y.]{.refAuthor}[, Chu, J.]{.refAuthor}[,
    Radhakrishnan, S.]{.refAuthor}[, and A. Jain]{.refAuthor}, [\"TCP
    Fast Open\"]{.refTitle}, [RFC 7413]{.seriesInfo}, [DOI
    10.17487/RFC7413]{.seriesInfo}, December 2014,
    \<<https://www.rfc-editor.org/info/rfc7413>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8684\]
:   [Ford, A.]{.refAuthor}[, Raiciu, C.]{.refAuthor}[,
    Handley, M.]{.refAuthor}[, Bonaventure, O.]{.refAuthor}[, and C.
    Paasch]{.refAuthor}, [\"TCP Extensions for Multipath Operation with
    Multiple Addresses\"]{.refTitle}, [RFC 8684]{.seriesInfo}, [DOI
    10.17487/RFC8684]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8684>\>.
:   
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ANRW17\]
:   [Trammell, B.]{.refAuthor}[, Kuehlewind, M.]{.refAuthor}[, De
    Vaere, P.]{.refAuthor}[, Learmonth, I.]{.refAuthor}[, and G.
    Fairhurst]{.refAuthor}, [\"Tracking transport-layer evolution with
    PATHspider\"]{.refTitle}, [Applied Networking Research Workshop 2017
    (ANRW17)]{.refContent}, July 2017.
:   

\[DHC-CONVERTER\]
:   [Boucadair, M.]{.refAuthor}[, Jacquenet, C.]{.refAuthor}[, and T.
    Reddy.K]{.refAuthor}, [\"DHCP Options for 0-RTT TCP
    Converters\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-boucadair-tcpm-dhc-converter-03]{.seriesInfo}, 7 October 2019,
    \<<https://tools.ietf.org/html/draft-boucadair-tcpm-dhc-converter-03>\>.
:   

\[Fukuda2011\]
:   [Fukuda, K.]{.refAuthor}, [\"An Analysis of Longitudinal TCP Passive
    Measurements (Short Paper)\"]{.refTitle}, [Traffic Monitoring and
    Analysis]{.refContent}, [TMA 2011]{.refContent}, [Lecture Notes in
    Computer Science, vol. 6613]{.refContent}, 2011.
:   

\[HOT-MIDDLEBOX13\]
:   [Detal, G.]{.refAuthor}[, Paasch, C.]{.refAuthor}[, and O.
    Bonaventure]{.refAuthor}, [\"Multipath in the
    Middle(Box)\"]{.refTitle}, [HotMiddlebox\'13]{.refContent}, [DOI
    10.1145/2535828.2535829]{.seriesInfo}, December 2013,
    \<<https://inl.info.ucl.ac.be/publications/multipath-middlebox>\>.
:   

\[IANA-CONVERT\]
:   [IANA]{.refAuthor}, [\"TCP Convert Protocol (Convert)
    Parameters\"]{.refTitle},
    \<<https://www.iana.org/assignments/tcp-convert-protocol-parameters>\>.
:   

\[IETFJ16\]
:   [Bonaventure, O.]{.refAuthor}[ and S. Seo]{.refAuthor}, [\"Multipath
    TCP Deployments\"]{.refTitle}, [IETF Journal]{.refContent}, [Vol.
    12, Issue 2]{.refContent}, November 2016.
:   

\[IMC11\]
:   [Honda, K.]{.refAuthor}[, Nishida, Y.]{.refAuthor}[,
    Raiciu, C.]{.refAuthor}[, Greenhalgh, A.]{.refAuthor}[,
    Handley, M.]{.refAuthor}[, and T. Hideyuki]{.refAuthor}, [\"Is it
    still possible to extend TCP?\"]{.refTitle}, [Proceedings of the
    2011 ACM SIGCOMM conference on Internet measurement conference
    ]{.refContent}, [DOI 10.1145/2068816.2068834]{.seriesInfo}, November
    2011, \<<https://doi.org/10.1145/2068816.2068834>\>.
:   

\[INTAREA-SOCKS\]
:   [Olteanu, V.]{.refAuthor}[ and D. Niculescu]{.refAuthor}, [\"SOCKS
    Protocol Version 6\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-olteanu-intarea-socks-6-10]{.seriesInfo}, 13
    July 2020,
    \<<https://tools.ietf.org/html/draft-olteanu-intarea-socks-6-10>\>.
:   

\[LOW-LATENCY\]
:   [Arkko, J.]{.refAuthor}[ and J. Tantsura]{.refAuthor}, [\"Low
    Latency Applications and the Internet Architecture\"]{.refTitle},
    [Work in Progress]{.refContent}, [Internet-Draft,
    draft-arkko-arch-low-latency-02]{.seriesInfo}, 30 October 2017,
    \<<https://tools.ietf.org/html/draft-arkko-arch-low-latency-02>\>.
:   

\[MPTCP-PLAIN\]
:   [Boucadair, M.]{.refAuthor}[, Jacquenet, C.]{.refAuthor}[,
    Bonaventure, O.]{.refAuthor}[, Behaghel, D.]{.refAuthor}[,
    Secci, S.]{.refAuthor}[, Henderickx, W.]{.refAuthor}[,
    Skog, R.]{.refAuthor}[, Vinapamula, S.]{.refAuthor}[,
    Seo, S.]{.refAuthor}[, Cloetens, W.]{.refAuthor}[,
    Meyer, U.]{.refAuthor}[, Contreras, L.]{.refAuthor}[, and B.
    Peirens]{.refAuthor}, [\"Extensions for Network-Assisted MPTCP
    Deployment Models\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-boucadair-mptcp-plain-mode-10]{.seriesInfo},
    March 2017,
    \<<https://tools.ietf.org/html/draft-boucadair-mptcp-plain-mode-10>\>.
:   

\[MPTCP-TRANSPARENT\]
:   [Peirens, B.]{.refAuthor}[, Detal, G.]{.refAuthor}[,
    Barre, S.]{.refAuthor}[, and O. Bonaventure]{.refAuthor}, [\"Link
    bonding with transparent Multipath TCP\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-peirens-mptcp-transparent-00]{.seriesInfo}, 8 July 2016,
    \<<https://tools.ietf.org/html/draft-peirens-mptcp-transparent-00>\>.
:   

\[RFC1812\]
:   [Baker, F., Ed.]{.refAuthor}, [\"Requirements for IP Version 4
    Routers\"]{.refTitle}, [RFC 1812]{.seriesInfo}, [DOI
    10.17487/RFC1812]{.seriesInfo}, June 1995,
    \<<https://www.rfc-editor.org/info/rfc1812>\>.
:   

\[RFC1919\]
:   [Chatel, M.]{.refAuthor}, [\"Classical versus Transparent IP
    Proxies\"]{.refTitle}, [RFC 1919]{.seriesInfo}, [DOI
    10.17487/RFC1919]{.seriesInfo}, March 1996,
    \<<https://www.rfc-editor.org/info/rfc1919>\>.
:   

\[RFC1928\]
:   [Leech, M.]{.refAuthor}[, Ganis, M.]{.refAuthor}[,
    Lee, Y.]{.refAuthor}[, Kuris, R.]{.refAuthor}[,
    Koblas, D.]{.refAuthor}[, and L. Jones]{.refAuthor}, [\"SOCKS
    Protocol Version 5\"]{.refTitle}, [RFC 1928]{.seriesInfo}, [DOI
    10.17487/RFC1928]{.seriesInfo}, March 1996,
    \<<https://www.rfc-editor.org/info/rfc1928>\>.
:   

\[RFC2782\]
:   [Gulbrandsen, A.]{.refAuthor}[, Vixie, P.]{.refAuthor}[, and L.
    Esibov]{.refAuthor}, [\"A DNS RR for specifying the location of
    services (DNS SRV)\"]{.refTitle}, [RFC 2782]{.seriesInfo}, [DOI
    10.17487/RFC2782]{.seriesInfo}, February 2000,
    \<<https://www.rfc-editor.org/info/rfc2782>\>.
:   

\[RFC3135\]
:   [Border, J.]{.refAuthor}[, Kojo, M.]{.refAuthor}[,
    Griner, J.]{.refAuthor}[, Montenegro, G.]{.refAuthor}[, and Z.
    Shelby]{.refAuthor}, [\"Performance Enhancing Proxies Intended to
    Mitigate Link-Related Degradations\"]{.refTitle}, [RFC
    3135]{.seriesInfo}, [DOI 10.17487/RFC3135]{.seriesInfo}, June 2001,
    \<<https://www.rfc-editor.org/info/rfc3135>\>.
:   

\[RFC4279\]
:   [Eronen, P., Ed.]{.refAuthor}[ and H. Tschofenig, Ed.]{.refAuthor},
    [\"Pre-Shared Key Ciphersuites for Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 4279]{.seriesInfo}, [DOI
    10.17487/RFC4279]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4279>\>.
:   

\[RFC5461\]
:   [Gont, F.]{.refAuthor}, [\"TCP\'s Reaction to Soft
    Errors\"]{.refTitle}, [RFC 5461]{.seriesInfo}, [DOI
    10.17487/RFC5461]{.seriesInfo}, February 2009,
    \<<https://www.rfc-editor.org/info/rfc5461>\>.
:   

\[RFC6269\]
:   [Ford, M., Ed.]{.refAuthor}[, Boucadair, M.]{.refAuthor}[,
    Durand, A.]{.refAuthor}[, Levis, P.]{.refAuthor}[, and P.
    Roberts]{.refAuthor}, [\"Issues with IP Address
    Sharing\"]{.refTitle}, [RFC 6269]{.seriesInfo}, [DOI
    10.17487/RFC6269]{.seriesInfo}, June 2011,
    \<<https://www.rfc-editor.org/info/rfc6269>\>.
:   

\[RFC6296\]
:   [Wasserman, M.]{.refAuthor}[ and F. Baker]{.refAuthor},
    [\"IPv6-to-IPv6 Network Prefix Translation\"]{.refTitle}, [RFC
    6296]{.seriesInfo}, [DOI 10.17487/RFC6296]{.seriesInfo}, June 2011,
    \<<https://www.rfc-editor.org/info/rfc6296>\>.
:   

\[RFC6731\]
:   [Savolainen, T.]{.refAuthor}[, Kato, J.]{.refAuthor}[, and T.
    Lemon]{.refAuthor}, [\"Improved Recursive DNS Server Selection for
    Multi-Interfaced Nodes\"]{.refTitle}, [RFC 6731]{.seriesInfo}, [DOI
    10.17487/RFC6731]{.seriesInfo}, December 2012,
    \<<https://www.rfc-editor.org/info/rfc6731>\>.
:   

\[RFC6887\]
:   [Wing, D., Ed.]{.refAuthor}[, Cheshire, S.]{.refAuthor}[,
    Boucadair, M.]{.refAuthor}[, Penno, R.]{.refAuthor}[, and P.
    Selkirk]{.refAuthor}, [\"Port Control Protocol (PCP)\"]{.refTitle},
    [RFC 6887]{.seriesInfo}, [DOI 10.17487/RFC6887]{.seriesInfo}, April
    2013, \<<https://www.rfc-editor.org/info/rfc6887>\>.
:   

\[RFC6928\]
:   [Chu, J.]{.refAuthor}[, Dukkipati, N.]{.refAuthor}[,
    Cheng, Y.]{.refAuthor}[, and M. Mathis]{.refAuthor}, [\"Increasing
    TCP\'s Initial Window\"]{.refTitle}, [RFC 6928]{.seriesInfo}, [DOI
    10.17487/RFC6928]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6928>\>.
:   

\[RFC6978\]
:   [Touch, J.]{.refAuthor}, [\"A TCP Authentication Option Extension
    for NAT Traversal\"]{.refTitle}, [RFC 6978]{.seriesInfo}, [DOI
    10.17487/RFC6978]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6978>\>.
:   

\[RFC7250\]
:   [Wouters, P., Ed.]{.refAuthor}[, Tschofenig, H., Ed.]{.refAuthor}[,
    Gilmore, J.]{.refAuthor}[, Weiler, S.]{.refAuthor}[, and T.
    Kivinen]{.refAuthor}, [\"Using Raw Public Keys in Transport Layer
    Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [RFC 7250]{.seriesInfo}, [DOI
    10.17487/RFC7250]{.seriesInfo}, June 2014,
    \<<https://www.rfc-editor.org/info/rfc7250>\>.
:   

\[RFC7414\]
:   [Duke, M.]{.refAuthor}[, Braden, R.]{.refAuthor}[,
    Eddy, W.]{.refAuthor}[, Blanton, E.]{.refAuthor}[, and A.
    Zimmermann]{.refAuthor}, [\"A Roadmap for Transmission Control
    Protocol (TCP) Specification Documents\"]{.refTitle}, [RFC
    7414]{.seriesInfo}, [DOI 10.17487/RFC7414]{.seriesInfo}, February
    2015, \<<https://www.rfc-editor.org/info/rfc7414>\>.
:   

\[RFC8041\]
:   [Bonaventure, O.]{.refAuthor}[, Paasch, C.]{.refAuthor}[, and G.
    Detal]{.refAuthor}, [\"Use Cases and Operational Experience with
    Multipath TCP\"]{.refTitle}, [RFC 8041]{.seriesInfo}, [DOI
    10.17487/RFC8041]{.seriesInfo}, January 2017,
    \<<https://www.rfc-editor.org/info/rfc8041>\>.
:   

\[RFC8305\]
:   [Schinazi, D.]{.refAuthor}[ and T. Pauly]{.refAuthor}, [\"Happy
    Eyeballs Version 2: Better Connectivity Using
    Concurrency\"]{.refTitle}, [RFC 8305]{.seriesInfo}, [DOI
    10.17487/RFC8305]{.seriesInfo}, December 2017,
    \<<https://www.rfc-editor.org/info/rfc8305>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   

\[RFC8548\]
:   [Bittau, A.]{.refAuthor}[, Giffin, D.]{.refAuthor}[,
    Handley, M.]{.refAuthor}[, Mazieres, D.]{.refAuthor}[,
    Slack, Q.]{.refAuthor}[, and E. Smith]{.refAuthor}, [\"Cryptographic
    Protection of TCP Streams (tcpcrypt)\"]{.refTitle}, [RFC
    8548]{.seriesInfo}, [DOI 10.17487/RFC8548]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8548>\>.
:   

\[TCPM-CONVERTER\]
:   [Boucadair, M.]{.refAuthor}[ and C. Jacquenet]{.refAuthor},
    [\"RADIUS Extensions for 0-RTT TCP Converters\"]{.refTitle}, [Work
    in Progress]{.refContent}, [Internet-Draft,
    draft-boucadair-opsawg-tcpm-converter-01]{.seriesInfo}, 28 February
    2020,
    \<<https://tools.ietf.org/html/draft-boucadair-opsawg-tcpm-converter-01>\>.
:   

\[TS23501\]
:   [3GPP (3rd Generation Partnership Project)]{.refAuthor},
    [\"Technical Specification Group Services and System Aspects; System
    architecture for the 5G System; Stage 2 (Release 16)\"]{.refTitle},
    2019,
    \<<https://www.3gpp.org/ftp/Specs/archive/23_series/23.501/>\>.
:   
:::
:::

::: {#sec-api}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Example Socket API Changes to Support the 0-RTT TCP Convert Protocol](#name-example-socket-api-changes-){.section-name .selfRef} {#name-example-socket-api-changes-}

::: {#active-open-client-side}
::: {#section-a.1 .section}
## [A.1.](#section-a.1){.section-number .selfRef} [Active Open (Client Side)](#name-active-open-client-side){.section-name .selfRef} {#name-active-open-client-side}

On the Client side, the support of the 0-RTT Converter protocol does not
require any other changes than those identified in [Appendix
A](https://www.rfc-editor.org/rfc/rfc7413#appendix-A){.relref} of
\[[RFC7413](#RFC7413){.xref}\]. Those modifications are already
supported by multiple TCP stacks.[¶](#section-a.1-1){.pilcrow}

As an example, on Linux, a Client can send the 0-RTT Convert message
inside a SYN by using sendto with the MSG_FASTOPEN flag as shown in the
example below:[¶](#section-a.1-2){.pilcrow}

::: {#section-a.1-3 .artwork .art-text .alignLeft}
      s = socket(AF_INET, SOCK_STREAM, 0);

      sendto(s, buffer, buffer_len, MSG_FASTOPEN,
                     (struct sockaddr *) &server_addr, addr_len);

[¶](#section-a.1-3){.pilcrow}
:::

The Client side of the Linux TFO can be used in two different modes
depending on the host configuration (sysctl tcp_fastopen
variable):[¶](#section-a.1-4){.pilcrow}

[]{.break}

0x1:
:   (client) enables sending data in the opening SYN on the
    Client.[¶](#section-a.1-5.2){.pilcrow}
:   

0x4:
:   (client) enables sending data in the opening SYN regardless of
    cookie availability and without a cookie
    option.[¶](#section-a.1-5.4){.pilcrow}
:   

By setting this configuration variable to 0x5, a Linux Client using the
above code would send data inside the SYN without using a TFO
option.[¶](#section-a.1-6){.pilcrow}
:::
:::

::: {#passive-open-converter-side}
::: {#section-a.2 .section}
## [A.2.](#section-a.2){.section-number .selfRef} [Passive Open (Converter Side)](#name-passive-open-converter-side){.section-name .selfRef} {#name-passive-open-converter-side}

The Converter needs to enable the reception of data inside the SYN
independently of the utilization of the TFO option. This implies that
the Transport Converter application cannot rely on the Fast Open Cookies
to validate the reachability of the IP address that sent the SYN. It
must rely on other techniques, such as the Cookie TLV described in this
document, to verify this reachability.[¶](#section-a.2-1){.pilcrow}

\[[RFC7413](#RFC7413){.xref}\] suggested the utilization of a
TCP_FASTOPEN socket option to enable the reception of SYNs containing
data. Later, [Appendix
A](https://www.rfc-editor.org/rfc/rfc7413#appendix-A){.relref} of
\[[RFC7413](#RFC7413){.xref}\] mentioned:[¶](#section-a.2-2){.pilcrow}

> Traditionally, accept() returns only after a socket is connected. But,
> for a Fast Open connection, accept() returns upon receiving a SYN with
> a valid Fast Open cookie and data, and the data is available to be
> read through, e.g., recvmsg(), read().[¶](#section-a.2-3){.pilcrow}

To support the 0-RTT TCP Convert Protocol, this behavior should be
modified as follows:[¶](#section-a.2-4){.pilcrow}

> Traditionally, accept() returns only after a socket is connected. But,
> for a Fast Open connection, accept() returns upon receiving a SYN with
> data, and the data is available to be read through, e.g., recvmsg(),
> read(). The application that receives such SYNs with data must be able
> to validate the reachability of the source of the SYN and also deal
> with replayed SYNs.[¶](#section-a.2-5){.pilcrow}

The Linux Server side can be configured with the following
sysctls:[¶](#section-a.2-6){.pilcrow}

[]{.break}

0x2:
:   (server) enables the Server support, i.e., allowing data in a SYN
    packet to be accepted and passed to the application before a 3-way
    handshake finishes.[¶](#section-a.2-7.2){.pilcrow}
:   

0x200:
:   (server) accepts data-in-SYN w/o any cookie option
    present.[¶](#section-a.2-7.4){.pilcrow}
:   

However, this configuration is system wide. This is convenient for
typical Transport Converter deployments where no other applications
relying on TFO are collocated on the same
device.[¶](#section-a.2-8){.pilcrow}

Recently, the TCP_FASTOPEN_NO_COOKIE socket option has been added to
provide the same behavior on a per-socket basis. This enables a single
host to support both Servers that require the Fast Open Cookie and
Servers that do not use it.[¶](#section-a.2-9){.pilcrow}
:::
:::
:::
:::

::: {#acknowledgments}
::: {#section-appendix.b .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

Although they could disagree with the contents of the document, we would
like to thank [Joe Touch]{.contact-name} and [Juliusz
Chroboczek]{.contact-name}, whose comments on the MPTCP mailing list
have forced us to reconsider the design of the solution several
times.[¶](#section-appendix.b-1){.pilcrow}

We would like to thank [Raphael Bauduin]{.contact-name}, [Stefano
Secci]{.contact-name}, [Anandatirtha Nandugudi]{.contact-name}, and
[Gregory Vander Schueren]{.contact-name} for their help in preparing
this document. [Nandini Ganesh]{.contact-name} provided valuable
feedback about the handling of TFO and the error codes. [Yuchung
Cheng]{.contact-name} and [Praveen Balasubramanian]{.contact-name}
helped to clarify the discussion on supplying data in SYNs. [Phil
Eardley]{.contact-name} and [Michael Scharf]{.contact-name} helped to
clarify different parts of the text. Thanks to [Éric
Vyncke]{.contact-name}, [Roman Danyliw]{.contact-name}, [Benjamin
Kaduk]{.contact-name}, and [Alexey Melnikov]{.contact-name} for the IESG
review, and [Christian Huitema]{.contact-name} for the Security
Directorate review.[¶](#section-appendix.b-2){.pilcrow}

Many thanks to [Mirja Kühlewind]{.contact-name} for the detailed AD
review.[¶](#section-appendix.b-3){.pilcrow}

This document builds upon earlier documents that proposed various forms
of Multipath TCP proxies:
\[[MPTCP-PLAIN](#I-D.boucadair-mptcp-plain-mode){.xref}\],
\[[MPTCP-TRANSPARENT](#I-D.peirens-mptcp-transparent){.xref}\], and
\[[HOT-MIDDLEBOX13](#HOT-MIDDLEBOX13){.xref}\].[¶](#section-appendix.b-4){.pilcrow}

From
\[[MPTCP-PLAIN](#I-D.boucadair-mptcp-plain-mode){.xref}\]:[¶](#section-appendix.b-5){.pilcrow}

Many thanks to [Chi Dung Phung]{.contact-name}, [Mingui
Zhang]{.contact-name}, [Rao Shoaib]{.contact-name}, [Yoshifumi
Nishida]{.contact-name}, and [Christoph Paasch]{.contact-name} for their
valuable comments.[¶](#section-appendix.b-6){.pilcrow}

Thanks to [Ian Farrer]{.contact-name}, [Mikael
Abrahamsson]{.contact-name}, [Alan Ford]{.contact-name}, [Dan
Wing]{.contact-name}, and [Sri Gundavelli]{.contact-name} for the
fruitful discussions at IETF 95 (Buenos
Aires).[¶](#section-appendix.b-7){.pilcrow}

Special thanks to [Pierrick Seite]{.contact-name}, [Yannick Le
Goff]{.contact-name}, [Fred Klamm]{.contact-name}, and [Xavier
Grall]{.contact-name} for their
input.[¶](#section-appendix.b-8){.pilcrow}

Thanks also to [Olaf Schleusing]{.contact-name}, [Martin
Gysi]{.contact-name}, [Thomas Zasowski]{.contact-name}, [Andreas
Burkhard]{.contact-name}, [Silka Simmen]{.contact-name}, [Sandro
Berger]{.contact-name}, [Michael Melloul]{.contact-name}, [Jean-Yves
Flahaut]{.contact-name}, [Adrien Desportes]{.contact-name}, [Gregory
Detal]{.contact-name}, [Benjamin David]{.contact-name}, [Arun
Srinivasan]{.contact-name}, and [Raghavendra Mallya]{.contact-name} for
their input.[¶](#section-appendix.b-9){.pilcrow}
:::
:::

::: {#contributors}
::: {#section-appendix.c .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

[Bart Peirens]{.contact-name} contributed to an early draft version of
this document.[¶](#section-appendix.c-1){.pilcrow}

As noted above, this document builds on two previous
documents.[¶](#section-appendix.c-2){.pilcrow}

The authors of \[[MPTCP-PLAIN](#I-D.boucadair-mptcp-plain-mode){.xref}\]
were:[¶](#section-appendix.c-3){.pilcrow}

-   ::: {#section-appendix.c-4.1}
    [Mohamed
    Boucadair]{.contact-name}[¶](#section-appendix.c-4.1.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.2}
    [Christian
    Jacquenet]{.contact-name}[¶](#section-appendix.c-4.2.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.3}
    [Olivier
    Bonaventure]{.contact-name}[¶](#section-appendix.c-4.3.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.4}
    [Denis
    Behaghel]{.contact-name}[¶](#section-appendix.c-4.4.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.5}
    [Stefano
    Secci]{.contact-name}[¶](#section-appendix.c-4.5.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.6}
    [Wim
    Henderickx]{.contact-name}[¶](#section-appendix.c-4.6.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.7}
    [Robert Skog]{.contact-name}[¶](#section-appendix.c-4.7.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.8}
    [Suresh
    Vinapamula]{.contact-name}[¶](#section-appendix.c-4.8.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.9}
    [SungHoon
    Seo]{.contact-name}[¶](#section-appendix.c-4.9.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.10}
    [Wouter
    Cloetens]{.contact-name}[¶](#section-appendix.c-4.10.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.11}
    [Ullrich
    Meyer]{.contact-name}[¶](#section-appendix.c-4.11.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.12}
    [Luis M.
    Contreras]{.contact-name}[¶](#section-appendix.c-4.12.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-4.13}
    [Bart
    Peirens]{.contact-name}[¶](#section-appendix.c-4.13.1){.pilcrow}
    :::

The authors of
\[[MPTCP-TRANSPARENT](#I-D.peirens-mptcp-transparent){.xref}\]
were:[¶](#section-appendix.c-5){.pilcrow}

-   ::: {#section-appendix.c-6.1}
    [Bart
    Peirens]{.contact-name}[¶](#section-appendix.c-6.1.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-6.2}
    [Gregory
    Detal]{.contact-name}[¶](#section-appendix.c-6.2.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-6.3}
    [Sebastien
    Barre]{.contact-name}[¶](#section-appendix.c-6.3.1){.pilcrow}
    :::

-   ::: {#section-appendix.c-6.4}
    [Olivier
    Bonaventure]{.contact-name}[¶](#section-appendix.c-6.4.1){.pilcrow}
    :::
:::
:::

::: {#authors-addresses}
::: {#section-appendix.d .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Olivier Bonaventure ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Tessares]{.org}
:::

::: {.left dir="auto"}
[Avenue Jean Monnet 1]{.street-address}
:::

::: {.left dir="auto"}
[B-1348 Louvain-la-Neuve]{.locality}
:::

::: {.left dir="auto"}
[Belgium]{.country-name}
:::

::: email
Email: <Olivier.Bonaventure@tessares.net>
:::

::: {.left dir="auto"}
[Mohamed Boucadair ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Orange]{.org}
:::

::: {.left dir="auto"}
[Clos Courtel]{.street-address}
:::

::: {.left dir="auto"}
[35000]{.postal-code} [Rennes]{.locality}
:::

::: {.left dir="auto"}
[France]{.country-name}
:::

::: email
Email: <mohamed.boucadair@orange.com>
:::

::: {.left dir="auto"}
[Sri Gundavelli]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco]{.org}
:::

::: {.left dir="auto"}
[170 West Tasman Drive]{.street-address}
:::

::: {.left dir="auto"}
[San Jose]{.locality}, [CA]{.region} [95134]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <sgundave@cisco.com>
:::

::: {.left dir="auto"}
[SungHoon Seo]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Korea Telecom]{.org}
:::

::: {.left dir="auto"}
[151 Taebong-ro]{.street-address}
:::

::: {.left dir="auto"}
[Seocho-gu, Seoul, 06763]{.locality}
:::

::: {.left dir="auto"}
[Republic of Korea]{.country-name}
:::

::: email
Email: <sh.seo@kt.com>
:::

::: {.left dir="auto"}
[Benjamin Hesmans]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Tessares]{.org}
:::

::: {.left dir="auto"}
[Avenue Jean Monnet 1]{.street-address}
:::

::: {.left dir="auto"}
[B-1348 Louvain-la-Neuve]{.locality}
:::

::: {.left dir="auto"}
[Belgium]{.country-name}
:::

::: email
Email: <Benjamin.Hesmans@tessares.net>
:::
:::
:::
