  RFC 9238             Loading MUD URLs from QR Codes   May 2022
  -------------------- -------------------------------- ----------
  Richardson, et al.   Informational                    \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [9238](https://www.rfc-editor.org/rfc/rfc9238){.eref}

Category:
:   Informational

Published:
:   May 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    M. Richardson
    :::

    ::: org
    Sandelman Software Works
    :::
    :::

    ::: author
    ::: author-name
    J. Latour
    :::

    ::: org
    CIRA Labs
    :::
    :::

    ::: author
    ::: author-name
    H. Habibi Gharakheili
    :::

    ::: org
    UNSW Sydney
    :::
    :::
:::

# RFC 9238 {#rfcnum}

# Loading Manufacturer Usage Description (MUD) URLs from QR Codes {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This informational document details a protocol to load Manufacturer
Usage Description (MUD) definitions from RFC 8520 for devices that do
not have them integrated.[¶](#section-abstract-1){.pilcrow}

This document is published to inform the Internet community of this
mechanism to allow interoperability and to serve as a basis of other
standards work if there is interest.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9238>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Protocol](#name-protocol){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [The SQRL
        Protocol](#name-the-sqrl-protocol){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Manufacturer Usage Descriptions in
        SQRL](#name-manufacturer-usage-descript){.xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [B000 Company
            Name](#name-b000-company-name){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.xref}.  [B001 Product
            Name](#name-b001-product-name){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.3}
            [3.2.3](#section-3.2.3){.xref}.  [B002 Model
            Number](#name-b002-model-number){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.4}
            [3.2.4](#section-3.2.4){.xref}.  [MUD URL Data
            Record](#name-mud-url-data-record){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.5}
            [3.2.5](#section-3.2.5){.xref}.  [Device MAC
            Address](#name-device-mac-address){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Applicability](#name-applicability){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Generic URL or Version-Specific
    URL](#name-generic-url-or-version-spec){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Crowd Supply of MUD
    Files](#name-crowd-supply-of-mud-files){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Privacy
    Considerations](#name-privacy-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [QR Codes Are Not
        Assurances](#name-qr-codes-are-not-assurances){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [MUD Files Can Have
        Signatures](#name-mud-files-can-have-signatur){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [URL Shortening Services Can Change
        Content](#name-url-shortening-services-can){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [8.4](#section-8.4){.xref}.  [MUD QR Code Stickers Could Be
        Confused](#name-mud-qr-code-stickers-could-){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.5}
        [8.5](#section-8.5){.xref}.  [QR Code Can Include a MAC
        Address](#name-qr-code-can-include-a-mac-a){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-A){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [](#appendix-B){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Manufacturer Usage Description (MUD) \[[RFC8520](#RFC8520){.xref}\]
defines a YANG data model to express what sort of access a device
requires to operate correctly. That document additionally defines three
ways for the device to communicate the MUD URL (i.e., the URL of the
resulting MUD file in JSON \[[RFC8259](#RFC8259){.xref}\]) to a network
enforcement point: via DHCP, within an X.509 certificate extension, and
via the Link Local Discovery Protocol (LLDP).[¶](#section-1-1){.pilcrow}

Each of the above mechanisms conveys the MUD URL in band and requires
modifications to the device firmware. Most small Internet of Things
(IoT) devices do not have LLDP and often have very restricted DHCP
clients. Adding LLDP or DHCP options requires at least some minimal
configuration change and possibly entirely new subsystems. Meanwhile,
use of the PKIX certification extension only makes sense as part of a
larger deployment based on an Initial Device Identifier (IDevID)
\[[IEEE802-1AR](#IEEE802-1AR){.xref}\], for instance, as described in
\[[RFC8995](#RFC8995){.xref}\].[¶](#section-1-2){.pilcrow}

In the above cases, these mechanisms can only be implemented by persons
with access to modify and update the firmware of the
device.[¶](#section-1-3){.pilcrow}

In the meantime, there is a chicken or egg problem
\[[chickenegg](#chickenegg){.xref}\]. That is, manufacturers are not
motivated to (and thus likely do not) include MUD URLs in their
products, as they believe that there are no gateways using those URLs.
At the same time, gateways have little incentive to (and thus likely do
not) include code that processes MUD URLs, as it is believed that no
products have or disseminate URLs.[¶](#section-1-4){.pilcrow}

The protocol described in this document allows any person with physical
access to the device to affix a reference to a MUD URL that can later be
scanned by an end user.[¶](#section-1-5){.pilcrow}

The QR-based protocol is presented as a convenient alternative when the
mechanisms from \[[RFC8520](#RFC8520){.xref}\] are not available to use
on the device or the gateway.[¶](#section-1-6){.pilcrow}

Affixing a sticker can be done by:[¶](#section-1-7){.pilcrow}

-   [the marketing department of the
    manufacturer,[¶](#section-1-8.1){.pilcrow}]{#section-1-8.1}
-   [an outsourced assembler
    plant,[¶](#section-1-8.2){.pilcrow}]{#section-1-8.2}
-   [value-added resellers (perhaps in response to a local request for
    proposal (RFP)),[¶](#section-1-8.3){.pilcrow}]{#section-1-8.3}
-   [a company importing the product (possibly to comply with a local
    regulation),[¶](#section-1-8.4){.pilcrow}]{#section-1-8.4}
-   [a network administrator (perhaps before sending devices home with
    employees or to remote sites),
    and[¶](#section-1-8.5){.pilcrow}]{#section-1-8.5}
-   [a retailer as a value-added
    service.[¶](#section-1-8.6){.pilcrow}]{#section-1-8.6}

QR codes are informally described in \[[qrcode](#qrcode){.xref}\] and
formally defined in \[[isoiec18004](#isoiec18004){.xref}\]. The protocol
described in this document uses a QR code to encode the MUD URL.
Specifically, the protocol leverages the data format from the Reverse
Logistics Association\'s Standardized Quick Response for Logistics
\[[SQRL](#SQRL){.xref}\].[¶](#section-1-9){.pilcrow}

SQRL codes are being put on devices via a sticker or via laser etching
into the case in order to deal with many situations but specifically for
end-of-life processing for the device. An important idea behind the
effort is that clearly identifying a product permits appropriate
disposal, refurbishment, or recycling of the components of the
product.[¶](#section-1-10){.pilcrow}

There are also use cases for SQRL in which the codes are used as part of
regular maintenance for a product.[¶](#section-1-11){.pilcrow}

SQRL is an application of the 12N Data Identifier system specified by
the ANSI MH10.8.2 Committee \[[mh10](#mh10){.xref}\] in a format
appropriate for QR codes, as well as other things like Normalization
Form C (NFC) transmissions.[¶](#section-1-12){.pilcrow}

QR code generators are available as web services or as programs, such as
\[[qrencode](#qrencode){.xref}\].[¶](#section-1-13){.pilcrow}

[Section 5](#genericfirmware){.xref} summarizes the considerations
contained in \"Updating files vs Updating MUD URLs\" ([Section
7.1](https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-mud-acceptable-urls-04#section-7.1){.relref}
of \[[MUD-URLS](#I-D.ietf-opsawg-mud-acceptable-urls){.xref}\]). Due to
the immutable nature of the QR code, MUD URLs in this document will need
to be non-firmware specific.[¶](#section-1-14){.pilcrow}
:::
:::

::: {#Terminology}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

Although this document is not an IETF Standards Track publication, it
adopts the conventions for normative language to provide clarity of
instructions to the implementer. The key words \"[MUST]{.bcp14}\",
\"[MUST NOT]{.bcp14}\", \"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\",
\"[SHALL NOT]{.bcp14}\", \"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

Readers should be familiar with the terminology in
\[[RFC8520](#RFC8520){.xref}\], including: MUD file, MUD URL,
manufacturer, MUD manager, and controller.[¶](#section-2-2){.pilcrow}
:::
:::

::: {#protocol}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Protocol](#name-protocol){.section-name .selfRef} {#name-protocol}

The QR code protocol builds upon the work by \[[SQRL](#SQRL){.xref}\].
That protocol is very briefly described in [Section
3.1](#sqrlsummary){.xref}. Then, the list of needed Data Records to be
filled in is explained.[¶](#section-3-1){.pilcrow}

::: {#sqrlsummary}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [The SQRL Protocol](#name-the-sqrl-protocol){.section-name .selfRef} {#name-the-sqrl-protocol}

\[[SQRL](#SQRL){.xref}\] documents an octet protocol that can be
efficiently encoded into QR codes using a sequence of US-ASCII bytes,
plus six control codes (see Section 3.1 of
\[[SQRL](#SQRL){.xref}\]):[¶](#section-3.1-1){.pilcrow}

-   [\<RS> Record Separator (US-ASCII
    30)[¶](#section-3.1-2.1){.pilcrow}]{#section-3.1-2.1}
-   [\<EoT> End of Transmission (US-ASCII
    4)[¶](#section-3.1-2.2){.pilcrow}]{#section-3.1-2.2}
-   [\<FS> Field Separator (US-ASCII
    28)[¶](#section-3.1-2.3){.pilcrow}]{#section-3.1-2.3}
-   [\<GS> Group Separator (US-ASCII
    29)[¶](#section-3.1-2.4){.pilcrow}]{#section-3.1-2.4}
-   [\<US> Unit Separator (US-ASCII
    31)[¶](#section-3.1-2.5){.pilcrow}]{#section-3.1-2.5}
-   [Concatenation Operator (US-ASCII 43:
    \"+\")[¶](#section-3.1-2.6){.pilcrow}]{#section-3.1-2.6}

Section 7.2 of \[[SQRL](#SQRL){.xref}\] gives the details, which can be
summarized as:[¶](#section-3.1-3){.pilcrow}

1.  ::: {#section-3.1-4.1}
    The QR code header starts with:[¶](#section-3.1-4.1.1){.pilcrow}

    ::: {#section-3.1-4.1.2 .alignLeft .art-text .artwork}
        "[)>" <RS> "06" <GS> "12N"

    [¶](#section-3.1-4.1.2){.pilcrow}
    :::
    :::

2.  [Include one or more Data Records. This consists of a four-letter
    Field Identifier, followed by US-ASCII characters terminated with a
    \<Unit Separator>.[¶](#section-3.1-4.2){.pilcrow}]{#section-3.1-4.2}

3.  ::: {#section-3.1-4.3}
    End with:[¶](#section-3.1-4.3.1){.pilcrow}

    ::: {#section-3.1-4.3.2 .alignLeft .art-text .artwork}
        <RS><EoT>

    [¶](#section-3.1-4.3.2){.pilcrow}
    :::
    :::

Additionally, there are optional flags that may be present in every Data
Record, as described in Section 7.4 of \[[SQRL](#SQRL){.xref}\]. These
flags have no bearing on MUD processing. A parser that is only
collecting MUD URLs will not need to parse those flags. A
general-purpose SQRL parser will need more
complexity.[¶](#section-3.1-5){.pilcrow}

Field Separator characters are used in SQRL to signify the beginning of
a new unit of data. A MUD-specific parser that encounters a Field
Separator and has not yet collected the right MUD information
[MUST]{.bcp14} ignore the characters collected so far and then
restart.[¶](#section-3.1-6){.pilcrow}

Environment records, as described in Section 7.4 of
\[[SQRL](#SQRL){.xref}\], look and act exactly as fields, with a special
Field Identifier. They serve no purpose when looking for MUD information
and [MAY]{.bcp14} be ignored.[¶](#section-3.1-7){.pilcrow}
:::
:::

::: {#manufacturer-usage-descriptions-in-sqrl}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Manufacturer Usage Descriptions in SQRL](#name-manufacturer-usage-descript){.section-name .selfRef} {#name-manufacturer-usage-descript}

::: {#b000-company-name}
::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [B000 Company Name](#name-b000-company-name){.section-name .selfRef} {#name-b000-company-name}

The B000 Data Record is mandatory in \[[SQRL](#SQRL){.xref}\]. It
[MUST]{.bcp14} be in US-ASCII representation. It should be a
representation of the company or brand name. It [SHOULD]{.bcp14} match
the ietf-mud/mud/mfg-name in the MUD file; however, the MUD file can
contain arbitrary UTF-8 for this name, while the SQRL files are expected
to be 7-bit US-ASCII.[¶](#section-3.2.1-1){.pilcrow}
:::
:::

::: {#b001-product-name}
::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [B001 Product Name](#name-b001-product-name){.section-name .selfRef} {#name-b001-product-name}

The B001 Data Record is optional in \[[SQRL](#SQRL){.xref}\]. It is the
Product Name in US-ASCII. Its presence is [RECOMMENDED]{.bcp14}. Some
third parties that create QR code stickers might not know the product
name with 100% certainty and [MAY]{.bcp14} prefer to omit this rather
than create further confusion.[¶](#section-3.2.2-1){.pilcrow}
:::
:::

::: {#b002-model-number}
::: {#section-3.2.3 .section}
#### [3.2.3.](#section-3.2.3){.section-number .selfRef} [B002 Model Number](#name-b002-model-number){.section-name .selfRef} {#name-b002-model-number}

The B002 Data Record is optional in \[[SQRL](#SQRL){.xref}\] but is
MANDATORY in this profile. It is the Model Name in US-ASCII. It
[SHOULD]{.bcp14} match the optional ietf-mud/mud/model-name in the MUD
file if that entry is present in the MUD file. MUD files can contain
arbitrary UTF-8 for the model-name, while the SQRL files are expected to
be 7-bit US-ASCII.[¶](#section-3.2.3-1){.pilcrow}

If a third party that is creating QR codes cannot locate an official
model number when creating their MUD file and QR code, then the third
party [SHOULD]{.bcp14} make one up.[¶](#section-3.2.3-2){.pilcrow}
:::
:::

::: {#mudurl}
::: {#section-3.2.4 .section}
#### [3.2.4.](#section-3.2.4){.section-number .selfRef} [MUD URL Data Record](#name-mud-url-data-record){.section-name .selfRef} {#name-mud-url-data-record}

A new Field Identifier has been assigned by the Reverse Logistics
Association, which is \"M180\". This record [MUST]{.bcp14} be filled
with the MUD URL.[¶](#section-3.2.4-1){.pilcrow}

Short URLs are easier to encode into a QR code because they require
fewer pixels of QR code. More content in the QR code requires a bigger
image.[¶](#section-3.2.4-2){.pilcrow}

Use of URL shortening services (see
\[[URLshorten](#URLshorten){.xref}\]) can be useful, provided that the
service is stable throughout the lifetime of the device and QR code and
that the privacy stance of the service is well understood. The Security
Considerations section of \[[RFC3986](#RFC3986){.xref}\] applies,
particularly Section
[7.1](https://www.rfc-editor.org/rfc/rfc3986#section-7.1){.relref}.[¶](#section-3.2.4-3){.pilcrow}

Section 8.1 of \[[SQRL](#SQRL){.xref}\] also has some good advice on
longevity concerns with URLs.[¶](#section-3.2.4-4){.pilcrow}

The URL provided [MUST NOT]{.bcp14} have a query (?) portion present. If
one is present, the query portion [MUST]{.bcp14} be removed before
processing.[¶](#section-3.2.4-5){.pilcrow}
:::
:::

::: {#macaddress}
::: {#section-3.2.5 .section}
#### [3.2.5.](#section-3.2.5){.section-number .selfRef} [Device MAC Address](#name-device-mac-address){.section-name .selfRef} {#name-device-mac-address}

If a Media Access Control (MAC) address is used as a unique device
identifier (which is [RECOMMENDED]{.bcp14} if possible), then it
[MUST]{.bcp14} be included in this Data
Record.[¶](#section-3.2.5-1){.pilcrow}

Section 9.10 of \[[SQRL](#SQRL){.xref}\] defines the Data Record
\"M06C\" as the MAC address. No format for the MAC address is provided
in that document.[¶](#section-3.2.5-2){.pilcrow}

In this document, it is [RECOMMENDED]{.bcp14} that 12 (or 16) hex octets
are used with no spaces or punctuation. (16 octets are used in the IEEE
64-bit Extended Unique Identifier (EUI-64) format used in
\[[IEEE.802.15.4](#IEEE.802.15.4){.xref}\] and some next generation
Ethernet proposals). In this document, it is [RECOMMENDED]{.bcp14} that
uppercase hexadecimal letters be used.[¶](#section-3.2.5-3){.pilcrow}

Parsers that find punctuation (such as colons (\":\"), dashes (\"-\"),
US-ASCII Space (32), US-ASCII TAB (0), US-ASCII linefeed (10), or
US-ASCII carriage return (13)) [MUST]{.bcp14} skip over the punctuation.
Parsers [MUST]{.bcp14} tolerate hexadecimal in uppercase, lowercase, and
even mixed case. Systems [SHOULD]{.bcp14} canonicalize it to
uppercase.[¶](#section-3.2.5-4){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#applicability}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Applicability](#name-applicability){.section-name .selfRef} {#name-applicability}

The use of stickers to convey MUD URLs would appear to have little value
when the stickers are applied by the end-user organization and consumed
by the same. This is particularly the case when the QR code does not
include the device MAC address. In such a situation, the installer
handling the device would scan the QR code to get the appropriate MUD
file reference and have to input the associated MAC address as
well.[¶](#section-4-1){.pilcrow}

In such a case, one might wonder why the installer couldn\'t just enter
the appropriate MAC address and select the appropriate Access Control
Lists (ACLs) for the device. Then a MUD file or QR code to convey the
MAC address would not be needed. However, the use of a MUD file (or QR
code or other way to convey the MAC address) is advantageous because it
offers several layers of indirection:[¶](#section-4-2){.pilcrow}

1.  [The ACLs for a given device may be added or
    removed.[¶](#section-4-3.1){.pilcrow}]{#section-4-3.1}
2.  [The ACLs may refer to DNS names, which may map to IPv4 or IPv6
    addresses.[¶](#section-4-3.2){.pilcrow}]{#section-4-3.2}
3.  [The entire file may be replaced and may also include supply chain
    information, such as Software Bill of Materials
    (SBOM).[¶](#section-4-3.3){.pilcrow}]{#section-4-3.3}

In addition, the mechanism to install a new device (MAC address) to MUD
file mapping does not need to permit any other network security settings
to be alterable by the person doing the
installation.[¶](#section-4-4){.pilcrow}
:::
:::

::: {#genericfirmware}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Generic URL or Version-Specific URL](#name-generic-url-or-version-spec){.section-name .selfRef} {#name-generic-url-or-version-spec}

MUD URLs that are communicated in band by the device and that are
programmed into the device\'s firmware may provide a firmware-specific
version of the MUD URL. The advantage of this is that the resulting ACLs
enforced in the network are specific to the needs of that version of the
firmware.[¶](#section-5-1){.pilcrow}

A MUD URL that is affixed to the device with a sticker or etched into
the case cannot be changed.[¶](#section-5-2){.pilcrow}

Given the considerations of \"Updating MUD URLs vs Updating MUD files\"
([Section
6.1](https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-mud-acceptable-urls-04#section-6.1){.relref}
of \[[MUD-URLS](#I-D.ietf-opsawg-mud-acceptable-urls){.xref}\]), it is
prudent to use a MUD URL that points to a MUD file that will only have
new features added over time and never have features removed. To recap,
if a feature is removed from the firmware and the MUD file still permits
it, then there is a potential hole that could perhaps be exploited. The
opposite situation, where a MUD file wrongly forbids something, leads to
false positives in the security system, and the evidence is that this
results in the entire system being ignored. Preventing attacks on core
infrastructure may be more important than getting the ACL
perfect.[¶](#section-5-3){.pilcrow}

When the firmware eventually receives built-in MUD URL support, then a
more-specific URL may be used.[¶](#section-5-4){.pilcrow}

Note that in many cases, it will be third parties who are generating
these QR codes, so the MUD file may be hosted by the third
party.[¶](#section-5-5){.pilcrow}
:::
:::

::: {#crowd-supply-of-mud-files}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Crowd Supply of MUD Files](#name-crowd-supply-of-mud-files){.section-name .selfRef} {#name-crowd-supply-of-mud-files}

At the time of writing, the IETF MUD is a new IETF Proposed Standard.
Hence, IoT device manufacturers have not yet provided MUD profiles for
their devices. A research group at the University of New South Wales
(UNSW Sydney) has developed an open-source tool, called MUDgee
\[[MUDgee](#MUDgee){.xref}\], which automatically generates a MUD file
(profile) for an IoT device from its traffic trace in order to make this
process faster, easier, and more accurate. Note that the generated
profile completeness solely depends on the completeness of the input
traffic traces. MUDgee assumes that all the activity seen is intended
and benign.[¶](#section-6-1){.pilcrow}

UNSW researchers have applied MUDgee to about 30 consumer IoT devices
from their lab testbed and publicly released their MUD files
\[[MUDfiles](#MUDfiles){.xref}\]. MUDgee can assist IoT manufacturers in
developing and verifying MUD profiles, while also helping adopters of
these devices to ensure they are compatible with their organizational
policies.[¶](#section-6-2){.pilcrow}

Similar processes have been done in a number of other public and private
labs. One of the strong motivations for this specification is to allow
for this work to leave the lab and to be applied in the
field.[¶](#section-6-3){.pilcrow}
:::
:::

::: {#privacy-considerations}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Privacy Considerations](#name-privacy-considerations){.section-name .selfRef} {#name-privacy-considerations}

The presence of the MUD URL in the QR code reveals the manufacturer of
the device, the type or model of the device, and possibly the firmware
version of the device.[¶](#section-7-1){.pilcrow}

The MAC address of the device will also need to be present, and this is
potentially Personally Identifiable Information (PII). Such QR codes
should not be placed on the outside of the packaging and only on the
device itself, ideally on a non-prominent part of the device (e.g., the
bottom).[¶](#section-7-2){.pilcrow}

The QR code sticker should not be placed on any part of the device that
might become visible to machine vision systems in the same area. This
includes security systems, robotic vacuum cleaners, or anyone taking a
picture with a camera. Such systems may store the picture(s) in such a
way that a future viewer of the image will be able to decode the QR
code, possibly through an assembly of multiple pictures. Of course, the
QR code is not, however, a certain indicator that the device is present,
only that the QR code sticker that came with the device is
present.[¶](#section-7-3){.pilcrow}

The use of URL shorting services discussed in [Section
3.2.4](#mudurl){.xref} may result in trading convenience and efficiency
with privacy, since the service provider might leverage per-device or
per-customer, short URLs to track and correlate
requests.[¶](#section-7-4){.pilcrow}
:::
:::

::: {#security-considerations}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

::: {#qr-codes-are-not-assurances}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [QR Codes Are Not Assurances](#name-qr-codes-are-not-assurances){.section-name .selfRef} {#name-qr-codes-are-not-assurances}

The mere presence of a QR code on a device does not in itself create any
security issues on its own. Neither an attached paper sticker nor a
laser-etched code in a plastic case will affect the device
operation.[¶](#section-8.1-1){.pilcrow}

The QR code is not active; in general, it is not able to communicate
using nearby networks. It is conceivable that something more active is
concealed in the sticker, e.g., an NFC or a Radio Frequency
Identification (RFID) tag. But, any sticker could contain such a thing,
e.g., on some university campuses, stickers are often used as part of
political campaigns and can be found attached all over the
place.[¶](#section-8.1-2){.pilcrow}

Security issues that this protocol creates are related to assumptions
that the presence of the QR code might imply. The presence of the QR
code may imply to some owners or network operators that the behavior of
the device has been vetted by some authority. It is here that some
caution is required.[¶](#section-8.1-3){.pilcrow}

A possibly bigger risk from application of MUD file stickers to devices
is that they may begin to convey a sense of safety to users of the
device. The presence of the sticker, possibly with the logo of the
physical establishment in which the device is located, could convey to
occupants of the establishment that this device is an official device,
for instance, a university that only deploys sensors on the university
campus that have been vetted for compliance against a MUD
definition.[¶](#section-8.1-4){.pilcrow}

The risk is then of social engineering, e.g., any device with a
reasonable-looking QR code may be seen as a trusted device (even though
such trust is not justified based on that evidence). An attacker that
wishes to infiltrate their own devices need only suitably camouflage the
device with an appropriate sticker in order to convey
legitimacy.[¶](#section-8.1-5){.pilcrow}
:::
:::

::: {#mud-files-can-have-signatures}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [MUD Files Can Have Signatures](#name-mud-files-can-have-signatur){.section-name .selfRef} {#name-mud-files-can-have-signatur}

The network operator who takes the MUD file designated by the QR code
needs to be careful that they are validating the signature on the MUD
file. The network operator needs to verify that the file is intact and
that the signer of the file is authorized to sign MUD files for that
vendor, or if a MUD file is a crowd-sourced definition, they need to
establish if it can be trusted. \[[RFC8520](#RFC8520){.xref}\] does not
define any infrastructure to authenticate or authorize MUD file
signers.[¶](#section-8.2-1){.pilcrow}
:::
:::

::: {#url-shortening-services-can-change-content}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [URL Shortening Services Can Change Content](#name-url-shortening-services-can){.section-name .selfRef} {#name-url-shortening-services-can}

If a URL shortening service is used, it is possible that the MUD
controller will be redirected to another MUD file with different
content. The use of MUD signatures can detect attacks on the integrity
of the file. To do this, the MUD controller needs to be able to verify
the signature on the file.[¶](#section-8.3-1){.pilcrow}

If a Trust-On-First-Use (TOFU) policy is used for signature trust
anchors, then the URL shortening service can still attack if it
substitutes content and signature on the first use. MUD controllers and
the people operating them need to be cautious when using
TOFU.[¶](#section-8.3-2){.pilcrow}
:::
:::

::: {#mud-qr-code-stickers-could-be-confused}
::: {#section-8.4 .section}
### [8.4.](#section-8.4){.section-number .selfRef} [MUD QR Code Stickers Could Be Confused](#name-mud-qr-code-stickers-could-){.section-name .selfRef} {#name-mud-qr-code-stickers-could-}

Another issue with the stickers is that the wrong sticker could be
applied to a device by a reseller or another trusted party, either in
error or via some physical or socially engineered attack against that
party. The network operator now onboards a device and applies what they
think is a legitimate network policy for the device in their hands, only
it is in fact a policy for another kind of
device.[¶](#section-8.4-1){.pilcrow}

Careful examination of stickers is in
order![¶](#section-8.4-2){.pilcrow}
:::
:::

::: {#qr-code-can-include-mac-address}
::: {#section-8.5 .section}
### [8.5.](#section-8.5){.section-number .selfRef} [QR Code Can Include a MAC Address](#name-qr-code-can-include-a-mac-a){.section-name .selfRef} {#name-qr-code-can-include-a-mac-a}

Inclusion of the device-specific MAC address (described in [Section
3.2.5](#macaddress){.xref}) in the QR code makes use of the MUD code
much easier, as it identifies the device specifically. If the MAC
address is not included, then a network operator, having the device in
their hands, has to associate the policy with the device through some
other interface.[¶](#section-8.5-1){.pilcrow}

Despite the significant advantage of having the MAC address included, it
is unlikely that third-party stickers will include it. Including the MAC
address requires that a unique sticker with a QR code be created for
each device. This is possible if the sticker is applied by a
manufacturer; it is already common to have a serial number and MAC
address on the outside of the device. In that case, if the QR code is
part of that sticker, then the customization problem is not that
complex.[¶](#section-8.5-2){.pilcrow}

For cases where a third party has produced the QR code, it is likely
that every device of a particular model will have the same QR code
applied, omitting the MAC address. This increases the possibility that
the wrong policy will be applied to a
device.[¶](#section-8.5-3){.pilcrow}
:::
:::
:::
:::

::: {#iana-considerations}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-9-1){.pilcrow}
:::
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8520\]
:   [Lear, E.]{.refAuthor}, [Droms, R.]{.refAuthor}, and [D.
    Romascanu]{.refAuthor}, [\"Manufacturer Usage Description
    Specification\"]{.refTitle}, [RFC 8520]{.seriesInfo}, [DOI
    10.17487/RFC8520]{.seriesInfo}, March 2019,
    \<<https://www.rfc-editor.org/info/rfc8520>\>.
:   

\[SQRL\]
:   [Reverse Logistics Association]{.refAuthor}, [\"SQRL Codes:
    Standardized Quick Response for Logistics, Using the 12N Data
    Identifier\"]{.refTitle}, February 2017,
    \<<https://rla.org/resource/12n-documentation>\>.
:   
:::

::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[chickenegg\]
:   [Wikipedia]{.refAuthor}, [\"Chicken or the egg\"]{.refTitle}, April
    2022,
    \<<https://en.wikipedia.org/w/index.php?title=Chicken_or_the_egg&oldid=1081728488>\>.
:   

\[IEEE.802.15.4\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Low-Rate Wireless
    Networks\"]{.refTitle}, [IEEE Std. 802.15.4-2015]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2016.7460875]{.seriesInfo}, April 2016,
    \<<https://ieeexplore.ieee.org/document/7460875>\>.
:   

\[IEEE802-1AR\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Local and Metropolitan Area
    Networks - Secure Device Identity\"]{.refTitle}, [IEEE Std
    802.1AR-2018]{.seriesInfo}, August 2018,
    \<<https://standards.ieee.org/ieee/802.1AR/6995/>\>.
:   

\[isoiec18004\]
:   [ISO/IEC]{.refAuthor}, [\"Information technology - Automatic
    identification and data capture techniques - QR Code bar code
    symbology specification\"]{.refTitle}, [ISO/IEC
    18004:2015]{.seriesInfo}, February 2015.
:   

\[mh10\]
:   [ANSI]{.refAuthor}, [\"Data Identifier and Application Identifier
    Standard\"]{.refTitle}, [ANSI MH10.8.2-2016]{.seriesInfo}, June
    2016, \<<https://webstore.ansi.org/Standards/MHIA/ANSIMH102016>\>.
:   

\[MUD-URLS\]
:   [Richardson, M.]{.refAuthor}, [Pan, W.]{.refAuthor}, and [E.
    Lear]{.refAuthor}, [\"Authorized update to MUD URLs\"]{.refTitle},
    [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-opsawg-mud-acceptable-urls-04]{.seriesInfo}, 6 October
    2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-opsawg-mud-acceptable-urls-04>\>.
:   

\[MUDfiles\]
:   [UNSW Sydney]{.refAuthor}, [\"MUD Profiles\"]{.refTitle},
    \<<https://iotanalytics.unsw.edu.au/mud/>\>.
:   

\[MUDgee\]
:   [\"MUDgee\"]{.refTitle}, [commit f63a88d]{.refContent}, July 2019,
    \<<https://github.com/ayyoob/mudgee>\>.
:   

\[qrcode\]
:   [Wikipedia]{.refAuthor}, [\"QR code\"]{.refTitle}, April 2022,
    \<<https://en.wikipedia.org/w/index.php?title=QR_code&oldid=1082559657>\>.
:   

\[qrencode\]
:   [\"libqrencode\"]{.refTitle}, [commit 715e29f]{.refContent},
    September 2020, \<<https://github.com/fukuchi/libqrencode>\>.
:   

\[RFC3986\]
:   [Berners-Lee, T.]{.refAuthor}, [Fielding, R.]{.refAuthor}, and [L.
    Masinter]{.refAuthor}, [\"Uniform Resource Identifier (URI): Generic
    Syntax\"]{.refTitle}, [STD 66]{.seriesInfo}, [RFC
    3986]{.seriesInfo}, [DOI 10.17487/RFC3986]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3986>\>.
:   

\[RFC8259\]
:   [Bray, T., Ed.]{.refAuthor}, [\"The JavaScript Object Notation
    (JSON) Data Interchange Format\"]{.refTitle}, [STD 90]{.seriesInfo},
    [RFC 8259]{.seriesInfo}, [DOI 10.17487/RFC8259]{.seriesInfo},
    December 2017, \<<https://www.rfc-editor.org/info/rfc8259>\>.
:   

\[RFC8995\]
:   [Pritikin, M.]{.refAuthor}, [Richardson, M.]{.refAuthor},
    [Eckert, T.]{.refAuthor}, [Behringer, M.]{.refAuthor}, and [K.
    Watsen]{.refAuthor}, [\"Bootstrapping Remote Secure Key
    Infrastructure (BRSKI)\"]{.refTitle}, [RFC 8995]{.seriesInfo}, [DOI
    10.17487/RFC8995]{.seriesInfo}, May 2021,
    \<<https://www.rfc-editor.org/info/rfc8995>\>.
:   

\[URLshorten\]
:   [Wikipedia]{.refAuthor}, [\"URL shortening\"]{.refTitle}, April
    2022,
    \<<https://en.wikipedia.org/w/index.php?title=URL_shorteningg&oldid=1084979184>\>.
:   
:::
:::

::: {#acknowledgements}
::: {#appendix-A .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

This work was supported by the Canadian Internet Registration Authority
(cira.ca).[¶](#appendix-A-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Michael Richardson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Sandelman Software Works]{.org}
:::

::: email
Email: <mcr+ietf@sandelman.ca>
:::

::: {.left dir="auto"}
[Jacques Latour]{.fn .nameRole}
:::

::: {.left dir="auto"}
[CIRA Labs]{.org}
:::

::: email
Email: <Jacques.Latour@cira.ca>
:::

::: {.left dir="auto"}
[Hassan Habibi Gharakheili]{.fn .nameRole}
:::

::: {.left dir="auto"}
[UNSW Sydney]{.org}
:::

::: email
Email: <h.habibi@unsw.edu.au>
:::
:::
:::
