  RFC 9171           Bundle Protocol Version 7   January 2022
  ------------------ --------------------------- --------------
  Burleigh, et al.   Standards Track             \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9171](https://www.rfc-editor.org/rfc/rfc9171){.eref}

Category:
:   Standards Track

Published:
:   January 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    S. Burleigh
    :::

    ::: org
    IPNGROUP
    :::
    :::

    ::: author
    ::: author-name
    K. Fall
    :::

    ::: org
    Roland Computing Services
    :::
    :::

    ::: author
    ::: author-name
    E. Birrane, III
    :::

    ::: org
    APL, Johns Hopkins University
    :::
    :::
:::

# RFC 9171 {#rfcnum}

# Bundle Protocol Version 7 {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document presents a specification for the Bundle Protocol, adapted
from the experimental Bundle Protocol specification developed by the
Delay-Tolerant Networking Research Group of the Internet Research Task
Force and documented in RFC 5050.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9171>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions Used in This
    Document](#name-conventions-used-in-this-do){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Service
    Description](#name-service-description){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Definitions](#name-definitions){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Discussion of BP
        Concepts](#name-discussion-of-bp-concepts){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Services Offered by Bundle
        Protocol Agents](#name-services-offered-by-bundle-){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Bundle Format](#name-bundle-format){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Bundle
        Structure](#name-bundle-structure){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [BP Fundamental Data
        Structures](#name-bp-fundamental-data-structu){.xref}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [CRC
            Type](#name-crc-type){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [CRC](#name-crc){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.3}
            [4.2.3](#section-4.2.3){.xref}.  [Bundle Processing Control
            Flags](#name-bundle-processing-control-f){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.4}
            [4.2.4](#section-4.2.4){.xref}.  [Block Processing Control
            Flags](#name-block-processing-control-fl){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.5}
            [4.2.5](#section-4.2.5){.xref}.  [Identifiers](#name-identifiers){.xref}

            -   ::: {#section-toc.1-1.4.2.2.2.5.2.1}
                [4.2.5.1](#section-4.2.5.1){.xref}.  [Endpoint
                ID](#name-endpoint-id){.xref}

                -   ::: {#section-toc.1-1.4.2.2.2.5.2.1.2.1}
                    [4.2.5.1.1](#section-4.2.5.1.1){.xref}.  [The dtn
                    URI Scheme](#name-the-dtn-uri-scheme){.xref}
                    :::

                -   ::: {#section-toc.1-1.4.2.2.2.5.2.1.2.2}
                    [4.2.5.1.2](#section-4.2.5.1.2){.xref}.  [The ipn
                    URI Scheme](#name-the-ipn-uri-scheme){.xref}
                    :::
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.5.2.2}
                [4.2.5.2](#section-4.2.5.2){.xref}.  [Node
                ID](#name-node-id){.xref}
                :::
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.6}
            [4.2.6](#section-4.2.6){.xref}.  [DTN
            Time](#name-dtn-time){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.7}
            [4.2.7](#section-4.2.7){.xref}.  [Creation
            Timestamp](#name-creation-timestamp){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.8}
            [4.2.8](#section-4.2.8){.xref}.  [Block-Type-Specific
            Data](#name-block-type-specific-data){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Block
        Structures](#name-block-structures){.xref}

        -   ::: {#section-toc.1-1.4.2.3.2.1}
            [4.3.1](#section-4.3.1){.xref}.  [Primary Bundle
            Block](#name-primary-bundle-block){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.2}
            [4.3.2](#section-4.3.2){.xref}.  [Canonical Bundle Block
            Format](#name-canonical-bundle-block-form){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Extension
        Blocks](#name-extension-blocks){.xref}

        -   ::: {#section-toc.1-1.4.2.4.2.1}
            [4.4.1](#section-4.4.1){.xref}.  [Previous
            Node](#name-previous-node){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.2}
            [4.4.2](#section-4.4.2){.xref}.  [Bundle
            Age](#name-bundle-age){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.3}
            [4.4.3](#section-4.4.3){.xref}.  [Hop
            Count](#name-hop-count){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Bundle
    Processing](#name-bundle-processing){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Generation of Administrative
        Records](#name-generation-of-administrativ){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Bundle
        Transmission](#name-bundle-transmission){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Bundle
        Dispatching](#name-bundle-dispatching){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Bundle
        Forwarding](#name-bundle-forwarding){.xref}

        -   ::: {#section-toc.1-1.5.2.4.2.1}
            [5.4.1](#section-5.4.1){.xref}.  [Forwarding
            Contraindicated](#name-forwarding-contraindicated){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.4.2.2}
            [5.4.2](#section-5.4.2){.xref}.  [Forwarding
            Failed](#name-forwarding-failed){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Bundle
        Expiration](#name-bundle-expiration){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [Bundle
        Reception](#name-bundle-reception){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.7}
        [5.7](#section-5.7){.xref}.  [Local Bundle
        Delivery](#name-local-bundle-delivery){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.8}
        [5.8](#section-5.8){.xref}.  [Bundle
        Fragmentation](#name-bundle-fragmentation){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.9}
        [5.9](#section-5.9){.xref}.  [Application Data Unit
        Reassembly](#name-application-data-unit-reass){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.10}
        [5.10](#section-5.10){.xref}. [Bundle
        Deletion](#name-bundle-deletion){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.11}
        [5.11](#section-5.11){.xref}. [Discarding a
        Bundle](#name-discarding-a-bundle){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.12}
        [5.12](#section-5.12){.xref}. [Canceling a
        Transmission](#name-canceling-a-transmission){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Administrative Record
    Processing](#name-administrative-record-proce){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Administrative
        Records](#name-administrative-records){.xref}

        -   ::: {#section-toc.1-1.6.2.1.2.1}
            [6.1.1](#section-6.1.1){.xref}.  [Bundle Status
            Reports](#name-bundle-status-reports){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Generation of Administrative
        Records](#name-generation-of-administrative){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Services Required of the Convergence
    Layer](#name-services-required-of-the-co){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [The Convergence
        Layer](#name-the-convergence-layer){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Summary of Convergence-Layer
        Services](#name-summary-of-convergence-laye){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Bundle Block
        Types](#name-bundle-block-types){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Primary Bundle Protocol
        Version](#name-primary-bundle-protocol-ver){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [9.3](#section-9.3){.xref}.  [Bundle Processing Control
        Flags](#name-bundle-processing-control-fl){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.4}
        [9.4](#section-9.4){.xref}.  [Block Processing Control
        Flags](#name-block-processing-control-fla){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.5}
        [9.5](#section-9.5){.xref}.  [Bundle Status Report Reason
        Codes](#name-bundle-status-report-reason){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.6}
        [9.6](#section-9.6){.xref}.  [Bundle Protocol URI Scheme
        Types](#name-bundle-protocol-uri-scheme-){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.7}
        [9.7](#section-9.7){.xref}.  [dtn URI
        Scheme](#name-dtn-uri-scheme){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.8}
        [9.8](#section-9.8){.xref}.  [ipn URI
        Scheme](#name-ipn-uri-scheme){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix A](#appendix-A){.xref}.  [Significant Changes from RFC
    5050](#name-significant-changes-from-rf){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix B](#appendix-B){.xref}.  [CDDL
    Expression](#name-cddl-expression){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [](#appendix-C){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.14}
    [](#appendix-D){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#sect-1}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

Since the publication of the Bundle Protocol specification (Experimental
RFC 5050 \[[RFC5050](#RFC5050){.xref}\]) in 2007, the Delay-Tolerant
Networking (DTN) Bundle Protocol (BP) has been implemented in multiple
programming languages and deployed to a wide variety of computing
platforms. This implementation and deployment experience has identified
opportunities for making the protocol simpler, more capable, and easier
to use. The present document, standardizing the Bundle Protocol, is
adapted from RFC 5050 in that context, reflecting lessons learned.
Significant changes from the Bundle Protocol specification defined in
RFC 5050 are listed in [Appendix
A](#app-a){.xref}.[¶](#section-1-1){.pilcrow}

This document describes BP version 7 (BPv7).[¶](#section-1-2){.pilcrow}

Delay-Tolerant Networking is a network architecture providing
communications in and/or through highly stressed environments. Stressed
networking environments include those with intermittent connectivity,
large and/or variable delays, and high bit error rates. To provide its
services, BP may be viewed as sitting at the application layer of some
number of constituent networks, forming a store-carry-forward overlay
network. Key capabilities of BP include:[¶](#section-1-3){.pilcrow}

-   [Ability to use physical motility for the movement of
    data.[¶](#section-1-4.1){.pilcrow}]{#section-1-4.1}
-   [Ability to move the responsibility for error control from one node
    to another.[¶](#section-1-4.2){.pilcrow}]{#section-1-4.2}
-   [Ability to cope with intermittent connectivity, including cases
    where the sender and receiver are not concurrently present in the
    network.[¶](#section-1-4.3){.pilcrow}]{#section-1-4.3}
-   [Ability to take advantage of scheduled, predicted, and
    opportunistic connectivity, whether bidirectional or unidirectional,
    in addition to continuous
    connectivity.[¶](#section-1-4.4){.pilcrow}]{#section-1-4.4}
-   [Late binding of overlay-network endpoint identifiers to underlying
    constituent network
    addresses.[¶](#section-1-4.5){.pilcrow}]{#section-1-4.5}

For descriptions of these capabilities and the rationale for the DTN
architecture, see \[[ARCH](#RFC4838){.xref}\] and
\[[SIGC](#SIGC){.xref}\].[¶](#section-1-5){.pilcrow}

BP\'s location within the standard protocol stack is as shown in [Figure
1](#fig-1){.xref}. BP uses underlying \"integrated\" transport and/or
network protocols for communications within a given constituent network.
The layer at which those underlying protocols are located is here termed
the \"convergence layer\", and the interface between the Bundle Protocol
and a specific underlying protocol is termed a \"convergence-layer
adapter\".[¶](#section-1-6){.pilcrow}

[Figure 1](#fig-1){.xref} shows three distinct transport and network
protocols (denoted T1/N1, T2/N2, and T3/N3).[¶](#section-1-7){.pilcrow}

[]{#name-the-bundle-protocol-in-the-}

::: {#fig-1}
::: {#section-1-8.1 .alignLeft .art-ascii-art .art-text .artwork}
    +-----------+                                         +-----------+
    |   BP app  |                                         |   BP app  |
    +---------v-|   +->>>>>>>>>>v-+     +->>>>>>>>>>v-+   +-^---------+
    |   BP    v |   | ^    BP   v |     | ^   BP    v |   | ^   BP    |
    +---------v-+   +-^---------v-+     +-^---------v-+   +-^---------+
    | T1      v |   + ^  T1/T2  v |     + ^  T2/T3  v |   | ^ T3      |
    +---------v-+   +-^---------v-+     +-^---------v +   +-^---------+
    | N1      v |   | ^  N1/N2  v |     | ^  N2/N3  v |   | ^ N3      |
    +---------v-+   +-^---------v +     +-^---------v-+   +-^---------+
    |         >>>>>>>>^         >>>>>>>>>>^         >>>>>>>>^         |
    +-----------+   +-------------+     +-------------+   +-----------+
    |                     |                     |                     |
    |<---- A network ---->|                     |<---- A network ---->|
    |                     |                     |                     |
:::

[Figure 1](#figure-1){.selfRef}: [The Bundle Protocol in the Protocol
Stack Model](#name-the-bundle-protocol-in-the-){.selfRef}
:::

This document describes the format of the protocol data units (PDUs)
(called \"bundles\") passed between entities participating in BP
communications.[¶](#section-1-9){.pilcrow}

The entities are referred to as \"bundle nodes\". This document does not
address:[¶](#section-1-10){.pilcrow}

-   [Operations in the convergence-layer adapters that bundle nodes use
    to transport data through specific types of internets. (However, the
    document does discuss the services that must be provided by each
    adapter at the convergence
    layer.)[¶](#section-1-11.1){.pilcrow}]{#section-1-11.1}
-   [The bundle route computation
    algorithm.[¶](#section-1-11.2){.pilcrow}]{#section-1-11.2}
-   [Mechanisms for populating the routing or forwarding information
    bases of bundle
    nodes.[¶](#section-1-11.3){.pilcrow}]{#section-1-11.3}
-   [The mechanisms for securing bundles en
    route.[¶](#section-1-11.4){.pilcrow}]{#section-1-11.4}
-   [The mechanisms for managing bundle
    nodes.[¶](#section-1-11.5){.pilcrow}]{#section-1-11.5}

Note that implementations of the specification presented in this
document will not be interoperable with implementations of RFC
5050.[¶](#section-1-12){.pilcrow}
:::
:::

::: {#sect-2}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions Used in This Document](#name-conventions-used-in-this-do){.section-name .selfRef} {#name-conventions-used-in-this-do}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::
:::

::: {#sect-3}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Service Description](#name-service-description){.section-name .selfRef} {#name-service-description}

::: {#sect-3.1}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Definitions](#name-definitions){.section-name .selfRef} {#name-definitions}

[]{.break}

Bundle:
:   A bundle is a PDU of BP, so named because negotiation of the
    parameters of a data exchange may be impractical in a delay-tolerant
    network: it is often better practice to \"bundle\" with a unit of
    application data all metadata that might be needed in order to make
    the data immediately usable when delivered to the application. Each
    bundle comprises a sequence of two or more \"blocks\" of protocol
    data, which serve various purposes.[¶](#section-3.1-1.2){.pilcrow}
:   

Block:
:   A Bundle Protocol block is one of the protocol data structures that
    together constitute a well-formed
    bundle.[¶](#section-3.1-1.4){.pilcrow}
:   

Application Data Unit:
:   An application data unit (ADU) is the unit of data whose conveyance
    to the bundle\'s destination is the purpose for the transmission of
    some bundle that is not a fragment (as defined
    below).[¶](#section-3.1-1.6){.pilcrow}
:   

Bundle payload:
:   A bundle payload (or simply \"payload\") is the content of the
    bundle\'s payload block. The terms \"bundle content\", \"bundle
    payload\", and \"payload\" are used interchangeably in this
    document. For a bundle that is not a fragment (as defined below),
    the payload is an ADU.[¶](#section-3.1-1.8){.pilcrow}
:   

Partial payload:
:   A partial payload is a payload that comprises either the first N
    bytes or the last N bytes of some other payload of length M, such
    that 0 \< N \< M. Note that every partial payload is a payload and
    therefore can be further subdivided into partial
    payloads.[¶](#section-3.1-1.10){.pilcrow}
:   

Fragment:
:   A fragment, a.k.a. \"fragmentary bundle\", is a bundle whose payload
    block contains a partial payload.[¶](#section-3.1-1.12){.pilcrow}
:   

Bundle node:
:   A bundle node (or, in the context of this document, simply a
    \"node\") is any entity that can send and/or receive bundles. Each
    bundle node has three conceptual components, defined below, as shown
    in [Figure 2](#fig-2){.xref}: a \"Bundle Protocol Agent\", a set of
    zero or more \"convergence-layer adapters\", and an \"application
    agent\". (\"CL1 PDUs\" are the PDUs of the convergence-layer
    protocol used in network 1.)[¶](#section-3.1-1.14){.pilcrow}
:   

[]{#name-components-of-a-bundle-node}

::: {#fig-2}
::: {#section-3.1-2.1 .alignLeft .art-ascii-art .art-text .artwork}
    +-----------------------------------------------------------+
    |Node                                                       |
    |                                                           |
    | +-------------------------------------------------------+ |
    | |Application Agent                                      | |
    | |                                                       | |
    | | +--------------------------+ +----------------------+ | |
    | | |Administrative element    | |Application-specific  | | |
    | | |                          | |element               | | |
    | | |                          | |                      | | |
    | | +--------------------------+ +----------------------+ | |
    | |                ^                          ^           | |
    | |           Admin|records        Application|data       | |
    | |                |                          |           | |
    | +----------------v--------------------------v-----------+ |
    |                               ^                           |
    |                               | ADUs                      |
    |                               |                           |
    | +-----------------------------v-------------------------+ |
    | |Bundle Protocol Agent                                  | |
    | |                                                       | |
    | |                                                       | |
    | +-------------------------------------------------------+ |
    |        ^                 ^                        ^       |
    |        | Bundles         | Bundles        Bundles |       |
    |        |                 |                        |       |
    | +------v-----+     +-----v------+           +-----v-----+ |
    | |CLA 1       |     |CLA 2       |           |CLA n      | |
    | |            |     |            |   . . .   |           | |
    | |            |     |            |           |           | |
    +-+------------+-----+------------+-----------+-----------+-+
             ^                 ^                        ^
          CL1|PDUs          CL2|PDUs                 CLn|PDUs
             |                 |                        |
      +------v-----+     +-----v------+           +-----v-----+
       Network 1          Network 2                Network n
:::

[Figure 2](#figure-2){.selfRef}: [Components of a Bundle
Node](#name-components-of-a-bundle-node){.selfRef}
:::

[]{.break}

Bundle Protocol Agent:
:   The Bundle Protocol Agent (BPA) of a node is the node component that
    offers the BP services and executes the procedures of the Bundle
    Protocol.[¶](#section-3.1-3.2){.pilcrow}
:   

Convergence-layer adapter:
:   A convergence-layer adapter (CLA) is a node component that sends and
    receives bundles on behalf of the BPA, utilizing the services of
    some \"integrated\" protocol stack that is supported in one of the
    networks within which the node is functionally
    located.[¶](#section-3.1-3.4){.pilcrow}
:   

Application agent:
:   The application agent (AA) of a node is the node component that
    utilizes the BP services to effect communication for some user
    purpose. The application agent in turn has two elements: an
    administrative element and an application-specific
    element.[¶](#section-3.1-3.6){.pilcrow}
:   

Application-specific element:
:   The application-specific element of an AA is the node component that
    constructs, requests transmission of, accepts delivery of, and
    processes units of user application
    data.[¶](#section-3.1-3.8){.pilcrow}
:   

Administrative element:
:   The administrative element of an AA is the node component that
    constructs and requests transmission of administrative records
    (defined below), including status reports, and accepts delivery of
    and processes any administrative records that the node
    receives.[¶](#section-3.1-3.10){.pilcrow}
:   

Administrative record:
:   A BP administrative record is an ADU that is exchanged between the
    administrative elements of nodes\' application agents for some BP
    administrative purpose. The only administrative record defined in
    this specification is the status report, discussed
    later.[¶](#section-3.1-3.12){.pilcrow}
:   

Bundle endpoint:
:   A bundle endpoint (or simply \"endpoint\") is a set of zero or more
    bundle nodes that all identify themselves for BP purposes by some
    common identifier, called a \"bundle endpoint ID\" (or, in this
    document, simply \"endpoint ID\"); endpoint IDs are described in
    detail in [Section
    4.2.5.1](#sect-4.2.5.1){.xref}.[¶](#section-3.1-3.14){.pilcrow}
:   

Singleton endpoint:
:   A singleton endpoint is an endpoint that always contains exactly one
    member.[¶](#section-3.1-3.16){.pilcrow}
:   

Registration:
:   A registration is the state machine characterizing a given node\'s
    membership in a given endpoint. Any single registration has an
    associated delivery failure action as defined below and must at any
    time be in one of two states: Active or Passive. Registrations are
    local; information about a node\'s registrations is not expected to
    be available at other nodes, and the Bundle Protocol does not
    include a mechanism for distributing information about
    registrations.[¶](#section-3.1-3.18){.pilcrow}
:   

Delivery:
:   A bundle is considered to have been delivered at a node subject to a
    registration as soon as the ADU that is the payload of the bundle,
    together with any relevant metadata (an implementation matter), has
    been presented to the node\'s application agent in a manner
    consistent with the state of that
    registration.[¶](#section-3.1-3.20){.pilcrow}
:   

Deliverability:
:   A bundle is considered \"deliverable\" subject to a registration if
    and only if (a) the bundle\'s destination endpoint is the endpoint
    with which the registration is associated, (b) the bundle has not
    yet been delivered subject to this registration, and (c) the bundle
    has not yet been \"abandoned\" (as defined below) subject to this
    registration.[¶](#section-3.1-3.22){.pilcrow}
:   

Abandonment:
:   To abandon a bundle subject to some registration is to assert that
    the bundle is not deliverable subject to that
    registration.[¶](#section-3.1-3.24){.pilcrow}
:   

Delivery failure action:
:   The delivery failure action of a registration is the action that is
    to be taken when a bundle that is \"deliverable\" subject to that
    registration is received at a time when the registration is in the
    Passive state.[¶](#section-3.1-3.26){.pilcrow}
:   

Destination:
:   The destination of a bundle is the endpoint comprising the node(s)
    at which the bundle is to be delivered (as defined
    above).[¶](#section-3.1-3.28){.pilcrow}
:   

Transmission:
:   A transmission is an attempt by a node\'s BPA to cause copies of a
    bundle to be delivered to one or more of the nodes that are members
    of some endpoint (the bundle\'s destination) in response to a
    transmission request issued by the node\'s application
    agent.[¶](#section-3.1-3.30){.pilcrow}
:   

Forwarding:
:   To forward a bundle to a node is to invoke the services of one or
    more CLAs in a sustained effort to cause a copy of the bundle to be
    received by that node.[¶](#section-3.1-3.32){.pilcrow}
:   

Discarding:
:   To discard a bundle is to cease all operations on the bundle and
    functionally erase all references to it. The specific procedures by
    which this is accomplished are an implementation
    matter.[¶](#section-3.1-3.34){.pilcrow}
:   

Retention constraint:
:   A retention constraint is an element of the state of a bundle that
    prevents the bundle from being discarded. That is, a bundle cannot
    be discarded while it has any retention
    constraints.[¶](#section-3.1-3.36){.pilcrow}
:   

Deletion:
:   To delete a bundle is to remove unconditionally all of the bundle\'s
    retention constraints, enabling the bundle to be
    discarded.[¶](#section-3.1-3.38){.pilcrow}
:   
:::
:::

::: {#sect-3.2}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Discussion of BP Concepts](#name-discussion-of-bp-concepts){.section-name .selfRef} {#name-discussion-of-bp-concepts}

Multiple instances of the same bundle (the same unit of DTN protocol
data) might exist concurrently in different parts of a network \--
possibly differing in some blocks \-- in the memory local to one or more
bundle nodes and/or in transit between nodes. In the context of the
operation of a bundle node, a bundle is an instance (copy), in that
node\'s local memory, of some bundle that is in the
network.[¶](#section-3.2-1){.pilcrow}

The payload for a bundle forwarded in response to a bundle transmission
request is the ADU whose location is provided as a parameter to that
request. The payload for a bundle forwarded in response to reception of
a bundle is the payload of the received
bundle.[¶](#section-3.2-2){.pilcrow}

In the most familiar case, a bundle node is instantiated as a single
process running on a general-purpose computer, but in general the
definition is meant to be broader: a bundle node might alternatively be
a thread, an object in an object-oriented operating system, a
special-purpose hardware device, etc.[¶](#section-3.2-3){.pilcrow}

The manner in which the functions of the BPA are performed is wholly an
implementation matter. For example, BPA functionality might be coded
into each node individually; it might be implemented as a shared library
that is used in common by any number of bundle nodes on a single
computer; it might be implemented as a daemon whose services are invoked
via inter-process or network communication by any number of bundle nodes
on one or more computers; it might be implemented in
hardware.[¶](#section-3.2-4){.pilcrow}

Every CLA implements its own thin layer of protocol, interposed between
BP and the (usually \"top\") protocol(s) of the underlying integrated
protocol stack; this \"CL protocol\" may only serve to multiplex and
demultiplex bundles to and from the underlying integrated protocol, or
it may offer additional CL-specific functionality. The manner in which a
CLA sends and receives bundles, as well as the definitions of CLAs and
CL protocols, are beyond the scope of this
specification.[¶](#section-3.2-5){.pilcrow}

Note that the administrative element of a node\'s application agent may
itself, in some cases, function as a CLA. That is, outgoing bundles may
be \"tunneled\" through encapsulating
bundles:[¶](#section-3.2-6){.pilcrow}

-   [An outgoing bundle constitutes a byte array. This byte array may,
    like any other, be presented to the BPA as an ADU that is to be
    transmitted to some
    endpoint.[¶](#section-3.2-7.1){.pilcrow}]{#section-3.2-7.1}
-   [The original bundle thus forms the payload of an encapsulating
    bundle that is forwarded using some other convergence-layer
    protocol(s).[¶](#section-3.2-7.2){.pilcrow}]{#section-3.2-7.2}
-   [When the encapsulating bundle is received, its payload is delivered
    to the peer application agent administrative element, which then
    instructs the BPA to dispatch that original bundle in the usual
    way.[¶](#section-3.2-7.3){.pilcrow}]{#section-3.2-7.3}

The purposes for which this technique may be useful (such as
cross-domain security) are beyond the scope of this
specification.[¶](#section-3.2-8){.pilcrow}

The only interface between the BPA and the application-specific element
of the AA is the BP service interface. But between the BPA and the
administrative element of the AA there is a (conceptual) private control
interface in addition to the BP service interface. This private control
interface enables the BPA and the administrative element of the AA to
direct each other to take action under specific
circumstances.[¶](#section-3.2-9){.pilcrow}

In the case of a node that serves simply as a BP \"router\", the AA may
have no application-specific element at all. The application-specific
elements of other nodes\' AAs may perform arbitrarily complex
application functions, perhaps even offering multiplexed DTN
communication services to a number of other applications. As with the
BPA, the manner in which the AA performs its functions is wholly an
implementation matter.[¶](#section-3.2-10){.pilcrow}

Singletons are the most familiar sort of endpoint, but in general the
endpoint notion is meant to be broader. For example, the nodes in a
sensor network might constitute a set of bundle nodes that are all
registered in a single common endpoint and will all receive any data
delivered at that endpoint. **Note** too that any given bundle node
might be registered in multiple bundle endpoints and receive all data
delivered at each of those endpoints.[¶](#section-3.2-11){.pilcrow}

Recall that every node, by definition, includes an application agent,
which in turn includes an administrative element, which exchanges
administrative records with the administrative elements of other nodes.
As such, every node is permanently, structurally registered in the
singleton endpoint at which administrative records received from other
nodes are delivered. Registration in no other endpoint can ever be
assumed to be permanent. This endpoint, termed the node\'s
\"administrative endpoint\", is therefore uniquely and permanently
associated with the node, and for this reason the ID of a node\'s
administrative endpoint may always serve as the \"node ID\" (see
[Section 4.2.5.2](#sect-4.2.5.2){.xref}) of the
node.[¶](#section-3.2-12){.pilcrow}

The destination of every bundle is an endpoint, which may or may not be
singleton. The source of every bundle is a node, identified by node ID.
Note, though, that the source node ID asserted in a given bundle may be
the null endpoint ID (as described later) rather than the ID of the
source node; bundles for which the asserted source node ID is the null
endpoint ID are termed \"anonymous\"
bundles.[¶](#section-3.2-13){.pilcrow}

Any number of transmissions may be concurrently undertaken by the BPA of
a given node.[¶](#section-3.2-14){.pilcrow}

When the BPA of a node determines that it must forward a bundle either
to a node that is a member of the bundle\'s destination endpoint or to
some intermediate forwarding node, the BPA invokes the services of one
or more CLAs in a sustained effort to cause a copy of the bundle to be
received by that node.[¶](#section-3.2-15){.pilcrow}

Upon reception, the processing of a bundle depends on whether or not the
receiving node is registered in the bundle\'s destination endpoint. If
it is, and if the payload of the bundle is non-fragmentary (possibly as
a result of successful payload reassembly from fragmentary payloads,
including the original payload of the newly received bundle), then the
bundle is normally delivered to the node\'s application agent subject to
the registration characterizing the node\'s membership in the
destination endpoint.[¶](#section-3.2-16){.pilcrow}

The Bundle Protocol itself does not ensure delivery of a bundle to its
destination. Data loss along the path to the destination node can be
minimized by utilizing reliable convergence-layer protocols between
neighbors on all segments of the end-to-end path; however, for
end-to-end bundle delivery assurance it will be necessary to develop
extensions to the Bundle Protocol and/or application-layer
mechanisms.[¶](#section-3.2-17){.pilcrow}

The Bundle Protocol is designed for extensibility. Bundle Protocol
extensions, documented elsewhere, may extend this specification by
defining additional:[¶](#section-3.2-18){.pilcrow}

-   [blocks[¶](#section-3.2-19.1){.pilcrow}]{#section-3.2-19.1}
-   [administrative
    records[¶](#section-3.2-19.2){.pilcrow}]{#section-3.2-19.2}
-   [bundle processing control
    flags[¶](#section-3.2-19.3){.pilcrow}]{#section-3.2-19.3}
-   [block processing control
    flags[¶](#section-3.2-19.4){.pilcrow}]{#section-3.2-19.4}
-   [types of bundle status
    reports[¶](#section-3.2-19.5){.pilcrow}]{#section-3.2-19.5}
-   [bundle status report reason
    codes[¶](#section-3.2-19.6){.pilcrow}]{#section-3.2-19.6}
-   [mandates and constraints on processing that conformant BPAs must
    perform at specified points in the inbound and outbound bundle
    processing
    cycles[¶](#section-3.2-19.7){.pilcrow}]{#section-3.2-19.7}
:::
:::

::: {#sect-3.3}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Services Offered by Bundle Protocol Agents](#name-services-offered-by-bundle-){.section-name .selfRef} {#name-services-offered-by-bundle-}

The BPA of each node is expected to provide the following services to
the node\'s application agent:[¶](#section-3.3-1){.pilcrow}

-   [commencing a registration (registering the node in an
    endpoint).[¶](#section-3.3-2.1){.pilcrow}]{#section-3.3-2.1}
-   [terminating a
    registration.[¶](#section-3.3-2.2){.pilcrow}]{#section-3.3-2.2}
-   [switching a registration between Active and Passive
    states.[¶](#section-3.3-2.3){.pilcrow}]{#section-3.3-2.3}
-   [transmitting a bundle to an identified bundle
    endpoint.[¶](#section-3.3-2.4){.pilcrow}]{#section-3.3-2.4}
-   [canceling a
    transmission.[¶](#section-3.3-2.5){.pilcrow}]{#section-3.3-2.5}
-   [polling a registration that is in the Passive
    state.[¶](#section-3.3-2.6){.pilcrow}]{#section-3.3-2.6}
-   [delivering a received
    bundle.[¶](#section-3.3-2.7){.pilcrow}]{#section-3.3-2.7}

Note that the details of registration functionality are an
implementation matter and are beyond the scope of this
specification.[¶](#section-3.3-3){.pilcrow}
:::
:::
:::
:::

::: {#sect-4}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Bundle Format](#name-bundle-format){.section-name .selfRef} {#name-bundle-format}

::: {#sect-4.1}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Bundle Structure](#name-bundle-structure){.section-name .selfRef} {#name-bundle-structure}

The format of bundles [SHALL]{.bcp14} conform to the Concise Binary
Object Representation (CBOR)
\[[RFC8949](#RFC8949){.xref}\].[¶](#section-4.1-1){.pilcrow}

Cryptographic verification of a block is possible only if the sequence
of octets on which the verifying node computes its hash \-- the
canonicalized representation of the block \-- is identical to the
sequence of octets on which the hash declared for that block was
computed. To ensure that blocks are always in canonical representation
when they are transmitted and received, the CBOR encodings of the values
of all fields in all blocks [MUST]{.bcp14} conform to the core
deterministic encoding requirements as specified in
\[[RFC8949](#RFC8949){.xref}\], except that indefinite-length items are
not prohibited.[¶](#section-4.1-2){.pilcrow}

Each bundle [SHALL]{.bcp14} be a concatenated sequence of at least two
blocks, represented as a CBOR indefinite-length array. The first block
in the sequence (the first item of the array) [MUST]{.bcp14} be a
primary bundle block in CBOR encoding as described below; the bundle
[MUST]{.bcp14} have exactly one primary bundle block. The primary block
[MUST]{.bcp14} be followed by one or more canonical bundle blocks
(additional array items) in CBOR encoding as described in [Section
4.3.2](#sect-4.3.2){.xref}. Every block following the primary block
[SHALL]{.bcp14} be the CBOR encoding of a canonical block. The last such
block [MUST]{.bcp14} be a payload block; the bundle [MUST]{.bcp14} have
exactly one payload block. The payload block [SHALL]{.bcp14} be followed
by a CBOR \"break\" stop code, terminating the
array.[¶](#section-4.1-3){.pilcrow}

(Note that, while CBOR permits considerable flexibility in the encoding
of bundles, this flexibility must not be interpreted as inviting
increased complexity in PDU structure.)[¶](#section-4.1-4.1){.pilcrow}

Associated with each block of a bundle is a block number. The block
number uniquely identifies the block within the bundle, enabling blocks
(notably Bundle Protocol Security blocks) to reference other blocks in
the same bundle without ambiguity. The block number of the primary block
is implicitly zero; the block numbers of all other blocks are explicitly
stated in block headers as noted below. Block numbering is unrelated to
the order in which blocks are sequenced in the bundle. The block number
of the payload block is always 1.[¶](#section-4.1-5){.pilcrow}

An implementation of the Bundle Protocol [MAY]{.bcp14} discard any
sequence of bytes that does not conform to the Bundle Protocol
specification.[¶](#section-4.1-6){.pilcrow}

An implementation of the Bundle Protocol [MAY]{.bcp14} accept a sequence
of bytes that does not conform to the Bundle Protocol specification
(e.g., one that represents data elements in fixed-length arrays rather
than indefinite-length arrays) and transform it into conformant BP
structure before processing it. Procedures for accomplishing such a
transformation are beyond the scope of this
specification.[¶](#section-4.1-7){.pilcrow}
:::
:::

::: {#sect-4.2}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [BP Fundamental Data Structures](#name-bp-fundamental-data-structu){.section-name .selfRef} {#name-bp-fundamental-data-structu}

::: {#sect-4.2.1}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [CRC Type](#name-crc-type){.section-name .selfRef} {#name-crc-type}

CRC type is an unsigned integer type code for which the following values
(and no others) are valid:[¶](#section-4.2.1-1){.pilcrow}

-   [0 indicates \"no Cyclic Redundancy Check (CRC) is
    present.\"[¶](#section-4.2.1-2.1){.pilcrow}]{#section-4.2.1-2.1}
-   [1 indicates \"a standard X-25 CRC-16 is present.\"
    \[[CRC16](#CRC16){.xref}\][¶](#section-4.2.1-2.2){.pilcrow}]{#section-4.2.1-2.2}
-   [2 indicates \"a standard CRC32C (Castagnoli) CRC-32 is present.\"
    \[[RFC4960](#RFC4960){.xref}\][¶](#section-4.2.1-2.3){.pilcrow}]{#section-4.2.1-2.3}

CRC type [SHALL]{.bcp14} be represented as a CBOR unsigned
integer.[¶](#section-4.2.1-3){.pilcrow}

For examples of CRC32C CRCs, see [Appendix
A.4](https://www.rfc-editor.org/rfc/rfc7143#appendix-A.4){.relref} of
\[[RFC7143](#RFC7143){.xref}\].[¶](#section-4.2.1-4){.pilcrow}

Note that more robust protection of BP data integrity, as needed, may be
provided by means of Block Integrity Blocks (BIBs) as defined in the
Bundle Protocol Security specification
\[[BPSEC](#RFC9172){.xref}\].[¶](#section-4.2.1-5){.pilcrow}
:::
:::

::: {#sect-4.2.2}
::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [CRC](#name-crc){.section-name .selfRef} {#name-crc}

The CRC [SHALL]{.bcp14} be omitted from a block if and only if the
block\'s CRC type code is zero.[¶](#section-4.2.2-1){.pilcrow}

When not omitted, the CRC [SHALL]{.bcp14} be represented as a CBOR byte
string of two bytes (that is, CBOR additional information 2, if CRC type
is 1) or of four bytes (that is, CBOR additional information 4, if CRC
type is 2); in each case, the sequence of bytes [SHALL]{.bcp14}
constitute an unsigned integer value (of 16 or 32 bits, respectively) in
network byte order.[¶](#section-4.2.2-2){.pilcrow}
:::
:::

::: {#sect-4.2.3}
::: {#section-4.2.3 .section}
#### [4.2.3.](#section-4.2.3){.section-number .selfRef} [Bundle Processing Control Flags](#name-bundle-processing-control-f){.section-name .selfRef} {#name-bundle-processing-control-f}

Bundle processing control flags assert properties of the bundle as a
whole rather than of any particular block of the bundle. They are
conveyed in the primary block of the
bundle.[¶](#section-4.2.3-1){.pilcrow}

The following properties are asserted by the bundle processing control
flags:[¶](#section-4.2.3-2){.pilcrow}

-   [The bundle is a fragment.
    (Boolean)[¶](#section-4.2.3-3.1){.pilcrow}]{#section-4.2.3-3.1}

-   [The bundle\'s payload is an administrative record.
    (Boolean)[¶](#section-4.2.3-3.2){.pilcrow}]{#section-4.2.3-3.2}

-   [The bundle must not be fragmented.
    (Boolean)[¶](#section-4.2.3-3.3){.pilcrow}]{#section-4.2.3-3.3}

-   [Acknowledgment by the user application is requested.
    (Boolean)[¶](#section-4.2.3-3.4){.pilcrow}]{#section-4.2.3-3.4}

-   [Status time is requested in all status reports.
    (Boolean)[¶](#section-4.2.3-3.5){.pilcrow}]{#section-4.2.3-3.5}

-   ::: {#section-4.2.3-3.6}
    Flags requesting types of status reports (all
    Boolean):[¶](#section-4.2.3-3.6.1){.pilcrow}

    -   [Request reporting of bundle
        reception.[¶](#section-4.2.3-3.6.2.1){.pilcrow}]{#section-4.2.3-3.6.2.1}
    -   [Request reporting of bundle
        forwarding.[¶](#section-4.2.3-3.6.2.2){.pilcrow}]{#section-4.2.3-3.6.2.2}
    -   [Request reporting of bundle
        delivery.[¶](#section-4.2.3-3.6.2.3){.pilcrow}]{#section-4.2.3-3.6.2.3}
    -   [Request reporting of bundle
        deletion.[¶](#section-4.2.3-3.6.2.4){.pilcrow}]{#section-4.2.3-3.6.2.4}
    :::

If the bundle processing control flags indicate that the bundle\'s ADU
is an administrative record, then all status report request flag values
[MUST]{.bcp14} be zero.[¶](#section-4.2.3-4){.pilcrow}

If the bundle\'s source node is omitted (i.e., the source node ID is the
ID of the null endpoint, which has no members as discussed below; this
option enables anonymous bundle transmission), then the bundle is not
uniquely identifiable and all Bundle Protocol features that rely on
bundle identity must therefore be disabled: the \"Bundle must not be
fragmented\" flag value [MUST]{.bcp14} be 1, and all status report
request flag values [MUST]{.bcp14} be
zero.[¶](#section-4.2.3-5){.pilcrow}

Bundle processing control flags that are unrecognized [MUST]{.bcp14} be
ignored, as future definitions of additional flags might not be
integrated simultaneously into the Bundle Protocol implementations
operating at all nodes.[¶](#section-4.2.3-6){.pilcrow}

The bundle processing control flags [SHALL]{.bcp14} be represented as a
CBOR unsigned integer item, the value of which [SHALL]{.bcp14} be
processed as a bit field indicating the control flag values as follows
(note that bit numbering in this instance is reversed from the usual
practice, beginning with the low-order bit instead of the high-order
bit, in recognition of the potential definition of additional control
flag values in the future):[¶](#section-4.2.3-7){.pilcrow}

[]{.break}

Bit 0 (the low-order bit, 0x000001):
:   Bundle is a fragment.[¶](#section-4.2.3-8.2){.pilcrow}
:   

Bit 1 (0x000002):
:   ADU is an administrative record.[¶](#section-4.2.3-8.4){.pilcrow}
:   

Bit 2 (0x000004):
:   Bundle must not be fragmented.[¶](#section-4.2.3-8.6){.pilcrow}
:   

Bit 3 (0x000008):
:   Reserved.[¶](#section-4.2.3-8.8){.pilcrow}
:   

Bit 4 (0x000010):
:   Reserved.[¶](#section-4.2.3-8.10){.pilcrow}
:   

Bit 5 (0x000020):
:   Acknowledgement by application is
    requested.[¶](#section-4.2.3-8.12){.pilcrow}
:   

Bit 6 (0x000040):
:   Status time requested in reports.[¶](#section-4.2.3-8.14){.pilcrow}
:   

Bit 7 (0x000080):
:   Reserved.[¶](#section-4.2.3-8.16){.pilcrow}
:   

Bit 8 (0x000100):
:   Reserved.[¶](#section-4.2.3-8.18){.pilcrow}
:   

Bit 9 (0x000200):
:   Reserved.[¶](#section-4.2.3-8.20){.pilcrow}
:   

Bit 10 (0x000400):
:   Reserved.[¶](#section-4.2.3-8.22){.pilcrow}
:   

Bit 11 (0x000800):
:   Reserved.[¶](#section-4.2.3-8.24){.pilcrow}
:   

Bit 12 (0x001000):
:   Reserved.[¶](#section-4.2.3-8.26){.pilcrow}
:   

Bit 13 (0x002000):
:   Reserved.[¶](#section-4.2.3-8.28){.pilcrow}
:   

Bit 14 (0x004000):
:   Request reporting of bundle
    reception.[¶](#section-4.2.3-8.30){.pilcrow}
:   

Bit 15 (0x008000):
:   Reserved.[¶](#section-4.2.3-8.32){.pilcrow}
:   

Bit 16 (0x010000):
:   Request reporting of bundle
    forwarding.[¶](#section-4.2.3-8.34){.pilcrow}
:   

Bit 17 (0x020000):
:   Request reporting of bundle
    delivery.[¶](#section-4.2.3-8.36){.pilcrow}
:   

Bit 18 (0x040000):
:   Request reporting of bundle
    deletion.[¶](#section-4.2.3-8.38){.pilcrow}
:   

Bits 19-20:
:   Reserved.[¶](#section-4.2.3-8.40){.pilcrow}
:   

Bits 21-63:
:   Unassigned.[¶](#section-4.2.3-8.42){.pilcrow}
:   
:::
:::

::: {#sect-4.2.4}
::: {#section-4.2.4 .section}
#### [4.2.4.](#section-4.2.4){.section-number .selfRef} [Block Processing Control Flags](#name-block-processing-control-fl){.section-name .selfRef} {#name-block-processing-control-fl}

The block processing control flags assert properties of canonical bundle
blocks. They are conveyed in the header of the block to which they
pertain.[¶](#section-4.2.4-1){.pilcrow}

Block processing control flags that are unrecognized [MUST]{.bcp14} be
ignored, as future definitions of additional flags might not be
integrated simultaneously into the Bundle Protocol implementations
operating at all nodes.[¶](#section-4.2.4-2){.pilcrow}

The block processing control flags [SHALL]{.bcp14} be represented as a
CBOR unsigned integer item, the value of which [SHALL]{.bcp14} be
processed as a bit field indicating the control flag values as follows
(note that bit numbering in this instance is reversed from the usual
practice, beginning with the low-order bit instead of the high-order
bit, for agreement with the bit numbering of the bundle processing
control flags):[¶](#section-4.2.4-3){.pilcrow}

[]{.break}

Bit 0 (the low-order bit, 0x01):
:   Block must be replicated in every
    fragment.[¶](#section-4.2.4-4.2){.pilcrow}
:   

Bit 1 (0x02):
:   Transmit status report if block can\'t be
    processed.[¶](#section-4.2.4-4.4){.pilcrow}
:   

Bit 2 (0x04):
:   Delete bundle if block can\'t be
    processed.[¶](#section-4.2.4-4.6){.pilcrow}
:   

Bit 3 (0x08):
:   Reserved.[¶](#section-4.2.4-4.8){.pilcrow}
:   

Bit 4 (0x10):
:   Discard block if it can\'t be
    processed.[¶](#section-4.2.4-4.10){.pilcrow}
:   

Bit 5 (0x20):
:   Reserved.[¶](#section-4.2.4-4.12){.pilcrow}
:   

Bit 6 (0x40):
:   Reserved.[¶](#section-4.2.4-4.14){.pilcrow}
:   

Bits 7-63:
:   Unassigned.[¶](#section-4.2.4-4.16){.pilcrow}
:   

For each bundle whose bundle processing control flags indicate that the
bundle\'s ADU is an administrative record, or whose source node ID is
the null endpoint ID as defined below, the value of the \"Transmit
status report if block can\'t be processed\" flag in every canonical
block of the bundle [MUST]{.bcp14} be
zero.[¶](#section-4.2.4-5){.pilcrow}
:::
:::

::: {#sect-4.2.5}
::: {#section-4.2.5 .section}
#### [4.2.5.](#section-4.2.5){.section-number .selfRef} [Identifiers](#name-identifiers){.section-name .selfRef} {#name-identifiers}

::: {#sect-4.2.5.1}
::: {#section-4.2.5.1 .section}
##### [4.2.5.1.](#section-4.2.5.1){.section-number .selfRef} [Endpoint ID](#name-endpoint-id){.section-name .selfRef} {#name-endpoint-id}

The destinations of bundles are bundle endpoints, identified by text
strings termed \"endpoint IDs\" (see [Section 3.1](#sect-3.1){.xref}).
Each endpoint ID (EID) is a Uniform Resource Identifier
\[[URI](#RFC3986){.xref}\]. As such, each endpoint ID can be
characterized as having this general
structure:[¶](#section-4.2.5.1-1){.pilcrow}

\< scheme name \> : \< scheme-specific part, or \"SSP\"
\>[¶](#section-4.2.5.1-2){.pilcrow}

The scheme identified by the \< scheme name \> in an endpoint ID is a
set of syntactic and semantic rules that fully explain how to parse and
interpret the scheme-specific part (SSP). Each scheme that may be used
to form a BP endpoint ID must be added to the \"Bundle Protocol URI
Scheme Types\" registry, maintained by IANA as described in [Section
9.6](#sect-9.6){.xref}; association of a unique URI scheme code number
with each scheme name in this registry helps to enable compact
representation of endpoint IDs in bundle blocks. Note that the set of
allowable schemes is effectively unlimited. Any scheme conforming to
\[[URIREG](#RFC7595){.xref}\] may be added to the registry of URI scheme
code numbers and thereupon used in a Bundle Protocol endpoint
ID.[¶](#section-4.2.5.1-3){.pilcrow}

Each entry in the registry of URI scheme code numbers [MUST]{.bcp14}
contain a reference to a scheme code number definition document, which
defines the manner in which the scheme-specific part of any URI formed
in that scheme is parsed and interpreted and [MUST]{.bcp14} be CBOR
encoded for transmission as a BP endpoint ID. The scheme code number
definition document may also contain information as to (a) which
convergence-layer protocol(s) may be used to forward a bundle to a BP
destination endpoint identified by such an ID and (b) how the ID of the
convergence-layer protocol endpoint to use for that purpose can be
inferred from that destination endpoint
ID.[¶](#section-4.2.5.1-4){.pilcrow}

Note that, although endpoint IDs are URIs, implementations of the BP
service interface may support expression of endpoint IDs in some
internationalized manner (e.g., Internationalized Resource Identifiers
(IRIs); see
\[[RFC3987](#RFC3987){.xref}\]).[¶](#section-4.2.5.1-5){.pilcrow}

Each BP endpoint ID (EID) [SHALL]{.bcp14} be represented as a CBOR array
comprising two items.[¶](#section-4.2.5.1-6){.pilcrow}

The first item of the array [SHALL]{.bcp14} be the code number
identifying the endpoint ID\'s URI scheme, as defined in the registry of
URI scheme code numbers for the Bundle Protocol. Each URI scheme code
number [SHALL]{.bcp14} be represented as a CBOR unsigned
integer.[¶](#section-4.2.5.1-7){.pilcrow}

The second item of the array [SHALL]{.bcp14} be the applicable CBOR
encoding of the scheme-specific part of the EID, defined as noted in the
references(s) for the URI scheme code number registry entry for the
EID\'s URI scheme.[¶](#section-4.2.5.1-8){.pilcrow}

::: {#sect-4.2.5.1.1}
::: {#section-4.2.5.1.1 .section}
###### [4.2.5.1.1.](#section-4.2.5.1.1){.section-number .selfRef} [The dtn URI Scheme](#name-the-dtn-uri-scheme){.section-name .selfRef} {#name-the-dtn-uri-scheme}

The \"dtn\" scheme supports the identification of BP endpoints by
arbitrarily expressive character strings. It is specified as
follows:[¶](#section-4.2.5.1.1-1){.pilcrow}

[]{.break}

Scheme syntax:
:   This specification uses the Augmented Backus-Naur Form (ABNF)
    notation of
    \[[RFC5234](#RFC5234){.xref}\].[¶](#section-4.2.5.1.1-2.2){.pilcrow}
:   

::: {#section-4.2.5.1.1-3}
``` {.lang-abnf .sourcecode}
dtn-uri = "dtn:" ("none" / dtn-hier-part)

dtn-hier-part = "//" node-name name-delim demux ; a path-rootless

node-name = reg-name

name-delim = "/"

demux = *VCHAR
```

[¶](#section-4.2.5.1.1-3){.pilcrow}
:::

[]{.break}

Scheme semantics:
:   URIs of the dtn scheme are used as endpoint identifiers in the
    Delay-Tolerant Networking (DTN) Bundle Protocol (BP) as described in
    the present document.[¶](#section-4.2.5.1.1-4.2){.pilcrow}
:   

The endpoint ID \"dtn:none\" identifies the \"null endpoint\", the
endpoint that by definition never has any
members.[¶](#section-4.2.5.1.1-5){.pilcrow}

All BP endpoints identified by all other dtn-scheme endpoint IDs for
which the first character of demux is a character other than \'\~\'
(tilde) are singleton endpoints. All BP endpoints identified by
dtn-scheme endpoint IDs for which the first character **is** \'\~\'
(tilde) are **not** singleton
endpoints.[¶](#section-4.2.5.1.1-6){.pilcrow}

A dtn-scheme endpoint ID for which the demux is of length zero
[MAY]{.bcp14} identify the administrative endpoint for the node
identified by node-name, and as such may serve as a node ID. No
dtn-scheme endpoint ID for which the demux is of non-zero length may do
so.[¶](#section-4.2.5.1.1-7){.pilcrow}

Note that these syntactic rules impose constraints on dtn-scheme
endpoint IDs that were not imposed by the original specification of the
dtn scheme as provided in \[[RFC5050](#RFC5050){.xref}\]. It is believed
that the dtn-scheme endpoint IDs employed by BP applications conforming
to \[[RFC5050](#RFC5050){.xref}\] are in most cases unlikely to be in
violation of these rules, but the developers of such applications are
advised of the potential for compromised
interoperation.[¶](#section-4.2.5.1.1-8){.pilcrow}

[]{.break}

Encoding considerations:
:   For transmission as a BP endpoint ID, the scheme-specific part of a
    URI of the dtn scheme [SHALL]{.bcp14} be represented as a CBOR text
    string unless the EID\'s SSP is \"none\", in which case the SSP
    [SHALL]{.bcp14} be represented as a CBOR unsigned integer with the
    value zero. For all other purposes, URIs of the dtn scheme are
    encoded exclusively in US-ASCII
    characters.[¶](#section-4.2.5.1.1-9.2){.pilcrow}
:   

Interoperability considerations:
:   None.[¶](#section-4.2.5.1.1-9.4){.pilcrow}
:   

Security considerations:

:   \

    []{.break}

    Reliability and consistency:
    :   None of the BP endpoints identified by the URIs of the dtn
        scheme are guaranteed to be reachable at any time, and the
        identity of the processing entities operating on those endpoints
        is never guaranteed by the Bundle Protocol itself. Verification
        of the signature provided by the Block Integrity Block targeting
        the bundle\'s primary block, as defined by Bundle Protocol
        Security \[[BPSEC](#RFC9172){.xref}\], is required for this
        purpose.[¶](#section-4.2.5.1.1-9.6.2.2){.pilcrow}
    :   

    Malicious construction:
    :   Malicious construction of a conformant dtn-scheme URI is limited
        to the malicious selection of node names and the malicious
        selection of demux strings. That is, a maliciously constructed
        dtn-scheme URI could be used to direct a bundle to an endpoint
        that might be damaged by the arrival of that bundle or,
        alternatively, to declare a false source for a bundle and
        thereby cause incorrect processing at a node that receives the
        bundle. In both cases (and indeed in all bundle processing), the
        node that receives a bundle should verify its authenticity and
        validity before operating on it in any
        way.[¶](#section-4.2.5.1.1-9.6.2.4){.pilcrow}
    :   

    Back-end transcoding:
    :   The limited expressiveness of URIs of the dtn scheme effectively
        eliminates the possibility of threat due to errors in back-end
        transcoding.[¶](#section-4.2.5.1.1-9.6.2.6){.pilcrow}
    :   

    Rare IP address formats:
    :   Not relevant, as IP addresses do not appear anywhere in
        conformant dtn-scheme
        URIs.[¶](#section-4.2.5.1.1-9.6.2.8){.pilcrow}
    :   

    Sensitive information:
    :   Because dtn-scheme URIs are used only to represent the
        identities of Bundle Protocol endpoints, the risk of disclosure
        of sensitive information due to interception of these URIs is
        minimal. Examination of dtn-scheme URIs could be used to support
        traffic analysis; where traffic analysis is a plausible danger,
        bundles should be conveyed by secure convergence-layer protocols
        that do not expose endpoint
        IDs.[¶](#section-4.2.5.1.1-9.6.2.10){.pilcrow}
    :   

    Semantic attacks:
    :   The simplicity of dtn-scheme URI syntax minimizes the
        possibility of misinterpretation of a URI by a human
        user.[¶](#section-4.2.5.1.1-9.6.2.12){.pilcrow}
    :   

:   
:::
:::

::: {#sect-4.2.5.1.2}
::: {#section-4.2.5.1.2 .section}
###### [4.2.5.1.2.](#section-4.2.5.1.2){.section-number .selfRef} [The ipn URI Scheme](#name-the-ipn-uri-scheme){.section-name .selfRef} {#name-the-ipn-uri-scheme}

The \"ipn\" scheme supports the identification of BP endpoints by pairs
of unsigned integers, for compact representation in bundle blocks. It is
specified as follows:[¶](#section-4.2.5.1.2-1){.pilcrow}

[]{.break}

Scheme syntax:
:   This specification uses the Augmented Backus-Naur Form (ABNF)
    notation of \[[RFC5234](#RFC5234){.xref}\], including the core ABNF
    syntax rule for DIGIT defined by that
    specification.[¶](#section-4.2.5.1.2-2.2){.pilcrow}
:   

::: {#section-4.2.5.1.2-3}
``` {.lang-abnf .sourcecode}
ipn-uri = "ipn:" ipn-hier-part

ipn-hier-part = node-nbr nbr-delim service-nbr ; a path-rootless

node-nbr = 1*DIGIT

nbr-delim = "."

service-nbr = 1*DIGIT
```

[¶](#section-4.2.5.1.2-3){.pilcrow}
:::

[]{.break}

Scheme semantics:
:   URIs of the ipn scheme are used as endpoint identifiers in the
    Delay-Tolerant Networking (DTN) Bundle Protocol (BP) as described in
    the present document.[¶](#section-4.2.5.1.2-4.2){.pilcrow}
:   

All BP endpoints identified by ipn-scheme endpoint IDs are singleton
endpoints.[¶](#section-4.2.5.1.2-5){.pilcrow}

An ipn-scheme endpoint ID for which service-nbr is zero [MAY]{.bcp14}
identify the administrative endpoint for the node identified by
node-nbr, and as such may serve as a node ID. No ipn-scheme endpoint ID
for which service-nbr is non-zero may do
so.[¶](#section-4.2.5.1.2-6){.pilcrow}

[]{.break}

Encoding considerations:
:   For transmission as a BP endpoint ID, the scheme-specific part of a
    URI of the ipn scheme [SHALL]{.bcp14} be represented as a CBOR array
    comprising two items. The first item of this array [SHALL]{.bcp14}
    be the EID\'s node number (a number that identifies the node)
    represented as a CBOR unsigned integer. The second item of this
    array [SHALL]{.bcp14} be the EID\'s service number (a number that
    identifies some application service) represented as a CBOR unsigned
    integer. For all other purposes, URIs of the ipn scheme are encoded
    exclusively in US-ASCII
    characters.[¶](#section-4.2.5.1.2-7.2){.pilcrow}
:   

Interoperability considerations:
:   None.[¶](#section-4.2.5.1.2-7.4){.pilcrow}
:   

Security considerations:

:   \

    []{.break}

    Reliability and consistency:
    :   None of the BP endpoints identified by the URIs of the ipn
        scheme are guaranteed to be reachable at any time, and the
        identity of the processing entities operating on those endpoints
        is never guaranteed by the Bundle Protocol itself. Verification
        of the signature provided by the Block Integrity Block targeting
        the bundle\'s primary block, as defined by Bundle Protocol
        Security \[[BPSEC](#RFC9172){.xref}\], is required for this
        purpose.[¶](#section-4.2.5.1.2-7.6.2.2){.pilcrow}
    :   

    Malicious construction:
    :   Malicious construction of a conformant ipn-scheme URI is limited
        to the malicious selection of node numbers and the malicious
        selection of service numbers. That is, a maliciously constructed
        ipn-scheme URI could be used to direct a bundle to an endpoint
        that might be damaged by the arrival of that bundle or,
        alternatively, to declare a false source for a bundle and
        thereby cause incorrect processing at a node that receives the
        bundle. In both cases (and indeed in all bundle processing), the
        node that receives a bundle should verify its authenticity and
        validity before operating on it in any
        way.[¶](#section-4.2.5.1.2-7.6.2.4){.pilcrow}
    :   

    Back-end transcoding:
    :   The limited expressiveness of URIs of the ipn scheme effectively
        eliminates the possibility of threat due to errors in back-end
        transcoding.[¶](#section-4.2.5.1.2-7.6.2.6){.pilcrow}
    :   

    Rare IP address formats:
    :   Not relevant, as IP addresses do not appear anywhere in
        conformant ipn-scheme
        URIs.[¶](#section-4.2.5.1.2-7.6.2.8){.pilcrow}
    :   

    Sensitive information:
    :   Because ipn-scheme URIs are used only to represent the
        identities of Bundle Protocol endpoints, the risk of disclosure
        of sensitive information due to interception of these URIs is
        minimal. Examination of ipn-scheme URIs could be used to support
        traffic analysis; where traffic analysis is a plausible danger,
        bundles should be conveyed by secure convergence-layer protocols
        that do not expose endpoint
        IDs.[¶](#section-4.2.5.1.2-7.6.2.10){.pilcrow}
    :   

    Semantic attacks:
    :   The simplicity of ipn-scheme URI syntax minimizes the
        possibility of misinterpretation of a URI by a human
        user.[¶](#section-4.2.5.1.2-7.6.2.12){.pilcrow}
    :   

:   
:::
:::
:::
:::

::: {#sect-4.2.5.2}
::: {#section-4.2.5.2 .section}
##### [4.2.5.2.](#section-4.2.5.2){.section-number .selfRef} [Node ID](#name-node-id){.section-name .selfRef} {#name-node-id}

For many purposes of the Bundle Protocol, it is important to identify
the node that is operative in some
context.[¶](#section-4.2.5.2-1){.pilcrow}

As discussed in [Section 3.1](#sect-3.1){.xref}, nodes are distinct from
endpoints; specifically, an endpoint is a set of zero or more nodes. But
rather than define a separate namespace for node identifiers, we instead
use endpoint identifiers to identify nodes as discussed in [Section
3.2](#sect-3.2){.xref}. Formally:[¶](#section-4.2.5.2-2){.pilcrow}

-   [Every node is, by definition, permanently registered in the
    singleton endpoint at which administrative records are delivered to
    its application agent\'s administrative element, termed the node\'s
    \"administrative
    endpoint\".[¶](#section-4.2.5.2-3.1){.pilcrow}]{#section-4.2.5.2-3.1}
-   [As such, the EID of a node\'s administrative endpoint
    [SHALL]{.bcp14} uniquely identify that
    node.[¶](#section-4.2.5.2-3.2){.pilcrow}]{#section-4.2.5.2-3.2}
-   [The EID of any singleton endpoint is allowed to serve as a \"node
    ID\" identifying the node that is the sole member of that
    endpoint.[¶](#section-4.2.5.2-3.3){.pilcrow}]{#section-4.2.5.2-3.3}
:::
:::
:::
:::

::: {#sect-4.2.6}
::: {#section-4.2.6 .section}
#### [4.2.6.](#section-4.2.6){.section-number .selfRef} [DTN Time](#name-dtn-time){.section-name .selfRef} {#name-dtn-time}

A DTN time is an unsigned integer indicating the number of milliseconds
that have elapsed since the DTN Epoch, 2000-01-01 00:00:00 +0000 (UTC).
DTN time is not affected by leap seconds.[¶](#section-4.2.6-1){.pilcrow}

Each DTN time [SHALL]{.bcp14} be represented as a CBOR unsigned integer
item. Implementers need to be aware that DTN time values conveyed in
CBOR encoding in bundles will nearly always exceed (2^32^ - 1); the
manner in which a DTN time value is represented in memory is an
implementation matter. The DTN time value zero indicates that the time
is unknown.[¶](#section-4.2.6-2){.pilcrow}
:::
:::

::: {#sect-4.2.7}
::: {#section-4.2.7 .section}
#### [4.2.7.](#section-4.2.7){.section-number .selfRef} [Creation Timestamp](#name-creation-timestamp){.section-name .selfRef} {#name-creation-timestamp}

Each bundle\'s creation timestamp [SHALL]{.bcp14} be represented as a
CBOR array comprising two items.[¶](#section-4.2.7-1){.pilcrow}

The first item of the array, termed \"bundle creation time\",
[SHALL]{.bcp14} be the DTN time at which the transmission request was
received that resulted in the creation of the bundle, represented as a
CBOR unsigned integer.[¶](#section-4.2.7-2){.pilcrow}

The second item of the array, termed the creation timestamp\'s
\"sequence number\", [SHALL]{.bcp14} be the latest value (as of the time
at which the transmission request was received) of a monotonically
increasing positive integer counter managed by the source node\'s BPA,
represented as a CBOR unsigned integer. The sequence counter
[MAY]{.bcp14} be reset to zero whenever the current time advances by one
millisecond.[¶](#section-4.2.7-3){.pilcrow}

For nodes that lack accurate clocks, it is recommended that bundle
creation time be set to zero and that the counter used as the source of
the bundle sequence count never be reset to
zero.[¶](#section-4.2.7-4){.pilcrow}

Note that, in general, the creation of two distinct bundles with the
same source node ID and bundle creation timestamp may result in
unexpected network behavior and/or suboptimal performance. The
combination of source node ID and bundle creation timestamp serves to
identify a single transmission request, enabling it to be acknowledged
by the receiving application (provided the source node ID is not the
null endpoint ID).[¶](#section-4.2.7-5){.pilcrow}
:::
:::

::: {#sect-4.2.8}
::: {#section-4.2.8 .section}
#### [4.2.8.](#section-4.2.8){.section-number .selfRef} [Block-Type-Specific Data](#name-block-type-specific-data){.section-name .selfRef} {#name-block-type-specific-data}

Block-type-specific data in each block (other than the primary block)
[SHALL]{.bcp14} be the applicable CBOR encoding of the content of the
block. Details of this representation are included in the specification
defining the block type.[¶](#section-4.2.8-1){.pilcrow}
:::
:::
:::
:::

::: {#sect-4.3}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Block Structures](#name-block-structures){.section-name .selfRef} {#name-block-structures}

This section describes the primary block in detail and non-primary
blocks in general. Rules for processing these blocks appear in [Section
5](#sect-5){.xref}.[¶](#section-4.3-1){.pilcrow}

Note that supplementary DTN protocol specifications (including, but not
restricted to, Bundle Protocol Security \[[BPSEC](#RFC9172){.xref}\])
may require that BP implementations conforming to those protocols
construct and process additional blocks.[¶](#section-4.3-2){.pilcrow}

::: {#sect-4.3.1}
::: {#section-4.3.1 .section}
#### [4.3.1.](#section-4.3.1){.section-number .selfRef} [Primary Bundle Block](#name-primary-bundle-block){.section-name .selfRef} {#name-primary-bundle-block}

The primary bundle block contains the basic information needed to
forward bundles to their destinations.[¶](#section-4.3.1-1){.pilcrow}

Each primary block [SHALL]{.bcp14} be represented as a CBOR array; the
number of elements in the array [SHALL]{.bcp14} be 8 (if the bundle is
not a fragment and the block has no CRC), 9 (if the block has a CRC and
the bundle is not a fragment), 10 (if the bundle is a fragment and the
block has no CRC), or 11 (if the bundle is a fragment and the block has
a CRC).[¶](#section-4.3.1-2){.pilcrow}

The primary block of each bundle [SHALL]{.bcp14} be immutable. The CBOR-
encoded values of all fields in the primary block [MUST]{.bcp14} remain
unchanged from the time the block is created to the time it is
delivered.[¶](#section-4.3.1-3){.pilcrow}

The fields of the primary bundle block [SHALL]{.bcp14} be as follows,
listed in the order in which they [MUST]{.bcp14}
appear:[¶](#section-4.3.1-4){.pilcrow}

[]{.break}

Version:
:   An unsigned integer value indicating the version of the Bundle
    Protocol that constructed this block. The present document describes
    BPv7. This version number [SHALL]{.bcp14} be represented as a CBOR
    unsigned integer item.[¶](#section-4.3.1-5.2){.pilcrow}
:   

Bundle Processing Control Flags:
:   The bundle processing control flags are discussed in [Section
    4.2.3](#sect-4.2.3){.xref}.[¶](#section-4.3.1-5.4){.pilcrow}
:   

CRC Type:
:   CRC type codes are discussed in [Section 4.2.1](#sect-4.2.1){.xref}.
    The CRC type code for the primary block [MAY]{.bcp14} be zero if the
    bundle contains a BPSec Block Integrity Block
    \[[BPSEC](#RFC9172){.xref}\] whose target is the primary block;
    otherwise, the CRC type code for the primary block [MUST]{.bcp14} be
    non-zero.[¶](#section-4.3.1-5.6){.pilcrow}
:   

Destination EID:
:   The Destination EID field identifies the bundle endpoint that is the
    bundle\'s destination, i.e., the endpoint that contains the node(s)
    at which the bundle is to be
    delivered.[¶](#section-4.3.1-5.8){.pilcrow}
:   

Source node ID:
:   The Source node ID field identifies the bundle node at which the
    bundle was initially transmitted, except that source node ID may be
    the null endpoint ID in the event that the bundle\'s source chooses
    to remain anonymous.[¶](#section-4.3.1-5.10){.pilcrow}
:   

Report-to EID:
:   The Report-to EID field identifies the bundle endpoint to which
    status reports pertaining to the forwarding and delivery of this
    bundle are to be transmitted.[¶](#section-4.3.1-5.12){.pilcrow}
:   

Creation Timestamp:
:   The creation timestamp comprises two unsigned integers that,
    together with the source node ID and (if the bundle is a fragment)
    the fragment offset and payload length, serve to identify the
    bundle. See [Section 4.2.7](#sect-4.2.7){.xref} for the definition
    of this field.[¶](#section-4.3.1-5.14){.pilcrow}
:   

Lifetime:

:   The Lifetime field is an unsigned integer that indicates the time at
    which the bundle\'s payload will no longer be useful, encoded as a
    number of milliseconds past the creation time. (For high-rate
    deployments with very brief disruptions, fine-grained expression of
    bundle lifetime may be useful.) When a bundle\'s age exceeds its
    lifetime, bundle nodes need no longer retain or forward the bundle;
    the bundle [SHOULD]{.bcp14} be deleted from the
    network.[¶](#section-4.3.1-5.16.1){.pilcrow}

    If the asserted lifetime for a received bundle is so lengthy that
    retention of the bundle until its expiration time might degrade
    operation of the node at which the bundle is received, or if the BPA
    of that node determines that the bundle must be deleted in order to
    prevent network performance degradation (e.g., the bundle appears to
    be part of a denial-of-service attack), then that BPA [MAY]{.bcp14}
    impose a temporary overriding lifetime of shorter duration; such an
    overriding lifetime [SHALL NOT]{.bcp14} replace the lifetime
    asserted in the bundle but [SHALL]{.bcp14} serve as the bundle\'s
    effective lifetime while the bundle resides at that node. Procedures
    for imposing lifetime overrides are beyond the scope of this
    specification.[¶](#section-4.3.1-5.16.2){.pilcrow}

    For bundles originating at nodes that lack accurate clocks, it is
    recommended that bundle age be obtained from the Bundle Age
    extension block (see [Section 4.4.2](#sect-4.4.2){.xref}) rather
    than from the difference between current time and bundle creation
    time. Bundle lifetime [SHALL]{.bcp14} be represented as a CBOR
    unsigned integer item.[¶](#section-4.3.1-5.16.3){.pilcrow}

:   

Fragment offset:
:   If and only if the bundle processing control flags of this primary
    block indicate that the bundle is a fragment, fragment offset
    [SHALL]{.bcp14} be present in the primary block. Fragment offset
    [SHALL]{.bcp14} be represented as a CBOR unsigned integer indicating
    the offset from the start of the original ADU at which the bytes
    comprising the payload of this bundle were
    located.[¶](#section-4.3.1-5.18){.pilcrow}
:   

Total Application Data Unit Length:
:   If and only if the bundle processing control flags of this primary
    block indicate that the bundle is a fragment, total application data
    unit length [SHALL]{.bcp14} be present in the primary block. Total
    application data unit length [SHALL]{.bcp14} be represented as a
    CBOR unsigned integer indicating the total length of the original
    ADU of which this bundle\'s payload is a
    part.[¶](#section-4.3.1-5.20){.pilcrow}
:   

CRC:
:   A CRC [SHALL]{.bcp14} be present in the primary block unless the
    bundle includes a BPSec Block Integrity Block
    \[[BPSEC](#RFC9172){.xref}\] whose target is the primary block, in
    which case a CRC [MAY]{.bcp14} be present in the primary block. The
    length and nature of the CRC [SHALL]{.bcp14} be as indicated by the
    CRC type. The CRC [SHALL]{.bcp14} be computed over the concatenation
    of all bytes (including CBOR \"break\" characters) of the primary
    block including the CRC field itself, which, for this purpose,
    [SHALL]{.bcp14} be temporarily populated with all bytes set to
    zero.[¶](#section-4.3.1-5.22){.pilcrow}
:   
:::
:::

::: {#sect-4.3.2}
::: {#section-4.3.2 .section}
#### [4.3.2.](#section-4.3.2){.section-number .selfRef} [Canonical Bundle Block Format](#name-canonical-bundle-block-form){.section-name .selfRef} {#name-canonical-bundle-block-form}

Every block other than the primary block (all such blocks are termed
\"canonical\" blocks) [SHALL]{.bcp14} be represented as a CBOR array;
the number of elements in the array [SHALL]{.bcp14} be 5 (if CRC type is
zero) or 6 (otherwise).[¶](#section-4.3.2-1){.pilcrow}

The fields of every canonical block [SHALL]{.bcp14} be as follows,
listed in the order in which they [MUST]{.bcp14}
appear:[¶](#section-4.3.2-2){.pilcrow}

[]{.break}

Block type code:
:   An unsigned integer. Bundle block type code 1 indicates that the
    block is a Bundle Payload Block. Other block type codes are
    described in [Section 9.1](#sect-9.1){.xref}. Block type codes 192
    through 255 are not reserved and are available for private and/or
    experimental use. All other block type code values are reserved for
    future use.[¶](#section-4.3.2-3.2){.pilcrow}
:   

Block number:
:   An unsigned integer as discussed in [Section 4.1](#sect-4.1){.xref}.
    The block number [SHALL]{.bcp14} be represented as a CBOR unsigned
    integer.[¶](#section-4.3.2-3.4){.pilcrow}
:   

Block processing control flags:
:   As discussed in [Section
    4.2.4](#sect-4.2.4){.xref}.[¶](#section-4.3.2-3.6){.pilcrow}
:   

CRC type:
:   As discussed in [Section
    4.2.1](#sect-4.2.1){.xref}.[¶](#section-4.3.2-3.8){.pilcrow}
:   

Block-type-specific data:
:   Represented as a single definite-length CBOR byte string, i.e., a
    CBOR byte string that is not of indefinite length. For each type of
    block, the block-type-specific data byte string is the
    serialization, in a block-type-specific manner, of the data conveyed
    by that type of block; definitions of blocks are required to define
    the manner in which block-type-specific data are serialized within
    the block-type-specific data field. For the Bundle Payload Block in
    particular (block type 1), the block-type-specific data field,
    termed the \"payload\", [SHALL]{.bcp14} be an ADU, or some
    contiguous extent thereof, represented as a definite-length CBOR
    byte string.[¶](#section-4.3.2-3.10){.pilcrow}
:   

If and only if the value of the CRC type field of this block is non-zero:
:   A CRC. If present, the length and nature of the CRC [SHALL]{.bcp14}
    be as indicated by the CRC type and the CRC [SHALL]{.bcp14} be
    computed over the concatenation of all bytes of the block (including
    CBOR \"break\" characters) including the CRC field itself, which,
    for this purpose, [SHALL]{.bcp14} be temporarily populated with all
    bytes set to zero.[¶](#section-4.3.2-3.12){.pilcrow}
:   
:::
:::
:::
:::

::: {#sect-4.4}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Extension Blocks](#name-extension-blocks){.section-name .selfRef} {#name-extension-blocks}

\"Extension blocks\" are all blocks other than the primary and payload
blocks. Three types of extension blocks are defined below. All
implementations of the Bundle Protocol specification (the present
document) [MUST]{.bcp14} include procedures for recognizing, parsing,
and acting on, but not necessarily producing, these types of extension
blocks.[¶](#section-4.4-1){.pilcrow}

The specifications for additional types of extension blocks must
indicate whether or not BP implementations conforming to those
specifications must recognize, parse, act on, and/or produce blocks of
those types. As not all nodes will necessarily instantiate BP
implementations that conform to those additional specifications, it is
possible for a node to receive a bundle that includes extension blocks
that the node cannot process. The values of the block processing control
flags indicate the action to be taken by the BPA when this is the
case.[¶](#section-4.4-2){.pilcrow}

No mandated procedure in this specification is unconditionally dependent
on the absence or presence of any extension block. Therefore, any BPA
[MAY]{.bcp14} insert or remove any extension block in any bundle,
subject to all mandates in the Bundle Protocol specification and all
extension block specifications to which the node\'s BP implementation
conforms. Note that removal of an extension block will probably disable
one or more elements of bundle processing that were intended by the BPA
that inserted that block. In particular, note that removal of an
extension block that is one of the targets of a BPSec security block may
render the bundle unverifiable.[¶](#section-4.4-3){.pilcrow}

The following extension blocks are defined in the current
document.[¶](#section-4.4-4){.pilcrow}

::: {#sect-4.4.1}
::: {#section-4.4.1 .section}
#### [4.4.1.](#section-4.4.1){.section-number .selfRef} [Previous Node](#name-previous-node){.section-name .selfRef} {#name-previous-node}

The Previous Node Block, block type 6, identifies the node that
forwarded this bundle to the local node (i.e., to the node at which the
bundle currently resides); its block-type-specific data is the node ID
of that forwarder node. That node ID [SHALL]{.bcp14} conform to [Section
4.2.5.2](#sect-4.2.5.2){.xref}. If the local node is the source of the
bundle, then the bundle [MUST NOT]{.bcp14} contain any Previous Node
Block. Otherwise, the bundle [SHOULD]{.bcp14} contain one (1) occurrence
of this type of block and [MUST NOT]{.bcp14} contain more than
one.[¶](#section-4.4.1-1){.pilcrow}
:::
:::

::: {#sect-4.4.2}
::: {#section-4.4.2 .section}
#### [4.4.2.](#section-4.4.2){.section-number .selfRef} [Bundle Age](#name-bundle-age){.section-name .selfRef} {#name-bundle-age}

The Bundle Age Block, block type 7, contains the number of milliseconds
that have elapsed between the time the bundle was created and the time
at which it was most recently forwarded. It is intended for use by nodes
lacking access to an accurate clock, to aid in determining the time at
which a bundle\'s lifetime expires. The block-type-specific data of this
block is an unsigned integer containing the age of the bundle in
milliseconds, which [SHALL]{.bcp14} be represented as a CBOR unsigned
integer item. (The age of the bundle is the sum of all known intervals
of the bundle\'s residence at forwarding nodes, up to the time at which
the bundle was most recently forwarded, plus the summation of signal
propagation time over all episodes of transmission between forwarding
nodes. Determination of these values is an implementation matter.) If
the bundle\'s creation time is zero, then the bundle [MUST]{.bcp14}
contain exactly one (1) occurrence of this type of block; otherwise, the
bundle [MAY]{.bcp14} contain at most one (1) occurrence of this type of
block. A bundle [MUST NOT]{.bcp14} contain multiple occurrences of the
Bundle Age Block, as this could result in processing
anomalies.[¶](#section-4.4.2-1){.pilcrow}
:::
:::

::: {#sect-4.4.3}
::: {#section-4.4.3 .section}
#### [4.4.3.](#section-4.4.3){.section-number .selfRef} [Hop Count](#name-hop-count){.section-name .selfRef} {#name-hop-count}

The Hop Count Block, block type 10, contains two unsigned integers: hop
limit and hop count. A \"hop\" is here defined as an occasion on which a
bundle was forwarded from one node to another node. The hop limit
[MUST]{.bcp14} be in the range 1 through 255. The hop limit value
[SHOULD NOT]{.bcp14} be changed at any time after creation of the Hop
Count Block; the hop count value [SHOULD]{.bcp14} initially be zero and
[SHOULD]{.bcp14} be increased by 1 on each
hop.[¶](#section-4.4.3-1){.pilcrow}

The Hop Count Block is mainly intended as a safety mechanism, a means of
identifying bundles for removal from the network that can never be
delivered due to a persistent forwarding error. The hop count is
particularly valuable as a defense against routing anomalies that might
cause a bundle to be forwarded in a cyclical \"ping-pong\" fashion
between two nodes. When a bundle\'s hop count exceeds its hop limit, the
bundle [SHOULD]{.bcp14} be deleted for the reason \"Hop limit
exceeded\", following the Bundle Deletion procedure defined in [Section
5.10](#sect-5.10){.xref}.[¶](#section-4.4.3-2){.pilcrow}

Procedures for determining the appropriate hop limit for a bundle are
beyond the scope of this specification.[¶](#section-4.4.3-3){.pilcrow}

The block-type-specific data in a Hop Count Block [SHALL]{.bcp14} be
represented as a CBOR array comprising two items. The first item of this
array [SHALL]{.bcp14} be the bundle\'s hop limit, represented as a CBOR
unsigned integer. The second item of this array [SHALL]{.bcp14} be the
bundle\'s hop count, represented as a CBOR unsigned integer. A bundle
[MAY]{.bcp14} contain one occurrence of this type of block but [MUST
NOT]{.bcp14} contain more than one.[¶](#section-4.4.3-4){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#sect-5}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Bundle Processing](#name-bundle-processing){.section-name .selfRef} {#name-bundle-processing}

The bundle-processing procedures mandated in this section and in
[Section 6](#sect-6){.xref} govern the operation of the BPA and the
application agent administrative element of each bundle node. They are
neither exhaustive nor exclusive. Supplementary DTN protocol
specifications (including, but not restricted to, Bundle Protocol
Security \[[BPSEC](#RFC9172){.xref}\]) may augment, override, or
supersede the mandates of this document.[¶](#section-5-1){.pilcrow}

::: {#sect-5.1}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Generation of Administrative Records](#name-generation-of-administrativ){.section-name .selfRef} {#name-generation-of-administrativ}

All transmission of bundles is in response to bundle transmission
requests presented by nodes\' application agents. When required to
\"generate\" an administrative record (such as a bundle status report),
the BPA itself is responsible for causing a new bundle to be
transmitted, conveying that record. In concept, the BPA discharges this
responsibility by directing the administrative element of the node\'s
application agent to construct the record and request its transmission
as detailed in [Section 6](#sect-6){.xref}. In practice, the manner in
which administrative record generation is accomplished is an
implementation matter, provided the constraints noted in [Section
6](#sect-6){.xref} are observed.[¶](#section-5.1-1){.pilcrow}

Status reports are relatively small bundles. Moreover, even when the
generation of status reports is enabled, the decision on whether or not
to generate a requested status report is left to the discretion of the
BPA. Nonetheless, note that requesting status reports for any single
bundle might easily result in the generation of (1 + (2 \*(N-1))) status
report bundles, where N is the number of nodes on the path from the
bundle\'s source to its destination, inclusive. That is, the requesting
of status reports for large numbers of bundles could result in an
unacceptable increase in the bundle traffic in the network. For this
reason, the generation of status reports [MUST]{.bcp14} be disabled by
default and enabled only when the risk of excessive network traffic is
deemed acceptable. Mechanisms that could assist in assessing and
mitigating this risk, such as pre-placed agreements authorizing the
generation of status reports under specified circumstances, are beyond
the scope of this specification.[¶](#section-5.1-2){.pilcrow}

Notes on administrative record terminology:[¶](#section-5.1-3){.pilcrow}

-   [A \"bundle reception status report\" is a bundle status report with
    the \"Reporting node received bundle\" flag set to
    1.[¶](#section-5.1-4.1){.pilcrow}]{#section-5.1-4.1}
-   [A \"bundle forwarding status report\" is a bundle status report
    with the \"Reporting node forwarded the bundle\" flag set to
    1.[¶](#section-5.1-4.2){.pilcrow}]{#section-5.1-4.2}
-   [A \"bundle delivery status report\" is a bundle status report with
    the \"Reporting node delivered the bundle\" flag set to
    1.[¶](#section-5.1-4.3){.pilcrow}]{#section-5.1-4.3}
-   [A \"bundle deletion status report\" is a bundle status report with
    the \"Reporting node deleted the bundle\" flag set to
    1.[¶](#section-5.1-4.4){.pilcrow}]{#section-5.1-4.4}
:::
:::

::: {#sect-5.2}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Bundle Transmission](#name-bundle-transmission){.section-name .selfRef} {#name-bundle-transmission}

The steps in processing a bundle transmission request are as
follows:[¶](#section-5.2-1){.pilcrow}

[]{.break}

Step 1:
:   Transmission of the bundle is initiated. An outbound bundle
    [MUST]{.bcp14} be created per the parameters of the bundle
    transmission request, with the retention constraint \"Dispatch
    pending\". The source node ID of the bundle [MUST]{.bcp14} be
    either (a) the null endpoint ID, indicating that the source of the
    bundle is anonymous or (b) the EID of a singleton endpoint whose
    only member is the node of which the BPA is a
    component.[¶](#section-5.2-2.1){.pilcrow}
:   

Step 2:
:   Processing proceeds from Step 1 of [Section
    5.4](#sect-5.4){.xref}.[¶](#section-5.2-2.2){.pilcrow}
:   
:::
:::

::: {#sect-5.3}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Bundle Dispatching](#name-bundle-dispatching){.section-name .selfRef} {#name-bundle-dispatching}

(Note that this procedure is initiated only following completion of Step
4 of [Section 5.6](#sect-5.6){.xref}.)[¶](#section-5.3-1){.pilcrow}

The steps in dispatching a bundle are as
follows:[¶](#section-5.3-2){.pilcrow}

[]{.break}

Step 1:
:   If the bundle\'s destination endpoint is an endpoint of which the
    node is a member, the Bundle Delivery procedure defined in [Section
    5.7](#sect-5.7){.xref} [MUST]{.bcp14} be followed and, for the
    purposes of all subsequent processing of this bundle at this node,
    the node\'s membership in the bundle\'s destination endpoint
    [SHALL]{.bcp14} be disavowed; specifically, even though the node is
    a member of the bundle\'s destination endpoint, the node [SHALL
    NOT]{.bcp14} undertake to forward the bundle to itself in the course
    of performing the procedure described in [Section
    5.4](#sect-5.4){.xref}.[¶](#section-5.3-3.1){.pilcrow}
:   

Step 2:
:   Processing proceeds from Step 1 of [Section
    5.4](#sect-5.4){.xref}.[¶](#section-5.3-3.2){.pilcrow}
:   
:::
:::

::: {#sect-5.4}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Bundle Forwarding](#name-bundle-forwarding){.section-name .selfRef} {#name-bundle-forwarding}

The steps in forwarding a bundle are as
follows:[¶](#section-5.4-1){.pilcrow}

[]{.break}

Step 1:
:   The retention constraint \"Forward pending\" [MUST]{.bcp14} be added
    to the bundle, and the bundle\'s \"Dispatch pending\" retention
    constraint [MUST]{.bcp14} be removed.[¶](#section-5.4-2.1){.pilcrow}
:   

Step 2:

:   The BPA [MUST]{.bcp14} determine whether or not forwarding is
    contraindicated (that is, rendered inadvisable) for any of the
    reasons listed in the IANA \"Bundle Status Report Reason Codes\"
    registry (see [Section 9.5](#sect-9.5){.xref}), whose initial
    contents are listed in [Table 1](#tab-1){.xref}. In
    particular:[¶](#section-5.4-2.2.1){.pilcrow}

    -   [The BPA [MAY]{.bcp14} choose to either forward the bundle
        directly to its destination node(s) (if possible) or forward the
        bundle to some other node(s) for further forwarding. The manner
        in which this decision is made may depend on the scheme name in
        the destination endpoint ID and/or on other state but in any
        case is beyond the scope of this document; one possible
        mechanism is described in \[[SABR](#SABR){.xref}\]. If the BPA
        elects to forward the bundle to some other node(s) for further
        forwarding but finds it impossible to select any node(s) to
        forward the bundle to, then forwarding is
        contraindicated.[¶](#section-5.4-2.2.2.1){.pilcrow}]{#section-5.4-2.2.2.1}
    -   [Provided the BPA succeeded in selecting the node or nodes to
        forward the bundle to, the BPA [MUST]{.bcp14} subsequently
        select the CLA(s) whose services will enable the node to send
        the bundle to those nodes. The manner in which specific
        appropriate CLAs are selected is beyond the scope of this
        document; the TCP CLA \[[TCPCL](#RFC9174){.xref}\]
        [MUST]{.bcp14} be implemented when some or all of the bundles
        forwarded by the BPA must be forwarded via the Internet but may
        not be appropriate for the forwarding of any particular bundle.
        If the agent finds it impossible to select any appropriate
        CLA(s) to use in forwarding this bundle, then forwarding is
        contraindicated.[¶](#section-5.4-2.2.2.2){.pilcrow}]{#section-5.4-2.2.2.2}

:   

Step 3:
:   If forwarding of the bundle is determined to be contraindicated for
    any of the reasons listed in the IANA \"Bundle Status Report Reason
    Codes\" registry (see [Section 9.5](#sect-9.5){.xref}), then the
    Forwarding Contraindicated procedure defined in [Section
    5.4.1](#sect-5.4.1){.xref} [MUST]{.bcp14} be followed; the remaining
    steps of this Bundle Forwarding procedure are skipped at this
    time.[¶](#section-5.4-2.3){.pilcrow}
:   

Step 4:

:   For each node selected for forwarding, the BPA [MUST]{.bcp14} invoke
    the services of the selected CLA(s) in order to effect the sending
    of the bundle to that node. Determining the time at which the BPA
    invokes CLA services is a BPA implementation matter. Determining the
    time at which each CLA subsequently responds to this service
    invocation by sending the bundle is a CLA implementation matter.
    Note that:[¶](#section-5.4-2.4.1){.pilcrow}

    -   [If the bundle has a Previous Node Block, as defined in [Section
        4.4.1](#sect-4.4.1){.xref}, then that block [MUST]{.bcp14} be
        removed from the bundle before the bundle is
        forwarded.[¶](#section-5.4-2.4.2.1){.pilcrow}]{#section-5.4-2.4.2.1}
    -   [If the BPA is configured to attach Previous Node Blocks to
        forwarded bundles, then a Previous Node Block containing the
        node ID of the forwarding node [MUST]{.bcp14} be inserted into
        the bundle before the bundle is
        forwarded.[¶](#section-5.4-2.4.2.2){.pilcrow}]{#section-5.4-2.4.2.2}
    -   [If the bundle has a Bundle Age Block, as defined in [Section
        4.4.2](#sect-4.4.2){.xref}, then at the last possible moment
        before the CLA initiates conveyance of the bundle via the CL
        protocol the bundle age value [MUST]{.bcp14} be increased by the
        difference between the current time and the time at which the
        bundle was received (or, if the local node is the source of the
        bundle,
        created).[¶](#section-5.4-2.4.2.3){.pilcrow}]{#section-5.4-2.4.2.3}

:   

Step 5:
:   When all selected CLAs have informed the BPA that they have
    concluded their data-sending procedures with regard to this bundle,
    processing may depend on the results of those
    procedures.[¶](#section-5.4-2.5){.pilcrow}
:   

If completion of the data-sending procedures by all selected CLAs has
not resulted in successful forwarding of the bundle (an
implementation-specific determination that is beyond the scope of this
specification), then the BPA [MAY]{.bcp14} choose (in an
implementation-specific manner, again beyond the scope of this
specification) to initiate another attempt to forward the bundle. In
that event, processing proceeds from Step 4. The minimum number of times
a given node will initiate another forwarding attempt for any single
bundle in this event (a number that may be zero) is a node configuration
parameter that must be exposed to other nodes in the network to the
extent that this is required by the operating
environment.[¶](#section-5.4-3){.pilcrow}

If completion of the data-sending procedures by all selected CLAs
**HAS** resulted in successful forwarding of the bundle, or if it has
not but the BPA does not choose to initiate another attempt to forward
the bundle, then:[¶](#section-5.4-4){.pilcrow}

-   [If the \"request reporting of bundle forwarding\" flag in the
    bundle\'s status report request field is set to 1 and status
    reporting is enabled, then a bundle forwarding status report
    [SHOULD]{.bcp14} be generated, destined for the bundle\'s report-to
    endpoint ID. The reason code on this bundle forwarding status report
    [MUST]{.bcp14} be \"no additional
    information\".[¶](#section-5.4-5.1){.pilcrow}]{#section-5.4-5.1}
-   [If any applicable Bundle Protocol extensions mandate generation of
    status reports upon conclusion of convergence-layer data-sending
    procedures, all such status reports [SHOULD]{.bcp14} be generated
    with extension-mandated reason
    codes.[¶](#section-5.4-5.2){.pilcrow}]{#section-5.4-5.2}
-   [The bundle\'s \"Forward pending\" retention constraint
    [MUST]{.bcp14} be
    removed.[¶](#section-5.4-5.3){.pilcrow}]{#section-5.4-5.3}

::: {#sect-5.4.1}
::: {#section-5.4.1 .section}
#### [5.4.1.](#section-5.4.1){.section-number .selfRef} [Forwarding Contraindicated](#name-forwarding-contraindicated){.section-name .selfRef} {#name-forwarding-contraindicated}

The steps in responding to contraindication of forwarding are as
follows:[¶](#section-5.4.1-1){.pilcrow}

[]{.break}

Step 1:
:   The BPA [MUST]{.bcp14} determine whether or not to declare failure
    in forwarding the bundle. Note: This decision is likely to be
    influenced by the reason for which forwarding is
    contraindicated.[¶](#section-5.4.1-2.1){.pilcrow}
:   

Step 2:
:   If forwarding failure is declared, then the Forwarding Failed
    procedure defined in [Section 5.4.2](#sect-5.4.2){.xref}
    [MUST]{.bcp14} be followed.[¶](#section-5.4.1-2.2){.pilcrow}
:   

Otherwise, when \-- at some future time \-- the forwarding of this
bundle ceases to be contraindicated, processing proceeds from Step 4 of
[Section 5.4](#sect-5.4){.xref}.[¶](#section-5.4.1-3){.pilcrow}
:::
:::

::: {#sect-5.4.2}
::: {#section-5.4.2 .section}
#### [5.4.2.](#section-5.4.2){.section-number .selfRef} [Forwarding Failed](#name-forwarding-failed){.section-name .selfRef} {#name-forwarding-failed}

The steps in responding to a declaration of forwarding failure are as
follows:[¶](#section-5.4.2-1){.pilcrow}

[]{.break}

Step 1:
:   The BPA [MAY]{.bcp14} forward the bundle back to the node that sent
    it, as identified by the Previous Node Block, if present. This
    forwarding, if performed, [SHALL]{.bcp14} be accomplished by
    performing Step 4 and Step 5 of [Section 5.4](#sect-5.4){.xref}
    where the sole node selected for forwarding [SHALL]{.bcp14} be the
    node that sent the bundle.[¶](#section-5.4.2-2.1){.pilcrow}
:   

Step 2:
:   If the bundle\'s destination endpoint is an endpoint of which the
    node is a member, then the bundle\'s \"Forward pending\" retention
    constraint [MUST]{.bcp14} be removed. Otherwise, the bundle
    [MUST]{.bcp14} be deleted: the Bundle Deletion procedure defined in
    [Section 5.10](#sect-5.10){.xref} [MUST]{.bcp14} be followed, citing
    the reason for which forwarding was determined to be
    contraindicated.[¶](#section-5.4.2-2.2){.pilcrow}
:   
:::
:::
:::
:::

::: {#sect-5.5}
::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Bundle Expiration](#name-bundle-expiration){.section-name .selfRef} {#name-bundle-expiration}

A bundle expires when the bundle\'s age exceeds its lifetime as
specified in the primary bundle block or as overridden by the BPA.
Bundle age [MAY]{.bcp14} be determined by subtracting the bundle\'s
creation timestamp time from the current time if (a) that timestamp time
is not zero and (b) the local node\'s clock is known to be accurate;
otherwise, bundle age [MUST]{.bcp14} be obtained from the Bundle Age
extension block. Bundle expiration [MAY]{.bcp14} occur at any point in
the processing of a bundle. When a bundle expires, the BPA
[MUST]{.bcp14} delete the bundle for the reason \"Lifetime expired\"
(when the expired lifetime is the lifetime as specified in the primary
block) or \"Traffic pared\" (when the expired lifetime is a lifetime
override as imposed by the BPA): the Bundle Deletion procedure defined
in [Section 5.10](#sect-5.10){.xref} [MUST]{.bcp14} be
followed.[¶](#section-5.5-1){.pilcrow}
:::
:::

::: {#sect-5.6}
::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [Bundle Reception](#name-bundle-reception){.section-name .selfRef} {#name-bundle-reception}

The steps in processing a bundle that has been received from another
node are as follows:[¶](#section-5.6-1){.pilcrow}

[]{.break}

Step 1:
:   The retention constraint \"Dispatch pending\" [MUST]{.bcp14} be
    added to the bundle.[¶](#section-5.6-2.1){.pilcrow}
:   

Step 2:
:   If the \"request reporting of bundle reception\" flag in the
    bundle\'s status report request field is set to 1 and status
    reporting is enabled, then a bundle reception status report with
    reason code \"No additional information\" [SHOULD]{.bcp14} be
    generated, destined for the bundle\'s report-to endpoint
    ID.[¶](#section-5.6-2.2){.pilcrow}
:   

Step 3:
:   CRCs [SHOULD]{.bcp14} be computed for every block of the bundle that
    has an attached CRC. If any block of the bundle is malformed
    according to this specification (including syntactically invalid
    CBOR), or if any block has an attached CRC and the CRC computed for
    this block upon reception differs from that attached CRC, then the
    BPA [MUST]{.bcp14} delete the bundle for the reason \"Block
    unintelligible\". The Bundle Deletion procedure defined in [Section
    5.10](#sect-5.10){.xref} [MUST]{.bcp14} be followed, and all
    remaining steps of the Bundle Reception procedure [MUST]{.bcp14} be
    skipped.[¶](#section-5.6-2.3){.pilcrow}
:   

Step 4:

:   For each block in the bundle that is an extension block that the BPA
    cannot process:[¶](#section-5.6-2.4.1){.pilcrow}

    -   [If the block processing control flags in that block indicate
        that a status report is requested in this event and if status
        reporting is enabled, then a bundle reception status report with
        reason code \"Block unsupported\" [SHOULD]{.bcp14} be generated,
        destined for the bundle\'s report-to endpoint
        ID.[¶](#section-5.6-2.4.2.1){.pilcrow}]{#section-5.6-2.4.2.1}
    -   [If the block processing control flags in that block indicate
        that the bundle must be deleted in this event, then the BPA
        [MUST]{.bcp14} delete the bundle for the reason \"Block
        unsupported\"; the Bundle Deletion procedure defined in [Section
        5.10](#sect-5.10){.xref} [MUST]{.bcp14} be followed, and all
        remaining steps of the Bundle Reception procedure [MUST]{.bcp14}
        be
        skipped.[¶](#section-5.6-2.4.2.2){.pilcrow}]{#section-5.6-2.4.2.2}
    -   [If the block processing control flags in that block do **NOT**
        indicate that the bundle must be deleted in this event but do
        indicate that the block must be discarded, then the BPA
        [MUST]{.bcp14} remove this block from the
        bundle.[¶](#section-5.6-2.4.2.3){.pilcrow}]{#section-5.6-2.4.2.3}
    -   [If the block processing control flags in that block neither
        indicate that the bundle must be deleted nor indicate that the
        block must be discarded, then processing continues with the next
        extension block that the BPA cannot process, if any; otherwise,
        processing proceeds from Step
        5.[¶](#section-5.6-2.4.2.4){.pilcrow}]{#section-5.6-2.4.2.4}

:   

Step 5:
:   Processing proceeds from Step 1 of [Section
    5.3](#sect-5.3){.xref}.[¶](#section-5.6-2.5){.pilcrow}
:   
:::
:::

::: {#sect-5.7}
::: {#section-5.7 .section}
### [5.7.](#section-5.7){.section-number .selfRef} [Local Bundle Delivery](#name-local-bundle-delivery){.section-name .selfRef} {#name-local-bundle-delivery}

The steps in processing a bundle that is destined for an endpoint of
which this node is a member are as follows:[¶](#section-5.7-1){.pilcrow}

[]{.break}

Step 1:
:   If the received bundle is a fragment, the ADU Reassembly procedure
    described in [Section 5.9](#sect-5.9){.xref} [MUST]{.bcp14} be
    followed. If this procedure results in reassembly of the entire
    original ADU, processing of the fragmentary bundle whose payload has
    been replaced by the reassembled ADU (whether this bundle or a
    previously received fragment) proceeds from Step 2; otherwise, the
    retention constraint \"Reassembly pending\" [MUST]{.bcp14} be added
    to the bundle, and all remaining steps of this procedure
    [MUST]{.bcp14} be skipped.[¶](#section-5.7-2.1){.pilcrow}
:   

Step 2:

:   Delivery depends on the state of the registration whose endpoint ID
    matches that of the destination of the
    bundle:[¶](#section-5.7-2.2.1){.pilcrow}

    -   [An additional implementation-specific delivery deferral
        procedure [MAY]{.bcp14} optionally be associated with the
        registration.[¶](#section-5.7-2.2.2.1){.pilcrow}]{#section-5.7-2.2.2.1}

    -   [If the registration is in the Active state, then the bundle
        [MUST]{.bcp14} be delivered automatically as soon as it is the
        next bundle that is due for delivery according to the BPA\'s
        bundle delivery scheduling policy (an implementation
        matter).[¶](#section-5.7-2.2.2.2){.pilcrow}]{#section-5.7-2.2.2.2}

    -   ::: {#section-5.7-2.2.2.3}
        If the registration is in the Passive state, or if delivery of
        the bundle fails for some implementation-specific reason, then
        the registration\'s delivery failure action [MUST]{.bcp14} be
        taken. The delivery failure action [MUST]{.bcp14} be one of the
        following:[¶](#section-5.7-2.2.2.3.1){.pilcrow}

        -   [Defer delivery of the bundle subject to this registration
            until (a) this bundle is the least recently received of all
            bundles currently deliverable subject to this registration
            and (b) either the registration is polled or the
            registration is in the Active state, and also perform any
            additional delivery deferral procedure associated with the
            registration,
            or[¶](#section-5.7-2.2.2.3.2.1){.pilcrow}]{#section-5.7-2.2.2.3.2.1}
        -   [Abandon delivery of the bundle subject to this registration
            (as defined in [Section
            3.1](#sect-3.1){.xref}).[¶](#section-5.7-2.2.2.3.2.2){.pilcrow}]{#section-5.7-2.2.2.3.2.2}
        :::

:   

Step 3:
:   As soon as the bundle has been delivered, if the \"request reporting
    of bundle delivery\" flag in the bundle\'s status report request
    field is set to 1 and bundle status reporting is enabled, then a
    bundle delivery status report [SHOULD]{.bcp14} be generated,
    destined for the bundle\'s report-to endpoint ID. Note that this
    status report only states that the payload has been delivered to the
    application agent, not that the application agent has processed that
    payload.[¶](#section-5.7-2.3){.pilcrow}
:   
:::
:::

::: {#sect-5.8}
::: {#section-5.8 .section}
### [5.8.](#section-5.8){.section-number .selfRef} [Bundle Fragmentation](#name-bundle-fragmentation){.section-name .selfRef} {#name-bundle-fragmentation}

It may at times be advantageous for BPAs to reduce the sizes of bundles
in order to forward them. This might be the case, for example, if a node
to which a bundle is to be forwarded is accessible only via intermittent
contacts and no upcoming contact is long enough to enable the forwarding
of the entire bundle.[¶](#section-5.8-1){.pilcrow}

The size of a bundle can be reduced by \"fragmenting\" the bundle. To
fragment a bundle whose payload is of size M is to replace it with two
\"fragments\" \-- new bundles with the same source node ID and creation
timestamp as the original bundle \-- whose payloads [MUST]{.bcp14} be
the first N and the last (M - N) bytes of the original bundle\'s
payload, where 0 \< N \< M.[¶](#section-5.8-2){.pilcrow}

Note that fragments are bundles and therefore may themselves be
fragmented, so multiple episodes of fragmentation may in effect replace
the original bundle with more than two fragments. (However, there is
only one \"level\" of fragmentation, as in IP
fragmentation.)[¶](#section-5.8-3){.pilcrow}

Any bundle whose primary block\'s bundle processing control flags do
**NOT** indicate that it must not be fragmented [MAY]{.bcp14} be
fragmented at any time, for any purpose, at the discretion of the BPA.
**NOTE**, however, that some combinations of bundle fragmentation,
replication, and routing might result in unexpected traffic
patterns.[¶](#section-5.8-4){.pilcrow}

Fragmentation [SHALL]{.bcp14} be constrained as
follows:[¶](#section-5.8-5){.pilcrow}

-   [The concatenation of the payloads of all fragments produced by
    fragmentation [MUST]{.bcp14} always be identical to the payload of
    the fragmented bundle (that is, the bundle that is being
    fragmented). Note that the payloads of fragments resulting from
    different fragmentation episodes, in different parts of the network,
    may be overlapping subsets of the fragmented bundle\'s
    payload.[¶](#section-5.8-6.1){.pilcrow}]{#section-5.8-6.1}
-   [The primary block of each fragment [MUST]{.bcp14} differ from that
    of the fragmented bundle, in that the bundle processing control
    flags of the fragment [MUST]{.bcp14} indicate that the bundle is a
    fragment and both fragment offset and total application data unit
    length must be provided. Additionally, the CRC of the primary block
    of the fragmented bundle, if any, [MUST]{.bcp14} be replaced in each
    fragment by a new CRC computed for the primary block of that
    fragment.[¶](#section-5.8-6.2){.pilcrow}]{#section-5.8-6.2}
-   [The payload blocks of fragments will differ from that of the
    fragmented bundle as noted
    above.[¶](#section-5.8-6.3){.pilcrow}]{#section-5.8-6.3}
-   [If the fragmented bundle is not a fragment or is the fragment with
    offset zero, then all extension blocks of the fragmented bundle
    [MUST]{.bcp14} be replicated in the fragment whose offset is
    zero.[¶](#section-5.8-6.4){.pilcrow}]{#section-5.8-6.4}
-   [Each of the fragmented bundle\'s extension blocks whose \"Block
    must be replicated in every fragment\" flag is set to 1
    [MUST]{.bcp14} be replicated in every
    fragment.[¶](#section-5.8-6.5){.pilcrow}]{#section-5.8-6.5}
-   [Beyond these rules, rules for the replication of extension blocks
    in the fragments must be defined in the specifications for those
    extension block
    types.[¶](#section-5.8-6.6){.pilcrow}]{#section-5.8-6.6}
:::
:::

::: {#sect-5.9}
::: {#section-5.9 .section}
### [5.9.](#section-5.9){.section-number .selfRef} [Application Data Unit Reassembly](#name-application-data-unit-reass){.section-name .selfRef} {#name-application-data-unit-reass}

Note that the Bundle Fragmentation procedure described in [Section
5.8](#sect-5.8){.xref} may result in the replacement of a single
original bundle with an arbitrarily large number of fragmentary bundles.
In order to be delivered at a destination node, the original bundle\'s
payload must be reassembled from the payloads of those
fragments.[¶](#section-5.9-1){.pilcrow}

The \"material extents\" of a received fragment\'s payload are all
continuous sequences of bytes in that payload that do not overlap with
the material extents of the payloads of any previously received
fragments with the same source node ID and creation timestamp. If the
concatenation \-- as informed by fragment offsets and payload lengths
\-- of the material extents of the payloads of this fragment and all
previously received fragments with the same source node ID and creation
timestamp as this fragment forms a continuous byte array whose length is
equal to the total application data unit length noted in the fragment\'s
primary block, then:[¶](#section-5.9-2){.pilcrow}

-   [This byte array \-- the reassembled ADU \-- [MUST]{.bcp14} replace
    the payload of that fragment whose material extents include the
    extent at offset zero. Note that this will enable delivery of the
    reconstituted original bundle as described in Step 1 of [Section
    5.7](#sect-5.7){.xref}.[¶](#section-5.9-3.1){.pilcrow}]{#section-5.9-3.1}
-   [The \"Reassembly pending\" retention constraint [MUST]{.bcp14} be
    removed from every other fragment with the same source node ID and
    creation timestamp as this
    fragment.[¶](#section-5.9-3.2){.pilcrow}]{#section-5.9-3.2}

Note: Reassembly of ADUs from fragments occurs at the nodes that are
members of destination endpoints as necessary; an ADU [MAY]{.bcp14} also
be reassembled at some other node on the path to the
destination.[¶](#section-5.9-4){.pilcrow}
:::
:::

::: {#sect-5.10}
::: {#section-5.10 .section}
### [5.10.](#section-5.10){.section-number .selfRef} [Bundle Deletion](#name-bundle-deletion){.section-name .selfRef} {#name-bundle-deletion}

The steps in deleting a bundle are as
follows:[¶](#section-5.10-1){.pilcrow}

[]{.break}

Step 1:
:   If the \"request reporting of bundle deletion\" flag in the
    bundle\'s status report request field is set to 1 and if status
    reporting is enabled, then a bundle deletion status report citing
    the reason for deletion [SHOULD]{.bcp14} be generated, destined for
    the bundle\'s report-to endpoint ID.[¶](#section-5.10-2.1){.pilcrow}
:   

Step 2:
:   All of the bundle\'s retention constraints [MUST]{.bcp14} be
    removed.[¶](#section-5.10-2.2){.pilcrow}
:   
:::
:::

::: {#sect-5.11}
::: {#section-5.11 .section}
### [5.11.](#section-5.11){.section-number .selfRef} [Discarding a Bundle](#name-discarding-a-bundle){.section-name .selfRef} {#name-discarding-a-bundle}

As soon as a bundle has no remaining retention constraints, it
[MAY]{.bcp14} be discarded, thereby releasing any persistent storage
that may have been allocated to it.[¶](#section-5.11-1){.pilcrow}
:::
:::

::: {#sect-5.12}
::: {#section-5.12 .section}
### [5.12.](#section-5.12){.section-number .selfRef} [Canceling a Transmission](#name-canceling-a-transmission){.section-name .selfRef} {#name-canceling-a-transmission}

When requested to cancel a specified transmission, where the bundle
created upon initiation of the indicated transmission has not yet been
discarded, the BPA [MUST]{.bcp14} delete that bundle for the reason
\"Transmission canceled\". For this purpose, the procedure defined in
[Section 5.10](#sect-5.10){.xref} [MUST]{.bcp14} be
followed.[¶](#section-5.12-1){.pilcrow}
:::
:::
:::
:::

::: {#sect-6}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Administrative Record Processing](#name-administrative-record-proce){.section-name .selfRef} {#name-administrative-record-proce}

::: {#sect-6.1}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Administrative Records](#name-administrative-records){.section-name .selfRef} {#name-administrative-records}

Administrative records are standard ADUs that are used in providing some
of the features of the Bundle Protocol. Bundle Protocol administrative
record types are registered in the IANA \"Bundle Administrative Record
Types\" registry \[[RFC5050](#RFC5050){.xref}\]; of these, only
administrative record type 1, \"Bundle status report\", is defined for
BPv7 at this time. Note that additional types of administrative records
may be defined by supplementary DTN protocol specification
documents.[¶](#section-6.1-1){.pilcrow}

Every administrative record consists of:[¶](#section-6.1-2){.pilcrow}

-   [A record type code (an unsigned integer for which valid values are
    as defined below).[¶](#section-6.1-3.1){.pilcrow}]{#section-6.1-3.1}
-   [Record content in type-specific
    format.[¶](#section-6.1-3.2){.pilcrow}]{#section-6.1-3.2}

Each BP administrative record [SHALL]{.bcp14} be represented as a CBOR
array comprising two items.[¶](#section-6.1-4){.pilcrow}

The first item of the array [SHALL]{.bcp14} be a record type code, which
[SHALL]{.bcp14} be represented as a CBOR unsigned
integer.[¶](#section-6.1-5){.pilcrow}

The second element of this array [SHALL]{.bcp14} be the applicable CBOR
encoding of the content of the record. Details of the CBOR encoding of
administrative record type 1 are provided below. Details of the CBOR
encoding of other types of administrative records are included in the
specifications defining those records.[¶](#section-6.1-6){.pilcrow}

::: {#sect-6.1.1}
::: {#section-6.1.1 .section}
#### [6.1.1.](#section-6.1.1){.section-number .selfRef} [Bundle Status Reports](#name-bundle-status-reports){.section-name .selfRef} {#name-bundle-status-reports}

The transmission of \"bundle status reports\" under specified conditions
is an option that can be invoked when transmission of a bundle is
requested. These reports are intended to provide information about how
bundles are progressing through the system, including notices of
receipt, forwarding, final delivery, and deletion. They are transmitted
to the report-to endpoints of bundles.[¶](#section-6.1.1-1){.pilcrow}

Each bundle status report [SHALL]{.bcp14} be represented as a CBOR
array. The number of elements in the array [SHALL]{.bcp14} be either 6
(if the subject bundle is a fragment) or 4
(otherwise).[¶](#section-6.1.1-2){.pilcrow}

The first element of the bundle status report [SHALL]{.bcp14} be bundle
status information represented as a CBOR array of at least four
elements. The first four elements of the bundle status information shall
provide information on the following four status assertions, in this
order:[¶](#section-6.1.1-3){.pilcrow}

-   [Reporting node received
    bundle.[¶](#section-6.1.1-4.1){.pilcrow}]{#section-6.1.1-4.1}
-   [Reporting node forwarded the
    bundle.[¶](#section-6.1.1-4.2){.pilcrow}]{#section-6.1.1-4.2}
-   [Reporting node delivered the
    bundle.[¶](#section-6.1.1-4.3){.pilcrow}]{#section-6.1.1-4.3}
-   [Reporting node deleted the
    bundle.[¶](#section-6.1.1-4.4){.pilcrow}]{#section-6.1.1-4.4}

Each element of the bundle status information [SHALL]{.bcp14} be a
bundle status item encoded as a CBOR
array.[¶](#section-6.1.1-5){.pilcrow}

The number of elements in each bundle status item [SHALL]{.bcp14} be
either 2 (if the value of the first element of the bundle status item is
1 AND the \"Report status time\" flag was set to 1 in the bundle
processing control flags of the bundle whose status is being reported)
or 1 (otherwise).[¶](#section-6.1.1-6){.pilcrow}

The first element of each bundle status item [SHALL]{.bcp14} be a status
indicator, a Boolean value indicating whether or not the corresponding
bundle status is asserted, encoded as a CBOR Boolean value. If present,
the second element of each bundle status item [SHALL]{.bcp14} indicate
the time (as reported by the local system clock; this is an
implementation matter) at which the indicated status was asserted for
this bundle, represented as a DTN time as described in [Section
4.2.6](#sect-4.2.6){.xref}.[¶](#section-6.1.1-7){.pilcrow}

The second element of the bundle status report [SHALL]{.bcp14} be the
bundle status report reason code explaining the value of the status
indicator, represented as a CBOR unsigned integer. Valid status report
reason codes are registered in the IANA \"Bundle Status Report Reason
Codes\" subregistry in the \"Bundle Protocol\" registry (see [Section
9.5](#sect-9.5){.xref}). The initial contents of that registry are
listed in [Table 1](#tab-1){.xref}, but the list of status report reason
codes provided here is neither exhaustive nor exclusive; supplementary
DTN protocol specifications (including, but not restricted to, Bundle
Protocol Security \[[BPSEC](#RFC9172){.xref}\]) may define additional
reason codes.[¶](#section-6.1.1-8){.pilcrow}

[]{#name-status-report-reason-codes}

::: {#tab-1}
  Value    Meaning
  -------- --------------------------------------------
  0        No additional information.
  1        Lifetime expired.
  2        Forwarded over unidirectional link.
  3        Transmission canceled.
  4        Depleted storage.
  5        Destination endpoint ID unavailable.
  6        No known route to destination from here.
  7        No timely contact with next node on route.
  8        Block unintelligible.
  9        Hop limit exceeded.
  10       Traffic pared (e.g., status reports).
  11       Block unsupported.
  17-254   Unassigned
  255      Reserved

  : [Table 1](#table-1){.selfRef}: [Status Report Reason
  Codes](#name-status-report-reason-codes){.selfRef}
:::

The third element of the bundle status report [SHALL]{.bcp14} be the
source node ID identifying the source of the bundle whose status is
being reported, represented as described in [Section
4.2.5.1.1](#sect-4.2.5.1.1){.xref}.[¶](#section-6.1.1-10){.pilcrow}

The fourth element of the bundle status report [SHALL]{.bcp14} be the
creation timestamp of the bundle whose status is being reported,
represented as described in [Section
4.2.7](#sect-4.2.7){.xref}.[¶](#section-6.1.1-11){.pilcrow}

The fifth element of the bundle status report [SHALL]{.bcp14} be present
if and only if the bundle whose status is being reported contained a
fragment offset. If present, it [SHALL]{.bcp14} be the subject bundle\'s
fragment offset represented as a CBOR unsigned integer
item.[¶](#section-6.1.1-12){.pilcrow}

The sixth element of the bundle status report [SHALL]{.bcp14} be present
if and only if the bundle whose status is being reported contained a
fragment offset. If present, it [SHALL]{.bcp14} be the length of the
subject bundle\'s payload represented as a CBOR unsigned integer
item.[¶](#section-6.1.1-13){.pilcrow}

Note that the forwarding parameters (such as lifetime, applicable
security measures, etc.) of the bundle whose status is being reported
[MAY]{.bcp14} be reflected in the parameters governing the forwarding of
the bundle that conveys a status report, but this is an implementation
matter. Bundle Protocol deployment experience to date has not been
sufficient to suggest any clear guidance on this
topic.[¶](#section-6.1.1-14){.pilcrow}
:::
:::
:::
:::

::: {#sect-6.2}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Generation of Administrative Records](#name-generation-of-administrative){.section-name .selfRef} {#name-generation-of-administrative}

Whenever the application agent\'s administrative element is directed by
the BPA to generate an administrative record, the following procedure
must be followed:[¶](#section-6.2-1){.pilcrow}

[]{.break}

Step 1:
:   The administrative record must be constructed. If the administrative
    record references a bundle and the referenced bundle is a fragment,
    the administrative record [MUST]{.bcp14} contain the fragment offset
    and fragment length.[¶](#section-6.2-2.1){.pilcrow}
:   

Step 2:
:   A request for transmission of a bundle whose payload is this
    administrative record [MUST]{.bcp14} be presented to the
    BPA.[¶](#section-6.2-2.2){.pilcrow}
:   
:::
:::
:::
:::

::: {#sect-7}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Services Required of the Convergence Layer](#name-services-required-of-the-co){.section-name .selfRef} {#name-services-required-of-the-co}

::: {#sect-7.1}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [The Convergence Layer](#name-the-convergence-layer){.section-name .selfRef} {#name-the-convergence-layer}

The successful operation of the end-to-end Bundle Protocol depends on
the operation of underlying protocols at what is termed the
\"convergence layer\"; these protocols accomplish communication between
nodes. A wide variety of protocols may serve this purpose, so long as
each CLA provides a defined minimal set of services to the BPA. This
convergence-layer service specification enumerates those
services.[¶](#section-7.1-1){.pilcrow}
:::
:::

::: {#sect-7.2}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Summary of Convergence-Layer Services](#name-summary-of-convergence-laye){.section-name .selfRef} {#name-summary-of-convergence-laye}

Each CLA is expected to provide the following services to the
BPA:[¶](#section-7.2-1){.pilcrow}

-   [sending a bundle to a bundle node that is reachable via the
    convergence-layer
    protocol.[¶](#section-7.2-2.1){.pilcrow}]{#section-7.2-2.1}
-   [notifying the BPA of the disposition of its data-sending procedures
    with regard to a bundle, upon concluding those
    procedures.[¶](#section-7.2-2.2){.pilcrow}]{#section-7.2-2.2}
-   [delivering to the BPA a bundle that was sent by a bundle node via
    the convergence-layer
    protocol.[¶](#section-7.2-2.3){.pilcrow}]{#section-7.2-2.3}

The convergence-layer service interface specified here is neither
exhaustive nor exclusive. That is, supplementary DTN protocol
specifications (including, but not restricted to, Bundle Protocol
Security \[[BPSEC](#RFC9172){.xref}\]) may expect CLAs that serve BP
implementations conforming to those protocols to provide additional
services such as reporting on the transmission and/or reception progress
of individual bundles (at completion and/or incrementally),
retransmitting data that were lost in transit, discarding
bundle-conveying data units that the convergence-layer protocol
determines are corrupt or inauthentic, or reporting on the integrity
and/or authenticity of delivered bundles.[¶](#section-7.2-3){.pilcrow}

In addition, the Bundle Protocol relies on the capabilities of protocols
at the convergence layer to minimize congestion in the
store-carry-forward overlay network. The potentially long round-trip
times characterizing delay-tolerant networks are incompatible with
end-to-end, reactive congestion-control mechanisms, so convergence-layer
protocols [MUST]{.bcp14} provide rate limiting or congestion
control.[¶](#section-7.2-4){.pilcrow}
:::
:::
:::
:::

::: {#sect-8}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The Bundle Protocol security architecture and the available security
services are specified in an accompanying document, the Bundle Protocol
Security (BPSec) specification \[[BPSEC](#RFC9172){.xref}\]. Whenever
Bundle Protocol security services (as opposed to the security services
provided by overlying application protocols or underlying
convergence-layer protocols) are required, those services
[SHALL]{.bcp14} be provided by BPSec rather than by some other mechanism
with the same or similar scope.[¶](#section-8-1){.pilcrow}

A Bundle Protocol Agent (BPA) that sources, cryptographically verifies,
and/or accepts a bundle [MUST]{.bcp14} implement support for BPSec. Use
of BPSec for any single bundle is optional.[¶](#section-8-2){.pilcrow}

The BPSec extensions to the Bundle Protocol enable each block of a
bundle (other than a BPSec extension block) to be individually
authenticated by a signature block (Block Integrity Block, or BIB) and
also enable each block of a bundle other than the primary block (and the
BPSec extension blocks themselves) to be individually encrypted by a
Block Confidentiality Block (BCB).[¶](#section-8-3){.pilcrow}

Because the security mechanisms are extension blocks that are themselves
inserted into the bundle, the protections they afford apply while the
bundle is at rest, awaiting transmission at the next forwarding
opportunity, as well as in transit.[¶](#section-8-4){.pilcrow}

Additionally, convergence-layer protocols that ensure authenticity of
communication between adjacent nodes in a BP network topology
[SHOULD]{.bcp14} be used where available, to minimize the ability of
unauthenticated nodes to introduce inauthentic traffic into the network.
Convergence-layer protocols that ensure confidentiality of communication
between adjacent nodes in a BP network topology [SHOULD]{.bcp14} also be
used where available, to minimize exposure of the bundle\'s primary
block and other cleartext blocks, thereby offering some defense against
traffic analysis.[¶](#section-8-5){.pilcrow}

In order to provide authenticity and/or confidentiality of communication
between BP nodes, the convergence-layer protocol requires as input the
name or names of the expected communication peer(s). These must be
supplied by the CLA. Details of the means by which the CLA determines
which CL endpoint name(s) must be provided to the CL protocol are out of
scope for this specification. Note, though, that when the CL endpoint
names are a function of BP endpoint IDs, the correctness and
authenticity of that mapping will be vital to the overall security
properties that the CL provides to the
system.[¶](#section-8-6){.pilcrow}

Note that, while the primary block must remain in the clear for routing
purposes, the Bundle Protocol could be protected against traffic
analysis to some extent by using bundle-in-bundle encapsulation
\[[BIBE](#I-D.ietf-dtn-bibect){.xref}\] to tunnel bundles to a safe
forward distribution point: the encapsulated bundle could form the
payload of an encapsulating bundle, and that payload block could be
encrypted by a BCB.[¶](#section-8-7){.pilcrow}

Note that the generation of bundle status reports is disabled by default
because malicious initiation of bundle status reporting could result in
the transmission of extremely large numbers of bundles, effecting a
denial-of-service attack. Imposing bundle lifetime overrides would
constitute one defense against such an
attack.[¶](#section-8-8){.pilcrow}

Note also that the reception of large numbers of fragmentary bundles
with very long lifetimes could constitute a denial-of-service attack,
occupying storage while pending reassembly that will never occur.
Imposing bundle lifetime overrides would, again, constitute one defense
against such an attack.[¶](#section-8-9){.pilcrow}

This protocol makes use of absolute timestamps for several purposes.
Provisions are included for nodes without accurate clocks to retain most
of the protocol functionality, but nodes that are unaware that their
clock is inaccurate may exhibit unexpected
behavior.[¶](#section-8-10){.pilcrow}
:::
:::

::: {#sect-9}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

The Bundle Protocol includes fields requiring registries managed by
IANA.[¶](#section-9-1){.pilcrow}

::: {#sect-9.1}
::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Bundle Block Types](#name-bundle-block-types){.section-name .selfRef} {#name-bundle-block-types}

The \"Bundle Block Types\" subregistry in the \"Bundle Protocol\"
registry has been augmented by adding a column identifying the version
of the Bundle Protocol (Bundle Protocol Version) that applies to the
values. IANA has added the following values, as described in [Section
4.3.1](#sect-4.3.1){.xref}, to the \"Bundle Block Types\" registry with
a value of \"7\" for the Bundle Protocol Version. IANA has set the
Bundle Protocol Version to \"6\" or \"6,7\" for preexisting values in
the \"Bundle Block Types\" registry, as shown
below.[¶](#section-9.1-1){.pilcrow}

[]{#name-bundle-block-types-registry}

  Bundle Protocol Version   Value     Description                                    Reference
  ------------------------- --------- ---------------------------------------------- --------------------------------------------
  none                      0         Reserved                                       \[[RFC6255](#RFC6255){.xref}\]
  6,7                       1         Bundle Payload Block                           \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6                         2         Bundle Authentication Block                    \[[RFC6257](#RFC6257){.xref}\]
  6                         3         Payload Integrity Block                        \[[RFC6257](#RFC6257){.xref}\]
  6                         4         Payload Confidentiality Block                  \[[RFC6257](#RFC6257){.xref}\]
  6                         5         Previous-Hop Insertion Block                   \[[RFC6259](#RFC6259){.xref}\]
  7                         6         Previous node (proximate sender)               \[RFC9171\]
  7                         7         Bundle age (in milliseconds)                   \[RFC9171\]
  6                         8         Metadata Extension Block                       \[[RFC6258](#RFC6258){.xref}\]
  6                         9         Extension Security Block                       \[[RFC6257](#RFC6257){.xref}\]
  7                         10        Hop count (#prior xmit attempts)               \[RFC9171\]
  7                         11-191    Unassigned                                     
  6,7                       192-255   Reserved for Private and/or Experimental Use   \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]

  : [Table 2](#table-2){.selfRef}: [\"Bundle Block Types\"
  Registry](#name-bundle-block-types-registry){.selfRef}
:::
:::

::: {#sect-9.2}
::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Primary Bundle Protocol Version](#name-primary-bundle-protocol-ver){.section-name .selfRef} {#name-primary-bundle-protocol-ver}

IANA has added the following value to the \"Primary Bundle Protocol
Version\" subregistry in the \"Bundle Protocol\"
registry.[¶](#section-9.2-1){.pilcrow}

[]{#name-primary-bundle-protocol-vers}

  Value   Description   Reference
  ------- ------------- -------------
  7       Assigned      \[RFC9171\]

  : [Table 3](#table-3){.selfRef}: [\"Primary Bundle Protocol Version\"
  Registry](#name-primary-bundle-protocol-vers){.selfRef}

Values 8-255 (rather than 7-255) are now
Unassigned.[¶](#section-9.2-3){.pilcrow}
:::
:::

::: {#sect-9.3}
::: {#section-9.3 .section}
### [9.3.](#section-9.3){.section-number .selfRef} [Bundle Processing Control Flags](#name-bundle-processing-control-fl){.section-name .selfRef} {#name-bundle-processing-control-fl}

The \"Bundle Processing Control Flags\" subregistry in the \"Bundle
Protocol\" registry has been augmented by adding a column identifying
the version of the Bundle Protocol (Bundle Protocol Version) that
applies to the new values. IANA has added the following values, as
described in [Section 4.2.3](#sect-4.2.3){.xref}, to the \"Bundle
Processing Control Flags\" registry with a value of \"7\" for the Bundle
Protocol Version. IANA has set the Bundle Protocol Version to the value
\"6\" or \"6,7\" for preexisting values in the \"Bundle Processing
Control Flags\" registry, as shown below.[¶](#section-9.3-1){.pilcrow}

[]{#name-bundle-processing-control-fla}

  Bundle Protocol Version   Bit Position (right to left)   Description                                   Reference
  ------------------------- ------------------------------ --------------------------------------------- --------------------------------------------
  6,7                       0                              Bundle is a fragment                          \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       1                              ADU is an administrative record               \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       2                              Bundle must not be fragmented                 \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6                         3                              Custody transfer is requested                 \[[RFC5050](#RFC5050){.xref}\]
  6                         4                              Destination endpoint is a singleton           \[[RFC5050](#RFC5050){.xref}\]
  6,7                       5                              Acknowledgement by application is requested   \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  7                         6                              Status time requested in reports              \[RFC9171\]
  6                         7-8                            Class of service: priority                    \[[RFC5050](#RFC5050){.xref}\]
  6                         9-13                           Class of service: reserved                    \[[RFC5050](#RFC5050){.xref}\]
  6,7                       14                             Request reporting of bundle reception         \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6                         15                             Request reporting of custody acceptance       \[[RFC5050](#RFC5050){.xref}\]
  6,7                       16                             Request reporting of bundle forwarding        \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       17                             Request reporting of bundle delivery          \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       18                             Request reporting of bundle deletion          \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       19                             Reserved                                      \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       20                             Reserved                                      \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
                            21-63                          Unassigned                                    

  : [Table 4](#table-4){.selfRef}: [\"Bundle Processing Control Flags\"
  Registry](#name-bundle-processing-control-fla){.selfRef}
:::
:::

::: {#sect-9.4}
::: {#section-9.4 .section}
### [9.4.](#section-9.4){.section-number .selfRef} [Block Processing Control Flags](#name-block-processing-control-fla){.section-name .selfRef} {#name-block-processing-control-fla}

The \"Block Processing Control Flags\" subregistry in the \"Bundle
Protocol\" registry has been augmented by adding a column identifying
the version of the Bundle Protocol (Bundle Protocol Version) that
applies to the related BP version. IANA has set the Bundle Protocol
Version to the value \"6\" or \"6,7\" for preexisting values in the
\"Bundle Processing Control Flags\" registry, as shown
below.[¶](#section-9.4-1){.pilcrow}

[]{#name-block-processing-control-flag}

  Bundle Protocol Version   Bit Position (right to left)[¶](#section-9.4-2.1.1.0.1){.pilcrow}   Description                                           Reference
  ------------------------- ------------------------------------------------------------------- ----------------------------------------------------- --------------------------------------------
  6,7                       0                                                                   Block must be replicated in every fragment            \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       1                                                                   Transmit status report if block can\'t be processed   \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       2                                                                   Delete bundle if block can\'t be processed            \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6                         3                                                                   Last block                                            \[[RFC5050](#RFC5050){.xref}\]
  6,7                       4                                                                   Discard block if it can\'t be processed               \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6                         5                                                                   Block was forwarded without being processed           \[[RFC5050](#RFC5050){.xref}\]
  6                         6                                                                   Block contains an EID-reference field                 \[[RFC5050](#RFC5050){.xref}\]
                            7-63                                                                Unassigned                                            

  : [Table 5](#table-5){.selfRef}: [\"Block Processing Control Flags\"
  Registry](#name-block-processing-control-flag){.selfRef}
:::
:::

::: {#sect-9.5}
::: {#section-9.5 .section}
### [9.5.](#section-9.5){.section-number .selfRef} [Bundle Status Report Reason Codes](#name-bundle-status-report-reason){.section-name .selfRef} {#name-bundle-status-report-reason}

The \"Bundle Status Report Reason Codes\" subregistry in the \"Bundle
Protocol\" registry has been augmented by adding a column identifying
the version of the Bundle Protocol (Bundle Protocol Version) that
applies to the new values. IANA has added the following values, as
described in [Section 6.1.1](#sect-6.1.1){.xref}, to the \"Bundle Status
Report Reason Codes\" registry with a value of \"7\" for the Bundle
Protocol Version. IANA has set the Bundle Protocol Version to the value
\"6,7\" for preexisting values in the \"Bundle Status Report Reason
Codes\" registry, as shown below.[¶](#section-9.5-1){.pilcrow}

[]{#name-bundle-status-report-reason-}

  Bundle Protocol Version   Value    Description                                 Reference
  ------------------------- -------- ------------------------------------------- --------------------------------------------
  6,7                       0        No additional information                   \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       1        Lifetime expired                            \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       2        Forwarded over unidirectional link          \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       3        Transmission canceled                       \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       4        Depleted storage                            \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       5        Destination endpoint ID unavailable         \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       6        No known route to destination from here     \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       7        No timely contact with next node on route   \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  6,7                       8        Block unintelligible                        \[[RFC5050](#RFC5050){.xref}\] \[RFC9171\]
  7                         9        Hop limit exceeded                          \[RFC9171\]
  7                         10       Traffic pared                               \[RFC9171\]
  7                         11       Block unsupported                           \[RFC9171\]
                            17-254   Unassigned                                  
  6,7                       255      Reserved                                    \[[RFC6255](#RFC6255){.xref}\] \[RFC9171\]

  : [Table 6](#table-6){.selfRef}: [\"Bundle Status Report Reason
  Codes\" Registry](#name-bundle-status-report-reason-){.selfRef}
:::
:::

::: {#sect-9.6}
::: {#section-9.6 .section}
### [9.6.](#section-9.6){.section-number .selfRef} [Bundle Protocol URI Scheme Types](#name-bundle-protocol-uri-scheme-){.section-name .selfRef} {#name-bundle-protocol-uri-scheme-}

The Bundle Protocol has a URI scheme type field \-- an unsigned integer
of indefinite length \-- for which IANA has created, and will maintain,
a new \"Bundle Protocol URI Scheme Types\" subregistry in the \"Bundle
Protocol\" registry. The \"Bundle Protocol URI Scheme Types\" registry
governs a namespace of unsigned integers. Initial values for the
\"Bundle Protocol URI Scheme Types\" registry are given
below.[¶](#section-9.6-1){.pilcrow}

The registration policy for this registry is Standards Action
\[[RFC8126](#RFC8126){.xref}\]. The allocation should only be granted
for a Standards Track RFC approved by the
IESG.[¶](#section-9.6-2){.pilcrow}

The range of values is provided as unsigned
integers.[¶](#section-9.6-3){.pilcrow}

Each assignment consists of a URI scheme type name and its associated
description, a reference to the document that defines the URI scheme,
and a reference to the document that defines the use of this URI scheme
in BP endpoint IDs (including the CBOR encoding of those endpoint IDs in
transmitted bundles).[¶](#section-9.6-4){.pilcrow}

[]{#name-bundle-protocol-uri-scheme-t}

  Value       Description                BP Utilization Reference   URI Definition Reference
  ----------- -------------------------- -------------------------- --------------------------------------------
  0           Reserved                   n/a                        
  1           dtn                        \[RFC9171\]                \[RFC9171\]
  2           ipn                        \[RFC9171\]                \[[RFC6260](#RFC6260){.xref}\] \[RFC9171\]
  3-254       Unassigned                 n/a                        
  255-65535   Reserved                   n/a                        
  \>65535     Reserved for Private Use   n/a                        

  : [Table 7](#table-7){.selfRef}: [\"Bundle Protocol URI Scheme Types\"
  Registry](#name-bundle-protocol-uri-scheme-t){.selfRef}
:::
:::

::: {#sect-9.7}
::: {#section-9.7 .section}
### [9.7.](#section-9.7){.section-number .selfRef} [dtn URI Scheme](#name-dtn-uri-scheme){.section-name .selfRef} {#name-dtn-uri-scheme}

In the \"Uniform Resource Identifier (URI) Schemes\" (uri-schemes)
registry, IANA has updated the registration of the URI scheme with the
string \"dtn\" as the scheme name, as
follows:[¶](#section-9.7-1){.pilcrow}

[]{.break}

URI scheme name:
:   \"dtn\"[¶](#section-9.7-2.2){.pilcrow}
:   

Status:
:   Permanent[¶](#section-9.7-2.4){.pilcrow}
:   

Applications and/or protocols that use this URI scheme name:
:   The Delay-Tolerant Networking (DTN) Bundle Protocol
    (BP).[¶](#section-9.7-2.6){.pilcrow}
:   

Contact:

:   [Scott Burleigh]{.contact-name}
    \<sburleig.sb\@gmail.com>[¶](#section-9.7-2.8.1){.pilcrow}

:   

Change controller:
:   IETF (iesg\@ietf.org)[¶](#section-9.7-2.10){.pilcrow}
:   

Reference:
:   \[RFC9171\][¶](#section-9.7-2.12){.pilcrow}
:   
:::
:::

::: {#sect-9.8}
::: {#section-9.8 .section}
### [9.8.](#section-9.8){.section-number .selfRef} [ipn URI Scheme](#name-ipn-uri-scheme){.section-name .selfRef} {#name-ipn-uri-scheme}

In the \"Uniform Resource Identifier (URI) Schemes\" (uri-schemes)
registry, IANA has updated the registration of the URI scheme with the
string \"ipn\" as the scheme name, originally documented in RFC 6260
\[[RFC6260](#RFC6260){.xref}\], as follows.[¶](#section-9.8-1){.pilcrow}

[]{.break}

URI scheme name:
:   \"ipn\"[¶](#section-9.8-2.2){.pilcrow}
:   

Status:
:   Permanent[¶](#section-9.8-2.4){.pilcrow}
:   

Applications and/or protocols that use this URI scheme name:
:   The Delay-Tolerant Networking (DTN) Bundle Protocol
    (BP).[¶](#section-9.8-2.6){.pilcrow}
:   

Contact:

:   [Scott Burleigh]{.contact-name}
    \<sburleig.sb\@gmail.com>[¶](#section-9.8-2.8.1){.pilcrow}

:   

Change controller:
:   IETF (iesg\@ietf.org)[¶](#section-9.8-2.10){.pilcrow}
:   

Reference:
:   \[RFC9171\][¶](#section-9.8-2.12){.pilcrow}
:   
:::
:::
:::
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[BPSEC\]
:   [Birrane, III, E.]{.refAuthor} and [K. McKeever]{.refAuthor},
    [\"Bundle Protocol Security (BPSec)\"]{.refTitle}, [RFC
    9172]{.seriesInfo}, [DOI 10.17487/RFC9172]{.seriesInfo}, January
    2022, \<<https://www.rfc-editor.org/info/rfc9172>\>.
:   

\[CRC16\]
:   [ITU-T]{.refAuthor}, [\"X.25: Interface between Data Terminal
    Equipment (DTE) and Data Circuit-terminating Equipment (DCE) for
    terminals operating in the packet mode and connected to public data
    networks by dedicated circuit\"]{.refTitle}, [p. 9, Section
    2.2.7.4]{.refContent}, [ITU-T Recommendation X.25]{.seriesInfo},
    October 1996, \<<https://www.itu.int/rec/T-REC-X.25-199610-I/>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4960\]
:   [Stewart, R., Ed.]{.refAuthor}, [\"Stream Control Transmission
    Protocol\"]{.refTitle}, [RFC 4960]{.seriesInfo}, [DOI
    10.17487/RFC4960]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4960>\>.
:   

\[RFC5234\]
:   [Crocker, D., Ed.]{.refAuthor} and [P. Overell]{.refAuthor},
    [\"Augmented BNF for Syntax Specifications: ABNF\"]{.refTitle}, [STD
    68]{.seriesInfo}, [RFC 5234]{.seriesInfo}, [DOI
    10.17487/RFC5234]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5234>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8949\]
:   [Bormann, C.]{.refAuthor} and [P. Hoffman]{.refAuthor}, [\"Concise
    Binary Object Representation (CBOR)\"]{.refTitle}, [STD
    94]{.seriesInfo}, [RFC 8949]{.seriesInfo}, [DOI
    10.17487/RFC8949]{.seriesInfo}, December 2020,
    \<<https://www.rfc-editor.org/info/rfc8949>\>.
:   

\[SABR\]
:   [Consultative Committee for Space Data Systems]{.refAuthor},
    [\"Schedule-Aware Bundle Routing\"]{.refTitle}, [CCSDS Recommended
    Standard 734.3-B-1]{.seriesInfo}, July 2019,
    \<<https://public.ccsds.org/Pubs/734x3b1.pdf>\>.
:   

\[TCPCL\]
:   [Sipos, B.]{.refAuthor}, [Demmer, M.]{.refAuthor},
    [Ott, J.]{.refAuthor}, and [S. Perreault]{.refAuthor},
    [\"Delay-Tolerant Networking TCP Convergence-Layer Protocol Version
    4\"]{.refTitle}, [RFC 9174]{.seriesInfo}, [DOI
    10.17487/RFC9174]{.seriesInfo}, January 2022,
    \<<https://www.rfc-editor.org/info/rfc9174>\>.
:   

\[URI\]
:   [Berners-Lee, T.]{.refAuthor}, [Fielding, R.]{.refAuthor}, and [L.
    Masinter]{.refAuthor}, [\"Uniform Resource Identifier (URI): Generic
    Syntax\"]{.refTitle}, [STD 66]{.seriesInfo}, [RFC
    3986]{.seriesInfo}, [DOI 10.17487/RFC3986]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3986>\>.
:   

\[URIREG\]
:   [Thaler, D., Ed.]{.refAuthor}, [Hansen, T.]{.refAuthor}, and [T.
    Hardie]{.refAuthor}, [\"Guidelines and Registration Procedures for
    URI Schemes\"]{.refTitle}, [BCP 35]{.seriesInfo}, [RFC
    7595]{.seriesInfo}, [DOI 10.17487/RFC7595]{.seriesInfo}, June 2015,
    \<<https://www.rfc-editor.org/info/rfc7595>\>.
:   
:::

::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ARCH\]
:   [Cerf, V.]{.refAuthor}, [Burleigh, S.]{.refAuthor},
    [Hooke, A.]{.refAuthor}, [Torgerson, L.]{.refAuthor},
    [Durst, R.]{.refAuthor}, [Scott, K.]{.refAuthor},
    [Fall, K.]{.refAuthor}, and [H. Weiss]{.refAuthor},
    [\"Delay-Tolerant Networking Architecture\"]{.refTitle}, [RFC
    4838]{.seriesInfo}, [DOI 10.17487/RFC4838]{.seriesInfo}, April 2007,
    \<<https://www.rfc-editor.org/info/rfc4838>\>.
:   

\[BIBE\]
:   [Burleigh, S.]{.refAuthor}, [\"Bundle-in-Bundle
    Encapsulation\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-dtn-bibect-03]{.seriesInfo}, 18 February
    2020,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-dtn-bibect-03>\>.
:   

\[RFC3987\]
:   [Duerst, M.]{.refAuthor} and [M. Suignard]{.refAuthor},
    [\"Internationalized Resource Identifiers (IRIs)\"]{.refTitle}, [RFC
    3987]{.seriesInfo}, [DOI 10.17487/RFC3987]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3987>\>.
:   

\[RFC5050\]
:   [Scott, K.]{.refAuthor} and [S. Burleigh]{.refAuthor}, [\"Bundle
    Protocol Specification\"]{.refTitle}, [RFC 5050]{.seriesInfo}, [DOI
    10.17487/RFC5050]{.seriesInfo}, November 2007,
    \<<https://www.rfc-editor.org/info/rfc5050>\>.
:   

\[RFC6255\]
:   [Blanchet, M.]{.refAuthor}, [\"Delay-Tolerant Networking Bundle
    Protocol IANA Registries\"]{.refTitle}, [RFC 6255]{.seriesInfo},
    [DOI 10.17487/RFC6255]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6255>\>.
:   

\[RFC6257\]
:   [Symington, S.]{.refAuthor}, [Farrell, S.]{.refAuthor},
    [Weiss, H.]{.refAuthor}, and [P. Lovell]{.refAuthor}, [\"Bundle
    Security Protocol Specification\"]{.refTitle}, [RFC
    6257]{.seriesInfo}, [DOI 10.17487/RFC6257]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6257>\>.
:   

\[RFC6258\]
:   [Symington, S.]{.refAuthor}, [\"Delay-Tolerant Networking Metadata
    Extension Block\"]{.refTitle}, [RFC 6258]{.seriesInfo}, [DOI
    10.17487/RFC6258]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6258>\>.
:   

\[RFC6259\]
:   [Symington, S.]{.refAuthor}, [\"Delay-Tolerant Networking
    Previous-Hop Insertion Block\"]{.refTitle}, [RFC 6259]{.seriesInfo},
    [DOI 10.17487/RFC6259]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6259>\>.
:   

\[RFC6260\]
:   [Burleigh, S.]{.refAuthor}, [\"Compressed Bundle Header Encoding
    (CBHE)\"]{.refTitle}, [RFC 6260]{.seriesInfo}, [DOI
    10.17487/RFC6260]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6260>\>.
:   

\[RFC7143\]
:   [Chadalapaka, M.]{.refAuthor}, [Satran, J.]{.refAuthor},
    [Meth, K.]{.refAuthor}, and [D. Black]{.refAuthor}, [\"Internet
    Small Computer System Interface (iSCSI) Protocol
    (Consolidated)\"]{.refTitle}, [RFC 7143]{.seriesInfo}, [DOI
    10.17487/RFC7143]{.seriesInfo}, April 2014,
    \<<https://www.rfc-editor.org/info/rfc7143>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[SIGC\]
:   [Fall, K.]{.refAuthor}, [\"A Delay-Tolerant Network Architecture for
    Challenged Internets\"]{.refTitle}, [SIGCOMM 2003]{.refContent},
    [DOI 10.1145/863955.863960]{.seriesInfo}, August 2003,
    \<<https://dl.acm.org/doi/10.1145/863955.863960>\>.
:   
:::
:::

::: {#app-a}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Significant Changes from RFC 5050](#name-significant-changes-from-rf){.section-name .selfRef} {#name-significant-changes-from-rf}

This document makes the following significant changes from RFC
5050:[¶](#appendix-A-1){.pilcrow}

-   [Clarifies the difference between transmission and
    forwarding.[¶](#appendix-A-2.1){.pilcrow}]{#appendix-A-2.1}
-   [Migrates custody transfer to the bundle-in-bundle encapsulation
    specification
    \[[BIBE](#I-D.ietf-dtn-bibect){.xref}\].[¶](#appendix-A-2.2){.pilcrow}]{#appendix-A-2.2}
-   [Introduces the concept of \"node ID\" as functionally distinct from
    endpoint ID, while having the same
    syntax.[¶](#appendix-A-2.3){.pilcrow}]{#appendix-A-2.3}
-   [Restructures primary block, making it immutable. Adds optional
    CRC.[¶](#appendix-A-2.4){.pilcrow}]{#appendix-A-2.4}
-   [Adds optional CRCs to non-primary
    blocks.[¶](#appendix-A-2.5){.pilcrow}]{#appendix-A-2.5}
-   [Adds block ID number to canonical block format (to support
    BPSec).[¶](#appendix-A-2.6){.pilcrow}]{#appendix-A-2.6}
-   [Adds definition of Bundle Age extension
    block.[¶](#appendix-A-2.7){.pilcrow}]{#appendix-A-2.7}
-   [Adds definition of Previous Node extension
    block.[¶](#appendix-A-2.8){.pilcrow}]{#appendix-A-2.8}
-   [Adds definition of Hop Count extension
    block.[¶](#appendix-A-2.9){.pilcrow}]{#appendix-A-2.9}
-   [Removes Quality of Service
    markings.[¶](#appendix-A-2.10){.pilcrow}]{#appendix-A-2.10}
-   [Changes from Self-Delimiting Numeric Values (SDNVs) to CBOR
    encoding.[¶](#appendix-A-2.11){.pilcrow}]{#appendix-A-2.11}
-   [Adds lifetime
    overrides.[¶](#appendix-A-2.12){.pilcrow}]{#appendix-A-2.12}
-   [Clarifies that time values are denominated in milliseconds, not
    seconds.[¶](#appendix-A-2.13){.pilcrow}]{#appendix-A-2.13}
:::
:::

::: {#app-c}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [CDDL Expression](#name-cddl-expression){.section-name .selfRef} {#name-cddl-expression}

For informational purposes, Carsten Bormann and Brian Sipos have kindly
provided an expression of the Bundle Protocol specification in the
Concise Data Definition Language (CDDL). That CDDL expression is
presented below. Note that wherever the CDDL expression is in
disagreement with the textual representation of the BP specification
presented in the earlier sections of this document, the textual
representation rules.[¶](#appendix-B-1){.pilcrow}

::: {#appendix-B-2}
``` {.lang-cddl .sourcecode}
   bpv7_start = bundle / #6.55799(bundle)

   ; Times before 2000 are invalid

   dtn-time = uint

   ; CRC enumerated type

   crc-type = &(

     crc-none: 0,

     crc-16bit: 1,

     crc-32bit: 2

   )

   ; Either 16-bit or 32-bit

   crc-value = (bstr .size 2) / (bstr .size 4)

   creation-timestamp = [

     dtn-time, ; absolute time of creation

     sequence: uint ; sequence within the time

   ]

   eid = $eid .within eid-structure

   eid-structure = [

     uri-code: uint,

     SSP: any

   ]

   $eid /= [

     uri-code: 1,

     SSP: (tstr / 0)

   ]

   $eid /= [

     uri-code: 2,

     SSP: [

       nodenum: uint,

       servicenum: uint

     ]

   ]

   ; The root bundle array

   bundle = [primary-block, *extension-block, payload-block]

   primary-block = [

     version: 7,

     bundle-control-flags,

     crc-type,

     destination: eid,

     source-node: eid,

     report-to: eid,

     creation-timestamp,

     lifetime: uint,

     ? (

       fragment-offset: uint,

       total-application-data-length: uint

     ),

     ? crc-value,

   ]

   bundle-control-flags = uint .bits bundleflagbits

   bundleflagbits = &(

     reserved: 20,

     reserved: 19,

     bundle-deletion-status-reports-are-requested: 18,

     bundle-delivery-status-reports-are-requested: 17,

     bundle-forwarding-status-reports-are-requested: 16,

     reserved: 15,

     bundle-reception-status-reports-are-requested: 14,

     reserved: 13,

     reserved: 12,

     reserved: 11,

     reserved: 10,

     reserved: 9,

     reserved: 8,

     reserved: 7,

     status-time-is-requested-in-all-status-reports: 6,

     user-application-acknowledgement-is-requested: 5,

     reserved: 4,

     reserved: 3,

     bundle-must-not-be-fragmented: 2,

     payload-is-an-administrative-record: 1,

     bundle-is-a-fragment: 0

   )

   ; Abstract shared structure of all non-primary blocks

   canonical-block-structure = [

     block-type-code: uint,

     block-number: uint,

     block-control-flags,

     crc-type,

     ; Each block type defines the content within the byte string

     block-type-specific-data,

     ? crc-value

   ]

   block-control-flags = uint .bits blockflagbits

   blockflagbits = &(

     reserved: 7,

     reserved: 6,

     reserved: 5,

     block-must-be-removed-from-bundle-if-it-cannot-be-processed: 4,

     reserved: 3,

     bundle-must-be-deleted-if-block-cannot-be-processed: 2,

     status-report-must-be-transmitted-if-block-cannot-be-processed:
     1,

     block-must-be-replicated-in-every-fragment: 0

   )

   block-type-specific-data = bstr / #6.24(bstr)

   ; Actual CBOR data embedded in a byte string, with optional tag to
   indicate so.

   ; Additional plain bstr allows ciphertext data.

   embedded-cbor<Item> = (bstr .cbor Item) / #6.24(bstr .cbor Item) /
   bstr

   ; Extension block type, which does not specialize other than the
   code/number

   extension-block =
   $extension-block .within canonical-block-structure

   ; Generic shared structure of all non-primary blocks

   extension-block-use<CodeValue, BlockData> = [

     block-type-code: CodeValue,

     block-number: (uint .gt 1),

     block-control-flags,

     crc-type,

     BlockData,

     ? crc-value

   ]

   ; Payload block type

   payload-block = payload-block-structure .within canonical-block-
   structure

   payload-block-structure = [

     block-type-code: 1,

     block-number: 1,

     block-control-flags,

     crc-type,

     $payload-block-data,

     ? crc-value

   ]

   ; Arbitrary payload data, including non-CBOR byte string

   $payload-block-data /= block-type-specific-data

   ; Administrative record as a payload data specialization

   $payload-block-data /= embedded-cbor<admin-record>

   admin-record = $admin-record .within admin-record-structure

   admin-record-structure = [

     record-type-code: uint,

     record-content: any

   ]

   ; Only one defined record type

   $admin-record /= [1, status-record-content]

   status-record-content = [

     bundle-status-information,

     status-report-reason-code: uint,

     source-node-eid: eid,

     subject-creation-timestamp: creation-timestamp,

     ? (

       subject-payload-offset: uint,

       subject-payload-length: uint

     )

   ]

   bundle-status-information = [

     reporting-node-received-bundle: status-info-content,

     reporting-node-forwarded-bundle: status-info-content,

     reporting-node-delivered-bundle: status-info-content,

     reporting-node-deleted-bundle: status-info-content

   ]

   status-info-content = [

     status-indicator: bool,

     ? timestamp: dtn-time

   ]

   ; Previous Node extension block

   $extension-block /=

     extension-block-use<6, embedded-cbor<ext-data-previous-node>>

   ext-data-previous-node = eid

   ; Bundle Age extension block

   $extension-block /=

     extension-block-use<7, embedded-cbor<ext-data-bundle-age>>

   ext-data-bundle-age = uint

   ; Hop Count extension block

   $extension-block /=

     extension-block-use<10, embedded-cbor<ext-data-hop-count>>

   ext-data-hop-count = [

     hop-limit: uint,

     hop-count: uint

   ]
```

[¶](#appendix-B-2){.pilcrow}
:::
:::
:::

::: {#acks-section}
::: {#appendix-C .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

This work is freely adapted from RFC 5050, which was an effort of the
Delay-Tolerant Networking Research Group. The following DTNRG
participants contributed significant technical material and/or inputs to
that document: [Dr. Vinton Cerf]{.contact-name} of Google; [Scott
Burleigh]{.contact-name}, [Adrian Hooke]{.contact-name}, and [Leigh
Torgerson]{.contact-name} of the Jet Propulsion Laboratory; [Michael
Demmer]{.contact-name} of the University of California at Berkeley;
[Robert Durst]{.contact-name}, [Keith Scott]{.contact-name}, and [Susan
Symington]{.contact-name} of The MITRE Corporation; [Kevin
Fall]{.contact-name} of Carnegie Mellon University; [Stephen
Farrell]{.contact-name} of Trinity College Dublin; [Howard
Weiss]{.contact-name} and [Peter Lovell]{.contact-name} of SPARTA, Inc.;
and [Manikantan Ramadas]{.contact-name} of Ohio
University.[¶](#appendix-C-1){.pilcrow}

Scott Burleigh would like to thank the Jet Propulsion Laboratory,
California Institute of Technology, for its generous and sustained
support of this work.[¶](#appendix-C-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Scott Burleigh]{.fn .nameRole}
:::

::: {.left dir="auto"}
[IPNGROUP]{.org}
:::

::: {.left dir="auto"}
[1435 Woodhurst Blvd.]{.street-address}
:::

::: {.left dir="auto"}
[McLean]{.locality}, [VA]{.region} [22102]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <sburleig.sb@gmail.com>
:::

::: {.left dir="auto"}
[Kevin Fall]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Roland Computing Services]{.org}
:::

::: {.left dir="auto"}
[3871 Piedmont Ave. Suite 8]{.street-address}
:::

::: {.left dir="auto"}
[Oakland]{.locality}, [CA]{.region} [94611]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <kfall+rcs@kfall.com>
:::

::: {.left dir="auto"}
[Edward J. Birrane, III]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Johns Hopkins University Applied Physics Laboratory]{.org}
:::

::: {.left dir="auto"}
[11100 Johns Hopkins Rd]{.street-address}
:::

::: {.left dir="auto"}
[Laurel]{.locality}, [MD]{.region} [20723]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 443 778 7423](tel:+1%20443%20778%207423){.tel}
:::

::: email
Email: <Edward.Birrane@jhuapl.edu>
:::
:::
:::
