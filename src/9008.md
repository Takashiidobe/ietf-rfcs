  RFC 9008         RPL Data Plane    April 2021
  ---------------- ----------------- ------------
  Robles, et al.   Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9008](https://www.rfc-editor.org/rfc/rfc9008){.eref}

Updates:
:   [6550](https://www.rfc-editor.org/rfc/rfc6550){.eref},
    [6553](https://www.rfc-editor.org/rfc/rfc6553){.eref},
    [8138](https://www.rfc-editor.org/rfc/rfc8138){.eref}

Category:
:   Standards Track

Published:
:   April 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    M.I. Robles
    :::

    ::: org
    UTN-FRM/Aalto
    :::
    :::

    ::: author
    ::: author-name
    M. Richardson
    :::

    ::: org
    SSW
    :::
    :::

    ::: author
    ::: author-name
    P. Thubert
    :::

    ::: org
    Cisco
    :::
    :::
:::

# RFC 9008 {#rfcnum}

# Using RPI Option Type, Routing Header for Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data Plane {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document looks at different data flows through Low-Power and Lossy
Networks (LLN) where RPL (IPv6 Routing Protocol for Low-Power and Lossy
Networks) is used to establish routing. The document enumerates the
cases where RPL Packet Information (RPI) Option Type (RFC 6553), RPL
Source Route Header (RFC 6554), and IPv6-in-IPv6 encapsulation are
required in the data plane. This analysis provides the basis upon which
to design efficient compression of these headers. This document updates
RFC 6553 by adding a change to the RPI Option Type. Additionally, this
document updates RFC 6550 by defining a flag in the DODAG Information
Object (DIO) Configuration option to indicate this change and updates
RFC 8138 as well to consider the new Option Type when the RPL Option is
decompressed.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9008>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Overview](#name-overview){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology and Requirements
    Language](#name-terminology-and-requirement){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [RPL Overview](#name-rpl-overview){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Updates to RFC 6550, RFC 6553, and RFC
    8138](#name-updates-to-rfc-6550-rfc-655){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Updates to RFC
        6550](#name-updates-to-rfc-6550){.xref}

        -   ::: {#section-toc.1-1.4.2.1.2.1}
            [4.1.1](#section-4.1.1){.xref}.  [Advertising External
            Routes with Non-Storing Mode
            Signaling](#name-advertising-external-routes){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.1.2.2}
            [4.1.2](#section-4.1.2){.xref}.  [Configuration Options and
            Mode of Operation](#name-configuration-options-and-m){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.1.2.3}
            [4.1.3](#section-4.1.3){.xref}.  [Indicating the New RPI in
            the DODAG Configuration Option
            Flag](#name-indicating-the-new-rpi-in-t){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Updates to RFC 6553: Indicating
        the New RPI Option
        Type](#name-updates-to-rfc-6553-indicat){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Updates to RFC 8138: Indicating
        the Way to Decompress with the New RPI Option
        Type](#name-updates-to-rfc-8138-indicat){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Reference
    Topology](#name-reference-topology){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Use Cases](#name-use-cases){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Storing Mode](#name-storing-mode){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Storing Mode: Interaction between
        Leaf and Root](#name-storing-mode-interaction-be){.xref}

        -   ::: {#section-toc.1-1.7.2.1.2.1}
            [7.1.1](#section-7.1.1){.xref}.  [SM: Example of Flow from
            RAL to Root](#name-sm-example-of-flow-from-ral){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.1.2.2}
            [7.1.2](#section-7.1.2){.xref}.  [SM: Example of Flow from
            Root to RAL](#name-sm-example-of-flow-from-roo){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.1.2.3}
            [7.1.3](#section-7.1.3){.xref}.  [SM: Example of Flow from
            Root to RUL](#name-sm-example-of-flow-from-root){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.1.2.4}
            [7.1.4](#section-7.1.4){.xref}.  [SM: Example of Flow from
            RUL to Root](#name-sm-example-of-flow-from-rul){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [SM: Interaction between Leaf and
        Internet](#name-sm-interaction-between-leaf){.xref}

        -   ::: {#section-toc.1-1.7.2.2.2.1}
            [7.2.1](#section-7.2.1){.xref}.  [SM: Example of Flow from
            RAL to Internet](#name-sm-example-of-flow-from-ral-){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.2.2.2}
            [7.2.2](#section-7.2.2){.xref}.  [SM: Example of Flow from
            Internet to RAL](#name-sm-example-of-flow-from-int){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.2.2.3}
            [7.2.3](#section-7.2.3){.xref}.  [SM: Example of Flow from
            RUL to Internet](#name-sm-example-of-flow-from-rul-){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.2.2.4}
            [7.2.4](#section-7.2.4){.xref}.  [SM: Example of Flow from
            Internet to RUL](#name-sm-example-of-flow-from-inte){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [SM: Interaction between Leaf and
        Leaf](#name-sm-interaction-between-leaf-){.xref}

        -   ::: {#section-toc.1-1.7.2.3.2.1}
            [7.3.1](#section-7.3.1){.xref}.  [SM: Example of Flow from
            RAL to RAL](#name-sm-example-of-flow-from-ral-t){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.2}
            [7.3.2](#section-7.3.2){.xref}.  [SM: Example of Flow from
            RAL to RUL](#name-sm-example-of-flow-from-ral-to){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.3}
            [7.3.3](#section-7.3.3){.xref}.  [SM: Example of Flow from
            RUL to RAL](#name-sm-example-of-flow-from-rul-t){.xref}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.4}
            [7.3.4](#section-7.3.4){.xref}.  [SM: Example of Flow from
            RUL to RUL](#name-sm-example-of-flow-from-rul-to){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Non-Storing
    Mode](#name-non-storing-mode){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Non-Storing Mode: Interaction
        between Leaf and Root](#name-non-storing-mode-interactio){.xref}

        -   ::: {#section-toc.1-1.8.2.1.2.1}
            [8.1.1](#section-8.1.1){.xref}.  [Non-SM: Example of Flow
            from RAL to Root](#name-non-sm-example-of-flow-from){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.1.2.2}
            [8.1.2](#section-8.1.2){.xref}.  [Non-SM: Example of Flow
            from Root to RAL](#name-non-sm-example-of-flow-from-){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.1.2.3}
            [8.1.3](#section-8.1.3){.xref}.  [Non-SM: Example of Flow
            from Root to
            RUL](#name-non-sm-example-of-flow-from-r){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.1.2.4}
            [8.1.4](#section-8.1.4){.xref}.  [Non-SM: Example of Flow
            from RUL to
            Root](#name-non-sm-example-of-flow-from-ru){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Non-Storing Mode: Interaction
        between Leaf and
        Internet](#name-non-storing-mode-interaction){.xref}

        -   ::: {#section-toc.1-1.8.2.2.2.1}
            [8.2.1](#section-8.2.1){.xref}.  [Non-SM: Example of Flow
            from RAL to
            Internet](#name-non-sm-example-of-flow-from-ra){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.2.2.2}
            [8.2.2](#section-8.2.2){.xref}.  [Non-SM: Example of Flow
            from Internet to
            RAL](#name-non-sm-example-of-flow-from-i){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.2.2.3}
            [8.2.3](#section-8.2.3){.xref}.  [Non-SM: Example of Flow
            from RUL to
            Internet](#name-non-sm-example-of-flow-from-rul){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.2.2.4}
            [8.2.4](#section-8.2.4){.xref}.  [Non-SM: Example of Flow
            from Internet to
            RUL](#name-non-sm-example-of-flow-from-in){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [Non-SM: Interaction between
        Leaves](#name-non-sm-interaction-between-){.xref}

        -   ::: {#section-toc.1-1.8.2.3.2.1}
            [8.3.1](#section-8.3.1){.xref}.  [Non-SM: Example of Flow
            from RAL to
            RAL](#name-non-sm-example-of-flow-from-ral){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.2}
            [8.3.2](#section-8.3.2){.xref}.  [Non-SM: Example of Flow
            from RAL to
            RUL](#name-non-sm-example-of-flow-from-ral-){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.3}
            [8.3.3](#section-8.3.3){.xref}.  [Non-SM: Example of Flow
            from RUL to
            RAL](#name-non-sm-example-of-flow-from-rul-){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.4}
            [8.3.4](#section-8.3.4){.xref}.  [Non-SM: Example of Flow
            from RUL to
            RUL](#name-non-sm-example-of-flow-from-rul-t){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Operational Considerations of Supporting
    RULs](#name-operational-considerations-){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Operational Considerations of Introducing
    0x23](#name-operational-considerations-o){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [Option Type in RPL
        Option](#name-option-type-in-rpl-option-2){.xref}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Change to the \"DODAG
        Configuration Option Flags\"
        Subregistry](#name-change-to-the-dodag-configu){.xref}
        :::

    -   ::: {#section-toc.1-1.11.2.3}
        [11.3](#section-11.3){.xref}.  [Change MOP Value 7 to
        Reserved](#name-change-mop-value-7-to-reser){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [13](#section-13){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.13.2.1}
        [13.1](#section-13.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.13.2.2}
        [13.2](#section-13.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.a){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

RPL (IPv6 Routing Protocol for Low-Power and Lossy Networks)
\[[RFC6550](#RFC6550){.xref}\] is a routing protocol for constrained
networks. \[[RFC6553](#RFC6553){.xref}\] defines the RPL Option carried
within the IPv6 Hop-by-Hop Options header to carry the RPLInstanceID and
quickly identify inconsistencies (loops) in the routing topology. The
RPL Option is commonly referred to as the RPL Packet Information (RPI),
although the RPI is the routing information that is defined in
\[[RFC6550](#RFC6550){.xref}\] and transported in the RPL Option. RFC
6554 \[[RFC6554](#RFC6554){.xref}\] defines the \"RPL Source Route
Header\" (RH3), an IPv6 extension header to deliver datagrams within a
RPL routing domain, particularly in Non-Storing
mode.[¶](#section-1-1){.pilcrow}

These various items are referred to as RPL artifacts, and they are seen
on all of the data plane traffic that occurs in RPL-routed networks;
they do not, in general, appear on the RPL control plane at all, which
is mostly hop-by-hop traffic (one exception being Destination
Advertisement Object (DAO) messages in Non-Storing
mode).[¶](#section-1-2){.pilcrow}

It has become clear from attempts to do multi-vendor interoperability,
and from a desire to compress as many of the above artifacts as
possible, that not all implementers agree when artifacts are necessary,
or when they can be safely omitted, or
removed.[¶](#section-1-3){.pilcrow}

The ROLL (Routing Over Low power and Lossy networks) Working Group
analyzed how IPv6 rules \[[RFC2460](#RFC2460){.xref}\] apply to the
Storing and Non-Storing use of RPL. The result was 24 data-plane use
cases. They are exhaustively outlined here in order to be completely
unambiguous. During the processing of this document, new rules were
published as \[[RFC8200](#RFC8200){.xref}\], and this document was
updated to reflect the normative changes in that
document.[¶](#section-1-4){.pilcrow}

This document updates \[[RFC6553](#RFC6553){.xref}\], changing the value
of the Option Type of the RPL Option to make routers compliant with
\[[RFC8200](#RFC8200){.xref}\] ignore this option when it is not
recognized.[¶](#section-1-5){.pilcrow}

A Routing Header Dispatch for IPv6 over Low-Power Wireless Personal Area
Networks (6LoWPAN) (6LoRH) \[[RFC8138](#RFC8138){.xref}\] defines a
mechanism for compressing RPL Option information and Routing Header type
3 (RH3) \[[RFC6554](#RFC6554){.xref}\], as well as an efficient
IPv6-in-IPv6 technique.[¶](#section-1-6){.pilcrow}

Most of the use cases described herein require the use of IPv6-in-IPv6
packet encapsulation. When encapsulating and decapsulating packets,
\[[RFC6040](#RFC6040){.xref}\] [MUST]{.bcp14} be applied to map the
setting of the explicit congestion notification (ECN) field between
inner and outer headers. Additionally,
\[[TUNNELS](#I-D.ietf-intarea-tunnels){.xref}\] is recommended reading
to explain the relationship of IP tunnels to existing protocol layers
and the challenges in supporting IP
tunneling.[¶](#section-1-7){.pilcrow}

Unconstrained uses of RPL are not in scope of this document, and
applicability statements for those uses may provide different advice,
e.g.,
\[[ACP](#I-D.ietf-anima-autonomic-control-plane){.xref}\].[¶](#section-1-8){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Overview](#name-overview){.section-name .selfRef} {#name-overview}

The rest of the document is organized as follows: [Section
2](#sec_terms){.xref} describes the terminology that is used. [Section
3](#sec_rpl_overview){.xref} provides a RPL overview. [Section
4](#updateRFCs_section){.xref} describes the updates to RFC 6553, RFC
6550, and RFC 8138. [Section 5](#sec_ref_topo){.xref} provides the
reference topology used for the use cases. [Section
6](#sec_use_cases){.xref} describes the use cases included. [Section
7](#sec_sm){.xref} describes the Storing mode cases and [Section
8](#sec_non-sm){.xref} the Non-Storing mode cases. [Section
9](#notrplaware){.xref} describes the operational considerations of
supporting RPL-unaware leaves. [Section 10](#sec_op_con_0x23){.xref}
depicts operational considerations for the proposed change on RPI Option
Type, [Section 11](#iana){.xref} the IANA considerations, and then
[Section 12](#Security){.xref} describes the security
aspects.[¶](#section-1.1-1){.pilcrow}
:::
:::

::: {#sec_terms}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology and Requirements Language](#name-terminology-and-requirement){.section-name .selfRef} {#name-terminology-and-requirement}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

The following terminology defined in \[[RFC7102](#RFC7102){.xref}\]
applies to this document: LLN, RPL, RPL domain, and
ROLL.[¶](#section-2-2){.pilcrow}

[]{.break}

Consumed:
:   A Routing Header is consumed when the Segments Left field is zero,
    which indicates that the destination in the IPv6 header is the final
    destination of the packet and that the hops in the Routing Header
    have been traversed.[¶](#section-2-3.2){.pilcrow}
:   

RPL Leaf:
:   An IPv6 host that is attached to a RPL router and obtains
    connectivity through a RPL Destination-Oriented Directed Acyclic
    Graph (DODAG). As an IPv6 node, a RPL leaf is expected to ignore a
    consumed Routing Header, and as an IPv6 host, it is expected to
    ignore a Hop-by-Hop Options header. Thus, a RPL leaf can correctly
    receive a packet with RPL artifacts. On the other hand, a RPL leaf
    is not expected to generate RPL artifacts or to support IP-in-IP
    encapsulation. For simplification, this document uses the standalone
    term leaf to mean a RPL leaf.[¶](#section-2-3.4){.pilcrow}
:   

RPL Packet Information (RPI):
:   The information defined abstractly in \[[RFC6550](#RFC6550){.xref}\]
    to be placed in IP packets. The term is commonly used, including in
    this document, to refer to the RPL Option
    \[[RFC6553](#RFC6553){.xref}\] that transports that abstract
    information in an IPv6 Hop-by-Hop Options header.
    \[[RFC8138](#RFC8138){.xref}\] provides an alternate (more
    compressed) formatting for the same abstract
    information.[¶](#section-2-3.6){.pilcrow}
:   

RPL-Aware Node (RAN):
:   A device that implements RPL. Please note that the device can be
    found inside the LLN or outside LLN.[¶](#section-2-3.8){.pilcrow}
:   

RPL-Aware Leaf (RAL):
:   A RPL-aware node that is also a RPL
    leaf.[¶](#section-2-3.10){.pilcrow}
:   

RPL-Unaware Node:
:   A device that does not implement RPL, thus the device is RPL
    unaware. Please note that the device can be found inside the
    LLN.[¶](#section-2-3.12){.pilcrow}
:   

RPL-Unaware Leaf (RUL):
:   A RPL-unaware node that is also a RPL
    leaf.[¶](#section-2-3.14){.pilcrow}
:   

6LoWPAN Node (6LN):
:   \[[RFC6775](#RFC6775){.xref}\] defines it as the following: \"A
    6LoWPAN node is any host or router participating in a LoWPAN. This
    term is used when referring to situations in which either a host or
    router can play the role described.\" In this document, a 6LN acts
    as a leaf.[¶](#section-2-3.16){.pilcrow}
:   

6LoWPAN Router (6LR):
:   \[[RFC6775](#RFC6775){.xref}\] defines it as the following: \"An
    intermediate router in the LoWPAN that is able to send and receive
    Router Advertisements (RAs) and Router Solicitations (RSs) as well
    as forward and route IPv6 packets. 6LoWPAN routers are present only
    in route-over topologies.\"[¶](#section-2-3.18){.pilcrow}
:   

6LoWPAN Border Router (6LBR):
:   \[[RFC6775](#RFC6775){.xref}\] defines it as the following: \"A
    border router located at the junction of separate 6LoWPAN networks
    or between a 6LoWPAN network and another IP network. There may be
    one or more 6LBRs at the 6LoWPAN network boundary. A 6LBR is the
    responsible authority for IPv6 prefix propagation for the 6LoWPAN
    network it is serving. An isolated LoWPAN also contains a 6LBR in
    the network, which provides the prefix(es) for the isolated
    network.\"[¶](#section-2-3.20){.pilcrow}
:   

Flag Day:
:   A flag day is caused when a network is reconfigured in a way that
    nodes running the older configuration cannot communicate with nodes
    running the new configuration. An example of a flag day is when the
    ARPANET changed from IP version 3 to IP version 4 on January 1, 1983
    \[[RFC0801](#RFC0801){.xref}\]. In the context of this document, a
    switch from RPI Option Type (0x63) to Option Type (0x23) presents as
    a disruptive changeover. In order to reduce the amount of time for
    such a changeover, [Section 4.1.3](#update6550){.xref} provides a
    mechanism to allow nodes to be incrementally
    upgraded.[¶](#section-2-3.22){.pilcrow}
:   

Non-Storing Mode (Non-SM):
:   A RPL mode of operation in which the RPL-aware nodes send
    information to the root about their parents. Thus, the root knows
    the topology. Because the root knows the topology, the intermediate
    6LRs do not maintain routing state, and source routing is
    needed.[¶](#section-2-3.24){.pilcrow}
:   

Storing Mode (SM):
:   A RPL mode of operation in which RPL-aware nodes (6LRs) maintain
    routing state (of the children) so that source routing is not
    needed.[¶](#section-2-3.26){.pilcrow}
:   

Note: Due to lack of space in some tables, we refer to IPv6-in-IPv6 as
IP6-IP6.[¶](#section-2-4.1){.pilcrow}
:::
:::

::: {#sec_rpl_overview}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [RPL Overview](#name-rpl-overview){.section-name .selfRef} {#name-rpl-overview}

RPL defines the RPL control message (control plane), which is an ICMPv6
message \[[RFC4443](#RFC4443){.xref}\] with a Type of 155. DIS (DODAG
Information Solicitation), DIO (DODAG Information Object), and DAO
(Destination Advertisement Object) messages are all RPL control messages
but with different Code values. A RPL stack is shown in [Figure
1](#fig_RPLStack){.xref}.[¶](#section-3-1){.pilcrow}

[]{#name-rpl-stack}

::: {#fig_RPLStack}
::: {#section-3-2.1 .artwork .art-text .alignLeft}
    +--------------+
    | Upper Layers |
    |              |
    +--------------+
    |   RPL        |
    |              |
    +--------------+
    |   ICMPv6     |
    |              |
    +--------------+
    |   IPv6       |
    |              |
    +--------------+
    |   6LoWPAN    |
    |              |
    +--------------+
    |   PHY-MAC    |
    |              |
    +--------------+
:::

[Figure 1](#figure-1){.selfRef}: [RPL Stack](#name-rpl-stack){.selfRef}
:::

RPL supports two modes of Downward internal traffic: in Storing mode
(SM), it is fully stateful; in Non-Storing mode (non-SM), it is fully
source routed. A RPL Instance is either fully Storing or fully
Non-Storing, i.e., a RPL Instance with a combination of fully Storing
and Non-Storing nodes is not supported with the current specifications
at the time of writing this document. External routes are advertised
with non-SM messaging even in an SM network, see [Section
4.1.1](#nnstext){.xref}[¶](#section-3-3){.pilcrow}
:::
:::

::: {#updateRFCs_section}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Updates to RFC 6550, RFC 6553, and RFC 8138](#name-updates-to-rfc-6550-rfc-655){.section-name .selfRef} {#name-updates-to-rfc-6550-rfc-655}

::: {#updateRFC_section6550}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Updates to RFC 6550](#name-updates-to-rfc-6550){.section-name .selfRef} {#name-updates-to-rfc-6550}

::: {#nnstext}
::: {#section-4.1.1 .section}
#### [4.1.1.](#section-4.1.1){.section-number .selfRef} [Advertising External Routes with Non-Storing Mode Signaling](#name-advertising-external-routes){.section-name .selfRef} {#name-advertising-external-routes}

[Section
6.7.8](https://www.rfc-editor.org/rfc/rfc6550#section-6.7.8){.relref} of
\[[RFC6550](#RFC6550){.xref}\] introduces the \'E\' flag that is set to
indicate that the 6LR that generates the DAO redistributes external
targets into the RPL network. An external target is a target that has
been learned through an alternate protocol, for instance, a route to a
prefix that is outside the RPL domain but reachable via a 6LR. Being
outside of the RPL domain, a node that is reached via an external target
cannot be guaranteed to ignore the RPL artifacts and cannot be expected
to process the compression defined in \[[RFC8138](#RFC8138){.xref}\]
correctly. This means that the RPL artifacts should be contained in an
IP-in-IP encapsulation that is removed by the 6LR, and that any
remaining compression should be expanded by the 6LR before it forwards a
packet outside the RPL domain.[¶](#section-4.1.1-1){.pilcrow}

This specification updates \[[RFC6550](#RFC6550){.xref}\] to say that
advertising external targets using Non-Storing mode DAO messaging even
in a Storing mode network is [RECOMMENDED]{.bcp14}. This way, external
routes are not advertised within the DODAG, and all packets to an
external target reach the root like normal Non-Storing mode traffic. The
Non-Storing mode DAO informs the root of the address of the 6LR that
injects the external route, and the root uses IP-in-IP encapsulation to
that 6LR, which terminates the IP-in-IP tunnel and forwards the original
packet outside the RPL domain free of RPL
artifacts.[¶](#section-4.1.1-2){.pilcrow}

In the other direction, for traffic coming from an external target into
the LLN, the parent (6LR) that injects the traffic always encapsulates
to the root. This whole operation is transparent to intermediate routers
that only see traffic between the 6LR and the root, and only the root
and the 6LRs that inject external routes in the network need to be
upgraded to add this function to the
network.[¶](#section-4.1.1-3){.pilcrow}

A RUL is a special case of external target when the target is actually a
host, and it is known to support a consumed Routing Header and to ignore
a Hop-by-Hop Options header as prescribed by
\[[RFC8200](#RFC8200){.xref}\]. The target may have been learned through
an external routing protocol or may have been registered to the 6LR
using \[[RFC8505](#RFC8505){.xref}\].[¶](#section-4.1.1-4){.pilcrow}

In order to enable IP-in-IP all the way to a 6LN, it is beneficial that
the 6LN supports decapsulating IP-in-IP, but that is not assumed by
\[[RFC8504](#RFC8504){.xref}\]. If the 6LN is a RUL, the root that
encapsulates a packet [SHOULD]{.bcp14} terminate the tunnel at a parent
6LR. The root may encapsulate all the way to the RUL if it is aware that
the RUL supports IP-in-IP decapsulation and the artifacts in the outer
header chain.[¶](#section-4.1.1-5){.pilcrow}

A node that is reachable over an external route is not expected to
support \[[RFC8138](#RFC8138){.xref}\]. Whether a decapsulation took
place or not and even when the 6LR is delivering the packet to a RUL,
the 6LR that injected an external route [MUST]{.bcp14} undo the
\[[RFC8138](#RFC8138){.xref}\] compression on the packet before
forwarding over that external route.[¶](#section-4.1.1-6){.pilcrow}
:::
:::

::: {#mopchanges}
::: {#section-4.1.2 .section}
#### [4.1.2.](#section-4.1.2){.section-number .selfRef} [Configuration Options and Mode of Operation](#name-configuration-options-and-m){.section-name .selfRef} {#name-configuration-options-and-m}

[Section
6.7.6](https://www.rfc-editor.org/rfc/rfc6550#section-6.7.6){.relref} of
\[[RFC6550](#RFC6550){.xref}\] describes the DODAG Configuration option
as containing a series of flags in the first octet of the
payload.[¶](#section-4.1.2-1){.pilcrow}

Anticipating future work to revise RPL relating to how the LLN and DODAG
are configured, this document renames the IANA \"DODAG Configuration
Option Flags\" subregistry so that it applies to Mode of Operation (MOP)
values zero (0) through six (6) only, leaving the flags unassigned for
MOP value seven (7). The MOP is described in
\[[RFC6550](#RFC6550){.xref}\], [Section
6.3.1](https://www.rfc-editor.org/rfc/rfc6550#section-6.3.1){.relref}.[¶](#section-4.1.2-2){.pilcrow}

In addition, this document reserves MOP value 7 for future
expansion.[¶](#section-4.1.2-3){.pilcrow}

See Sections [11.2](#sec_op_flags_reg){.xref} and
[11.3](#sec_mop_val_change){.xref}.[¶](#section-4.1.2-4){.pilcrow}
:::
:::

::: {#update6550}
::: {#section-4.1.3 .section}
#### [4.1.3.](#section-4.1.3){.section-number .selfRef} [Indicating the New RPI in the DODAG Configuration Option Flag](#name-indicating-the-new-rpi-in-t){.section-name .selfRef} {#name-indicating-the-new-rpi-in-t}

In order to avoid a flag day caused by lack of interoperation between
nodes of the new RPI Option Type (0x23) and old RPI Option Type (0x63),
this section defines a flag in the DODAG Configuration option, to
indicate when the new RPI Option Type can be safely used. This means
that the flag is going to indicate the value of Option Type that the
network will be using for the RPL Option. Thus, when a node joins to a
network, it will know which value to use. With this, RPL-capable nodes
know if it is safe to use 0x23 when creating a new RPL Option. A node
that forwards a packet with an RPI [MUST NOT]{.bcp14} modify the Option
Type of the RPL Option.[¶](#section-4.1.3-1){.pilcrow}

This is done using a DODAG Configuration option flag that will signal
\"RPI 0x23 enable\" and propagate through the network. [Section
6.3.1](https://www.rfc-editor.org/rfc/rfc6550#section-6.3.1){.relref} of
\[[RFC6550](#RFC6550){.xref}\] defines a 3-bit Mode of Operation (MOP)
in the DIO Base Object. The flag is defined only for MOP value between 0
to 6.[¶](#section-4.1.3-2){.pilcrow}

For a MOP value of 7, a node [MUST]{.bcp14} use the RPI 0x23
option.[¶](#section-4.1.3-3){.pilcrow}

As stated in \[[RFC6550](#RFC6550){.xref}\], the DODAG Configuration
option is present in DIO messages. The DODAG Configuration option
distributes configuration information. It is generally static, and it
does not change within the DODAG. This information is configured at the
DODAG root and distributed throughout the DODAG with the DODAG
Configuration option. Nodes other than the DODAG root do not modify this
information when propagating the DODAG Configuration
option.[¶](#section-4.1.3-4){.pilcrow}

Currently, the DODAG Configuration option in
\[[RFC6550](#RFC6550){.xref}\] states that the unused bits
\"[MUST]{.bcp14} be initialized to zero by the sender and [MUST]{.bcp14}
be ignored by the receiver.\" If the flag is received with a value zero,
which is the default, then new nodes will remain compatible with RFC
6553 \-- originating traffic with the old RPI Option Type value (0x63).
If the flag is received with a value of 1, then the value for the RPL
Option [MUST]{.bcp14} be set to 0x23.[¶](#section-4.1.3-5){.pilcrow}

Bit number three of the Flags field in the DODAG Configuration option is
to be used as shown in [Table 1](#fig_RPIflagday2){.xref} (which is the
same as [Table 36](#fig_RPIflagdayConfOption){.xref} in [Section
11](#iana){.xref} and is shown here for
convenience):[¶](#section-4.1.3-6){.pilcrow}

[]{#name-dodag-configuration-option-}

::: {#fig_RPIflagday2}
  Bit number   Description       Reference
  ------------ ----------------- ---------------
  3            RPI 0x23 enable   This document

  : [Table 1](#table-1){.selfRef}: [DODAG Configuration Option Flag to
  Indicate the RPI Flag
  Day](#name-dodag-configuration-option-){.selfRef}
:::

In the case of reboot, the node (6LN or 6LR) does not remember the RPI
Option Type (i.e., whether or not the flag is set), so the node will not
trigger DIO messages until a DIO message is received that indicates the
RPI value to be used. The node will use the value 0x23 if the network
supports this feature.[¶](#section-4.1.3-8){.pilcrow}
:::
:::
:::
:::

::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Updates to RFC 6553: Indicating the New RPI Option Type](#name-updates-to-rfc-6553-indicat){.section-name .selfRef} {#name-updates-to-rfc-6553-indicat}

This modification is required in order to be able to send, for example,
IPv6 packets from a RPL-aware leaf to a RPL-unaware node through the
Internet (see [Section 7.2.1](#sm-Ral2i){.xref}) without requiring
IPv6-in-IPv6 encapsulation.[¶](#section-4.2-1){.pilcrow}

[Section 6](https://www.rfc-editor.org/rfc/rfc6553#section-6){.relref}
of \[[RFC6553](#RFC6553){.xref}\] states, as shown in [Table
2](#fig_RPIOption){.xref}, that in the Option Type field of the RPL
Option, the two high-order bits must be set to \'01\' and the third bit
is equal to \'1\'. The first two bits indicate that the IPv6 node must
discard the packet if it doesn\'t recognize the Option Type, and the
third bit indicates that the Option Data may change in route. The
remaining bits serve as the Option Type.[¶](#section-4.2-2){.pilcrow}

[]{#name-option-type-in-rpl-option}

::: {#fig_RPIOption}
  Hex Value   Binary Value               Description   Reference
  ----------- -------------- --- ------- ------------- --------------------------------
              act                        chg           rest
  0x63        01             1   00011   RPL Option    \[[RFC6553](#RFC6553){.xref}\]

  : [Table 2](#table-2){.selfRef}: [Option Type in RPL
  Option](#name-option-type-in-rpl-option){.selfRef}
:::

This document illustrates that it is not always possible to know for
sure at the source whether a packet will travel only within the RPL
domain or whether it will leave it.[¶](#section-4.2-4){.pilcrow}

At the time \[[RFC6553](#RFC6553){.xref}\] was published, leaking a
Hop-by-Hop Options header in the outer IPv6 header chain could
potentially impact core routers in the Internet. So at that time, it was
decided to encapsulate any packet with a RPL Option using IPv6-in-IPv6
in all cases where it was unclear whether the packet would remain within
the RPL domain. In the exception case where a packet would still leak,
the Option Type would ensure that the first router in the Internet that
does not recognize the option would drop the packet and protect the rest
of the network.[¶](#section-4.2-5){.pilcrow}

Even with \[[RFC8138](#RFC8138){.xref}\], where the IPv6-in-IPv6 header
is compressed, this approach yields extra bytes in a packet; this means
consuming more energy and more bandwidth, incurring higher chances of
loss, and possibly causing a fragmentation at the 6LoWPAN level. This
impacts the daily operation of constrained devices for a case that
generally does not happen and would not heavily impact the core
anyway.[¶](#section-4.2-6){.pilcrow}

While the intention was and remains that the Hop-by-Hop Options header
with a RPL Option should be confined within the RPL domain, this
specification modifies this behavior in order to reduce the dependency
on IPv6-in-IPv6 and protect the constrained devices. [Section
4](https://www.rfc-editor.org/rfc/rfc8200#section-4){.relref} of
\[[RFC8200](#RFC8200){.xref}\] clarifies the behavior of routers in the
Internet as follows: \"it is now expected that nodes along a packet\'s
delivery path only examine and process the Hop-by-Hop Options header if
explicitly configured to do so.\"[¶](#section-4.2-7){.pilcrow}

When unclear about the travel of a packet, it becomes preferable for a
source not to encapsulate, accepting the fact that the packet may leave
the RPL domain on its way to its destination. In that event, the packet
should reach its destination and should not be discarded by the first
node that does not recognize the RPL Option. However, with the current
value of the Option Type, if a node in the Internet is configured to
process the Hop-by-Hop Options header, and if such a node encounters an
Option Type with the first two bits set to 01 and the node conforms to
\[[RFC8200](#RFC8200){.xref}\], it will drop the packet. Host systems
should do the same, irrespective of the
configuration.[¶](#section-4.2-8){.pilcrow}

Thus, this document updates the Option Type of the RPL Option
\[[RFC6553](#RFC6553){.xref}\], naming it RPI Option Type for simplicity
([Table 3](#fig_RPIOption_new){.xref}): the two high order bits
[MUST]{.bcp14} be set to \'00\', and the third bit is equal to \'1\'.
The first two bits indicate that the IPv6 node [MUST]{.bcp14} skip over
this option and continue processing the header
(\[[RFC8200](#RFC8200){.xref}\], [Section
4.2](https://www.rfc-editor.org/rfc/rfc8200#section-4.2){.relref}) if it
doesn\'t recognize the Option Type, and the third bit continues to be
set to indicate that the Option Data may change en route. The rightmost
five bits remain at 0x3(00011). This ensures that a packet that leaves
the RPL domain of an LLN (or that leaves the LLN entirely) will not be
discarded when it contains the RPL Option.[¶](#section-4.2-9){.pilcrow}

With the new Option Type, if an IPv6 (intermediate) node (RPL unaware)
receives a packet with a RPL Option, it should ignore the Hop-by-Hop RPL
Option (skip over this option and continue processing the header). This
is relevant, as it was mentioned previously, in the case that there is a
flow from RAL to Internet (see [Section
7.2.1](#sm-Ral2i){.xref}).[¶](#section-4.2-10){.pilcrow}

This is a significant update to
\[[RFC6553](#RFC6553){.xref}\].[¶](#section-4.2-11){.pilcrow}

[]{#name-revised-option-type-in-rpl-}

::: {#fig_RPIOption_new}
  Hex Value   Binary Value               Description   Reference
  ----------- -------------- --- ------- ------------- ---------------
              act                        chg           rest
  0x23        00             1   00011   RPL Option    This document

  : [Table 3](#table-3){.selfRef}: [Revised Option Type in RPL
  Option](#name-revised-option-type-in-rpl-){.selfRef}
:::

Without the signaling described below, this change would otherwise
create a lack of interoperation (flag day) for existing networks that
are currently using 0x63 as the RPI Option Type value. A move to 0x23
will not be understood by those networks. It is suggested that RPL
implementations accept both 0x63 and 0x23 when processing the
header.[¶](#section-4.2-13){.pilcrow}

When forwarding packets, implementations [SHOULD]{.bcp14} use the same
value of RPI Type as was received. This is required because the RPI
Option Type does not change en route (\[[RFC8200](#RFC8200){.xref}\],
[Section
4.2](https://www.rfc-editor.org/rfc/rfc8200#section-4.2){.relref}). It
allows the network to be incrementally upgraded and allows the DODAG
root to know which parts of the network have been
upgraded.[¶](#section-4.2-14){.pilcrow}

When originating new packets, implementations should have an option to
determine which value to originate with. This option is controlled by
the DODAG Configuration option ([Section
4.1.3](#update6550){.xref}).[¶](#section-4.2-15){.pilcrow}

The change of RPI Option Type from 0x63 to 0x23 makes all nodes that are
compliant with [Section
4.2](https://www.rfc-editor.org/rfc/rfc8200#section-4.2){.relref} of
\[[RFC8200](#RFC8200){.xref}\] tolerant of the RPL artifacts. There is
no longer a need to remove the artifacts when sending traffic to the
Internet. This change clarifies when to use IPv6-in-IPv6 headers and how
to address them: the Hop-by-Hop Options header containing the RPI
[MUST]{.bcp14} always be added when 6LRs originate packets (without
IPv6-in-IPv6 headers), and IPv6-in-IPv6 headers [MUST]{.bcp14} always be
added when a 6LR finds that it needs to insert a Hop-by-Hop Options
header containing the RPL Option. The IPv6-in-IPv6 header is to be
addressed to the RPL root when on the way up, and to the end host when
on the way down.[¶](#section-4.2-16){.pilcrow}

In the Non-Storing case, dealing with RPL-unaware leaf nodes is much
easier as the 6LBR (DODAG root) has complete knowledge about the
connectivity of all DODAG nodes, and all traffic flows through the root
node.[¶](#section-4.2-17){.pilcrow}

The 6LBR can recognize RPL-unaware leaf nodes because it will receive a
DAO about that node from the 6LR immediately above that RPL-unaware
node.[¶](#section-4.2-18){.pilcrow}

The Non-Storing mode case does not require the Type change from 0x63 to
0x23, as the root can always create the right packet. The Type change
does not adversely affect the Non-Storing case (see [Section
4.1.3](#update6550){.xref}).[¶](#section-4.2-19){.pilcrow}
:::

::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Updates to RFC 8138: Indicating the Way to Decompress with the New RPI Option Type](#name-updates-to-rfc-8138-indicat){.section-name .selfRef} {#name-updates-to-rfc-8138-indicat}

This modification is required in order to be able to decompress the RPL
Option with the new Option Type of 0x23.[¶](#section-4.3-1){.pilcrow}

The RPI-6LoRH header provides a compressed form for the RPL RPI; see
\[[RFC8138](#RFC8138){.xref}\], [Section
6](https://www.rfc-editor.org/rfc/rfc8138#section-6){.relref}. A node
that is decompressing this header [MUST]{.bcp14} decompress using the
RPI Option Type that is currently active, that is, a choice between 0x23
(new) and 0x63 (old). The node will know which to use based upon the
presence of the flag in the DODAG Configuration option defined in
[Section 4.1.3](#update6550){.xref}. For example, if the network is in
0x23 mode (by DIO option), then it should be decompressed to
0x23.[¶](#section-4.3-2){.pilcrow}

[Section 7](https://www.rfc-editor.org/rfc/rfc8138#section-7){.relref}
of \[[RFC8138](#RFC8138){.xref}\] documents how to compress the
IPv6-in-IPv6 header.[¶](#section-4.3-3){.pilcrow}

There are potential significant advantages to having a single code path
that always processes IPv6-in-IPv6 headers with no conditional
branches.[¶](#section-4.3-4){.pilcrow}

In Storing mode, the scenarios where the flow goes from RAL to RUL and
RUL to RUL include compression of the IPv6-in-IPv6 and RPI headers. The
IPv6-in-IPv6 header [MUST]{.bcp14} be used in this case, and it
[SHOULD]{.bcp14} be compressed as specified in
\[[RFC8138](#RFC8138){.xref}\], [Section
7](https://www.rfc-editor.org/rfc/rfc8138#section-7){.relref}. [Figure
2](#rtghc){.xref} illustrates the case in Storing mode where the packet
is received from the Internet, then the root encapsulates the packet to
insert the RPI. In that example, the leaf is not known to support RFC
8138, and the packet is encapsulated to the 6LR that is the parent and
last hop to the final destination.[¶](#section-4.3-5){.pilcrow}

[]{#name-rpi-inserted-by-the-root-in}

::: {#rtghc}
::: {#section-4.3-6.1 .artwork .art-text .alignLeft}
    +-+ ... -+-+ ... +-+- ... -+-+- +-+-+-+ ... +-+-+ ... -+++ ... +-...
    |11110001|SRH-6LoRH| RPI-  |IP-in-IP| NH=1      |11110CPP| UDP | UDP
    |Page 1  |Type1 S=0| 6LoRH |6LoRH   |LOWPAN_IPHC| UDP    | hdr |Payld
    +-+ ... -+-+ ... +-+- ... -+-+-.+-+-+-+-+ ... +-+-+ ... -+ ... +-...
             <-4bytes->                      <-        RFC 6282      ->
                                                   No RPL artifact
:::

[Figure 2](#figure-2){.selfRef}: [RPI Inserted by the Root in Storing
Mode](#name-rpi-inserted-by-the-root-in){.selfRef}
:::

In [Figure 2](#rtghc){.xref}, the source of the IPv6-in-IPv6
encapsulation is the root, so it is elided in the IP-in-IP 6LoRH. The
destination is the parent 6LR of the destination of the inner packet so
it cannot be elided. It is placed as the single entry in a Source Route
Header 6LoRH (SRH-6LoRH) as the first 6LoRH. There is a single entry so
the SRH-6LoRH Size is zero. In that example, the Type is 1 so the 6LR
address is compressed to two bytes. This results in the total length of
the SRH-6LoRH being four bytes. The RPI-6LoRH and then the IP-in-IP
6LoRH follow. When the IP-in-IP 6LoRH is removed, all the router headers
that precede it are also removed. The Paging Dispatch
\[[RFC8025](#RFC8025){.xref}\] may also be removed if there was no
previous Page change to a Page other than 0 or 1, since the LOWPAN_IPHC
is encoded in the same fashion in the default Page 0 and in Page 1. The
resulting packet to the destination is the inner packet compressed with
\[[RFC6282](#RFC6282){.xref}\].[¶](#section-4.3-7){.pilcrow}
:::
:::
:::

::: {#sec_ref_topo}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Reference Topology](#name-reference-topology){.section-name .selfRef} {#name-reference-topology}

A RPL network in general is composed of a 6LBR, a Backbone Router
(6BBR), a 6LR, and a 6LN as a leaf logically organized in a DODAG
structure.[¶](#section-5-1){.pilcrow}

[Figure 3](#fig_CommonTopology){.xref} shows the reference RPL topology
for this document. The nodes are labeled with letters so that they may
be referenced in subsequent sections. In the figure, 6LR represents a
full router node. The 6LN is a RPL-aware router or host (as a leaf).
Additionally, for simplification purposes, it is supposed that the 6LBR
has direct access to Internet and is the root of the DODAG, thus the
6BBR is not present in the figure.[¶](#section-5-2){.pilcrow}

The 6LN leaves marked as RAL (F, H, and I) are RPL nodes with no
children hosts.[¶](#section-5-3){.pilcrow}

The leaves marked as RUL (G and J) are devices that do not speak RPL at
all (RPL unaware), but use Router Advertisements, 6LoWPAN Duplicate
Address Request and Duplicate Address Confirmation (DAR/DAC), and
6LoWPAN Neighbor Discovery (ND) only to participate in the network
\[[RFC8505](#RFC8505){.xref}\]. In the document, these leaves (G and J)
are also referred to as a RUL.[¶](#section-5-4){.pilcrow}

The 6LBR (A) in the figure is the root of the Global
DODAG.[¶](#section-5-5){.pilcrow}

[]{#name-a-reference-rpl-topology}

::: {#fig_CommonTopology}
::: {#section-5-6.1 .artwork .art-text .alignLeft}
                      +------------+
                      |  INTERNET  ----------+
                      |            |         |
                      +------------+         |
                                             |
                                             |
                                             |
                                           A |
                                       +-------+
                                       |6LBR   |
                           +-----------|(root) |-------+
                           |           +-------+       |
                           |                           |
                           |                           |
                           |                           |
                           |                           |
                           | B                         |C
                       +---|---+                   +---|---+
                       |  6LR  |                   |  6LR  |
             +---------|       |--+             +---       ---+
             |         +-------+  |             |  +-------+  |
             |                    |             |             |
             |                    |             |             |
             |                    |             |             |
             |                    |             |             |
             | D                  |  E          |             |
           +-|-----+          +---|---+         |             |
           |  6LR  |          |  6LR  |         |             |
           |       |    +------       |         |             |
           +---|---+    |     +---|---+         |             |
               |        |         |             |             |
               |        |         +--+          |             |
               |        |            |          |             |
               |        |            |          |             |
               |        |            |        I |          J  |
            F  |        | G          | H        |             |
         +-----+-+    +-|-----+  +---|--+   +---|---+     +---|---+
         |  RAL  |    | RUL   |  | RAL  |   |  RAL  |     | RUL   |
         |  6LN  |    |  6LN  |  | 6LN  |   |  6LN  |     |  6LN  |
         +-------+    +-------+  +------+   +-------+     +-------+
:::

[Figure 3](#figure-3){.selfRef}: [A Reference RPL
Topology](#name-a-reference-rpl-topology){.selfRef}
:::
:::
:::

::: {#sec_use_cases}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Use Cases](#name-use-cases){.section-name .selfRef} {#name-use-cases}

In the data plane, a combination of RFC 6553, RFC 6554, and IPv6-in-IPv6
encapsulation are going to be analyzed for a number of representative
traffic flows.[¶](#section-6-1){.pilcrow}

The use cases describe the communication in the following
cases:[¶](#section-6-2){.pilcrow}

-   [Between RPL-aware nodes with the root
    (6LBR)[¶](#section-6-3.1){.pilcrow}]{#section-6-3.1}
-   [Between RPL-aware nodes with the
    Internet[¶](#section-6-3.2){.pilcrow}]{#section-6-3.2}
-   [Between RUL nodes within the LLN (e.g., see [Section
    7.1.4](#sm-nRal2root){.xref})[¶](#section-6-3.3){.pilcrow}]{#section-6-3.3}
-   [Inside of the LLN when the final destination address resides
    outside of the LLN (e.g., see [Section
    7.2.3](#sm-nRal2i){.xref})[¶](#section-6-3.4){.pilcrow}]{#section-6-3.4}

The use cases are as follows:[¶](#section-6-4){.pilcrow}

-   ::: {#section-6-5.1}
    Interaction between leaf and root:[¶](#section-6-5.1.1){.pilcrow}

    -   [RAL to
        root[¶](#section-6-5.1.2.1){.pilcrow}]{#section-6-5.1.2.1}
    -   [root to
        RAL[¶](#section-6-5.1.2.2){.pilcrow}]{#section-6-5.1.2.2}
    -   [RUL to
        root[¶](#section-6-5.1.2.3){.pilcrow}]{#section-6-5.1.2.3}
    -   [root to
        RUL[¶](#section-6-5.1.2.4){.pilcrow}]{#section-6-5.1.2.4}
    :::

-   ::: {#section-6-5.2}
    Interaction between leaf and
    Internet:[¶](#section-6-5.2.1){.pilcrow}

    -   [RAL to
        Internet[¶](#section-6-5.2.2.1){.pilcrow}]{#section-6-5.2.2.1}
    -   [Internet to
        RAL[¶](#section-6-5.2.2.2){.pilcrow}]{#section-6-5.2.2.2}
    -   [RUL to
        Internet[¶](#section-6-5.2.2.3){.pilcrow}]{#section-6-5.2.2.3}
    -   [Internet to
        RUL[¶](#section-6-5.2.2.4){.pilcrow}]{#section-6-5.2.2.4}
    :::

-   ::: {#section-6-5.3}
    Interaction between leaves:[¶](#section-6-5.3.1){.pilcrow}

    -   [RAL to
        RAL[¶](#section-6-5.3.2.1){.pilcrow}]{#section-6-5.3.2.1}
    -   [RAL to
        RUL[¶](#section-6-5.3.2.2){.pilcrow}]{#section-6-5.3.2.2}
    -   [RUL to
        RAL[¶](#section-6-5.3.2.3){.pilcrow}]{#section-6-5.3.2.3}
    -   [RUL to
        RUL[¶](#section-6-5.3.2.4){.pilcrow}]{#section-6-5.3.2.4}
    :::

This document is consistent with the rule that a header cannot be
inserted or removed on the fly inside an IPv6 packet that is being
routed. This is a fundamental precept of the IPv6 architecture as
outlined in \[[RFC8200](#RFC8200){.xref}\].[¶](#section-6-6){.pilcrow}

As the Rank information in the RPI artifact is changed at each hop, it
will typically be zero when it arrives at the DODAG root. The DODAG root
[MUST]{.bcp14} force it to zero when passing the packet out to the
Internet. The Internet will therefore not see any SenderRank
information.[¶](#section-6-7){.pilcrow}

Despite being legal to leave the RPI artifact in place, an intermediate
router that needs to add an extension header (e.g., RH3 or RPL Option)
[MUST]{.bcp14} still encapsulate the packet in an (additional) outer IP
header. The new header is placed after this new outer IP
header.[¶](#section-6-8){.pilcrow}

A corollary is that an intermediate router can remove an RH3 or RPL
Option only if it is placed in an encapsulating IPv6 header that is
addressed *to* this intermediate router. When doing the above, the whole
encapsulating header must be removed. (A replacement may be
added.)[¶](#section-6-9){.pilcrow}

Both the RPL Option and the RH3 headers may be modified in very specific
ways by routers on the path of the packet without the need to add and
remove an encapsulating header. Both headers were designed with this
modification in mind, and both the RPL RH3 and the RPL Option are marked
mutable but recoverable: so an IPsec Authentication Header (AH) can be
applied across these headers, but it cannot secure the values that
mutate.[¶](#section-6-10){.pilcrow}

The RPI [MUST]{.bcp14} be present in every single RPL data
packet.[¶](#section-6-11){.pilcrow}

Prior to \[[RFC8138](#RFC8138){.xref}\], there was significant interest
in creating an exception to this rule and removing the RPI for Downward
flows in Non-Storing mode. This exception covered a very small number of
cases, and caused significant interoperability challenges while adding
significant interest in the code and tests. The ability to compress the
RPI down to three bytes or less removes much of the pressure to optimize
this any further.[¶](#section-6-12){.pilcrow}

Throughout the following subsections, the examples are described in more
detail in the first subsections, and more concisely in the later
ones.[¶](#section-6-13){.pilcrow}

The use cases are delineated based on the following IPV6 and RPL
mandates:[¶](#section-6-14){.pilcrow}

-   ::: {#section-6-15.1}
    The RPI has to be in every packet that traverses the
    LLN.[¶](#section-6-15.1.1){.pilcrow}

    -   [Because of the above requirement, packets from the Internet
        have to be
        encapsulated.[¶](#section-6-15.1.2.1){.pilcrow}]{#section-6-15.1.2.1}
    -   [A header cannot be inserted or removed on the fly inside an
        IPv6 packet that is being
        routed.[¶](#section-6-15.1.2.2){.pilcrow}]{#section-6-15.1.2.2}
    -   [Extension headers may not be added or removed except by the
        sender or the
        receiver.[¶](#section-6-15.1.2.3){.pilcrow}]{#section-6-15.1.2.3}
    -   [RPI and RH3 headers may be modified by routers on the path of
        the packet without the need to add and remove an encapsulating
        header.[¶](#section-6-15.1.2.4){.pilcrow}]{#section-6-15.1.2.4}
    -   [An RH3 or RPL Option can only be removed by an intermediate
        router if it is placed in an encapsulating IPv6 header, which is
        addressed to the intermediate
        router.[¶](#section-6-15.1.2.5){.pilcrow}]{#section-6-15.1.2.5}
    -   [The Non-Storing mode requires downstream encapsulation by the
        root for
        RH3.[¶](#section-6-15.1.2.6){.pilcrow}]{#section-6-15.1.2.6}
    :::

The use cases are delineated based on the following
assumptions:[¶](#section-6-16){.pilcrow}

-   ::: {#section-6-17.1}
    This document assumes that the LLN is using the no-drop RPI Option
    Type (0x23).[¶](#section-6-17.1.1){.pilcrow}

    -   [Each IPv6 node (including Internet routers) obeys
        \[[RFC8200](#RFC8200){.xref}\], so that the 0x23 RPI Option Type
        can be safely
        inserted.[¶](#section-6-17.1.2.1){.pilcrow}]{#section-6-17.1.2.1}
    -   [All 6LRs obey
        \[[RFC8200](#RFC8200){.xref}\].[¶](#section-6-17.1.2.2){.pilcrow}]{#section-6-17.1.2.2}
    -   [The RPI is ignored at the IPv6 destination (dst) node
        (RUL).[¶](#section-6-17.1.2.3){.pilcrow}]{#section-6-17.1.2.3}
    -   [In the use cases, we assume that the RAL supports IP-in-IP
        encapsulation.[¶](#section-6-17.1.2.4){.pilcrow}]{#section-6-17.1.2.4}
    -   [In the use cases, we don\'t assume that the RUL supports
        IP-in-IP
        encapsulation.[¶](#section-6-17.1.2.5){.pilcrow}]{#section-6-17.1.2.5}
    -   [For traffic leaving a RUL, if the RUL adds an opaque RPI, then
        the 6LR as a RPL Border Router [SHOULD]{.bcp14} rewrite the RPI
        to indicate the selected Instance and set the
        flags.[¶](#section-6-17.1.2.6){.pilcrow}]{#section-6-17.1.2.6}
    -   [The description for RALs applies to RAN in
        general.[¶](#section-6-17.1.2.7){.pilcrow}]{#section-6-17.1.2.7}
    -   [Unconstrained uses of RPL are not in scope of this
        document.[¶](#section-6-17.1.2.8){.pilcrow}]{#section-6-17.1.2.8}
    -   [Compression is based on
        \[[RFC8138](#RFC8138){.xref}\].[¶](#section-6-17.1.2.9){.pilcrow}]{#section-6-17.1.2.9}
    -   [The flow label \[[RFC6437](#RFC6437){.xref}\] is not needed in
        RPL.[¶](#section-6-17.1.2.10){.pilcrow}]{#section-6-17.1.2.10}
    :::
:::
:::

::: {#sec_sm}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Storing Mode](#name-storing-mode){.section-name .selfRef} {#name-storing-mode}

In Storing mode (SM) (fully stateful), the sender can determine if the
destination is inside the LLN by looking if the destination address is
matched by the DIO\'s Prefix Information Option (PIO)
option.[¶](#section-7-1){.pilcrow}

[Table 4](#fig_EncStoMode){.xref} itemizes which headers are needed in
each of the following scenarios. It indicates whether an IPv6-in-IPv6
header must be added and to which destination it must be
addressed:[¶](#section-7-2){.pilcrow}

1.  [the final destination (the RAL node that is the target
    (tgt)),[¶](#section-7-3.1){.pilcrow}]{#section-7-3.1}
2.  [the \"root\", or[¶](#section-7-3.2){.pilcrow}]{#section-7-3.2}
3.  [the 6LR parent of a
    RUL.[¶](#section-7-3.3){.pilcrow}]{#section-7-3.3}

In cases where no IPv6-in-IPv6 header is needed, the column states
\"No\", and the destination is N/A (Not Applicable). If the IPv6-in-IPv6
header is needed, the column shows \"must\".[¶](#section-7-4){.pilcrow}

In all cases, the RPI is needed, since it identifies inconsistencies
(loops) in the routing topology. In general, the RH3 is not needed
because it is not used in Storing mode. However, there is one scenario
(from the root to the RUL in SM) where the RH3 can be used to point at
the RUL ([Table
8](#Storing-root2notrplnoIPIP){.xref}).[¶](#section-7-5){.pilcrow}

The leaf can be a router 6LR or a host, both indicated as 6LN. The root
refers to the 6LBR (see [Figure
3](#fig_CommonTopology){.xref}).[¶](#section-7-6){.pilcrow}

[]{#name-ipv6-in-ipv6-encapsulation-}

::: {#fig_EncStoMode}
  Interaction between   Use Case      IPv6-in-IPv6   IPv6-in-IPv6 dst
  --------------------- ------------- -------------- ------------------
  Leaf - Root           RAL to root   No             N/A
                        root to RAL   No             N/A
                        root to RUL   must           6LR
                        RUL to root   must           root
  Leaf - Internet       RAL to Int    may            root
                        Int to RAL    must           RAL (tgt)
                        RUL to Int    must           root
                        Int to RUL    must           6LR
  Leaf - Leaf           RAL to RAL    No             N/A
                        RAL to RUL    No(up)         N/A
                                      must(down)     6LR
                        RUL to RAL    must(up)       root
                                      must(down)     RAL
                        RUL to RUL    must(up)       root
                                      must(down)     6LR

  : [Table 4](#table-4){.selfRef}: [IPv6-in-IPv6 Encapsulation in
  Storing Mode](#name-ipv6-in-ipv6-encapsulation-){.selfRef}
:::

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Storing Mode: Interaction between Leaf and Root](#name-storing-mode-interaction-be){.section-name .selfRef} {#name-storing-mode-interaction-be}

This section describes the communication flow in Storing mode (SM)
between the following:[¶](#section-7.1-1){.pilcrow}

-   [RAL to root[¶](#section-7.1-2.1){.pilcrow}]{#section-7.1-2.1}
-   [root to RAL[¶](#section-7.1-2.2){.pilcrow}]{#section-7.1-2.2}
-   [RUL to root[¶](#section-7.1-2.3){.pilcrow}]{#section-7.1-2.3}
-   [root to RUL[¶](#section-7.1-2.4){.pilcrow}]{#section-7.1-2.4}

::: {#section-7.1.1 .section}
#### [7.1.1.](#section-7.1.1){.section-number .selfRef} [SM: Example of Flow from RAL to Root](#name-sm-example-of-flow-from-ral){.section-name .selfRef} {#name-sm-example-of-flow-from-ral}

In Storing mode, RPI \[[RFC6553](#RFC6553){.xref}\] is used to send the
RPLInstanceID and Rank information.[¶](#section-7.1.1-1){.pilcrow}

In this case, the flow comprises:[¶](#section-7.1.1-2){.pilcrow}

RAL (6LN) \--\> 6LR_i \--\> root (6LBR)[¶](#section-7.1.1-3){.pilcrow}

For example, a communication flow could be: Node F (6LN) \--\> Node D
(6LR_i) \--\> Node B (6LR_i) \--\> Node A root
(6LBR)[¶](#section-7.1.1-4){.pilcrow}

The RAL (Node F) inserts the RPI, and sends the packet to the 6LR (Node
D), which decrements the Rank in the RPI and sends the packet up. When
the packet arrives at the 6LBR (Node A), the RPI is removed and the
packet is processed.[¶](#section-7.1.1-5){.pilcrow}

No IPv6-in-IPv6 header is required.[¶](#section-7.1.1-6){.pilcrow}

The RPI can be removed by the 6LBR because the packet is addressed to
the 6LBR. The RAL must know that it is communicating with the 6LBR to
make use of this scenario. The RAL can know the address of the 6LBR
because it knows the address of the root via the DODAGID in the DIO
messages.[¶](#section-7.1.1-7){.pilcrow}

[Table 5](#Storing-summary-headers){.xref} summarizes which headers are
needed for this use case.[¶](#section-7.1.1-8){.pilcrow}

[]{#name-sm-summary-of-the-use-of-he}

::: {#Storing-summary-headers}
  Header              RAL src   6LR_i   6LBR dst
  ------------------- --------- ------- ----------
  Added headers       RPI       \--     \--
  Modified headers    \--       RPI     \--
  Removed headers     \--       \--     RPI
  Untouched headers   \--       \--     \--

  : [Table 5](#table-5){.selfRef}: [SM: Summary of the Use of Headers
  from RAL to Root](#name-sm-summary-of-the-use-of-he){.selfRef}
:::
:::

::: {#Storing-root2ral}
::: {#section-7.1.2 .section}
#### [7.1.2.](#section-7.1.2){.section-number .selfRef} [SM: Example of Flow from Root to RAL](#name-sm-example-of-flow-from-roo){.section-name .selfRef} {#name-sm-example-of-flow-from-roo}

In this case, the flow comprises:[¶](#section-7.1.2-1){.pilcrow}

root (6LBR) \--\> 6LR_i \--\> RAL (6LN)[¶](#section-7.1.2-2){.pilcrow}

For example, a communication flow could be: Node A root (6LBR) \--\>
Node B (6LR_i) \--\> Node D (6LR_i) \--\> Node F
(6LN)[¶](#section-7.1.2-3){.pilcrow}

In this case, the 6LBR inserts RPI and sends the packet down. The 6LR
increments the Rank in the RPI (it examines the RPLInstanceID to
identify the right forwarding table). The packet is processed in the
RAL, and the RPI is removed.[¶](#section-7.1.2-4){.pilcrow}

No IPv6-in-IPv6 header is required.[¶](#section-7.1.2-5){.pilcrow}

[Table 6](#Storing-root2leaf){.xref} summarizes which headers are needed
for this use case.[¶](#section-7.1.2-6){.pilcrow}

[]{#name-sm-summary-of-the-use-of-hea}

::: {#Storing-root2leaf}
  Header              6LBR src   6LR_i   RAL dst
  ------------------- ---------- ------- ---------
  Added headers       RPI        \--     \--
  Modified headers    \--        RPI     \--
  Removed headers     \--        \--     RPI
  Untouched headers   \--        \--     \--

  : [Table 6](#table-6){.selfRef}: [SM: Summary of the Use of Headers
  from Root to RAL](#name-sm-summary-of-the-use-of-hea){.selfRef}
:::
:::
:::

::: {#section-7.1.3 .section}
#### [7.1.3.](#section-7.1.3){.section-number .selfRef} [SM: Example of Flow from Root to RUL](#name-sm-example-of-flow-from-root){.section-name .selfRef} {#name-sm-example-of-flow-from-root}

In this case, the flow comprises:[¶](#section-7.1.3-1){.pilcrow}

root (6LBR) \--\> 6LR_i \--\> RUL (IPv6 dst
node)[¶](#section-7.1.3-2){.pilcrow}

For example, a communication flow could be: Node A (6LBR) \--\> Node B
(6LR_i) \--\> Node E (6LR_n) \--\> Node G
(RUL)[¶](#section-7.1.3-3){.pilcrow}

6LR_i (Node B) represents the intermediate routers from the source
(6LBR) to the destination (RUL), and 1 \<= i \<= n, where n is the total
number of routers (6LR) that the packet goes through, from the 6LBR
(Node A) to the RUL (Node G).[¶](#section-7.1.3-4){.pilcrow}

The 6LBR will encapsulate the packet in an IPv6-in-IPv6 header and
prepend an RPI. The IPv6-in-IPv6 header is addressed to the 6LR parent
of the RUL (6LR_n). The 6LR parent of the RUL removes the header and
sends the packet to the RUL.[¶](#section-7.1.3-5){.pilcrow}

[Table 7](#Storing-root2notrpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-7.1.3-6){.pilcrow}

[]{#name-sm-summary-of-the-use-of-head}

::: {#Storing-root2notrpl}
  Header              6LBR src        6LR_i     6LR_n           RUL dst
  ------------------- --------------- --------- --------------- ---------
  Added headers       IP6-IP6 (RPI)   \--       \--             \--
  Modified headers    \--             RPI       \--             \--
  Removed headers     \--             \--       IP6-IP6 (RPI)   \--
  Untouched headers   \--             IP6-IP6   \--             \--

  : [Table 7](#table-7){.selfRef}: [SM: Summary of the Use of Headers
  from Root to RUL](#name-sm-summary-of-the-use-of-head){.selfRef}
:::

IP-in-IP encapsulation may be avoided for root-to-RUL communication. In
SM, it can be replaced by a loose RH3 header that indicates the RUL. In
which case, the packet is routed to the 6LR as a normal SM operation,
then the 6LR forwards to the RUL based on the RH3, and the RUL ignores
both the consumed RH3 and the RPI, as in Non-Storing
mode.[¶](#section-7.1.3-8){.pilcrow}

[Table 8](#Storing-root2notrplnoIPIP){.xref} summarizes which headers
are needed for this scenario.[¶](#section-7.1.3-9){.pilcrow}

[]{#name-sm-summary-of-the-use-of-heade}

::: {#Storing-root2notrplnoIPIP}
  ---------------------------------------------------------------------------
  Header         6LBR src       6LR_i\         6LR_n           RUL dst
                                i=(1,..,n-1)                   
  -------------- -------------- -------------- --------------- --------------
  Added headers  RPI, RH3       \--            \--             \--

  Modified       \--            RPI            RPI,            \--
  headers                                      RH3(consumed)   

  Removed        \--            \--            \--             \--
  headers                                                      

  Untouched      \--            RH3            \--             RPI, RH3 (both
  headers                                                      ignored)
  ---------------------------------------------------------------------------

  : [Table 8](#table-8){.selfRef}: [SM: Summary of the Use of Headers
  from Root to RUL without
  Encapsulation](#name-sm-summary-of-the-use-of-heade){.selfRef}
:::
:::

::: {#sm-nRal2root}
::: {#section-7.1.4 .section}
#### [7.1.4.](#section-7.1.4){.section-number .selfRef} [SM: Example of Flow from RUL to Root](#name-sm-example-of-flow-from-rul){.section-name .selfRef} {#name-sm-example-of-flow-from-rul}

In this case, the flow comprises:[¶](#section-7.1.4-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_i \--\> root
(6LBR)[¶](#section-7.1.4-2){.pilcrow}

For example, a communication flow could be: Node G (RUL) \--\> Node E
(6LR_1) \--\> Node B (6LR_i) \--\> Node A root
(6LBR)[¶](#section-7.1.4-3){.pilcrow}

6LR_i represents the intermediate routers from the source (RUL) to the
destination (6LBR), and 1 \<= i \<= n, where n is the total number of
routers (6LR) that the packet goes through, from the RUL to the
6LBR.[¶](#section-7.1.4-4){.pilcrow}

When the packet arrives from the RUL (Node G) to 6LR_1 (Node E), the
6LR_1 will encapsulate the packet in an IPv6-in-IPv6 header with an RPI.
The IPv6-in-IPv6 header is addressed to the root (Node A). The root
removes the header and processes the
packet.[¶](#section-7.1.4-5){.pilcrow}

[Table 9](#Storing-notrpl2root){.xref} summarizes which headers are
needed for this use case where the IPv6-in-IPv6 header is addressed to
the root (Node A).[¶](#section-7.1.4-6){.pilcrow}

[]{#name-sm-summary-of-the-use-of-header}

::: {#Storing-notrpl2root}
  Header              RUL src   6LR_1           6LR_i     6LBR dst
  ------------------- --------- --------------- --------- ---------------
  Added headers       \--       IP6-IP6 (RPI)   \--       \--
  Modified headers    \--       \--             RPI       \--
  Removed headers     \--       \--             \--       IP6-IP6 (RPI)
  Untouched headers   \--       \--             IP6-IP6   \--

  : [Table 9](#table-9){.selfRef}: [SM: Summary of the Use of Headers
  from RUL to Root](#name-sm-summary-of-the-use-of-header){.selfRef}
:::
:::
:::
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [SM: Interaction between Leaf and Internet](#name-sm-interaction-between-leaf){.section-name .selfRef} {#name-sm-interaction-between-leaf}

This section describes the communication flow in Storing mode (SM)
between the following:[¶](#section-7.2-1){.pilcrow}

-   [RAL to Internet[¶](#section-7.2-2.1){.pilcrow}]{#section-7.2-2.1}
-   [Internet to RAL[¶](#section-7.2-2.2){.pilcrow}]{#section-7.2-2.2}
-   [RUL to Internet[¶](#section-7.2-2.3){.pilcrow}]{#section-7.2-2.3}
-   [Internet to RUL[¶](#section-7.2-2.4){.pilcrow}]{#section-7.2-2.4}

::: {#sm-Ral2i}
::: {#section-7.2.1 .section}
#### [7.2.1.](#section-7.2.1){.section-number .selfRef} [SM: Example of Flow from RAL to Internet](#name-sm-example-of-flow-from-ral-){.section-name .selfRef} {#name-sm-example-of-flow-from-ral-}

In this case, the flow comprises:[¶](#section-7.2.1-1){.pilcrow}

RAL (6LN) \--\> 6LR_i \--\> root (6LBR) \--\>
Internet[¶](#section-7.2.1-2){.pilcrow}

For example, the communication flow could be: Node F (RAL) \--\> Node D
(6LR_i) \--\> Node B (6LR_i) \--\> Node A root (6LBR) \--\>
Internet[¶](#section-7.2.1-3){.pilcrow}

6LR_i represents the intermediate routers from the source (RAL) to the
root (6LBR), and 1 \<= i \<= n, where n is the total number of routers
(6LR) that the packet goes through, from the RAL to the
6LBR.[¶](#section-7.2.1-4){.pilcrow}

RPL information from RFC 6553 may go out to Internet as it will be
ignored by nodes that have not been configured to be RPL aware. No
IPv6-in-IPv6 header is required.[¶](#section-7.2.1-5){.pilcrow}

On the other hand, the RAL may insert the RPI encapsulated in an
IPv6-in-IPv6 header to the root. Thus, the root removes the RPI and
sends the packet to the Internet.[¶](#section-7.2.1-6){.pilcrow}

Note: In this use case, a leaf node is used, but this use case can also
be applicable to any RPL-aware node type (e.g.,
6LR).[¶](#section-7.2.1-7.1){.pilcrow}

[Table 10](#Storing-rpl2int){.xref} summarizes which headers are needed
for this use case when there is no encapsulation. Note that the RPI is
modified by 6LBR to set the SenderRank to zero in the case that it is
not already zero. [Table 11](#Storing-rpl2intIPIP){.xref} summarizes
which headers are needed when encapsulation to the root takes
place.[¶](#section-7.2.1-8){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers}

::: {#Storing-rpl2int}
  Header              RAL src   6LR_i   6LBR   Internet dst
  ------------------- --------- ------- ------ ---------------
  Added headers       RPI       \--     \--    \--
  Modified headers    \--       RPI     RPI    \--
  Removed headers     \--       \--     \--    \--
  Untouched headers   \--       \--     \--    RPI (Ignored)

  : [Table 10](#table-10){.selfRef}: [SM: Summary of the Use of Headers
  from RAL to Internet with No
  Encapsulation](#name-sm-summary-of-the-use-of-headers){.selfRef}
:::

[]{#name-sm-summary-of-the-use-of-headers-}

::: {#Storing-rpl2intIPIP}
  Header              RAL src         6LR_i     6LBR            Internet dst
  ------------------- --------------- --------- --------------- --------------
  Added headers       IP6-IP6 (RPI)   \--       \--             \--
  Modified headers    \--             RPI       \--             \--
  Removed headers     \--             \--       IP6-IP6 (RPI)   \--
  Untouched headers   \--             IP6-IP6   \--             \--

  : [Table 11](#table-11){.selfRef}: [SM: Summary of the Use of Headers
  from RAL to Internet with Encapsulation to the Root
  (6LBR)](#name-sm-summary-of-the-use-of-headers-){.selfRef}
:::
:::
:::

::: {#section-7.2.2 .section}
#### [7.2.2.](#section-7.2.2){.section-number .selfRef} [SM: Example of Flow from Internet to RAL](#name-sm-example-of-flow-from-int){.section-name .selfRef} {#name-sm-example-of-flow-from-int}

In this case, the flow comprises:[¶](#section-7.2.2-1){.pilcrow}

Internet \--\> root (6LBR) \--\> 6LR_i \--\> RAL
(6LN)[¶](#section-7.2.2-2){.pilcrow}

For example, a communication flow could be: Internet \--\> Node A root
(6LBR) \--\> Node B (6LR_1) \--\> Node D (6LR_n) \--\> Node F
(RAL)[¶](#section-7.2.2-3){.pilcrow}

When the packet arrives from Internet to 6LBR, the RPI is added in a
outer IPv6-in-IPv6 header (with the IPv6-in-IPv6 destination address set
to the RAL) and sent to the 6LR, which modifies the Rank in the RPI.
When the packet arrives at the RAL, the packet is decapsulated, which
removes the RPI before the packet is
processed.[¶](#section-7.2.2-4){.pilcrow}

[Table 12](#Storing-int2rpl){.xref} summarizes which headers are needed
for this use case.[¶](#section-7.2.2-5){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-f}

::: {#Storing-int2rpl}
  Header              Internet src   6LBR            6LR_i   RAL dst
  ------------------- -------------- --------------- ------- ---------------
  Added headers       \--            IP6-IP6 (RPI)   \--     \--
  Modified headers    \--            \--             RPI     \--
  Removed headers     \--            \--             \--     IP6-IP6 (RPI)
  Untouched headers   \--            \--             \--     \--

  : [Table 12](#table-12){.selfRef}: [SM: Summary of the Use of Headers
  from Internet to
  RAL](#name-sm-summary-of-the-use-of-headers-f){.selfRef}
:::
:::

::: {#sm-nRal2i}
::: {#section-7.2.3 .section}
#### [7.2.3.](#section-7.2.3){.section-number .selfRef} [SM: Example of Flow from RUL to Internet](#name-sm-example-of-flow-from-rul-){.section-name .selfRef} {#name-sm-example-of-flow-from-rul-}

In this case, the flow comprises:[¶](#section-7.2.3-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_i \--\> root (6LBR) \--\>
Internet[¶](#section-7.2.3-2){.pilcrow}

For example, a communication flow could be: Node G (RUL) \--\> Node E
(6LR_1) \--\> Node B (6lR_i) \--\> Node A root (6LBR) \--\>
Internet[¶](#section-7.2.3-3){.pilcrow}

The node 6LR_1 (i=1) will add an IPv6-in-IPv6 (RPI) header addressed to
the root such that the root can remove the RPI before passing upwards.
In the intermediate 6LR, the Rank in the RPI is
modified.[¶](#section-7.2.3-4){.pilcrow}

The originating node will ideally leave the IPv6 flow label as zero so
that the packet can be better compressed through the LLN. The 6LBR will
set the flow label of the packet to a non-zero value when sending to the
Internet. For details, check
\[[RFC6437](#RFC6437){.xref}\].[¶](#section-7.2.3-5){.pilcrow}

[Table 13](#Storing-notrpl2int){.xref} summarizes which headers are
needed for this use case.[¶](#section-7.2.3-6){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-fr}

::: {#Storing-notrpl2int}
  Header              IPv6 src (RUL)   6LR_1           6LR_i i=(2,..,n)   6LBR            Internet dst
  ------------------- ---------------- --------------- ------------------ --------------- --------------
  Added headers       \--              IP6-IP6 (RPI)   \--                \--             \--
  Modified headers    \--              \--             RPI                \--             \--
  Removed headers     \--              \--             \--                IP6-IP6 (RPI)   \--
  Untouched headers   \--              \--             \--                \--             \--

  : [Table 13](#table-13){.selfRef}: [SM: Summary of the Use of Headers
  from RUL to
  Internet](#name-sm-summary-of-the-use-of-headers-fr){.selfRef}
:::
:::
:::

::: {#section-7.2.4 .section}
#### [7.2.4.](#section-7.2.4){.section-number .selfRef} [SM: Example of Flow from Internet to RUL](#name-sm-example-of-flow-from-inte){.section-name .selfRef} {#name-sm-example-of-flow-from-inte}

In this case, the flow comprises:[¶](#section-7.2.4-1){.pilcrow}

Internet \--\> root (6LBR) \--\> 6LR_i \--\> RUL (IPv6 dst
node)[¶](#section-7.2.4-2){.pilcrow}

For example, a communication flow could be: Internet \--\> Node A root
(6LBR) \--\> Node B (6LR_i) \--\> Node E (6LR_n) \--\> Node G
(RUL)[¶](#section-7.2.4-3){.pilcrow}

The 6LBR will have to add an RPI within an IPv6-in-IPv6 header. The
IPv6-in-IPv6 encapsulating header is addressed to the 6LR parent of the
RUL.[¶](#section-7.2.4-4){.pilcrow}

Further details about this are mentioned in
\[[RFC9010](#RFC9010){.xref}\], which specifies RPL routing for a 6LN
acting as a plain host and being unaware of
RPL.[¶](#section-7.2.4-5){.pilcrow}

The 6LBR may set the flow label on the inner IPv6-in-IPv6 header to zero
in order to aid in compression \[[RFC8138](#RFC8138){.xref}\]
\[[RFC6437](#RFC6437){.xref}\].[¶](#section-7.2.4-6){.pilcrow}

[Table 14](#Storing-int2notrpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-7.2.4-7){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-fr-2}

::: {#Storing-int2notrpl}
  Header              Internet src   6LBR            6LR_i i=(1,..,n-1)   6LR_n           RUL dst
  ------------------- -------------- --------------- -------------------- --------------- ---------
  Added headers       \--            IP6-IP6 (RPI)   \--                  \--             \--
  Modified headers    \--            \--             RPI                  \--             \--
  Removed headers     \--            \--             \--                  IP6-IP6 (RPI)   \--
  Untouched headers   \--            \--             \--                  \--             \--

  : [Table 14](#table-14){.selfRef}: [SM: Summary of the Use of Headers
  from Internet to
  RUL](#name-sm-summary-of-the-use-of-headers-fr-2){.selfRef}
:::
:::
:::

::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [SM: Interaction between Leaf and Leaf](#name-sm-interaction-between-leaf-){.section-name .selfRef} {#name-sm-interaction-between-leaf-}

This section describes the communication flow in Storing mode (SM)
between the following:[¶](#section-7.3-1){.pilcrow}

-   [RAL to RAL[¶](#section-7.3-2.1){.pilcrow}]{#section-7.3-2.1}
-   [RAL to RUL[¶](#section-7.3-2.2){.pilcrow}]{#section-7.3-2.2}
-   [RUL to RAL[¶](#section-7.3-2.3){.pilcrow}]{#section-7.3-2.3}
-   [RUL to RUL[¶](#section-7.3-2.4){.pilcrow}]{#section-7.3-2.4}

::: {#storingRALtoRAL}
::: {#section-7.3.1 .section}
#### [7.3.1.](#section-7.3.1){.section-number .selfRef} [SM: Example of Flow from RAL to RAL](#name-sm-example-of-flow-from-ral-t){.section-name .selfRef} {#name-sm-example-of-flow-from-ral-t}

In \[[RFC6550](#RFC6550){.xref}\], RPL allows a simple, one-hop
optimization for both Storing and Non-Storing networks. A node may send
a packet destined to a one-hop neighbor directly to that node. See
[Section 9](https://www.rfc-editor.org/rfc/rfc6550#section-9){.relref}
of \[[RFC6550](#RFC6550){.xref}\].[¶](#section-7.3.1-1){.pilcrow}

When the nodes are not directly connected, then the flow comprises the
following in the Storing mode:[¶](#section-7.3.1-2){.pilcrow}

RAL src (6LN) \--\> 6LR_ia \--\> common parent (6LR_x) \--\> 6LR_id
\--\> RAL dst (6LN)[¶](#section-7.3.1-3){.pilcrow}

For example, a communication flow could be: Node F (RAL src) \--\> Node
D (6LR_ia) \--\> Node B (6LR_x) \--\> Node E (6LR_id) \--\> Node H (RAL
dst)[¶](#section-7.3.1-4){.pilcrow}

6LR_ia (Node D) represents the intermediate routers from the source to
the common parent 6LR_x (Node B), and 1 \<= ia \<= n, where n is the
total number of routers (6LR) that the packet goes through, from the RAL
(Node F) to the common parent 6LR_x (Node
B).[¶](#section-7.3.1-5){.pilcrow}

6LR_id (Node E) represents the intermediate routers from the common
parent 6LR_x (Node B) to the destination RAL (Node H), and 1 \<= id \<=
m, where m is the total number of routers (6LR) that the packet goes
through, from the common parent (6LR_x) to the destination RAL (Node
H).[¶](#section-7.3.1-6){.pilcrow}

It is assumed that the two nodes are in the same RPL domain (that they
share the same DODAG root). At the common parent (Node B), the direction
flag (\'O\' flag) of the RPI is changed (from decreasing ranks to
increasing ranks).[¶](#section-7.3.1-7){.pilcrow}

While the 6LR nodes will update the RPI, no node needs to add or remove
the RPI, so no IPv6-in-IPv6 headers are
necessary.[¶](#section-7.3.1-8){.pilcrow}

[Table 15](#Storing-rpl2rpl){.xref} summarizes which headers are needed
for this use case.[¶](#section-7.3.1-9){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-fr-3}

::: {#Storing-rpl2rpl}
  Header              RAL src   6LR_ia   6LR_x (common parent)   6LR_id   RAL dst
  ------------------- --------- -------- ----------------------- -------- ---------
  Added headers       RPI       \--      \--                     \--      \--
  Modified headers    \--       RPI      RPI                     RPI      \--
  Removed headers     \--       \--      \--                     \--      RPI
  Untouched headers   \--       \--      \--                     \--      \--

  : [Table 15](#table-15){.selfRef}: [SM: Summary of the Use of Headers
  from RAL to
  RAL](#name-sm-summary-of-the-use-of-headers-fr-3){.selfRef}
:::
:::
:::

::: {#storingRALtononRAL}
::: {#section-7.3.2 .section}
#### [7.3.2.](#section-7.3.2){.section-number .selfRef} [SM: Example of Flow from RAL to RUL](#name-sm-example-of-flow-from-ral-to){.section-name .selfRef} {#name-sm-example-of-flow-from-ral-to}

In this case, the flow comprises:[¶](#section-7.3.2-1){.pilcrow}

RAL src (6LN) \--\> 6LR_ia \--\> common parent (6LBR, the root) \--\>
6LR_id \--\> RUL (IPv6 dst node)[¶](#section-7.3.2-2){.pilcrow}

For example, a communication flow could be: Node F (RAL) \--\> Node D
\--\> Node B \--\> Node A \--\> Node B \--\> Node E \--\> Node G
(RUL)[¶](#section-7.3.2-3){.pilcrow}

6LR_ia represents the intermediate routers from the source (RAL) to the
common parent (the root), and 1 \<= ia \<= n, where n is the total
number of routers (6LR) that the packet goes through, from the RAL to
the root.[¶](#section-7.3.2-4){.pilcrow}

6LR_id (Node E) represents the intermediate routers from the root (Node
B) to the destination RUL (Node G). In this case, 1 \<= id \<= m, where
m is the total number of routers (6LR) that the packet goes through,
from the root down to the destination
RUL.[¶](#section-7.3.2-5){.pilcrow}

In this case, the packet from the RAL goes to the 6LBR because the route
to the RUL is not injected into the RPL SM. Thus, the RAL inserts an RPI
(RPI1) addressed to the root (6LBR). The root does not remove the RPI1
(the root cannot remove an RPI if there is no encapsulation). The root
inserts an IPv6-in-IPv6 encapsulation with an RPI2 and sends it to the
6LR parent of the RUL, which removes the encapsulation and RPI2 before
passing the packet to the RUL.[¶](#section-7.3.2-6){.pilcrow}

[Table 16](#Storing-rpl2nrpl){.xref} summarizes which headers are needed
for this use case.[¶](#section-7.3.2-7){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-fr-4}

::: {#Storing-rpl2nrpl}
  Header              RAL src   6LR_ia   6LBR             6LR_id   6LR_m            RUL dst
  ------------------- --------- -------- ---------------- -------- ---------------- ----------------
  Added headers       RPI1      \--      IP6-IP6 (RPI2)   \--      \--              \--
  Modified headers    \--       RPI1     \--              RPI2     \--              \--
  Removed headers     \--       \--      \--              \--      IP6-IP6 (RPI2)   \--
  Untouched headers   \--       \--      RPI1             RPI1     RPI1             RPI1 (ignored)

  : [Table 16](#table-16){.selfRef}: [SM: Summary of the Use of Headers
  from RAL to
  RUL](#name-sm-summary-of-the-use-of-headers-fr-4){.selfRef}
:::
:::
:::

::: {#storingnotRALtoRAL}
::: {#section-7.3.3 .section}
#### [7.3.3.](#section-7.3.3){.section-number .selfRef} [SM: Example of Flow from RUL to RAL](#name-sm-example-of-flow-from-rul-t){.section-name .selfRef} {#name-sm-example-of-flow-from-rul-t}

In this case, the flow comprises:[¶](#section-7.3.3-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_ia \--\> 6LBR \--\> 6LR_id \--\> RAL dst
(6LN)[¶](#section-7.3.3-2){.pilcrow}

For example, a communication flow could be: Node G (RUL) \--\> Node E
\--\> Node B \--\> Node A \--\> Node B \--\> Node D \--\> Node F
(RAL)[¶](#section-7.3.3-3){.pilcrow}

6LR_ia (Node E) represents the intermediate routers from the source
(RUL) (Node G) to the root (Node A). In this case, 1 \<= ia \<= n, where
n is the total number of routers (6LR) that the packet goes through,
from the source to the root.[¶](#section-7.3.3-4){.pilcrow}

6LR_id represents the intermediate routers from the root (Node A) to the
destination RAL (Node F). In this case, 1 \<= id \<= m, where m is the
total number of routers (6LR) that the packet goes through, from the
root to the destination RAL.[¶](#section-7.3.3-5){.pilcrow}

The 6LR_1 (Node E) receives the packet from the RUL (Node G) and inserts
the RPI (RPI1) encapsulated in an IPv6-in-IPv6 header to the root. The
root removes the outer header including the RPI (RPI1) and inserts a new
RPI (RPI2) addressed to the destination RAL (Node
F).[¶](#section-7.3.3-6){.pilcrow}

[Table 17](#Storing-notrpl2rpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-7.3.3-7){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-fr-5}

::: {#Storing-notrpl2rpl}
  Header              RUL src   6LR_1            6LR_ia   6LBR             6LR_id   RAL dst
  ------------------- --------- ---------------- -------- ---------------- -------- ----------------
  Added headers       \--       IP6-IP6 (RPI1)   \--      IP6-IP6 (RPI2)   \--      \--
  Modified headers    \--       \--              RPI1     \--              RPI2     \--
  Removed headers     \--       \--              \--      IP6-IP6 (RPI1)   \--      IP6-IP6 (RPI2)
  Untouched headers   \--       \--              \--      \--              \--      \--

  : [Table 17](#table-17){.selfRef}: [SM: Summary of the Use of Headers
  from RUL to
  RAL](#name-sm-summary-of-the-use-of-headers-fr-5){.selfRef}
:::
:::
:::

::: {#section-7.3.4 .section}
#### [7.3.4.](#section-7.3.4){.section-number .selfRef} [SM: Example of Flow from RUL to RUL](#name-sm-example-of-flow-from-rul-to){.section-name .selfRef} {#name-sm-example-of-flow-from-rul-to}

In this case, the flow comprises:[¶](#section-7.3.4-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_ia \--\> 6LBR \--\> 6LR_id
\--\> RUL (IPv6 dst node)[¶](#section-7.3.4-2){.pilcrow}

For example, a communication flow could be: Node G (RUL src) \--\> Node
E \--\> Node B \--\> Node A (root) \--\> Node C \--\> Node J (RUL
dst)[¶](#section-7.3.4-3){.pilcrow}

Internal nodes 6LR_ia (e.g., Node E or Node B) is the intermediate
router from the RUL source (Node G) to the root (6LBR) (Node A). In this
case, 1 \<= ia \<= n, where n is the total number of routers (6LR) that
the packet goes through, from the RUL to the root. 6LR_1 applies when
ia=1.[¶](#section-7.3.4-4){.pilcrow}

6LR_id (Node C) represents the intermediate routers from the root (Node
A) to the destination RUL (Node J). In this case, 1 \<= id \<= m, where
m is the total number of routers (6LR) that the packet goes through,
from the root to the destination RUL.[¶](#section-7.3.4-5){.pilcrow}

The 6LR_1 (Node E) receives the packet from the RUL (Node G) and adds
the RPI (RPI1) in an IPv6-in-IPv6 encapsulation directed to the root.
The root removes the outer header including the RPI (RPI1) and inserts a
new RPI (RPI2) addressed to the 6LR parent of the
RUL.[¶](#section-7.3.4-6){.pilcrow}

[Table 18](#Storing-notrpl2notrpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-7.3.4-7){.pilcrow}

[]{#name-sm-summary-of-the-use-of-headers-fr-6}

::: {#Storing-notrpl2notrpl}
  Header              RUL src   6LR_1            6LR_ia   6LBR             6LR_id   6LR_n            RUL dst
  ------------------- --------- ---------------- -------- ---------------- -------- ---------------- ---------
  Added headers       \--       IP6-IP6 (RPI1)   \--      IP6-IP6 (RPI1)   \--      \--              \--
  Modified headers    \--       \--              RPI1     \--              RPI2     \--              \--
  Removed headers     \--       \--              \--      IP6-IP6 (RPI1)   \--      IP6-IP6 (RPI2)   \--
  Untouched headers   \--       \--              \--      \--              \--      \--              \--

  : [Table 18](#table-18){.selfRef}: [SM: Summary of the Use of Headers
  from RUL to
  RUL](#name-sm-summary-of-the-use-of-headers-fr-6){.selfRef}
:::
:::
:::
:::
:::

::: {#sec_non-sm}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Non-Storing Mode](#name-non-storing-mode){.section-name .selfRef} {#name-non-storing-mode}

In Non-Storing mode (Non-SM) (fully source routed), the 6LBR (DODAG
root) has complete knowledge about the connectivity of all DODAG nodes
and all traffic flows through the root node. Thus, there is no need for
all nodes to know about the existence of RPL-unaware nodes. Only the
6LBR needs to act if compensation is necessary for RPL-unaware
receivers.[¶](#section-8-1){.pilcrow}

[Table 19](#fig_table_non-storing){.xref} summarizes which headers are
needed in the following scenarios and indicates when the RPI, RH3, and
IPv6-in-IPv6 header are to be inserted. The last column depicts the
target destination of the IPv6-in-IPv6 header: 6LN (indicated by
\"RAL\"), 6LR (parent of a RUL), or the root. In cases where no
IPv6-in-IPv6 header is needed, the column indicates \"No\". There is no
expectation on RPL that RPI can be omitted because it is needed for
routing, quality of service, and compression. This specification expects
that an RPI is always present. The term \"may(up)\" means that the
IPv6-in-IPv6 header may be necessary in the Upward direction. The term
\"must(up)\" means that the IPv6-in-IPv6 header must be present in the
Upward direction. The term \"must(down)\" means that the IPv6-in-IPv6
header must be present in the Downward
direction.[¶](#section-8-2){.pilcrow}

The leaf can be a router 6LR or a host, both indicated as 6LN ([Figure
3](#fig_CommonTopology){.xref}). In [Table
19](#fig_table_non-storing){.xref}, the (1) indicates a 6TiSCH case
\[[RFC8180](#RFC8180){.xref}\], where the RPI may still be needed for
the RPLInstanceID to be available for priority/channel selection at each
hop.[¶](#section-8-3){.pilcrow}

[]{#name-headers-needed-in-non-stori}

::: {#fig_table_non-storing}
  Interaction between   Use Case      RPI       RH3   IPv6-in-IPv6   IP-in-IP dst
  --------------------- ------------- --------- ----- -------------- --------------
  Leaf - Root           RAL to root   Yes       No    No             No
                        root to RAL   Yes       Yes   No             No
                        root to RUL   Yes (1)   Yes   No             6LR
                        RUL to root   Yes       No    must           root
  Leaf - Internet       RAL to Int    Yes       No    may(up)        root
                        Int to RAL    Yes       Yes   must           RAL
                        RUL to Int    Yes       No    must           root
                        Int to RUL    Yes       Yes   must           6LR
  Leaf - Leaf           RAL to RAL    Yes       Yes   may(up)        root
                                                      must(down)     RAL
                        RAL to RUL    Yes       Yes   may(up)        root
                                                      must(down)     6LR
                        RUL to RAL    Yes       Yes   must(up)       root
                                                      must(down)     RAL
                        RUL to RUL    Yes       Yes   must(up)       root
                                                      must(down)     6LR

  : [Table 19](#table-19){.selfRef}: [Headers Needed in Non-Storing
  Mode: RPI, RH3, IPv6-in-IPv6
  Encapsulation](#name-headers-needed-in-non-stori){.selfRef}
:::

::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Non-Storing Mode: Interaction between Leaf and Root](#name-non-storing-mode-interactio){.section-name .selfRef} {#name-non-storing-mode-interactio}

This section describes the communication flow in Non-Storing mode
(Non-SM) between the following:[¶](#section-8.1-1){.pilcrow}

-   [RAL to root[¶](#section-8.1-2.1){.pilcrow}]{#section-8.1-2.1}
-   [root to RAL[¶](#section-8.1-2.2){.pilcrow}]{#section-8.1-2.2}
-   [RUL to root[¶](#section-8.1-2.3){.pilcrow}]{#section-8.1-2.3}
-   [root to RUL[¶](#section-8.1-2.4){.pilcrow}]{#section-8.1-2.4}

::: {#section-8.1.1 .section}
#### [8.1.1.](#section-8.1.1){.section-number .selfRef} [Non-SM: Example of Flow from RAL to Root](#name-non-sm-example-of-flow-from){.section-name .selfRef} {#name-non-sm-example-of-flow-from}

In Non-Storing mode, the leaf node uses default routing to send traffic
to the root. The RPI must be included since it contains the Rank
information, which is used to avoid and/or detect
loops.[¶](#section-8.1.1-1){.pilcrow}

RAL (6LN) \--\> 6LR_i \--\> root(6LBR)[¶](#section-8.1.1-2){.pilcrow}

For example, a communication flow could be: Node F \--\> Node D \--\>
Node B \--\> Node A (root)[¶](#section-8.1.1-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination. In this case, 1 \<= i \<= n, where n is the total number of
routers (6LR) that the packet goes through, from the source (RAL) to the
destination (6LBR).[¶](#section-8.1.1-4){.pilcrow}

This situation is the same case as Storing
mode.[¶](#section-8.1.1-5){.pilcrow}

[Table 20](#NonStoring-summary-headers){.xref} summarizes which headers
are needed for this use case.[¶](#section-8.1.1-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-o}

::: {#NonStoring-summary-headers}
  Header              RAL src   6LR_i   6LBR dst
  ------------------- --------- ------- ----------
  Added headers       RPI       \--     \--
  Modified headers    \--       RPI     \--
  Removed headers     \--       \--     RPI
  Untouched headers   \--       \--     \--

  : [Table 20](#table-20){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to Root](#name-non-sm-summary-of-the-use-o){.selfRef}
:::
:::

::: {#nsroottoRAL}
::: {#section-8.1.2 .section}
#### [8.1.2.](#section-8.1.2){.section-number .selfRef} [Non-SM: Example of Flow from Root to RAL](#name-non-sm-example-of-flow-from-){.section-name .selfRef} {#name-non-sm-example-of-flow-from-}

In this case, the flow comprises:[¶](#section-8.1.2-1){.pilcrow}

root (6LBR) \--\> 6LR_i \--\> RAL (6LN)[¶](#section-8.1.2-2){.pilcrow}

For example, a communication flow could be: Node A (root) \--\> Node B
\--\> Node D \--\> Node F[¶](#section-8.1.2-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination. In this case, 1 \<= i \<= n, where n is the total number of
routers (6LR) that the packet goes through, from the source (6LBR) to
the destination (RAL).[¶](#section-8.1.2-4){.pilcrow}

The 6LBR inserts an RH3 and an RPI. No IPv6-in-IPv6 header is necessary
as the traffic originates with a RPL-aware node, the 6LBR. The
destination is known to be RPL aware because the root knows the whole
topology in Non-Storing mode.[¶](#section-8.1.2-5){.pilcrow}

[Table 21](#NonStoring-root2rpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.1.2-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of}

::: {#NonStoring-root2rpl}
  Header              6LBR src   6LR_i      RAL dst
  ------------------- ---------- ---------- ----------
  Added headers       RPI, RH3   \--        \--
  Modified headers    \--        RPI, RH3   \--
  Removed headers     \--        \--        RPI, RH3
  Untouched headers   \--        \--        \--

  : [Table 21](#table-21){.selfRef}: [Non-SM: Summary of the Use of
  Headers from Root to
  RAL](#name-non-sm-summary-of-the-use-of){.selfRef}
:::
:::
:::

::: {#section-8.1.3 .section}
#### [8.1.3.](#section-8.1.3){.section-number .selfRef} [Non-SM: Example of Flow from Root to RUL](#name-non-sm-example-of-flow-from-r){.section-name .selfRef} {#name-non-sm-example-of-flow-from-r}

In this case, the flow comprises:[¶](#section-8.1.3-1){.pilcrow}

root (6LBR) \--\> 6LR_i \--\> RUL (IPv6 dst
node)[¶](#section-8.1.3-2){.pilcrow}

For example, a communication flow could be: Node A (root) \--\> Node B
\--\> Node E \--\> Node G (RUL)[¶](#section-8.1.3-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination. In this case, 1 \<= i \<= n, where n is the total number of
routers (6LR) that the packet goes through, from the source (6LBR) to
the destination (RUL).[¶](#section-8.1.3-4){.pilcrow}

In the 6LBR, the RH3 is added; it is then modified at each intermediate
6LR (6LR_1 and so on), and it is fully consumed in the last 6LR (6LR_n)
but is left in place. When the RPI is added, the RUL, which does not
understand the RPI, will ignore it (per \[[RFC8200](#RFC8200){.xref}\]);
thus, encapsulation is not necessary.[¶](#section-8.1.3-5){.pilcrow}

[Table 22](#NonStoring-root2notrpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.1.3-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-}

::: {#NonStoring-root2notrpl}
  Header              6LBR src   6LR_i i=(1,..,n-1)   6LR_n                RUL dst
  ------------------- ---------- -------------------- -------------------- -------------------------
  Added headers       RPI, RH3   \--                  \--                  \--
  Modified headers    \--        RPI, RH3             RPI, RH3(consumed)   \--
  Removed headers     \--        \--                  \--                  \--
  Untouched headers   \--        \--                  \--                  RPI, RH3 (both ignored)

  : [Table 22](#table-22){.selfRef}: [Non-SM: Summary of the Use of
  Headers from Root to
  RUL](#name-non-sm-summary-of-the-use-of-){.selfRef}
:::
:::

::: {#section-8.1.4 .section}
#### [8.1.4.](#section-8.1.4){.section-number .selfRef} [Non-SM: Example of Flow from RUL to Root](#name-non-sm-example-of-flow-from-ru){.section-name .selfRef} {#name-non-sm-example-of-flow-from-ru}

In this case, the flow comprises:[¶](#section-8.1.4-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_i \--\> root (6LBR)
dst[¶](#section-8.1.4-2){.pilcrow}

For example, a communication flow could be: Node G \--\> Node E \--\>
Node B \--\> Node A (root)[¶](#section-8.1.4-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination. In this case, 1 \<= i \<= n, where n is the total number of
routers (6LR) that the packet goes through, from the source (RUL) to the
destination (6LBR). For example, 6LR_1 (i=1) is the router that receives
the packets from the RUL.[¶](#section-8.1.4-4){.pilcrow}

In this case, the RPI is added by the first 6LR (6LR_1) (Node E),
encapsulated in an IPv6-in-IPv6 header, and modified in the subsequent
6LRs in the flow. The RPI and the entire packet are consumed by the
root.[¶](#section-8.1.4-5){.pilcrow}

[Table 23](#NonStoring-notrpl2root){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.1.4-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-h}

::: {#NonStoring-notrpl2root}
  Header              RUL src   6LR_1                6LR_i   6LBR dst
  ------------------- --------- -------------------- ------- --------------------
  Added headers       \--       IPv6-in-IPv6 (RPI)   \--     \--
  Modified headers    \--       \--                  RPI     \--
  Removed headers     \--       \--                  \--     IPv6-in-IPv6 (RPI)
  Untouched headers   \--       \--                  \--     \--

  : [Table 23](#table-23){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RUL to
  Root](#name-non-sm-summary-of-the-use-of-h){.selfRef}
:::
:::
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Non-Storing Mode: Interaction between Leaf and Internet](#name-non-storing-mode-interaction){.section-name .selfRef} {#name-non-storing-mode-interaction}

This section describes the communication flow in Non-Storing mode
(Non-SM) between the following:[¶](#section-8.2-1){.pilcrow}

-   [RAL to Internet[¶](#section-8.2-2.1){.pilcrow}]{#section-8.2-2.1}
-   [Internet to RAL[¶](#section-8.2-2.2){.pilcrow}]{#section-8.2-2.2}
-   [RUL to Internet[¶](#section-8.2-2.3){.pilcrow}]{#section-8.2-2.3}
-   [Internet to RUL[¶](#section-8.2-2.4){.pilcrow}]{#section-8.2-2.4}

::: {#section-8.2.1 .section}
#### [8.2.1.](#section-8.2.1){.section-number .selfRef} [Non-SM: Example of Flow from RAL to Internet](#name-non-sm-example-of-flow-from-ra){.section-name .selfRef} {#name-non-sm-example-of-flow-from-ra}

In this case, the flow comprises:[¶](#section-8.2.1-1){.pilcrow}

RAL (6LN) src \--\> 6LR_i \--\> root (6LBR) \--\> Internet
dst[¶](#section-8.2.1-2){.pilcrow}

For example, a communication flow could be: Node F (RAL) \--\> Node D
\--\> Node B \--\> Node A \--\> Internet. Having the RAL information
about the RPL domain, the packet may be encapsulated to the root when
the destination is not in the RPL domain of the
RAL.[¶](#section-8.2.1-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination, and 1 \<= i \<= n, where n is the total number of routers
(6LR) that the packet goes through, from the source (RAL) to the
6LBR.[¶](#section-8.2.1-4){.pilcrow}

In this case, the encapsulation from the RAL to the root is optional.
The simplest case is when the RPI gets to the Internet (as the [Table
24](#NonStoring-rpl2int){.xref} shows it), knowing that the Internet is
going to ignore it.[¶](#section-8.2.1-5){.pilcrow}

The IPv6 flow label should be set to zero to aid in compression
\[[RFC8138](#RFC8138){.xref}\], and the 6LBR will set it to a non-zero
value when sending towards the Internet
\[[RFC6437](#RFC6437){.xref}\].[¶](#section-8.2.1-6){.pilcrow}

[Table 24](#NonStoring-rpl2int){.xref} summarizes which headers are
needed for this use case when no encapsulation is used. [Table
25](#NonStoring-rpl2intwithIPIP){.xref} summarizes which headers are
needed for this use case when encapsulation to the root is
used.[¶](#section-8.2.1-7){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-he}

::: {#NonStoring-rpl2int}
  Header              RAL src   6LR_i   6LBR   Internet dst
  ------------------- --------- ------- ------ ---------------
  Added headers       RPI       \--     \--    \--
  Modified headers    \--       RPI     RPI    \--
  Removed headers     \--       \--     \--    \--
  Untouched headers   \--       \--     \--    RPI (Ignored)

  : [Table 24](#table-24){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to Internet with No
  Encapsulation](#name-non-sm-summary-of-the-use-of-he){.selfRef}
:::

[]{#name-non-sm-summary-of-the-use-of-hea}

::: {#NonStoring-rpl2intwithIPIP}
  Header              RAL src               6LR_i   6LBR                 Internet dst
  ------------------- --------------------- ------- -------------------- --------------
  Added headers       IP6v6-in-IPv6 (RPI)   \--     \--                  \--
  Modified headers    \--                   RPI     \--                  \--
  Removed headers     \--                   \--     IPv6-in-IPv6 (RPI)   \--
  Untouched headers   \--                   \--     \--                  \--

  : [Table 25](#table-25){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to Internet with Encapsulation to the
  Root](#name-non-sm-summary-of-the-use-of-hea){.selfRef}
:::
:::

::: {#section-8.2.2 .section}
#### [8.2.2.](#section-8.2.2){.section-number .selfRef} [Non-SM: Example of Flow from Internet to RAL](#name-non-sm-example-of-flow-from-i){.section-name .selfRef} {#name-non-sm-example-of-flow-from-i}

In this case, the flow comprises:[¶](#section-8.2.2-1){.pilcrow}

Internet \--\> root (6LBR) \--\> 6LR_i \--\> RAL dst
(6LN)[¶](#section-8.2.2-2){.pilcrow}

For example, a communication flow could be: Internet \--\> Node A (root)
\--\> Node B \--\> Node D \--\> Node F
(RAL)[¶](#section-8.2.2-3){.pilcrow}

6LR_i represents the intermediate routers from source to destination,
and 1 \<= i \<= n, where n is the total number of routers (6LR) that the
packet goes through, from the 6LBR to the destination
(RAL).[¶](#section-8.2.2-4){.pilcrow}

The 6LBR must add an RH3 header. As the 6LBR will know the path and
address of the target node, it can address the IPv6-in-IPv6 header to
that node. The 6LBR will zero the flow label upon entry in order to aid
compression
\[[RFC8138](#RFC8138){.xref}\].[¶](#section-8.2.2-5){.pilcrow}

[Table 26](#NonStoring-int2rpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.2.2-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-head}

::: {#NonStoring-int2rpl}
  Header              Internet src   6LBR                      6LR_i                     RAL dst
  ------------------- -------------- ------------------------- ------------------------- -------------------------
  Added headers       \--            IPv6-in-IPv6 (RH3, RPI)   \--                       \--
  Modified headers    \--            \--                       IPv6-in-IPv6 (RH3, RPI)   \--
  Removed headers     \--            \--                       \--                       IPv6-in-IPv6 (RH3, RPI)
  Untouched headers   \--            \--                       \--                       \--

  : [Table 26](#table-26){.selfRef}: [Non-SM: Summary of the Use of
  Headers from Internet to
  RAL](#name-non-sm-summary-of-the-use-of-head){.selfRef}
:::
:::

::: {#section-8.2.3 .section}
#### [8.2.3.](#section-8.2.3){.section-number .selfRef} [Non-SM: Example of Flow from RUL to Internet](#name-non-sm-example-of-flow-from-rul){.section-name .selfRef} {#name-non-sm-example-of-flow-from-rul}

In this case, the flow comprises:[¶](#section-8.2.3-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_i \--\> root (6LBR) \--\>
Internet dst[¶](#section-8.2.3-2){.pilcrow}

For example, a communication flow could be: Node G \--\> Node E \--\>
Node B \--\> Node A \--\> Internet[¶](#section-8.2.3-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination, and 1 \<= i \<= n, where n is the total number of routers
(6LRs) that the packet goes through, from the source (RUL) to the 6LBR,
e.g., 6LR_1 (i=1).[¶](#section-8.2.3-4){.pilcrow}

In this case, the flow label is recommended to be zero in the RUL. As
the RUL parent adds RPL headers in the RUL packet, the first 6LR (6LR_1)
will add an RPI inside a new IPv6-in-IPv6 header. The IPv6-in-IPv6
header will be addressed to the root. This case is identical to the
Storing mode case (see [Section
7.2.3](#sm-nRal2i){.xref}).[¶](#section-8.2.3-5){.pilcrow}

[Table 27](#NonStoring-notrpl2int){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.2.3-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-heade}

::: {#NonStoring-notrpl2int}
  Header              RUL src   6LR_1           6LR_i i=(2,..,n)   6LBR            Internet dst
  ------------------- --------- --------------- ------------------ --------------- --------------
  Added headers       \--       IP6-IP6 (RPI)   \--                \--             \--
  Modified headers    \--       \--             RPI                \--             \--
  Removed headers     \--       \--             \--                IP6-IP6 (RPI)   \--
  Untouched headers   \--       \--             \--                \--             \--

  : [Table 27](#table-27){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RUL to
  Internet](#name-non-sm-summary-of-the-use-of-heade){.selfRef}
:::
:::

::: {#section-8.2.4 .section}
#### [8.2.4.](#section-8.2.4){.section-number .selfRef} [Non-SM: Example of Flow from Internet to RUL](#name-non-sm-example-of-flow-from-in){.section-name .selfRef} {#name-non-sm-example-of-flow-from-in}

In this case, the flow comprises:[¶](#section-8.2.4-1){.pilcrow}

Internet src \--\> root (6LBR) \--\> 6LR_i \--\> RUL (IPv6 dst
node)[¶](#section-8.2.4-2){.pilcrow}

For example, a communication flow could be: Internet \--\> Node A (root)
\--\> Node B \--\> Node E \--\> Node G[¶](#section-8.2.4-3){.pilcrow}

6LR_i represents the intermediate routers from the source to the
destination, and 1 \<= i \<= n, where n is the total number of routers
(6LR) that the packet goes through, from the 6LBR to the
RUL.[¶](#section-8.2.4-4){.pilcrow}

The 6LBR must add an RH3 header inside an IPv6-in-IPv6 header. The 6LBR
will know the path and will recognize that the final node is not a
RPL-capable node as it will have received the connectivity DAO from the
nearest 6LR. The 6LBR can therefore make the IPv6-in-IPv6 header
destination be the last 6LR. The 6LBR will set to zero the flow label
upon entry in order to aid compression
\[[RFC8138](#RFC8138){.xref}\].[¶](#section-8.2.4-5){.pilcrow}

[Table 28](#NonStoring-int2notrpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.2.4-6){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-header}

::: {#NonStoring-int2notrpl}
  Header              Internet src   6LBR                 6LR_i                6LR_n                RUL dst
  ------------------- -------------- -------------------- -------------------- -------------------- ---------
  Added headers       \--            IP6-IP6 (RH3, RPI)   \--                  \--                  \--
  Modified headers    \--            \--                  IP6-IP6 (RH3, RPI)   \--                  \--
  Removed headers     \--            \--                  \--                  IP6-IP6 (RH3, RPI)   \--
  Untouched headers   \--            \--                  \--                  \--                  \--

  : [Table 28](#table-28){.selfRef}: [Non-SM: Summary of the Use of
  Headers from Internet to
  RUL](#name-non-sm-summary-of-the-use-of-header){.selfRef}
:::
:::
:::

::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [Non-SM: Interaction between Leaves](#name-non-sm-interaction-between-){.section-name .selfRef} {#name-non-sm-interaction-between-}

This section describes the communication flow in Non-Storing mode
(Non-SM) between the following:[¶](#section-8.3-1){.pilcrow}

-   [RAL to RAL[¶](#section-8.3-2.1){.pilcrow}]{#section-8.3-2.1}
-   [RAL to RUL[¶](#section-8.3-2.2){.pilcrow}]{#section-8.3-2.2}
-   [RUL to RAL[¶](#section-8.3-2.3){.pilcrow}]{#section-8.3-2.3}
-   [RUL to RUL[¶](#section-8.3-2.4){.pilcrow}]{#section-8.3-2.4}

::: {#section-8.3.1 .section}
#### [8.3.1.](#section-8.3.1){.section-number .selfRef} [Non-SM: Example of Flow from RAL to RAL](#name-non-sm-example-of-flow-from-ral){.section-name .selfRef} {#name-non-sm-example-of-flow-from-ral}

In this case, the flow comprises:[¶](#section-8.3.1-1){.pilcrow}

RAL src \--\> 6LR_ia \--\> root (6LBR) \--\> 6LR_id \--\> RAL
dst[¶](#section-8.3.1-2){.pilcrow}

For example, a communication flow could be: Node F (RAL src) \--\> Node
D \--\> Node B \--\> Node A (root) \--\> Node B \--\> Node E \--\> Node
H (RAL dst)[¶](#section-8.3.1-3){.pilcrow}

6LR_ia represents the intermediate routers from the source to the root,
and 1 \<= ia \<= n, where n is the total number of routers (6LR) that
the packet goes through, from the RAL to the
root.[¶](#section-8.3.1-4){.pilcrow}

6LR_id represents the intermediate routers from the root to the
destination, and 1 \<= id \<= m, where m is the total number of the
intermediate routers (6LR).[¶](#section-8.3.1-5){.pilcrow}

This case involves only nodes in same RPL domain. The originating node
will add an RPI to the original packet and send the packet
Upward.[¶](#section-8.3.1-6){.pilcrow}

The originating node may put the RPI (RPI1) into an IPv6-in-IPv6 header
addressed to the root so that the 6LBR can remove that header. If it
does not, then the RPI1 is forwarded down from the root in the inner
header to no avail.[¶](#section-8.3.1-7){.pilcrow}

The 6LBR will need to insert an RH3 header, which requires that it add
an IPv6-in-IPv6 header. It removes the RPI (RPI1), as it was contained
in an IPv6-in-IPv6 header addressed to it. Otherwise, there may be an
RPI buried inside the inner IP header, which should be ignored. The root
inserts an RPI (RPI2) alongside the RH3.[¶](#section-8.3.1-8){.pilcrow}

Networks that use the RPL point-to-point extension
\[[RFC6997](#RFC6997){.xref}\] are essentially Non-Storing DODAGs and
fall into this scenario or the scenario given in [Section
8.1.2](#nsroottoRAL){.xref}, with the originating node acting as a
6LBR.[¶](#section-8.3.1-9){.pilcrow}

[Table 29](#NonStoring-rpl2rpl){.xref} summarizes which headers are
needed for this use case when encapsulation to the root takes
place.[¶](#section-8.3.1-10){.pilcrow}

[Table 30](#NonStoring-rpl2rplnoIPIP){.xref} summarizes which headers
are needed for this use case when there is no encapsulation to the root.
Note that in the Modified headers row, going up in each 6LR_ia only the
RPI1 is changed. Going down, in each 6LR_id the IPv6 header is swapped
with the RH3 so both are changed alongside with the
RPI2.[¶](#section-8.3.1-11){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-header-2}

::: {#NonStoring-rpl2rpl}
  Header              RAL src          6LR_ia   6LBR                          6LR_id                RAL dst
  ------------------- ---------------- -------- ----------------------------- --------------------- ---------------------
  Added headers       IP6-IP6 (RPI1)   \--      IP6-IP6 (RH3 -\> RAL, RPI2)   \--                   \--
  Modified headers    \--              RPI1     \--                           IP6-IP6 (RH3, RPI2)   \--
  Removed headers     \--              \--      IP6-IP6 (RPI1)                \--                   IP6-IP6 (RH3, RPI2)
  Untouched headers   \--              \--      \--                           \--                   \--

  : [Table 29](#table-29){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to RAL with Encapsulation to the
  Root](#name-non-sm-summary-of-the-use-of-header-2){.selfRef}
:::

[]{#name-non-sm-summary-of-the-use-of-header-3}

::: {#NonStoring-rpl2rplnoIPIP}
  Header              RAL src   6LR_ia   6LBR                  6LR_id                RAL dst
  ------------------- --------- -------- --------------------- --------------------- ---------------------
  Added headers       RPI1      \--      IP6-IP6 (RH3, RPI2)   \--                   \--
  Modified headers    \--       RPI1     \--                   IP6-IP6 (RH3, RPI2)   \--
  Removed headers     \--       \--      \--                   \--                   IP6-IP6 (RH3, RPI2)
  Untouched headers   \--       \--      RPI1                  RPI1                  RPI1 (Ignored)

  : [Table 30](#table-30){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to RAL without Encapsulation to the
  Root](#name-non-sm-summary-of-the-use-of-header-3){.selfRef}
:::
:::

::: {#section-8.3.2 .section}
#### [8.3.2.](#section-8.3.2){.section-number .selfRef} [Non-SM: Example of Flow from RAL to RUL](#name-non-sm-example-of-flow-from-ral-){.section-name .selfRef} {#name-non-sm-example-of-flow-from-ral-}

In this case, the flow comprises:[¶](#section-8.3.2-1){.pilcrow}

RAL \--\> 6LR_ia \--\> root (6LBR) \--\> 6LR_id \--\> RUL (IPv6 dst
node)[¶](#section-8.3.2-2){.pilcrow}

For example, a communication flow could be: Node F (RAL) \--\> Node D
\--\> Node B \--\> Node A (root) \--\> Node B \--\> Node E \--\> Node G
(RUL)[¶](#section-8.3.2-3){.pilcrow}

6LR_ia represents the intermediate routers from the source to the root,
and 1 \<= ia \<= n, where n is the total number of intermediate routers
(6LR).[¶](#section-8.3.2-4){.pilcrow}

6LR_id represents the intermediate routers from the root to the
destination, and 1 \<= id \<= m, where m is the total number of the
intermediate routers (6LRs).[¶](#section-8.3.2-5){.pilcrow}

As in the previous case, the RAL (6LN) may insert an RPI (RPI1) header,
which must be in an IPv6-in-IPv6 header addressed to the root so that
the 6LBR can remove this RPI. The 6LBR will then insert an RH3 inside a
new IPv6-in-IPv6 header addressed to the last 6LR_id (6LR_id = m)
alongside the insertion of RPI2.[¶](#section-8.3.2-6){.pilcrow}

If the originating node does not put the RPI (RPI1) into an IPv6-in-IPv6
header addressed to the root, then the RPI1 is forwarded down from the
root in the inner header to no avail.[¶](#section-8.3.2-7){.pilcrow}

[Table 31](#NonStoring-rpl2notrpl){.xref} summarizes which headers are
needed for this use case when encapsulation to the root takes place.
[Table 32](#NonStoring-rpl2notrplnoIPIP){.xref} summarizes which headers
are needed for this use case when no encapsulation to the root takes
place.[¶](#section-8.3.2-8){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-header-4}

::: {#NonStoring-rpl2notrpl}
  Header              RAL src          6LR_ia   6LBR                  6LR_id                6LR_m                 RUL dst
  ------------------- ---------------- -------- --------------------- --------------------- --------------------- ---------
  Added headers       IP6-IP6 (RPI1)   \--      IP6-IP6 (RH3, RPI2)   \--                   \--                   \--
  Modified headers    \--              RPI1     \--                   IP6-IP6 (RH3, RPI2)   \--                   \--
  Removed headers     \--              \--      IP6-IP6 (RPI1)        \--                   IP6-IP6 (RH3, RPI2)   \--
  Untouched headers   \--              \--      \--                   \--                   \--                   \--

  : [Table 31](#table-31){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to RUL with Encapsulation to the
  Root](#name-non-sm-summary-of-the-use-of-header-4){.selfRef}
:::

[]{#name-non-sm-summary-of-the-use-of-header-5}

::: {#NonStoring-rpl2notrplnoIPIP}
  Header              RAL src   6LR_ia   6LBR                  6LR_id                6LR_n                 RUL dst
  ------------------- --------- -------- --------------------- --------------------- --------------------- ----------------
  Added headers       RPI1      \--      IP6-IP6 (RH3, RPI2)   \--                   \--                   \--
  Modified headers    \--       RPI1     \--                   IP6-IP6 (RH3, RPI2)   \--                   \--
  Removed headers     \--       \--      \--                   \--                   IP6-IP6 (RH3, RPI2)   \--
  Untouched headers   \--       \--      RPI1                  RPI1                  RPI1                  RPI1 (ignored)

  : [Table 32](#table-32){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RAL to RUL without Encapsulation to the
  Root](#name-non-sm-summary-of-the-use-of-header-5){.selfRef}
:::
:::

::: {#section-8.3.3 .section}
#### [8.3.3.](#section-8.3.3){.section-number .selfRef} [Non-SM: Example of Flow from RUL to RAL](#name-non-sm-example-of-flow-from-rul-){.section-name .selfRef} {#name-non-sm-example-of-flow-from-rul-}

In this case, the flow comprises:[¶](#section-8.3.3-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_ia \--\> root (6LBR) \--\>
6LR_id \--\> RAL dst (6LN)[¶](#section-8.3.3-2){.pilcrow}

For example, a communication flow could be: Node G (RUL) \--\> Node E
\--\> Node B \--\> Node A (root) \--\> Node B \--\> Node E \--\> Node H
(RAL)[¶](#section-8.3.3-3){.pilcrow}

6LR_ia represents the intermediate routers from source to the root, and
1 \<= ia \<= n, where n is the total number of intermediate routers
(6LR).[¶](#section-8.3.3-4){.pilcrow}

6LR_id represents the intermediate routers from the root to the
destination, and 1 \<= id \<= m, where m is the total number of the
intermediate routers (6LR).[¶](#section-8.3.3-5){.pilcrow}

In this scenario, the RPI (RPI1) is added by the first 6LR (6LR_1)
inside an IPv6-in-IPv6 header addressed to the root. The 6LBR will
remove this RPI and add its own IPv6-in-IPv6 header containing an RH3
header and an RPI (RPI2).[¶](#section-8.3.3-6){.pilcrow}

[Table 33](#NonStoring-notrpl2rpl){.xref} summarizes which headers are
needed for this use case.[¶](#section-8.3.3-7){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-header-6}

::: {#NonStoring-notrpl2rpl}
  Header              RUL src   6LR_1            6LR_ia   6LBR                  6LR_id                RAL dst
  ------------------- --------- ---------------- -------- --------------------- --------------------- ---------------------
  Added headers       \--       IP6-IP6 (RPI1)   \--      IP6-IP6 (RH3, RPI2)   \--                   \--
  Modified headers    \--       \--              RPI1     \--                   IP6-IP6 (RH3, RPI2)   \--
  Removed headers     \--       \--              \--      IP6-IP6 (RPI1)        \--                   IP6-IP6 (RH3, RPI2)
  Untouched headers   \--       \--              \--      \--                   \--                   \--

  : [Table 33](#table-33){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RUL to
  RAL](#name-non-sm-summary-of-the-use-of-header-6){.selfRef}
:::
:::

::: {#section-8.3.4 .section}
#### [8.3.4.](#section-8.3.4){.section-number .selfRef} [Non-SM: Example of Flow from RUL to RUL](#name-non-sm-example-of-flow-from-rul-t){.section-name .selfRef} {#name-non-sm-example-of-flow-from-rul-t}

In this case, the flow comprises:[¶](#section-8.3.4-1){.pilcrow}

RUL (IPv6 src node) \--\> 6LR_1 \--\> 6LR_ia \--\> root (6LBR) \--\>
6LR_id \--\> RUL (IPv6 dst node)[¶](#section-8.3.4-2){.pilcrow}

For example, a communication flow could be: Node G \--\> Node E \--\>
Node B \--\> Node A (root) \--\> Node C \--\> Node
J[¶](#section-8.3.4-3){.pilcrow}

6LR_ia represents the intermediate routers from the source to the root,
and 1 \<= ia \<= n, where n is the total number of intermediate routers
(6LR).[¶](#section-8.3.4-4){.pilcrow}

6LR_id represents the intermediate routers from the root to the
destination, and 1 \<= id \<= m, where m is the total number of the
intermediate routers (6LR).[¶](#section-8.3.4-5){.pilcrow}

This scenario is the combination of the previous two
cases.[¶](#section-8.3.4-6){.pilcrow}

[Table 34](#NonStoring-notrpl2notrpl){.xref} summarizes which headers
are needed for this use case.[¶](#section-8.3.4-7){.pilcrow}

[]{#name-non-sm-summary-of-the-use-of-header-7}

::: {#NonStoring-notrpl2notrpl}
  Header              RUL src   6LR_1            6LR_ia   6LBR                  6LR_id                6LR_m                 RUL dst
  ------------------- --------- ---------------- -------- --------------------- --------------------- --------------------- ---------
  Added headers       \--       IP6-IP6 (RPI1)   \--      IP6-IP6 (RH3, RPI2)   \--                   \--                   \--
  Modified headers    \--       \--              RPI1     \--                   IP6-IP6 (RH3, RPI2)   \--                   \--
  Removed headers     \--       \--              \--      IP6-IP6 (RPI1)        \--                   IP6-IP6 (RH3, RPI2)   \--
  Untouched headers   \--       \--              \--      \--                   \--                   \--                   \--

  : [Table 34](#table-34){.selfRef}: [Non-SM: Summary of the Use of
  Headers from RUL to
  RUL](#name-non-sm-summary-of-the-use-of-header-7){.selfRef}
:::
:::
:::
:::
:::

::: {#notrplaware}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Operational Considerations of Supporting RULs](#name-operational-considerations-){.section-name .selfRef} {#name-operational-considerations-}

Roughly half of the situations described in this document involve leaf
(\"host\") nodes that do not speak RPL. These nodes fall into two
further categories: ones that drop a packet that have RPI or RH3
headers, and ones that continue to process a packet that has RPI and/or
RH3 headers.[¶](#section-9-1){.pilcrow}

\[[RFC8200](#RFC8200){.xref}\] provides for new rules that suggest that
nodes that have not been configured (explicitly) to examine Hop-by-Hop
Options headers should ignore those headers and continue processing the
packet. Despite this, and despite the switch from 0x63 to 0x23, there
may be nodes that predate RFC 8200 or are simply intolerant. Those nodes
will drop packets that continue to have RPL artifacts in them. In
general, such nodes cannot be easily supported in RPL
LLNs.[¶](#section-9-2){.pilcrow}

There are some specific cases where it is possible to remove the RPL
artifacts prior to forwarding the packet to the leaf host. The critical
thing is that the artifacts have been inserted by the RPL root inside an
IPv6-in-IPv6 header, and that the header has been addressed to the 6LR
immediately prior to the leaf node. In that case, in the process of
removing the IPv6-in-IPv6 header, the artifacts can also be
removed.[¶](#section-9-3){.pilcrow}

The above case occurs whenever traffic originates from the outside the
LLN (the \"Internet\" cases above), and Non-Storing mode is used. In
Non-Storing mode, the RPL root knows the exact topology (as it must
create the RH3 header) and therefore knows which 6LR is prior to the
leaf. For example, in [Figure 3](#fig_CommonTopology){.xref}, Node E is
the 6LR prior to leaf Node G, or Node C is the 6LR prior to leaf Node
J.[¶](#section-9-4){.pilcrow}

Traffic originating from the RPL root (such as when the data collection
system is co-located on the RPL root), does not require an IPv6-in-IPv6
header (in Storing or Non-Storing mode), as the packet is originating at
the root, and the root can insert the RPI and RH3 headers directly into
the packet as it is formed. Such a packet is slightly smaller, but can
only be sent to nodes (whether RPL aware or not) that will tolerate the
RPL artifacts.[¶](#section-9-5){.pilcrow}

An operator that finds itself with a high amount of traffic from the RPL
root to RPL-unaware leaves will have to do IPv6-in-IPv6 encapsulation if
the leaf is not tolerant of the RPL artifacts. Such an operator could
otherwise omit this unnecessary header if it was certain of the
properties of the leaf.[¶](#section-9-6){.pilcrow}

As the Storing mode cannot know the final path of the traffic,
intolerant leaf nodes, which drop packets with RPL artifacts, cannot be
supported.[¶](#section-9-7){.pilcrow}
:::
:::

::: {#sec_op_con_0x23}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Operational Considerations of Introducing 0x23](#name-operational-considerations-o){.section-name .selfRef} {#name-operational-considerations-o}

This section describes the operational considerations of introducing the
new RPI Option Type of 0x23.[¶](#section-10-1){.pilcrow}

During bootstrapping, the node receives the DIO with the information of
RPI Option Type, indicating the new RPI in the DODAG Configuration
option flag. The DODAG root is in charge of configuring the current
network with the new value, through DIO messages, and determining when
all the nodes have been set with the new value. The DODAG should change
to a new DODAG version. In case of rebooting, the node does not remember
the RPI Option Type. Thus, the DIO is sent with a flag indicating the
new RPI Option Type.[¶](#section-10-2){.pilcrow}

The DODAG Configuration option is contained in a RPL DIO message, which
contains a unique Destination Advertisement Trigger Sequence Number
(DTSN) counter. The leaf nodes respond to this message with DAO messages
containing the same DTSN. This is a normal part of RPL routing; the RPL
root therefore knows when the updated DODAG Configuration option has
been seen by all nodes.[¶](#section-10-3){.pilcrow}

Before the migration happens, all the RPL-aware nodes should support
both values. The migration procedure is triggered when the DIO is sent
with the flag indicating the new RPI Option Type. Namely, it remains at
0x63 until it is sure that the network is capable of 0x23, then it
abruptly changes to 0x23. The 0x23 RPI Option allows the sending of
packets to non-RPL nodes. The non-RPL nodes should ignore the option and
continue processing the packets.[¶](#section-10-4){.pilcrow}

As mentioned previously, indicating the new RPI in the DODAG
Configuration option flag is a way to avoid the flag day (abrupt
changeover) in a network using 0x63 as the RPI Option Type value. It is
suggested that RPL implementations accept both 0x63 and 0x23 RPI Option
Type values when processing the header to enable
interoperability.[¶](#section-10-5){.pilcrow}
:::
:::

::: {#iana}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Option Type in RPL Option](#name-option-type-in-rpl-option-2){.section-name .selfRef} {#name-option-type-in-rpl-option-2}

This document updates the registration made in the \"Destination Options
and Hop-by-Hop Options\" subregistry \[[RFC6553](#RFC6553){.xref}\] from
0x63 to 0x23 as shown in [Table
35](#fig_IanaRPIOption){.xref}.[¶](#section-11.1-1){.pilcrow}

[]{#name-option-type-in-rpl-option-3}

::: {#fig_IanaRPIOption}
  Hex Value   Binary Value               Description               Reference
  ----------- -------------- --- ------- ------------------------- -----------------------------------------------
              act                        chg                       rest
  0x23        00             1   00011   RPL Option                This document
  0x63        01             1   00011   RPL Option (DEPRECATED)   \[[RFC6553](#RFC6553){.xref}\], this document

  : [Table 35](#table-35){.selfRef}: [Option Type in RPL
  Option](#name-option-type-in-rpl-option-3){.selfRef}
:::

The \"DODAG Configuration Option Flags for MOP 0..6\" subregistry is
updated as follows ([Table
36](#fig_RPIflagdayConfOption){.xref}):[¶](#section-11.1-3){.pilcrow}

[]{#name-dodag-configuration-option-f}

::: {#fig_RPIflagdayConfOption}
  Bit Number   Capability Description   Reference
  ------------ ------------------------ ---------------
  3            RPI 0x23 enable          This document

  : [Table 36](#table-36){.selfRef}: [DODAG Configuration Option Flag to
  Indicate the RPI Flag
  Day](#name-dodag-configuration-option-f){.selfRef}
:::
:::

::: {#sec_op_flags_reg}
::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Change to the \"DODAG Configuration Option Flags\" Subregistry](#name-change-to-the-dodag-configu){.section-name .selfRef} {#name-change-to-the-dodag-configu}

IANA has changed the name of the \"DODAG Configuration Option Flags\"
subregistry to \"DODAG Configuration Option Flags for MOP
0..6\".[¶](#section-11.2-1){.pilcrow}

The subregistry references this document for this
change.[¶](#section-11.2-2){.pilcrow}
:::
:::

::: {#sec_mop_val_change}
::: {#section-11.3 .section}
### [11.3.](#section-11.3){.section-number .selfRef} [Change MOP Value 7 to Reserved](#name-change-mop-value-7-to-reser){.section-name .selfRef} {#name-change-mop-value-7-to-reser}

IANA has changed the registration status of value 7 in the \"Mode of
Operation\" subregistry from Unassigned to Reserved. This change is in
support of future work.[¶](#section-11.3-1){.pilcrow}

This document is listed as a reference for this entry in the
subregistry.[¶](#section-11.3-2){.pilcrow}
:::
:::
:::
:::

::: {#Security}
::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations covered in \[[RFC6553](#RFC6553){.xref}\]
and \[[RFC6554](#RFC6554){.xref}\] apply when the packets are in the RPL
Domain.[¶](#section-12-1){.pilcrow}

The IPv6-in-IPv6 mechanism described in this document is much more
limited than the general mechanism described in
\[[RFC2473](#RFC2473){.xref}\]. The willingness of each node in the LLN
to decapsulate packets and forward them could be exploited by nodes to
disguise the origin of an attack.[¶](#section-12-2){.pilcrow}

While a typical LLN may be a very poor origin for attack traffic (as the
networks tend to be very slow, and the nodes often have very low duty
cycles), given enough nodes, LLNs could still have a significant impact,
particularly if the attack is targeting another LLN. Additionally, some
uses of RPL involve large-backbone, ISP-scale equipment
\[[ACP](#I-D.ietf-anima-autonomic-control-plane){.xref}\], which may be
equipped with multiple 100 Gb/s interfaces.[¶](#section-12-3){.pilcrow}

Blocking or careful filtering of IPv6-in-IPv6 traffic entering the LLN
as described above will make sure that any attack that is mounted must
originate from compromised nodes within the LLN. The use of network
ingress filtering \[[BCP38](#BCP38){.xref}\] on egress traffic at the
RPL root will alert the operator to the existence of the attack as well
as drop the attack traffic. As the RPL network is typically numbered
from a single prefix, which is itself assigned by RPL, network ingress
filtering \[[BCP38](#BCP38){.xref}\] involves a single prefix comparison
and should be trivial to automatically
configure.[¶](#section-12-4){.pilcrow}

There are some scenarios where IPv6-in-IPv6 traffic should be allowed to
pass through the RPL root, such as the IPv6-in-IPv6 mediated
communications between a new pledge and the Join Registrar/Coordinator
(JRC) when using
\[[BRSKI](#I-D.ietf-anima-bootstrapping-keyinfra){.xref}\] and
\[[ZEROTOUCH-JOIN](#I-D.ietf-6tisch-dtsecurity-zerotouch-join){.xref}\].
This is the case for the RPL root to do careful filtering: it occurs
only when the Join Coordinator is not co-located inside the RPL
root.[¶](#section-12-5){.pilcrow}

With the above precautions, an attack using IPv6-in-IPv6 tunnels can
only be by a node within the LLN on another node within the LLN. Such an
attack could, of course, be done directly. An attack of this kind is
meaningful only if the source addresses are either fake or if the point
is to amplify return traffic. Such an attack could also be done without
the use of IPv6-in-IPv6 headers, by using forged source addresses
instead. If the attack requires bidirectional communication, then
IPv6-in-IPv6 provides no advantages.[¶](#section-12-6){.pilcrow}

Whenever IPv6-in-IPv6 headers are being proposed, there is a concern
about creating security issues. In the Security Considerations section
of \[[RFC2473](#RFC2473){.xref}\] (Section
[9](https://www.rfc-editor.org/rfc/rfc2473#section-9){.relref}), it was
suggested that tunnel entry and exit points can be secured by securing
the IPv6 path between them. This recommendation is not practical for RPL
networks. \[[RFC5406](#RFC5406){.xref}\] provides guidance on what on
what additional details are needed in order to \"Use IPsec\". While the
use of Encapsulating Security Payload (ESP) would prevent source address
forgeries, in order to use it with \[[RFC8138](#RFC8138){.xref}\],
compression would have to occur before encryption, as the
\[[RFC8138](#RFC8138){.xref}\] compression is lossy. Once encrypted,
there would be no further redundancy to compress. These are minor
issues. The major issue is how to establish trust enough such that
Internet Key Exchange Protocol Version 2 (IKEv2) could be used. This
would require a system of certificates to be present in every single
node, including any Internet nodes that might need to communicate with
the LLN. Thus, using IPsec requires a global PKI in the general
case.[¶](#section-12-7){.pilcrow}

More significantly, the use of IPsec tunnels to protect the IPv6-in-IPv6
headers would, in the general case, scale with the square of the number
of nodes. This is a lot of resources for a constrained nodes on a
constrained network. In the end, the IPsec tunnels would be providing
only BCP38-like origin authentication! That is, IPsec provides a
transitive guarantee to the tunnel exit point that the tunnel entry
point did network ingress filtering \[[BCP38](#BCP38){.xref}\] on
traffic going in. Just doing origin filtering per BCP 38 at the entry
and exit of the LLN provides a similar level of security without all the
scaling and trust problems related to IPv6 tunnels as discussed in
\[[RFC2473](#RFC2473){.xref}\]. IPsec is not
recommended.[¶](#section-12-8){.pilcrow}

An LLN with hostile nodes within it would not be protected against
impersonation within the LLN by entry/exit
filtering.[¶](#section-12-9){.pilcrow}

The RH3 header usage described here can be abused in equivalent ways. An
external attacker may form a packet with an RH3 that is not fully
consumed and encapsulate it to hide the RH3 from intermediate nodes and
disguise the origin of traffic. As such, the attacker\'s RH3 header will
not be seen by the network until it reaches the destination, which will
decapsulate it. As indicated in [Section
4.2](https://www.rfc-editor.org/rfc/rfc6554#section-4.2){.relref} of
\[[RFC6554](#RFC6554){.xref}\], RPL routers are responsible for ensuring
that an SRH is only used between RPL routers. As such, if there is an
RH3 that is not fully consumed in the encapsulated packet, the node that
decapsulates it [MUST]{.bcp14} ensure that the outer packet was
originated in the RPL domain and drop the packet
otherwise.[¶](#section-12-10){.pilcrow}

Also, as indicated by [Section
2](https://www.rfc-editor.org/rfc/rfc6554#section-2){.relref} of
\[[RFC6554](#RFC6554){.xref}\], RPL Border Routers \"do not allow
datagrams carrying an SRH header to enter or exit a RPL routing
domain.\" This sentence must be understood as concerning
non-fully-consumed packets. A consumed (inert) RH3 header could be
present in a packet that flows from one LLN, crosses the Internet, and
enters another LLN. Per the discussion in this document, such headers do
not need to be removed. However, there is no case described in this
document where an RH3 is inserted in a Non-Storing network on traffic
that is leaving the LLN, but this document should not preclude such a
future innovation.[¶](#section-12-11){.pilcrow}

In short, a packet that crosses the border of the RPL domain
[MAY]{.bcp14} carry an RH3, and if so, that RH3 [MUST]{.bcp14} be fully
consumed.[¶](#section-12-12){.pilcrow}

The RPI, if permitted to enter the LLN, could be used by an attacker to
change the priority of a packet by selecting a different RPLInstanceID,
perhaps one with a higher energy cost, for instance. It could also be
that not all nodes are reachable in an LLN using the default
RPLInstanceID, but a change of RPLInstanceID would permit an attacker to
bypass such filtering. Like the RH3, an RPI is to be inserted by the RPL
root on traffic entering the LLN by first inserting an IPv6-in-IPv6
header. The attacker\'s RPI therefore will not be seen by the network.
Upon reaching the destination node, the RPI has no further meaning and
is just skipped; the presence of a second RPI will have no meaning to
the end node as the packet has already been identified as being at its
final destination.[¶](#section-12-13){.pilcrow}

For traffic leaving a RUL, if the RUL adds an uninitialized RPI (e.g.,
with a value of zero), then the 6LR as a RPL Border Router
[SHOULD]{.bcp14} rewrite the RPI to indicate the selected Instance and
set the flags. This is done in order to avoid the following scenarios:
1) The leaf is an external router that passes a packet that it did not
generate and that carries an unrelated RPI, and 2) The leaf is an
attacker or presents misconfiguration and tries to inject traffic in a
protected Instance. Also, this applies to the case where the leaf is
aware of the RPL Instance and passes a correct RPI; the 6LR needs a
configuration that allows that leaf to inject in that
instance.[¶](#section-12-14){.pilcrow}

The RH3 and RPIs could be abused by an attacker inside of the network to
route packets in nonobvious ways, perhaps eluding observation. This
usage appears consistent with a normal operation of
\[[RFC6997](#RFC6997){.xref}\] and cannot be restricted at all. This is
a feature, not a bug.[¶](#section-12-15){.pilcrow}

\[[RFC7416](#RFC7416){.xref}\] deals with many other threats to LLNs not
directly related to the use of IPv6-in-IPv6 headers, and this document
does not change that analysis.[¶](#section-12-16){.pilcrow}

Nodes within the LLN can use the IPv6-in-IPv6 mechanism to mount an
attack on another part of the LLN, while disguising the origin of the
attack. The mechanism can even be abused to make it appear that the
attack is coming from outside the LLN, and unless countered, this could
be used to mount a DDOS attack upon nodes elsewhere in the Internet. See
\[[DDOS-KREBS](#DDOS-KREBS){.xref}\] for an example of such attacks
already seen in the real world.[¶](#section-12-17){.pilcrow}

If an attack comes from inside of LLN, it can be alleviated with SAVI
(Source Address Validation Improvement) using
\[[RFC8505](#RFC8505){.xref}\] with \[[RFC8928](#RFC8928){.xref}\]. The
attacker will not be able to source traffic with an address that is not
registered, and the registration process checks for topological
correctness. Notice that there is Layer 2 authentication in most of the
cases. If an attack comes from outside LLN, IPv6-in-IPv6 can be used to
hide inner routing headers, but by construction, the RH3 can typically
only address nodes within the LLN. That is, an RH3 with a CmprI less
than 8 should be considered an attack (see [Section
3](https://www.rfc-editor.org/rfc/rfc6554#section-3){.relref} of
\[[RFC6554](#RFC6554){.xref}\]).[¶](#section-12-18){.pilcrow}

Nodes outside of the LLN will need to pass IPv6-in-IPv6 traffic through
the RPL root to perform this attack. To counter, the RPL root
[SHOULD]{.bcp14} either restrict ingress of IPv6-in-IPv6 packets (the
simpler solution), or it [SHOULD]{.bcp14} walk the IP header extension
chain until it can inspect the upper-layer payload as described in
\[[RFC7045](#RFC7045){.xref}\]. In particular, the RPL root
[SHOULD]{.bcp14} do network ingress filtering \[[BCP38](#BCP38){.xref}\]
on the source addresses of all IP headers that it examines in both
directions.[¶](#section-12-19){.pilcrow}

Note: there are some situations where a prefix will spread across
multiple LLNs via mechanisms such as the one described in
\[[RFC8929](#RFC8929){.xref}\]. In this case, the network ingress
filtering \[[BCP38](#BCP38){.xref}\] needs to take this into account,
either by exchanging detailed routing information on each LLN or by
moving the network ingress filtering \[[BCP38](#BCP38){.xref}\] further
towards the Internet, so that the details of the multiple LLNs do not
matter.[¶](#section-12-20){.pilcrow}
:::
:::

::: {#section-13 .section}
## [13.](#section-13){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-13.1 .section}
### [13.1.](#section-13.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[BCP38\]

:   ::: {#RFC2827 .refInstance}
    [Ferguson, P.]{.refAuthor} and [D. Senie]{.refAuthor}, [\"Network
    Ingress Filtering: Defeating Denial of Service Attacks which employ
    IP Source Address Spoofing\"]{.refTitle}, [BCP 38]{.seriesInfo},
    [RFC 2827]{.seriesInfo}, May 2000.
    :::

    \<<https://rfc-editor.org/info/bcp38>\>

:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC6040\]
:   [Briscoe, B.]{.refAuthor}, [\"Tunnelling of Explicit Congestion
    Notification\"]{.refTitle}, [RFC 6040]{.seriesInfo}, [DOI
    10.17487/RFC6040]{.seriesInfo}, November 2010,
    \<<https://www.rfc-editor.org/info/rfc6040>\>.
:   

\[RFC6282\]
:   [Hui, J., Ed.]{.refAuthor} and [P. Thubert]{.refAuthor},
    [\"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based
    Networks\"]{.refTitle}, [RFC 6282]{.seriesInfo}, [DOI
    10.17487/RFC6282]{.seriesInfo}, September 2011,
    \<<https://www.rfc-editor.org/info/rfc6282>\>.
:   

\[RFC6550\]
:   [Winter, T., Ed.]{.refAuthor}, [Thubert, P., Ed.]{.refAuthor},
    [Brandt, A.]{.refAuthor}, [Hui, J.]{.refAuthor},
    [Kelsey, R.]{.refAuthor}, [Levis, P.]{.refAuthor},
    [Pister, K.]{.refAuthor}, [Struik, R.]{.refAuthor}, [Vasseur,
    JP.]{.refAuthor}, and [R. Alexander]{.refAuthor}, [\"RPL: IPv6
    Routing Protocol for Low-Power and Lossy Networks\"]{.refTitle},
    [RFC 6550]{.seriesInfo}, [DOI 10.17487/RFC6550]{.seriesInfo}, March
    2012, \<<https://www.rfc-editor.org/info/rfc6550>\>.
:   

\[RFC6553\]
:   [Hui, J.]{.refAuthor} and [JP. Vasseur]{.refAuthor}, [\"The Routing
    Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying
    RPL Information in Data-Plane Datagrams\"]{.refTitle}, [RFC
    6553]{.seriesInfo}, [DOI 10.17487/RFC6553]{.seriesInfo}, March 2012,
    \<<https://www.rfc-editor.org/info/rfc6553>\>.
:   

\[RFC6554\]
:   [Hui, J.]{.refAuthor}, [Vasseur, JP.]{.refAuthor},
    [Culler, D.]{.refAuthor}, and [V. Manral]{.refAuthor}, [\"An IPv6
    Routing Header for Source Routes with the Routing Protocol for
    Low-Power and Lossy Networks (RPL)\"]{.refTitle}, [RFC
    6554]{.seriesInfo}, [DOI 10.17487/RFC6554]{.seriesInfo}, March 2012,
    \<<https://www.rfc-editor.org/info/rfc6554>\>.
:   

\[RFC7045\]
:   [Carpenter, B.]{.refAuthor} and [S. Jiang]{.refAuthor},
    [\"Transmission and Processing of IPv6 Extension
    Headers\"]{.refTitle}, [RFC 7045]{.seriesInfo}, [DOI
    10.17487/RFC7045]{.seriesInfo}, December 2013,
    \<<https://www.rfc-editor.org/info/rfc7045>\>.
:   

\[RFC8025\]
:   [Thubert, P., Ed.]{.refAuthor} and [R. Cragie]{.refAuthor}, [\"IPv6
    over Low-Power Wireless Personal Area Network (6LoWPAN) Paging
    Dispatch\"]{.refTitle}, [RFC 8025]{.seriesInfo}, [DOI
    10.17487/RFC8025]{.seriesInfo}, November 2016,
    \<<https://www.rfc-editor.org/info/rfc8025>\>.
:   

\[RFC8138\]
:   [Thubert, P., Ed.]{.refAuthor}, [Bormann, C.]{.refAuthor},
    [Toutain, L.]{.refAuthor}, and [R. Cragie]{.refAuthor}, [\"IPv6 over
    Low-Power Wireless Personal Area Network (6LoWPAN) Routing
    Header\"]{.refTitle}, [RFC 8138]{.seriesInfo}, [DOI
    10.17487/RFC8138]{.seriesInfo}, April 2017,
    \<<https://www.rfc-editor.org/info/rfc8138>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8200\]
:   [Deering, S.]{.refAuthor} and [R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [STD
    86]{.seriesInfo}, [RFC 8200]{.seriesInfo}, [DOI
    10.17487/RFC8200]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8200>\>.
:   
:::

::: {#section-13.2 .section}
### [13.2.](#section-13.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ACP\]
:   [Eckert, T.]{.refAuthor}, [Behringer, M. H.]{.refAuthor}, and [S.
    Bjarnason]{.refAuthor}, [\"An Autonomic Control Plane
    (ACP)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-ietf-anima-autonomic-control-plane-30]{.seriesInfo}, 30
    October 2020,
    \<<https://tools.ietf.org/html/draft-ietf-anima-autonomic-control-plane-30>\>.
:   

\[BRSKI\]
:   [Pritikin, M.]{.refAuthor}, [Richardson, M. C.]{.refAuthor},
    [Eckert, T.]{.refAuthor}, [Behringer, M. H.]{.refAuthor}, and [K.
    Watsen]{.refAuthor}, [\"Bootstrapping Remote Secure Key
    Infrastructures (BRSKI)\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-anima-bootstrapping-keyinfra-45]{.seriesInfo}, 11
    November 2020,
    \<<https://tools.ietf.org/html/draft-ietf-anima-bootstrapping-keyinfra-45>\>.
:   

\[DDOS-KREBS\]
:   [Goodin, D.]{.refAuthor}, [\"Record-breaking DDoS reportedly
    delivered by >145k hacked cameras\"]{.refTitle}, September 2016,
    \<<https://arstechnica.com/information-technology/2016/09/botnet-of-145k-cameras-reportedly-deliver-internets-biggest-ddos-ever/>\>.
:   

\[RFC0801\]
:   [Postel, J.]{.refAuthor}, [\"NCP/TCP transition plan\"]{.refTitle},
    [RFC 801]{.seriesInfo}, [DOI 10.17487/RFC0801]{.seriesInfo},
    November 1981, \<<https://www.rfc-editor.org/info/rfc801>\>.
:   

\[RFC2460\]
:   [Deering, S.]{.refAuthor} and [R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [RFC
    2460]{.seriesInfo}, [DOI 10.17487/RFC2460]{.seriesInfo}, December
    1998, \<<https://www.rfc-editor.org/info/rfc2460>\>.
:   

\[RFC2473\]
:   [Conta, A.]{.refAuthor} and [S. Deering]{.refAuthor}, [\"Generic
    Packet Tunneling in IPv6 Specification\"]{.refTitle}, [RFC
    2473]{.seriesInfo}, [DOI 10.17487/RFC2473]{.seriesInfo}, December
    1998, \<<https://www.rfc-editor.org/info/rfc2473>\>.
:   

\[RFC4443\]
:   [Conta, A.]{.refAuthor}, [Deering, S.]{.refAuthor}, and [M. Gupta,
    Ed.]{.refAuthor}, [\"Internet Control Message Protocol (ICMPv6) for
    the Internet Protocol Version 6 (IPv6) Specification\"]{.refTitle},
    [STD 89]{.seriesInfo}, [RFC 4443]{.seriesInfo}, [DOI
    10.17487/RFC4443]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4443>\>.
:   

\[RFC5406\]
:   [Bellovin, S.]{.refAuthor}, [\"Guidelines for Specifying the Use of
    IPsec Version 2\"]{.refTitle}, [BCP 146]{.seriesInfo}, [RFC
    5406]{.seriesInfo}, [DOI 10.17487/RFC5406]{.seriesInfo}, February
    2009, \<<https://www.rfc-editor.org/info/rfc5406>\>.
:   

\[RFC6437\]
:   [Amante, S.]{.refAuthor}, [Carpenter, B.]{.refAuthor},
    [Jiang, S.]{.refAuthor}, and [J. Rajahalme]{.refAuthor}, [\"IPv6
    Flow Label Specification\"]{.refTitle}, [RFC 6437]{.seriesInfo},
    [DOI 10.17487/RFC6437]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6437>\>.
:   

\[RFC6775\]
:   [Shelby, Z., Ed.]{.refAuthor}, [Chakrabarti, S.]{.refAuthor},
    [Nordmark, E.]{.refAuthor}, and [C. Bormann]{.refAuthor},
    [\"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless
    Personal Area Networks (6LoWPANs)\"]{.refTitle}, [RFC
    6775]{.seriesInfo}, [DOI 10.17487/RFC6775]{.seriesInfo}, November
    2012, \<<https://www.rfc-editor.org/info/rfc6775>\>.
:   

\[RFC6997\]
:   [Goyal, M., Ed.]{.refAuthor}, [Baccelli, E.]{.refAuthor},
    [Philipp, M.]{.refAuthor}, [Brandt, A.]{.refAuthor}, and [J.
    Martocci]{.refAuthor}, [\"Reactive Discovery of Point-to-Point
    Routes in Low-Power and Lossy Networks\"]{.refTitle}, [RFC
    6997]{.seriesInfo}, [DOI 10.17487/RFC6997]{.seriesInfo}, August
    2013, \<<https://www.rfc-editor.org/info/rfc6997>\>.
:   

\[RFC7102\]
:   [Vasseur, JP.]{.refAuthor}, [\"Terms Used in Routing for Low-Power
    and Lossy Networks\"]{.refTitle}, [RFC 7102]{.seriesInfo}, [DOI
    10.17487/RFC7102]{.seriesInfo}, January 2014,
    \<<https://www.rfc-editor.org/info/rfc7102>\>.
:   

\[RFC7416\]
:   [Tsao, T.]{.refAuthor}, [Alexander, R.]{.refAuthor},
    [Dohler, M.]{.refAuthor}, [Daza, V.]{.refAuthor},
    [Lozano, A.]{.refAuthor}, and [M. Richardson, Ed.]{.refAuthor}, [\"A
    Security Threat Analysis for the Routing Protocol for Low-Power and
    Lossy Networks (RPLs)\"]{.refTitle}, [RFC 7416]{.seriesInfo}, [DOI
    10.17487/RFC7416]{.seriesInfo}, January 2015,
    \<<https://www.rfc-editor.org/info/rfc7416>\>.
:   

\[RFC8180\]
:   [Vilajosana, X., Ed.]{.refAuthor}, [Pister, K.]{.refAuthor}, and [T.
    Watteyne]{.refAuthor}, [\"Minimal IPv6 over the TSCH Mode of IEEE
    802.15.4e (6TiSCH) Configuration\"]{.refTitle}, [BCP
    210]{.seriesInfo}, [RFC 8180]{.seriesInfo}, [DOI
    10.17487/RFC8180]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8180>\>.
:   

\[RFC8504\]
:   [Chown, T.]{.refAuthor}, [Loughney, J.]{.refAuthor}, and [T.
    Winters]{.refAuthor}, [\"IPv6 Node Requirements\"]{.refTitle}, [BCP
    220]{.seriesInfo}, [RFC 8504]{.seriesInfo}, [DOI
    10.17487/RFC8504]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8504>\>.
:   

\[RFC8505\]
:   [Thubert, P., Ed.]{.refAuthor}, [Nordmark, E.]{.refAuthor},
    [Chakrabarti, S.]{.refAuthor}, and [C. Perkins]{.refAuthor},
    [\"Registration Extensions for IPv6 over Low-Power Wireless Personal
    Area Network (6LoWPAN) Neighbor Discovery\"]{.refTitle}, [RFC
    8505]{.seriesInfo}, [DOI 10.17487/RFC8505]{.seriesInfo}, November
    2018, \<<https://www.rfc-editor.org/info/rfc8505>\>.
:   

\[RFC8928\]
:   [Thubert, P., Ed.]{.refAuthor}, [Sarikaya, B.]{.refAuthor},
    [Sethi, M.]{.refAuthor}, and [R. Struik]{.refAuthor},
    [\"Address-Protected Neighbor Discovery for Low-Power and Lossy
    Networks\"]{.refTitle}, [RFC 8928]{.seriesInfo}, [DOI
    10.17487/RFC8928]{.seriesInfo}, November 2020,
    \<<https://www.rfc-editor.org/info/rfc8928>\>.
:   

\[RFC8929\]
:   [Thubert, P., Ed.]{.refAuthor}, [Perkins, C.E.]{.refAuthor}, and [E.
    Levy-Abegnoli]{.refAuthor}, [\"IPv6 Backbone Router\"]{.refTitle},
    [RFC 8929]{.seriesInfo}, [DOI 10.17487/RFC8929]{.seriesInfo},
    November 2020, \<<https://www.rfc-editor.org/info/rfc8929>\>.
:   

\[RFC9010\]
:   [Thubert, P., Ed.]{.refAuthor} and [M. Richardson]{.refAuthor},
    [\"Routing for RPL (Routing Protocol for Low-Power and Lossy
    Networks) Leaves\"]{.refTitle}, [RFC 9010]{.seriesInfo}, [DOI
    10.17487/RFC9010]{.seriesInfo}, April 2021,
    \<<https://www.rfc-editor.org/rfc/rfc9010>\>.
:   

\[TUNNELS\]
:   [Touch, J.]{.refAuthor} and [M. Townsley]{.refAuthor}, [\"IP Tunnels
    in the Internet Architecture\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-intarea-tunnels-10]{.seriesInfo}, 12 September 2019,
    \<<https://tools.ietf.org/html/draft-ietf-intarea-tunnels-10>\>.
:   

\[ZEROTOUCH-JOIN\]
:   [Richardson, M.]{.refAuthor}, [\"6tisch Zero-Touch Secure Join
    protocol\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-ietf-6tisch-dtsecurity-zerotouch-join-04]{.seriesInfo}, 8 July
    2019,
    \<<https://tools.ietf.org/html/draft-ietf-6tisch-dtsecurity-zerotouch-join-04>\>.
:   
:::
:::

::: {#Acknowledgments}
::: {#section-appendix.a .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

This work is done thanks to the grant given by the StandICT.eu
project.[¶](#section-appendix.a-1){.pilcrow}

A special BIG thanks to [C. M. Heard]{.contact-name} for the help with
[Section 4](#updateRFCs_section){.xref}. Much of the editing in that
section is based on his comments.[¶](#section-appendix.a-2){.pilcrow}

Additionally, the authors would like to acknowledge the review,
feedback, and comments of the following (in alphabetical order):
[Dominique Barthel]{.contact-name}, [Robert Cragie]{.contact-name},
[Ralph Droms]{.contact-name}, [Simon Duquennoy]{.contact-name}, [Cenk
Guendogan]{.contact-name}, [Rahul Jadhav]{.contact-name}, [Benjamin
Kaduk]{.contact-name}, [Matthias Kovatsch]{.contact-name}, [Gustavo
Mercado]{.contact-name}, [Subramanian Moonesamy]{.contact-name},
[Marcela Orbiscay]{.contact-name}, [Cristian Perez]{.contact-name},
[Charlie Perkins]{.contact-name}, [Alvaro Retana]{.contact-name}, [Peter
van der Stok]{.contact-name}, [Xavier Vilajosana]{.contact-name}, [Éric
Vyncke]{.contact-name}, and [Thomas
Watteyne]{.contact-name}.[¶](#section-appendix.a-3){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Maria Ines Robles]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Universidad Tecno. Nac.(UTN)-FRM, Argentina /Aalto University
Finland]{.org}
:::

::: {.left dir="auto"}
[Coronel Rodríguez 273]{.street-address}
:::

::: {.left dir="auto"}
[M5500]{.postal-code} [Mendoza]{.locality}
:::

::: {.left dir="auto"}
[Provincia de Mendoza]{.region}
:::

::: {.left dir="auto"}
[Argentina]{.country-name}
:::

::: email
Email: <mariainesrobles@gmail.com>
:::

::: {.left dir="auto"}
[Michael C. Richardson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Sandelman Software Works]{.org}
:::

::: {.left dir="auto"}
[470 Dawson Avenue]{.street-address}
:::

::: {.left dir="auto"}
[Ottawa]{.locality} [ON]{.region} [K1Z 5V7]{.postal-code}
:::

::: {.left dir="auto"}
[Canada]{.country-name}
:::

::: email
Email: <mcr+ietf@sandelman.ca>
:::

::: url
URI: <http://www.sandelman.ca/mcr/>
:::

::: {.left dir="auto"}
[Pascal Thubert]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc]{.org}
:::

::: {.left dir="auto"}
[Building D]{.extended-address}
:::

::: {.left dir="auto"}
[45 Allee des Ormes - BP1200]{.street-address}
:::

::: {.left dir="auto"}
[06254]{.postal-code} [MOUGINS - Sophia Antipolis]{.locality}
:::

::: {.left dir="auto"}
[France]{.country-name}
:::

::: tel
Phone: [+33 497 23 26 34](tel:+33%20497%2023%2026%2034){.tel}
:::

::: email
Email: <pthubert@cisco.com>
:::
:::
:::
