  RFC 8689   SMTP Require TLS Option   November 2019
  ---------- ------------------------- ---------------
  Fenton     Standards Track           \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8689](https://www.rfc-editor.org/rfc/rfc8689){.eref}

Category:
:   Standards Track

Published:
:   November 2019

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    J. Fenton
    :::

    ::: org
    Altmode Networks
    :::
    :::
:::

# RFC 8689 {#rfcnum}

# SMTP Require TLS Option {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The SMTP STARTTLS option, used in negotiating transport-level encryption
of SMTP connections, is not as useful from a security standpoint as it
might be because of its opportunistic nature; message delivery is, by
default, prioritized over security. This document describes an SMTP
service extension, REQUIRETLS, and a message header field, TLS-Required.
If the REQUIRETLS option or TLS-Required message header field is used
when sending a message, it asserts a request on the part of the message
sender to override the default negotiation of TLS, either by requiring
that TLS be negotiated when the message is relayed or by requesting that
recipient-side policy mechanisms such as MTA-STS and DNS-Based
Authentication of Named Entities (DANE) be ignored when relaying a
message for which security is
unimportant.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8689>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2019 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [The REQUIRETLS Service
    Extension](#name-the-requiretls-service-exte){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [The TLS-Required Header
    Field](#name-the-tls-required-header-fie){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [REQUIRETLS
    Semantics](#name-requiretls-semantics){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [REQUIRETLS Receipt
        Requirements](#name-requiretls-receipt-requirem){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [REQUIRETLS Sender
        Requirements](#name-requiretls-sender-requireme){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [Sending with TLS
            Required](#name-sending-with-tls-required){.xref}[¶](#section-toc.1-1.4.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [Sending with TLS
            Optional](#name-sending-with-tls-optional){.xref}[¶](#section-toc.1-1.4.2.2.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [REQUIRETLS
        Submission](#name-requiretls-submission){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Delivery of REQUIRETLS
        messages](#name-delivery-of-requiretls-mess){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Non-delivery Message
    Handling](#name-non-delivery-message-handli){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Reorigination
    Considerations](#name-reorigination-consideration){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Passive
        Attacks](#name-passive-attacks){.xref}[¶](#section-toc.1-1.8.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Active
        Attacks](#name-active-attacks){.xref}[¶](#section-toc.1-1.8.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [Bad-Actor
        MTAs](#name-bad-actor-mtas){.xref}[¶](#section-toc.1-1.8.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [8.4](#section-8.4){.xref}.  [Policy
        Conflicts](#name-policy-conflicts){.xref}[¶](#section-toc.1-1.8.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix
    A](#section-appendix.a){.xref}.  [Examples](#name-examples){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [A.1](#section-a.1){.xref}.  [REQUIRETLS SMTP
        Option](#name-requiretls-smtp-option){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [A.2](#section-a.2){.xref}.  [TLS-Required Header
        Field](#name-tls-required-header-field){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [](#section-appendix.b){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.c){.xref}[Author\'s
    Address](#name-authors-address){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The [SMTP](#RFC5321){.xref} \[[RFC5321](#RFC5321){.xref}\] [STARTTLS
service extension](#RFC3207){.xref} \[[RFC3207](#RFC3207){.xref}\]
provides a means by which an SMTP server and client can establish a
Transport Layer Security (TLS) protected session for the transmission of
email messages. By default, TLS is used only upon mutual agreement
(successful negotiation) of STARTTLS between the client and server; if
this is not possible, the message is sent without transport encryption.
Furthermore, it is common practice for the client to negotiate TLS even
if the SMTP server\'s certificate is invalid.[¶](#section-1-1){.pilcrow}

Policy mechanisms such as [DANE](#RFC7672){.xref}
\[[RFC7672](#RFC7672){.xref}\] and [MTA-STS](#RFC8461){.xref}
\[[RFC8461](#RFC8461){.xref}\] may impose requirements for the use of
TLS for email destined for some domains. However, such policies do not
allow the sender to specify which messages are more sensitive and
require transport-level encryption and which ones are less sensitive and
ought to be relayed even if TLS cannot be negotiated
successfully.[¶](#section-1-2){.pilcrow}

The default opportunistic nature of SMTP TLS enables several on-the-wire
attacks on SMTP security between MTAs. These include passive
eavesdropping on connections for which TLS is not used, interference in
the SMTP protocol to prevent TLS from being negotiated (presumably
accompanied by eavesdropping), and insertion of a man-in-the-middle
attacker exploiting the lack of server authentication by the client.
Attacks are described in more detail in the [Security
Considerations](#Security){.xref} section of this
document.[¶](#section-1-3){.pilcrow}

REQUIRETLS consists of two mechanisms: an SMTP service extension and a
message header field. The service extension is used to specify that a
given message sent during a particular session [MUST]{.bcp14} be sent
over a TLS-protected session with specified security characteristics. It
also requires that the SMTP server advertise that it supports
REQUIRETLS, in effect promising that it will honor the requirement to
enforce TLS transmission and REQUIRETLS support for onward transmission
of those messages.[¶](#section-1-4){.pilcrow}

The TLS-Required message header field is used to convey a request to
ignore recipient-side policy mechanisms such as MTA-STS and DANE,
thereby prioritizing delivery over ability to negotiate TLS. Unlike the
service extension, the TLS-Required header field allows the message to
transit through one or more MTAs that do not support
REQUIRETLS.[¶](#section-1-5){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}

The formal syntax uses the Augmented Backus-Naur Form (ABNF)
\[[RFC5234](#RFC5234){.xref}\], including the core rules defined in
Appendix B of that document.[¶](#section-1.1-2){.pilcrow}
:::
:::

::: {#service_extension}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [The REQUIRETLS Service Extension](#name-the-requiretls-service-exte){.section-name .selfRef} {#name-the-requiretls-service-exte}

The REQUIRETLS SMTP service extension has the following
characteristics:[¶](#section-2-1){.pilcrow}

1.  [The textual name of the extension is \"Require
    TLS\".[¶](#section-2-2.1){.pilcrow}]{#section-2-2.1}

2.  [The EHLO keyword value associated with this extension is
    \"REQUIRETLS\".[¶](#section-2-2.2){.pilcrow}]{#section-2-2.2}

3.  [No additional SMTP verbs are defined by this
    extension.[¶](#section-2-2.3){.pilcrow}]{#section-2-2.3}

4.  [One optional parameter (\"REQUIRETLS\") is added to the MAIL FROM
    command by this extension. No value is associated with this
    parameter.[¶](#section-2-2.4){.pilcrow}]{#section-2-2.4}

5.  [The maximum length of a MAIL FROM command line is increased by 11
    octets by the possible addition of a space and the REQUIRETLS
    keyword.[¶](#section-2-2.5){.pilcrow}]{#section-2-2.5}

6.  [One new SMTP status code is defined by this extension to convey an
    error condition resulting from failure of the client to send data to
    a server that does not also support the REQUIRETLS
    extension.[¶](#section-2-2.6){.pilcrow}]{#section-2-2.6}

7.  [The REQUIRETLS extension is valid for message relay
    \[[RFC5321](#RFC5321){.xref}\], submission
    \[[RFC6409](#RFC6409){.xref}\], and the Local Mail Transfer Protocol
    (LMTP)
    \[[RFC2033](#RFC2033){.xref}\].[¶](#section-2-2.7){.pilcrow}]{#section-2-2.7}

8.  ::: {#section-2-2.8}
    The ABNF syntax for the MAIL FROM parameter is as
    follows:[¶](#section-2-2.8.1){.pilcrow}

    ::: {#section-2-2.8.2}
    ``` {.sourcecode .lang-abnf}
    requiretls-param  = "REQUIRETLS"
                    ; where requiretls-param is an instance of an
                    ; esmtp-param used in Mail-parameters in
                    ; RFC 5321, Section 4.1.2. There is no esmtp-value
                    ; associated with requiretls-param. 
    ```

    [¶](#section-2-2.8.2){.pilcrow}
    :::
    :::

In order to specify REQUIRETLS treatment for a given message, the
REQUIRETLS option is specified in the MAIL FROM command when that
message is transmitted. This option [MUST]{.bcp14} only be specified in
the context of an SMTP session meeting the security requirements of
REQUIRETLS:[¶](#section-2-3){.pilcrow}

-   [The session itself [MUST]{.bcp14} employ TLS
    transmission.[¶](#section-2-4.1){.pilcrow}]{#section-2-4.1}
-   [If the SMTP server to which the message is being transmitted is
    identified through an MX record lookup, its name [MUST]{.bcp14} be
    validated via a DNSSEC signature on the recipient domain\'s MX
    record, or the MX hostname [MUST]{.bcp14} be validated by an MTA-STS
    policy as described in [Section
    4.1](https://www.rfc-editor.org/rfc/rfc8461#section-4.1){.relref} of
    \[[RFC8461](#RFC8461){.xref}\]. DNSSEC is defined in
    \[[RFC4033](#RFC4033){.xref}\], \[[RFC4034](#RFC4034){.xref}\], and
    \[[RFC4035](#RFC4035){.xref}\].[¶](#section-2-4.2){.pilcrow}]{#section-2-4.2}
-   [The certificate presented by the SMTP server either [MUST]{.bcp14}
    be verified successfully by a trust chain leading to a certificate
    trusted by the SMTP client, or it [MUST]{.bcp14} be verified
    successfully using DANE, as specified in
    \[[RFC7672](#RFC7672){.xref}\]. For trust chains, the choice of
    trusted (root) certificates is at the discretion of the SMTP
    client.[¶](#section-2-4.3){.pilcrow}]{#section-2-4.3}
-   [Following the negotiation of STARTTLS, the SMTP server
    [MUST]{.bcp14} advertise in the subsequent EHLO response that it
    supports REQUIRETLS.[¶](#section-2-4.4){.pilcrow}]{#section-2-4.4}
:::
:::

::: {#header_field}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [The TLS-Required Header Field](#name-the-tls-required-header-fie){.section-name .selfRef} {#name-the-tls-required-header-fie}

One new message header field \[[RFC5322](#RFC5322){.xref}\],
TLS-Required, is defined by this specification. It is used for messages
for which the originator requests that the recipient TLS policy
(including [MTA-STS](#RFC8461){.xref} \[[RFC8461](#RFC8461){.xref}\] and
[DANE](#RFC7672){.xref} \[[RFC7672](#RFC7672){.xref}\]) be ignored. This
might be done, for example, to report a misconfigured mail server, such
as an expired TLS certificate.[¶](#section-3-1){.pilcrow}

The TLS-Required header field has a single [REQUIRED]{.bcp14}
parameter:[¶](#section-3-2){.pilcrow}

-   [No - The SMTP client [SHOULD]{.bcp14} attempt to send the message
    regardless of its ability to negotiate STARTTLS with the SMTP
    server, ignoring policy-based mechanisms (including MTA-STS and
    DANE), if any, asserted by the recipient domain. Nevertheless, the
    client [SHOULD]{.bcp14} negotiate STARTTLS with the server if
    available.[¶](#section-3-3.1){.pilcrow}]{#section-3-3.1}

More than one instance of the TLS-Required header field [MUST
NOT]{.bcp14} appear in a given message.[¶](#section-3-4){.pilcrow}

The ABNF syntax for the TLS-Required header field is as
follows:[¶](#section-3-5){.pilcrow}

::: {#section-3-6}
``` {.sourcecode .lang-abnf}
requiretls-field = "TLS-Required:" [FWS] "No" CRLF
        ; where requiretls-field in an instance of an
        ; optional-field defined in RFC 5322, Section 3.6.8.
FWS = <as defined in RFC 5322>
CRLF = <as defined in RFC 5234> 
```

[¶](#section-3-6){.pilcrow}
:::
:::
:::

::: {#semantics}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [REQUIRETLS Semantics](#name-requiretls-semantics){.section-name .selfRef} {#name-requiretls-semantics}

::: {#receipt}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [REQUIRETLS Receipt Requirements](#name-requiretls-receipt-requirem){.section-name .selfRef} {#name-requiretls-receipt-requirem}

Upon receipt of the REQUIRETLS option on a MAIL FROM command during the
receipt of a message, an SMTP server [MUST]{.bcp14} tag that message as
needing REQUIRETLS handling.[¶](#section-4.1-1){.pilcrow}

Upon receipt of a message not specifying the REQUIRETLS option on its
MAIL FROM command but containing the TLS-Required header field in its
message header, an SMTP server implementing this specification
[MUST]{.bcp14} tag that message with the option specified in the
TLS-Required header field. If the REQUIRETLS MAIL FROM parameter is
specified, the TLS-Required header field [MUST]{.bcp14} be ignored but
[MAY]{.bcp14} be included in the onward relay of the
message.[¶](#section-4.1-2){.pilcrow}

The manner in which the above tagging takes place is implementation
dependent. If the message is being locally aliased and redistributed to
multiple addresses, all instances of the message [MUST]{.bcp14} be
tagged in the same manner.[¶](#section-4.1-3){.pilcrow}
:::
:::

::: {#sender}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [REQUIRETLS Sender Requirements](#name-requiretls-sender-requireme){.section-name .selfRef} {#name-requiretls-sender-requireme}

::: {#yestls}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [Sending with TLS Required](#name-sending-with-tls-required){.section-name .selfRef} {#name-sending-with-tls-required}

When sending a message tagged as requiring TLS for which the MAIL FROM
return-path is not empty (an empty MAIL FROM return-path indicating a
bounce message), the sending (client) MTA
[MUST]{.bcp14}:[¶](#section-4.2.1-1){.pilcrow}

1.  [Look up the SMTP server to which the message is to be sent, as
    described in \[[RFC5321](#RFC5321){.xref}\], [Section
    5.1](https://www.rfc-editor.org/rfc/rfc5321#section-5.1){.relref}.[¶](#section-4.2.1-2.1){.pilcrow}]{#section-4.2.1-2.1}
2.  [If the server lookup is accomplished via the recipient domain\'s MX
    record (the usual case) and is not accompanied by a valid DNSSEC
    signature, the client [MUST]{.bcp14} also validate the SMTP server
    name using MTA-STS, as described in \[[RFC8461](#RFC8461){.xref}\],
    [Section
    4.1](https://www.rfc-editor.org/rfc/rfc8461#section-4.1){.relref}.[¶](#section-4.2.1-2.2){.pilcrow}]{#section-4.2.1-2.2}
3.  [Open an SMTP session with the peer SMTP server using the EHLO
    verb.[¶](#section-4.2.1-2.3){.pilcrow}]{#section-4.2.1-2.3}
4.  [Establish a TLS-protected SMTP session with its peer SMTP server
    and authenticate the server\'s certificate as specified in
    \[[RFC6125](#RFC6125){.xref}\] or \[[RFC7672](#RFC7672){.xref}\], as
    applicable. The hostname from the MX record lookup (or the domain
    name in the absence of an MX record where an A record is used
    directly) [MUST]{.bcp14} match the DNS-ID or CN-ID of the
    certificate presented by the
    server.[¶](#section-4.2.1-2.4){.pilcrow}]{#section-4.2.1-2.4}
5.  [Ensure that the response to the subsequent EHLO following
    establishment of the TLS protection advertises the REQUIRETLS
    capability.[¶](#section-4.2.1-2.5){.pilcrow}]{#section-4.2.1-2.5}

The SMTP client [SHOULD]{.bcp14} follow the recommendations in
\[[RFC7525](#RFC7525){.xref}\] or its successor with respect to
negotiation of the TLS session.[¶](#section-4.2.1-3){.pilcrow}

If any of the above steps fail, the client [MUST]{.bcp14} issue a QUIT
to the server and repeat steps 2-5 with each host on the recipient
domain\'s list of MX hosts in an attempt to find a mail path that meets
the sender\'s requirements. The client [MAY]{.bcp14} send other,
unprotected messages to that server if it has any such messages prior to
issuing the QUIT. If there are no more MX hosts, the client [MUST
NOT]{.bcp14} transmit the message to the
domain.[¶](#section-4.2.1-4){.pilcrow}

Following such a failure, the SMTP client [MUST]{.bcp14} send a
non-delivery notification to the reverse-path of the failed message, as
described in [Section
3.6](https://www.rfc-editor.org/rfc/rfc5321#section-3.6){.relref} of
\[[RFC5321](#RFC5321){.xref}\]. The following [status
codes](#RFC5248){.xref} \[[RFC5248](#RFC5248){.xref}\] [SHOULD]{.bcp14}
be used:[¶](#section-4.2.1-5){.pilcrow}

-   [REQUIRETLS not supported by server: 5.7.30 REQUIRETLS support
    required[¶](#section-4.2.1-6.1){.pilcrow}]{#section-4.2.1-6.1}
-   [Unable to establish TLS-protected SMTP session: 5.7.10 Encryption
    needed[¶](#section-4.2.1-6.2){.pilcrow}]{#section-4.2.1-6.2}

Refer to [Section 5](#errors){.xref} for further requirements regarding
non-delivery messages.[¶](#section-4.2.1-7){.pilcrow}

If all REQUIRETLS requirements have been met, transmit the message,
issuing the REQUIRETLS option on the MAIL FROM command with the required
option(s), if any.[¶](#section-4.2.1-8){.pilcrow}
:::
:::

::: {#maytls}
::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [Sending with TLS Optional](#name-sending-with-tls-optional){.section-name .selfRef} {#name-sending-with-tls-optional}

Messages tagged \"TLS-Required: No\" are handled as follows. When
sending such a message, the sending (client) MTA
[MUST]{.bcp14}:[¶](#section-4.2.2-1){.pilcrow}

-   [Look up the SMTP server to which the message is to be sent, as
    described in \[[RFC5321](#RFC5321){.xref}\], [Section
    5.1](https://www.rfc-editor.org/rfc/rfc5321#section-5.1){.relref}.[¶](#section-4.2.2-2.1){.pilcrow}]{#section-4.2.2-2.1}
-   [Open an SMTP session with the peer SMTP server using the EHLO verb.
    Attempt to negotiate STARTTLS if possible, and follow any policy
    published by the recipient domain, but do not fail if this is
    unsuccessful.[¶](#section-4.2.2-2.2){.pilcrow}]{#section-4.2.2-2.2}

Some SMTP servers may be configured to require STARTTLS connections as a
matter of policy and not accept messages in the absence of STARTTLS. A
non-delivery notification [MUST]{.bcp14} be returned to the sender if
message relay fails due to an inability to negotiate STARTTLS when
required by the server.[¶](#section-4.2.2-3){.pilcrow}

Since messages tagged with \"TLS-Required: No\" will sometimes be sent
to SMTP servers not supporting REQUIRETLS, that option will not be
uniformly observed by all SMTP relay
hops.[¶](#section-4.2.2-4){.pilcrow}
:::
:::
:::
:::

::: {#submission}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [REQUIRETLS Submission](#name-requiretls-submission){.section-name .selfRef} {#name-requiretls-submission}

A Mail User Agent (MUA) or other agent making the initial introduction
of a message has the option to decide whether to require TLS. If TLS is
to be required, it [MUST]{.bcp14} do so by negotiating STARTTLS and
REQUIRETLS and including the REQUIRETLS option on the MAIL FROM command,
as is done for message relay.[¶](#section-4.3-1){.pilcrow}

When TLS is not to be required, the sender [MUST]{.bcp14} include the
TLS-Required header field in the message. SMTP servers implementing this
specification [MUST]{.bcp14} interpret this header field as described in
[Section 4.1](#receipt){.xref}.[¶](#section-4.3-2){.pilcrow}

In either case, the decision whether to specify REQUIRETLS [MAY]{.bcp14}
be done based on a user interface selection or based on a ruleset or
other policy. The manner in which the decision to require TLS is made is
implementation dependent and is beyond the scope of this
specification.[¶](#section-4.3-3){.pilcrow}
:::
:::

::: {#delivery}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Delivery of REQUIRETLS messages](#name-delivery-of-requiretls-mess){.section-name .selfRef} {#name-delivery-of-requiretls-mess}

Messages are usually retrieved by end users using protocols other than
SMTP such as [IMAP](#RFC3501){.xref} \[[RFC3501](#RFC3501){.xref}\],
[POP](#RFC1939){.xref} \[[RFC1939](#RFC1939){.xref}\], or Web mail
systems. Mail delivery agents supporting the REQUIRETLS SMTP option
[SHOULD]{.bcp14} observe the guidelines in
\[[RFC8314](#RFC8314){.xref}\].[¶](#section-4.4-1){.pilcrow}
:::
:::
:::
:::

::: {#errors}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Non-delivery Message Handling](#name-non-delivery-message-handli){.section-name .selfRef} {#name-non-delivery-message-handli}

Non-delivery (\"bounce\") messages usually contain important metadata
about the message to which they refer, including the original message
header. They therefore [MUST]{.bcp14} be protected in the same manner as
the original message. All non-delivery messages resulting from messages
with the REQUIRETLS SMTP option, whether resulting from a REQUIRETLS
error or some other issue, [MUST]{.bcp14} also specify the REQUIRETLS
SMTP option unless redacted as described
below.[¶](#section-5-1){.pilcrow}

The path from the origination of an error bounce message back to the
MAIL FROM address may not share the same REQUIRETLS support as the
forward path. Therefore, users requiring TLS are advised to make sure
that they are capable of receiving mail using REQUIRETLS as well.
Otherwise, such non-delivery messages will be
lost.[¶](#section-5-2){.pilcrow}

If a REQUIRETLS message is bounced, the server [MUST]{.bcp14} behave as
if RET=HDRS was present, as described in \[[RFC3461](#RFC3461){.xref}\].
If both RET=FULL and REQUIRETLS are present, the RET=FULL [MUST]{.bcp14}
be disregarded. The SMTP client for a REQUIRETLS bounce message uses an
empty MAIL FROM return-path, as required by
\[[RFC5321](#RFC5321){.xref}\]. When the MAIL FROM return-path is empty,
the REQUIRETLS parameter [SHOULD NOT]{.bcp14} cause a bounce message to
be discarded even if the next-hop relay does not advertise
REQUIRETLS.[¶](#section-5-3){.pilcrow}

Senders of messages requiring TLS are advised to consider the
possibility that bounce messages will be lost as a result of REQUIRETLS
return path failure and that some information could be leaked if a
bounce message is not able to be transmitted with
REQUIRETLS.[¶](#section-5-4){.pilcrow}
:::
:::

::: {#reorigination}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Reorigination Considerations](#name-reorigination-consideration){.section-name .selfRef} {#name-reorigination-consideration}

In a number of situations, a [mediator](#RFC5598){.xref}
\[[RFC5598](#RFC5598){.xref}\] originates a new message as a result of
an incoming message. These situations include but are not limited to
mailing lists (including administrative traffic such as message approval
requests), [Sieve](#RFC5228){.xref} \[[RFC5228](#RFC5228){.xref}\],
\"vacation\" responders, and other filters to which incoming messages
may be piped. These newly originated messages may essentially be copies
of the incoming message, such as with a forwarding service or a mailing
list expander. In other cases, such as with a vacation message or a
delivery notification, they will be different but might contain parts of
the original message or other information for which the original message
sender wants to influence the requirement to use TLS
transmission.[¶](#section-6-1){.pilcrow}

Mediators that reoriginate messages should apply REQUIRETLS requirements
in incoming messages (both requiring TLS transmission and requesting
that TLS not be required) to the reoriginated messages to the extent
feasible. A limitation to this might be that for a message requiring
TLS, redistribution to multiple addresses while retaining the TLS
requirement could result in the message not being delivered to some of
the intended recipients.[¶](#section-6-2){.pilcrow}

User-side mediators (such as use of Sieve rules on a user agent)
typically do not have access to the SMTP details and therefore may not
be aware of the REQUIRETLS requirement on a delivered message.
Recipients that expect sensitive traffic should avoid the use of
user-side mediators. Alternatively, if operationally feasible (such as
when forwarding to a specific, known address), they should apply
REQUIRETLS to all reoriginated messages that do not contain the
\"TLS-Required: No\" header field.[¶](#section-6-3){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

Per this document, IANA has added the following keyword to the \"SMTP
Service Extensions\" subregistry of the [\"Mail Parameters\"
registry](#MailParams){.xref}
\[[MailParams](#MailParams){.xref}\]:[¶](#section-7-1){.pilcrow}

-   ::: {#section-7-2.1}

    EHLO Keyword:
    :   REQUIRETLS[¶](#section-7-2.1.1.2){.pilcrow}

    Description:
    :   Require TLS[¶](#section-7-2.1.1.4){.pilcrow}

    Syntax and parameters:
    :   (no parameters)[¶](#section-7-2.1.1.6){.pilcrow}

    Additional SMTP verbs:
    :   none[¶](#section-7-2.1.1.8){.pilcrow}

    MAIL and RCPT parameters:
    :   REQUIRETLS parameter on MAIL[¶](#section-7-2.1.1.10){.pilcrow}

    Behavior:
    :   Use of the REQUIRETLS parameter on the MAIL verb causes that
        message to require the use of TLS and tagging with REQUIRETLS
        for all onward relay.[¶](#section-7-2.1.1.12){.pilcrow}

    Command length increment:
    :   11 characters[¶](#section-7-2.1.1.14){.pilcrow}
    :::

Per this document, IANA has added an entry to the \"Enumerated Status
Codes\" subregistry of the [\"Simple Mail Transfer Protocol (SMTP)
Enhanced Status Codes Registry\"](#SMTPStatusCodes){.xref}
\[[SMTPStatusCodes](#SMTPStatusCodes){.xref}\]:[¶](#section-7-3){.pilcrow}

-   ::: {#section-7-4.1}

    Code:
    :   X.7.30[¶](#section-7-4.1.1.2){.pilcrow}

    Sample Text:
    :   REQUIRETLS support required[¶](#section-7-4.1.1.4){.pilcrow}

    Associated basic status code:
    :   550[¶](#section-7-4.1.1.6){.pilcrow}

    Description:
    :   This indicates that the message was not able to be forwarded
        because it was received with a REQUIRETLS requirement and none
        of the SMTP servers to which the message should be forwarded
        provide this support.[¶](#section-7-4.1.1.8){.pilcrow}

    Reference:
    :   RFC 8689[¶](#section-7-4.1.1.10){.pilcrow}

    Submitter:
    :   J. Fenton[¶](#section-7-4.1.1.12){.pilcrow}

    Change Controller:
    :   IESG[¶](#section-7-4.1.1.14){.pilcrow}
    :::

Per this document, IANA has added an entry to the \"Permanent Message
Header Field Names\" subregistry of the [\"Message Headers\"
registry](#MessageHeaders){.xref}
\[[MessageHeaders](#MessageHeaders){.xref}\] as
follows:[¶](#section-7-5){.pilcrow}

-   ::: {#section-7-6.1}

    Header field name:
    :   TLS-Required[¶](#section-7-6.1.1.2){.pilcrow}

    Applicable protocol:
    :   mail[¶](#section-7-6.1.1.4){.pilcrow}

    Status:
    :   standard[¶](#section-7-6.1.1.6){.pilcrow}

    Author/change controller:
    :   IETF[¶](#section-7-6.1.1.8){.pilcrow}

    Specification document:
    :   RFC 8689[¶](#section-7-6.1.1.10){.pilcrow}
    :::
:::
:::

::: {#Security}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The purpose of REQUIRETLS is to give the originator of a message control
over the security of email they send, either by conveying an expectation
that it will be transmitted in an encrypted form over the wire or
explicitly indicating that transport encryption is not required if it
cannot be successfully negotiated.[¶](#section-8-1){.pilcrow}

The following considerations apply to the REQUIRETLS service extension
but not the TLS-Required header field, since messages specifying the
header field are less concerned with transport
security.[¶](#section-8-2){.pilcrow}

::: {#Passive}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Passive Attacks](#name-passive-attacks){.section-name .selfRef} {#name-passive-attacks}

REQUIRETLS is generally effective against passive attackers who are
merely trying to eavesdrop on an SMTP exchange between an SMTP client
and server. This assumes, of course, the cryptographic integrity of the
TLS connection being used.[¶](#section-8.1-1){.pilcrow}
:::
:::

::: {#Active}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Active Attacks](#name-active-attacks){.section-name .selfRef} {#name-active-attacks}

Active attacks against TLS-encrypted SMTP connections can take many
forms. One such attack is to interfere in the negotiation by changing
the STARTTLS command to something illegal such as XXXXXXXX. This causes
TLS negotiation to fail and messages to be sent in the clear, where they
can be intercepted. REQUIRETLS detects the failure of STARTTLS and
declines to send the message rather than send it
insecurely.[¶](#section-8.2-1){.pilcrow}

A second form of attack is a man-in-the-middle attack where the attacker
terminates the TLS connection rather than the intended SMTP server. This
is possible when, as is commonly the case, the SMTP client either does
not verify the server\'s certificate or establishes the connection even
when the verification fails. REQUIRETLS requires successful certificate
validation before sending the message.[¶](#section-8.2-2){.pilcrow}

Another active attack involves the spoofing of DNS MX records of the
recipient domain. An attacker with this capability could potentially
cause the message to be redirected to a mail server under the
attacker\'s own control, which would presumably have a valid
certificate. REQUIRETLS requires that the recipient domain\'s MX record
lookup be validated either using DNSSEC or via a published MTA-STS
policy that specifies the acceptable SMTP server hostname(s) for the
recipient domain.[¶](#section-8.2-3){.pilcrow}
:::
:::

::: {#badactor}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [Bad-Actor MTAs](#name-bad-actor-mtas){.section-name .selfRef} {#name-bad-actor-mtas}

A bad-actor MTA along the message transmission path could misrepresent
its support of REQUIRETLS and/or actively strip REQUIRETLS tags from
messages it handles. However, since intermediate MTAs are already
trusted with the cleartext of messages they handle, and are not part of
the threat model for transport-layer security, they are also not part of
the threat model for REQUIRETLS.[¶](#section-8.3-1){.pilcrow}

It should be reemphasized that since SMTP TLS is a transport-layer
security protocol, messages sent using REQUIRETLS are not encrypted
end-to-end and are visible to MTAs that are part of the message delivery
path. Messages containing sensitive information that MTAs should not
have access to [MUST]{.bcp14} be sent using end-to-end content
encryption such as [OpenPGP](#RFC4880){.xref}
\[[RFC4880](#RFC4880){.xref}\] or [S/MIME](#RFC8551){.xref}
\[[RFC8551](#RFC8551){.xref}\].[¶](#section-8.3-2){.pilcrow}
:::
:::

::: {#conflicts}
::: {#section-8.4 .section}
### [8.4.](#section-8.4){.section-number .selfRef} [Policy Conflicts](#name-policy-conflicts){.section-name .selfRef} {#name-policy-conflicts}

In some cases, the use of the TLS-Required header field may conflict
with a recipient domain policy expressed through the
[DANE](#RFC7672){.xref} \[[RFC7672](#RFC7672){.xref}\] or
[MTA-STS](#RFC8461){.xref} \[[RFC8461](#RFC8461){.xref}\] protocols.
Although these protocols encourage the use of TLS transport by
advertising the availability of TLS, the use of the \"TLS-Required: No\"
header field represents an explicit decision on the part of the sender
not to require the use of TLS, such as to overcome a configuration
error. The recipient domain has the ultimate ability to require TLS by
not accepting messages when STARTTLS has not been negotiated; otherwise,
\"TLS-Required: No\" is effectively directing the client MTA to behave
as if it does not support DANE or MTA-STS.[¶](#section-8.4-1){.pilcrow}
:::
:::
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[MailParams\]
:   [IANA]{.refAuthor}, [\"Mail Parameters\"]{.refTitle},
    \<[http://www.iana.org/assignments/mail-parameters](https://www.iana.org/assignments/mail-parameters)\>.

\[MessageHeaders\]
:   [IANA]{.refAuthor}, [\"Permanent Message Header Field
    Names\"]{.refTitle},
    \<<https://www.iana.org/assignments/message-headers>\>.

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.

\[RFC3207\]
:   [Hoffman, P.]{.refAuthor}, [\"SMTP Service Extension for Secure SMTP
    over Transport Layer Security\"]{.refTitle}, [RFC
    3207]{.seriesInfo}, [DOI 10.17487/RFC3207]{.seriesInfo}, February
    2002, \<<https://www.rfc-editor.org/info/rfc3207>\>.

\[RFC3461\]
:   [Moore, K.]{.refAuthor}, [\"Simple Mail Transfer Protocol (SMTP)
    Service Extension for Delivery Status Notifications
    (DSNs)\"]{.refTitle}, [RFC 3461]{.seriesInfo}, [DOI
    10.17487/RFC3461]{.seriesInfo}, January 2003,
    \<<https://www.rfc-editor.org/info/rfc3461>\>.

\[RFC4033\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"DNS Security Introduction and
    Requirements\"]{.refTitle}, [RFC 4033]{.seriesInfo}, [DOI
    10.17487/RFC4033]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4033>\>.

\[RFC4034\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Resource Records for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4034]{.seriesInfo}, [DOI
    10.17487/RFC4034]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4034>\>.

\[RFC4035\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Protocol Modifications for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4035]{.seriesInfo}, [DOI
    10.17487/RFC4035]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4035>\>.

\[RFC5234\]
:   [Crocker, D., Ed.]{.refAuthor}[ and P. Overell]{.refAuthor},
    [\"Augmented BNF for Syntax Specifications: ABNF\"]{.refTitle}, [STD
    68]{.seriesInfo}, [RFC 5234]{.seriesInfo}, [DOI
    10.17487/RFC5234]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5234>\>.

\[RFC5248\]
:   [Hansen, T.]{.refAuthor}[ and J. Klensin]{.refAuthor}, [\"A Registry
    for SMTP Enhanced Mail System Status Codes\"]{.refTitle}, [BCP
    138]{.seriesInfo}, [RFC 5248]{.seriesInfo}, [DOI
    10.17487/RFC5248]{.seriesInfo}, June 2008,
    \<<https://www.rfc-editor.org/info/rfc5248>\>.

\[RFC5321\]
:   [Klensin, J.]{.refAuthor}, [\"Simple Mail Transfer
    Protocol\"]{.refTitle}, [RFC 5321]{.seriesInfo}, [DOI
    10.17487/RFC5321]{.seriesInfo}, October 2008,
    \<<https://www.rfc-editor.org/info/rfc5321>\>.

\[RFC5322\]
:   [Resnick, P., Ed.]{.refAuthor}, [\"Internet Message
    Format\"]{.refTitle}, [RFC 5322]{.seriesInfo}, [DOI
    10.17487/RFC5322]{.seriesInfo}, October 2008,
    \<<https://www.rfc-editor.org/info/rfc5322>\>.

\[RFC6125\]
:   [Saint-Andre, P.]{.refAuthor}[ and J. Hodges]{.refAuthor},
    [\"Representation and Verification of Domain-Based Application
    Service Identity within Internet Public Key Infrastructure Using
    X.509 (PKIX) Certificates in the Context of Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 6125]{.seriesInfo}, [DOI
    10.17487/RFC6125]{.seriesInfo}, March 2011,
    \<<https://www.rfc-editor.org/info/rfc6125>\>.

\[RFC7525\]
:   [Sheffer, Y.]{.refAuthor}[, Holz, R.]{.refAuthor}[, and P.
    Saint-Andre]{.refAuthor}, [\"Recommendations for Secure Use of
    Transport Layer Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [BCP 195]{.seriesInfo}, [RFC
    7525]{.seriesInfo}, [DOI 10.17487/RFC7525]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7525>\>.

\[RFC7672\]
:   [Dukhovni, V.]{.refAuthor}[ and W. Hardaker]{.refAuthor}, [\"SMTP
    Security via Opportunistic DNS-Based Authentication of Named
    Entities (DANE) Transport Layer Security (TLS)\"]{.refTitle}, [RFC
    7672]{.seriesInfo}, [DOI 10.17487/RFC7672]{.seriesInfo}, October
    2015, \<<https://www.rfc-editor.org/info/rfc7672>\>.

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.

\[RFC8314\]
:   [Moore, K.]{.refAuthor}[ and C. Newman]{.refAuthor}, [\"Cleartext
    Considered Obsolete: Use of Transport Layer Security (TLS) for Email
    Submission and Access\"]{.refTitle}, [RFC 8314]{.seriesInfo}, [DOI
    10.17487/RFC8314]{.seriesInfo}, January 2018,
    \<<https://www.rfc-editor.org/info/rfc8314>\>.

\[RFC8461\]
:   [Margolis, D.]{.refAuthor}[, Risher, M.]{.refAuthor}[,
    Ramakrishnan, B.]{.refAuthor}[, Brotman, A.]{.refAuthor}[, and J.
    Jones]{.refAuthor}, [\"SMTP MTA Strict Transport Security
    (MTA-STS)\"]{.refTitle}, [RFC 8461]{.seriesInfo}, [DOI
    10.17487/RFC8461]{.seriesInfo}, September 2018,
    \<<https://www.rfc-editor.org/info/rfc8461>\>.

\[SMTPStatusCodes\]
:   [IANA]{.refAuthor}, [\"Simple Mail Transfer Protocol (SMTP) Enhanced
    Status Codes Registry\"]{.refTitle},
    \<<https://www.iana.org/assignments/smtp-enhanced-status-codes>\>.
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC1939\]
:   [Myers, J.]{.refAuthor}[ and M. Rose]{.refAuthor}, [\"Post Office
    Protocol - Version 3\"]{.refTitle}, [STD 53]{.seriesInfo}, [RFC
    1939]{.seriesInfo}, [DOI 10.17487/RFC1939]{.seriesInfo}, May 1996,
    \<<https://www.rfc-editor.org/info/rfc1939>\>.

\[RFC2033\]
:   [Myers, J.]{.refAuthor}, [\"Local Mail Transfer
    Protocol\"]{.refTitle}, [RFC 2033]{.seriesInfo}, [DOI
    10.17487/RFC2033]{.seriesInfo}, October 1996,
    \<<https://www.rfc-editor.org/info/rfc2033>\>.

\[RFC3501\]
:   [Crispin, M.]{.refAuthor}, [\"INTERNET MESSAGE ACCESS PROTOCOL -
    VERSION 4rev1\"]{.refTitle}, [RFC 3501]{.seriesInfo}, [DOI
    10.17487/RFC3501]{.seriesInfo}, March 2003,
    \<<https://www.rfc-editor.org/info/rfc3501>\>.

\[RFC4880\]
:   [Callas, J.]{.refAuthor}[, Donnerhacke, L.]{.refAuthor}[,
    Finney, H.]{.refAuthor}[, Shaw, D.]{.refAuthor}[, and R.
    Thayer]{.refAuthor}, [\"OpenPGP Message Format\"]{.refTitle}, [RFC
    4880]{.seriesInfo}, [DOI 10.17487/RFC4880]{.seriesInfo}, November
    2007, \<<https://www.rfc-editor.org/info/rfc4880>\>.

\[RFC5228\]
:   [Guenther, P., Ed.]{.refAuthor}[ and T. Showalter, Ed.]{.refAuthor},
    [\"Sieve: An Email Filtering Language\"]{.refTitle}, [RFC
    5228]{.seriesInfo}, [DOI 10.17487/RFC5228]{.seriesInfo}, January
    2008, \<<https://www.rfc-editor.org/info/rfc5228>\>.

\[RFC5598\]
:   [Crocker, D.]{.refAuthor}, [\"Internet Mail
    Architecture\"]{.refTitle}, [RFC 5598]{.seriesInfo}, [DOI
    10.17487/RFC5598]{.seriesInfo}, July 2009,
    \<<https://www.rfc-editor.org/info/rfc5598>\>.

\[RFC6409\]
:   [Gellens, R.]{.refAuthor}[ and J. Klensin]{.refAuthor}, [\"Message
    Submission for Mail\"]{.refTitle}, [STD 72]{.seriesInfo}, [RFC
    6409]{.seriesInfo}, [DOI 10.17487/RFC6409]{.seriesInfo}, November
    2011, \<<https://www.rfc-editor.org/info/rfc6409>\>.

\[RFC8551\]
:   [Schaad, J.]{.refAuthor}[, Ramsdell, B.]{.refAuthor}[, and S.
    Turner]{.refAuthor}, [\"Secure/Multipurpose Internet Mail Extensions
    (S/MIME) Version 4.0 Message Specification\"]{.refTitle}, [RFC
    8551]{.seriesInfo}, [DOI 10.17487/RFC8551]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8551>\>.
:::
:::

::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Examples](#name-examples){.section-name .selfRef} {#name-examples}

This section is informative.[¶](#section-appendix.a-1){.pilcrow}

::: {#section-a.1 .section}
## [A.1.](#section-a.1){.section-number .selfRef} [REQUIRETLS SMTP Option](#name-requiretls-smtp-option){.section-name .selfRef} {#name-requiretls-smtp-option}

The TLS-Required SMTP option is used to express the intention of the
sender to have the associated message relayed using TLS. In the
following example, lines beginning with \"C:\" are transmitted from the
SMTP client to the server, and lines beginning with \"S:\" are
transmitted in the opposite direction.[¶](#section-a.1-1){.pilcrow}

::: {#section-a.1-2 .artwork .art-text .alignLeft}
     S: 220 mail.example.net ESMTP
     C: EHLO mail.example.org
     S: 250-mail.example.net Hello example.org [192.0.2.1]
     S: 250-SIZE 52428800
     S: 250-8BITMIME
     S: 250-PIPELINING
     S: 250-STARTTLS
     S: 250 HELP
     C: STARTTLS
     S: TLS go ahead

[¶](#section-a.1-2){.pilcrow}
:::

(at this point TLS negotiation takes place. The remainder of this
session occurs within TLS.)[¶](#section-a.1-3){.pilcrow}

::: {#section-a.1-4 .artwork .art-text .alignLeft}
     S: 220 mail.example.net ESMTP
     C: EHLO mail.example.org
     S: 250-mail.example.net Hello example.org [192.0.2.1]
     S: 250-SIZE 52428800
     S: 250-8BITMIME
     S: 250-PIPELINING
     S: 250-REQUIRETLS
     S: 250 HELP
     C: MAIL FROM:<roger@example.org> REQUIRETLS
     S: 250 OK
     C: RCPT TO:<editor@example.net>
     S: 250 Accepted
     C: DATA
     S: 354 Enter message, ending with "." on a line by itself

[¶](#section-a.1-4){.pilcrow}
:::

(message follows)[¶](#section-a.1-5){.pilcrow}

::: {#section-a.1-6 .artwork .art-text .alignLeft}
     C: .
     S: 250 OK
     C: QUIT

[¶](#section-a.1-6){.pilcrow}
:::
:::

::: {#section-a.2 .section}
## [A.2.](#section-a.2){.section-number .selfRef} [TLS-Required Header Field](#name-tls-required-header-field){.section-name .selfRef} {#name-tls-required-header-field}

The TLS-Required header field is used when the sender requests that the
mail system not heed a default policy of the recipient domain requiring
TLS. It might be used, for example, to allow problems with the recipient
domain\'s TLS certificate to be reported:[¶](#section-a.2-1){.pilcrow}

::: {#section-a.2-2 .artwork .art-text .alignLeft}
     From: Roger Reporter <roger@example.org>
     To: Andy Admin <admin@example.com>
     Subject: Certificate problem?
     TLS-Required: No
     Date: Fri, 18 Jan 2019 10:26:55 -0800
     Message-ID: <5c421a6f79c0e_d153ff8286d45c468473@mail.example.org>

     Andy, there seems to be a problem with the TLS certificate
     on your mail server. Are you aware of this?

     Roger         

[¶](#section-a.2-2){.pilcrow}
:::
:::
:::

::: {#acknowledgements}
::: {#section-appendix.b .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The author would like to acknowledge many helpful suggestions on the
ietf-smtp and uta mailing lists, in particular those of Viktor Dukhovni,
Tony Finch, Jeremy Harris, Arvel Hathcock, John Klensin, Barry Leiba,
John Levine, Chris Newman, Rolf Sonneveld, and Per
Thorsheim.[¶](#section-appendix.b-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Jim Fenton]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Altmode Networks]{.org}
:::

::: {.left dir="auto"}
[Los Altos]{.locality}, [California]{.region} [94024]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <fenton@bluepopcorn.net>
:::
:::
:::
