  RFC 8772     Simple BNG CUSP   May 2020
  ------------ ----------------- ----------
  Hu, et al.   Informational     \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [8772](https://www.rfc-editor.org/rfc/rfc8772){.eref}

Category:
:   Informational

Published:
:   May 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    S. Hu
    :::

    ::: org
    China Mobile
    :::
    :::

    ::: author
    ::: author-name
    D. Eastlake 3rd
    :::

    ::: org
    Futurewei Technologies
    :::
    :::

    ::: author
    ::: author-name
    F. Qin
    :::

    ::: org
    China Mobile
    :::
    :::

    ::: author
    ::: author-name
    T. Chua
    :::

    ::: org
    Singapore Telecommunications
    :::
    :::

    ::: author
    ::: author-name
    D. Huang
    :::

    ::: org
    ZTE
    :::
    :::
:::

# RFC 8772 {#rfcnum}

# The China Mobile, Huawei, and ZTE Broadband Network Gateway (BNG) Simple Control and User Plane Separation Protocol (S-CUSP) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

A Broadband Network Gateway (BNG) in a fixed wireline access network is
an Ethernet-centric IP edge router and the aggregation point for
subscriber traffic. Control and User Plane Separation (CUPS) for such a
BNG improves flexibility and scalability but requires various
communication between the User Plane (UP) and the Control Plane (CP).
China Mobile, Huawei Technologies, and ZTE have developed a simple CUPS
control channel protocol to support such communication: the Simple
Control and User Plane Separation Protocol (S-CUSP). S-CUSP is defined
in this document.[¶](#section-abstract-1){.pilcrow}

This document is not an IETF standard and does not have IETF consensus.
S-CUSP is presented here to make its specification conveniently
available to the Internet community to enable diagnosis and
interoperability.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8772>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Implementation Requirement
        Keywords](#name-implementation-requirement-){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Terms](#name-terms){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [BNG CUPS
    Overview](#name-bng-cups-overview){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [BNG CUPS
        Motivation](#name-bng-cups-motivation){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [BNG CUPS Architecture
        Overview](#name-bng-cups-architecture-overv){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [BNG CUPS
        Interfaces](#name-bng-cups-interfaces){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [Service Interface
            (Si)](#name-service-interface-si){.xref}[¶](#section-toc.1-1.3.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.2}
            [3.3.2](#section-3.3.2){.xref}.  [Control Interface
            (Ci)](#name-control-interface-ci){.xref}[¶](#section-toc.1-1.3.2.3.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.3}
            [3.3.3](#section-3.3.3){.xref}.  [Management Interface
            (Mi)](#name-management-interface-mi){.xref}[¶](#section-toc.1-1.3.2.3.2.3.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [BNG CUPS Procedure
        Overview](#name-bng-cups-procedure-overview){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [S-CUSP Protocol
    Overview](#name-s-cusp-protocol-overview){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Control Channel
        Procedures](#name-control-channel-procedures){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.1.2.1}
            [4.1.1](#section-4.1.1){.xref}.  [S-CUSP Session
            Establishment](#name-s-cusp-session-establishmen){.xref}[¶](#section-toc.1-1.4.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.1.2.2}
            [4.1.2](#section-4.1.2){.xref}.  [Keepalive Timer and
            DeadTimer](#name-keepalive-timer-and-deadtim){.xref}[¶](#section-toc.1-1.4.2.1.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Node
        Procedures](#name-node-procedures){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [UP Resource
            Report](#name-up-resource-report){.xref}[¶](#section-toc.1-1.4.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [Update BAS Function on
            Access
            Interface](#name-update-bas-function-on-acce){.xref}[¶](#section-toc.1-1.4.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.3}
            [4.2.3](#section-4.2.3){.xref}.  [Update Network
            Routing](#name-update-network-routing){.xref}[¶](#section-toc.1-1.4.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.4}
            [4.2.4](#section-4.2.4){.xref}.  [CGN Public IP Address
            Allocation](#name-cgn-public-ip-address-alloc){.xref}[¶](#section-toc.1-1.4.2.2.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.5}
            [4.2.5](#section-4.2.5){.xref}.  [Data Synchronization
            between the CP and
            UP](#name-data-synchronization-betwee){.xref}[¶](#section-toc.1-1.4.2.2.2.5.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Subscriber Session
        Procedures](#name-subscriber-session-procedur){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.3.2.1}
            [4.3.1](#section-4.3.1){.xref}.  [Create Subscriber
            Session](#name-create-subscriber-session){.xref}[¶](#section-toc.1-1.4.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.2}
            [4.3.2](#section-4.3.2){.xref}.  [Update Subscriber
            Session](#name-update-subscriber-session){.xref}[¶](#section-toc.1-1.4.2.3.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.3}
            [4.3.3](#section-4.3.3){.xref}.  [Delete Subscriber
            Session](#name-delete-subscriber-session){.xref}[¶](#section-toc.1-1.4.2.3.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.4}
            [4.3.4](#section-4.3.4){.xref}.  [Subscriber Session Events
            Report](#name-subscriber-session-events-r){.xref}[¶](#section-toc.1-1.4.2.3.2.4.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [S-CUSP Call
    Flows](#name-s-cusp-call-flows){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [IPoE](#name-ipoe){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.1.2.1}
            [5.1.1](#section-5.1.1){.xref}.  [DHCPv4
            Access](#name-dhcpv4-access){.xref}[¶](#section-toc.1-1.5.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.2}
            [5.1.2](#section-5.1.2){.xref}.  [DHCPv6
            Access](#name-dhcpv6-access){.xref}[¶](#section-toc.1-1.5.2.1.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.3}
            [5.1.3](#section-5.1.3){.xref}.  [IPv6 Stateless Address
            Autoconfiguration (SLAAC)
            Access](#name-ipv6-stateless-address-auto){.xref}[¶](#section-toc.1-1.5.2.1.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.4}
            [5.1.4](#section-5.1.4){.xref}.  [DHCPv6 and SLAAC
            Access](#name-dhcpv6-and-slaac-access){.xref}[¶](#section-toc.1-1.5.2.1.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.5}
            [5.1.5](#section-5.1.5){.xref}.  [DHCP Dual-Stack
            Access](#name-dhcp-dual-stack-access){.xref}[¶](#section-toc.1-1.5.2.1.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.6}
            [5.1.6](#section-5.1.6){.xref}.  [L2 Static Subscriber
            Access](#name-l2-static-subscriber-access){.xref}[¶](#section-toc.1-1.5.2.1.2.6.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [PPPoE](#name-pppoe){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.2.2.1}
            [5.2.1](#section-5.2.1){.xref}.  [IPv4 PPPoE
            Access](#name-ipv4-pppoe-access){.xref}[¶](#section-toc.1-1.5.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.2}
            [5.2.2](#section-5.2.2){.xref}.  [IPv6 PPPoE
            Access](#name-ipv6-pppoe-access){.xref}[¶](#section-toc.1-1.5.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.3}
            [5.2.3](#section-5.2.3){.xref}.  [PPPoE Dual-Stack
            Access](#name-pppoe-dual-stack-access){.xref}[¶](#section-toc.1-1.5.2.2.2.3.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [WLAN
        Access](#name-wlan-access){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [L2TP](#name-l2tp){.xref}[¶](#section-toc.1-1.5.2.4.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.4.2.1}
            [5.4.1](#section-5.4.1){.xref}.  [L2TP LAC
            Access](#name-l2tp-lac-access){.xref}[¶](#section-toc.1-1.5.2.4.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.4.2.2}
            [5.4.2](#section-5.4.2){.xref}.  [L2TP LNS IPv4
            Access](#name-l2tp-lns-ipv4-access){.xref}[¶](#section-toc.1-1.5.2.4.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.4.2.3}
            [5.4.3](#section-5.4.3){.xref}.  [L2TP LNS IPv6
            Access](#name-l2tp-lns-ipv6-access){.xref}[¶](#section-toc.1-1.5.2.4.2.3.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [CGN (Carrier Grade
        NAT)](#name-cgn-carrier-grade-nat){.xref}[¶](#section-toc.1-1.5.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [L3 Leased Line
        Access](#name-l3-leased-line-access){.xref}[¶](#section-toc.1-1.5.2.6.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.6.2.1}
            [5.6.1](#section-5.6.1){.xref}.  [Web
            Authentication](#name-web-authentication){.xref}[¶](#section-toc.1-1.5.2.6.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.6.2.2}
            [5.6.2](#section-5.6.2){.xref}.  [User Traffic
            Trigger](#name-user-traffic-trigger){.xref}[¶](#section-toc.1-1.5.2.6.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.7}
        [5.7](#section-5.7){.xref}.  [Multicast Service
        Access](#name-multicast-service-access){.xref}[¶](#section-toc.1-1.5.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [S-CUSP Message
    Formats](#name-s-cusp-message-formats){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Common Message
        Header](#name-common-message-header){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Control
        Messages](#name-control-messages){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.6.2.2.2.1}
            [6.2.1](#section-6.2.1){.xref}.  [Hello
            Message](#name-hello-message){.xref}[¶](#section-toc.1-1.6.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.2}
            [6.2.2](#section-6.2.2){.xref}.  [Keepalive
            Message](#name-keepalive-message){.xref}[¶](#section-toc.1-1.6.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.3}
            [6.2.3](#section-6.2.3){.xref}.  [Sync_Request
            Message](#name-sync_request-message){.xref}[¶](#section-toc.1-1.6.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.4}
            [6.2.4](#section-6.2.4){.xref}.  [Sync_Begin
            Message](#name-sync_begin-message){.xref}[¶](#section-toc.1-1.6.2.2.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.5}
            [6.2.5](#section-6.2.5){.xref}.  [Sync_Data
            Message](#name-sync_data-message){.xref}[¶](#section-toc.1-1.6.2.2.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.6}
            [6.2.6](#section-6.2.6){.xref}.  [Sync_End
            Message](#name-sync_end-message){.xref}[¶](#section-toc.1-1.6.2.2.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.7}
            [6.2.7](#section-6.2.7){.xref}.  [Update_Request
            Message](#name-update_request-message){.xref}[¶](#section-toc.1-1.6.2.2.2.7.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.2.2.8}
            [6.2.8](#section-6.2.8){.xref}.  [Update_Response
            Message](#name-update_response-message){.xref}[¶](#section-toc.1-1.6.2.2.2.8.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Event
        Message](#name-event-message){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [Report
        Message](#name-report-message){.xref}[¶](#section-toc.1-1.6.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [CGN
        Messages](#name-cgn-messages){.xref}[¶](#section-toc.1-1.6.2.5.1){.pilcrow}

        -   ::: {#section-toc.1-1.6.2.5.2.1}
            [6.5.1](#section-6.5.1){.xref}.  [Addr_Allocation_Req
            Message](#name-addr_allocation_req-message){.xref}[¶](#section-toc.1-1.6.2.5.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.5.2.2}
            [6.5.2](#section-6.5.2){.xref}.  [Addr_Allocation_Ack
            Message](#name-addr_allocation_ack-message){.xref}[¶](#section-toc.1-1.6.2.5.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.5.2.3}
            [6.5.3](#section-6.5.3){.xref}.  [Addr_Renew_Req
            Message](#name-addr_renew_req-message){.xref}[¶](#section-toc.1-1.6.2.5.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.5.2.4}
            [6.5.4](#section-6.5.4){.xref}.  [Addr_Renew_Ack
            Message](#name-addr_renew_ack-message){.xref}[¶](#section-toc.1-1.6.2.5.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.5.2.5}
            [6.5.5](#section-6.5.5){.xref}.  [Addr_Release_Req
            Message](#name-addr_release_req-message){.xref}[¶](#section-toc.1-1.6.2.5.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.5.2.6}
            [6.5.6](#section-6.5.6){.xref}.  [Addr_Release_Ack
            Message](#name-addr_release_ack-message){.xref}[¶](#section-toc.1-1.6.2.5.2.6.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.6}
        [6.6](#section-6.6){.xref}.  [Vendor
        Message](#name-vendor-message){.xref}[¶](#section-toc.1-1.6.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.7}
        [6.7](#section-6.7){.xref}.  [Error
        Message](#name-error-message){.xref}[¶](#section-toc.1-1.6.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [S-CUSP TLVs and
    Sub-TLVs](#name-s-cusp-tlvs-and-sub-tlvs){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Common TLV
        Header](#name-common-tlv-header){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Basic Data
        Fields](#name-basic-data-fields){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Sub-TLV Format and
        Sub-TLVs](#name-sub-tlv-format-and-sub-tlvs){.xref}[¶](#section-toc.1-1.7.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.3.2.1}
            [7.3.1](#section-7.3.1){.xref}.  [Name
            Sub-TLVs](#name-name-sub-tlvs){.xref}[¶](#section-toc.1-1.7.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.2}
            [7.3.2](#section-7.3.2){.xref}.  [Ingress-CAR
            Sub-TLV](#name-ingress-car-sub-tlv){.xref}[¶](#section-toc.1-1.7.2.3.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.3}
            [7.3.3](#section-7.3.3){.xref}.  [Egress-CAR
            Sub-TLV](#name-egress-car-sub-tlv){.xref}[¶](#section-toc.1-1.7.2.3.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.4}
            [7.3.4](#section-7.3.4){.xref}.  [If-Desc
            Sub-TLV](#name-if-desc-sub-tlv){.xref}[¶](#section-toc.1-1.7.2.3.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.5}
            [7.3.5](#section-7.3.5){.xref}.  [IPv6 Address List
            Sub-TLV](#name-ipv6-address-list-sub-tlv){.xref}[¶](#section-toc.1-1.7.2.3.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.3.2.6}
            [7.3.6](#section-7.3.6){.xref}.  [Vendor
            Sub-TLV](#name-vendor-sub-tlv){.xref}[¶](#section-toc.1-1.7.2.3.2.6.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [Hello
        TLV](#name-hello-tlv){.xref}[¶](#section-toc.1-1.7.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.5}
        [7.5](#section-7.5){.xref}.  [Keepalive
        TLV](#name-keepalive-tlv){.xref}[¶](#section-toc.1-1.7.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.6}
        [7.6](#section-7.6){.xref}.  [Error Information
        TLV](#name-error-information-tlv){.xref}[¶](#section-toc.1-1.7.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.7}
        [7.7](#section-7.7){.xref}.  [BAS Function
        TLV](#name-bas-function-tlv){.xref}[¶](#section-toc.1-1.7.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.8}
        [7.8](#section-7.8){.xref}.  [Routing
        TLVs](#name-routing-tlvs){.xref}[¶](#section-toc.1-1.7.2.8.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.8.2.1}
            [7.8.1](#section-7.8.1){.xref}.  [IPv4 Routing
            TLV](#name-ipv4-routing-tlv){.xref}[¶](#section-toc.1-1.7.2.8.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.8.2.2}
            [7.8.2](#section-7.8.2){.xref}.  [IPv6 Routing
            TLV](#name-ipv6-routing-tlv){.xref}[¶](#section-toc.1-1.7.2.8.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.9}
        [7.9](#section-7.9){.xref}.  [Subscriber
        TLVs](#name-subscriber-tlvs){.xref}[¶](#section-toc.1-1.7.2.9.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.9.2.1}
            [7.9.1](#section-7.9.1){.xref}.  [Basic Subscriber
            TLV](#name-basic-subscriber-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.2}
            [7.9.2](#section-7.9.2){.xref}.  [PPP Subscriber
            TLV](#name-ppp-subscriber-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.3}
            [7.9.3](#section-7.9.3){.xref}.  [IPv4 Subscriber
            TLV](#name-ipv4-subscriber-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.4}
            [7.9.4](#section-7.9.4){.xref}.  [IPv6 Subscriber
            TLV](#name-ipv6-subscriber-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.5}
            [7.9.5](#section-7.9.5){.xref}.  [IPv4 Static Subscriber
            Detect
            TLV](#name-ipv4-static-subscriber-dete){.xref}[¶](#section-toc.1-1.7.2.9.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.6}
            [7.9.6](#section-7.9.6){.xref}.  [IPv6 Static Subscriber
            Detect
            TLV](#name-ipv6-static-subscriber-dete){.xref}[¶](#section-toc.1-1.7.2.9.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.7}
            [7.9.7](#section-7.9.7){.xref}.  [L2TP-LAC Subscriber
            TLV](#name-l2tp-lac-subscriber-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.7.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.8}
            [7.9.8](#section-7.9.8){.xref}.  [L2TP-LNS Subscriber
            TLV](#name-l2tp-lns-subscriber-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.8.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.9}
            [7.9.9](#section-7.9.9){.xref}.  [L2TP-LAC Tunnel
            TLV](#name-l2tp-lac-tunnel-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.9.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.10}
            [7.9.10](#section-7.9.10){.xref}. [L2TP-LNS Tunnel
            TLV](#name-l2tp-lns-tunnel-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.10.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.11}
            [7.9.11](#section-7.9.11){.xref}. [Update Response
            TLV](#name-update-response-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.11.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.12}
            [7.9.12](#section-7.9.12){.xref}. [Subscriber Policy
            TLV](#name-subscriber-policy-tlv){.xref}[¶](#section-toc.1-1.7.2.9.2.12.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.9.2.13}
            [7.9.13](#section-7.9.13){.xref}. [Subscriber CGN Port Range
            TLV](#name-subscriber-cgn-port-range-t){.xref}[¶](#section-toc.1-1.7.2.9.2.13.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.10}
        [7.10](#section-7.10){.xref}. [Device Status
        TLVs](#name-device-status-tlvs){.xref}[¶](#section-toc.1-1.7.2.10.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.10.2.1}
            [7.10.1](#section-7.10.1){.xref}.  [Interface Status
            TLV](#name-interface-status-tlv){.xref}[¶](#section-toc.1-1.7.2.10.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.10.2.2}
            [7.10.2](#section-7.10.2){.xref}.  [Board Status
            TLV](#name-board-status-tlv){.xref}[¶](#section-toc.1-1.7.2.10.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.11}
        [7.11](#section-7.11){.xref}. [CGN
        TLVs](#name-cgn-tlvs){.xref}[¶](#section-toc.1-1.7.2.11.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.11.2.1}
            [7.11.1](#section-7.11.1){.xref}.  [Address Allocation
            Request
            TLV](#name-address-allocation-request-){.xref}[¶](#section-toc.1-1.7.2.11.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.11.2.2}
            [7.11.2](#section-7.11.2){.xref}.  [Address Allocation
            Response
            TLV](#name-address-allocation-response){.xref}[¶](#section-toc.1-1.7.2.11.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.11.2.3}
            [7.11.3](#section-7.11.3){.xref}.  [Address Renewal Request
            TLV](#name-address-renewal-request-tlv){.xref}[¶](#section-toc.1-1.7.2.11.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.11.2.4}
            [7.11.4](#section-7.11.4){.xref}.  [Address Renewal Response
            TLV](#name-address-renewal-response-tl){.xref}[¶](#section-toc.1-1.7.2.11.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.11.2.5}
            [7.11.5](#section-7.11.5){.xref}.  [Address Release Request
            TLV](#name-address-release-request-tlv){.xref}[¶](#section-toc.1-1.7.2.11.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.11.2.6}
            [7.11.6](#section-7.11.6){.xref}.  [Address Release Response
            TLV](#name-address-release-response-tl){.xref}[¶](#section-toc.1-1.7.2.11.2.6.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.12}
        [7.12](#section-7.12){.xref}. [Event
        TLVs](#name-event-tlvs){.xref}[¶](#section-toc.1-1.7.2.12.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.12.2.1}
            [7.12.1](#section-7.12.1){.xref}.  [Subscriber Traffic
            Statistics
            TLV](#name-subscriber-traffic-statisti){.xref}[¶](#section-toc.1-1.7.2.12.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.12.2.2}
            [7.12.2](#section-7.12.2){.xref}.  [Subscriber Detection
            Result
            TLV](#name-subscriber-detection-result){.xref}[¶](#section-toc.1-1.7.2.12.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.13}
        [7.13](#section-7.13){.xref}. [Vendor
        TLV](#name-vendor-tlv){.xref}[¶](#section-toc.1-1.7.2.13.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Tables of S-CUSP
    Codepoints](#name-tables-of-s-cusp-codepoints){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Message
        Types](#name-message-types){.xref}[¶](#section-toc.1-1.8.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [TLV
        Types](#name-tlv-types){.xref}[¶](#section-toc.1-1.8.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [TLV Operation
        Codes](#name-tlv-operation-codes){.xref}[¶](#section-toc.1-1.8.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [8.4](#section-8.4){.xref}.  [Sub-TLV
        Types](#name-sub-tlv-types){.xref}[¶](#section-toc.1-1.8.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.5}
        [8.5](#section-8.5){.xref}.  [Error
        Codes](#name-error-codes){.xref}[¶](#section-toc.1-1.8.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.6}
        [8.6](#section-8.6){.xref}.  [If-Type
        Values](#name-if-type-values){.xref}[¶](#section-toc.1-1.8.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.7}
        [8.7](#section-8.7){.xref}.  [Access-Mode
        Values](#name-access-mode-values){.xref}[¶](#section-toc.1-1.8.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.8}
        [8.8](#section-8.8){.xref}.  [Access Method
        Bits](#name-access-method-bits){.xref}[¶](#section-toc.1-1.8.2.8.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.9}
        [8.9](#section-8.9){.xref}.  [Route-Type
        Values](#name-route-type-values){.xref}[¶](#section-toc.1-1.8.2.9.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.10}
        [8.10](#section-8.10){.xref}. [Access-Type
        Values](#name-access-type-values){.xref}[¶](#section-toc.1-1.8.2.10.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.b){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.c){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::
:::
:::

::: {#sect-1}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

A Broadband Network Gateway (BNG) in a fixed wireline access network is
an Ethernet-centric IP edge router and the aggregation point for
subscriber traffic. To provide centralized session management, flexible
address allocation, high scalability for subscriber management capacity,
and cost-efficient redundancy, the CU-separated (CP/UP-separated) BNG
framework is described in a technical report
\[[TR-384](#TR-384){.xref}\] from the Broadband Forum (BBF). The
CU-separated service CP, which is responsible for user access
authentication and setting forwarding entries in UPs, can be virtualized
and centralized. The routing control and forwarding plane, i.e., the BNG
UP (local), can be distributed across the infrastructure. Other
structures can also be supported, such as the CP and UP being virtual or
both being physical.[¶](#section-1-1){.pilcrow}

Note: In this document, the terms \"user\" and \"subscriber\" are used
interchangeably.[¶](#section-1-2){.pilcrow}

This document specifies the Simple CU Separation Protocol (S-CUSP) for
communications over the BNG control channel between a BNG CP and a set
of UPs. S-CUSP is designed to be flexible and extensible so as to allow
for easy addition of messages and data items, should further
requirements be expressed in the future.[¶](#section-1-3){.pilcrow}

This document is not an IETF standard and does not have IETF consensus.
S-CUSP was designed by China Mobile, Huawei Technologies, and ZTE. It is
presented here to make the S-CUSP specification conveniently available
to the Internet community to enable diagnosis and
interoperability.[¶](#section-1-4){.pilcrow}

At the time of writing this document, the BBF is working to produce
\[[WT-459](#WT-459){.xref}\], which will describe an architecture and
requirements for a CP and UP separation of a disaggregated BNG. Future
work may attempt to show how the protocol described in this document
addresses those requirements and may modify this specification to handle
unaddressed requirements.[¶](#section-1-5){.pilcrow}
:::
:::

::: {#sect-2}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

This section specifies implementation requirement keywords and terms
used in this document. S-CUSP messages are described in this document
using Routing Backus-Naur Form (RBNF) as defined in
\[[RFC5511](#RFC5511){.xref}\].[¶](#section-2-1){.pilcrow}

::: {#sect-2.1}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Implementation Requirement Keywords](#name-implementation-requirement-){.section-name .selfRef} {#name-implementation-requirement-}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.1-1){.pilcrow}
:::
:::

::: {#sect-2.2}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Terms](#name-terms){.section-name .selfRef} {#name-terms}

This section specifies terms used in this
document.[¶](#section-2.2-1){.pilcrow}

AAA:
:   Authentication Authorization
    Accounting.[¶](#section-2.2-2.2){.pilcrow}
:   

ACK:
:   Acknowledgement message.[¶](#section-2.2-2.4){.pilcrow}
:   

BAS:
:   Broadband Access Server, also known as a BBRAS, BNG, or
    BRAS.[¶](#section-2.2-2.6){.pilcrow}
:   

BNG:
:   Broadband Network Gateway. A BNG (or Broadband Remote Access Server
    (BRAS)) routes traffic to and from broadband remote access devices
    such as digital subscriber line access multiplexers (DSLAM) on an
    Internet Service Provider\'s (ISP) network. BNG / BRAS can also be
    referred to as a BAS or BBRAS.[¶](#section-2.2-2.8){.pilcrow}
:   

BRAS:
:   Broadband Remote Access Server, also known as a BAS, BBRAS, or
    BNG.[¶](#section-2.2-2.10){.pilcrow}
:   

CAR:
:   Committed Access Rate.[¶](#section-2.2-2.12){.pilcrow}
:   

CBS:
:   Committed Burst Size.[¶](#section-2.2-2.14){.pilcrow}
:   

CGN:
:   Carrier Grade NAT.[¶](#section-2.2-2.16){.pilcrow}
:   

Ci:
:   Control Interface.[¶](#section-2.2-2.18){.pilcrow}
:   

CIR:
:   Committed Information Rate.[¶](#section-2.2-2.20){.pilcrow}
:   

CoA:
:   Change of Authorization.[¶](#section-2.2-2.22){.pilcrow}
:   

CP:
:   Control Plane. CP is a user control management component that
    supports the management of the UP\'s resources such as the user
    entry and forwarding policy.[¶](#section-2.2-2.24){.pilcrow}
:   

CU:
:   Control Plane / User Plane.[¶](#section-2.2-2.26){.pilcrow}
:   

CUSP:
:   Control and User Plane Separation
    Protocol.[¶](#section-2.2-2.28){.pilcrow}
:   

DEI:
:   Drop Eligibility Indicator as defined in
    \[[802.1Q](#IEEE-802.1Q){.xref}\]. A bit in a VLAN tag after the
    priority and before the VLAN ID. (This bit was formerly the CFI
    (Canonical Format Indicator).)[¶](#section-2.2-2.30){.pilcrow}
:   

DHCP:
:   Dynamic Host Configuration Protocol
    \[[RFC2131](#RFC2131){.xref}\].[¶](#section-2.2-2.32){.pilcrow}
:   

dial-up:
:   This refers to the initial connection messages when a new subscriber
    appears. The name is left over from when subscribers literally
    dialed up on a modem-equipped phone line but herein is applied to
    other initial connection techniques. Initial connection is
    frequently indicated by the receipt of packets over PPPoE
    \[[RFC2516](#RFC2516){.xref}\] or
    IPoE.[¶](#section-2.2-2.34){.pilcrow}
:   

EMS:
:   Element Management System.[¶](#section-2.2-2.36){.pilcrow}
:   

IPoE:
:   IP over Ethernet.[¶](#section-2.2-2.38){.pilcrow}
:   

L2TP:
:   Layer 2 Tunneling Protocol
    \[[RFC2661](#RFC2661){.xref}\].[¶](#section-2.2-2.40){.pilcrow}
:   

LAC:
:   L2TP Access Concentrator.[¶](#section-2.2-2.42){.pilcrow}
:   

LNS:
:   L2TP Network Server.[¶](#section-2.2-2.44){.pilcrow}
:   

MAC:
:   48-bit Media Access Control address
    \[[RFC7042](#RFC7042){.xref}\].[¶](#section-2.2-2.46){.pilcrow}
:   

MANO:
:   Management and Orchestration.[¶](#section-2.2-2.48){.pilcrow}
:   

Mi:
:   Management Interface.[¶](#section-2.2-2.50){.pilcrow}
:   

MSS:
:   Maximum Segment Size.[¶](#section-2.2-2.52){.pilcrow}
:   

MRU:
:   Maximum Receive Unit.[¶](#section-2.2-2.54){.pilcrow}
:   

NAT:
:   Network Address Translation
    \[[RFC3022](#RFC3022){.xref}\].[¶](#section-2.2-2.56){.pilcrow}
:   

ND:
:   Neighbor Discovery.[¶](#section-2.2-2.58){.pilcrow}
:   

NFV:
:   Network Function Virtualization.[¶](#section-2.2-2.60){.pilcrow}
:   

NFVI:
:   NFV Infrastructure.[¶](#section-2.2-2.62){.pilcrow}
:   

PBS:
:   Peak Burst Size.[¶](#section-2.2-2.64){.pilcrow}
:   

PD:
:   Prefix Delegation.[¶](#section-2.2-2.66){.pilcrow}
:   

PIR:
:   Peak Information Rate.[¶](#section-2.2-2.68){.pilcrow}
:   

PPP:
:   Point-to-Point Protocol
    \[[RFC1661](#RFC1661){.xref}\].[¶](#section-2.2-2.70){.pilcrow}
:   

PPPoE:
:   PPP over Ethernet
    \[[RFC2516](#RFC2516){.xref}\].[¶](#section-2.2-2.72){.pilcrow}
:   

RBNF:
:   Routing Backus-Naur Form
    \[[RFC5511](#RFC5511){.xref}\].[¶](#section-2.2-2.74){.pilcrow}
:   

RG:
:   Residential Gateway.[¶](#section-2.2-2.76){.pilcrow}
:   

S-CUSP:
:   Simple Control and User Plane Separation
    Protocol.[¶](#section-2.2-2.78){.pilcrow}
:   

Subscriber:
:   The remote user gaining network accesses via a
    BNG.[¶](#section-2.2-2.80){.pilcrow}
:   

Si:
:   Service Interface.[¶](#section-2.2-2.82){.pilcrow}
:   

TLV:
:   Type-Length-Value. See Sections [7.1](#sect-7.1){.xref} and
    [7.3](#sect-7.3){.xref}.[¶](#section-2.2-2.84){.pilcrow}
:   

UP:
:   User Plane. UP is a network edge and user policy implementation
    component. The traditional router\'s control plane and forwarding
    plane are both preserved on BNG devices in the form of a user
    plane.[¶](#section-2.2-2.86){.pilcrow}
:   

URPF:
:   Unicast Reverse Path Forwarding.[¶](#section-2.2-2.88){.pilcrow}
:   

User:
:   Equivalent to \"customer\" or
    \"subscriber\".[¶](#section-2.2-2.90){.pilcrow}
:   

VRF:
:   Virtual Routing and Forwarding.[¶](#section-2.2-2.92){.pilcrow}
:   
:::
:::
:::
:::

::: {#sect-3}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [BNG CUPS Overview](#name-bng-cups-overview){.section-name .selfRef} {#name-bng-cups-overview}

::: {#sect-3.1}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [BNG CUPS Motivation](#name-bng-cups-motivation){.section-name .selfRef} {#name-bng-cups-motivation}

The rapid development of new services, such as 4K TV, Internet of Things
(IoT), etc., and increasing numbers of home broadband service users
present some new challenges for BNGs such
as:[¶](#section-3.1-1){.pilcrow}

Low resource utilization:
:   The traditional BNG acts as both a gateway for user access
    authentication and accounting and also an IP network\'s Layer 3
    edge. The mutually affecting nature of the tightly coupled control
    plane and forwarding plane makes it difficult to achieve the maximum
    performance of either plane.[¶](#section-3.1-2.2){.pilcrow}
:   

Complex management and maintenance:
:   Due to the large numbers of traditional BNGs, configuring each
    device in a network is very tedious when deploying global service
    policies. As the network expands and new services are introduced,
    this deployment mode will cease to be feasible as it is unable to
    manage services effectively and to rectify faults
    rapidly.[¶](#section-3.1-2.4){.pilcrow}
:   

Slow service provisioning:
:   The coupling of the CP and the forwarding plane, in addition to
    being a distributed network control mechanism, means that any new
    technology has to rely heavily on the existing network
    devices.[¶](#section-3.1-2.6){.pilcrow}
:   

The framework for a cloud-based BNG with CU separation to address these
challenges for fixed networks is described in
\[[TR-384](#TR-384){.xref}\]. The main idea of CU separation is to
extract and centralize the user management functions of multiple BNG
devices, forming a unified and centralized CP. The traditional router\'s
CP and forwarding plane are both preserved on BNG devices in the form of
a UP.[¶](#section-3.1-3){.pilcrow}
:::
:::

::: {#sect-3.2}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [BNG CUPS Architecture Overview](#name-bng-cups-architecture-overv){.section-name .selfRef} {#name-bng-cups-architecture-overv}

The functions in a traditional BNG can be divided into two parts: (1)
the user access management function and (2) the routing function. The
user access management function can be deployed as a centralized module
or device, called the BNG Control Plane (BNG-CP). The routing function,
which includes routing control and the forwarding engine, can be
deployed in the form of the BNG User Plane
(BNG-UP).[¶](#section-3.2-1){.pilcrow}

[Figure 1](#fig1){.xref} shows the architecture of a CU-separated
BNG:[¶](#section-3.2-2){.pilcrow}

[]{#name-architecture-of-a-cu-separa}

::: {#fig1}
::: {#section-3.2-3.1 .artwork .art-text .alignLeft}
     +------------------------------------------------------------------+
     |        Neighboring policy and resource management systems        |
     |                                                                  |
     |   +-------------+   +-----------+   +---------+   +----------+   |
     |   | AAA Server  |   |DHCP Server|   |   EMS   |   |   MANO   |   |
     |   +-------------+   +-----------+   +---------+   +----------+   |
     +------------------------------------------------------------------+

     +------------------------------------------------------------------+
     |                       CU-separated BNG system                    |
     | +--------------------------------------------------------------+ |
     | |   +----------+  +----------+ +------++------++-----------+   | |
     | |   | Address  |  |Subscriber| | AAA  ||Access||    UP     |   | |
     | |   |management|  |management| |      || mgt  ||management |   | |
     | |   +----------+  +----------+ +------++------++-----------+   | |
     | |                              CP                              | |
     | +--------------------------------------------------------------+ |
     |                                                                  |
     |                                                                  |
     |                                                                  |
     | +---------------------------+      +--------------------------+  |
     | |  +------------------+     |      |  +------------------+    |  |
     | |  | Routing control  |     |      |  | Routing control  |    |  |
     | |  +------------------+     | ...  |  +------------------+    |  |
     | |  +------------------+     |      |  +------------------+    |  |
     | |  |Forwarding engine |     |      |  |Forwarding engine |    |  |
     | |  +------------------+  UP |      |  +------------------+  UP|  |
     | +---------------------------+      +--------------------------+  |
    +------------------------------------------------------------------+
:::

[Figure 1](#figure-1){.selfRef}: [Architecture of a CU-Separated
BNG](#name-architecture-of-a-cu-separa){.selfRef}
:::

As shown in [Figure 1](#fig1){.xref}, the BNG-CP could be virtualized
and centralized, which provides benefits such as centralized session
management, flexible address allocation, high scalability for subscriber
management capacity, cost-efficient redundancy, etc. The functional
components inside the BNG-CP can be implemented as Virtual Network
Functions (VNFs) and hosted in an NFVI.[¶](#section-3.2-4){.pilcrow}

The UP management module in the BNG-CP centrally manages the distributed
BNG-UPs (e.g., load balancing), as well as the setup, deletion, and
maintenance of channels between CPs and UPs. Other modules in the
BNG-CP, such as address management, AAA, etc., are responsible for the
connection with external subsystems in order to fulfill those services.
Note that the UP [SHOULD]{.bcp14} support both physical and virtual
network functions. For example, network functions related to BNG-UP L3
forwarding can be disaggregated and distributed across the physical
infrastructure, and the other CP management functions in the
CU-separated BNG can be moved into the NFVI for virtualization
\[[TR-384](#TR-384){.xref}\].[¶](#section-3.2-5){.pilcrow}

The details of the CU-separated BNG\'s function components are as
follows:[¶](#section-3.2-6){.pilcrow}

The CP is responsible for the following:[¶](#section-3.2-7){.pilcrow}

-   [Address management: Unified address pool management and CGN
    subscriber address traceability
    management.[¶](#section-3.2-8.1){.pilcrow}]{#section-3.2-8.1}
-   [AAA: This component performs Authentication, Authorization, and
    Accounting, together with RADIUS/Diameter. The BNG communicates with
    the AAA server to check whether the subscriber who sent an access
    request has network access authority. Once the subscriber goes
    online, this component (together with the Service Control component)
    implements accounting, data capacity limitation, and QoS enforcement
    policies.[¶](#section-3.2-8.2){.pilcrow}]{#section-3.2-8.2}
-   [Subscriber management: User entry management and forwarding policy
    management.[¶](#section-3.2-8.3){.pilcrow}]{#section-3.2-8.3}
-   [Access management: Process user dial-up packets, such as PPPoE,
    DHCP, L2TP, etc.[¶](#section-3.2-8.4){.pilcrow}]{#section-3.2-8.4}
-   [UP management: Management of UP interface status and the setup,
    deletion, and maintenance of channels between CP and
    UP.[¶](#section-3.2-8.5){.pilcrow}]{#section-3.2-8.5}

The UP is responsible for the following:[¶](#section-3.2-9){.pilcrow}

-   [Routing control functions: Responsible for instantiating routing
    forwarding plane (e.g., routing, multicast, MPLS,
    etc.).[¶](#section-3.2-10.1){.pilcrow}]{#section-3.2-10.1}
-   [Routing and service forwarding plane functions: Responsibilities
    include traffic forwarding, QoS, and traffic statistics
    collection.[¶](#section-3.2-10.2){.pilcrow}]{#section-3.2-10.2}
-   [Subscriber detection: Responsible for detecting whether a
    subscriber is still
    online.[¶](#section-3.2-10.3){.pilcrow}]{#section-3.2-10.3}
:::
:::

::: {#sect-3.3}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [BNG CUPS Interfaces](#name-bng-cups-interfaces){.section-name .selfRef} {#name-bng-cups-interfaces}

The three interfaces defined below support the communication between the
CP and UP. These are referred to as the Service Interface (Si), Control
Interface (Ci), and Management Interface (Mi) as shown in [Figure
2](#fig2){.xref}.[¶](#section-3.3-1){.pilcrow}

[]{#name-interfaces-between-the-cp-a}

::: {#fig2}
::: {#section-3.3-2.1 .artwork .art-text .alignLeft}
              +-----------------------------------+
              |                                   |
              |               BNG-CP              |
              |                                   |
              +--+--------------+--------------+--+
                 |              |              |
      1. Service |   2. Control | 3. Management|
       Interface |    Interface |    Interface |
            (Si) |         (Ci) |         (Mi) |
                 |              |              |
                 |           ___|___           |
                 |       ___(       )___       |
                _|______(               )______|_
               (                                 )
              (         Network/Internet         )
               (________                 ________)
                 |      (___         ___)      |
                 |          (_______)          |
                 |              |              |
                 |              |              |
              +--+--------------+--------------+--+
              |                                   |
              |               BNG-UP              |
              |                                   |
              +-----------------------------------+
:::

[Figure 2](#figure-2){.selfRef}: [Interfaces between the CP and UP of
the BNG](#name-interfaces-between-the-cp-a){.selfRef}
:::

::: {#sect-3.3.1}
::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [Service Interface (Si)](#name-service-interface-si){.section-name .selfRef} {#name-service-interface-si}

For a traditional BNG (without CU separation), the user dial-up signals
are terminated and processed by the CP of a BNG. When the CP and UP of a
BNG are separated, there needs to be a way to relay these signals
between the CP and the UP.[¶](#section-3.3.1-1){.pilcrow}

The Si is used to establish tunnels between the CP and UP. The tunnels
are responsible for relaying the PPPoE-, IPoE-, and L2TP-related control
packets that are received from a Residential Gateway (RG) over those
tunnels. An appropriate tunnel type is Virtual eXtensible Local Area
Network (VXLAN)
\[[RFC7348](#RFC7348){.xref}\].[¶](#section-3.3.1-2){.pilcrow}

The detailed definition of Si is out of scope for this
document.[¶](#section-3.3.1-3){.pilcrow}
:::
:::

::: {#sect-3.3.2}
::: {#section-3.3.2 .section}
#### [3.3.2.](#section-3.3.2){.section-number .selfRef} [Control Interface (Ci)](#name-control-interface-ci){.section-name .selfRef} {#name-control-interface-ci}

The CP uses the Ci to deliver subscriber session states, network routing
entries, etc., to the UP (see [Section 6.2.7](#sect-6.2.7){.xref}). The
UP uses this interface to report subscriber service statistics,
subscriber detection results, etc., to the CP (see Sections
[6.3](#sect-6.3){.xref} and [6.4](#sect-6.4){.xref}). A carrying
protocol for this interface is specified in this
document.[¶](#section-3.3.2-1){.pilcrow}
:::
:::

::: {#sect-3.3.3}
::: {#section-3.3.3 .section}
#### [3.3.3.](#section-3.3.3){.section-number .selfRef} [Management Interface (Mi)](#name-management-interface-mi){.section-name .selfRef} {#name-management-interface-mi}

The Network Configuration Protocol (NETCONF)
\[[RFC6241](#RFC6241){.xref}\] is the protocol used on the Mi between a
CP and UP. It is used to configure the parameters of the Ci, Si, access
interfaces, and QoS/ACL Templates. It is expected that implementations
will make use of existing YANG models where possible but that new YANG
models specific to S-CUSP will need to be defined. The definitions of
the parameters that can be configured are out of scope for this
document.[¶](#section-3.3.3-1){.pilcrow}
:::
:::
:::
:::

::: {#sect-3.4}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [BNG CUPS Procedure Overview](#name-bng-cups-procedure-overview){.section-name .selfRef} {#name-bng-cups-procedure-overview}

The following numbered sequences ([Figure 3](#fig3){.xref}) give a
high-level view of the main BNG CUPS
procedures.[¶](#section-3.4-1){.pilcrow}

[]{#name-bng-cups-procedures-overvie}

::: {#fig3}
::: {#section-3.4-2.1 .artwork .art-text .alignLeft}
       RG              UP                      CP              AAA
       |               |Establish S-CUSP Channel|               |
       |              1|<---------------------->|               |
       |               |                        |               |
       |               | Report board interface |               |
       |               |      information       |               |
       |              2|------to CP via Ci----->|               |
       |               |                        |               |
       |               |  Update BAS function   |               |
       |              3|    request/response    |               |
       |               |<-----on UP via Ci----->|               |
       |               |                        |               |
       |               | Update network routing |               |
       |               |    request/response    |               |
       |              4|<------- via Ci-------->|               |
       |  Online Req   |                        |               |
    5.1|-------------->|                        |               |
       |               | Relay the Online Req   |               |
       |            5.2|-----to CP via Si------>| Authentication|
       |               |                        |    Req/Rep    |
       |               |                     5.3|<------------->|
       |               | Send the Online Rep    |               |
       |            5.4|<----to UP via Si-------|               |
       |               |                        |               |
       |               | Create subscriber      |               |
       |               |    session on UP       |               |
       |            5.5|<--------via Ci-------->|               |
       |  Online Rep   |                        |               |
    5.6|<--------------|                        |               |
       |               |                        |  CoA Request  |
       |               |                     6.1|<--------------|
       |               | Update session on UP   |               |
       |            6.2|<--------via Ci-------->|               |
       |               |                        |  CoA Response |
       |  Offline Req  |                     6.3|-------------->|
    7.1|-------------->|                        |               |
       |               | Relay the Offline Req  |               |
       |            7.2|------to CP via Si----->|               |
       |               |                        |               |
       |               | Send the Offline Rep   |               |
       |            7.3|<-----to UP via Si------|               |
       |  Offline Rep  |                        |               |
    7.4|<--------------|                        |               |
       |               | Delete session on UP   |               |
       |            7.5|<--------via Ci-------->|               |
       |               |                        |               |
       |               |      Event report      |               |
       |              8|---------via Ci-------->|               |
       |               |                        |               |
       |               | Data synchronization   |               |
       |              9|<--------via Ci-------->|               |
       |               |                        |               |
       |               | CGN address allocation |               |
       |             10|<--------via Ci-------->|               |
       |               |                        |               |
:::

[Figure 3](#figure-3){.selfRef}: [BNG CUPS Procedures
Overview](#name-bng-cups-procedures-overvie){.selfRef}
:::

\(1\)
:   S-CUSP session establishment: This is the first step of the BNG CUPS
    procedures. Once the Ci parameters are configured on a UP, it will
    start to set up S-CUSP sessions with the specified CPs. The detailed
    definition of S-CUSP session establishment can be found in [Section
    4.1.1](#sect-4.1.1){.xref}.[¶](#section-3.4-3.1){.pilcrow}

\(2\)
:   Board and interface report: Once the S-CUSP session is established
    between the UP and a CP, the UP will report status information on
    the boards and subscriber-facing interfaces of this UP to the CP. A
    board can also be called a Line/Service Process Unit (LPU/SPU) card.
    The subscriber-facing interfaces refer to the interfaces that
    connect the access network nodes (e.g., Optical Line Terminal (OLT),
    DSLAM, etc.). The CP can use this information to enable the
    Broadband Access Server (BAS) function (e.g., IPoE, PPPoE, etc.) on
    the specified interfaces. See Sections [4.2.1](#sect-4.2.1){.xref}
    and [7.10](#sect-7.10){.xref} for more details on resource
    reporting.[¶](#section-3.4-3.2){.pilcrow}

\(3\)
:   BAS function enable: To enable the BAS function on the specified
    interfaces of a UP.[¶](#section-3.4-3.3){.pilcrow}

\(4\)
:   Subscriber network route advertisement: The CP will allocate one or
    more IP address blocks to a UP. Each address block contains a series
    of IP addresses. Those IP addresses will be allocated to subscribers
    who are dialing up from the UP. To enable other nodes in the network
    to learn how to reach the subscribers, the CP needs to notify the UP
    to advertise to the network the routes that can reach those IP
    addresses.[¶](#section-3.4-3.4){.pilcrow}

\(5\)
:   5.1-5.6 is a complete call flow of a subscriber dial-up (as defined
    in [Section 4.3.1](#sect-4.3.1){.xref}) process. When a UP receives
    a dial-up request, it will relay the request packet to a CP through
    the Si. The CP will parse the request. If everything is OK, it will
    send an authentication request to the AAA server to authenticate the
    subscriber. Once the subscriber passes the authentication, the AAA
    server will return a positive response to the CP. Then the CP will
    send the dial-up response packet to the UP, and the UP will forward
    the response packet to the subscriber (RG). At the same time, the CP
    will create a subscriber session on the UP, enabling the subscriber
    to access the network. For different access types, the process may
    be a bit different, but the high-level process is similar. For each
    access type, the detailed process can be found in [Section
    5](#sect-5){.xref}.[¶](#section-3.4-3.5){.pilcrow}

\(6\)
:   6.1-6.3 is the sequence when updating an existing subscriber
    session. The AAA server initiates a Change of Authorization (CoA)
    and sends the CoA to the CP. The CP will then update the session
    according to the CoA. See [Section 4.3.2](#sect-4.3.2){.xref} for
    more detail on CP messages updating UP
    tables.[¶](#section-3.4-3.6){.pilcrow}

\(7\)
:   7.1-7.5 is the sequence for deleting an existing subscriber session.
    When a UP receives an Offline Request, it will relay the request to
    a CP through the Si. The CP will send back a response to the UP
    through the Si. The UP will then forward the Offline Response to the
    subscriber. Then the CP will delete the session on the UP through
    the Ci.[¶](#section-3.4-3.7){.pilcrow}

\(8\)

:   Event reports include the following two parts (more detail can be
    found in [Section 4.3.4](#sect-4.3.4){.xref}). Both are reported
    using the Event message:[¶](#section-3.4-3.8.1){.pilcrow}

    -   [8.1. Subscriber Traffic Statistics
        Report[¶](#section-3.4-3.8.2.1){.pilcrow}]{#section-3.4-3.8.2.1}
    -   [8.2. Subscriber Detection Result
        Report[¶](#section-3.4-3.8.2.2){.pilcrow}]{#section-3.4-3.8.2.2}

\(9\)
:   Data synchronization: See [Section 4.2.5](#sect-4.2.5){.xref} for
    more detail on CP and UP
    synchronization.[¶](#section-3.4-3.9){.pilcrow}

\(10\)
:   CGN address allocation: See [Section 4.2.4](#sect-4.2.4){.xref} for
    more detail on CGN address
    allocation.[¶](#section-3.4-3.10){.pilcrow}
:::
:::
:::
:::

::: {#sect-4}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [S-CUSP Protocol Overview](#name-s-cusp-protocol-overview){.section-name .selfRef} {#name-s-cusp-protocol-overview}

::: {#sect-4.1}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Control Channel Procedures](#name-control-channel-procedures){.section-name .selfRef} {#name-control-channel-procedures}

::: {#sect-4.1.1}
::: {#section-4.1.1 .section}
#### [4.1.1.](#section-4.1.1){.section-number .selfRef} [S-CUSP Session Establishment](#name-s-cusp-session-establishmen){.section-name .selfRef} {#name-s-cusp-session-establishmen}

A UP is associated with a CP and is controlled by that CP. In the case
of a hot-standby or cold-standby, a UP is associated with two CPs: the
master CP and standby CP. The association between a UP and its CPs is
implemented by dynamic configuration.[¶](#section-4.1.1-1){.pilcrow}

Once a UP knows its CPs, the UP starts to establish S-CUSP sessions with
those CPs, as shown in [Figure
4](#fig4){.xref}.[¶](#section-4.1.1-2){.pilcrow}

[]{#name-s-cusp-session-establishment}

::: {#fig4}
::: {#section-4.1.1-3.1 .artwork .art-text .alignLeft}
                     UP                               CP
                     |   TCP Session Establishment     |
                     |<------------------------------->|
                     |                                 |
                     |   Hello (version, capability)   |
                     |-------------------------------->|
                     |                                 |
                     |   Hello (version, capability)   |
                     |<--------------------------------|
                     |                                 |
:::

[Figure 4](#figure-4){.selfRef}: [S-CUSP Session
Establishment](#name-s-cusp-session-establishment){.selfRef}
:::

The S-CUSP session establishment consists of two successive
steps:[¶](#section-4.1.1-4){.pilcrow}

\(1\)
:   Establishment of a TCP connection (3-way handshake)
    \[[RFC793](#RFC0793){.xref}\] between the CP and the UP using a
    configured port from the dynamic port range
    (49152-65535).[¶](#section-4.1.1-5.1){.pilcrow}

\(2\)
:   Establishment of an S-CUSP session over the TCP
    connection.[¶](#section-4.1.1-5.2){.pilcrow}

Once the TCP connection is established, the CP and the UP initialize the
S-CUSP session, during which the version and Keepalive timers are
negotiated.[¶](#section-4.1.1-6){.pilcrow}

The version information (Hello TLV, see [Section 7.4](#sect-7.4){.xref})
is carried within Hello messages (see [Section
6.2.1](#sect-6.2.1){.xref}). A CP can support multiple versions, but a
UP can only support one version; thus the version negotiation is based
on whether a version can be supported by both the CP and the UP. If a CP
or UP receives a Hello message that does not indicate a version
supported by both, it responds with a Hello message containing an Error
Information TLV to notify the peer of the Version-Mismatch error, and
the session establishment phase fails.[¶](#section-4.1.1-7){.pilcrow}

Keepalive negotiation is performed by carrying a Keepalive TLV in the
Hello message. The Keepalive TLV includes a Keepalive timer and
DeadTimer field. The CP and UP have to agree on the Keepalive Timer and
DeadTimer. Otherwise, a subsequent Hello message with an Error
Information TLV will be sent to its peer, and the session establishment
phase fails.[¶](#section-4.1.1-8){.pilcrow}

The S-CUSP session establishment phase fails if the CP or UP disagree on
the version and keepalive parameters or if one of the CP or UP does not
answer after the expiration of the Establishment timer. When the S-CUSP
session establishment fails, the TCP connection is promptly closed.
Successive retries are permitted, but an implementation [SHOULD]{.bcp14}
make use of an exponential backoff session establishment retry
procedure.[¶](#section-4.1.1-9){.pilcrow}

The S-CUSP session timer values that need to be configured are
summarized in [Table
1](#tab-sess-timers){.xref}.[¶](#section-4.1.1-10){.pilcrow}

[]{#name-s-cusp-session-timers}

::: {#tab-sess-timers}
  Timer Name            Range in Seconds   Default Value
  --------------------- ------------------ ----------------
  Establishment Timer   1-32767            45
  Keepalive Timer       0-255              30
  DeadTimer             1-32767            4 \* Keepalive

  : [Table 1](#table-1){.selfRef}: [S-CUSP Session
  Timers](#name-s-cusp-session-timers){.selfRef}
:::
:::
:::

::: {#sect-4.1.2}
::: {#section-4.1.2 .section}
#### [4.1.2.](#section-4.1.2){.section-number .selfRef} [Keepalive Timer and DeadTimer](#name-keepalive-timer-and-deadtim){.section-name .selfRef} {#name-keepalive-timer-and-deadtim}

Once an S-CUSP session has been established, a UP or CP may want to know
that its S-CUSP peer is still connected.[¶](#section-4.1.2-1){.pilcrow}

Each end of an S-CUSP session runs a Keepalive timer. It restarts the
timer every time it sends a message on the session. When the timer
expires, it sends a Keepalive message. Thus, a message is transmitted at
least as often as the value to which the Keepalive timer is reset,
unless, as explained below, that value is the special value
zero.[¶](#section-4.1.2-2){.pilcrow}

Each end of an S-CUSP session also runs a DeadTimer and restarts that
DeadTimer whenever a message is received on the session. If the
DeadTimer expires at an end of the session, that end declares the
session dead and the session will be closed, unless their DeadTimer is
set to the special value zero, in which case the session will not time
out.[¶](#section-4.1.2-3){.pilcrow}

The minimum value of the Keepalive timer is 1 second, and it is
specified in units of 1 second. The [RECOMMENDED]{.bcp14} default value
is 30 seconds. The recommended default for the DeadTimer is four times
the value of the Keepalive timer used by the remote peer. As above, the
timers may be disabled by setting them to
zero.[¶](#section-4.1.2-4){.pilcrow}

The Keepalive timer and DeadTimer are negotiated through the Keepalive
TLV carried in the Hello message.[¶](#section-4.1.2-5){.pilcrow}
:::
:::
:::
:::

::: {#sect-4.2}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Node Procedures](#name-node-procedures){.section-name .selfRef} {#name-node-procedures}

::: {#sect-4.2.1}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [UP Resource Report](#name-up-resource-report){.section-name .selfRef} {#name-up-resource-report}

Once an S-CUSP session has been established between a CP and a UP, the
UP reports the state information of the boards and access-facing
interfaces on the UP to the CP, as shown in [Figure 5](#fig5){.xref}.
Report messages are unacknowledged and are assumed to be delivered
because the session runs over TCP.[¶](#section-4.2.1-1){.pilcrow}

The CP can use that information to activate/enable the BAS functions
(e.g., IPoE, PPPoE, etc.) on the specified
interfaces.[¶](#section-4.2.1-2){.pilcrow}

In addition, the UP resource report may trigger a UP warm-standby
process. In the case of warm-standby, a failure on a UP may trigger the
CP to start a warm-standby process, by moving the online subscriber
sessions to a standby UP and then directing the affected subscribers to
access the Internet through the standby
UP.[¶](#section-4.2.1-3){.pilcrow}

[]{#name-up-board-and-interface-repo}

::: {#fig5}
::: {#section-4.2.1-4.1 .artwork .art-text .alignLeft}
                         UP                      CP
                         |  Report Board Status   |
                         |------to CP via Ci----->|
                         |                        |
                         | Report Interface Status|
                         |------to CP via Ci----->|
                         |                        |
:::

[Figure 5](#figure-5){.selfRef}: [UP Board and Interface
Report](#name-up-board-and-interface-repo){.selfRef}
:::

Board status information is carried in the Board Status TLV ([Section
7.10.2](#sect-7.10.2){.xref}), and interface status information is
carried in the Interface Status TLV ([Section
7.10.1](#sect-7.10.1){.xref}). Both Board Status and Interface Status
TLVs are carried in the Report message ([Section
6.4](#sect-6.4){.xref}).[¶](#section-4.2.1-5){.pilcrow}
:::
:::

::: {#sect-4.2.2}
::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [Update BAS Function on Access Interface](#name-update-bas-function-on-acce){.section-name .selfRef} {#name-update-bas-function-on-acce}

Once the CP collects the interface status of a UP, it will
activate/deactivate/modify the BAS functions on specified interfaces
through the Update_Request and Update_Response message exchanges
([Section 6.2](#sect-6.2){.xref}), carrying the BAS Function TLV
([Section 7.7](#sect-7.7){.xref}).[¶](#section-4.2.2-1){.pilcrow}

[]{#name-update-bas-function}

::: {#fig6}
::: {#section-4.2.2-2.1 .artwork .art-text .alignLeft}
                         UP                       CP
                         |   Update BAS Function   |
                         |         Request         |
                         |<-----on UP via Ci-------|
                         |                         |
                         |   Update BAS Function   |
                         |         Response        |
                         |------on UP via Ci------>|
                         |                         |
:::

[Figure 6](#figure-6){.selfRef}: [Update BAS
Function](#name-update-bas-function){.selfRef}
:::
:::
:::

::: {#sect-4.2.3}
::: {#section-4.2.3 .section}
#### [4.2.3.](#section-4.2.3){.section-number .selfRef} [Update Network Routing](#name-update-network-routing){.section-name .selfRef} {#name-update-network-routing}

The CP will allocate one or more address blocks to a UP. Each address
block contains a series of IP addresses. Those IP addresses will be
assigned to subscribers who are dialing up to the UP. To enable the
other nodes in the network to learn how to reach the subscribers, the CP
needs to install the routes on the UP and notify the UP to advertise the
routes to the network.[¶](#section-4.2.3-1){.pilcrow}

[]{#name-update-network-routing-2}

::: {#fig7}
::: {#section-4.2.3-2.1 .artwork .art-text .alignLeft}
                         UP                       CP
                         | Subscriber network route|
                         |      update request     |
                         |<------- via Ci----------|
                         |                         |
                         | Subscriber network route|
                         |      update response    |
                         |-------- via Ci--------->|
                         |                         |
:::

[Figure 7](#figure-7){.selfRef}: [Update Network
Routing](#name-update-network-routing-2){.selfRef}
:::

The Update_Request and Update_Response message exchanges, carrying the
IPv4/IPv6 Routing TLVs ([Section 7.8](#sect-7.8){.xref}), update the
subscriber\'s network routing
information.[¶](#section-4.2.3-3){.pilcrow}
:::
:::

::: {#sect-4.2.4}
::: {#section-4.2.4 .section}
#### [4.2.4.](#section-4.2.4){.section-number .selfRef} [CGN Public IP Address Allocation](#name-cgn-public-ip-address-alloc){.section-name .selfRef} {#name-cgn-public-ip-address-alloc}

The following sequences ([Figure 8](#fig8){.xref}) describe the
procedures related to CGN address management. Three independent
procedures are defined: one each for CGN address allocation
request/response, CGN address renewal request/response, and CGN address
release request/response.[¶](#section-4.2.4-1){.pilcrow}

CGN address allocation/renew/release procedures are designed for the
case where the CGN function is running on the UP. The UP has to map the
subscriber private IP addresses to public IP addresses, and such mapping
is performed by the UP locally when a subscriber dials up. That means
the UP has to ask for public IPv4 address blocks for CGN subscribers
from the CP.[¶](#section-4.2.4-2){.pilcrow}

In addition, when a public IP address is allocated to a UP, there will
be a lease time (e.g., one day). Before the lease time expires, the UP
can ask for renewal of the IP address lease from the CP. It is achieved
by the exchange of the Addr_Renew_Req and Addr_Renew_Ack
messages.[¶](#section-4.2.4-3){.pilcrow}

If the public IP address will not be used anymore, the UP
[SHOULD]{.bcp14} release the address by sending an Addr_Release_Req
message to the CP.[¶](#section-4.2.4-4){.pilcrow}

If the CP wishes to withdraw addresses that it has previously leased to
a UP, it uses the same procedures as above. The Oper code (see [Section
7.1](#sect-7.1){.xref}) in the IPv4/IPv6 Routing TLV (see [Section
7.8](#sect-7.8){.xref}) determines whether the request is an update or
withdraw.[¶](#section-4.2.4-5){.pilcrow}

The relevant messages are defined in [Section
6.5](#sect-6.5){.xref}.[¶](#section-4.2.4-6){.pilcrow}

[]{#name-cgn-public-ip-address-alloca}

::: {#fig8}
::: {#section-4.2.4-7.1 .artwork .art-text .alignLeft}
                     UP                       CP
                     | CGN Address Allocation  |
                     |         Request         |
                  1.1|-------- via Ci--------->|
                     | CGN Address Allocation  |
                     |         Response        |
                  1.2|<------- via Ci----------|
                     |                         |
                     | CGN Address Renew       |
                     |         Request         |
                  2.1|-------- via Ci--------->|
                     | CGN Address Renew       |
                     |         Response        |
                  2.2|<------- via Ci----------|
                     |                         |
                     | CGN Address Release     |
                     |         Request         |
                  3.1|-------- via Ci--------->|
                     | CGN Address Release     |
                     |         Response        |
                  3.3|<------- via Ci----------|
                     |                         |
:::

[Figure 8](#figure-8){.selfRef}: [CGN Public IP Address
Allocation](#name-cgn-public-ip-address-alloca){.selfRef}
:::
:::
:::

::: {#sect-4.2.5}
::: {#section-4.2.5 .section}
#### [4.2.5.](#section-4.2.5){.section-number .selfRef} [Data Synchronization between the CP and UP](#name-data-synchronization-betwee){.section-name .selfRef} {#name-data-synchronization-betwee}

For a CU-separated BNG, the UP will continue to function using the state
that has been installed in it even if the CP fails or the session
between the UP and CP fails.[¶](#section-4.2.5-1){.pilcrow}

Under some circumstances, it is necessary to synchronize state between
the CP and UP, for example, if a CP fails and the UP is switched to a
different CP.[¶](#section-4.2.5-2){.pilcrow}

Synchronization includes two directions. One direction is from UP to CP;
in that case, the synchronization information is mainly about the
board/interface status of the UP. The other direction is from CP to UP;
in that case, the subscriber sessions, subscriber network routes, L2TP
tunnels, etc., will be synchronized to the
UP.[¶](#section-4.2.5-3){.pilcrow}

The synchronization is triggered by a Sync_Request message, to which the
receiver will (1) reply with a Sync_Begin message to notify the
requester that synchronization will begin and (2) then start the
synchronization using the Sync_Data message. When synchronization
finishes, a Sync_End message will be
sent.[¶](#section-4.2.5-4){.pilcrow}

[Figure 9](#fig9){.xref} shows the process of data synchronization
between a UP and a CP.[¶](#section-4.2.5-5){.pilcrow}

[]{#name-data-synchronization}

::: {#fig9}
::: {#section-4.2.5-6.1 .artwork .art-text .alignLeft}
                         UP                       CP
                         | Synchronization Request |
                         |<------- via Ci----------|
                         |                         |
                         | Synchronization Begin   |
                         |-------- via Ci--------->|
                         |                         |
                         | Board/Interface Report  |
                         |-------- via Ci--------->|
                         |                         |
                         | Synchronization End     |
                         |-------- via Ci--------->|
                         |                         |
                        1) Synchronization from UP to CP

                         UP                       CP
                         | Synchronization Request |
                         |-------- via Ci--------->|
                         |                         |
                         | Synchronization Begin   |
                         |<-------- via Ci---------|
                         |                         |
                         |      Synchronizes       |
                         |Subscriber Session States|
                         |  Network Route Entries  |
                         |<------- via Ci----------|
                         |                         |
                         | Synchronization End     |
                         |<-------- via Ci---------|
                         |                         |
                        2) Synchronization from CP to UP
:::

[Figure 9](#figure-9){.selfRef}: [Data
Synchronization](#name-data-synchronization){.selfRef}
:::
:::
:::
:::
:::

::: {#sect-4.3}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Subscriber Session Procedures](#name-subscriber-session-procedur){.section-name .selfRef} {#name-subscriber-session-procedur}

A subscriber session consists of a set of forwarding states, policies,
and security rules that are applied to the subscriber. It is used for
forwarding subscriber traffic in a UP. To initialize a session on a UP,
a collection of hardware resources (e.g., NP, TCAM, etc.) has to be
allocated to a session on a UP as part of its
initiation.[¶](#section-4.3-1){.pilcrow}

Procedures related to subscriber sessions include subscriber session
creation, update, deletion, and statistics reporting. The following
subsections give a high-level view of the
procedures.[¶](#section-4.3-2){.pilcrow}

::: {#sect-4.3.1}
::: {#section-4.3.1 .section}
#### [4.3.1.](#section-4.3.1){.section-number .selfRef} [Create Subscriber Session](#name-create-subscriber-session){.section-name .selfRef} {#name-create-subscriber-session}

The sequence below ([Figure 10](#fig10){.xref}) describes the DHCP IPv4
dial-up process. It is an example that shows how a subscriber session is
created. (An example for IPv6 appears in [Section
5.1.2](#sect-5.1.2){.xref}.)[¶](#section-4.3.1-1){.pilcrow}

[]{#name-creating-a-subscriber-sessi}

::: {#fig10}
::: {#section-4.3.1-2.1 .artwork .art-text .alignLeft}
         RG              UP                       CP             AAA
         | Online Request|                        |               |
        1|-------------->|                        |               |
         |               |Relay the Online Request|               |
         |              2|-----to CP via Si------>| Authentication|
         |               |                        |    Req/Rep    |
         |               |                       3|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              4|<--------via Ci---------|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              5|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                       6|<------------->|
         |               |  Send Online Response  |               |
         |              7|<----to UP via Si-------|               |
         |               |                        |               |
         |Online Response|                        |               |
        8|<--------------|                        |               |
         |               |                        |               |
:::

[Figure 10](#figure-10){.selfRef}: [Creating a Subscriber
Session](#name-creating-a-subscriber-sessi){.selfRef}
:::

The request starts from an Online Request message (step 1) from the RG
(for example, a DHCP Discovery packet). When the UP receives the Online
Request from the RG, it will tunnel the Online Request to the CP through
the Si (step 2). A tunneling technology implements the
Si.[¶](#section-4.3.1-3){.pilcrow}

When the CP receives the Online Request from the UP, it will send an
authentication request to the AAA server to authenticate and authorize
the subscriber (step 3). When a positive reply is received from the AAA
server, the CP starts to create a subscriber session for the request.
Relevant resources (e.g., IP address, bandwidth, etc.) will be allocated
to the subscriber. Policies and security rules will be generated for the
subscriber. Then the CP sends a request to create a session to the UP
through the Ci (step 4), and a response is expected from the UP to
confirm the creation (step 5).[¶](#section-4.3.1-4){.pilcrow}

Finally, the CP will notify the AAA server to start accounting (step 6).
At the same time, an Online Response message (for example, a DHCP Ack
packet) will be sent to the UP through the Si (step 7). The UP will then
forward the Online Response to the RG (step
8).[¶](#section-4.3.1-5){.pilcrow}

That completes the subscriber activation
process.[¶](#section-4.3.1-6){.pilcrow}
:::
:::

::: {#sect-4.3.2}
::: {#section-4.3.2 .section}
#### [4.3.2.](#section-4.3.2){.section-number .selfRef} [Update Subscriber Session](#name-update-subscriber-session){.section-name .selfRef} {#name-update-subscriber-session}

The following numbered sequence ([Figure 11](#fig11){.xref}) shows the
process of updating the subscriber
session.[¶](#section-4.3.2-1){.pilcrow}

[]{#name-updating-a-subscriber-sessi}

::: {#fig11}
::: {#section-4.3.2-2.1 .artwork .art-text .alignLeft}
                UP                       CP             AAA
                |                        |  CoA Request  |
                |                       1|<--------------|
                | Session Update Request |               |
               2|<--------via Ci---------|               |
                |                        |               |
                | Session Update Response|               |
               3|---------via Ci-------->|               |
                |                        |  CoA Response |
                |                       4|-------------->|
                |                        |               |
:::

[Figure 11](#figure-11){.selfRef}: [Updating a Subscriber
Session](#name-updating-a-subscriber-sessi){.selfRef}
:::

When a subscriber session has been created on a UP, there may be
requirements to update the session with new parameters (e.g., bandwidth,
QoS, policies, etc.).[¶](#section-4.3.2-3){.pilcrow}

This procedure is triggered by a Change of Authorization (CoA) request
message sent by the AAA server. The CP will update the session on the UP
according to the new parameters through the
Ci.[¶](#section-4.3.2-4){.pilcrow}
:::
:::

::: {#sect-4.3.3}
::: {#section-4.3.3 .section}
#### [4.3.3.](#section-4.3.3){.section-number .selfRef} [Delete Subscriber Session](#name-delete-subscriber-session){.section-name .selfRef} {#name-delete-subscriber-session}

The call flow below shows how S-CUSP deals with a subscriber Offline
Request.[¶](#section-4.3.3-1){.pilcrow}

[]{#name-deleting-a-subscriber-sessi}

::: {#fig12}
::: {#section-4.3.3-2.1 .artwork .art-text .alignLeft}
               RG               UP                       CP
                |Offline Request |                        |
               1|--------------->|                        |
                |                |    Relay the Offline   |
                |                |        Request         |
                |               2|------to CP via Si----->|
                |                |                        |
                |                |    Send the Offline    |
                |                |        Response        |
                |               3|<-----to UP via Si------|
                |Offline Response|                        |
               4|<---------------|                        |
                |                |     Session Delete     |
                |                |        Request         |
                |                |<--------via Ci---------|
                |                |     Session Delete     |
                |                |       Response         |
                |                |---------via Ci-------->|
                |                |                        |
:::

[Figure 12](#figure-12){.selfRef}: [Deleting a Subscriber
Session](#name-deleting-a-subscriber-sessi){.selfRef}
:::

Similar to the session creation process, when a UP receives an Offline
Request from an RG, it will tunnel the request to a CP through the
Si.[¶](#section-4.3.3-3){.pilcrow}

When the CP receives the Offline Request, it will withdraw/release the
resources (e.g., IP address, bandwidth) that have been allocated to the
subscriber. It then sends a reply to the UP through the Si, and the UP
will forward the reply to the RG. At the same time, it will delete all
the status of the session on the UP through the
Ci.[¶](#section-4.3.3-4){.pilcrow}
:::
:::

::: {#sect-4.3.4}
::: {#section-4.3.4 .section}
#### [4.3.4.](#section-4.3.4){.section-number .selfRef} [Subscriber Session Events Report](#name-subscriber-session-events-r){.section-name .selfRef} {#name-subscriber-session-events-r}

[]{#name-events-report}

::: {#fig13}
::: {#section-4.3.4-1.1 .artwork .art-text .alignLeft}
                         UP                       CP
                         | Statistic/Detect Report|
                         |---------via Ci-------->|
                         |                        |
:::

[Figure 13](#figure-13){.selfRef}: [Events
Report](#name-events-report){.selfRef}
:::

When a session is created on a UP, the UP will periodically report
statistics information and subscriber detection results of the session
to the CP.[¶](#section-4.3.4-2){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#sect-5}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [S-CUSP Call Flows](#name-s-cusp-call-flows){.section-name .selfRef} {#name-s-cusp-call-flows}

The subsections below give an overview of various \"dial-up\"
interactions over the Si followed by an overview of the setting of
information in the UP by the CP using S-CUSP over the
Ci.[¶](#section-5-1){.pilcrow}

S-CUSP messages are described in this document using Routing Backus Naur
Form (RBNF) as defined in
\[[RFC5511](#RFC5511){.xref}\].[¶](#section-5-2){.pilcrow}

::: {#sect-5.1}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [IPoE](#name-ipoe){.section-name .selfRef} {#name-ipoe}

::: {#sect-5.1.1}
::: {#section-5.1.1 .section}
#### [5.1.1.](#section-5.1.1){.section-number .selfRef} [DHCPv4 Access](#name-dhcpv4-access){.section-name .selfRef} {#name-dhcpv4-access}

The following sequence ([Figure 14](#fig14){.xref}) shows detailed
procedures for DHCPv4 access.[¶](#section-5.1.1-1){.pilcrow}

[]{#name-dhcpv4-access-2}

::: {#fig14}
::: {#section-5.1.1-2.1 .artwork .art-text .alignLeft}
         RG              UP                       CP             AAA
         | DHCP Discovery|                        |               |
        1|-------------->|                        |               |
         |               |Relay the DHCP Discovery|               |
         |              2|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                       3|<------------->|
         |               |  Send the DHCP Offer   |               |
         |              4|<----to UP via Si-------|               |
         |  DHCP Offer   |                        |               |
        5|<--------------|                        |               |
         |  DHCP Request |                        |               |
        6|-------------->|                        |               |
         |               | Relay the DHCP Request |               |
         |              7|-----to CP via Si------>|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              8|<--------via Ci---------|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              9|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      10|<------------->|
         |               |  Send DHCP ACK         |               |
         |             11|<----to UP via Si-------|               |
         |               |                        |               |
         |  DHCP ACK     |                        |               |
       12|<--------------|                        |               |
         |               |                        |               |
:::

[Figure 14](#figure-14){.selfRef}: [DHCPv4
Access](#name-dhcpv4-access-2){.selfRef}
:::

S-CUSP implements steps 8 and 9.[¶](#section-5.1.1-3){.pilcrow}

After a subscriber is authenticated and authorized by the AAA server,
the CP creates a new subscriber session on the UP. This is achieved by
sending an Update_Request message to the
UP.[¶](#section-5.1.1-4){.pilcrow}

The format of the Update_Request message is shown as follows using
RBNF:[¶](#section-5.1.1-5){.pilcrow}

::: {#section-5.1.1-6}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]
```

[¶](#section-5.1.1-6){.pilcrow}
:::

The UP will reply with an Update_Response message. The format of the
Update_Response message is as follows:[¶](#section-5.1.1-7){.pilcrow}

::: {#section-5.1.1-8}
``` {.sourcecode .lang-rbnf}
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.1.1-8){.pilcrow}
:::
:::
:::

::: {#sect-5.1.2}
::: {#section-5.1.2 .section}
#### [5.1.2.](#section-5.1.2){.section-number .selfRef} [DHCPv6 Access](#name-dhcpv6-access){.section-name .selfRef} {#name-dhcpv6-access}

The following sequence ([Figure 15](#fig15){.xref}) shows detailed
procedures for DHCPv6 access.[¶](#section-5.1.2-1){.pilcrow}

[]{#name-dhcpv6-access-2}

::: {#fig15}
::: {#section-5.1.2-2.1 .artwork .art-text .alignLeft}
         RG              UP                       CP             AAA
         |  Solicit      |                        |               |
        1|-------------->|                        |               |
         |               |  Relay the Solicit     |               |
         |              2|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                       3|<------------->|
         |               |  Send the Advertise    |               |
         |              4|<----to UP via Si-------|               |
         |  Advertise    |                        |               |
        5|<--------------|                        |               |
         |               |                        |               |
         |  Request      |                        |               |
        6|-------------->|                        |               |
         |               |  Relay the Request     |               |
         |              7|-----to CP via Si------>|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              8|<--------via Ci-------->|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              9|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      10|<------------->|
         |               |  Send Reply            |               |
         |             11|<----to UP via Si-------|               |
         |  Reply        |                        |               |
       12|<--------------|                        |               |
         |               |                        |               |
:::

[Figure 15](#figure-15){.selfRef}: [DHCPv6
Access](#name-dhcpv6-access-2){.selfRef}
:::

Steps 1-7 are a standard DHCP IPv6 access process. The subscriber
creation is triggered by a DHCP IPv6 request message. When this message
is received, it means that the subscriber has passed the AAA
authentication and authorization. Then the CP will create a subscriber
session on the UP. This is achieved by sending an Update_Request message
to the UP (step 8).[¶](#section-5.1.2-3){.pilcrow}

The format of the Update_Request message is as
follows:[¶](#section-5.1.2-4){.pilcrow}

::: {#section-5.1.2-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
```

[¶](#section-5.1.2-5){.pilcrow}
:::

The UP will reply with an Update_Response message (step 9). The format
of the Update_Response message is as
follows:[¶](#section-5.1.2-6){.pilcrow}

::: {#section-5.1.2-7}
``` {.sourcecode .lang-rbnf}
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.1.2-7){.pilcrow}
:::
:::
:::

::: {#sect-5.1.3}
::: {#section-5.1.3 .section}
#### [5.1.3.](#section-5.1.3){.section-number .selfRef} [IPv6 Stateless Address Autoconfiguration (SLAAC) Access](#name-ipv6-stateless-address-auto){.section-name .selfRef} {#name-ipv6-stateless-address-auto}

The following flow ([Figure 16](#fig16){.xref}) shows the IPv6 SLAAC
access process.[¶](#section-5.1.3-1){.pilcrow}

[]{#name-ipv6-slaac-access}

::: {#fig16}
::: {#section-5.1.3-2.1 .artwork .art-text .alignLeft}
         RG              UP                       CP             AAA
         |      RS       |                        |               |
        1|-------------->|                        |               |
         |               |  Relay the Router      |               |
         |               |    Solicit (RS)        |               |
         |              2|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                       3|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              4|<--------via Ci---------|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              5|---------via Ci-------->|               |
         |               |                        |               |
         |               |  Send Router Advertise |               |
         |               |         (RA)           |               |
         |              6|<----to UP via Si-------|               |
         |      RA       |                        |               |
        7|<--------------|                        |               |
         |               |                        |               |
         |      NS       |                        |               |
        8|-------------->|                        |               |
         |               |  Relay the Neighbor    |               |
         |               |     Solicit (NS)       |               |
         |              9|-----to CP via Si------>|               |
         |               |                        |   Accounting  |
         |               |                      10|<------------->|
         |               |  Send a Neighbor       |               |
         |               |     Advertise (NA)     |               |
         |             11|<----to UP via Si-------|               |
         |      NA       |                        |               |
       12|<--------------|                        |               |
         |               |                        |               |
:::

[Figure 16](#figure-16){.selfRef}: [IPv6 SLAAC
Access](#name-ipv6-slaac-access){.selfRef}
:::

It starts with a Router Solicit (RS) request from an RG that is tunneled
to the CP by the UP. After the AAA authentication and authorization, the
CP will create a subscriber session on the
UP.[¶](#section-5.1.3-3){.pilcrow}

This is achieved by sending an Update_Request message to the UP (step
4).[¶](#section-5.1.3-4){.pilcrow}

The format of the Update_Request message is as
follows:[¶](#section-5.1.3-5){.pilcrow}

::: {#section-5.1.3-6}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
```

[¶](#section-5.1.3-6){.pilcrow}
:::

The UP will reply with an Update_Response message (step 5). The format
of the Update_Response message is as
follows:[¶](#section-5.1.3-7){.pilcrow}

::: {#section-5.1.3-8}
``` {.sourcecode .lang-rbnf}
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.1.3-8){.pilcrow}
:::
:::
:::

::: {#sect-5.1.4}
::: {#section-5.1.4 .section}
#### [5.1.4.](#section-5.1.4){.section-number .selfRef} [DHCPv6 and SLAAC Access](#name-dhcpv6-and-slaac-access){.section-name .selfRef} {#name-dhcpv6-and-slaac-access}

The following call flow ([Figure 17](#fig17){.xref}) shows the DHCP IPv6
and SLAAC access process.[¶](#section-5.1.4-1){.pilcrow}

[]{#name-dhcpv6-and-slaac-access-2}

::: {#fig17}
::: {#section-5.1.4-2.1 .artwork .art-text .alignLeft}
         RG              UP                       CP             AAA
         |      RS       |                        |               |
        1|-------------->|                        |               |
         |               |  Relay the RS          |               |
         |              2|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                       3|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              4|<--------via Ci---------|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              5|---------via Ci-------->|               |
         |               |                        |               |
         |               |  Send RA               |               |
         |              6|<----to UP via Si-------|               |
         |      RA       |                        |               |
        7|<--------------|                        |               |
         |               |                        |               |
         |DHCPv6 Solicit |                        |               |
        8|-------------->|                        |               |
         |               |  Relay DHCPv6 Solicit  |               |
         |              9|-----to CP via Si------>|               |
         |               |                        |               |
         |               |  Update Subscriber     |               |
         |               |   Session Request      |               |
         |             10|<--------via Ci---------|               |
         |               |                        |               |
         |               |  Update Subscriber     |               |
         |               |   Session Response     |               |
         |             11|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      12|<------------->|
         |               |  Send DHCPv6 Reply     |               |
         |             13|<----to UP via Si-------|               |
         |               |                        |               |
         | DHCPv6 Reply  |                        |               |
       14|<--------------|                        |               |
         |               |                        |               |
:::

[Figure 17](#figure-17){.selfRef}: [DHCPv6 and SLAAC
Access](#name-dhcpv6-and-slaac-access-2){.selfRef}
:::

When a subscriber passes AAA authentication, the CP will create a
subscriber session on the UP. This is achieved by sending an
Update_Request message to the UP (step
4).[¶](#section-5.1.4-3){.pilcrow}

::: {#section-5.1.4-4}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
```

[¶](#section-5.1.4-4){.pilcrow}
:::

The UP will reply with an Update_Response message (step 5). The format
of the Update_Response is as follows:[¶](#section-5.1.4-5){.pilcrow}

::: {#section-5.1.4-6}
``` {.sourcecode .lang-rbnf}
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.1.4-6){.pilcrow}
:::

After receiving a DHCPv6 Solicit, the CP will update the subscriber
session by sending an Update_Request message with new parameters to the
UP (step 10).[¶](#section-5.1.4-7){.pilcrow}

The format of the Update_Request message is as
follows:[¶](#section-5.1.4-8){.pilcrow}

::: {#section-5.1.4-9}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]
```

[¶](#section-5.1.4-9){.pilcrow}
:::

The UP will reply with an Update_Response message (step 11). The format
of the Update_Response is as follows:[¶](#section-5.1.4-10){.pilcrow}

::: {#section-5.1.4-11}
``` {.sourcecode .lang-rbnf}
<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.1.4-11){.pilcrow}
:::
:::
:::

::: {#sect-5.1.5}
::: {#section-5.1.5 .section}
#### [5.1.5.](#section-5.1.5){.section-number .selfRef} [DHCP Dual-Stack Access](#name-dhcp-dual-stack-access){.section-name .selfRef} {#name-dhcp-dual-stack-access}

The following sequence ([Figure 18](#fig18){.xref}) is a combination of
DHCP IPv4 and DHCP IPv6 access processes.[¶](#section-5.1.5-1){.pilcrow}

[]{#name-dhcp-dual-stack-access-2}

::: {#fig18}
::: {#section-5.1.5-2.1 .artwork .art-text .alignLeft}
         RG              UP                       CP             AAA
         | DHCP Discovery|                        |               |
        1|-------------->|                        |               |
         |               |Relay the DHCP Discovery|               |
         |              2|-----to CP via Si------>|     AAA       |
         |               |                        |   Req/Resp    |
         |               |                       3|<------------->|
         |               |  Send the DHCP Offer   |               |
         |              4|<----to UP via Si-------|               |
         |  DHCP Offer   |                        |               |
        5|<--------------|                        |               |
         |  DHCP Request |                        |               |
        6|-------------->|                        |               |
         |               |  Relay the DHCP Request|               |
         |              7|-----to CP via Si------>|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              8|<--------via Ci-------->|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              9|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      10|<------------->|
         |               |  Send DHCP ACK         |               |
         |             11|<----to UP via Si-------|               |
         |  DHCP ACK     |                        |               |
       12|<--------------|                        |               |
         |      RS       |                        |               |
       13|-------------->|                        |               |
         |               |  Relay the RS          |               |
         |             14|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                      15|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |             16|<--------via Ci---------|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |             17|---------via Ci-------->|               |
         |               |                        |               |
         |               |  Send the RA           |               |
         |             18|<----to UP via Si-------|               |
         |      RA       |                        |               |
       19|<--------------|                        |               |
         |DHCPv6 Solicit |                        |               |
       20|-------------->|                        |               |
         |               |  Relay DHCPv6 Solicit  |               |
         |             21|-----to CP via Si------>|               |
         |               |                        |               |
         |               |  Update Subscriber     |               |
         |               |   Session Request      |               |
         |             22|<--------via Ci---------|               |
         |               |  Update Subscriber     |               |
         |               |   Session Response     |               |
         |             23|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      24|<------------->|
         |               |  Send DHCPv6 Reply     |               |
         |             25|<----to UP via Si-------|               |
         | DHCPv6 Reply  |                        |               |
       26|<--------------|                        |               |
         |               |                        |               |
:::

[Figure 18](#figure-18){.selfRef}: [DHCP Dual-Stack
Access](#name-dhcp-dual-stack-access-2){.selfRef}
:::

The DHCP dual-stack access includes three sets of
Update_Request/Update_Response exchanges to create/update a DHCPv4/v6
subscriber session.[¶](#section-5.1.5-3){.pilcrow}

\(1\)

:   Create a DHCPv4 session (steps 8 and
    9):[¶](#section-5.1.5-4.1.1){.pilcrow}

    ::: {#section-5.1.5-4.1.2}
    ``` {.sourcecode .lang-rbnf}
    <Update_Request Message> ::= <Common Header>
                      <Basic Subscriber TLV>
                      <IPv4 Subscriber TLV>
                      <IPv4 Routing TLV>
                      [<Subscriber Policy TLV>]

    <Update_Response Message> ::= <Common Header>
                     <Update Response TLV>
                     [<Subscriber CGN Port Range TLV>]
    ```

    [¶](#section-5.1.5-4.1.2){.pilcrow}
    :::

\(2\)

:   Create a DHCPv6 session (steps 16 and
    17):[¶](#section-5.1.5-4.2.1){.pilcrow}

    ::: {#section-5.1.5-4.2.2}
    ``` {.sourcecode .lang-rbnf}
    <Update_Request Message> ::= <Common Header>
                      <Basic Subscriber TLV>
                      <IPv6 Subscriber TLV>
                      <IPv6 Routing TLV>
                      [<Subscriber Policy TLV>]

    <Update_Response Message> ::= <Common Header>
                     <Update Response TLV>
    ```

    [¶](#section-5.1.5-4.2.2){.pilcrow}
    :::

\(3\)

:   Update DHCPv6 session (steps 22 and
    23):[¶](#section-5.1.5-4.3.1){.pilcrow}

    ::: {#section-5.1.5-4.3.2}
    ``` {.sourcecode .lang-rbnf}
    <Update_Request Message> ::= <Common Header>
                      <Basic Subscriber TLV>
                      <IPv6 Subscriber TLV>
                      <IPv6 Routing TLV>
                      [<Subscriber Policy TLV>]

    <Update_Response Message> ::= <Common Header>
                     <Update Response TLV>
    ```

    [¶](#section-5.1.5-4.3.2){.pilcrow}
    :::
:::
:::

::: {#sect-5.1.6}
::: {#section-5.1.6 .section}
#### [5.1.6.](#section-5.1.6){.section-number .selfRef} [L2 Static Subscriber Access](#name-l2-static-subscriber-access){.section-name .selfRef} {#name-l2-static-subscriber-access}

L2 static subscriber access processes are as
follows:[¶](#section-5.1.6-1){.pilcrow}

[]{#name-l2-static-subscriber-access-2}

::: {#fig19}
::: {#section-5.1.6-2.1 .artwork .art-text .alignLeft}
         RG              UP                      CP              AAA
         |               |    Static Subscriber   |               |
         |               |     Detection Req.     |               |
         |              1|<-----to UP via Ci------|               |
         |               |    Static Subscriber   |               |
         |               |     Detection Rep.     |               |
         |              2|------to UP via Ci----->|               |
         |  ARP/ND(REQ)  |                        |               |
      3.1|<--------------|                        |               |
         |  ARP/ND(ACK)  |                        |               |
      3.2|-------------->|                        |               |
         |               |  Relay the ARP/ND      |               |
         |            3.3|-----to CP via Si------>|       AAA     |
         |               |                        |    Req/Rep    |
         |               |                     3.4|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |            3.5|<--------via Ci---------|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |            3.6|---------via Ci-------->|               |
         |  ARP/ND(REQ)  |                        |               |
      4.1|-------------->|                        |               |
         |               |  Relay the ARP/ND      |               |
         |            4.2|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                     4.3|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |            4.4|<--------via Ci---------|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |            4.5|---------via Ci-------->|               |
         |  ARP/ND(ACK)  |                        |               |
      4.6|<--------------|                        |               |
         |   IP Traffic  |                        |               |
      5.1|-------------->|                        |               |
         |               |  Relay the IP Traffic  |               |
         |            5.2|-----to CP via Si------>|      AAA      |
         |               |                        |    Req/Rep    |
         |               |                     5.3|<------------->|
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |            5.4|<--------via Ci-------->|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |            5.5|---------via Ci-------->|               |
         |  ARP/ND(REQ)  |                        |               |
      5.6|<--------------|                        |               |
         |  ARP/ND(ACK)  |                        |               |
      5.7|-------------->|                        |               |
         |               |                        |               |
:::

[Figure 19](#figure-19){.selfRef}: [L2 Static Subscriber
Access](#name-l2-static-subscriber-access-2){.selfRef}
:::

For L2 static subscriber access, the process starts with a CP installing
a static subscriber detection list on a UP. The list determines which
subscribers will be detected. That is implemented by exchanging
Update_Request and Update_Response messages between CP and UP. The
formats of the messages are as follows:[¶](#section-5.1.6-3){.pilcrow}

::: {#section-5.1.6-4}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <IPv4 Static Subscriber Detect TLVs>
                  <IPv6 Static Subscriber Detect TLVs>

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.1.6-4){.pilcrow}
:::

For L2 static subscriber access, there are three ways to trigger the
access process:[¶](#section-5.1.6-5){.pilcrow}

\(1\)
:   Triggered by UP (steps 3.1-3.6): This assumes that the UP knows the
    IP address, the access interface, and the VLAN of the RG. The UP
    will actively trigger the access flow by sending an ARP/ND packet to
    the RG. If the RG is online, it will reply with an ARP/ND to the UP.
    The UP will tunnel the ARP/ND to the CP through the Si. The CP then
    triggers the authentication process. If the authentication result is
    positive, the CP will create a corresponding subscriber session on
    the UP.[¶](#section-5.1.6-6.1){.pilcrow}

\(2\)
:   Triggered by RG ARP/ND (steps 4.1-4.6): Most of the process is the
    same as option 1 (triggered by UP). The difference is that the RG
    will actively send the ARP/ND to trigger the
    process.[¶](#section-5.1.6-6.2){.pilcrow}

\(3\)
:   Triggered by RG IP traffic (steps 5.1-5.7): This is for the case
    where the RG has the ARP/ND information, but the subscriber session
    on the UP is lost (e.g., due to failure on the UP or the UP
    restarting). That means the RG may keep sending IP packets to the
    UP. The packets will trigger the UP to start a new access
    process.[¶](#section-5.1.6-6.3){.pilcrow}

From a subscriber session point of view, the procedures and the message
formats for the three cases above are the same, as
follows.[¶](#section-5.1.6-7){.pilcrow}

IPv4 Case:[¶](#section-5.1.6-8){.pilcrow}

::: {#section-5.1.6-9}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.1.6-9){.pilcrow}
:::

IPv6 Case:[¶](#section-5.1.6-10){.pilcrow}

::: {#section-5.1.6-11}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.1.6-11){.pilcrow}
:::
:::
:::
:::
:::

::: {#sect-5.2}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [PPPoE](#name-pppoe){.section-name .selfRef} {#name-pppoe}

::: {#sect-5.2.1}
::: {#section-5.2.1 .section}
#### [5.2.1.](#section-5.2.1){.section-number .selfRef} [IPv4 PPPoE Access](#name-ipv4-pppoe-access){.section-name .selfRef} {#name-ipv4-pppoe-access}

[Figure 20](#fig20){.xref} shows the IPv4 PPPoE access call
flow.[¶](#section-5.2.1-1){.pilcrow}

[]{#name-ipv4-pppoe-access-2}

::: {#fig20}
::: {#section-5.2.1-2.1 .artwork .art-text .alignLeft}
         RG              UP                      CP              AAA
         |  PPPoE Disc   |        PPPoE Disc      |               |
        1|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |  PPP LCP      |        PPP LCP         |               |
        2|<------------->|<---------via Si------->|               |
         |               |                        |      AAA      |
         |  PPP PAP/CHAP |        PPP PAP/CHAP    |    Req/Rep    |
        3|<------------->|<---------via Si------->|<------------->|
         |               |                        |               |
         |  PPP IPCP     |        PPP IPCP        |               |
        4|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              5|<--------via Ci---------|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              6|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                       7|<------------->|
         |               |                        |               |
:::

[Figure 20](#figure-20){.selfRef}: [IPv4 PPPoE
Access](#name-ipv4-pppoe-access-2){.selfRef}
:::

In the above sequence, steps 1-4 are the standard PPPoE call flow. The
UP is responsible for redirecting the PPPoE control packets to the CP or
RG. The PPPoE control packets are transmitted between the CP and UP
through the Si.[¶](#section-5.2.1-3){.pilcrow}

After the PPPoE call flow, if the subscriber passed the AAA
authentication and authorization, the CP will create a corresponding
session on the UP through the Ci. The formats of the messages are as
follows:[¶](#section-5.2.1-4){.pilcrow}

::: {#section-5.2.1-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.2.1-5){.pilcrow}
:::
:::
:::

::: {#sect-5.2.2}
::: {#section-5.2.2 .section}
#### [5.2.2.](#section-5.2.2){.section-number .selfRef} [IPv6 PPPoE Access](#name-ipv6-pppoe-access){.section-name .selfRef} {#name-ipv6-pppoe-access}

[Figure 21](#fig21){.xref} describes the IPv6 PPPoE access call
flow.[¶](#section-5.2.2-1){.pilcrow}

[]{#name-ipv6-pppoe-access-2}

::: {#fig21}
::: {#section-5.2.2-2.1 .artwork .art-text .alignLeft}
         RG              UP                      CP              AAA
         |  PPPoE Disc   |        PPPoE Disc      |               |
        1|<------------->|<--------via Si-------->|               |
         |               |                        |               |
         |  PPP LCP      |        PPP LCP         |               |
        2|<------------->|<---------via Si------->|               |
         |               |                        |      AAA      |
         |  PPP PAP/CHAP |        PPP PAP/CHAP    |    Req/Rep    |
        3|<------------->|<---------via Si------->|<------------->|
         |               |                        |               |
         |  PPP IP6CP    |        PPP IP6CP       |               |
        4|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Create Subscriber     |               |
         |               |   Session Request      |               |
         |              5|<--------via Ci---------|               |
         |               |  Create Subscriber     |               |
         |               |   Session Response     |               |
         |              6|---------via Ci-------->|               |
         |               |                        |               |
         | ND Negotiation|        ND Negotiation  |               |
        7|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Update Subscriber     |               |
         |               |   Session Request      |               |
         |              8|<--------via Ci---------|               |
         |               |  Update Subscriber     |               |
         |               |   Session Response     |               |
         |              9|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      10|<------------->|
         |    DHCPv6     |        DHCPv6          |               |
         |  Negotiation  |      Negotiation       |               |
       7'|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Update Subscriber     |               |
         |               |   Session Request      |               |
         |             8'|<---------via Ci--------|               |
         |               |  Update Subscriber     |               |
         |               |   Session Response     |               |
         |             9'|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                     10'|<------------->|
         |               |                        |               |
:::

[Figure 21](#figure-21){.selfRef}: [IPv6 PPPoE
Access](#name-ipv6-pppoe-access-2){.selfRef}
:::

From the above sequence, steps 1-4 are the standard PPPoE call flow. The
UP is responsible for redirecting the PPPoE control packets to the CP or
RG. The PPPoE control packets are transmitted between the CP and UP
through the Si.[¶](#section-5.2.2-3){.pilcrow}

After the PPPoE call flow, if the subscriber passed the AAA
authentication and authorization, the CP will create a corresponding
session on the UP through the Ci. The formats of the messages are as
follows:[¶](#section-5.2.2-4){.pilcrow}

::: {#section-5.2.2-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.2.2-5){.pilcrow}
:::

Then, the RG will initialize an ND/DHCPv6 negotiation process with the
CP (see steps 7 and 7\'); after that, it will trigger an update (steps
8-9 and 8\'-9\') to the subscriber session. The formats of the update
messages are as follows:[¶](#section-5.2.2-6){.pilcrow}

::: {#section-5.2.2-7}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.2.2-7){.pilcrow}
:::
:::
:::

::: {#sect-5.2.3}
::: {#section-5.2.3 .section}
#### [5.2.3.](#section-5.2.3){.section-number .selfRef} [PPPoE Dual-Stack Access](#name-pppoe-dual-stack-access){.section-name .selfRef} {#name-pppoe-dual-stack-access}

[Figure 22](#fig22){.xref} shows a combination of IPv4 and IPv6 PPPoE
access call flows.[¶](#section-5.2.3-1){.pilcrow}

[]{#name-pppoe-dual-stack-access-2}

::: {#fig22}
::: {#section-5.2.3-2.1 .artwork .art-text .alignLeft}
         RG              UP                      CP              AAA
         |PPPoE Discovery|      PPPoE Discovery   |               |
        1|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |  PPP LCP      |        PPP LCP         |               |
        2|<------------->|<---------via Si------->|               |
         |               |                        |      AAA      |
         |  PPP PAP/CHAP |        PPP PAP/CHAP    |    Req/Rep    |
        3|<------------->|<---------via Si------->|<------------->|
         |               |                        |               |
         |  PPP IPCP     |        PPP IPCP        |               |
        4|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Create v4 Subscriber  |               |
         |               |   Session Request      |               |
         |              5|<--------via Ci---------|               |
         |               |  Create v4 Subscriber  |               |
         |               |   Session Response     |               |
         |              6|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                       7|<------------->|
         |  PPP IP6CP    |        PPP IP6CP       |               |
       4'|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Create V6 Subscriber  |               |
         |               |   Session Request      |               |
         |             5'|<--------via Ci---------|               |
         |               |  Create v6 Subscriber  |               |
         |               |   Session Response     |               |
         |             6'|---------via Ci-------->|               |
         |               |                        |               |
         | ND Negotiation|     ND Negotiation     |               |
        8|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Update v6 Subscriber  |               |
         |               |   Session Request      |               |
         |              9|<---------via Ci--------|               |
         |               |  Update v6 Subscriber  |               |
         |               |   Session Response     |               |
         |             10|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      7'|<------------->|
         |    DHCPv6     |        DHCPv6          |               |
         |  Negotiation  |      Negotiation       |               |
       8'|<------------->|<---------via Si------->|               |
         |               |                        |               |
         |               |  Update v6 Subscriber  |               |
         |               |   Session Request      |               |
         |             9'|<--------via Ci---------|               |
         |               |  Update v6 Subscriber  |               |
         |               |   Session Response     |               |
         |            10'|---------via Ci-------->|               |
         |               |                        |   Accounting  |
         |               |                      7"|<------------->|
         |               |                        |               |
:::

[Figure 22](#figure-22){.selfRef}: [PPPoE Dual-Stack
Access](#name-pppoe-dual-stack-access-2){.selfRef}
:::

PPPoE dual stack is a combination of IPv4 PPPoE and IPv6 PPPoE access.
The process is as above. The formats of the messages are as
follows:[¶](#section-5.2.3-3){.pilcrow}

\(1\)

:   Create an IPv4 PPPoE subscriber session (steps
    5-6):[¶](#section-5.2.3-4.1.1){.pilcrow}

    ::: {#section-5.2.3-4.1.2}
    ``` {.sourcecode .lang-rbnf}
    <Update_Request Message> ::= <Common Header>
                      <Basic Subscriber TLV>
                      <PPP Subscriber TLV>
                      <IPv4 Subscriber TLV>
                      <IPv4 Routing TLV>
                      [<Subscriber Policy TLV>]

    <Update_Response Message> ::= <Common Header>
                     <Update Response TLV>
                     [<Subscriber CGN Port Range TLV>]
    ```

    [¶](#section-5.2.3-4.1.2){.pilcrow}
    :::

\(2\)

:   Create an IPv6 PPPoE subscriber session (steps
    5\'-6\'):[¶](#section-5.2.3-4.2.1){.pilcrow}

    ::: {#section-5.2.3-4.2.2}
    ``` {.sourcecode .lang-rbnf}
    <Update_Request Message> ::= <Common Header>
                      <Basic Subscriber TLV>
                      <PPP Subscriber TLV>
                      <IPv6 Subscriber TLV>
                      <IPv6 Routing TLV>
                      [<Subscriber Policy TLV>]

    <Update_Response Message> ::= <Common Header>
                     <Update Response TLV>
    ```

    [¶](#section-5.2.3-4.2.2){.pilcrow}
    :::

\(3\)

:   Update the IPv6 PPPoE subscriber session (steps 9-10 and
    9\'-10\'):[¶](#section-5.2.3-4.3.1){.pilcrow}

    ::: {#section-5.2.3-4.3.2}
    ``` {.sourcecode .lang-rbnf}
    <Update_Request Message> ::= <Common Header>
                      <Basic Subscriber TLV>
                      <PPP Subscriber TLV>
                      <IPv6 Subscriber TLV>
                      <IPv6 Routing TLV>
                      [<Subscriber Policy TLV>]

    <Update_Response Message> ::= <Common Header>
                     <Update Response TLV>
    ```

    [¶](#section-5.2.3-4.3.2){.pilcrow}
    :::
:::
:::
:::
:::

::: {#sect-5.3}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [WLAN Access](#name-wlan-access){.section-name .selfRef} {#name-wlan-access}

[Figure 23](#fig23){.xref} shows the WLAN access call
flow.[¶](#section-5.3-1){.pilcrow}

[]{#name-wlan-access-2}

::: {#fig23}
::: {#section-5.3-2.1 .artwork .art-text .alignLeft}
         RG            UP              CP         AAA      Web Server
         |    DHCP     |                |          |           |
         |  Discovery  |                |          |           |
        1|------------>|                |          |           |
         |             | DHCP Discovery |          |           |
         |            2|-----via Si---->|   AAA    |           |
         |             |   DHCP Offer   |<-------->|           |
         |            3|<----via Si-----|          |           |
         |  DHCP Offer |                |          |           |
        4|<------------|                |          |           |
         | DHCP Request|                |          |           |
        5|------------>|                |          |           |
         |             |  DHCP Request  |          |           |
         |            6|-----via Si---->|          |           |
         |             |                |          |           |
         |             | Create Session |          |           |
         |             |    Request     |          |           |
         |            7|<----via Ci-----|          |           |
         |             | Create Session |          |           |
         |             |    Response    |          |           |
         |            8|----via Ci----->|          |           |
         |             |                |          |           |
         |             |  DHCP ACK      |          |           |
         |            9|<----via Si-----|          |           |
         |  DHCP ACK   |                |          |           |
       10|<------------|                |          |           |
         |             |                |          |           |
         | Subscriber  |                |          |           |
         | HTTP Traffic|                |          |           |
       11|------------>|-->             |          |           |
         |             |  | Web URL     |          |           |
         |  Traffic    |  | Redirect    |          |           |
         | Redirection |  |             |          |           |
       12|<------------|<-+             |          |           |
         |                                                     |
       13|-----------------Redirect to Web Server------------->|
         |                                                     |
       14|<----------------Push HTTP Log-in Page---------------|
         |                                                     |
       15|-----------------User Authentication---------------->|
         |                                                     |
         |             |                |  Portal Interchange  |
         |             |              16|<-------------------->|
         |             |                |                      |
         |             |                |   AAA    |           |
         |             |                |  Req/Rep |           |
         |             |              17|<-------->|           |
         |             |                |          |           |
         |             | Update Session |          |           |
         |             |    Request     |          |           |
         |           18|<----via Ci-----|          |           |
         |             | Update Session |          |           |
         |             |    Response    |          |           |
         |           19|-----via Ci---->|          |           |
         |             |                |          |           |
:::

[Figure 23](#figure-23){.selfRef}: [WLAN
Access](#name-wlan-access-2){.selfRef}
:::

WLAN access starts with the DHCP dial-up process (steps 1-6). After
that, the CP will create a subscriber session on the UP (steps 7-8). The
formats of the session creation messages are as
follows:[¶](#section-5.3-3){.pilcrow}

IPv4 Case:[¶](#section-5.3-4){.pilcrow}

::: {#section-5.3-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.3-5){.pilcrow}
:::

IPv6 Case:[¶](#section-5.3-6){.pilcrow}

::: {#section-5.3-7}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.3-7){.pilcrow}
:::

After step 10, the RG will be allocated an IP address, and its first
HTTP packet will be redirected to a web server for subscriber
authentication (steps 11-17). After the web authentication, if the
result is positive, the CP will update the subscriber session by using
the following message exchanges:[¶](#section-5.3-8){.pilcrow}

IPv4 Case:[¶](#section-5.3-9){.pilcrow}

::: {#section-5.3-10}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.3-10){.pilcrow}
:::

IPv6 Case:[¶](#section-5.3-11){.pilcrow}

::: {#section-5.3-12}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.3-12){.pilcrow}
:::
:::
:::

::: {#sect-5.4}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [L2TP](#name-l2tp){.section-name .selfRef} {#name-l2tp}

::: {#sect-5.4.1}
::: {#section-5.4.1 .section}
#### [5.4.1.](#section-5.4.1){.section-number .selfRef} [L2TP LAC Access](#name-l2tp-lac-access){.section-name .selfRef} {#name-l2tp-lac-access}

[]{#name-l2tp-lac-access-2}

::: {#fig24}
::: {#section-5.4.1-1.1 .artwork .art-text .alignLeft}
         RG         UP(LAC)      CP(LAC)     AAA        LNS
         |    PPPoE   |    PPPoE     |        |          |
         |  Discovery |   Discovery  |        |          |
        1|<---------->|<---via Si--->|        |          |
         |            |              |        |          |
         |  PPP LCP   |   PPP LCP    |        |          |
        2|<---------->|<---via Si--->|        |          |
         |            |              |   AAA  |          |
         |PPP PAP/CHAP| PPP PAP/CHAP | Req/Rep|          |
        3|<---------->|<---via Si--->|<------>|          |
         |            |              |        |          |
         |  PPP IPCP  |  PPP IPCP    |        |          |
        4|<---------->|<---via Si--->|        |          |
         |            |              |        |          |
         |            | L2TP Tunnel  |        |          |
         |            | Negotiation  |        |          |
         |            |   SCCRQ/     |        |          |
         |            |   SCCRP/     |        |          |
         |            |   SCCCN      |        |          |
         |           5|<---via Si--->|        |          |
         |            | /\                               |
         |            | || Forward                       |
         |            | \/                               |
         |            |<-----------via Routing---------->|
         |            |                                  |
         |            | L2TP Session |        |          |
         |            | Negotiation  |        |          |
         |            |    ICRQ/     |        |          |
         |            |    ICRP/     |        |          |
         |            |    ICCN      |        |          |
         |           6|<---via Si--->|        |          |
         |            | /\                               |
         |            | || Forward                       |
         |            | \/                               |
         |            |<-----------via Routing---------->|
         |            |                                  |
         |            |    Create    |         |         |
         |            |  Subscriber  |         |         |
         |            |  Session Req |         |         |
         |           7|<---via Ci----|         |         |
         |            |    Create    |         |         |
         |            |  Subscriber  |         |         |
         |            |  Session Rep |         |         |
         |           8|----via Ci--->|         |         |
         |            |              |         |         |
         |                                               |
         |         PAP/CHAP (Triggered by LNS)           |
        9|<-----------------via Routing----------------->|
         |                                               |
:::

[Figure 24](#figure-24){.selfRef}: [L2TP LAC
Access](#name-l2tp-lac-access-2){.selfRef}
:::

Steps 1-4 are a standard PPPoE access process. After that, the LAC-CP
starts to negotiate an L2TP session and tunnel with the LNS. After the
negotiation, the CP will create an L2TP LAC subscriber session on the UP
through the following messages:[¶](#section-5.4.1-2){.pilcrow}

::: {#section-5.4.1-3}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <L2TP-LAC Subscriber TLV>
                  <L2TP-LAC Tunnel TLV>

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.4.1-3){.pilcrow}
:::
:::
:::

::: {#sect-5.4.2}
::: {#section-5.4.2 .section}
#### [5.4.2.](#section-5.4.2){.section-number .selfRef} [L2TP LNS IPv4 Access](#name-l2tp-lns-ipv4-access){.section-name .selfRef} {#name-l2tp-lns-ipv4-access}

[]{#name-l2tp-lns-ipv4-access-2}

::: {#fig25}
::: {#section-5.4.2-1.1 .artwork .art-text .alignLeft}
         RG          LAC            UP(LNS)  AAA      CP(LNS)
         |    PPPoE   |              |        |          |
         |  Discovery |              |        |          |
        1|<---------->|              |        |          |
         |            |              |        |          |
         |  PPP LCP   |              |        |          |
        2|<---------->|                       |          |
         |            |          AAA          |          |
         |PPP PAP/CHAP|        Req/Rep        |          |
        3|<---------->|<--------------------->|          |
         |            |                                  |
         |            | L2TP Tunnel  |     L2TP Tunnel   |
         |            | Negotiation  |     Negotiation   |
         |            |   SCCRQ/     |       SCCRQ/      |
         |            |   SCCRP/     |       SCCRP/      |
         |            |   SCCCN      |       SCCCN       |
         |           4|<------------>|<------via Si----->|
         |            |              |                   |
         |            | L2TP Session |     L2TP Session  |
         |            | Negotiation  |     Negotiation   |
         |            |    ICRQ/     |        ICRQ/      |
         |            |    ICRP/     |        ICRP/      |
         |            |    ICCN      |        ICCN       |
         |           5|<------------>|<------via Si----->|
         |            |              |                   |
         |            |              | Create Subscriber |
         |            |              | Session Request   |
         |            |             6|<-----via Ci-------|
         |            |              | Create Subscriber |
         |            |              | Session Response  |
         |            |             7|------via Ci------>|
         |                                               |
         |          PAP/CHAP (Triggered by LNS)          |
        8|<--------------------------------------------->|
         |                                               |
         |            |              |        |    AAA   |
         |            |              |        |  Req/Rep |
         |            |              |       9|<-------->|
         |            |              |                   |
         |                                               |
         |                   PPP IPCP                    |
       10|<--------------------------------------------->|
         |                                               |
         |            |              | Update Subscriber |
         |            |              | Session Request   |
         |            |            11|<-----via Ci-------|
         |            |              | Update Subscriber |
         |            |              | Session Response  |
         |            |            12|------via Ci------>|
         |            |              |                   |
:::

[Figure 25](#figure-25){.selfRef}: [L2TP LNS IPv4
Access](#name-l2tp-lns-ipv4-access-2){.selfRef}
:::

In this case, the BNG is running as an LNS and separated into LNS-CP and
LNS-UP. Steps 1-5 finish the normal L2TP dial-up process. When the L2TP
session and tunnel negotiations are finished, the LNS-CP will create an
L2TP LNS subscriber session on the LNS-UP. The format of the messages is
as follows:[¶](#section-5.4.2-2){.pilcrow}

::: {#section-5.4.2-3}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.4.2-3){.pilcrow}
:::

After that, the LNS-CP will trigger a AAA authentication. If the
authentication result is positive, a PPP IP Control Protocol (IPCP)
process will follow, and then the CP will update the session with the
following message exchanges:[¶](#section-5.4.2-4){.pilcrow}

::: {#section-5.4.2-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.4.2-5){.pilcrow}
:::
:::
:::

::: {#sect-5.4.3}
::: {#section-5.4.3 .section}
#### [5.4.3.](#section-5.4.3){.section-number .selfRef} [L2TP LNS IPv6 Access](#name-l2tp-lns-ipv6-access){.section-name .selfRef} {#name-l2tp-lns-ipv6-access}

[]{#name-l2tp-lns-ipv6-access-2}

::: {#fig26}
::: {#section-5.4.3-1.1 .artwork .art-text .alignLeft}
         RG          LAC          UP(LNS)    AAA      CP(LNS)
         |    PPPoE   |              |        |          |
         |  Discovery |              |        |          |
        1|<---------->|              |        |          |
         |            |              |        |          |
         |  PPP LCP   |              |        |          |
        2|<---------->|                       |          |
         |            |          AAA          |          |
         |PPP PAP/CHAP|        Req/Rep        |          |
        3|<---------->|<--------------------->|          |
         |            |                                  |
         |            | L2TP Tunnel  |     L2TP Tunnel   |
         |            | Negotiation  |     Negotiation   |
         |            |   SCCRQ/     |       SCCRQ/      |
         |            |   SCCRP/     |       SCCRP/      |
         |            |   SCCCN      |       SCCCN       |
         |           4|<------------>|<------via Si----->|
         |            |              |                   |
         |            | L2TP Session |     L2TP Session  |
         |            | Negotiation  |     Negotiation   |
         |            |    ICRQ/     |        ICRQ/      |
         |            |    ICRP/     |        ICRP/      |
         |            |    ICCN      |        ICCN       |
         |           5|<------------>|<------via Si----->|
         |            |              |                   |
         |            |              | Create Subscriber |
         |            |              | Session Request   |
         |            |             6|<-----via Ci-------|
         |            |              | Create Subscriber |
         |            |              | Session Response  |
         |            |             7|------via Ci------>|
         |                                               |
         |          PAP/CHAP (Triggered by LNS)          |
        8|<--------------------------------------------->|
         |                                               |
         |            |              |        |    AAA   |
         |            |              |        |  Req/Rep |
         |            |              |       9|<-------->|
         |            |              |        |          |
         |                                               |
         |                   PPP IP6CP                   |
       10|<--------------------------------------------->|
         |                                               |
         |            |              | Update Subscriber |
         |            |              | Session Request   |
         |            |            11|<-----via Ci-------|
         |            |              | Update Subscriber |
         |            |              | Session Response  |
         |            |            12|------via Ci------>|
         |                           |                   |
         |       ND Negotiation      |   ND Negotiation  |
       13|<------------------------->|<-----via Si------>|
         |                           |                   |
         |            |              | Update Subscriber |
         |            |              | Session Request   |
         |            |            14|<-----via Ci-------|
         |            |              | Update Subscriber |
         |            |              | Session Response  |
         |            |            15|------via Ci------>|
         |            |              |                   |
:::

[Figure 26](#figure-26){.selfRef}: [L2TP LNS IPv6
Access](#name-l2tp-lns-ipv6-access-2){.selfRef}
:::

Steps 1-12 are the same as L2TP LNS IPv4 access. Steps 1-5 finish the
normal L2TP dial-up process. When the L2TP session and tunnel
negotiations are finished, the LNS-CP will create an L2TP LNS subscriber
session on the LNS-UP. The format of the messages is as
follows:[¶](#section-5.4.3-2){.pilcrow}

::: {#section-5.4.3-3}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.4.3-3){.pilcrow}
:::

After that, the LNS-CP will trigger a AAA authentication. If the
authentication result is positive, a PPP IP6CP process will follow, and
then the CP will update the session with the following message
exchanges:[¶](#section-5.4.3-4){.pilcrow}

::: {#section-5.4.3-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <L2TP-LNS Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.4.3-5){.pilcrow}
:::

Then, an ND negotiation will be triggered by the RG. After the ND
negotiation, the CP will update the session with the following message
exchanges:[¶](#section-5.4.3-6){.pilcrow}

::: {#section-5.4.3-7}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <L2TP-LAC Subscriber TLV>
                  <Basic Subscriber TLV>
                  <PPP Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  <L2TP-LNS Tunnel TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.4.3-7){.pilcrow}
:::
:::
:::
:::
:::

::: {#sect-5.5}
::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [CGN (Carrier Grade NAT)](#name-cgn-carrier-grade-nat){.section-name .selfRef} {#name-cgn-carrier-grade-nat}

[]{#name-cgn-access}

::: {#fig27}
::: {#section-5.5-1.1 .artwork .art-text .alignLeft}
           RG              UP                       CP             AAA
           |               |  Public Address Block  |               |
           |               |   Allocation Request   |               |
           |              1|<--------via Ci-------->|               |
           |               |  Public Address Block  |               |
           |               |   Allocation Reply     |               |
           |              2|---------via Ci-------->|               |
           |   Subscriber  |                        |               |
           | Access Request|        Subscriber      |               |
          3|-------------->|      Access Request    |               |
           |              4|----------via Si------->|               |
           |               |                        |      AAA      |
           |               |       Subscriber       |    Req/Rep    |
           |  Subscriber   |      Access Reply     5|<------------->|
           | Access Reply 6|<---------via Si--------|               |
          7|<--------------|                        |               |
           |               |  Create Subscriber     |               |
           |               |   Session Request      |               |
           |              8|<--------via Ci---------|               |
           |               |                        |               |
           |               |  Create Subscriber     |               |
           |               |   Session Response     |               |
           |               | (with NAT information) |               |
           |              9|---------via Ci-------->|               |
           |               |                        |   Accounting  |
           |               |                        |  with source  |
           |               |                        |   information |
           |               |                      10|<------------->|
           |               |                        |  Public IP +  |
           |               |                        |  Port Range   |
           |               |                        |  to Private IP|
           |               |                        |  Mapping      |
           |               |                        |               |
:::

[Figure 27](#figure-27){.selfRef}: [CGN
Access](#name-cgn-access){.selfRef}
:::

The first steps allocate one or more CGN address blocks to the UP (steps
1-2). This is achieved by the following message exchanges between CP and
UP:[¶](#section-5.5-2){.pilcrow}

::: {#section-5.5-3}
``` {.sourcecode .lang-rbnf}
<Addr_Allocation_Req Message> ::= <Common Header>
                  <Address Allocation Request TLV>

<Addr_Allocation_Ack Message> ::= <Common Header>
                 <Address Allocation Response TLV>
```

[¶](#section-5.5-3){.pilcrow}
:::

Steps 3-9 show the general dial-up process in the case of CGN mode. The
specific processes (e.g., IPoE, PPPoE, L2TP, etc.) are defined in above
sections.[¶](#section-5.5-4){.pilcrow}

If a subscriber is a CGN subscriber, once the subscriber session is
created/updated, the UP will report the NAT information to the CP. This
is achieved by carrying the Subscriber CGN Port Range TLV in the
Update_Response message.[¶](#section-5.5-5){.pilcrow}
:::
:::

::: {#sect-5.6}
::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [L3 Leased Line Access](#name-l3-leased-line-access){.section-name .selfRef} {#name-l3-leased-line-access}

::: {#sect-5.6.1}
::: {#section-5.6.1 .section}
#### [5.6.1.](#section-5.6.1){.section-number .selfRef} [Web Authentication](#name-web-authentication){.section-name .selfRef} {#name-web-authentication}

[]{#name-web-authentication-based-l3}

::: {#fig28}
::: {#section-5.6.1-1.1 .artwork .art-text .alignLeft}
         RG            UP              CP         AAA      Web Server
         | User traffic|                |          |           |
        1|------------>|                |          |           |
         |             | User traffic   |          |           |
         |            2|-----via Si---->|    AAA   |           |
         |             |                |  Req/Rep |           |
         |             |               3|<-------->|           |
         |             | Create Session |          |           |
         |             |    Request     |          |           |
         |            4|<----via Ci-----|          |           |
         |             | Create Session |          |           |
         |             |    Response    |          |           |
         |            5|----via Ci----->|          |           |
         |             |                |          |           |
         | HTTP traffic|                |          |           |
        6|------------>|                |          |           |
         |             |                |          |           |
         | Redirect to |                |          |           |
         |   Web URL   |                |          |           |
        7|<------------|                |          |           |
         |             |                |          |           |
         |                                                     |
        8|-----------------Redirected to Web Server----------->|
         |                                                     |
        9|<----------------Push HTTP Log-in Page---------------|
         |                                                     |
       10|-----------------User Authentication---------------->|
         |                                                     |
         |             |                |  Portal Interchange  |
         |             |              11|<-------------------->|
         |             |                |                      |
         |             |                |   AAA    |           |
         |             |                |  Req/Rep |           |
         |             |              12|<-------->|           |
         |             |                |          |           |
         |             | Update Session |          |           |
         |             |    Request     |          |           |
         |           13|<----via Ci-----|          |           |
         |             | Update Session |          |           |
         |             |    Response    |          |           |
         |           14|----via Ci----->|          |           |
         |             |                |          |           |
:::

[Figure 28](#figure-28){.selfRef}: [Web Authentication-Based L3 Leased
Line Access](#name-web-authentication-based-l3){.selfRef}
:::

In this case, IP traffic from the RG will trigger the CP to authenticate
the RG by checking the source IP and the exchanges with the AAA server.
Once the RG has passed the authentication, the CP will create a
corresponding subscriber session on the UP through the following message
exchanges:[¶](#section-5.6.1-2){.pilcrow}

IPv4 Case:[¶](#section-5.6.1-3){.pilcrow}

::: {#section-5.6.1-4}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>

                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.6.1-4){.pilcrow}
:::

IPv6 Case:[¶](#section-5.6.1-5){.pilcrow}

::: {#section-5.6.1-6}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.6.1-6){.pilcrow}
:::

Then, the HTTP traffic from the RG will be redirected to a web server to
finish the web authentication. Once the web authentication is passed,
the CP will trigger another AAA authentication. After the AAA
authentication, the CP will update the session with the following
message exchanges:[¶](#section-5.6.1-7){.pilcrow}

IPv4 Case:[¶](#section-5.6.1-8){.pilcrow}

::: {#section-5.6.1-9}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.6.1-9){.pilcrow}
:::

IPv6 Case:[¶](#section-5.6.1-10){.pilcrow}

::: {#section-5.6.1-11}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.6.1-11){.pilcrow}
:::
:::
:::

::: {#sect-5.6.2}
::: {#section-5.6.2 .section}
#### [5.6.2.](#section-5.6.2){.section-number .selfRef} [User Traffic Trigger](#name-user-traffic-trigger){.section-name .selfRef} {#name-user-traffic-trigger}

[]{#name-user-traffic-triggered-l3-l}

::: {#fig29}
::: {#section-5.6.2-1.1 .artwork .art-text .alignLeft}
         RG            UP              CP         AAA
         |             |   L3 access    |          |
         |             |  control list  |          |
         |            1|<----via Ci-----|          |
         |    User     |                |          |
         |   traffic   |                |          |
        2|------------>|                |          |
         |             |  User traffic  |          |
         |            3|-----via Si---->|          |
         |             |                |   AAA    |
         |             |                |  Req/Rep |
         |             |               4|<-------->|
         |             |                |          |
         |             | Create Session |          |
         |             |    Request     |          |
         |            5|<----via Ci-----|          |
         |             | Create Session |          |
         |             |    Response    |          |
         |            6|----via Ci----->|          |
         |             |                |          |
:::

[Figure 29](#figure-29){.selfRef}: [User Traffic Triggered L3 Leased
Line Access](#name-user-traffic-triggered-l3-l){.selfRef}
:::

In this case, the CP must install on the UP an access control list,
which is used by the UP to determine whether or not an RG is legal. If
the traffic is from a legal RG, it will be redirected to the CP though
the Si. The CP will trigger a AAA interchange with the AAA server. After
that, the CP will create a corresponding subscriber session on the UP
with the following message exchanges:[¶](#section-5.6.2-2){.pilcrow}

IPv4 Case:[¶](#section-5.6.2-3){.pilcrow}

::: {#section-5.6.2-4}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv4 Subscriber TLV>
                  <IPv4 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
                 [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.6.2-4){.pilcrow}
:::

IPv6 Case:[¶](#section-5.6.2-5){.pilcrow}

::: {#section-5.6.2-6}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                  <Basic Subscriber TLV>
                  <IPv6 Subscriber TLV>
                  <IPv6 Routing TLV>
                  [<Subscriber Policy TLV>]

<Update_Response Message> ::= <Common Header>
                 <Update Response TLV>
```

[¶](#section-5.6.2-6){.pilcrow}
:::
:::
:::
:::
:::

::: {#sect-5.7}
::: {#section-5.7 .section}
### [5.7.](#section-5.7){.section-number .selfRef} [Multicast Service Access](#name-multicast-service-access){.section-name .selfRef} {#name-multicast-service-access}

[]{#name-multicast-access}

::: {#fig30}
::: {#section-5.7-1.1 .artwork .art-text .alignLeft}
               RG            UP              CP         AAA
               | User Access |  User Access   |   AAA    |
               |   Request   |    Request     |  Req/Rep |
              1|<----------->|<----via Si---->|<-------->|
               |             |                |          |
               |             | Create Session |          |
               |             |    Request     |          |
               |            2|<----via Ci---->|          |
               |             |                |          |
               |             | Create Session |          |
               |             |    Response    |          |
               |            3|----via Ci----->|          |
               |             |                |          |
               |  Multicast  |                |          |
               | negotiation |                |          |
              4|<----------->|                |          |
               |             |                |          |
:::

[Figure 30](#figure-30){.selfRef}: [Multicast
Access](#name-multicast-access){.selfRef}
:::

Multicast access starts with a user access request from the RG. The
request will be redirected to the CP by the Si. A follow-up AAA
interchange between the CP and the AAA server will be triggered. After
the authentication, the CP will create a multicast subscriber session on
the UP through the following messages:[¶](#section-5.7-2){.pilcrow}

IPv4 Case, there will be a Multicast-ProfileV4 sub-TLV present in the
Subscriber Policy TLV:[¶](#section-5.7-3){.pilcrow}

::: {#section-5.7-4}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
               <Basic Subscriber TLV>
               <IPv4 Subscriber TLV>
               <IPv4 Routing TLV>
               <Subscriber Policy TLV>

<Update_Response Message> ::= <Common Header>
              <Update Response TLV>
              [<Subscriber CGN Port Range TLV>]
```

[¶](#section-5.7-4){.pilcrow}
:::

IPv6 Case, there will be a Multicast-ProfileV6 sub-TLV present in the
Subscriber Policy TLV:[¶](#section-5.7-5){.pilcrow}

::: {#section-5.7-6}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
               <Basic Subscriber TLV>
               <IPv6 Subscriber TLV>
               <IPv6 Routing TLV>
               <Subscriber Policy TLV>

<Update_Response Message> ::= <Common Header>
              <Update Response TLV>
```

[¶](#section-5.7-6){.pilcrow}
:::
:::
:::
:::
:::

::: {#sect-6}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [S-CUSP Message Formats](#name-s-cusp-message-formats){.section-name .selfRef} {#name-s-cusp-message-formats}

An S-CUSP message consists of a common header followed by a
variable-length body consisting entirely of TLVs. Receiving an S-CUSP
message with an unknown message type or missing mandatory TLV
[MUST]{.bcp14} trigger an Error message (see [Section
6.7](#sect-6.7){.xref}) or a Response message with an Error Information
TLV (see [Section 7.6](#sect-7.6){.xref}).[¶](#section-6-1){.pilcrow}

Conversely, if a TLV is optional, the TLV may or may not be present.
Optional TLVs are indicated in the message formats shown in this
document by being enclosed in square
brackets.[¶](#section-6-2){.pilcrow}

This section specifies the format of the common S-CUSP message header
and lists the defined messages.[¶](#section-6-3){.pilcrow}

Network byte order is used for all multi-byte
fields.[¶](#section-6-4){.pilcrow}

::: {#sect-6.1}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Common Message Header](#name-common-message-header){.section-name .selfRef} {#name-common-message-header}

[]{#name-s-cusp-message-common-heade}

::: {#fig31}
::: {#section-6.1-1.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Ver  |  Resv | Message-Type  |        Message-Length         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |            Reserved           |        Transaction-ID         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 31](#figure-31){.selfRef}: [S-CUSP Message Common
Header](#name-s-cusp-message-common-heade){.selfRef}
:::

Ver (4 bits):
:   The major version of the protocol. This document specifies
    version 1. Different major versions of the protocol may have
    significantly different message structures and formats except that
    the Ver field will always be in the same place at the beginning of
    each message. A successful S-CUSP session depends on the CP and the
    UP both using the same major version of the
    protocol.[¶](#section-6.1-2.2){.pilcrow}
:   

Resv (4 bits):
:   Reserved. [MUST]{.bcp14} be sent as zero and ignored on
    receipt.[¶](#section-6.1-2.4){.pilcrow}
:   

Message-Type (8 bits):
:   The set of message types specified in this document is listed in
    [Section 8.1](#sect-9.1){.xref}.[¶](#section-6.1-2.6){.pilcrow}
:   

Message-Length (16 bits):
:   Total length of the S-CUSP message including the common header,
    expressed in number of bytes as an unsigned
    integer.[¶](#section-6.1-2.8){.pilcrow}
:   

Transaction-ID (16 bits):
:   This field is used to identify requests. It is echoed back in any
    corresponding ACK/Response/Error message. It is
    [RECOMMENDED]{.bcp14} that a monotonically increasing value be used
    in successive messages and that the value wraps back to zero after
    0xFFFF. The content of this field is an opaque value that the
    receiver [MUST NOT]{.bcp14} use for any purpose except to echo back
    in a corresponding response and, optionally, for
    logging.[¶](#section-6.1-2.10){.pilcrow}
:   
:::
:::

::: {#sect-6.2}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Control Messages](#name-control-messages){.section-name .selfRef} {#name-control-messages}

This document defines the following control
messages:[¶](#section-6.2-1){.pilcrow}

[]{#name-control-messages-2}

  Type   Name              Notes and TLVs that can be carried
  ------ ----------------- ----------------------------------------------------------------------------
  1      Hello             Hello TLV, Keepalive TLV
  2      Keepalive         A common header with the Keepalive message type
  3      Sync_Request      Synchronization request
  4      Sync_Begin        Synchronization starts
  5      Sync_Data         Synchronization data: TLVs specified in [Section 7](#sect-7){.xref}
  6      Sync_End          End synchronization
  7      Update_Request    TLVs specified in Sections [7.6](#sect-7.6){.xref}-[7.9](#sect-7.9){.xref}
  8      Update_Response   TLVs specified in Sections [7.6](#sect-7.6){.xref}-[7.9](#sect-7.9){.xref}

  : [Table 2](#table-2){.selfRef}: [Control
  Messages](#name-control-messages-2){.selfRef}

::: {#sect-6.2.1}
::: {#section-6.2.1 .section}
#### [6.2.1.](#section-6.2.1){.section-number .selfRef} [Hello Message](#name-hello-message){.section-name .selfRef} {#name-hello-message}

The Hello message is used for S-CUSP session establishment and version
negotiation. The details of S-CUSP session establishment and version
negotiation can be found in [Section
4.1.1](#sect-4.1.1){.xref}.[¶](#section-6.2.1-1){.pilcrow}

The format of the Hello message is as
follows:[¶](#section-6.2.1-2){.pilcrow}

::: {#section-6.2.1-3}
``` {.sourcecode .lang-rbnf}
<Hello Message> ::= <Common Header>
                     <Hello TLV>
                     <Keepalive TLV>
                     [<Error Information TLV>]
```

[¶](#section-6.2.1-3){.pilcrow}
:::

The return code and negotiation result will be carried in the Error
Information TLV. They are listed as
follows:[¶](#section-6.2.1-4){.pilcrow}

0:
:   Success. Version negotiation
    success.[¶](#section-6.2.1-5.2){.pilcrow}
:   

1:
:   Failure. Malformed message
    received.[¶](#section-6.2.1-5.4){.pilcrow}
:   

2:
:   TLV-Unknown. One or more of the TLVs was not
    understood.[¶](#section-6.2.1-5.6){.pilcrow}
:   

1001:
:   Version-Mismatch. The version negotiation fails. The S-CUSP session
    establishment phase fails.[¶](#section-6.2.1-5.8){.pilcrow}
:   

1002:
:   Keepalive Error. The keepalive negotiation fails. The S-CUSP session
    establishment phase fails.[¶](#section-6.2.1-5.10){.pilcrow}
:   

1003:
:   Timer Expires. The establishment timer expired. Session
    establishment phase fails.[¶](#section-6.2.1-5.12){.pilcrow}
:   
:::
:::

::: {#sect-6.2.2}
::: {#section-6.2.2 .section}
#### [6.2.2.](#section-6.2.2){.section-number .selfRef} [Keepalive Message](#name-keepalive-message){.section-name .selfRef} {#name-keepalive-message}

Each end of an S-CUSP session periodically sends a Keepalive message. It
is used to detect whether the peer end is still alive. The Keepalive
procedures are defined in [Section
4.1.2](#sect-4.1.2){.xref}.[¶](#section-6.2.2-1){.pilcrow}

The format of the Keepalive message is as
follows:[¶](#section-6.2.2-2){.pilcrow}

::: {#section-6.2.2-3}
``` {.sourcecode .lang-rbnf}
<Keepalive Message> ::= <Common Header>
```

[¶](#section-6.2.2-3){.pilcrow}
:::
:::
:::

::: {#sect-6.2.3}
::: {#section-6.2.3 .section}
#### [6.2.3.](#section-6.2.3){.section-number .selfRef} [Sync_Request Message](#name-sync_request-message){.section-name .selfRef} {#name-sync_request-message}

The Sync_Request message is used to request synchronization from an
S-CUSP peer. Both CP and UP can request their peer to synchronize
data.[¶](#section-6.2.3-1){.pilcrow}

The format of the Sync_Request message is as
follows:[¶](#section-6.2.3-2){.pilcrow}

::: {#section-6.2.3-3}
``` {.sourcecode .lang-rbnf}
<Sync_Request Message> ::= <Common Header>
```

[¶](#section-6.2.3-3){.pilcrow}
:::

A Sync_Request message may result in a Sync_Begin message from its peer.
The Sync_Begin message is defined in [Section
6.2.4](#sect-6.2.4){.xref}.[¶](#section-6.2.3-4){.pilcrow}
:::
:::

::: {#sect-6.2.4}
::: {#section-6.2.4 .section}
#### [6.2.4.](#section-6.2.4){.section-number .selfRef} [Sync_Begin Message](#name-sync_begin-message){.section-name .selfRef} {#name-sync_begin-message}

The Sync_Begin message is a reply to a Sync_Request message. It is used
to notify the synchronization requester whether the synchronization can
be started.[¶](#section-6.2.4-1){.pilcrow}

The format of the Sync_Begin message is as
follows:[¶](#section-6.2.4-2){.pilcrow}

::: {#section-6.2.4-3}
``` {.sourcecode .lang-rbnf}
<Sync_Begin Message> ::= <Common Header>
                        <Error Information TLV>
```

[¶](#section-6.2.4-3){.pilcrow}
:::

The return codes are carried in the Error Information TLV. The codes are
listed below:[¶](#section-6.2.4-4){.pilcrow}

0:
:   Success. Be ready to synchronize.[¶](#section-6.2.4-5.2){.pilcrow}
:   

1:
:   Failure. Malformed message
    received.[¶](#section-6.2.4-5.4){.pilcrow}
:   

2:
:   TLV-Unknown. One or more of the TLVs was not
    understood.[¶](#section-6.2.4-5.6){.pilcrow}
:   

2001:
:   Synch-NoReady. The data to be synchronized is not
    ready.[¶](#section-6.2.4-5.8){.pilcrow}
:   

2002:
:   Synch-Unsupport. The data synchronization is not
    supported.[¶](#section-6.2.4-5.10){.pilcrow}
:   
:::
:::

::: {#sect-6.2.5}
::: {#section-6.2.5 .section}
#### [6.2.5.](#section-6.2.5){.section-number .selfRef} [Sync_Data Message](#name-sync_data-message){.section-name .selfRef} {#name-sync_data-message}

The Sync_Data message is used to send data being synchronized between
the CP and UP. The Sync_Data message has the same function and format as
the Update_Request message. The difference is that there is no ACK for a
Sync_Data message. An error caused by the Sync_Data message will result
in a Sync_End message.[¶](#section-6.2.5-1){.pilcrow}

There are two scenarios:[¶](#section-6.2.5-2){.pilcrow}

-   ::: {#section-6.2.5-3.1}
    Synchronization from UP to CP: Synchronize the resource data to
    CP.[¶](#section-6.2.5-3.1.1){.pilcrow}

    ::: {#section-6.2.5-3.1.2}
    ``` {.sourcecode .lang-rbnf}
          <Sync_Data Message> ::= <Common Header>
                                  [<Interface Status TLV>]
                                  [<Board Status TLV>]
    ```

    [¶](#section-6.2.5-3.1.2){.pilcrow}
    :::
    :::

-   ::: {#section-6.2.5-3.2}
    Synchronization from CP to UP: Synchronize all subscriber sessions
    to the UP. The Subscriber TLVs carried are those appearing in
    [Section 7.9](#sect-7.9){.xref}. As for which TLVs should be
    carried, it depends on the specific session data to be synchronized.
    The process is equivalent to the creation of a particular session.
    Refer to [Section 5](#sect-5){.xref} to see more
    details.[¶](#section-6.2.5-3.2.1){.pilcrow}

    ::: {#section-6.2.5-3.2.2}
    ``` {.sourcecode .lang-rbnf}
          <Sync_Data Message> ::= <Common Header>
                               [<IPv4 Routing TLV>]
                               [<IPv6 Routing TLV>]
                               [<Subscriber TLVs>]
    ```

    [¶](#section-6.2.5-3.2.2){.pilcrow}
    :::
    :::
:::
:::

::: {#sect-6.2.6}
::: {#section-6.2.6 .section}
#### [6.2.6.](#section-6.2.6){.section-number .selfRef} [Sync_End Message](#name-sync_end-message){.section-name .selfRef} {#name-sync_end-message}

The Sync_End message is used to indicate the end of a synchronization
process. The format of a Sync_End message is as
follows:[¶](#section-6.2.6-1){.pilcrow}

::: {#section-6.2.6-2}
``` {.sourcecode .lang-rbnf}
<Sync_End Message> ::= <Common Header>
                        <Error Information TLV>
```

[¶](#section-6.2.6-2){.pilcrow}
:::

The return/error codes are listed as
follows:[¶](#section-6.2.6-3){.pilcrow}

0:
:   Success. Synchronization finished.[¶](#section-6.2.6-4.2){.pilcrow}
:   

1:
:   Failure. Malformed message
    received.[¶](#section-6.2.6-4.4){.pilcrow}
:   

2:
:   TLV-Unknown. One or more of the TLVs was not
    understood.[¶](#section-6.2.6-4.6){.pilcrow}
:   
:::
:::

::: {#sect-6.2.7}
::: {#section-6.2.7 .section}
#### [6.2.7.](#section-6.2.7){.section-number .selfRef} [Update_Request Message](#name-update_request-message){.section-name .selfRef} {#name-update_request-message}

The Update_Request message is a multipurpose message; it can be used to
create, update, and delete subscriber sessions on a
UP.[¶](#section-6.2.7-1){.pilcrow}

For session operations, the specific operation is controlled by the Oper
field of the carried TLVs. As defined in [Section
7.1](#sect-7.1){.xref}, the Oper field can be set to either Update or
Delete when a TLV is carried in an Update_Request
message.[¶](#section-6.2.7-2){.pilcrow}

When the Oper field is set to Update, it means to create or update a
subscriber session. If the Oper field is set to Delete, it is a request
to delete a corresponding session.[¶](#section-6.2.7-3){.pilcrow}

The format of the Update_Request message is as
follows:[¶](#section-6.2.7-4){.pilcrow}

::: {#section-6.2.7-5}
``` {.sourcecode .lang-rbnf}
<Update_Request Message> ::= <Common Header>
                        [<IPv4 Routing TLV>]
                        [<IPv6 Routing TLV>]
                        [<Subscriber TLVs>]
```

[¶](#section-6.2.7-5){.pilcrow}
:::

Where the Subscriber TLVs are those appearing in [Section
7.9](#sect-7.9){.xref}. Each Update_Request message will result in an
Update_Response message, which is defined in [Section
6.2.8](#sect-6.2.8){.xref}.[¶](#section-6.2.7-6){.pilcrow}
:::
:::

::: {#sect-6.2.8}
::: {#section-6.2.8 .section}
#### [6.2.8.](#section-6.2.8){.section-number .selfRef} [Update_Response Message](#name-update_response-message){.section-name .selfRef} {#name-update_response-message}

The Update_Response message is a response to an Update_Request message.
It is used to confirm the update request (or reject it in the case of an
error). The format of an Update_Response message is as
follows:[¶](#section-6.2.8-1){.pilcrow}

::: {#section-6.2.8-2}
``` {.sourcecode .lang-rbnf}
<Update_Response Message> ::= <Common Header>
                        [<Subscriber CGN Port Range TLV>]
                        <Error Information TLV>
```

[¶](#section-6.2.8-2){.pilcrow}
:::

The return/error codes are carried in the Error Information TLV. They
are listed as follows:[¶](#section-6.2.8-3){.pilcrow}

0:
:   Success.[¶](#section-6.2.8-4.2){.pilcrow}
:   

1:
:   Failure. Malformed message
    received.[¶](#section-6.2.8-4.4){.pilcrow}
:   

2:
:   TLV-Unknown. One or more of the TLVs was not
    understood.[¶](#section-6.2.8-4.6){.pilcrow}
:   

3001:
:   Pool-Mismatch. The corresponding address pool cannot be
    found.[¶](#section-6.2.8-4.8){.pilcrow}
:   

3002:
:   Pool-Full. The address pool is fully allocated, and no address
    segment is available.[¶](#section-6.2.8-4.10){.pilcrow}
:   

3003:
:   Subnet-Mismatch. The address pool subnet cannot be
    found.[¶](#section-6.2.8-4.12){.pilcrow}
:   

3004:
:   Subnet-Conflict. Subnets in the address pool have been classified
    into other clients.[¶](#section-6.2.8-4.14){.pilcrow}
:   

4001:
:   Update-Fail-No-Res. The forwarding table fails to be delivered
    because the forwarding resources are
    insufficient.[¶](#section-6.2.8-4.16){.pilcrow}
:   

4002:
:   QoS-Update-Success. The QoS policy takes
    effect.[¶](#section-6.2.8-4.18){.pilcrow}
:   

4003:
:   QoS-Update-Sq-Fail. Failed to process the queue in the QoS
    policy.[¶](#section-6.2.8-4.20){.pilcrow}
:   

4004:
:   QoS-Update-CAR-Fail. Processing of the CAR in the QoS policy
    fails.[¶](#section-6.2.8-4.22){.pilcrow}
:   

4005:
:   Statistic-Fail-No-Res. Statistics processing failed due to
    insufficient statistics resources.[¶](#section-6.2.8-4.24){.pilcrow}
:   
:::
:::
:::
:::

::: {#sect-6.3}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Event Message](#name-event-message){.section-name .selfRef} {#name-event-message}

The Event message is used to report subscriber session traffic
statistics and detection information. The format of the Event message is
as follows:[¶](#section-6.3-1){.pilcrow}

::: {#section-6.3-2}
``` {.sourcecode .lang-rbnf}
<Event Message> ::= <Common Header>
                        [<Subscriber Traffic Statistics Report TLV>]
                        [<Subscriber Detection Result Report TLV>]
```

[¶](#section-6.3-2){.pilcrow}
:::
:::
:::

::: {#sect-6.4}
::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [Report Message](#name-report-message){.section-name .selfRef} {#name-report-message}

The Report message is used to report board and interface status on a UP.
The format of the Report message is as
follows:[¶](#section-6.4-1){.pilcrow}

::: {#section-6.4-2}
``` {.sourcecode .lang-rbnf}
<Report Message> ::= <Common Header>
                        [<Board Status TLVs>]
                        [<Interface Status TLVs>]
```

[¶](#section-6.4-2){.pilcrow}
:::
:::
:::

::: {#sect-6.5}
::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [CGN Messages](#name-cgn-messages){.section-name .selfRef} {#name-cgn-messages}

This document defines the following resource allocation
messages:[¶](#section-6.5-1){.pilcrow}

[]{#name-resource-allocation-message}

  Type   Message Name          TLV that is carried
  ------ --------------------- -----------------------------
  200    Addr_Allocation_Req   Address Allocation Request
  201    Addr_Allocation_Ack   Address Allocation Response
  202    Addr_Renew_Req        Address Renewal Request
  203    Addr_Renew_Ack        Address Renewal Response
  204    Addr_Release_Req      Address Release Request
  205    Addr_Release_Ack      Address Release Response

  : [Table 3](#table-3){.selfRef}: [Resource Allocation
  Messages](#name-resource-allocation-message){.selfRef}

::: {#sect-6.5.1}
::: {#section-6.5.1 .section}
#### [6.5.1.](#section-6.5.1){.section-number .selfRef} [Addr_Allocation_Req Message](#name-addr_allocation_req-message){.section-name .selfRef} {#name-addr_allocation_req-message}

The Addr_Allocation_Req message is used to request CGN address
allocation. The format of the Addr_Allocation_Req message is as
follows:[¶](#section-6.5.1-1){.pilcrow}

::: {#section-6.5.1-2}
``` {.sourcecode .lang-rbnf}
<Addr_Allocation_Req Message> ::= <Common Header>
                        <Address Allocation Request TLV>
```

[¶](#section-6.5.1-2){.pilcrow}
:::
:::
:::

::: {#sect-6.5.2}
::: {#section-6.5.2 .section}
#### [6.5.2.](#section-6.5.2){.section-number .selfRef} [Addr_Allocation_Ack Message](#name-addr_allocation_ack-message){.section-name .selfRef} {#name-addr_allocation_ack-message}

The Addr_Allocation_Ack message is a response to an Addr_Allocation_Req
message. The format of the Addr_Allocation_Ack message is as
follows:[¶](#section-6.5.2-1){.pilcrow}

::: {#section-6.5.2-2}
``` {.sourcecode .lang-rbnf}
<Addr_Allocation_Ack Message> ::= <Common Header>
                        <Address Allocation Response TLV>
```

[¶](#section-6.5.2-2){.pilcrow}
:::
:::
:::

::: {#sect-6.5.3}
::: {#section-6.5.3 .section}
#### [6.5.3.](#section-6.5.3){.section-number .selfRef} [Addr_Renew_Req Message](#name-addr_renew_req-message){.section-name .selfRef} {#name-addr_renew_req-message}

The Addr_Renew_Req message is used to request address renewal. The
format of the Addr_Renew_Req message is as
follows:[¶](#section-6.5.3-1){.pilcrow}

::: {#section-6.5.3-2}
``` {.sourcecode .lang-rbnf}
<Addr_Renew_Req Message> ::= <Common Header>
                        <Address Renewal Request TLV>
```

[¶](#section-6.5.3-2){.pilcrow}
:::
:::
:::

::: {#sect-6.5.4}
::: {#section-6.5.4 .section}
#### [6.5.4.](#section-6.5.4){.section-number .selfRef} [Addr_Renew_Ack Message](#name-addr_renew_ack-message){.section-name .selfRef} {#name-addr_renew_ack-message}

The Addr_Renew_Ack message is a response to an Addr_Renew_Req message.
The format of the Addr_Renew_Req message is as
follows:[¶](#section-6.5.4-1){.pilcrow}

::: {#section-6.5.4-2}
``` {.sourcecode .lang-rbnf}
<Addr_Renew_Ack Message> ::= <Common Header>
                        <Address Renewal Response TLV>
```

[¶](#section-6.5.4-2){.pilcrow}
:::
:::
:::

::: {#sect-6.5.5}
::: {#section-6.5.5 .section}
#### [6.5.5.](#section-6.5.5){.section-number .selfRef} [Addr_Release_Req Message](#name-addr_release_req-message){.section-name .selfRef} {#name-addr_release_req-message}

The Addr_Release_Req message is used to request address release. The
format of the Addr_Release_Req message is as
follows:[¶](#section-6.5.5-1){.pilcrow}

::: {#section-6.5.5-2}
``` {.sourcecode .lang-rbnf}
<Addr_Release_Req Message> ::= <Common Header>
                        <Address Release Request TLV>
```

[¶](#section-6.5.5-2){.pilcrow}
:::
:::
:::

::: {#sect-6.5.6}
::: {#section-6.5.6 .section}
#### [6.5.6.](#section-6.5.6){.section-number .selfRef} [Addr_Release_Ack Message](#name-addr_release_ack-message){.section-name .selfRef} {#name-addr_release_ack-message}

The Addr_Release_Ack message is a response to an Addr_Release_Req
message. The format of the Addr_Release_Ack message is as
follows:[¶](#section-6.5.6-1){.pilcrow}

::: {#section-6.5.6-2}
``` {.sourcecode .lang-rbnf}
<Addr_Release_Ack Message> ::= <Common Header>
                        <Address Release Response TLV>
```

[¶](#section-6.5.6-2){.pilcrow}
:::
:::
:::
:::
:::

::: {#sect-6.6}
::: {#section-6.6 .section}
### [6.6.](#section-6.6){.section-number .selfRef} [Vendor Message](#name-vendor-message){.section-name .selfRef} {#name-vendor-message}

The Vendor message, in conjunction with the Vendor TLV and Vendor
sub-TLV, can be used by vendors to extend S-CUSP. The Message-Type is
11. If the receiver does not recognize the message, an Error message
will be returned to the sender.[¶](#section-6.6-1){.pilcrow}

The format of the Vendor message is as
follows:[¶](#section-6.6-2){.pilcrow}

::: {#section-6.6-3}
``` {.sourcecode .lang-rbnf}
<Vendor Message> ::= <Common Header>
                     <Vendor TLV>
                     [<any other TLVs as specified by the vendor>]
```

[¶](#section-6.6-3){.pilcrow}
:::
:::
:::

::: {#sect-6.7}
::: {#section-6.7 .section}
### [6.7.](#section-6.7){.section-number .selfRef} [Error Message](#name-error-message){.section-name .selfRef} {#name-error-message}

The Error message is defined to return some critical error information
to the sender. If a receiver does not support the type of the received
message, it [MUST]{.bcp14} return an Error message to the
sender.[¶](#section-6.7-1){.pilcrow}

The format of the Error message is as
below:[¶](#section-6.7-2){.pilcrow}

::: {#section-6.7-3}
``` {.sourcecode .lang-rbnf}
<Error Message> ::= <Common Header>
                    <Error Information TLV>
```

[¶](#section-6.7-3){.pilcrow}
:::
:::
:::
:::
:::

::: {#sect-7}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [S-CUSP TLVs and Sub-TLVs](#name-s-cusp-tlvs-and-sub-tlvs){.section-name .selfRef} {#name-s-cusp-tlvs-and-sub-tlvs}

This section specifies the following:[¶](#section-7-1){.pilcrow}

-   [The format of the TLVs that appear in S-CUSP
    messages,[¶](#section-7-2.1){.pilcrow}]{#section-7-2.1}
-   [The format of the sub-TLVs that appear within the values of some
    TLVs, and[¶](#section-7-2.2){.pilcrow}]{#section-7-2.2}
-   [The format of some basic data fields that appear within TLVs or
    sub-TLVs.[¶](#section-7-2.3){.pilcrow}]{#section-7-2.3}

See [Section 8](#sect-9){.xref} for a list of all defined TLVs and
sub-TLVs.[¶](#section-7-3){.pilcrow}

::: {#sect-7.1}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Common TLV Header](#name-common-tlv-header){.section-name .selfRef} {#name-common-tlv-header}

S-CUSP messages consist of the common header specified in [Section
6.1](#sect-6.1){.xref} followed by TLVs formatted as specified in this
section.[¶](#section-7.1-1){.pilcrow}

[]{#name-common-tlv-header-2}

::: {#fig32}
::: {#section-7.1-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Oper  |      TLV-Type         |       TLV-Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                             Value                             ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 32](#figure-32){.selfRef}: [Common TLV
Header](#name-common-tlv-header-2){.selfRef}
:::

Oper (4 bits):
:   For Message-Types that specify an operation on a data set, the Oper
    field is interpreted as Update, Delete, or Reserved as specified in
    [Section 8.3](#sect-9.3){.xref}. For all other Message-Types, the
    Oper field [MUST]{.bcp14} be sent as zero and ignored on
    receipt.[¶](#section-7.1-3.2){.pilcrow}
:   

TLV-Type (12 bits):
:   The type of a TLV. TLV-Type specifies the interpretation and format
    of the Value field of the TLV. See [Section
    8.2](#sect-9.2){.xref}.[¶](#section-7.1-3.4){.pilcrow}
:   

TLV-Length (2 bytes):
:   The length of the Value portion of the TLV in bytes as an unsigned
    integer.[¶](#section-7.1-3.6){.pilcrow}
:   

Value (variable length):
:   This is the portion of the TLV whose size is given by TLV-Length. It
    consists of fields, frequently using one of the basic data field
    types (see [Section 7.2](#sect-7.2){.xref}) and sub-TLVs (see
    [Section 7.3](#sect-7.3){.xref}).[¶](#section-7.1-3.8){.pilcrow}
:   
:::
:::

::: {#sect-7.2}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Basic Data Fields](#name-basic-data-fields){.section-name .selfRef} {#name-basic-data-fields}

This section specifies the binary format of several standard basic data
fields that are used within other data structures in this
specification.[¶](#section-7.2-1){.pilcrow}

STRING:
:   0 to 255 octets. Will be encoded as a sub-TLV (see [Section
    7.3](#sect-7.3){.xref}) to provide the length. The use of this data
    type in S-CUSP is to provide convenient labels for use by network
    operators in configuring and debugging their networks and
    interpreting S-CUSP messages. Subscribers will not normally see
    these labels. They are normally interpreted as ASCII
    \[[RFC20](#RFC0020){.xref}\].[¶](#section-7.2-2.2){.pilcrow}
:   

MAC-Addr:
:   6 octets. Ethernet MAC address
    \[[RFC7042](#RFC7042){.xref}\].[¶](#section-7.2-2.4){.pilcrow}
:   

IPv4-Address:
:   8 octets. 4 octets of the IPv4 address value followed by a 4-octet
    address mask in the format
    XXX.XXX.XXX.XXX.[¶](#section-7.2-2.6){.pilcrow}
:   

IPv6-Address:
:   20 octets. 16 octets of the IPv6 address followed by a 4-octet
    integer n in the range of 0 to 128, which gives the address mask as
    the one\'s complement of 2\*\*(128-n) -
    1.[¶](#section-7.2-2.8){.pilcrow}
:   

VLAN ID:

:   2 octets. As follows
    \[[802.1Q](#IEEE-802.1Q){.xref}\]:[¶](#section-7.2-2.10.1){.pilcrow}

    ::: {#section-7.2-2.10.2 .artwork .art-text .alignLeft}
               0                   1
               0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
              | PRI |D|      VLAN-ID          |
              +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    [¶](#section-7.2-2.10.2){.pilcrow}
    :::

    PRI:
    :   Priority. Default value 7.[¶](#section-7.2-2.10.3.2){.pilcrow}
    :   

    D:
    :   Drop Eligibility Indicator (DEI). Default value
        0.[¶](#section-7.2-2.10.3.4){.pilcrow}
    :   

    VLAN-ID:
    :   Unsigned integer in the range 1-4094. (0 and 4095 are not valid
        VLAN IDs
        \[[802.1Q](#IEEE-802.1Q){.xref}\].)[¶](#section-7.2-2.10.3.6){.pilcrow}
    :   

:   
:::
:::

::: {#sect-7.3}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Sub-TLV Format and Sub-TLVs](#name-sub-tlv-format-and-sub-tlvs){.section-name .selfRef} {#name-sub-tlv-format-and-sub-tlvs}

In some cases, the Value portion of a TLV, as specified in [Section
7.1](#sect-7.1){.xref}, can contain one or more sub-TLVs formatted as
follows:[¶](#section-7.3-1){.pilcrow}

[]{#name-sub-tlv-header}

::: {#fig33}
::: {#section-7.3-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |              Type             |          Length               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Value                                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-...
:::

[Figure 33](#figure-33){.selfRef}: [Sub-TLV
Header](#name-sub-tlv-header){.selfRef}
:::

Type (2 bytes):
:   The type of a sub-TLV. The Type field specifies the interpretation
    and format of the Value field of the TLV. Sub-TLV type values have
    the same meaning regardless of the TLV type of the TLV within which
    the sub-TLV occurs. See [Section
    8.4](#sect-9.4){.xref}.[¶](#section-7.3-3.2){.pilcrow}
:   

Length (2 bytes):
:   The length of the Value portion of the sub-TLV in bytes as an
    unsigned integer.[¶](#section-7.3-3.4){.pilcrow}
:   

Value (variable length):
:   This is the Value portion of the sub-TLV whose size is given by
    Length.[¶](#section-7.3-3.6){.pilcrow}
:   

The sub-TLVs currently specified are defined in the following
subsections.[¶](#section-7.3-4){.pilcrow}

::: {#sect-7.3.1}
::: {#section-7.3.1 .section}
#### [7.3.1.](#section-7.3.1){.section-number .selfRef} [Name Sub-TLVs](#name-name-sub-tlvs){.section-name .selfRef} {#name-name-sub-tlvs}

This document defines the following name sub-TLVs that are used to carry
the name of the corresponding object. The length of each of these
sub-TLVs is variable from 1 to 255 octets. The value is of type STRING
padded with zero octets to a length in octets that is an integer
multiple of 4.[¶](#section-7.3.1-1){.pilcrow}

[]{#name-name-sub-tlvs-2}

  Type   Sub-TLV Name          Meaning
  ------ --------------------- ---------------------------------------
  1      VRF-Name              The name of a VRF
  2      Ingress-QoS-Profile   The name of an ingress QoS profile
  3      Egress-QoS-Profile    The name of an egress QoS profile
  4      User-ACL-Policy       The name of an ACL policy
  5      Multicast-ProfileV4   The name of an IPv4 multicast profile
  6      Multicast-ProfileV6   The name of an IPv6 multicast profile
  9      NAT-Instance          The name of a NAT instance
  10     Pool-Name             The name of an address pool

  : [Table 4](#table-4){.selfRef}: [Name
  Sub-TLVs](#name-name-sub-tlvs-2){.selfRef}
:::
:::

::: {#sect-7.3.2}
::: {#section-7.3.2 .section}
#### [7.3.2.](#section-7.3.2){.section-number .selfRef} [Ingress-CAR Sub-TLV](#name-ingress-car-sub-tlv){.section-name .selfRef} {#name-ingress-car-sub-tlv}

The Ingress-CAR sub-TLV indicates the authorized upstream Committed
Access Rate (CAR) parameters. The sub-TLV type of the Ingress-CAR
sub-TLV is 7. The sub-TLV length is 16. The format is as shown in
[Figure 34](#fig34){.xref}.[¶](#section-7.3.2-1){.pilcrow}

[]{#name-ingress-car-sub-tlv-2}

::: {#fig34}
::: {#section-7.3.2-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  CIR (Committed Information Rate)             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  PIR (Peak Information Rate)                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  CBS (Committed Burst Size)                   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  PBS (Peak Burst Size)                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 34](#figure-34){.selfRef}: [Ingress-CAR
Sub-TLV](#name-ingress-car-sub-tlv-2){.selfRef}
:::

Where:[¶](#section-7.3.2-3){.pilcrow}

-   ::: {#section-7.3.2-4.1}

    CIR (4 bytes):
    :   Guaranteed rate in
        bits/second.[¶](#section-7.3.2-4.1.1.2){.pilcrow}
    :   

    PIR (4 bytes):
    :   Burst rate in bits/second.[¶](#section-7.3.2-4.1.1.4){.pilcrow}
    :   

    CBS (4 bytes):
    :   The token bucket in bytes.[¶](#section-7.3.2-4.1.1.6){.pilcrow}
    :   

    PBS (4 bytes):
    :   Burst token bucket in
        bytes.[¶](#section-7.3.2-4.1.1.8){.pilcrow}
    :   
    :::

These fields are unsigned integers. More details about CIR, PIR, CBS,
and PBS can be found in
\[[RFC2698](#RFC2698){.xref}\].[¶](#section-7.3.2-5){.pilcrow}
:::
:::

::: {#sect-7.3.3}
::: {#section-7.3.3 .section}
#### [7.3.3.](#section-7.3.3){.section-number .selfRef} [Egress-CAR Sub-TLV](#name-egress-car-sub-tlv){.section-name .selfRef} {#name-egress-car-sub-tlv}

The Egress-CAR sub-TLV indicates the authorized downstream Committed
Access Rate (CAR) parameters. The sub-TLV type of the Egress-CAR sub-TLV
is 8. Its sub-TLV length is 16 octets. The format of the value part is
as defined below.[¶](#section-7.3.3-1){.pilcrow}

[]{#name-egress-car-sub-tlv-2}

::: {#fig35}
::: {#section-7.3.3-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  CIR (Committed Information Rate)             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  PIR (Peak Information Rate)                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  CBS (Committed Burst Size)                   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                  PBS (Peak Burst Size)                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 35](#figure-35){.selfRef}: [Egress-CAR
Sub-TLV](#name-egress-car-sub-tlv-2){.selfRef}
:::

Where:[¶](#section-7.3.3-3){.pilcrow}

-   ::: {#section-7.3.3-4.1}

    CIR (4 bytes):
    :   Guaranteed rate in
        bits/second.[¶](#section-7.3.3-4.1.1.2){.pilcrow}
    :   

    PIR (4 bytes):
    :   Burst rate in bits/second.[¶](#section-7.3.3-4.1.1.4){.pilcrow}
    :   

    CBS (4 bytes):
    :   The token bucket in bytes.[¶](#section-7.3.3-4.1.1.6){.pilcrow}
    :   

    PBS (4 bytes):
    :   Burst token bucket in
        bytes.[¶](#section-7.3.3-4.1.1.8){.pilcrow}
    :   
    :::

These fields are unsigned integers. More details about CIR, PIR, CBS,
and PBS can be found in
\[[RFC2698](#RFC2698){.xref}\].[¶](#section-7.3.3-5){.pilcrow}
:::
:::

::: {#sect-7.3.4}
::: {#section-7.3.4 .section}
#### [7.3.4.](#section-7.3.4){.section-number .selfRef} [If-Desc Sub-TLV](#name-if-desc-sub-tlv){.section-name .selfRef} {#name-if-desc-sub-tlv}

The If-Desc sub-TLV is defined to designate an interface. It is an
optional sub-TLV that may be carried in those TLVs that have an If-Index
or Out-If-Index field. The If-Desc sub-TLV is used as a locally unique
identifier within a BNG.[¶](#section-7.3.4-1){.pilcrow}

The sub-TLV type is 11. The sub-TLV length is 12 octets. The format
depends on the If-Type ([Section 8.6](#sect-9.6){.xref}). The format of
the value part is as follows:[¶](#section-7.3.4-2){.pilcrow}

[]{#name-if-desc-sub-tlv-formats}

::: {#fig36}
::: {#section-7.3.4-3.1 .artwork .art-text .alignLeft}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  If-Type (1-5)|    Chassis    |             Slot              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           Sub-Slot            |            Port Number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Sub-Port Number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                     If-Desc Sub-TLV (Physical Port)

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | If-Type (6-7) |                Reserved                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            Logic-ID                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Sub-Port Number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                      If-Desc Sub-TLV (Virtual Port)
:::

[Figure 36](#figure-36){.selfRef}: [If-Desc Sub-TLV
Formats](#name-if-desc-sub-tlv-formats){.selfRef}
:::

Where:[¶](#section-7.3.4-4){.pilcrow}

-   ::: {#section-7.3.4-5.1}

    If-Type:
    :   8 bits in length. The value of this field indicates the type of
        an interface. The If-Type values defined in this document are
        listed in [Section
        8.6](#sect-9.6){.xref}.[¶](#section-7.3.4-5.1.1.2){.pilcrow}
    :   

    Chassis (8 bits):
    :   Identifies the chassis that the interface belongs
        to.[¶](#section-7.3.4-5.1.1.4){.pilcrow}
    :   

    Slot (16 bits):
    :   Identifies the slot that the interface belongs
        to.[¶](#section-7.3.4-5.1.1.6){.pilcrow}
    :   

    Sub-Slot (16 bits):
    :   Identifies the sub-slot the interface belongs
        to.[¶](#section-7.3.4-5.1.1.8){.pilcrow}
    :   

    Port Number (16 bits):
    :   An identifier of a physical port/interface (e.g., If-Type: 1-5).
        It is locally significant within the
        slot/sub-slot.[¶](#section-7.3.4-5.1.1.10){.pilcrow}
    :   

    Sub-Port Number (32 bits):
    :   An identifier of the sub-port. Locally significant within its
        \"parent\" port (physical or
        virtual).[¶](#section-7.3.4-5.1.1.12){.pilcrow}
    :   

    Logic-ID (32 bits):
    :   An identifier of a virtual interface (e.g., If-Type:
        6-7).[¶](#section-7.3.4-5.1.1.14){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.3.5}
::: {#section-7.3.5 .section}
#### [7.3.5.](#section-7.3.5){.section-number .selfRef} [IPv6 Address List Sub-TLV](#name-ipv6-address-list-sub-tlv){.section-name .selfRef} {#name-ipv6-address-list-sub-tlv}

The IPv6 Address List sub-TLV is used to convey one or more IPv6
addresses. It is carried in the IPv6 Subscriber TLV. The sub-TLV type is
12. The sub-TLV length is variable.[¶](#section-7.3.5-1){.pilcrow}

The format of the value part of the IPv6 Address List sub-TLV is as
follows:[¶](#section-7.3.5-2){.pilcrow}

[]{#name-ipv6-address-list-sub-tlv-2}

::: {#fig37}
::: {#section-7.3.5-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                        IPv6 Address                           ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                        IPv6 Address                           ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                            ...                                ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                        IPv6 Address                           ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 37](#figure-37){.selfRef}: [IPv6 Address List
Sub-TLV](#name-ipv6-address-list-sub-tlv-2){.selfRef}
:::

Where:[¶](#section-7.3.5-4){.pilcrow}

-   ::: {#section-7.3.5-5.1}

    IPv6 Address (IPv6-Address):
    :   Each IP Address is of type IP-Address and carries an IPv6
        address and length.[¶](#section-7.3.5-5.1.1.2){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.3.6}
::: {#section-7.3.6 .section}
#### [7.3.6.](#section-7.3.6){.section-number .selfRef} [Vendor Sub-TLV](#name-vendor-sub-tlv){.section-name .selfRef} {#name-vendor-sub-tlv}

The Vendor sub-TLV is intended to be used inside the Value portion of
the Vendor TLV ([Section 7.13](#sect-7.13){.xref}). It provides a
Sub-Type that effectively extends the sub-TLV type in the sub-TLV header
and provides for versioning of Vendor
sub-TLVs.[¶](#section-7.3.6-1){.pilcrow}

The value part of the Vendor sub-TLV is formatted as
follows:[¶](#section-7.3.6-2){.pilcrow}

[]{#name-vendor-sub-tlv-2}

::: {#fig38}
::: {#section-7.3.6-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Vendor-ID                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Sub-Type            |       Sub-Type-Version        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~             Value (other as specified by vendor)              ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 38](#figure-38){.selfRef}: [Vendor
Sub-TLV](#name-vendor-sub-tlv-2){.selfRef}
:::

Where:[¶](#section-7.3.6-4){.pilcrow}

-   ::: {#section-7.3.6-5.1}

    Sub-TLV type:
    :   13.[¶](#section-7.3.6-5.1.1.2){.pilcrow}
    :   

    Sub-TLV length:
    :   Variable.[¶](#section-7.3.6-5.1.1.4){.pilcrow}
    :   

    Vendor-ID (4 bytes):
    :   Vendor ID as defined in RADIUS
        \[[RFC2865](#RFC2865){.xref}\].[¶](#section-7.3.6-5.1.1.6){.pilcrow}
    :   

    Sub-Type (2 bytes):
    :   Used by the vendor to distinguish multiple different
        sub-TLVs.[¶](#section-7.3.6-5.1.1.8){.pilcrow}
    :   

    Sub-Type-Version (2 bytes):
    :   Used by the vendor to distinguish different versions of a
        vendor-defined sub-TLV
        Sub-Type.[¶](#section-7.3.6-5.1.1.10){.pilcrow}
    :   

    Value:
    :   As specified by the
        vendor.[¶](#section-7.3.6-5.1.1.12){.pilcrow}
    :   
    :::

Since vendor code will be handling the sub-TLV after the Vendor-ID field
is recognized, the remainder of the sub-TLV can be organized however the
vendor wants. But it desirable for a vendor to be able to define
multiple different Vendor sub-TLVs and to keep track of different
versions of its vendor-defined sub-TLVs. Thus, it is
[RECOMMENDED]{.bcp14} that the vendor assign a Sub-Type value for each
of that vendor\'s sub-TLVs that is different from other Sub-Type values
that vendor has used. Also, when modifying a vendor-defined sub-TLV in a
way potentially incompatible with a previous definition, the vendor
[SHOULD]{.bcp14} increase the value it is using in the Sub-Type-Version
field.[¶](#section-7.3.6-6){.pilcrow}
:::
:::
:::
:::

::: {#sect-7.4}
::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [Hello TLV](#name-hello-tlv){.section-name .selfRef} {#name-hello-tlv}

The Hello TLV is defined to be carried in the Hello message for version
and capabilities negotiation. It indicates the S-CUSP sub-version and
capabilities supported. The format of the value part of the Hello TLV is
as follows:[¶](#section-7.4-1){.pilcrow}

[]{#name-hello-tlv-2}

::: {#fig39}
::: {#section-7.4-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          VerSupported                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Vendor-ID                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Capabilities                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 39](#figure-39){.selfRef}: [Hello
TLV](#name-hello-tlv-2){.selfRef}
:::

Where:[¶](#section-7.4-3){.pilcrow}

-   ::: {#section-7.4-4.1}

    TLV type:
    :   100.[¶](#section-7.4-4.1.1.2){.pilcrow}
    :   

    TLV length:
    :   12 octets.[¶](#section-7.4-4.1.1.4){.pilcrow}
    :   

    VerSupported:
    :   32 bits in length. It is a bit map of the Sub-Versions of S-CUSP
        that the sender supports. This document specifies Sub-Version
        zero of Major Version 1, that is, Version 1.0. The VerSupported
        field [MUST]{.bcp14} be nonzero. The VerSupported bits are
        numbered from 0 as the most significant bit. Bit 0 indicates
        support of Sub-Version zero, bit 1 indicates support of
        Sub-Version one, etc.[¶](#section-7.4-4.1.1.6){.pilcrow}
    :   

    Vendor-ID:
    :   4 bytes in length. Vendor ID, as defined in RADIUS
        \[[RFC2865](#RFC2865){.xref}\].[¶](#section-7.4-4.1.1.8){.pilcrow}
    :   

    Capabilities:
    :   32 bits in length. Flags that indicate the support of particular
        capabilities by the sender of the Hello. No capabilities are
        defined in this document, so implementations of the version
        specified herein will set this field to zero. The Capabilities
        field of the Hello TLV [MUST]{.bcp14} be checked before any
        other TLVs in the Hello because capabilities defined in the
        future might extend existing TLVs or permit new
        TLVs.[¶](#section-7.4-4.1.1.10){.pilcrow}
    :   
    :::

After the exchange of Hello messages, the CP and UP each perform a
logical AND of the Sub-Version supported by the CP and the UP and
separately perform a logical AND of the Capabilities field for the CP
and the UP.[¶](#section-7.4-5){.pilcrow}

If the result of the AND of the Sub-Versions supported is zero, then no
session can be established, and the connection is torn down. If the
result of the AND of the Sub-Versions supported is nonzero, then the
session uses the highest Sub-Version supported by both the CP and
UP.[¶](#section-7.4-6){.pilcrow}

For example, if one side supports Sub-Versions 1, 3, 4, and 5
(VerSupported = 0x5C000000) and the other side supports 2, 3, and 4
(VerSupported = 0x38000000), then 3 and 4 are the Sub-Versions in
common, and 4 is the highest Sub-Version supported by both sides. So
Sub-Version 4 is used for the session that has been
negotiated.[¶](#section-7.4-7){.pilcrow}

The result of the logical AND of the Capabilities bits will show what
additional capabilities both sides support. If this result is zero,
there are no such capabilities, so none can be used during the session.
If this result is nonzero, it shows the additional capabilities that can
be used during the session. The CP and the UP [MUST NOT]{.bcp14} use a
capability unless both advertise support.[¶](#section-7.4-8){.pilcrow}
:::
:::

::: {#sect-7.5}
::: {#section-7.5 .section}
### [7.5.](#section-7.5){.section-number .selfRef} [Keepalive TLV](#name-keepalive-tlv){.section-name .selfRef} {#name-keepalive-tlv}

The Keepalive TLV is carried in the Hello message. It provides timing
information for this feature. The format of the value part of the
Keepalive TLV is as follows:[¶](#section-7.5-1){.pilcrow}

[]{#name-keepalive-tlv-2}

::: {#fig40}
::: {#section-7.5-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Keepalive   | DeadTimer     |            Reserved           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 40](#figure-40){.selfRef}: [Keepalive
TLV](#name-keepalive-tlv-2){.selfRef}
:::

Where:[¶](#section-7.5-3){.pilcrow}

-   ::: {#section-7.5-4.1}

    TLV type:
    :   102.[¶](#section-7.5-4.1.1.2){.pilcrow}
    :   

    TLV length:
    :   4 octets.[¶](#section-7.5-4.1.1.4){.pilcrow}
    :   

    Keepalive (8 bits):
    :   Indicates the maximum interval (in seconds) between two
        consecutive S-CUSP messages sent by the sender of the message
        containing this TLV as an unsigned integer. The minimum value
        for the Keepalive field is 1 second. When set to 0, once the
        session is established, no further Keepalive messages are sent
        to the remote peer. A [RECOMMENDED]{.bcp14} value for the
        Keepalive frequency is 30
        seconds.[¶](#section-7.5-4.1.1.6){.pilcrow}
    :   

    DeadTimer (8 bits in length):
    :   Specifies the amount of time as an unsigned integer number of
        seconds, after the expiration of which, the S-CUSP peer can
        declare the session with the sender of the Hello message to be
        down if no S-CUSP message has been received. The DeadTimer
        [SHOULD]{.bcp14} be set to 0 and [MUST]{.bcp14} be ignored if
        the Keepalive is set to 0. A [RECOMMENDED]{.bcp14} value for the
        DeadTimer is 4 times the value of the
        Keepalive.[¶](#section-7.5-4.1.1.8){.pilcrow}
    :   

    Reserved:
    :   The Reserved bits [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.5-4.1.1.10){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.6}
::: {#section-7.6 .section}
### [7.6.](#section-7.6){.section-number .selfRef} [Error Information TLV](#name-error-information-tlv){.section-name .selfRef} {#name-error-information-tlv}

The Error Information TLV is a common TLV that can be used in many
responses (e.g., Update_Response message) and ACK messages (e.g.,
Addr_Allocation_Ack message). It is used to convey the information about
an error in the received S-CUSP message. The format of the value part of
the Error Information TLV is as follows:[¶](#section-7.6-1){.pilcrow}

[]{#name-error-information-tlv-2}

::: {#fig41}
::: {#section-7.6-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Message-Type  |  Reserved             |  TLV-Type             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Error Code                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 41](#figure-41){.selfRef}: [Error Information
TLV](#name-error-information-tlv-2){.selfRef}
:::

Where:[¶](#section-7.6-3){.pilcrow}

-   ::: {#section-7.6-4.1}

    TLV type:
    :   101.[¶](#section-7.6-4.1.1.2){.pilcrow}
    :   

    TLV length:
    :   8 octets.[¶](#section-7.6-4.1.1.4){.pilcrow}
    :   

    Message-Type (1 byte):
    :   This parameter is the message type of the message containing an
        error.[¶](#section-7.6-4.1.1.6){.pilcrow}
    :   

    Reserved (1 byte):
    :   [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.6-4.1.1.8){.pilcrow}
    :   

    TLV-Type (2 bytes):
    :   Indicates which TLV caused the
        error.[¶](#section-7.6-4.1.1.10){.pilcrow}
    :   

    Error Code:
    :   4 bytes in length. Indicate the specific Error Code (see
        [Section
        8.5](#sect-9.5){.xref}).[¶](#section-7.6-4.1.1.12){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.7}
::: {#section-7.7 .section}
### [7.7.](#section-7.7){.section-number .selfRef} [BAS Function TLV](#name-bas-function-tlv){.section-name .selfRef} {#name-bas-function-tlv}

The BAS Function TLV is used by a CP to control the access mode,
authentication methods, and other related functions of an interface on a
UP.[¶](#section-7.7-1){.pilcrow}

The format of the BAS Function TLV value part is as
follows:[¶](#section-7.7-2){.pilcrow}

[]{#name-bas-function-tlv-2}

::: {#fig42}
::: {#section-7.7-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          If-Index                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Access-Mode  |  Auth-Method4 |  Auth-Method6 |    Reserved   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                             Flags                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                         Sub-TLVs (optional)                   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 42](#figure-42){.selfRef}: [BAS Function
TLV](#name-bas-function-tlv-2){.selfRef}
:::

Where:[¶](#section-7.7-4){.pilcrow}

-   ::: {#section-7.7-5.1}

    TLV type:
    :   1.[¶](#section-7.7-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.7-5.1.1.4){.pilcrow}
    :   

    If-Index:
    :   4 bytes in length, a unique identifier of an interface of a
        BNG.[¶](#section-7.7-5.1.1.6){.pilcrow}
    :   

    Access-Mode:
    :   1 byte in length. It indicates the access mode of the interface.
        The defined values are listed in [Section
        8.7](#sect-9.7){.xref}.[¶](#section-7.7-5.1.1.8){.pilcrow}
    :   

    Auth-Method4:
    :   1 byte in length. It indicates the authentication on this
        interface for the IPv4 scenario. This field is defined as a
        bitmap. The bits defined in this document are listed in [Section
        8.8](#sect-9.8){.xref}. Other bits are reserved and
        [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.7-5.1.1.10){.pilcrow}
    :   

    Auth-Method6:
    :   1 byte in length. It indicates the authentication on this
        interface for the IPv6 scenario. This field is defined as a
        bitmap. The bits defined in this document are listed in [Section
        8.8](#sect-9.8){.xref}. Other bits are reserved and
        [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.7-5.1.1.12){.pilcrow}
    :   

    Sub-TLVs:

    :   The IF-Desc sub-TLV can be
        carried.[¶](#section-7.7-5.1.1.14.1){.pilcrow}

        If-Desc sub-TLV:
        :   Carries the interface
            information.[¶](#section-7.7-5.1.1.14.2.2){.pilcrow}
        :   

    :   

    Flags:
    :   The Flags field is defined as
        follows:[¶](#section-7.7-5.1.1.16){.pilcrow}
    :   
    :::

[]{#name-interface-flags}

::: {#fig43}
::: {#section-7.7-6.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                MBZ                            |Y|X|P|I|N|A|S|F|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 43](#figure-43){.selfRef}: [Interface
Flags](#name-interface-flags){.selfRef}
:::

Where:[¶](#section-7.7-7){.pilcrow}

-   ::: {#section-7.7-8.1}

    F (IPv4 Trigger) bit:

    :   Indicates whether IPv4 packets can trigger a subscriber to go
        online.[¶](#section-7.7-8.1.1.2.1){.pilcrow}

        1:
        :   Enabled.[¶](#section-7.7-8.1.1.2.2.2){.pilcrow}
        :   

        0:
        :   Disabled.[¶](#section-7.7-8.1.1.2.2.4){.pilcrow}
        :   

    :   

    S (IPv6 Trigger) bit:

    :   Indicates whether IPv6 packets can trigger a subscriber to go
        online.[¶](#section-7.7-8.1.1.4.1){.pilcrow}

        1:
        :   Enabled.[¶](#section-7.7-8.1.1.4.2.2){.pilcrow}
        :   

        0:
        :   Disabled.[¶](#section-7.7-8.1.1.4.2.4){.pilcrow}
        :   

    :   

    A (ARP Trigger) bit:

    :   Indicates whether ARP packets can trigger a subscriber to go
        online.[¶](#section-7.7-8.1.1.6.1){.pilcrow}

        1:
        :   Enabled.[¶](#section-7.7-8.1.1.6.2.2){.pilcrow}
        :   

        0:
        :   Disabled.[¶](#section-7.7-8.1.1.6.2.4){.pilcrow}
        :   

    :   

    N (ND Trigger) bit:

    :   Indicates whether ND packets can trigger a subscriber to go
        online.[¶](#section-7.7-8.1.1.8.1){.pilcrow}

        1:
        :   Enabled.[¶](#section-7.7-8.1.1.8.2.2){.pilcrow}
        :   

        0:
        :   Disabled.[¶](#section-7.7-8.1.1.8.2.4){.pilcrow}
        :   

    :   

    I (IPoE-Flow-Check):

    :   Used for UP detection.[¶](#section-7.7-8.1.1.10.1){.pilcrow}

        1:
        :   Enable traffic
            detection.[¶](#section-7.7-8.1.1.10.2.2){.pilcrow}
        :   

        0:
        :   Disable traffic
            detection.[¶](#section-7.7-8.1.1.10.2.4){.pilcrow}
        :   

    :   

    P (PPP-Flow-Check) bit:

    :   Used for UP detection.[¶](#section-7.7-8.1.1.12.1){.pilcrow}

        1:
        :   Enable traffic
            detection.[¶](#section-7.7-8.1.1.12.2.2){.pilcrow}
        :   

        0:
        :   Disable traffic
            detection.[¶](#section-7.7-8.1.1.12.2.4){.pilcrow}
        :   

    :   

    X (ARP-Proxy) bit:

    :   Indicates whether ARP proxy is enabled on the
        interface.[¶](#section-7.7-8.1.1.14.1){.pilcrow}

        1:
        :   The interface is enabled with ARP proxy and can process ARP
            requests across different network ports and
            VLANs.[¶](#section-7.7-8.1.1.14.2.2){.pilcrow}
        :   

        0:
        :   The ARP proxy is not enabled on the interface and only the
            ARP requests of the same network port and VLAN are
            processed.[¶](#section-7.7-8.1.1.14.2.4){.pilcrow}
        :   

    :   

    Y (ND-Proxy) bit:

    :   Indicates whether ND proxy is enabled on the
        interface.[¶](#section-7.7-8.1.1.16.1){.pilcrow}

        1:
        :   The interface is enabled with ND proxy and can process ND
            requests across different network ports and
            VLANs.[¶](#section-7.7-8.1.1.16.2.2){.pilcrow}
        :   

        0:
        :   The ND proxy is not enabled on the interface and only the ND
            requests of the same network port and VLAN are
            processed.[¶](#section-7.7-8.1.1.16.2.4){.pilcrow}
        :   

    :   

    MBZ:
    :   Reserved bits that [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.7-8.1.1.18){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.8}
::: {#section-7.8 .section}
### [7.8.](#section-7.8){.section-number .selfRef} [Routing TLVs](#name-routing-tlvs){.section-name .selfRef} {#name-routing-tlvs}

Typically, after an S-CUSP session is established between a UP and a CP,
the CP will allocate one or more blocks of IP addresses to the UP. Those
IP addresses will be allocated to subscribers who will dial-up (as
defined in [Section 4.3.1](#sect-4.3.1){.xref}) to the UP. To make sure
that other nodes within the network learn how to reach those IP
addresses, the CP needs to install one or more routes that can reach
those IP addresses on the UP and notify the UP to advertise the routes
to the network.[¶](#section-7.8-1){.pilcrow}

The Routing TLVs are used by a CP to notify a UP of the updates to
network routing information. They can be carried in the Update_Request
message and Sync_Data message.[¶](#section-7.8-2){.pilcrow}

::: {#sect-7.8.1}
::: {#section-7.8.1 .section}
#### [7.8.1.](#section-7.8.1){.section-number .selfRef} [IPv4 Routing TLV](#name-ipv4-routing-tlv){.section-name .selfRef} {#name-ipv4-routing-tlv}

The IPv4 Routing TLV is used to carry information related to IPv4
network routing.[¶](#section-7.8.1-1){.pilcrow}

The format of the TLV value part is as
below:[¶](#section-7.8.1-2){.pilcrow}

[]{#name-ipv4-routing-tlv-2}

::: {#fig44}
::: {#section-7.8.1-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Dest-Address                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Next-Hop                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Out-If-Index                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Cost                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Tag                                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Route-Type             |          Reserved           |A|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Sub-TLVs  (optional)                 ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 44](#figure-44){.selfRef}: [IPv4 Routing
TLV](#name-ipv4-routing-tlv-2){.selfRef}
:::

Where:[¶](#section-7.8.1-4){.pilcrow}

-   ::: {#section-7.8.1-5.1}

    TLV type:
    :   7.[¶](#section-7.8.1-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.8.1-5.1.1.4){.pilcrow}
    :   

    User-ID:
    :   4 bytes in length. This field carries the user identifier. It is
        filled with all Fs when a non-user route is delivered to the
        UP.[¶](#section-7.8.1-5.1.1.6){.pilcrow}
    :   

    Dest-Address (IPv4-Address type):
    :   Identifies the destination
        address.[¶](#section-7.8.1-5.1.1.8){.pilcrow}
    :   

    Next-Hop (IPv4-Address type):
    :   Identifies the next-hop
        address.[¶](#section-7.8.1-5.1.1.10){.pilcrow}
    :   

    Out-If-Index (4 bytes):
    :   Indicates the interface
        index.[¶](#section-7.8.1-5.1.1.12){.pilcrow}
    :   

    Cost (4 bytes):
    :   The cost value of the
        route.[¶](#section-7.8.1-5.1.1.14){.pilcrow}
    :   

    Tag (4 bytes):
    :   The tag value of the
        route.[¶](#section-7.8.1-5.1.1.16){.pilcrow}
    :   

    Route-Type (2 bytes):
    :   The value of this field indicates the route type. The values
        defined in this document are listed in [Section
        8.9](#sect-9.9){.xref}.[¶](#section-7.8.1-5.1.1.18){.pilcrow}
    :   

    Advertise-Flag:

    :   1 bit shown as \"A\" in the figure above ([Figure
        44](#fig44){.xref}). Indicates whether the UP should advertise
        the route. The following flag values are
        defined:[¶](#section-7.8.1-5.1.1.20.1){.pilcrow}

        0:
        :   Not advertised.[¶](#section-7.8.1-5.1.1.20.2.2){.pilcrow}
        :   

        1:
        :   Advertised.[¶](#section-7.8.1-5.1.1.20.2.4){.pilcrow}
        :   

    :   

    Sub-TLVs:

    :   The VRF-Name and/or If-Desc sub-TLVs can be
        carried.[¶](#section-7.8.1-5.1.1.22.1){.pilcrow}

        VRF-Name sub-TLV:
        :   Indicates which VRF the route belongs
            to.[¶](#section-7.8.1-5.1.1.22.2.2){.pilcrow}
        :   

        If-Desc sub-TLV:
        :   Carries the interface
            information.[¶](#section-7.8.1-5.1.1.22.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.8.1-5.1.1.24){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.8.2}
::: {#section-7.8.2 .section}
#### [7.8.2.](#section-7.8.2){.section-number .selfRef} [IPv6 Routing TLV](#name-ipv6-routing-tlv){.section-name .selfRef} {#name-ipv6-routing-tlv}

The IPv6 Routing TLV is used to carry IPv6 network routing
information.[¶](#section-7.8.2-1){.pilcrow}

The format of the value part of this TLV is as
follows:[¶](#section-7.8.2-2){.pilcrow}

[]{#name-ipv6-routing-tlv-2}

::: {#fig45}
::: {#section-7.8.2-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          IPv6 Dest-Address                    ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          IPv6 Next-Hop                        ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Out-If-Index                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Cost                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Tag                                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Route-Type             |          Reserved           |A|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Sub-TLVs (optional)                  ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 45](#figure-45){.selfRef}: [IPv6 Routing
TLV](#name-ipv6-routing-tlv-2){.selfRef}
:::

Where:[¶](#section-7.8.2-4){.pilcrow}

-   ::: {#section-7.8.2-5.1}

    TLV type:
    :   8.[¶](#section-7.8.2-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.8.2-5.1.1.4){.pilcrow}
    :   

    User-ID:
    :   4 bytes in length. This field carries the user identifier. This
        field is filled with all Fs when a non-user route is delivered
        to the UP.[¶](#section-7.8.2-5.1.1.6){.pilcrow}
    :   

    IPv6 Dest-Address (IPv6-Address type):
    :   Identifies the destination
        address.[¶](#section-7.8.2-5.1.1.8){.pilcrow}
    :   

    IPv6 Next-Hop (IPv6-Address type):
    :   Identifies the next-hop
        address.[¶](#section-7.8.2-5.1.1.10){.pilcrow}
    :   

    Out-If-Index (4 bytes):
    :   Indicates the interface
        index.[¶](#section-7.8.2-5.1.1.12){.pilcrow}
    :   

    Cost (4 bytes):
    :   This is the cost value of the
        route.[¶](#section-7.8.2-5.1.1.14){.pilcrow}
    :   

    Tag (4 bytes):
    :   The tag value of the
        route.[¶](#section-7.8.2-5.1.1.16){.pilcrow}
    :   

    Route-Type (2 bytes):
    :   The value of this field indicates the route type. The values
        defined in this document are listed in [Section
        8.9](#sect-9.9){.xref}.[¶](#section-7.8.2-5.1.1.18){.pilcrow}
    :   

    Advertise-Flag:

    :   1 bit shown as \"A\" in the figure above ([Figure
        45](#fig45){.xref}). Indicates whether the UP should advertise
        the route. The following flags are
        defined:[¶](#section-7.8.2-5.1.1.20.1){.pilcrow}

        0:
        :   Not advertised.[¶](#section-7.8.2-5.1.1.20.2.2){.pilcrow}
        :   

        1:
        :   Advertised.[¶](#section-7.8.2-5.1.1.20.2.4){.pilcrow}
        :   

    :   

    Sub-TLVs:

    :   The If-Desc and VRF-Name sub-TLVs can be
        carried.[¶](#section-7.8.2-5.1.1.22.1){.pilcrow}

        VRF-Name sub-TLV:
        :   Indicates the VRF to which the subscriber
            belongs.[¶](#section-7.8.2-5.1.1.22.2.2){.pilcrow}
        :   

        If-Desc sub-TLV:
        :   Carries the interface
            information.[¶](#section-7.8.2-5.1.1.22.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.8.2-5.1.1.24){.pilcrow}
    :   
    :::
:::
:::
:::
:::

::: {#sect-7.9}
::: {#section-7.9 .section}
### [7.9.](#section-7.9){.section-number .selfRef} [Subscriber TLVs](#name-subscriber-tlvs){.section-name .selfRef} {#name-subscriber-tlvs}

The Subscriber TLVs are defined for a CP to send the basic information
about a user to a UP.[¶](#section-7.9-1){.pilcrow}

::: {#sect-7.9.1}
::: {#section-7.9.1 .section}
#### [7.9.1.](#section-7.9.1){.section-number .selfRef} [Basic Subscriber TLV](#name-basic-subscriber-tlv){.section-name .selfRef} {#name-basic-subscriber-tlv}

The Basic Subscriber TLV is used to carry the common information for all
kinds of access subscribers. It is carried in an Update_Request
message.[¶](#section-7.9.1-1){.pilcrow}

The format of the Basic Subscriber TLV value part is as
follows:[¶](#section-7.9.1-2){.pilcrow}

[]{#name-basic-subscriber-tlv-2}

::: {#fig46}
::: {#section-7.9.1-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Session-ID                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-MAC                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        User-MAC (cont.)       |   Oper-ID     |    Reserved   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Access-Type   |Sub-Access-Type|  Account-Type | Address Family|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |               C-VID           |          P-VID                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |               Detect-Times    |          Detect-Interval      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            If-Index                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                            Sub-TLVs (optional)                ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 46](#figure-46){.selfRef}: [Basic Subscriber
TLV](#name-basic-subscriber-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.1-4){.pilcrow}

-   ::: {#section-7.9.1-5.1}

    TLV type:
    :   2.[¶](#section-7.9.1-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.1-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        subscriber.[¶](#section-7.9.1-5.1.1.6){.pilcrow}
    :   

    Session-ID (4 bytes):
    :   Session ID of a PPPoE subscriber. The value zero identifies a
        non-PPPoE subscriber.[¶](#section-7.9.1-5.1.1.8){.pilcrow}
    :   

    User-MAC (MAC-Addr type):
    :   The MAC address of a
        subscriber.[¶](#section-7.9.1-5.1.1.10){.pilcrow}
    :   

    Oper-ID (1 byte):
    :   Indicates the ID of an operation performed by a user. This field
        is carried in the response from the
        UP.[¶](#section-7.9.1-5.1.1.12){.pilcrow}
    :   

    Reserved (1 byte):
    :   [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.1-5.1.1.14){.pilcrow}
    :   

    Access-Type (1 byte):
    :   Indicates the type of subscriber access. Values defined in this
        document are listed in [Section
        8.10](#sect-9.10){.xref}.[¶](#section-7.9.1-5.1.1.16){.pilcrow}
    :   

    Sub-Access-Type (1 byte):

    :   Indicates whether PPP termination or PPP relay is
        used.[¶](#section-7.9.1-5.1.1.18.1){.pilcrow}

        0:
        :   Reserved.[¶](#section-7.9.1-5.1.1.18.2.2){.pilcrow}
        :   

        1:
        :   PPP Relay (for
            LAC).[¶](#section-7.9.1-5.1.1.18.2.4){.pilcrow}
        :   

        2:
        :   PPP termination (for
            LNS).[¶](#section-7.9.1-5.1.1.18.2.6){.pilcrow}
        :   

    :   

    Account-Type (1 byte):

    :   Indicates whether traffic statistics are collected
        independently.[¶](#section-7.9.1-5.1.1.20.1){.pilcrow}

        0:
        :   Collects statistics on IPv4 and IPv6 traffic of terminals
            independently.[¶](#section-7.9.1-5.1.1.20.2.2){.pilcrow}
        :   

        1:
        :   Collects statistics on IPv4 and IPv6 traffic of
            terminals.[¶](#section-7.9.1-5.1.1.20.2.4){.pilcrow}
        :   

    :   

    Address Family (1 byte):

    :   The type of IP address.[¶](#section-7.9.1-5.1.1.22.1){.pilcrow}

        1:
        :   IPv4.[¶](#section-7.9.1-5.1.1.22.2.2){.pilcrow}
        :   

        2:
        :   IPv6.[¶](#section-7.9.1-5.1.1.22.2.4){.pilcrow}
        :   

        3:
        :   Dual stack.[¶](#section-7.9.1-5.1.1.22.2.6){.pilcrow}
        :   

    :   

    C-VID (VLAN-ID):
    :   Indicates the inner VLAN ID. The value 0 indicates that the VLAN
        ID is invalid. The default value of PRI is 7, the value of DEI
        is 0, and the value of VID is 1-4094. The PRI value can also be
        obtained by parsing terminal
        packets.[¶](#section-7.9.1-5.1.1.24){.pilcrow}
    :   

    P-VID (VLAN-ID):
    :   Indicates the outer VLAN ID. The value 0 indicates that the VLAN
        ID is invalid. The format is the same as that for
        C-VID.[¶](#section-7.9.1-5.1.1.26){.pilcrow}
    :   

    Detect-Times (2 bytes):
    :   Number of detection timeout times. The value 0 indicates that no
        detection is performed.[¶](#section-7.9.1-5.1.1.28){.pilcrow}
    :   

    Detect-Interval (2 bytes):
    :   Detection interval in
        seconds.[¶](#section-7.9.1-5.1.1.30){.pilcrow}
    :   

    If-Index (4 bytes):
    :   Interface index.[¶](#section-7.9.1-5.1.1.32){.pilcrow}
    :   

    Sub-TLVs:

    :   The VRF-Name sub-TLV and If-Desc sub-TLV can be
        carried.[¶](#section-7.9.1-5.1.1.34.1){.pilcrow}

        VRF-Name sub-TLV:
        :   Indicates the VRF to which the subscriber
            belongs.[¶](#section-7.9.1-5.1.1.34.2.2){.pilcrow}
        :   

        If-Desc sub-TLV:
        :   Carries the interface
            information.[¶](#section-7.9.1-5.1.1.34.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.1-5.1.1.36){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.2}
::: {#section-7.9.2 .section}
#### [7.9.2.](#section-7.9.2){.section-number .selfRef} [PPP Subscriber TLV](#name-ppp-subscriber-tlv){.section-name .selfRef} {#name-ppp-subscriber-tlv}

The PPP Subscriber TLV is defined to carry PPP information of a user
from a CP to a UP. It will be carried in an Update_Request message when
PPPoE or L2TP access is used.[¶](#section-7.9.2-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.2-2){.pilcrow}

[]{#name-ppp-subscriber-tlv-2}

::: {#fig47}
::: {#section-7.9.2-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        MSS-Value              |        Reserved             |M|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        MRU                    |        Reserved               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Magic-Number                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Peer-Magic-Number                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 47](#figure-47){.selfRef}: [PPP Subscriber
TLV](#name-ppp-subscriber-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.2-4){.pilcrow}

-   ::: {#section-7.9.2-5.1}

    TLV type:
    :   3.[¶](#section-7.9.2-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   12 octets.[¶](#section-7.9.2-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        subscriber.[¶](#section-7.9.2-5.1.1.6){.pilcrow}
    :   

    MSS-Value (2 bytes):
    :   Indicates the MSS value (in
        bytes).[¶](#section-7.9.2-5.1.1.8){.pilcrow}
    :   

    MSS-Enable (M) (1 bit):

    :   Indicates whether the MSS is
        enabled.[¶](#section-7.9.2-5.1.1.10.1){.pilcrow}

        0:
        :   Disabled.[¶](#section-7.9.2-5.1.1.10.2.2){.pilcrow}
        :   

        1:
        :   Enabled.[¶](#section-7.9.2-5.1.1.10.2.4){.pilcrow}
        :   

    :   

    MRU (2 bytes):
    :   PPPoE local MRU (in
        bytes).[¶](#section-7.9.2-5.1.1.12){.pilcrow}
    :   

    Magic-Number (4 bytes):
    :   Local magic number in PPP negotiation
        packets.[¶](#section-7.9.2-5.1.1.14){.pilcrow}
    :   

    Peer-Magic-Number (4 bytes):
    :   Remote peer magic number.[¶](#section-7.9.2-5.1.1.16){.pilcrow}
    :   

    Reserved:
    :   The Reserved fields [MUST]{.bcp14} be sent as zero and ignored
        on receipt.[¶](#section-7.9.2-5.1.1.18){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.3}
::: {#section-7.9.3 .section}
#### [7.9.3.](#section-7.9.3){.section-number .selfRef} [IPv4 Subscriber TLV](#name-ipv4-subscriber-tlv){.section-name .selfRef} {#name-ipv4-subscriber-tlv}

The IPv4 Subscriber TLV is defined to carry IPv4-related information for
a BNG user. It will be carried in an Update_Request message when IPv4
IPoE or PPPoE access is used.[¶](#section-7.9.3-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.3-2){.pilcrow}

[]{#name-ipv4-subscriber-tlv-2}

::: {#fig48}
::: {#section-7.9.3-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-IPv4                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Gateway-IPv4                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          MTU                  |   Reserved            |U|E|W|P|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          VRF-Name Sub-TLV                     ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 48](#figure-48){.selfRef}: [IPv4 Subscriber
TLV](#name-ipv4-subscriber-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.3-4){.pilcrow}

-   ::: {#section-7.9.3-5.1}

    TLV type:
    :   4.[¶](#section-7.9.3-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.3-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        subscriber.[¶](#section-7.9.3-5.1.1.6){.pilcrow}
    :   

    User-IPv4 (IPv4-Address):
    :   The IPv4 address of the
        subscriber.[¶](#section-7.9.3-5.1.1.8){.pilcrow}
    :   

    Gateway-IPv4 (IPv4-Address):
    :   The gateway address of the
        subscriber.[¶](#section-7.9.3-5.1.1.10){.pilcrow}
    :   

    Portal-Force (P) (1 bit):

    :   Push advertisement.[¶](#section-7.9.3-5.1.1.12.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.3-5.1.1.12.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.3-5.1.1.12.2.4){.pilcrow}
        :   

    :   

    Web-Force (W) (1 bit):

    :   Push IPv4 Web.[¶](#section-7.9.3-5.1.1.14.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.3-5.1.1.14.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.3-5.1.1.14.2.4){.pilcrow}
        :   

    :   

    Echo-Enable (E) (1 bit):

    :   UP returns ARP Req or PPP
        Echo.[¶](#section-7.9.3-5.1.1.16.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.3-5.1.1.16.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.3-5.1.1.16.2.4){.pilcrow}
        :   

    :   

    IPv4-URPF (U) (1 bit):

    :   User Unicast Reverse Path Forwarding (URPF)
        flag.[¶](#section-7.9.3-5.1.1.18.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.3-5.1.1.18.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.3-5.1.1.18.2.4){.pilcrow}
        :   

    :   

    MTU (2 bytes):
    :   MTU value. The default value is
        1500.[¶](#section-7.9.3-5.1.1.20){.pilcrow}
    :   

    VRF-Name Sub-TLV:
    :   Indicates the subscriber belongs to which
        VRF.[¶](#section-7.9.3-5.1.1.22){.pilcrow}
    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.3-5.1.1.24){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.4}
::: {#section-7.9.4 .section}
#### [7.9.4.](#section-7.9.4){.section-number .selfRef} [IPv6 Subscriber TLV](#name-ipv6-subscriber-tlv){.section-name .selfRef} {#name-ipv6-subscriber-tlv}

The IPv6 Subscriber TLV is defined to carry IPv6-related information for
a BNG user. It will be carried in an Update_Request message when IPv6
IPoE or PPPoE access is used.[¶](#section-7.9.4-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.4-2){.pilcrow}

[]{#name-ipv6-subscriber-tlv-2}

::: {#fig49}
::: {#section-7.9.4-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~           User PD-Address (IPv6 Address List Sub-TLV)         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~        Gateway ND-Address (IPv6 Address List Sub-TLV)         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User Link-Local-Address              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          IPv6 Interface ID                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          IPv6 Interface ID (cont.)            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          MTU                  |   Reserved            |U|E|W|P|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                    VRF Name Sub-TLV (optional)                ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 49](#figure-49){.selfRef}: [IPv6 Subscriber
TLV](#name-ipv6-subscriber-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.4-4){.pilcrow}

-   ::: {#section-7.9.4-5.1}

    TLV type:
    :   5.[¶](#section-7.9.4-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.4-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        subscriber.[¶](#section-7.9.4-5.1.1.6){.pilcrow}
    :   

    User PD-Addresses (IPv6 Address List):
    :   Carries a list of Prefix Delegation (PD) addresses of the
        subscriber.[¶](#section-7.9.4-5.1.1.8){.pilcrow}
    :   

    User ND-Addresses (IPv6 Address List):
    :   Carries a list of Neighbor Discovery (ND) addresses of the
        subscriber.[¶](#section-7.9.4-5.1.1.10){.pilcrow}
    :   

    User Link-Local-Address (IPv6-Address):
    :   The link-local address of the
        subscriber.[¶](#section-7.9.4-5.1.1.12){.pilcrow}
    :   

    IPv6 Interface ID (8 bytes):
    :   The identifier of an IPv6
        interface.[¶](#section-7.9.4-5.1.1.14){.pilcrow}
    :   

    Portal-Force 1 bit (P):

    :   Push advertisement.[¶](#section-7.9.4-5.1.1.16.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.4-5.1.1.16.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.4-5.1.1.16.2.4){.pilcrow}
        :   

    :   

    Web-Force 1 bit (W):

    :   Push IPv6 Web.[¶](#section-7.9.4-5.1.1.18.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.4-5.1.1.18.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.4-5.1.1.18.2.4){.pilcrow}
        :   

    :   

    Echo-Enable 1 bit (E):

    :   The UP returns ARP Req or PPP
        Echo.[¶](#section-7.9.4-5.1.1.20.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.4-5.1.1.20.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.4-5.1.1.20.2.4){.pilcrow}
        :   

    :   

    IPv6-URPF 1 bit (U):

    :   User Reverse Path Forwarding (URPF)
        flag.[¶](#section-7.9.4-5.1.1.22.1){.pilcrow}

        0:
        :   Off.[¶](#section-7.9.4-5.1.1.22.2.2){.pilcrow}
        :   

        1:
        :   On.[¶](#section-7.9.4-5.1.1.22.2.4){.pilcrow}
        :   

    :   

    MTU (2 bytes):
    :   The MTU value. The default value is
        1500.[¶](#section-7.9.4-5.1.1.24){.pilcrow}
    :   

    VRF-Name Sub-TLV:
    :   Indicates the VRF to which the subscriber
        belongs.[¶](#section-7.9.4-5.1.1.26){.pilcrow}
    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.4-5.1.1.28){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.5}
::: {#section-7.9.5 .section}
#### [7.9.5.](#section-7.9.5){.section-number .selfRef} [IPv4 Static Subscriber Detect TLV](#name-ipv4-static-subscriber-dete){.section-name .selfRef} {#name-ipv4-static-subscriber-dete}

The IPv4 Static Subscriber Detect TLV is defined to carry IPv4-related
information for a static access subscriber. It will be carried in an
Update_Request message when IPv4 static access on a UP needs to be
enabled.[¶](#section-7.9.5-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.5-2){.pilcrow}

[]{#name-ipv4-static-subscriber-tlv}

::: {#fig50}
::: {#section-7.9.5-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          If-Index                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           C-VID               |           P-VID               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User Address                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Gateway Address                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-MAC                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        User-MAC (cont.)       |           Reserved            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                       Sub-TLVs (optional)                     ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 50](#figure-50){.selfRef}: [IPv4 Static Subscriber
TLV](#name-ipv4-static-subscriber-tlv){.selfRef}
:::

Where:[¶](#section-7.9.5-4){.pilcrow}

-   ::: {#section-7.9.5-5.1}

    TLV type:
    :   9.[¶](#section-7.9.5-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.5-5.1.1.4){.pilcrow}
    :   

    If-Index (4 bytes):
    :   The interface index of the interface from which the subscriber
        will dial-up.[¶](#section-7.9.5-5.1.1.6){.pilcrow}
    :   

    C-VID (VLAN-ID):
    :   Indicates the inner VLAN ID. The value 0 indicates that the VLAN
        ID is invalid. A valid value is
        1-4094.[¶](#section-7.9.5-5.1.1.8){.pilcrow}
    :   

    P-VID (VLAN-ID):
    :   Indicates the outer VLAN ID. The value 0 indicates that the VLAN
        ID is invalid. The format is the same as that of the C-VID. A
        valid value is 1-4094.[¶](#section-7.9.5-5.1.1.10){.pilcrow}
    :   

    User Address (IPv4-Addr):
    :   The user\'s IPv4 address.[¶](#section-7.9.5-5.1.1.12){.pilcrow}
    :   

    Gateway Address (IPv4-Addr):
    :   The gateway\'s IPv4
        address.[¶](#section-7.9.5-5.1.1.14){.pilcrow}
    :   

    User-MAC (MAC-Addr type):
    :   The MAC address of the
        subscriber.[¶](#section-7.9.5-5.1.1.16){.pilcrow}
    :   

    Sub-TLVs:

    :   The VRF-Name and If-Desc sub-TLVs may be
        carried.[¶](#section-7.9.5-5.1.1.18.1){.pilcrow}

        VRF-Name sub-TLV:
        :   Indicates the VRF to which the subscriber
            belongs.[¶](#section-7.9.5-5.1.1.18.2.2){.pilcrow}
        :   

        If-Desc sub-TLV:
        :   Carries the interface
            information.[¶](#section-7.9.5-5.1.1.18.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.5-5.1.1.20){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.6}
::: {#section-7.9.6 .section}
#### [7.9.6.](#section-7.9.6){.section-number .selfRef} [IPv6 Static Subscriber Detect TLV](#name-ipv6-static-subscriber-dete){.section-name .selfRef} {#name-ipv6-static-subscriber-dete}

The IPv6 Static Subscriber Detect TLV is defined to carry IPv6-related
information for a static access subscriber. It will be carried in an
Update_Request message when needed to enable IPv6 static subscriber
detection on a UP.[¶](#section-7.9.6-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.6-2){.pilcrow}

[]{#name-ipv6-static-subscriber-detec}

::: {#fig51}
::: {#section-7.9.6-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          If-Index                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           C-VID               |           P-VID               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          User Address                         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Gateway Address                      ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-MAC                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        User-MAC (cont.)       |           Reserved            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                        Sub-TLVs (optional)                     ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 51](#figure-51){.selfRef}: [IPv6 Static Subscriber Detect
TLV](#name-ipv6-static-subscriber-detec){.selfRef}
:::

Where:[¶](#section-7.9.6-4){.pilcrow}

-   ::: {#section-7.9.6-5.1}

    TLV type:
    :   10.[¶](#section-7.9.6-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.6-5.1.1.4){.pilcrow}
    :   

    If-Index (4 bytes):
    :   The interface index of the interface from which the subscriber
        will dial-up.[¶](#section-7.9.6-5.1.1.6){.pilcrow}
    :   

    C-VID (VLAN-ID):
    :   Indicates the inner VLAN ID. The value 0 indicates that the VLAN
        ID is invalid. A valid value is
        1-4094.[¶](#section-7.9.6-5.1.1.8){.pilcrow}
    :   

    P-VID (VLAN-ID):
    :   Indicates the outer VLAN ID. The value 0 indicates that the VLAN
        ID is invalid. The format is the same as that the of C-VID. A
        valid value is 1-4094.[¶](#section-7.9.6-5.1.1.10){.pilcrow}
    :   

    User Address (IPv6-Address type):
    :   The subscriber\'s IPv6
        address.[¶](#section-7.9.6-5.1.1.12){.pilcrow}
    :   

    Gateway Address (IPv6-Address type):
    :   The gateway\'s IPv6
        Address.[¶](#section-7.9.6-5.1.1.14){.pilcrow}
    :   

    User-MAC (MAC-Addr type):
    :   The MAC address of the
        subscriber.[¶](#section-7.9.6-5.1.1.16){.pilcrow}
    :   

    Sub-TLVs:

    :   VRF-Name and If-Desc sub-TLVs may be
        carried[¶](#section-7.9.6-5.1.1.18.1){.pilcrow}

        VRF-Name sub-TLV:
        :   Indicates the VRF to which the subscriber
            belongs.[¶](#section-7.9.6-5.1.1.18.2.2){.pilcrow}
        :   

        If-Desc sub-TLV:
        :   Carries the interface
            information.[¶](#section-7.9.6-5.1.1.18.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.6-5.1.1.20){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.7}
::: {#section-7.9.7 .section}
#### [7.9.7.](#section-7.9.7){.section-number .selfRef} [L2TP-LAC Subscriber TLV](#name-l2tp-lac-subscriber-tlv){.section-name .selfRef} {#name-l2tp-lac-subscriber-tlv}

The L2TP-LAC Subscriber TLV is defined to carry the related information
for an L2TP LAC access subscriber. It will be carried in an
Update_Request message when L2TP LAC access is
used.[¶](#section-7.9.7-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.7-2){.pilcrow}

[]{#name-l2tp-lac-subscriber-tlv-2}

::: {#fig52}
::: {#section-7.9.7-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Local-Tunnel-ID          |     Local-Session-ID          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Remote-Tunnel-ID         |     Remote-Session-ID         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 52](#figure-52){.selfRef}: [L2TP-LAC Subscriber
TLV](#name-l2tp-lac-subscriber-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.7-4){.pilcrow}

-   ::: {#section-7.9.7-5.1}

    TLV type:
    :   11.[¶](#section-7.9.7-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   12 octets.[¶](#section-7.9.7-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        user/subscriber.[¶](#section-7.9.7-5.1.1.6){.pilcrow}
    :   

    Local-Tunnel-ID (2 bytes):
    :   The local ID of the L2TP
        tunnel.[¶](#section-7.9.7-5.1.1.8){.pilcrow}
    :   

    Local-Session-ID (2 bytes):
    :   The local session ID with the L2TP
        tunnel.[¶](#section-7.9.7-5.1.1.10){.pilcrow}
    :   

    Remote-Tunnel-ID (2 bytes):
    :   The identifier of the L2TP tunnel at the remote
        endpoint.[¶](#section-7.9.7-5.1.1.12){.pilcrow}
    :   

    Remote-Session-ID (2 bytes):
    :   The session ID of the L2TP tunnel at the remote
        endpoint.[¶](#section-7.9.7-5.1.1.14){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.8}
::: {#section-7.9.8 .section}
#### [7.9.8.](#section-7.9.8){.section-number .selfRef} [L2TP-LNS Subscriber TLV](#name-l2tp-lns-subscriber-tlv){.section-name .selfRef} {#name-l2tp-lns-subscriber-tlv}

The L2TP-LNS Subscriber TLV is defined to carry the related information
for a L2TP LNS access subscriber. It will be carried in an
Update_Request message when L2TP LNS access is
used.[¶](#section-7.9.8-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.8-2){.pilcrow}

[]{#name-l2tp-lns-subscriber-tlv-2}

::: {#fig53}
::: {#section-7.9.8-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Local-Tunnel-ID          |     Local-Session-ID          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Remote-Tunnel-ID         |     Remote-Session-ID         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 53](#figure-53){.selfRef}: [L2TP-LNS Subscriber
TLV](#name-l2tp-lns-subscriber-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.8-4){.pilcrow}

-   ::: {#section-7.9.8-5.1}

    TLV type:
    :   12.[¶](#section-7.9.8-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   12 octets.[¶](#section-7.9.8-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        user/subscriber.[¶](#section-7.9.8-5.1.1.6){.pilcrow}
    :   

    Local-Tunnel-ID (2 bytes):
    :   The local ID of the L2TP
        tunnel.[¶](#section-7.9.8-5.1.1.8){.pilcrow}
    :   

    Local-Session-ID (2 bytes):
    :   The local session ID with the L2TP
        tunnel.[¶](#section-7.9.8-5.1.1.10){.pilcrow}
    :   

    Remote-Tunnel-ID (2 bytes):
    :   The identifier of the L2TP tunnel at the remote
        endpoint.[¶](#section-7.9.8-5.1.1.12){.pilcrow}
    :   

    Remote-Session-ID (2 bytes):
    :   The session ID of the L2TP tunnel at the remote
        endpoint.[¶](#section-7.9.8-5.1.1.14){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.9}
::: {#section-7.9.9 .section}
#### [7.9.9.](#section-7.9.9){.section-number .selfRef} [L2TP-LAC Tunnel TLV](#name-l2tp-lac-tunnel-tlv){.section-name .selfRef} {#name-l2tp-lac-tunnel-tlv}

The L2TP-LAC Tunnel TLV is defined to carry information related to the
L2TP LAC tunnel. It will be carried in the Update_Request message when
L2TP LAC access is used.[¶](#section-7.9.9-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.9-2){.pilcrow}

[]{#name-l2tp-lac-tunnel-tlv-2}

::: {#fig54}
::: {#section-7.9.9-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |       Local-Tunnel-ID         |       Remote-Tunnel-ID        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Source-Port         |           Dest-Port           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Source-IP                            ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Dest-IP                              ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          VRF-Name Sub-TLV                     ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 54](#figure-54){.selfRef}: [L2TP-LAC Tunnel
TLV](#name-l2tp-lac-tunnel-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.9-4){.pilcrow}

-   ::: {#section-7.9.9-5.1}

    TLV type:
    :   13.[¶](#section-7.9.9-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.9-5.1.1.4){.pilcrow}
    :   

    Local-Tunnel-ID (2 bytes):
    :   The local ID of the L2TP
        tunnel.[¶](#section-7.9.9-5.1.1.6){.pilcrow}
    :   

    Remote-Tunnel-ID (2 bytes):
    :   The remote ID of the L2TP
        tunnel.[¶](#section-7.9.9-5.1.1.8){.pilcrow}
    :   

    Source-Port (2 bytes):
    :   The source UDP port number of an L2TP
        subscriber.[¶](#section-7.9.9-5.1.1.10){.pilcrow}
    :   

    Dest-Port (2 bytes):
    :   The destination UDP port number of an L2TP
        subscriber.[¶](#section-7.9.9-5.1.1.12){.pilcrow}
    :   

    Source-IP (IPv4/v6):
    :   The source IP address of the
        tunnel.[¶](#section-7.9.9-5.1.1.14){.pilcrow}
    :   

    Dest-IP (IPv4/v6):
    :   The destination IP address of the
        tunnel.[¶](#section-7.9.9-5.1.1.16){.pilcrow}
    :   

    VRF-Name Sub-TLV:
    :   The VRF name to which the L2TP subscriber tunnel
        belongs.[¶](#section-7.9.9-5.1.1.18){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.10}
::: {#section-7.9.10 .section}
#### [7.9.10.](#section-7.9.10){.section-number .selfRef} [L2TP-LNS Tunnel TLV](#name-l2tp-lns-tunnel-tlv){.section-name .selfRef} {#name-l2tp-lns-tunnel-tlv}

The L2TP-LNS Tunnel TLV is defined to carry information related to the
L2TP LNS tunnel. It will be carried in the Update_Request message when
L2TP LNS access is used.[¶](#section-7.9.10-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.10-2){.pilcrow}

[]{#name-l2tp-lns-tunnel-tlv-2}

::: {#fig55}
::: {#section-7.9.10-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Local-Tunnel-ID        |       Remote-Tunnel-ID        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Source-Port            |         Dest-Port             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                       Source-IP                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                       Dest-IP                                 ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                       VRF-Name Sub-TLV                        ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 55](#figure-55){.selfRef}: [L2TP-LNS Tunnel
TLV](#name-l2tp-lns-tunnel-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.10-4){.pilcrow}

-   ::: {#section-7.9.10-5.1}

    TLV type:
    :   14.[¶](#section-7.9.10-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.10-5.1.1.4){.pilcrow}
    :   

    Local-Tunnel-ID (2 bytes):
    :   The local ID of the L2TP
        tunnel.[¶](#section-7.9.10-5.1.1.6){.pilcrow}
    :   

    Remote-Tunnel-ID (2 bytes):
    :   The remote ID of the L2TP
        tunnel.[¶](#section-7.9.10-5.1.1.8){.pilcrow}
    :   

    Source-Port (2 bytes):
    :   The source UDP port number of an L2TP
        subscriber.[¶](#section-7.9.10-5.1.1.10){.pilcrow}
    :   

    Dest-Port (2 bytes):
    :   The destination UDP port number of an L2TP
        subscriber.[¶](#section-7.9.10-5.1.1.12){.pilcrow}
    :   

    Source-IP (IPv4/v6):
    :   The source IP address of the
        tunnel.[¶](#section-7.9.10-5.1.1.14){.pilcrow}
    :   

    Dest-IP (IPv4/v6):
    :   The destination IP address of the
        tunnel.[¶](#section-7.9.10-5.1.1.16){.pilcrow}
    :   

    VRF-Name Sub-TLV:
    :   The VRF name to which the L2TP subscriber tunnel
        belongs.[¶](#section-7.9.10-5.1.1.18){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.11}
::: {#section-7.9.11 .section}
#### [7.9.11.](#section-7.9.11){.section-number .selfRef} [Update Response TLV](#name-update-response-tlv){.section-name .selfRef} {#name-update-response-tlv}

The Update Response TLV is used to return the operation result of an
update request. It is carried in the Update_Response message as a
response to the Update_Request message.[¶](#section-7.9.11-1){.pilcrow}

The format of the value part of the Update Response TLV is as
follows:[¶](#section-7.9.11-2){.pilcrow}

[]{#name-update-response-tlv-2}

::: {#fig56}
::: {#section-7.9.11-3.1 .artwork .art-text .alignLeft}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                          User-ID                              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        | User-Trans-ID |   Oper-Code   |   Oper-Result |  Reserved     |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                         Error-Code                            |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 56](#figure-56){.selfRef}: [Update Response
TLV](#name-update-response-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.11-4){.pilcrow}

-   ::: {#section-7.9.11-5.1}

    TLV type:
    :   302.[¶](#section-7.9.11-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   12.[¶](#section-7.9.11-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   A unique identifier of a
        user/subscriber.[¶](#section-7.9.11-5.1.1.6){.pilcrow}
    :   

    User-Trans-ID (1 byte):
    :   In the case of dual-stack access or when modifying a session,
        User-Trans-ID is used to identify a user operation transaction.
        It is used by the CP to correlate a response to a specific
        request.[¶](#section-7.9.11-5.1.1.8){.pilcrow}
    :   

    Oper-Code (1 byte):

    :   Operation code.[¶](#section-7.9.11-5.1.1.10.1){.pilcrow}

        1:
        :   Update.[¶](#section-7.9.11-5.1.1.10.2.2){.pilcrow}
        :   

        2:
        :   Delete.[¶](#section-7.9.11-5.1.1.10.2.4){.pilcrow}
        :   

    :   

    Oper-Result (1 byte):

    :   Operation Result.[¶](#section-7.9.11-5.1.1.12.1){.pilcrow}

        0:
        :   Success.[¶](#section-7.9.11-5.1.1.12.2.2){.pilcrow}
        :   

        Others:
        :   Failure.[¶](#section-7.9.11-5.1.1.12.2.4){.pilcrow}
        :   

    :   

    Error-Code (4 bytes):
    :   Operation failure cause code. For details, see [Section
        8.5](#sect-9.5){.xref}.[¶](#section-7.9.11-5.1.1.14){.pilcrow}
    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.11-5.1.1.16){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.12}
::: {#section-7.9.12 .section}
#### [7.9.12.](#section-7.9.12){.section-number .selfRef} [Subscriber Policy TLV](#name-subscriber-policy-tlv){.section-name .selfRef} {#name-subscriber-policy-tlv}

The Subscriber Policy TLV is used to carry the policies that will be
applied to a subscriber. It is carried in the Update_Request
message.[¶](#section-7.9.12-1){.pilcrow}

The format of the TLV value part is as
follows:[¶](#section-7.9.12-2){.pilcrow}

[]{#name-subscriber-policy-tlv-2}

::: {#fig57}
::: {#section-7.9.12-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   I-Priority  |   E-Priority  |   Reserved                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Sub-TLVs                             ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 57](#figure-57){.selfRef}: [Subscriber Policy
TLV](#name-subscriber-policy-tlv-2){.selfRef}
:::

Where:[¶](#section-7.9.12-4){.pilcrow}

-   ::: {#section-7.9.12-5.1}

    TLV type:
    :   6.[¶](#section-7.9.12-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.9.12-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        user/subscriber.[¶](#section-7.9.12-5.1.1.6){.pilcrow}
    :   

    Ingress-Priority (1 byte):
    :   Indicates the upstream priority. The value range is
        0\~7.[¶](#section-7.9.12-5.1.1.8){.pilcrow}
    :   

    Egress-Priority (1 byte):
    :   Indicates the downstream priority. The value range is
        0\~7.[¶](#section-7.9.12-5.1.1.10){.pilcrow}
    :   

    Sub-TLVs:

    :   The sub-TLVs that are present can occur in any
        order.[¶](#section-7.9.12-5.1.1.12.1){.pilcrow}

        Ingress-CAR sub-TLV:
        :   Upstream CAR.[¶](#section-7.9.12-5.1.1.12.2.2){.pilcrow}
        :   

        Egress-CAR sub-TLV:
        :   Downstream CAR.[¶](#section-7.9.12-5.1.1.12.2.4){.pilcrow}
        :   

        Ingress-QoS-Profile sub-TLV:
        :   Indicates the name of the QoS-Profile that is the profile in
            the upstream
            direction.[¶](#section-7.9.12-5.1.1.12.2.6){.pilcrow}
        :   

        Egress-QoS-Profile sub-TLV:
        :   Indicates the name of the QoS-Profile that is the profile in
            the downstream
            direction.[¶](#section-7.9.12-5.1.1.12.2.8){.pilcrow}
        :   

        User-ACL-Policy sub-TLV:
        :   All ACL user policies, including v4ACLIN, v4ACLOUT, v6ACLIN,
            v6ACLOUT, v4WEBACL, v6WEBACL, v4SpecialACL, and
            v6SpecialACL.[¶](#section-7.9.12-5.1.1.12.2.10){.pilcrow}
        :   

        Multicast-Profile4 sub-TLV:
        :   IPv4 multicast policy
            name.[¶](#section-7.9.12-5.1.1.12.2.12){.pilcrow}
        :   

        Multicast-Profile6 sub-TLV:
        :   IPv6 multicast policy
            name.[¶](#section-7.9.12-5.1.1.12.2.14){.pilcrow}
        :   

        NAT-Instance sub-TLV:
        :   Indicates the instance ID of a NAT
            user.[¶](#section-7.9.12-5.1.1.12.2.16){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.9.12-5.1.1.14){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.9.13}
::: {#section-7.9.13 .section}
#### [7.9.13.](#section-7.9.13){.section-number .selfRef} [Subscriber CGN Port Range TLV](#name-subscriber-cgn-port-range-t){.section-name .selfRef} {#name-subscriber-cgn-port-range-t}

The Subscriber CGN Port Range TLV is used to carry the NAT public
address and port range. It will be carried in the Update_Response
message when CGN is used.[¶](#section-7.9.13-1){.pilcrow}

The format of the value part of this TLV is as
follows:[¶](#section-7.9.13-2){.pilcrow}

[]{#name-subscriber-cgn-port-range-tl}

::: {#fig58}
::: {#section-7.9.13-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            User-ID                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           NAT-Port-Start      |          NAT-Port-End         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            NAT-Address                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 58](#figure-58){.selfRef}: [Subscriber CGN Port Range
TLV](#name-subscriber-cgn-port-range-tl){.selfRef}
:::

Where:[¶](#section-7.9.13-4){.pilcrow}

-   ::: {#section-7.9.13-5.1}

    TLV type:
    :   15.[¶](#section-7.9.13-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   12 octets.[¶](#section-7.9.13-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The identifier of a
        user/subscriber.[¶](#section-7.9.13-5.1.1.6){.pilcrow}
    :   

    NAT-Port-Start (2 bytes):
    :   The start port number.[¶](#section-7.9.13-5.1.1.8){.pilcrow}
    :   

    NAT-Port-End (2 bytes):
    :   The end port number.[¶](#section-7.9.13-5.1.1.10){.pilcrow}
    :   

    NAT-Address (4 bytes):
    :   The NAT public network
        address.[¶](#section-7.9.13-5.1.1.12){.pilcrow}
    :   
    :::
:::
:::
:::
:::

::: {#sect-7.10}
::: {#section-7.10 .section}
### [7.10.](#section-7.10){.section-number .selfRef} [Device Status TLVs](#name-device-status-tlvs){.section-name .selfRef} {#name-device-status-tlvs}

The TLVs in this section are for reporting interface and board-level
information from the UP to the CP.[¶](#section-7.10-1){.pilcrow}

::: {#sect-7.10.1}
::: {#section-7.10.1 .section}
#### [7.10.1.](#section-7.10.1){.section-number .selfRef} [Interface Status TLV](#name-interface-status-tlv){.section-name .selfRef} {#name-interface-status-tlv}

The Interface Status TLV is used to carry the status information of an
interface on a UP. It is carried in a Report
message.[¶](#section-7.10.1-1){.pilcrow}

The format of the value part of this TLV is as
follows:[¶](#section-7.10.1-2){.pilcrow}

[]{#name-interface-status-tlv-2}

::: {#fig59}
::: {#section-7.10.1-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          If-Index                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          MAC-Address (upper part)             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   MAC-Address (lower part)    |   Phy-State   |   Reserved    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          MTU                                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Sub-TLVs (optional)                  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 59](#figure-59){.selfRef}: [Interface Status
TLV](#name-interface-status-tlv-2){.selfRef}
:::

Where:[¶](#section-7.10.1-4){.pilcrow}

-   ::: {#section-7.10.1-5.1}

    TLV type:
    :   200.[¶](#section-7.10.1-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.10.1-5.1.1.4){.pilcrow}
    :   

    If-Index (4 bytes):
    :   Indicates the interface
        index.[¶](#section-7.10.1-5.1.1.6){.pilcrow}
    :   

    MAC-Address (MAC-Addr type):
    :   Interface MAC address.[¶](#section-7.10.1-5.1.1.8){.pilcrow}
    :   

    Phy-State (1 byte):

    :   Physical status of the
        interface.[¶](#section-7.10.1-5.1.1.10.1){.pilcrow}

        0:
        :   Down.[¶](#section-7.10.1-5.1.1.10.2.2){.pilcrow}
        :   

        1:
        :   Up.[¶](#section-7.10.1-5.1.1.10.2.4){.pilcrow}
        :   

    :   

    MTU (4 bytes):
    :   Interface MTU value.[¶](#section-7.10.1-5.1.1.12){.pilcrow}
    :   

    Sub-TLVs:
    :   The If-Desc and VRF-Name sub-TLVs can be
        carried.[¶](#section-7.10.1-5.1.1.14){.pilcrow}
    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.10.1-5.1.1.16){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.10.2}
::: {#section-7.10.2 .section}
#### [7.10.2.](#section-7.10.2){.section-number .selfRef} [Board Status TLV](#name-board-status-tlv){.section-name .selfRef} {#name-board-status-tlv}

The Board Status TLV is used to carry the status information of a board
on an UP. It is carried in a Report
message.[¶](#section-7.10.2-1){.pilcrow}

The format of the value part of the Board Status TLV is as
follows:[¶](#section-7.10.2-2){.pilcrow}

[]{#name-board-status-tlv-2}

::: {#fig60}
::: {#section-7.10.2-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Board-Type  | Board-State   |   Reserved    |   Chassis     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |               Slot            |           Sub-Slot            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 60](#figure-60){.selfRef}: [Board Status
TLV](#name-board-status-tlv-2){.selfRef}
:::

Where:[¶](#section-7.10.2-4){.pilcrow}

-   ::: {#section-7.10.2-5.1}

    TLV type:
    :   201.[¶](#section-7.10.2-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   8 octets.[¶](#section-7.10.2-5.1.1.4){.pilcrow}
    :   

    Chassis (1 byte):
    :   The chassis number of the
        board.[¶](#section-7.10.2-5.1.1.6){.pilcrow}
    :   

    Slot (16 bits):
    :   The slot number of the
        board.[¶](#section-7.10.2-5.1.1.8){.pilcrow}
    :   

    Sub-Slot (16 bits):
    :   The sub-slot number of the
        board.[¶](#section-7.10.2-5.1.1.10){.pilcrow}
    :   

    Board-Type (1 byte):

    :   The type of board used.[¶](#section-7.10.2-5.1.1.12.1){.pilcrow}

        1:
        :   CGN Service Process Unit (SPU)
            board.[¶](#section-7.10.2-5.1.1.12.2.2){.pilcrow}
        :   

        2:
        :   Line Process Unit (LPU)
            board.[¶](#section-7.10.2-5.1.1.12.2.4){.pilcrow}
        :   

    :   

    Board-State (1 byte):

    :   Indicates whether there are issues with the
        board.[¶](#section-7.10.2-5.1.1.14.1){.pilcrow}

        0:
        :   Normal.[¶](#section-7.10.2-5.1.1.14.2.2){.pilcrow}
        :   

        1:
        :   Abnormal.[¶](#section-7.10.2-5.1.1.14.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.10.2-5.1.1.16){.pilcrow}
    :   
    :::
:::
:::
:::
:::

::: {#sect-7.11}
::: {#section-7.11 .section}
### [7.11.](#section-7.11){.section-number .selfRef} [CGN TLVs](#name-cgn-tlvs){.section-name .selfRef} {#name-cgn-tlvs}

::: {#sect-7.11.1}
::: {#section-7.11.1 .section}
#### [7.11.1.](#section-7.11.1){.section-number .selfRef} [Address Allocation Request TLV](#name-address-allocation-request-){.section-name .selfRef} {#name-address-allocation-request-}

The Address Allocation Request TLV is used to request address allocation
from the CP. A Pool-Name sub-TLV is carried to indicate from which
address pool to allocate addresses. The Address Allocation Request TLV
is carried in the Addr_Allocation_Req
message.[¶](#section-7.11.1-1){.pilcrow}

The format of the value part of this TLV is as
follows:[¶](#section-7.11.1-2){.pilcrow}

[]{#name-address-allocation-request-t}

::: {#fig61}
::: {#section-7.11.1-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                          Pool-Name Sub-TLV                    ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 61](#figure-61){.selfRef}: [Address Allocation Request
TLV](#name-address-allocation-request-t){.selfRef}
:::

Where:[¶](#section-7.11.1-4){.pilcrow}

-   ::: {#section-7.11.1-5.1}

    TLV type:
    :   400.[¶](#section-7.11.1-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.11.1-5.1.1.4){.pilcrow}
    :   

    Pool-Name sub-TLV:
    :   Indicates from which address pool to allocate
        address.[¶](#section-7.11.1-5.1.1.6){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.11.2}
::: {#section-7.11.2 .section}
#### [7.11.2.](#section-7.11.2){.section-number .selfRef} [Address Allocation Response TLV](#name-address-allocation-response){.section-name .selfRef} {#name-address-allocation-response}

The Address Allocation Response TLV is used to return the address
allocation result; it is carried in the Addr_Allocation_Ack
message.[¶](#section-7.11.2-1){.pilcrow}

The value part of the Address Allocation Response TLV is formatted as
follows:[¶](#section-7.11.2-2){.pilcrow}

[]{#name-address-allocation-response-}

::: {#fig62}
::: {#section-7.11.2-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Lease Time                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Client-IP                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Client-IP (cont.)                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Error-Code                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                        Pool-Name Sub-TLV                      ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 62](#figure-62){.selfRef}: [Address Allocation Response
TLV](#name-address-allocation-response-){.selfRef}
:::

Where:[¶](#section-7.11.2-4){.pilcrow}

-   ::: {#section-7.11.2-5.1}

    TLV type:
    :   401.[¶](#section-7.11.2-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.11.2-5.1.1.4){.pilcrow}
    :   

    Lease Time (4 bytes):
    :   Duration of address lease in
        seconds.[¶](#section-7.11.2-5.1.1.6){.pilcrow}
    :   

    Client-IP (IPv4-Address type):
    :   The allocated IPv4 address and
        mask.[¶](#section-7.11.2-5.1.1.8){.pilcrow}
    :   

    Error-Code (4 bytes):

    :   Indicates success or an
        error.[¶](#section-7.11.2-5.1.1.10.1){.pilcrow}

        0:
        :   Success.[¶](#section-7.11.2-5.1.1.10.2.2){.pilcrow}
        :   

        1:
        :   Failure.[¶](#section-7.11.2-5.1.1.10.2.4){.pilcrow}
        :   

        3001:
        :   Pool-Mismatch. The corresponding address pool cannot be
            found.[¶](#section-7.11.2-5.1.1.10.2.6){.pilcrow}
        :   

        3002:
        :   Pool-Full. The address pool is fully allocated, and no
            address segment is
            available.[¶](#section-7.11.2-5.1.1.10.2.8){.pilcrow}
        :   

    :   

    Pool-Name sub-TLV:
    :   Indicates from which address pool the address is
        allocated.[¶](#section-7.11.2-5.1.1.12){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.11.3}
::: {#section-7.11.3 .section}
#### [7.11.3.](#section-7.11.3){.section-number .selfRef} [Address Renewal Request TLV](#name-address-renewal-request-tlv){.section-name .selfRef} {#name-address-renewal-request-tlv}

The Address Renewal Request TLV is used to request address renewal from
the CP. It is carried in the Addr_Renew_Req
message.[¶](#section-7.11.3-1){.pilcrow}

The format of this TLV value is as
follows:[¶](#section-7.11.3-2){.pilcrow}

[]{#name-address-renewal-request-tlv-2}

::: {#fig63}
::: {#section-7.11.3-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP (cont.)                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                     Pool-Name Sub-TLV                         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 63](#figure-63){.selfRef}: [Address Renewal Request
TLV](#name-address-renewal-request-tlv-2){.selfRef}
:::

Where:[¶](#section-7.11.3-4){.pilcrow}

-   ::: {#section-7.11.3-5.1}

    TLV type:
    :   402.[¶](#section-7.11.3-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.11.3-5.1.1.4){.pilcrow}
    :   

    Client-IP (IPv4-Address type):
    :   The IPv4 address and mask to be
        renewed.[¶](#section-7.11.3-5.1.1.6){.pilcrow}
    :   

    Pool-Name sub-TLV:
    :   Indicates from which address pool to renew the
        address.[¶](#section-7.11.3-5.1.1.8){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.11.4}
::: {#section-7.11.4 .section}
#### [7.11.4.](#section-7.11.4){.section-number .selfRef} [Address Renewal Response TLV](#name-address-renewal-response-tl){.section-name .selfRef} {#name-address-renewal-response-tl}

The Address Renewal Response TLV is used to return the address renewal
result. It is carried in the Addr_Renew_Ack
message.[¶](#section-7.11.4-1){.pilcrow}

The format of this TLV value is as
follows:[¶](#section-7.11.4-2){.pilcrow}

[]{#name-address-renewal-response-tlv}

::: {#fig64}
::: {#section-7.11.4-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP (cont.)                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Error-Code                                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                     Pool-Name Sub-TLV                         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 64](#figure-64){.selfRef}: [Address Renewal Response
TLV](#name-address-renewal-response-tlv){.selfRef}
:::

Where:[¶](#section-7.11.4-4){.pilcrow}

-   ::: {#section-7.11.4-5.1}

    TLV type:
    :   403.[¶](#section-7.11.4-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.11.4-5.1.1.4){.pilcrow}
    :   

    Client-IP (IPv4-Address type):
    :   The renewed IPv4 address and
        mask.[¶](#section-7.11.4-5.1.1.6){.pilcrow}
    :   

    Error-Code (4 bytes):

    :   Indicates success or an
        error:[¶](#section-7.11.4-5.1.1.8.1){.pilcrow}

        0:
        :   Success.[¶](#section-7.11.4-5.1.1.8.2.2){.pilcrow}
        :   

        1:
        :   Failure.[¶](#section-7.11.4-5.1.1.8.2.4){.pilcrow}
        :   

        3001:
        :   Pool-Mismatch. The corresponding address pool cannot be
            found.[¶](#section-7.11.4-5.1.1.8.2.6){.pilcrow}
        :   

        3002:
        :   Pool-Full. The address pool is fully allocated, and no
            address segment is
            available.[¶](#section-7.11.4-5.1.1.8.2.8){.pilcrow}
        :   

        3003:
        :   Subnet-Mismatch. The address pool subnet cannot be
            found.[¶](#section-7.11.4-5.1.1.8.2.10){.pilcrow}
        :   

        3004:
        :   Subnet-Conflict. Subnets in the address pool have been
            assigned to other
            clients.[¶](#section-7.11.4-5.1.1.8.2.12){.pilcrow}
        :   

    :   

    Pool-Name sub-TLV:
    :   Indicates from which address pool to renew the
        address.[¶](#section-7.11.4-5.1.1.10){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.11.5}
::: {#section-7.11.5 .section}
#### [7.11.5.](#section-7.11.5){.section-number .selfRef} [Address Release Request TLV](#name-address-release-request-tlv){.section-name .selfRef} {#name-address-release-request-tlv}

The Address Release Request TLV is used to release an IPv4 address. It
is carried in the Addr_Release_Req
message.[¶](#section-7.11.5-1){.pilcrow}

The value part of this TLV is formatted as
follows:[¶](#section-7.11.5-2){.pilcrow}

[]{#name-address-release-request-tlv-2}

::: {#fig65}
::: {#section-7.11.5-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP (cont.)                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                     Pool-Name sub-TLV                         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 65](#figure-65){.selfRef}: [Address Release Request
TLV](#name-address-release-request-tlv-2){.selfRef}
:::

Where:[¶](#section-7.11.5-4){.pilcrow}

-   ::: {#section-7.11.5-5.1}

    TLV type:
    :   404.[¶](#section-7.11.5-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.11.5-5.1.1.4){.pilcrow}
    :   

    Client-IP (IPv4-Address type):
    :   The IPv4 address and mask to be
        released.[¶](#section-7.11.5-5.1.1.6){.pilcrow}
    :   

    Pool-Name sub-TLV:
    :   Indicates from which address pool to release the
        address.[¶](#section-7.11.5-5.1.1.8){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.11.6}
::: {#section-7.11.6 .section}
#### [7.11.6.](#section-7.11.6){.section-number .selfRef} [Address Release Response TLV](#name-address-release-response-tl){.section-name .selfRef} {#name-address-release-response-tl}

The Address Release Response TLV is used to return the address release
result. It is carried in the Addr_Release_Ack
message.[¶](#section-7.11.6-1){.pilcrow}

The format of the value part of this TLV is as
follows:[¶](#section-7.11.6-2){.pilcrow}

[]{#name-address-release-response-tlv}

::: {#fig66}
::: {#section-7.11.6-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Client-IP (cont.)                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                     Error-Code                                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                     Pool-Name sub-TLV                         ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 66](#figure-66){.selfRef}: [Address Release Response
TLV](#name-address-release-response-tlv){.selfRef}
:::

Where:[¶](#section-7.11.6-4){.pilcrow}

-   ::: {#section-7.11.6-5.1}

    TLV type:
    :   405.[¶](#section-7.11.6-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.11.6-5.1.1.4){.pilcrow}
    :   

    Client-IP (IPv4-Address type):
    :   The released IPv4 address and
        mask.[¶](#section-7.11.6-5.1.1.6){.pilcrow}
    :   

    Error-Code (4 bytes):

    :   Indicates success or an
        error.[¶](#section-7.11.6-5.1.1.8.1){.pilcrow}

        0:
        :   Success. Address release
            success.[¶](#section-7.11.6-5.1.1.8.2.2){.pilcrow}
        :   

        1:
        :   Failure. Address release
            failed.[¶](#section-7.11.6-5.1.1.8.2.4){.pilcrow}
        :   

        3001:
        :   Pool-Mismatch. The corresponding address pool cannot be
            found.[¶](#section-7.11.6-5.1.1.8.2.6){.pilcrow}
        :   

        3003:
        :   Subnet-Mismatch. The address cannot be
            found.[¶](#section-7.11.6-5.1.1.8.2.8){.pilcrow}
        :   

        3004:
        :   Subnet-Conflict. The address has been allocated to another
            subscriber.[¶](#section-7.11.6-5.1.1.8.2.10){.pilcrow}
        :   

    :   

    Pool-Name sub-TLV:
    :   Indicates from which address pool to release the
        address.[¶](#section-7.11.6-5.1.1.10){.pilcrow}
    :   
    :::
:::
:::
:::
:::

::: {#sect-7.12}
::: {#section-7.12 .section}
### [7.12.](#section-7.12){.section-number .selfRef} [Event TLVs](#name-event-tlvs){.section-name .selfRef} {#name-event-tlvs}

::: {#sect-7.12.1}
::: {#section-7.12.1 .section}
#### [7.12.1.](#section-7.12.1){.section-number .selfRef} [Subscriber Traffic Statistics TLV](#name-subscriber-traffic-statisti){.section-name .selfRef} {#name-subscriber-traffic-statisti}

The Subscriber Traffic Statistics TLV is used to return the traffic
statistics of a user/subscriber. The format of the value part of this
TLV is as follows:[¶](#section-7.12.1-1){.pilcrow}

[]{#name-subscriber-traffic-statistic}

::: {#fig67}
::: {#section-7.12.1-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                User-ID                                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Statistics-Type                                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Packets (upper part)                   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Packets (lower part)                   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Bytes (upper part)                     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Bytes (lower part)                     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Loss Packets (upper part)              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Loss Packets (lower part)              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Loss Bytes (upper part)                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Ingress Loss Bytes (lower part)                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Packets (upper part)                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Packets (lower part)                    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Bytes (upper part)                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Bytes (lower part)                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Loss Packets (upper part)               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Loss Packets (lower part)               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Loss Bytes (upper part)                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                Egress Loss Bytes (lower part)                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 67](#figure-67){.selfRef}: [Subscriber Traffic Statistics
TLV](#name-subscriber-traffic-statistic){.selfRef}
:::

Where:[¶](#section-7.12.1-3){.pilcrow}

-   ::: {#section-7.12.1-4.1}

    TLV type:
    :   300.[¶](#section-7.12.1-4.1.1.2){.pilcrow}
    :   

    TLV length:
    :   72 octets.[¶](#section-7.12.1-4.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The subscriber identifier.[¶](#section-7.12.1-4.1.1.6){.pilcrow}
    :   

    Statistics-Type (4 bytes):

    :   Traffic type. It can be one of the following
        options:[¶](#section-7.12.1-4.1.1.8.1){.pilcrow}

        0:
        :   IPv4 traffic.[¶](#section-7.12.1-4.1.1.8.2.2){.pilcrow}
        :   

        1:
        :   IPv6 traffic.[¶](#section-7.12.1-4.1.1.8.2.4){.pilcrow}
        :   

        2:
        :   Dual-stack
            traffic.[¶](#section-7.12.1-4.1.1.8.2.6){.pilcrow}
        :   

    :   

    Ingress Packets (8 bytes):
    :   The number of the packets in the upstream
        direction.[¶](#section-7.12.1-4.1.1.10){.pilcrow}
    :   

    Ingress Bytes (8 bytes):
    :   The bytes of the upstream
        traffic.[¶](#section-7.12.1-4.1.1.12){.pilcrow}
    :   

    Ingress Loss Packets (8 bytes):
    :   The number of the lost packets in the upstream
        direction.[¶](#section-7.12.1-4.1.1.14){.pilcrow}
    :   

    Ingress Loss Bytes (8 bytes):
    :   The bytes of the lost upstream
        packets.[¶](#section-7.12.1-4.1.1.16){.pilcrow}
    :   

    Egress Packets (8 bytes):
    :   The number of the packets in the downstream
        direction.[¶](#section-7.12.1-4.1.1.18){.pilcrow}
    :   

    Egress Bytes (8 bytes):
    :   The bytes of the downstream
        traffic.[¶](#section-7.12.1-4.1.1.20){.pilcrow}
    :   

    Egress Loss Packets (8 bytes):
    :   The number of the lost packets in the downstream
        direction.[¶](#section-7.12.1-4.1.1.22){.pilcrow}
    :   

    Egress Loss Bytes (8 bytes):
    :   The bytes of the lost downstream
        packets.[¶](#section-7.12.1-4.1.1.24){.pilcrow}
    :   
    :::
:::
:::

::: {#sect-7.12.2}
::: {#section-7.12.2 .section}
#### [7.12.2.](#section-7.12.2){.section-number .selfRef} [Subscriber Detection Result TLV](#name-subscriber-detection-result){.section-name .selfRef} {#name-subscriber-detection-result}

The Subscriber Detection Result TLV is used to return the detection
result of a subscriber. Subscriber detection is a function to detect
whether or not a subscriber is online. The result can be used by the CP
to determine how to deal with the subscriber session (e.g., delete the
session if detection failed).[¶](#section-7.12.2-1){.pilcrow}

The format of this TLV value part is as
follows:[¶](#section-7.12.2-2){.pilcrow}

[]{#name-subscriber-detection-result-}

::: {#fig68}
::: {#section-7.12.2-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          User-ID                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Detect-Type   | Detect-Result |          Reserved             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 68](#figure-68){.selfRef}: [Subscriber Detection Result
TLV](#name-subscriber-detection-result-){.selfRef}
:::

Where:[¶](#section-7.12.2-4){.pilcrow}

-   ::: {#section-7.12.2-5.1}

    TLV type:
    :   301.[¶](#section-7.12.2-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   8 octets.[¶](#section-7.12.2-5.1.1.4){.pilcrow}
    :   

    User-ID (4 bytes):
    :   The subscriber identifier.[¶](#section-7.12.2-5.1.1.6){.pilcrow}
    :   

    Detect-Type (1 byte):

    :   Type of traffic
        detected.[¶](#section-7.12.2-5.1.1.8.1){.pilcrow}

        0:
        :   IPv4 detection.[¶](#section-7.12.2-5.1.1.8.2.2){.pilcrow}
        :   

        1:
        :   IPv6 detection.[¶](#section-7.12.2-5.1.1.8.2.4){.pilcrow}
        :   

        2:
        :   PPP detection.[¶](#section-7.12.2-5.1.1.8.2.6){.pilcrow}
        :   

    :   

    Detect-Result (1 byte):

    :   Indicates whether the detection was
        successful.[¶](#section-7.12.2-5.1.1.10.1){.pilcrow}

        0:
        :   Indicates that the detection is
            successful.[¶](#section-7.12.2-5.1.1.10.2.2){.pilcrow}
        :   

        1:
        :   Detection failure. The UP needs to report only when the
            detection fails.[¶](#section-7.12.2-5.1.1.10.2.4){.pilcrow}
        :   

    :   

    Reserved:
    :   The Reserved field [MUST]{.bcp14} be sent as zero and ignored on
        receipt.[¶](#section-7.12.2-5.1.1.12){.pilcrow}
    :   
    :::
:::
:::
:::
:::

::: {#sect-7.13}
::: {#section-7.13 .section}
### [7.13.](#section-7.13){.section-number .selfRef} [Vendor TLV](#name-vendor-tlv){.section-name .selfRef} {#name-vendor-tlv}

The Vendor TLV occurs as the first TLV in the Vendor message ([Section
6.6](#sect-6.6){.xref}). It provides a Sub-Type that effectively extends
the message type in the message header, provides for versioning of
vendor TLVs, and can accommodate sub-TLVs.[¶](#section-7.13-1){.pilcrow}

The value part of the Vendor TLV is formatted as
follows:[¶](#section-7.13-2){.pilcrow}

[]{#name-vendor-tlv-2}

::: {#fig69}
::: {#section-7.13-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Vendor-ID                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Sub-Type            |       Sub-Type-Version        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                      Sub-TLVs (optional)                      ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 69](#figure-69){.selfRef}: [Vendor
TLV](#name-vendor-tlv-2){.selfRef}
:::

Where:[¶](#section-7.13-4){.pilcrow}

-   ::: {#section-7.13-5.1}

    TLV type:
    :   1024.[¶](#section-7.13-5.1.1.2){.pilcrow}
    :   

    TLV length:
    :   Variable.[¶](#section-7.13-5.1.1.4){.pilcrow}
    :   

    Vendor-ID (4 bytes):
    :   Vendor ID as defined in RADIUS
        \[[RFC2865](#RFC2865){.xref}\].[¶](#section-7.13-5.1.1.6){.pilcrow}
    :   

    Sub-Type (2 bytes):
    :   Used by the vendor to distinguish multiple different vendor
        messages.[¶](#section-7.13-5.1.1.8){.pilcrow}
    :   

    Sub-Type-Version (2 bytes):
    :   Used by the vendor to distinguish different versions of a
        vendor-defined message
        Sub-Type.[¶](#section-7.13-5.1.1.10){.pilcrow}
    :   

    Sub-TLVs (variable):
    :   Sub-TLVs as specified by the
        vendor.[¶](#section-7.13-5.1.1.12){.pilcrow}
    :   
    :::

Since vendor code will be handling the TLV after the Vendor-ID field is
recognized, the remainder of the TLV values can be organized however the
vendor wants. But it is desirable for a vendor to be able to define
multiple different vendor messages and to keep track of different
versions of its vendor-defined messages. Thus, it is
[RECOMMENDED]{.bcp14} that the vendor assign a Sub-Type value for each
vendor message that it defines different from other Sub-Type values that
vendor has used. Also, when modifying a vendor-defined message in a way
potentially incompatible with a previous definition, the vendor
[SHOULD]{.bcp14} increase the value it is using in the Sub-Type-Version
field.[¶](#section-7.13-6){.pilcrow}
:::
:::
:::
:::

::: {#sect-9}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Tables of S-CUSP Codepoints](#name-tables-of-s-cusp-codepoints){.section-name .selfRef} {#name-tables-of-s-cusp-codepoints}

This section provides tables of the S-CUSP codepoints, particularly
message types, TLV types, TLV operation codes, sub-TLV types, and error
codes. In most cases, references are provided to relevant sections
elsewhere in this document.[¶](#section-8-1){.pilcrow}

::: {#sect-9.1}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Message Types](#name-message-types){.section-name .selfRef} {#name-message-types}

[]{#name-message-types-2}

  Type      Name                  Section of This Document
  --------- --------------------- -----------------------------
  0         Reserved              
  1         Hello                 [6.2.1](#sect-6.2.1){.xref}
  2         Keepalive             [6.2.2](#sect-6.2.2){.xref}
  3         Sync_Request          [6.2.3](#sect-6.2.3){.xref}
  4         Sync_Begin            [6.2.4](#sect-6.2.4){.xref}
  5         Sync_Data             [6.2.5](#sect-6.2.5){.xref}
  6         Sync_End              [6.2.6](#sect-6.2.6){.xref}
  7         Update_Request        [6.2.7](#sect-6.2.7){.xref}
  8         Update_Response       [6.2.8](#sect-6.2.8){.xref}
  9         Report                [6.4](#sect-6.4){.xref}
  10        Event                 [6.3](#sect-6.3){.xref}
  11        Vendor                [6.6](#sect-6.6){.xref}
  12        Error                 [6.7](#sect-6.7){.xref}
  13-199    Unassigned            
  200       Addr_Allocation_Req   [6.5.1](#sect-6.5.1){.xref}
  201       Addr_Allocation_Ack   [6.5.2](#sect-6.5.2){.xref}
  202       Addr_Renew_Req        [6.5.3](#sect-6.5.3){.xref}
  203       Addr_Renew_Ack        [6.5.4](#sect-6.5.4){.xref}
  204       Addr_Release_Req      [6.5.5](#sect-6.5.5){.xref}
  205       Addr_Release_Ack      [6.5.6](#sect-6.5.6){.xref}
  206-254   Unassigned            
  255       Reserved              

  : [Table 5](#table-5){.selfRef}: [Message
  Types](#name-message-types-2){.selfRef}
:::
:::

::: {#sect-9.2}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [TLV Types](#name-tlv-types){.section-name .selfRef} {#name-tlv-types}

[]{#name-tlv-types-2}

  Type        Name                            Usage Description
  ----------- ------------------------------- ------------------------------------------------------------------------------------------------------------------------------
  0           Reserved                        \-
  1           BAS Function                    Carries the BNG access functions to be enabled or disabled on specified interfaces.
  2           Basic Subscriber                Carries the basic information about a BNG subscriber.
  3           PPP Subscriber                  Carries the PPP information about a BNG subscriber.
  4           IPv4 Subscriber                 Carries the IPv4 address of a BNG subscriber.
  5           IPv6 Subscriber                 Carries the IPv6 address of a BNG subscriber.
  6           Subscriber Policy               Carries the policy information applied to a BNG subscriber.
  7           IPv4 Routing                    Carries the IPv4 network routing information.
  8           IPv6 Routing                    Carries the IPv6 network routing information.
  9           IPv4 Static Subscriber Detect   Carries the IPv4 static subscriber detect information.
  10          IPv6 Static Subscriber Detect   Carries the IPv6 static subscriber detect information.
  11          L2TP-LAC Subscriber             Carries the L2TP LAC subscriber information.
  12          L2TP-LNS Subscriber             Carries the L2TP LNS subscriber information.
  13          L2TP-LAC Tunnel                 Carries the L2TP LAC tunnel subscriber information.
  14          L2TP-LNS Tunnel                 Carries the L2TP LNS tunnel subscriber information.
  15          Subscriber CGN Port Range       Carries the public IPv4 address and related port range of a BNG subscriber.
  16-99       Unassigned                      \-
  100         Hello                           Used for version and Keepalive timers negotiation.
  101         Error Information               Carried in the Ack of the control message. Carries the processing result, success, or error.
  102         Keepalive                       Carried in the Hello message for Keepalive timers negotiation.
  103-199     Unassigned                      \-
  200         Interface Status                Interfaces status reported by the UP including physical interfaces, sub-interfaces, trunk interfaces, and tunnel interfaces.
  201         Board Status                    Board information reported by the UP including the board type and in-position status.
  202-299     Unassigned                      \-
  300         Subscriber Traffic Statistics   User traffic statistics.
  301         Subscriber Detection Result     User detection information.
  302         Update Response                 The processing result of a subscriber session update.
  303-299     Unassigned                      \-
  400         Address Allocation Request      Request address allocation.
  401         Address Allocation Response     Address allocation response.
  402         Address Renewal Request         Request for address lease renewal.
  403         Address Renewal Response        Response to a request for extending an IP address lease.
  404         Address Release Request         Request to release the address.
  405         Address Release Response        Ack of a message releasing an IP address.
  406-1023    Unassigned                      \-
  1024        Vendor                          As implemented by the vendor.
  1039-4095   Unassigned                      \-

  : [Table 6](#table-6){.selfRef}: [TLV
  Types](#name-tlv-types-2){.selfRef}
:::
:::

::: {#sect-9.3}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [TLV Operation Codes](#name-tlv-operation-codes){.section-name .selfRef} {#name-tlv-operation-codes}

TLV operation codes appear in the Oper field in the header of some TLVs.
See [Section 7.1](#sect-7.1){.xref}.[¶](#section-8.3-1){.pilcrow}

[]{#name-tlv-operation-codes-2}

  Code   Operation
  ------ ------------
  0      Reserved
  1      Update
  2      Delete
  3-15   Unassigned

  : [Table 7](#table-7){.selfRef}: [TLV Operation
  Codes](#name-tlv-operation-codes-2){.selfRef}
:::
:::

::: {#sect-9.4}
::: {#section-8.4 .section}
### [8.4.](#section-8.4){.section-number .selfRef} [Sub-TLV Types](#name-sub-tlv-types){.section-name .selfRef} {#name-sub-tlv-types}

See [Section 7.3](#sect-7.3){.xref}.[¶](#section-8.4-1){.pilcrow}

[]{#name-sub-tlv-types-2}

  Type       Name                  Section of This Document
  ---------- --------------------- -----------------------------
  0          Reserved              
  1          VRF Name              [7.3.1](#sect-7.3.1){.xref}
  2          Ingress-QoS-Profile   [7.3.1](#sect-7.3.1){.xref}
  3          Egress-QoS-Profile    [7.3.1](#sect-7.3.1){.xref}
  4          User-ACL-Policy       [7.3.1](#sect-7.3.1){.xref}
  5          Multicast-ProfileV4   [7.3.1](#sect-7.3.1){.xref}
  6          Multicast-ProfileV6   [7.3.1](#sect-7.3.1){.xref}
  7          Ingress-CAR           [7.3.2](#sect-7.3.2){.xref}
  8          Egress-CAR            [7.3.3](#sect-7.3.3){.xref}
  9          NAT-Instance          [7.3.1](#sect-7.3.1){.xref}
  10         Pool-Name             [7.3.1](#sect-7.3.1){.xref}
  11         If-Desc               [7.3.4](#sect-7.3.4){.xref}
  12         IPv6-Address List     [7.3.5](#sect-7.3.5){.xref}
  13         Vendor                [7.3.6](#sect-7.3.6){.xref}
  12-64534   Unassigned            
  65535      Reserved              

  : [Table 8](#table-8){.selfRef}: [Sub-TLV
  Types](#name-sub-tlv-types-2){.selfRef}
:::
:::

::: {#sect-9.5}
::: {#section-8.5 .section}
### [8.5.](#section-8.5){.section-number .selfRef} [Error Codes](#name-error-codes){.section-name .selfRef} {#name-error-codes}

[]{#name-error-codes-2}

  Value             Name                    Remarks
  ----------------- ----------------------- -------------------------------------------------------------------------------------------------------------------
  0                 Success                 Success
  1                 Failure                 Malformed message received.
  2                 TLV-Unknown             One or more of the TLVs was not understood.
  3                 TLV-Length              The TLV length is abnormal.
  4-999             Unassigned              Unassigned basic error codes.
  1000              Reserved                
  1001              Version-Mismatch        The version negotiation fails. Terminate. The subsequent service processes corresponding to the UP are suspended.
  1002              Keepalive Error         The keepalive negotiation fails.
  1003              Timer Expires           The establishment timer expired.
  1004-1999         Unassigned              Unassigned error codes for version negotiation.
  2000              Reserved                
  2001              Synch-NoReady           The data to be smoothed is not ready.
  2002              Synch-Unsupport         The request for smooth data is not supported.
  2003-2999         Unassigned              Unassigned data synchronization error codes.
  3000              Reserved                
  3001              Pool-Mismatch           The corresponding address pool cannot be found.
  3002              Pool-Full               The address pool is fully allocated, and no address segment is available.
  3003              Subnet-Mismatch         The address pool subnet cannot be found.
  3004              Subnet-Conflict         Subnets in the address pool have been classified into other clients.
  3005-3999         Unassigned              Unassigned error codes for address allocation.
  4000              Reserved                
  4001              Update-Fail-No-Res      The forwarding table fails to be delivered because the forwarding resources are insufficient.
  4002              QoS-Update-Success      The QoS policy takes effect.
  4003              QoS-Update-Sq-Fail      Failed to process the queue in the QoS policy.
  4004              QoS-Update-CAR-Fail     Processing of the CAR in the QoS policy fails.
  4005              Statistic-Fail-No-Res   Statistics processing failed due to insufficient statistics resources.
  4006-4999         Unassigned              Unassigned forwarding table delivery error codes.
  5000-4294967295   Reserved                

  : [Table 9](#table-9){.selfRef}: [Error
  Codes](#name-error-codes-2){.selfRef}
:::
:::

::: {#sect-9.6}
::: {#section-8.6 .section}
### [8.6.](#section-8.6){.section-number .selfRef} [If-Type Values](#name-if-type-values){.section-name .selfRef} {#name-if-type-values}

Defined values of the If-Type field in the If-Desc sub-TLV (see [Section
7.3.4](#sect-7.3.4){.xref}) are as follows:[¶](#section-8.6-1){.pilcrow}

[]{#name-if-type-values-2}

  Value   Meaning
  ------- --------------------
  0       Reserved
  1       Fast Ethernet (FE)
  2       GE
  3       10GE
  4       100GE
  5       Eth-Trunk
  6       Tunnel
  7       VE
  8-254   Unassigned
  255     Reserved

  : [Table 10](#table-10){.selfRef}: [If-Type
  Values](#name-if-type-values-2){.selfRef}
:::
:::

::: {#sect-9.7}
::: {#section-8.7 .section}
### [8.7.](#section-8.7){.section-number .selfRef} [Access-Mode Values](#name-access-mode-values){.section-name .selfRef} {#name-access-mode-values}

Defined values of the Access-Mode field in the BAS Function TLV (see
[Section 7.7](#sect-7.7){.xref}) are as
follows:[¶](#section-8.7-1){.pilcrow}

[]{#name-access-mode-values-2}

  Value   Meaning
  ------- ---------------------
  0       Layer 2 subscriber
  1       Layer 3 subscriber
  2       Layer 2 leased line
  3       Layer 3 leased line
  4-254   Unassigned
  255     Reserved

  : [Table 11](#table-11){.selfRef}: [Access-Mode
  Values](#name-access-mode-values-2){.selfRef}
:::
:::

::: {#sect-9.8}
::: {#section-8.8 .section}
### [8.8.](#section-8.8){.section-number .selfRef} [Access Method Bits](#name-access-method-bits){.section-name .selfRef} {#name-access-method-bits}

Defined values of the Auth-Method4 and Auth-Method6 fields in the BAS
Function TLV (see [Section 7.7](#sect-7.7){.xref}) are defined as bit
fields as follows:[¶](#section-8.8-1){.pilcrow}

[]{#name-auth-method4-values}

  Bit    Meaning
  ------ -------------------------
  0x01   PPPoE authentication
  0x02   DOT1X authentication
  0x04   Web authentication
  0x08   Web fast authentication
  0x10   Binding authentication
  0x20   Reserved
  0x40   Reserved
  0x80   Reserved

  : [Table 12](#table-12){.selfRef}: [Auth-Method4
  Values](#name-auth-method4-values){.selfRef}

[]{#name-auth-method6-values}

  Bit    Meaning
  ------ -------------------------
  0x01   PPPoE authentication
  0x02   DOT1X authentication
  0x04   Web authentication
  0x08   Web fast authentication
  0x10   Binding authentication
  0x20   Reserved
  0x40   Reserved
  0x80   Reserved

  : [Table 13](#table-13){.selfRef}: [Auth-Method6
  Values](#name-auth-method6-values){.selfRef}
:::
:::

::: {#sect-9.9}
::: {#section-8.9 .section}
### [8.9.](#section-8.9){.section-number .selfRef} [Route-Type Values](#name-route-type-values){.section-name .selfRef} {#name-route-type-values}

Values of the Route-Type field in the IPv4 and IPv6 Routing TLVs (see
Sections [7.8.1](#sect-7.8.1){.xref} and [7.8.2](#sect-7.8.2){.xref})
defined in this document are as follows:[¶](#section-8.9-1){.pilcrow}

[]{#name-route-type-values-2}

  Value     Meaning
  --------- ---------------------------------
  0         User host route
  1         Radius authorization FrameRoute
  2         Network segment route
  3         Gateway route
  4         Radius authorized IP route
  5         L2TP LNS side user route
  6-65534   Unassigned
  65535     Reserved

  : [Table 14](#table-14){.selfRef}: [Route-Type
  Values](#name-route-type-values-2){.selfRef}
:::
:::

::: {#sect-9.10}
::: {#section-8.10 .section}
### [8.10.](#section-8.10){.section-number .selfRef} [Access-Type Values](#name-access-type-values){.section-name .selfRef} {#name-access-type-values}

Values of the Access-Type field in the Basic Subscriber TLV (see
[Section 7.9.1](#sect-7.9.1){.xref}) defined in this document are as
follows:[¶](#section-8.10-1){.pilcrow}

[]{#name-access-type-values-2}

  Value    Meaning
  -------- --------------------------------------------------------------------
  0        Reserved
  1        PPP access (PPP \[[RFC1661](#RFC1661){.xref}\])
  2        PPP over Ethernet over ATM access (PPPoEoA)
  3        PPP over ATM access (PPPoA \[[RFC3336](#RFC3336){.xref}\])
  4        PPP over Ethernet access (PPPoE \[[RFC2516](#RFC2516){.xref}\])
  5        PPPoE over VLAN access (PPPoEoVLAN \[[RFC2516](#RFC2516){.xref}\])
  6        PPP over LNS access (PPPoLNS)
  7        IP over Ethernet DHCP access (IPoE_DHCP)
  8        IP over Ethernet EAP authentication access (IPoE_EAP)
  9        IP over Ethernet Layer 3 access (IPoE_L3)
  10       IP over Ethernet Layer 2 Static access (IPoE_L2_STATIC)
  11       Layer 2 Leased Line access (L2_Leased_Line)
  12       Layer 2 VPN Leased Line access (L2VPN_Leased_Line)
  13       Layer 3 Leased Line access (L3_Leased_Line)
  14       Layer 2 Leased line Sub-User access (L2_Leased_Line_SUB_USER)
  15       L2TP LAC tunnel access (L2TP_LAC)
  16       L2TP LNS tunnel access (L2TP_LNS)
  17-254   Unassigned
  255      Reserved

  : [Table 15](#table-15){.selfRef}: [Access-Type
  Values](#name-access-type-values-2){.selfRef}
:::
:::
:::
:::

::: {#sect-10}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-9-1){.pilcrow}
:::
:::

::: {#sect-11}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The Service, Control, and Management Interfaces between the CP and UP
might be across the general Internet or other hostile environment. The
ability of an adversary to block or corrupt messages or introduce
spurious messages on any one or more of these interfaces would give the
adversary the ability to stop subscribers from accessing network
services, disrupt existing subscriber sessions, divert traffic, mess up
accounting statistics, and generally cause havoc. Damage would not
necessarily be limited to one or a few subscribers but could disrupt
routing or deny service to one or more instances of the CP or otherwise
cause extensive interference. If the adversary knows the details of the
UP equipment and its forwarding rule capabilities, the adversary may be
able to cause a copy of most or all user data to be sent to an address
of the adversary\'s choosing, thus enabling
eavesdropping.[¶](#section-10-1){.pilcrow}

Thus, appropriate protections [MUST]{.bcp14} be implemented to provide
integrity, authenticity, and secrecy of traffic over those interfaces.
Whether such protection is used is the decision of the network operator.
See \[[RFC6241](#RFC6241){.xref}\] for Mi/NETCONF security. Security on
the Si is dependent on the tunneling protocol used, which is out of
scope for this document. Security for the Ci, over which S-CUSP flows,
is further discussed below.[¶](#section-10-2){.pilcrow}

S-CUSP messages do not provide security. Thus, if these messages are
exchanged in an environment where security is a concern, that security
[MUST]{.bcp14} be provided by another protocol such as TLS 1.3
\[[RFC8446](#RFC8446){.xref}\] or IPsec. TLS 1.3 is the
mandatory-to-implement protocol for interoperability. The use of a
particular security protocol on the Ci is determined by configuration.
Such security protocols need not always be used, and lesser security
precautions might be appropriate because, in some cases, the
communication between the CP and UP is in a benign
environment.[¶](#section-10-3){.pilcrow}
:::
:::

::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC20\]
:   [Cerf, V.]{.refAuthor}, [\"ASCII format for network
    interchange\"]{.refTitle}, [STD 80]{.seriesInfo}, [RFC
    20]{.seriesInfo}, [DOI 10.17487/RFC0020]{.seriesInfo}, October 1969,
    \<<https://www.rfc-editor.org/info/rfc20>\>.
:   

\[RFC793\]
:   [Postel, J.]{.refAuthor}, [\"Transmission Control
    Protocol\"]{.refTitle}, [STD 7]{.seriesInfo}, [RFC
    793]{.seriesInfo}, [DOI 10.17487/RFC0793]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc793>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2661\]
:   [Townsley, W.]{.refAuthor}[, Valencia, A.]{.refAuthor}[,
    Rubens, A.]{.refAuthor}[, Pall, G.]{.refAuthor}[,
    Zorn, G.]{.refAuthor}[, and B. Palter]{.refAuthor}, [\"Layer Two
    Tunneling Protocol \"L2TP\"\"]{.refTitle}, [RFC 2661]{.seriesInfo},
    [DOI 10.17487/RFC2661]{.seriesInfo}, August 1999,
    \<<https://www.rfc-editor.org/info/rfc2661>\>.
:   

\[RFC2865\]
:   [Rigney, C.]{.refAuthor}[, Willens, S.]{.refAuthor}[,
    Rubens, A.]{.refAuthor}[, and W. Simpson]{.refAuthor}, [\"Remote
    Authentication Dial In User Service (RADIUS)\"]{.refTitle}, [RFC
    2865]{.seriesInfo}, [DOI 10.17487/RFC2865]{.seriesInfo}, June 2000,
    \<<https://www.rfc-editor.org/info/rfc2865>\>.
:   

\[RFC6241\]
:   [Enns, R., Ed.]{.refAuthor}[, Bjorklund, M., Ed.]{.refAuthor}[,
    Schoenwaelder, J., Ed.]{.refAuthor}[, and A. Bierman,
    Ed.]{.refAuthor}, [\"Network Configuration Protocol
    (NETCONF)\"]{.refTitle}, [RFC 6241]{.seriesInfo}, [DOI
    10.17487/RFC6241]{.seriesInfo}, June 2011,
    \<<https://www.rfc-editor.org/info/rfc6241>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[802.1Q\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Local and metropolitan area
    networks\--Bridges and Bridged Networks\"]{.refTitle}, [IEEE
    802.1Q-2018]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2018.8403927]{.seriesInfo}, July 2018,
    \<<https://doi.org/10.1109/IEEESTD.2018.8403927>\>.
:   

\[RFC1661\]
:   [Simpson, W., Ed.]{.refAuthor}, [\"The Point-to-Point Protocol
    (PPP)\"]{.refTitle}, [STD 51]{.seriesInfo}, [RFC 1661]{.seriesInfo},
    [DOI 10.17487/RFC1661]{.seriesInfo}, July 1994,
    \<<https://www.rfc-editor.org/info/rfc1661>\>.
:   

\[RFC2131\]
:   [Droms, R.]{.refAuthor}, [\"Dynamic Host Configuration
    Protocol\"]{.refTitle}, [RFC 2131]{.seriesInfo}, [DOI
    10.17487/RFC2131]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2131>\>.
:   

\[RFC2516\]
:   [Mamakos, L.]{.refAuthor}[, Lidl, K.]{.refAuthor}[,
    Evarts, J.]{.refAuthor}[, Carrel, D.]{.refAuthor}[,
    Simone, D.]{.refAuthor}[, and R. Wheeler]{.refAuthor}, [\"A Method
    for Transmitting PPP Over Ethernet (PPPoE)\"]{.refTitle}, [RFC
    2516]{.seriesInfo}, [DOI 10.17487/RFC2516]{.seriesInfo}, February
    1999, \<<https://www.rfc-editor.org/info/rfc2516>\>.
:   

\[RFC2698\]
:   [Heinanen, J.]{.refAuthor}[ and R. Guerin]{.refAuthor}, [\"A Two
    Rate Three Color Marker\"]{.refTitle}, [RFC 2698]{.seriesInfo}, [DOI
    10.17487/RFC2698]{.seriesInfo}, September 1999,
    \<<https://www.rfc-editor.org/info/rfc2698>\>.
:   

\[RFC3022\]
:   [Srisuresh, P.]{.refAuthor}[ and K. Egevang]{.refAuthor},
    [\"Traditional IP Network Address Translator (Traditional
    NAT)\"]{.refTitle}, [RFC 3022]{.seriesInfo}, [DOI
    10.17487/RFC3022]{.seriesInfo}, January 2001,
    \<<https://www.rfc-editor.org/info/rfc3022>\>.
:   

\[RFC3336\]
:   [Thompson, B.]{.refAuthor}[, Koren, T.]{.refAuthor}[, and B.
    Buffam]{.refAuthor}, [\"PPP Over Asynchronous Transfer Mode
    Adaptation Layer 2 (AAL2)\"]{.refTitle}, [RFC 3336]{.seriesInfo},
    [DOI 10.17487/RFC3336]{.seriesInfo}, December 2002,
    \<<https://www.rfc-editor.org/info/rfc3336>\>.
:   

\[RFC5511\]
:   [Farrel, A.]{.refAuthor}, [\"Routing Backus-Naur Form (RBNF): A
    Syntax Used to Form Encoding Rules in Various Routing Protocol
    Specifications\"]{.refTitle}, [RFC 5511]{.seriesInfo}, [DOI
    10.17487/RFC5511]{.seriesInfo}, April 2009,
    \<<https://www.rfc-editor.org/info/rfc5511>\>.
:   

\[RFC7042\]
:   [Eastlake 3rd, D.]{.refAuthor}[ and J. Abley]{.refAuthor}, [\"IANA
    Considerations and IETF Protocol and Documentation Usage for IEEE
    802 Parameters\"]{.refTitle}, [BCP 141]{.seriesInfo}, [RFC
    7042]{.seriesInfo}, [DOI 10.17487/RFC7042]{.seriesInfo}, October
    2013, \<<https://www.rfc-editor.org/info/rfc7042>\>.
:   

\[RFC7348\]
:   [Mahalingam, M.]{.refAuthor}[, Dutt, D.]{.refAuthor}[,
    Duda, K.]{.refAuthor}[, Agarwal, P.]{.refAuthor}[,
    Kreeger, L.]{.refAuthor}[, Sridhar, T.]{.refAuthor}[,
    Bursell, M.]{.refAuthor}[, and C. Wright]{.refAuthor}, [\"Virtual
    eXtensible Local Area Network (VXLAN): A Framework for Overlaying
    Virtualized Layer 2 Networks over Layer 3 Networks\"]{.refTitle},
    [RFC 7348]{.seriesInfo}, [DOI 10.17487/RFC7348]{.seriesInfo}, August
    2014, \<<https://www.rfc-editor.org/info/rfc7348>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   

\[TR-384\]
:   [Broadband Forum]{.refAuthor}, [\"Cloud Central Office Reference
    Architectural Framework\"]{.refTitle}, [BBF TR-384]{.seriesInfo},
    January 2018.
:   

\[WT-459\]
:   [Broadband Forum]{.refAuthor}, [\"Control and User Plane Separation
    for a Disaggregated BNG\"]{.refTitle}, [BBF
    WT-459]{.seriesInfo}, 2019.
:   
:::
:::

::: {#acknowledgements}
::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The helpful comments and suggestions from the following individuals are
hereby acknowledged:[¶](#section-appendix.a-1){.pilcrow}

-   ::: {#section-appendix.a-2.1}
    [Loa
    Andersson]{.contact-name}[¶](#section-appendix.a-2.1.1){.pilcrow}
    :::

-   ::: {#section-appendix.a-2.2}
    [Greg Mirsky]{.contact-name}[¶](#section-appendix.a-2.2.1){.pilcrow}
    :::
:::
:::

::: {#contributors}
::: {#section-appendix.b .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

::: {.left dir="auto"}
[Zhenqiang Li]{.fn .nameRole}
:::

::: {.left dir="auto"}
[China Mobile]{.org}
:::

::: {.left dir="auto"}
[32 Xuanwumen West Ave]{.street-address}
:::

::: {.left dir="auto"}
[Xicheng District]{.locality}
:::

::: {.left dir="auto"}
[Beijing]{.locality}
:::

::: {.left dir="auto"}
[100053]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <lizhenqiang@chinamobile.com>
:::

::: {.left dir="auto"}
[Mach(Guoyi) Chen]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: {.left dir="auto"}
[Huawei Bldg., No. 156 Beiqing Road]{.street-address}
:::

::: {.left dir="auto"}
[Beijing]{.locality}
:::

::: {.left dir="auto"}
[100095]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <mach.chen@huawei.com>
:::

::: {.left dir="auto"}
[Zhouyi Yu]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: email
Email: <yuzhouyi@huawei.com>
:::

::: {.left dir="auto"}
[Chengguang Niu]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: email
Email: <chengguang.niu@huawei.com>
:::

::: {.left dir="auto"}
[Zitao Wang]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: email
Email: <wangzitao@huawei.com>
:::

::: {.left dir="auto"}
[Jun Song]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: email
Email: <song.jun@huawei.com>
:::

::: {.left dir="auto"}
[Dan Meng]{.fn .nameRole}
:::

::: {.left dir="auto"}
[H3C Technologies]{.org}
:::

::: {.left dir="auto"}
[No. 1 Lixing Center]{.extended-address}
:::

::: {.left dir="auto"}
[No. 8 Guangxun South Street]{.street-address}
:::

::: {.left dir="auto"}
[Chaoyang District]{.locality}
:::

::: {.left dir="auto"}
[Beijing]{.locality}
:::

::: {.left dir="auto"}
[100102]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <mengdan@h3c.com>
:::

::: {.left dir="auto"}
[Hanlei Liu]{.fn .nameRole}
:::

::: {.left dir="auto"}
[H3C Technologies]{.org}
:::

::: {.left dir="auto"}
[No. 1 Lixing Center]{.extended-address}
:::

::: {.left dir="auto"}
[No. 8 Guangxun South Street]{.street-address}
:::

::: {.left dir="auto"}
[Chaoyang District]{.locality}
:::

::: {.left dir="auto"}
[Beijing]{.locality}
:::

::: {.left dir="auto"}
[100102]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <hanlei_liu@h3c.com>
:::

::: {.left dir="auto"}
[Victor Lopez]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Telefonica]{.org}
:::

::: {.left dir="auto"}
[Spain]{.country-name}
:::

::: email
Email: <victor.lopezalvarez@telefonica.com>
:::
:::
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Shujun Hu]{.fn .nameRole}
:::

::: {.left dir="auto"}
[China Mobile]{.org}
:::

::: {.left dir="auto"}
[32 Xuanwumen West Ave]{.street-address}
:::

::: {.left dir="auto"}
[Xicheng District]{.locality}
:::

::: {.left dir="auto"}
[Beijing]{.locality}
:::

::: {.left dir="auto"}
[100053]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <hushujun@chinamobile.com>
:::

::: {.left dir="auto"}
[Donald Eastlake 3rd]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Futurewei Technologies]{.org}
:::

::: {.left dir="auto"}
[2386 Panoramic Circle]{.street-address}
:::

::: {.left dir="auto"}
[Apopka]{.locality}, [FL]{.region} [32703]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1-508-333-2270](tel:+1-508-333-2270){.tel}
:::

::: email
Email: <d3e3e3@gmail.com>
:::

::: {.left dir="auto"}
[Fengwei Qin]{.fn .nameRole}
:::

::: {.left dir="auto"}
[China Mobile]{.org}
:::

::: {.left dir="auto"}
[32 Xuanwumen West Ave]{.street-address}
:::

::: {.left dir="auto"}
[Xicheng District]{.locality}
:::

::: {.left dir="auto"}
[Beijing]{.locality}
:::

::: {.left dir="auto"}
[100053]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <qinfengwei@chinamobile.com>
:::

::: {.left dir="auto"}
[Tee Mong Chua]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Singapore Telecommunications Limited]{.org}
:::

::: {.left dir="auto"}
[31 Exeter Road, #05-04 Comcentre Podium Block]{.street-address}
:::

::: {.left dir="auto"}
SINGAPORE [239732]{.postal-code}
:::

::: {.left dir="auto"}
[Singapore]{.country-name}
:::

::: email
Email: <teemong@singtel.com>
:::

::: {.left dir="auto"}
[Daniel Huang]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ZTE]{.org}
:::

::: email
Email: <huang.guangping@zte.com.cn>
:::
:::
:::
