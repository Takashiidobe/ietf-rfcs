  RFC 8842             SDP Offer/Answer Considerations for DTLS   January 2021
  -------------------- ------------------------------------------ --------------
  Holmberg & Shpount   Standards Track                            \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8842](https://www.rfc-editor.org/rfc/rfc8842){.eref}

Updates:
:   [5763](https://www.rfc-editor.org/rfc/rfc5763){.eref},
    [7345](https://www.rfc-editor.org/rfc/rfc7345){.eref}

Category:
:   Standards Track

Published:
:   January 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    C. Holmberg
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    R. Shpount
    :::

    ::: org
    TurboBridge
    :::
    :::
:::

# RFC 8842 {#rfcnum}

# Session Description Protocol (SDP) Offer/Answer Considerations for Datagram Transport Layer Security (DTLS) and Transport Layer Security (TLS) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document defines the Session Description Protocol (SDP)
offer/answer procedures for negotiating and establishing a Datagram
Transport Layer Security (DTLS) association. The document also defines
the criteria for when a new DTLS association must be established. The
document updates RFCs 5763 and 7345 by replacing common SDP offer/answer
procedures with a reference to this
specification.[¶](#section-abstract-1){.pilcrow}

This document defines a new SDP media-level attribute,
\"tls-id\".[¶](#section-abstract-2){.pilcrow}

This document also defines how the \"tls-id\" attribute can be used for
negotiating and establishing a Transport Layer Security (TLS)
connection, in conjunction with the procedures in RFCs 4145 and
8122.[¶](#section-abstract-3){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8842>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions](#name-conventions){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Establishing a New DTLS
    Association](#name-establishing-a-new-dtls-ass){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [General](#name-general){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Change of Local Transport
        Parameters](#name-change-of-local-transport-p){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Change of ICE ufrag
        Value](#name-change-of-ice-ufrag-value){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [SDP \"tls-id\"
    Attribute](#name-sdp-tls-id-attribute){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [SDP Offer/Answer
    Procedures](#name-sdp-offer-answer-procedures){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [General](#name-general-2){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Generating the Initial SDP
        Offer](#name-generating-the-initial-sdp-){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Generating the
        Answer](#name-generating-the-answer){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Offerer Processing of the SDP
        Answer](#name-offerer-processing-of-the-s){.xref}[¶](#section-toc.1-1.5.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Modifying the
        Session](#name-modifying-the-session){.xref}[¶](#section-toc.1-1.5.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [ICE
    Considerations](#name-ice-considerations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [TLS
    Considerations](#name-tls-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [SIP
    Considerations](#name-sip-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [RFC
    Updates](#name-rfc-updates){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [General](#name-general-3){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Update to RFC
        5763](#name-update-to-rfc-5763){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.9.2.2.2.1}
            [9.2.1](#section-9.2.1){.xref}.  [Update to Section
            1](#name-update-to-section-1){.xref}[¶](#section-toc.1-1.9.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.2.2.2}
            [9.2.2](#section-9.2.2){.xref}.  [Update to Section
            5](#name-update-to-section-5){.xref}[¶](#section-toc.1-1.9.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.2.2.3}
            [9.2.3](#section-9.2.3){.xref}.  [Update to Section
            6.6](#name-update-to-section-66){.xref}[¶](#section-toc.1-1.9.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.2.2.4}
            [9.2.4](#section-9.2.4){.xref}.  [Update to Section
            6.7.1](#name-update-to-section-671){.xref}[¶](#section-toc.1-1.9.2.2.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [9.3](#section-9.3){.xref}.  [Update to RFC
        7345](#name-update-to-rfc-7345){.xref}[¶](#section-toc.1-1.9.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.9.2.3.2.1}
            [9.3.1](#section-9.3.1){.xref}.  [Update to Section
            4](#name-update-to-section-4){.xref}[¶](#section-toc.1-1.9.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.3.2.2}
            [9.3.2](#section-9.3.2){.xref}.  [Update to Section
            5.2.1](#name-update-to-section-521){.xref}[¶](#section-toc.1-1.9.2.3.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.3.2.3}
            [9.3.3](#section-9.3.3){.xref}.  [Update to Section
            9.1](#name-update-to-section-91){.xref}[¶](#section-toc.1-1.9.2.3.2.3.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}

    -   ::: {#section-toc.1-1.12.2.1}
        [12.1](#section-12.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.12.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [12.2](#section-12.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.12.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

\[[RFC5763](#RFC5763){.xref}\] defines Session Description Protocol
(SDP) offer/answer procedures for Secure Real-time Transport Protocol
using Datagram Transport Layer Security (DTLS-SRTP).
\[[RFC7345](#RFC7345){.xref}\] defines SDP offer/answer procedures for
UDP Transport Layer over Datagram Transport Layer Security (UDPTL-DTLS).
This specification defines general offer/answer procedures for DTLS,
based on the procedures in \[[RFC5763](#RFC5763){.xref}\]. Other
specifications, defining specific DTLS usages, can then reference this
specification, in order to ensure that the DTLS aspects are common among
all usages. Having common procedures is essential when multiple usages
share the same DTLS association \[[RFC8843](#RFC8843){.xref}\]. This
document updates \[[RFC5763](#RFC5763){.xref}\] and
\[[RFC7345](#RFC7345){.xref}\] by replacing common SDP offer/answer
procedures with a reference to this
specification.[¶](#section-1-1){.pilcrow}

NOTE: Since the publication of \[[RFC5763](#RFC5763){.xref}\],
\[[RFC4474](#RFC4474){.xref}\] has been obsoleted by
\[[RFC8224](#RFC8224){.xref}\]. The updating of the references (and the
associated procedures) within \[[RFC5763](#RFC5763){.xref}\] is outside
the scope of this document. However, implementers of
\[[RFC5763](#RFC5763){.xref}\] applications are encouraged to implement
\[[RFC8224](#RFC8224){.xref}\] instead of
\[[RFC4474](#RFC4474){.xref}\].[¶](#section-1-2.1){.pilcrow}

As defined in \[[RFC5763](#RFC5763){.xref}\], a new DTLS association
[MUST]{.bcp14} be established when transport parameters are changed.
Transport parameter change is not well defined when Interactive
Connectivity Establishment (ICE) \[[RFC8445](#RFC8445){.xref}\] is used.
One possible way to determine a transport change is based on ufrag
\[[RFC8445](#RFC8445){.xref}\] change, but the ufrag value is changed
both when ICE is negotiated and when ICE restart
\[[RFC8445](#RFC8445){.xref}\] occurs. These events do not always
require a new DTLS association to be established, but previously there
was no way to explicitly indicate in an SDP offer or answer whether a
new DTLS association was required. To solve that problem, this document
defines a new SDP attribute, \"tls-id\". The pair of SDP \"tls-id\"
attribute values (the attribute values of the offerer and the answerer)
uniquely identifies the DTLS association. Providing a new value of the
\"tls-id\" attribute in an SDP offer or answer can be used to indicate
whether a new DTLS association is to be
established.[¶](#section-1-3){.pilcrow}

The SDP \"tls-id\" attribute can be specified when negotiating a
Transport Layer Security (TLS) connection, using the procedures in this
document in conjunction with the procedures in
\[[RFC5763](#RFC5763){.xref}\] and \[[RFC8122](#RFC8122){.xref}\]. The
unique combination of SDP \"tls-id\" attribute values can be used to
identify the negotiated TLS connection. The unique value can be used,
for example, within TLS protocol extensions to differentiate between
multiple TLS connections and correlate those connections with specific
offer/answer exchanges. The TLS-specific considerations are described in
[Section 7](#sec-tls-cons){.xref}.[¶](#section-1-4){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions](#name-conventions){.section-name .selfRef} {#name-conventions}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Establishing a New DTLS Association](#name-establishing-a-new-dtls-ass){.section-name .selfRef} {#name-establishing-a-new-dtls-ass}

::: {#sec-dtls-gen}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [General](#name-general){.section-name .selfRef} {#name-general}

A new DTLS association must be established between two endpoints after a
successful SDP offer/answer exchange in the following
cases:[¶](#section-3.1-1){.pilcrow}

-   [The negotiated DTLS setup roles change;
    or[¶](#section-3.1-2.1){.pilcrow}]{#section-3.1-2.1}
-   [One or more fingerprint values are modified, added, or removed in
    either an SDP offer or answer;
    or[¶](#section-3.1-2.2){.pilcrow}]{#section-3.1-2.2}
-   [The intent to establish a new DTLS association is explicitly
    signaled using SDP, by changing the value of the SDP \"tls-id\"
    attribute defined in this
    document;[¶](#section-3.1-2.3){.pilcrow}]{#section-3.1-2.3}

NOTE: The first two items above are based on the procedures in
\[[RFC5763](#RFC5763){.xref}\]. This specification adds the support for
explicit signaling using the SDP \"tls-id\"
attribute.[¶](#section-3.1-3.1){.pilcrow}

A new DTLS association can only be established as a result of the
successful SDP offer/answer exchange. Whenever an entity determines that
a new DTLS association is required, the entity [MUST]{.bcp14} initiate
an SDP offer/answer exchange, following the procedures in [Section
5](#sec-oa){.xref}.[¶](#section-3.1-4){.pilcrow}

The sections below describe typical cases where a new DTLS association
needs to be established.[¶](#section-3.1-5){.pilcrow}

In this document, a \"new DTLS association\" between two endpoints
refers to either an initial DTLS association (when no DTLS association
is currently established between the endpoints) or a DTLS association
replacing a previously established one.[¶](#section-3.1-6){.pilcrow}
:::
:::

::: {#sec-dtls-transport}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Change of Local Transport Parameters](#name-change-of-local-transport-p){.section-name .selfRef} {#name-change-of-local-transport-p}

If an endpoint modifies its local transport parameters (address and/or
port), and if the modification requires a new DTLS association, the
endpoint [MUST]{.bcp14} change its local SDP \"tls-id\" attribute value
(see [Section 4](#sec-dcon-attr){.xref}).[¶](#section-3.2-1){.pilcrow}

If the underlying transport protocol prohibits a DTLS association from
spanning multiple 5-tuples (transport/source address/source
port/destination address/destination port), and if the 5-tuple is
changed, the endpoint [MUST]{.bcp14} change its local SDP \"tls-id\"
attribute value (see [Section 4](#sec-dcon-attr){.xref}). An example of
such a case is when DTLS is carried over the Stream Control Transmission
Protocol (SCTP), as described in
\[[RFC6083](#RFC6083){.xref}\].[¶](#section-3.2-2){.pilcrow}
:::
:::

::: {#sec-dtls-ufrag}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Change of ICE ufrag Value](#name-change-of-ice-ufrag-value){.section-name .selfRef} {#name-change-of-ice-ufrag-value}

If an endpoint uses ICE and modifies a local ufrag value, and if the
modification requires a new DTLS association, the endpoint
[MUST]{.bcp14} change its local SDP \"tls-id\" attribute value (see
[Section 4](#sec-dcon-attr){.xref}).[¶](#section-3.3-1){.pilcrow}
:::
:::
:::

::: {#sec-dcon-attr}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [SDP \"tls-id\" Attribute](#name-sdp-tls-id-attribute){.section-name .selfRef} {#name-sdp-tls-id-attribute}

The pair of SDP \"tls-id\" attribute values (the attribute values of the
offerer and the answerer) uniquely identifies the DTLS association or
TLS connection.[¶](#section-4-1){.pilcrow}

[]{.break}

Name:
:   tls-id[¶](#section-4-2.2){.pilcrow}
:   

Value:
:   tls-id-value[¶](#section-4-2.4){.pilcrow}
:   

Usage Level:
:   media[¶](#section-4-2.6){.pilcrow}
:   

Charset Dependent:
:   no[¶](#section-4-2.8){.pilcrow}
:   

Default Value:
:   N/A[¶](#section-4-2.10){.pilcrow}
:   

Syntax:

:   ::: {#section-4-2.12.1}
    ``` {.sourcecode .lang-abnf}
    tls-id-value = 20*255(tls-id-char)
    tls-id-char = ALPHA / DIGIT / "+" / "/" / "-" / "_"
    ```

    [¶](#section-4-2.12.1){.pilcrow}
    :::

    \<ALPHA and DIGIT defined in RFC
    4566>[¶](#section-4-2.12.2){.pilcrow}

:   

Example:

:   ::: {#section-4-2.14.1}
    ``` {.sourcecode .lang-sdp}
    a=tls-id:abc3de65cddef001be82
    ```

    [¶](#section-4-2.14.1){.pilcrow}
    :::

:   

Every time an endpoint requests to establish a new DTLS association, the
endpoint [MUST]{.bcp14} generate a new local \"tls-id\" attribute value.
An unchanged local \"tls-id\" attribute value, in combination with
non-changed fingerprints, indicates that the endpoint intends to reuse
the existing DTLS association.[¶](#section-4-3){.pilcrow}

The \"tls-id\" attribute value [MUST]{.bcp14} be generated using a
strong random function and include at least 120 bits of
randomness.[¶](#section-4-4){.pilcrow}

No default value is defined for the SDP \"tls-id\" attribute.
Implementations that wish to use the attribute [MUST]{.bcp14} explicitly
include it in SDP offers and answers. If an offer or answer does not
contain a \"tls-id\" attribute (this could happen if the offerer or
answerer represents an existing implementation that has not been updated
to support the \"tls-id\" attribute), a modification of one or more of
the following characteristics [MUST]{.bcp14} be treated as an indication
that an endpoint wants to establish a new DTLS association, unless there
is another mechanism to explicitly indicate that a new DTLS association
is to be established:[¶](#section-4-5){.pilcrow}

-   [DTLS setup role; or[¶](#section-4-6.1){.pilcrow}]{#section-4-6.1}
-   [fingerprint set; or[¶](#section-4-6.2){.pilcrow}]{#section-4-6.2}
-   [local transport
    parameters[¶](#section-4-6.3){.pilcrow}]{#section-4-6.3}

NOTE: A modification of the ufrag value is not treated as an indication
that an endpoint wants to establish a new DTLS association. In order to
indicate that a new DTLS association is to be established, one or more
of the characteristics listed above have to be
modified.[¶](#section-4-7.1){.pilcrow}

The mux category \[[RFC8859](#RFC8859){.xref}\] for the \"tls-id\"
attribute is \"IDENTICAL\", which means that the attribute value applies
to all media descriptions being multiplexed
\[[RFC8843](#RFC8843){.xref}\]. However, as described in
\[[RFC8843](#RFC8843){.xref}\], in order to avoid duplication, the
attribute is only associated with the \"m=\" line representing the
offerer/answerer BUNDLE tag.[¶](#section-4-8){.pilcrow}

For RTP-based media, the \"tls-id\" attribute applies to the whole
associated media description. The attribute [MUST NOT]{.bcp14} be
defined per source (using the SDP \"ssrc\" attribute
\[[RFC5576](#RFC5576){.xref}\]).[¶](#section-4-9){.pilcrow}

The SDP offer/answer procedures \[[RFC3264](#RFC3264){.xref}\]
associated with the attribute are defined in [Section
5](#sec-oa){.xref}.[¶](#section-4-10){.pilcrow}
:::
:::

::: {#sec-oa}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [SDP Offer/Answer Procedures](#name-sdp-offer-answer-procedures){.section-name .selfRef} {#name-sdp-offer-answer-procedures}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [General](#name-general-2){.section-name .selfRef} {#name-general-2}

This section defines the generic SDP offer/answer procedures for
negotiating a DTLS association. Additional procedures (e.g., regarding
usage of specific SDP attributes) for individual DTLS usages (e.g.,
DTLS-SRTP) are outside the scope of this specification and need to be
specified in a usage-specific document.[¶](#section-5.1-1){.pilcrow}

NOTE: The procedures in this section are generalizations of procedures
first specified in the DTLS-SRTP document
\[[RFC5763](#RFC5763){.xref}\], with the addition of usage of the SDP
\"tls-id\" attribute. That document is herein updated to make use of
these new procedures.[¶](#section-5.1-2.1){.pilcrow}

The procedures in this section apply to an SDP media description (\"m=\"
line) associated with DTLS-protected
media/data.[¶](#section-5.1-3){.pilcrow}

When an offerer or answerer indicates that it wants to establish a new
DTLS association, it needs to make sure that media packets associated
with any previously established DTLS association and the new DTLS
association can be demultiplexed. In the case of an ordered transport
(e.g., SCTP), this can be done simply by sending packets for the new
DTLS association after all packets associated with a previously
established DTLS association have been sent. In the case of an unordered
transport, such as UDP, packets associated with a previously established
DTLS association can arrive after the answer SDP and the first packets
associated with the new DTLS association have been received. The only
way to demultiplex packets associated with a previously established DTLS
association and the new DTLS association is on the basis of the 5-tuple.
Because of this, if an unordered transport is used for the DTLS
association, a new 3-tuple (transport/source address/source port)
[MUST]{.bcp14} be allocated by at least one of the endpoints so that
DTLS packets can be demultiplexed.[¶](#section-5.1-4){.pilcrow}

When an offerer needs to establish a new DTLS association, and if an
unordered transport (e.g., UDP) is used, the offerer [MUST]{.bcp14}
allocate a new 3-tuple for the offer in such a way that the offerer can
disambiguate any packets associated with the new DTLS association from
any packets associated with any other DTLS association. This typically
means using a local address and/or port, or a set of ICE candidates (see
[Section 6](#sec-dtls-reest-ice){.xref}), which were not recently used
for any other DTLS association.[¶](#section-5.1-5){.pilcrow}

When an answerer needs to establish a new DTLS association, if an
unordered transport is used, and the offerer did not allocate a new
3-tuple, the answerer [MUST]{.bcp14} allocate a new 3-tuple for the
answer in such a way that it can disambiguate any packets associated
with the new DTLS association from any packets associated with any other
DTLS association. This typically means using a local address and/or
port, or a set of ICE candidates (see [Section
6](#sec-dtls-reest-ice){.xref}), which were not recently used for any
other DTLS association.[¶](#section-5.1-6){.pilcrow}

In order to negotiate a DTLS association, the following SDP attributes
are used:[¶](#section-5.1-7){.pilcrow}

-   [The SDP \"setup\" attribute, defined in
    \[[RFC4145](#RFC4145){.xref}\], is used to negotiate the DTLS
    roles;[¶](#section-5.1-8.1){.pilcrow}]{#section-5.1-8.1}
-   [The SDP \"fingerprint\" attribute, defined in
    \[[RFC8122](#RFC8122){.xref}\], is used to provide one or more
    fingerprint values;
    and[¶](#section-5.1-8.2){.pilcrow}]{#section-5.1-8.2}
-   [The SDP \"tls-id\" attribute, defined in this specification, is
    used to identity the DTLS
    association.[¶](#section-5.1-8.3){.pilcrow}]{#section-5.1-8.3}

This specification does not define the usage of the SDP \"connection\"
attribute \[[RFC4145](#RFC4145){.xref}\] for negotiating a DTLS
association. However, the attribute [MAY]{.bcp14} be used if the DTLS
association is used together with another protocol (e.g., SCTP or TCP)
for which the usage of the attribute has been
defined.[¶](#section-5.1-9){.pilcrow}

Unlike for TCP and TLS connections, endpoints [MUST NOT]{.bcp14} use the
SDP \"setup\" attribute \"holdconn\" value when negotiating a DTLS
association.[¶](#section-5.1-10){.pilcrow}

Endpoints [MUST]{.bcp14} support the hash functions as defined in
\[[RFC8122](#RFC8122){.xref}\].[¶](#section-5.1-11){.pilcrow}

The certificate received during the DTLS handshake
\[[RFC6347](#RFC6347){.xref}\] [MUST]{.bcp14} match a certificate
fingerprint received in SDP \"fingerprint\" attributes according to the
procedures defined in \[[RFC8122](#RFC8122){.xref}\]. If fingerprints do
not match the hashed certificate, then an endpoint [MUST]{.bcp14} tear
down the media session immediately (see
\[[RFC8122](#RFC8122){.xref}\]).[¶](#section-5.1-12){.pilcrow}

SDP offerers and answerers might reuse certificates across multiple DTLS
associations, and provide identical fingerprint values for each DTLS
association. The combination of the SDP \"tls-id\" attribute values of
the SDP offerer and answerer identifies each individual DTLS
association.[¶](#section-5.1-13){.pilcrow}

NOTE: There are cases where the SDP \"tls-id\" attribute value generated
by the offerer will end up being used for multiple DTLS associations.
For that reason, the combination of the attribute values of the offerer
and answerer is needed in order to identity a DTLS association. An
example of such a case is where the offerer sends an updated offer
([Section 5.5](#sec-oa-mod){.xref}) without modifying its attribute
value, but the answerer determines that a new DTLS association is to be
created. The answerer will generate a new local attribute value for the
new DTLS association ([Section 5.3](#sec-oa-answer){.xref}), while the
offerer will use the same attribute value that it used for the current
association. Another example is when the Session Initiation Protocol
(SIP) \[[RFC3261](#RFC3261){.xref}\] is used for signaling, and an offer
is forked to multiple answerers. The attribute value generated by the
offerer will be used for DTLS associations established by each
answerer.[¶](#section-5.1-14.1){.pilcrow}
:::

::: {#sec-oa-offer}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Generating the Initial SDP Offer](#name-generating-the-initial-sdp-){.section-name .selfRef} {#name-generating-the-initial-sdp-}

When an offerer sends the initial offer, the offerer [MUST]{.bcp14}
insert an SDP \"setup\" attribute \[[RFC4145](#RFC4145){.xref}\] with an
\"actpass\" attribute value, as well as one or more SDP \"fingerprint\"
attributes according to the procedures in
\[[RFC8122](#RFC8122){.xref}\]. In addition, the offerer [MUST]{.bcp14}
insert in the offer an SDP \"tls-id\" attribute with a unique attribute
value.[¶](#section-5.2-1){.pilcrow}

As the offerer inserts the SDP \"setup\" attribute with an \"actpass\"
attribute value, the offerer [MUST]{.bcp14} be prepared to receive a
DTLS ClientHello message \[[RFC6347](#RFC6347){.xref}\] from the
answerer (if a new DTLS association is established by the answerer)
before the offerer receives the SDP answer.[¶](#section-5.2-2){.pilcrow}

If the offerer receives a DTLS ClientHello message, and a DTLS
association is established before the offerer receives the SDP answer
carrying the fingerprint associated with the DTLS association, any data
received on the DTLS association before the fingerprint [MUST]{.bcp14}
be considered to be coming from an unverified source. The processing of
such data and sending of data by the offerer to the unverified source is
outside the scope of this document.[¶](#section-5.2-3){.pilcrow}
:::
:::

::: {#sec-oa-answer}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Generating the Answer](#name-generating-the-answer){.section-name .selfRef} {#name-generating-the-answer}

When an answerer sends an answer, the answerer [MUST]{.bcp14} insert in
the answer an SDP \"setup\" attribute according to the procedures in
\[[RFC4145](#RFC4145){.xref}\] and one or more SDP \"fingerprint\"
attributes according to the procedures in
\[[RFC8122](#RFC8122){.xref}\]. If the answerer determines, based on the
criteria specified in [Section 3.1](#sec-dtls-gen){.xref}, that a new
DTLS association is to be established, the answerer [MUST]{.bcp14}
insert in the associated answer an SDP \"tls-id\" attribute with a new
unique attribute value. Note that the offerer and answerer generate
their own local \"tls-id\" attribute values, and the combination of both
values identifies the DTLS association.[¶](#section-5.3-1){.pilcrow}

If the answerer receives an offer that requires establishment of a new
DTLS association, and if the answerer does not accept the establishment
of a new DTLS association, the answerer [MUST]{.bcp14} reject the \"m=\"
lines associated with the suggested DTLS association
\[[RFC3264](#RFC3264){.xref}\].[¶](#section-5.3-2){.pilcrow}

If an answerer receives an offer that does not require the establishment
of a new DTLS association, and if the answerer determines that a new
DTLS association is not to be established, the answerer [MUST]{.bcp14}
insert in the associated answer an SDP \"tls-id\" attribute with the
previously assigned attribute value. In addition, the answerer
[MUST]{.bcp14} insert an SDP \"setup\" attribute with an attribute value
that does not change the previously negotiated DTLS roles, as well as
one or more SDP \"fingerprint\" attributes values that do not change the
previously sent fingerprint set, in the associated
answer.[¶](#section-5.3-3){.pilcrow}

If the answerer receives an offer that does not contain an SDP
\"tls-id\" attribute, the answerer [MUST NOT]{.bcp14} insert a
\"tls-id\" attribute in the answer.[¶](#section-5.3-4){.pilcrow}

If a new DTLS association is to be established, and if the answerer
inserts an SDP \"setup\" attribute with an \"active\" attribute value in
the answer, the answerer [MUST]{.bcp14} initiate a DTLS handshake
\[[RFC6347](#RFC6347){.xref}\] by sending a DTLS ClientHello message
towards the offerer.[¶](#section-5.3-5){.pilcrow}

Even though an offerer is required to insert an \"SDP\" setup attribute
with an \"actpass\" attribute value in initial offers ([Section
5.2](#sec-oa-offer){.xref}) and subsequent offers ([Section
5.5](#sec-oa-mod){.xref}), the answerer [MUST]{.bcp14} be able to
receive initial and subsequent offers with other attribute values, in
order to be backward compatible with older implementations that might
insert other attribute values in initial and subsequent
offers.[¶](#section-5.3-6){.pilcrow}
:::
:::

::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Offerer Processing of the SDP Answer](#name-offerer-processing-of-the-s){.section-name .selfRef} {#name-offerer-processing-of-the-s}

When an offerer receives an answer that establishes a new DTLS
association based on criteria defined in [Section
3.1](#sec-dtls-gen){.xref}, if the offerer becomes DTLS client (based on
the value of the SDP \"setup\" attribute value
\[[RFC4145](#RFC4145){.xref}\]), the offerer [MUST]{.bcp14} establish a
DTLS association. If the offerer becomes DTLS server, it [MUST]{.bcp14}
wait for the answerer to establish the DTLS
association.[¶](#section-5.4-1){.pilcrow}

If the offerer indicated a desire to reuse an existing DTLS association,
and the answerer does not request the establishment of a new DTLS
association, the offerer will continue to use the previously established
DTLS association.[¶](#section-5.4-2){.pilcrow}

A new DTLS association can be established based on changes in either an
SDP offer or answer. When communicating with legacy endpoints, an
offerer can receive an answer that includes the same fingerprint set and
setup role. A new DTLS association will still be established if such an
answer is received as a response to an offer that requested the
establishment of a new DTLS association, as the transport parameters
would have been changed in the offer.[¶](#section-5.4-3){.pilcrow}
:::

::: {#sec-oa-mod}
::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Modifying the Session](#name-modifying-the-session){.section-name .selfRef} {#name-modifying-the-session}

When an offerer sends a subsequent offer, if the offerer wants to
establish a new DTLS association, the offerer [MUST]{.bcp14} insert an
SDP \"setup\" attribute \[[RFC4145](#RFC4145){.xref}\] with an
\"actpass\" attribute value, as well as or more SDP \"fingerprint\"
attributes according to the procedures in
\[[RFC8122](#RFC8122){.xref}\]. In addition, the offerer [MUST]{.bcp14}
insert in the offer an SDP \"tls-id\" attribute with a new unique
attribute value.[¶](#section-5.5-1){.pilcrow}

When an offerer sends a subsequent offer and does not want to establish
a new DTLS association, if a previously established DTLS association
exists, the offerer [MUST]{.bcp14} insert in the offer an SDP \"setup\"
attribute with an \"actpass\" attribute value, and one or more SDP
\"fingerprint\" attributes with attribute values that do not change the
previously sent fingerprint set. In addition, the offerer [MUST]{.bcp14}
insert an SDP \"tls-id\" attribute with the previously assigned
attribute value in the offer.[¶](#section-5.5-2){.pilcrow}

NOTE: When a new DTLS association is being established, each endpoint
needs to be prepared to receive data on both the new and old DTLS
associations as long as both are alive.[¶](#section-5.5-3.1){.pilcrow}
:::
:::
:::
:::

::: {#sec-dtls-reest-ice}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [ICE Considerations](#name-ice-considerations){.section-name .selfRef} {#name-ice-considerations}

When the Interactive Connectivity Establishment (ICE) mechanism
\[[RFC8445](#RFC8445){.xref}\] is used, the ICE connectivity checks are
performed before the DTLS handshake begins. Note that if aggressive
nomination mode is used, multiple candidate pairs may be marked valid
before ICE finally converges on a single candidate
pair.[¶](#section-6-1){.pilcrow}

NOTE: Aggressive nomination has been deprecated from ICE but must still
be supported for backwards compatibility reasons
\[[RFC8445](#RFC8445){.xref}\].[¶](#section-6-2.1){.pilcrow}

When a new DTLS association is established over an unordered transport,
in order to disambiguate any packets associated with the newly
established DTLS association, at least one of the endpoints
[MUST]{.bcp14} allocate a completely new set of ICE candidates that were
not recently used for any other DTLS association. This means the
answerer cannot initiate a new DTLS association unless the offerer
initiated ICE restart \[[RFC8445](#RFC8445){.xref}\]. If the answerer
wants to initiate a new DTLS association, it needs to initiate an ICE
restart and a new offer/answer exchange on its own. However, an ICE
restart does not by default require a new DTLS association to be
established.[¶](#section-6-3){.pilcrow}

NOTE: Simple Traversal of the UDP Protocol through NAT (STUN) packets
are sent directly over UDP, not over DTLS.
\[[RFC7983](#RFC7983){.xref}\] describes how to demultiplex STUN packets
from DTLS packets and SRTP packets.[¶](#section-6-4.1){.pilcrow}

Each ICE candidate associated with a component is treated as being part
of the same DTLS association. Therefore, from a DTLS perspective, it is
not considered a change of local transport parameters when an endpoint
switches between those ICE candidates.[¶](#section-6-5){.pilcrow}
:::
:::

::: {#sec-tls-cons}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [TLS Considerations](#name-tls-considerations){.section-name .selfRef} {#name-tls-considerations}

The procedures in this document can also be used for negotiating and
establishing a TLS connection, with the restriction described
below.[¶](#section-7-1){.pilcrow}

As specified in \[[RFC4145](#RFC4145){.xref}\], the SDP \"connection\"
attribute is used to indicate whether to establish a new TLS connection.
An offerer and answerer [MUST]{.bcp14} ensure that the \"connection\"
attribute value and the \"tls-id\" attribute value do not cause a
conflict regarding whether a new TLS connection is to be established or
not.[¶](#section-7-2){.pilcrow}

NOTE: Even though the SDP \"connection\" attribute can be used to
indicate whether a new TLS connection is to be established, the unique
combination of SDP \"tls-id\" attribute values can be used to identity a
TLS connection. The unique value can be used e.g., within TLS protocol
extensions to differentiate between multiple TLS connections and
correlate those connections with specific offer/answer exchanges. One
such extension is defined in
\[[RFC8844](#RFC8844){.xref}\].[¶](#section-7-3.1){.pilcrow}

If an offerer or answerer inserts an SDP \"connection\" attribute with a
\"new\" value in the offer/answer and also inserts an SDP \"tls-id\"
attribute, the value of the \"tls-id\" attribute [MUST]{.bcp14} be new
and unique.[¶](#section-7-4){.pilcrow}

If an offerer or answerer inserts an SDP \"connection\" attribute with
an \"existing\" value in the offer/answer, if a previously established
TLS connection exists, and if the offerer/answerer previously inserted
an SDP \"tls-id\" attribute associated with the same TLS connection in
an offer/answer, the offerer/answerer [MUST]{.bcp14} also insert an SDP
\"tls-id\" attribute with the previously assigned value in the
offer/answer.[¶](#section-7-5){.pilcrow}

If an offerer or answerer receives an offer/answer with conflicting
attribute values, the offerer/answerer [MUST]{.bcp14} process the
offer/answer as misformed.[¶](#section-7-6){.pilcrow}

An endpoint [MUST NOT]{.bcp14} make assumptions regarding the support of
the SDP \"tls-id\" attribute by the peer. Therefore, to avoid ambiguity,
both offerers and answerers [MUST]{.bcp14} always use the \"connection\"
attribute in conjunction with the \"tls-id\"
attribute.[¶](#section-7-7){.pilcrow}

NOTE: As defined in \[[RFC4145](#RFC4145){.xref}\], if the SDP
\"connection\" attribute is not explicitly present, the implicit default
value is \"new\".[¶](#section-7-8.1){.pilcrow}

The SDP example below is based on the example in [Section
3.4](https://www.rfc-editor.org/rfc/rfc8122#section-3.4){.relref} of
\[[RFC8122](#RFC8122){.xref}\], with the addition of the SDP \"tls-id\"
attribute.[¶](#section-7-9){.pilcrow}

::: {#section-7-10}
``` {.sourcecode .lang-sdp}
m=image 54111 TCP/TLS t38
c=IN IP4 192.0.2.2
a=tls-id:abc3de65cddef001be82
a=setup:passive
a=connection:new
a=fingerprint:SHA-256 \
 12:DF:3E:5D:49:6B:19:E5:7C:AB:4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF: \
 3E:5D:49:6B:19:E5:7C:AB:4A:AD
a=fingerprint:SHA-1 \
 4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
```

[¶](#section-7-10){.pilcrow}
:::
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [SIP Considerations](#name-sip-considerations){.section-name .selfRef} {#name-sip-considerations}

When the Session Initiation Protocol (SIP)
\[[RFC3261](#RFC3261){.xref}\] is used as the signal protocol for
establishing a multimedia session, dialogs
\[[RFC3261](#RFC3261){.xref}\] might be established between the caller
and multiple callees. This is referred to as forking. If forking occurs,
separate DTLS associations will be established between the caller and
each callee.[¶](#section-8-1){.pilcrow}

When forking occurs, an SDP offerer can receive DTLS ClientHello
messages and SDP answers from multiple remote locations. Because of
this, the offerer might have to wait for multiple SDP answers (from
different remote locations) until it receives a certificate fingerprint
that matches the certificate associated with a specific DTLS handshake.
The offerer [MUST NOT]{.bcp14} declare a fingerprint mismatch until it
determines that it will not receive SDP answers from any additional
remote locations.[¶](#section-8-2){.pilcrow}

It is possible to send an INVITE request that does not contain an SDP
offer. Such an INVITE request is often referred to as an \"empty
INVITE\" or an \"offerless INVITE\". The receiving endpoint will include
the SDP offer in a response to the request. When the endpoint generates
such an SDP offer, if a previously established DTLS association exists,
the offerer [MUST]{.bcp14} insert an SDP \"tls-id\" attribute and one or
more SDP \"fingerprint\" attributes, with previously assigned attribute
values. If a previously established DTLS association does not exist, the
offer [MUST]{.bcp14} be generated based on the same rules as a new offer
(see [Section 5.2](#sec-oa-offer){.xref}). Regardless of the previous
existence of a DTLS association, the SDP \"setup\" attribute
[MUST]{.bcp14} be included according to the rules defined in
\[[RFC4145](#RFC4145){.xref}\]. Furthermore, if ICE is used, ICE restart
[MUST]{.bcp14} be initiated, according to the third-party call-control
considerations described in
\[[RFC8839](#RFC8839){.xref}\].[¶](#section-8-3){.pilcrow}
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [RFC Updates](#name-rfc-updates){.section-name .selfRef} {#name-rfc-updates}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [General](#name-general-3){.section-name .selfRef} {#name-general-3}

This section updates specifications that use DTLS-protected media, in
order to reflect the procedures defined in this
specification.[¶](#section-9.1-1){.pilcrow}
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Update to RFC 5763](#name-update-to-rfc-5763){.section-name .selfRef} {#name-update-to-rfc-5763}

::: {#section-9.2.1 .section}
#### [9.2.1.](#section-9.2.1){.section-number .selfRef} [Update to Section 1](#name-update-to-section-1){.section-name .selfRef} {#name-update-to-section-1}

The reference to \[[RFC4572](#RFC4572){.xref}\] is replaced with a
reference to
\[[RFC8122](#RFC8122){.xref}\].[¶](#section-9.2.1-1){.pilcrow}
:::

::: {#section-9.2.2 .section}
#### [9.2.2.](#section-9.2.2){.section-number .selfRef} [Update to Section 5](#name-update-to-section-5){.section-name .selfRef} {#name-update-to-section-5}

The text in \[[RFC5763](#RFC5763){.xref}\], [Section
5](https://www.rfc-editor.org/rfc/rfc5763#section-5){.relref}
(\"Establishing a Secure Channel\") is modified by replacing generic SDP
offer/answer procedures for DTLS with a reference to this
specification:[¶](#section-9.2.2-1){.pilcrow}

NEW TEXT:[¶](#section-9.2.2-2){.pilcrow}

> The two endpoints in the exchange present their identities as part of
> the DTLS handshake procedure using certificates. This document uses
> certificates in the same style as described in \"Connection-Oriented
> Media Transport over the Transport Layer Security (TLS) Protocol in
> the Session Description Protocol (SDP)\"
> \[[RFC8122](#RFC8122){.xref}\].[¶](#section-9.2.2-3.1){.pilcrow}
>
> If self-signed certificates are used, the content of the
> \"subjectAltName\" attribute inside the certificate [MAY]{.bcp14} use
> the uniform resource identifier (URI) of the user. This is useful for
> debugging purposes only and is not required to bind the certificate to
> one of the communication endpoints. The integrity of the certificate
> is ensured through the \"fingerprint\" attribute in the
> SDP.[¶](#section-9.2.2-3.2){.pilcrow}
>
> The generation of public/private key pairs is relatively expensive.
> Endpoints are not required to generate certificates for each
> session.[¶](#section-9.2.2-3.3){.pilcrow}
>
> The offer/answer model, defined in \[[RFC3264](#RFC3264){.xref}\], is
> used by protocols like the Session Initiation Protocol (SIP)
> \[[RFC3261](#RFC3261){.xref}\] to set up multimedia
> sessions.[¶](#section-9.2.2-3.4){.pilcrow}
>
> When an endpoint wishes to set up a secure media session with another
> endpoint, it sends an offer in a SIP message to the other endpoint.
> This offer includes, as part of the SDP payload, a fingerprint of a
> certificate that the endpoint wants to use. The endpoint
> [SHOULD]{.bcp14} send the SIP message containing the offer to the
> offerer\'s SIP proxy over an integrity-protected channel. The proxy
> [SHOULD]{.bcp14} add an Identity header field according to the
> procedures outlined in \[[RFC4474](#RFC4474){.xref}\]. When the far
> endpoint receives the SIP message, it can verify the identity of the
> sender using the Identity header field. Since the Identity header
> field is a digital signature across several SIP header fields, in
> addition to the body of the SIP message, the receiver can also be
> certain that the message has not been tampered with after the digital
> signature was applied and added to the SIP
> message.[¶](#section-9.2.2-3.5){.pilcrow}
>
> The far endpoint (answerer) may now establish a DTLS association with
> the offerer. Alternately, it can indicate in its answer that the
> offerer is to initiate the DTLS association. In either case, mutual
> DTLS certificate-based authentication will be used. After completing
> the DTLS handshake, information about the authenticated identities,
> including the certificates, is made available to the endpoint
> application. The answerer is then able to verify that the offerer\'s
> certificate used for authentication in the DTLS handshake can be
> associated with a certificate fingerprint contained in the offer in
> the SDP. At this point, the answerer may indicate to the end user that
> the media is secured. The offerer may only tentatively accept the
> answerer\'s certificate, since it may not yet have the answerer\'s
> certificate fingerprint[¶](#section-9.2.2-3.6){.pilcrow}
>
> When the answerer accepts the offer, it provides an answer back to the
> offerer containing the answerer\'s certificate fingerprint. At this
> point, the offerer can accept or reject the peer\'s certificate, and
> the offerer can indicate to the end user that the media is
> secured.[¶](#section-9.2.2-3.7){.pilcrow}
>
> Note that the entire authentication and key exchange for securing the
> media traffic is handled in the media path through DTLS. The signaling
> path is only used to verify the peers\' certificate
> fingerprints.[¶](#section-9.2.2-3.8){.pilcrow}
>
> The offerer and answerer [MUST]{.bcp14} follow the SDP offer/answer
> procedures defined in RFC 8842.[¶](#section-9.2.2-3.9){.pilcrow}
:::

::: {#section-9.2.3 .section}
#### [9.2.3.](#section-9.2.3){.section-number .selfRef} [Update to Section 6.6](#name-update-to-section-66){.section-name .selfRef} {#name-update-to-section-66}

The text in \[[RFC5763](#RFC5763){.xref}\], [Section
6.6](https://www.rfc-editor.org/rfc/rfc5763#section-6.6){.relref}
(\"Session Modification\") is modified by replacing generic SDP
offer/answer procedures for DTLS with a reference to this
specification:[¶](#section-9.2.3-1){.pilcrow}

NEW TEXT:[¶](#section-9.2.3-2){.pilcrow}

> Once an answer is provided to the offerer, either endpoint
> [MAY]{.bcp14} request a session modification that [MAY]{.bcp14}
> include an updated offer. This session modification can be carried in
> either an INVITE or UPDATE request. The peers can reuse an existing
> DTLS association or establish a new one, following the procedures in
> RFC 8842.[¶](#section-9.2.3-3.1){.pilcrow}
:::

::: {#section-9.2.4 .section}
#### [9.2.4.](#section-9.2.4){.section-number .selfRef} [Update to Section 6.7.1](#name-update-to-section-671){.section-name .selfRef} {#name-update-to-section-671}

The text in \[[RFC5763](#RFC5763){.xref}\], [Section
6.7.1](https://www.rfc-editor.org/rfc/rfc5763#section-6.7.1){.relref}
(\"ICE Interaction\") is modified by replacing the ICE procedures with a
reference to this specification:[¶](#section-9.2.4-1){.pilcrow}

NEW TEXT:[¶](#section-9.2.4-2){.pilcrow}

> The Interactive Connectivity Establishment (ICE)
> \[[RFC8445](#RFC8445){.xref}\] considerations for DTLS-protected media
> are described in RFC 8842.[¶](#section-9.2.4-3){.pilcrow}
:::
:::

::: {#section-9.3 .section}
### [9.3.](#section-9.3){.section-number .selfRef} [Update to RFC 7345](#name-update-to-rfc-7345){.section-name .selfRef} {#name-update-to-rfc-7345}

::: {#section-9.3.1 .section}
#### [9.3.1.](#section-9.3.1){.section-number .selfRef} [Update to Section 4](#name-update-to-section-4){.section-name .selfRef} {#name-update-to-section-4}

The subsections (4.1 - 4.5) in \[[RFC7345](#RFC7345){.xref}\], [Section
4](https://www.rfc-editor.org/rfc/rfc7345#section-4){.relref} (\"SDP
Offerer/Answerer Procedures\") are removed and replaced with the new
text below:[¶](#section-9.3.1-1){.pilcrow}

NEW TEXT:[¶](#section-9.3.1-2){.pilcrow}

> An endpoint (i.e., both the offerer and the answerer) [MUST]{.bcp14}
> create an SDP media description (\"m=\" line) for each UDPTL-over-DTLS
> media stream and [MUST]{.bcp14} assign a UDP/TLS/UDPTL value (see
> Table 1) to the \"proto\" field of the \"m=\"
> line.[¶](#section-9.3.1-3.1){.pilcrow}
>
> The offerer and answerer [MUST]{.bcp14} follow the SDP offer/answer
> procedures defined in RFC 8842 in order to negotiate the DTLS
> association associated with the UDPTL-over-DTLS media stream. In
> addition, the offerer and answerer [MUST]{.bcp14} use the SDP
> attributes defined for UDPTL over UDP, as defined in
> \[[ITU.T38](#ITU.T38){.xref}\].[¶](#section-9.3.1-3.2){.pilcrow}
:::

::: {#section-9.3.2 .section}
#### [9.3.2.](#section-9.3.2){.section-number .selfRef} [Update to Section 5.2.1](#name-update-to-section-521){.section-name .selfRef} {#name-update-to-section-521}

The text in \[[RFC7345](#RFC7345){.xref}\], [Section
5.2.1](https://www.rfc-editor.org/rfc/rfc7345#section-5.2.1){.relref}
(\"ICE Usage\") is modified by replacing the ICE procedures with a
reference to this specification:[¶](#section-9.3.2-1){.pilcrow}

NEW TEXT:[¶](#section-9.3.2-2){.pilcrow}

> The Interactive Connectivity Establishment (ICE)
> \[[RFC8445](#RFC8445){.xref}\] considerations for DTLS-protected media
> are described in RFC 8842.[¶](#section-9.3.2-3){.pilcrow}
:::

::: {#section-9.3.3 .section}
#### [9.3.3.](#section-9.3.3){.section-number .selfRef} [Update to Section 9.1](#name-update-to-section-91){.section-name .selfRef} {#name-update-to-section-91}

A reference to \[[RFC8122](#RFC8122){.xref}\] is added to
\[[RFC7345](#RFC7345){.xref}\], [Section
9.1](https://www.rfc-editor.org/rfc/rfc7345#section-9.1){.relref}
(\"Normative References\"):[¶](#section-9.3.3-1){.pilcrow}

NEW TEXT:[¶](#section-9.3.3-2){.pilcrow}

> []{.break}
>
> \[RFC8122\]
> :   Lennox, J. and C. Holmberg, \"Connection-Oriented Media Transport
>     over the Transport Layer Security (TLS) Protocol in the Session
>     Description Protocol (SDP)\", RFC 8122, DOI 10.17487/RFC8122,
>     March 2017,
>     \<<https://www.rfc-editor.org/info/rfc8122>\>.[¶](#section-9.3.3-3.1.2){.pilcrow}
> :   
:::
:::
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This specification does not modify the security considerations
associated with DTLS or the SDP offer/answer mechanism. In addition to
the introduction of the SDP \"tls-id\" attribute, this document simply
clarifies the procedures for negotiating and establishing a DTLS
association.[¶](#section-10-1){.pilcrow}

This specification does not modify the actual TLS connection setup
procedures. The SDP \"tls-is\" attribute as such cannot be used to
correlate an SDP offer/answer exchange with a TLS connection setup.
Thus, this document does not introduce new security considerations
related to correlating an SDP offer/answer exchange with a TLS
connection setup.[¶](#section-10-2){.pilcrow}
:::

::: {#section.iana}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document updates the \"Session Description Protocol Parameters\"
registry as specified in [Section
8.2.2](https://www.rfc-editor.org/rfc/rfc4566#section-8.2.2){.relref} of
\[[RFC4566](#RFC4566){.xref}\]. Specifically, it adds the SDP \"tls-id\"
attribute to the table for SDP media-level attributes as
follows.[¶](#section-11-1){.pilcrow}

[]{.break}

Attribute name:
:   tls-id[¶](#section-11-2.2){.pilcrow}
:   

Type of attribute:
:   Media-level[¶](#section-11-2.4){.pilcrow}
:   

Subject to charset:
:   No[¶](#section-11-2.6){.pilcrow}
:   

Purpose:
:   Indicates whether a new DTLS association or TLS connection is to be
    established/re-established.[¶](#section-11-2.8){.pilcrow}
:   

Appropriate Values:
:   See [Section
    4](#sec-dcon-attr){.xref}[¶](#section-11-2.10){.pilcrow}
:   

Contact name:
:   Christer Holmberg[¶](#section-11-2.12){.pilcrow}
:   

Mux Category:
:   IDENTICAL[¶](#section-11-2.14){.pilcrow}
:   
:::
:::

::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-12.1 .section}
### [12.1.](#section-12.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3261\]
:   [Rosenberg, J.]{.refAuthor}[, Schulzrinne, H.]{.refAuthor}[,
    Camarillo, G.]{.refAuthor}[, Johnston, A.]{.refAuthor}[,
    Peterson, J.]{.refAuthor}[, Sparks, R.]{.refAuthor}[,
    Handley, M.]{.refAuthor}[, and E. Schooler]{.refAuthor}, [\"SIP:
    Session Initiation Protocol\"]{.refTitle}, [RFC 3261]{.seriesInfo},
    [DOI 10.17487/RFC3261]{.seriesInfo}, June 2002,
    \<<https://www.rfc-editor.org/info/rfc3261>\>.
:   

\[RFC3264\]
:   [Rosenberg, J.]{.refAuthor}[ and H. Schulzrinne]{.refAuthor}, [\"An
    Offer/Answer Model with Session Description Protocol
    (SDP)\"]{.refTitle}, [RFC 3264]{.seriesInfo}, [DOI
    10.17487/RFC3264]{.seriesInfo}, June 2002,
    \<<https://www.rfc-editor.org/info/rfc3264>\>.
:   

\[RFC4145\]
:   [Yon, D.]{.refAuthor}[ and G. Camarillo]{.refAuthor}, [\"TCP-Based
    Media Transport in the Session Description Protocol
    (SDP)\"]{.refTitle}, [RFC 4145]{.seriesInfo}, [DOI
    10.17487/RFC4145]{.seriesInfo}, September 2005,
    \<<https://www.rfc-editor.org/info/rfc4145>\>.
:   

\[RFC4566\]
:   [Handley, M.]{.refAuthor}[, Jacobson, V.]{.refAuthor}[, and C.
    Perkins]{.refAuthor}, [\"SDP: Session Description
    Protocol\"]{.refTitle}, [RFC 4566]{.seriesInfo}, [DOI
    10.17487/RFC4566]{.seriesInfo}, July 2006,
    \<<https://www.rfc-editor.org/info/rfc4566>\>.
:   

\[RFC5763\]
:   [Fischl, J.]{.refAuthor}[, Tschofenig, H.]{.refAuthor}[, and E.
    Rescorla]{.refAuthor}, [\"Framework for Establishing a Secure
    Real-time Transport Protocol (SRTP) Security Context Using Datagram
    Transport Layer Security (DTLS)\"]{.refTitle}, [RFC
    5763]{.seriesInfo}, [DOI 10.17487/RFC5763]{.seriesInfo}, May 2010,
    \<<https://www.rfc-editor.org/info/rfc5763>\>.
:   

\[RFC6347\]
:   [Rescorla, E.]{.refAuthor}[ and N. Modadugu]{.refAuthor},
    [\"Datagram Transport Layer Security Version 1.2\"]{.refTitle}, [RFC
    6347]{.seriesInfo}, [DOI 10.17487/RFC6347]{.seriesInfo}, January
    2012, \<<https://www.rfc-editor.org/info/rfc6347>\>.
:   

\[RFC7345\]
:   [Holmberg, C.]{.refAuthor}[, Sedlacek, I.]{.refAuthor}[, and G.
    Salgueiro]{.refAuthor}, [\"UDP Transport Layer (UDPTL) over Datagram
    Transport Layer Security (DTLS)\"]{.refTitle}, [RFC
    7345]{.seriesInfo}, [DOI 10.17487/RFC7345]{.seriesInfo}, August
    2014, \<<https://www.rfc-editor.org/info/rfc7345>\>.
:   

\[RFC8122\]
:   [Lennox, J.]{.refAuthor}[ and C. Holmberg]{.refAuthor},
    [\"Connection-Oriented Media Transport over the Transport Layer
    Security (TLS) Protocol in the Session Description Protocol
    (SDP)\"]{.refTitle}, [RFC 8122]{.seriesInfo}, [DOI
    10.17487/RFC8122]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8122>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8445\]
:   [Keranen, A.]{.refAuthor}[, Holmberg, C.]{.refAuthor}[, and J.
    Rosenberg]{.refAuthor}, [\"Interactive Connectivity Establishment
    (ICE): A Protocol for Network Address Translator (NAT)
    Traversal\"]{.refTitle}, [RFC 8445]{.seriesInfo}, [DOI
    10.17487/RFC8445]{.seriesInfo}, July 2018,
    \<<https://www.rfc-editor.org/info/rfc8445>\>.
:   

\[RFC8843\]
:   [Holmberg, C.]{.refAuthor}[, Alvestrand, H.]{.refAuthor}[, and C.
    Jennings]{.refAuthor}, [\"Negotiating Media Multiplexing Using the
    Session Description Protocol (SDP)\"]{.refTitle}, [RFC
    8843]{.seriesInfo}, [DOI 10.17487/RFC8843]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8843>\>.
:   

\[RFC8859\]
:   [Nandakumar, S.]{.refAuthor}, [\"A Framework for Session Description
    Protocol (SDP) Attributes When Multiplexing\"]{.refTitle}, [RFC
    8859]{.seriesInfo}, [DOI 10.17487/RFC8859]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8859>\>.
:   
:::

::: {#section-12.2 .section}
### [12.2.](#section-12.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ITU.T38\]
:   [ITU-T]{.refAuthor}, [\"Procedures for real-time Group 3 facsimile
    communication over IP networks\"]{.refTitle}, [Recommendation
    T.38]{.seriesInfo}, September 2010,
    \<<https://www.itu.int/rec/T-REC-T.38/en>\>.
:   

\[RFC4474\]
:   [Peterson, J.]{.refAuthor}[ and C. Jennings]{.refAuthor},
    [\"Enhancements for Authenticated Identity Management in the Session
    Initiation Protocol (SIP)\"]{.refTitle}, [RFC 4474]{.seriesInfo},
    [DOI 10.17487/RFC4474]{.seriesInfo}, August 2006,
    \<<https://www.rfc-editor.org/info/rfc4474>\>.
:   

\[RFC4572\]
:   [Lennox, J.]{.refAuthor}, [\"Connection-Oriented Media Transport
    over the Transport Layer Security (TLS) Protocol in the Session
    Description Protocol (SDP)\"]{.refTitle}, [RFC 4572]{.seriesInfo},
    [DOI 10.17487/RFC4572]{.seriesInfo}, July 2006,
    \<<https://www.rfc-editor.org/info/rfc4572>\>.
:   

\[RFC5576\]
:   [Lennox, J.]{.refAuthor}[, Ott, J.]{.refAuthor}[, and T.
    Schierl]{.refAuthor}, [\"Source-Specific Media Attributes in the
    Session Description Protocol (SDP)\"]{.refTitle}, [RFC
    5576]{.seriesInfo}, [DOI 10.17487/RFC5576]{.seriesInfo}, June 2009,
    \<<https://www.rfc-editor.org/info/rfc5576>\>.
:   

\[RFC6083\]
:   [Tuexen, M.]{.refAuthor}[, Seggelmann, R.]{.refAuthor}[, and E.
    Rescorla]{.refAuthor}, [\"Datagram Transport Layer Security (DTLS)
    for Stream Control Transmission Protocol (SCTP)\"]{.refTitle}, [RFC
    6083]{.seriesInfo}, [DOI 10.17487/RFC6083]{.seriesInfo}, January
    2011, \<<https://www.rfc-editor.org/info/rfc6083>\>.
:   

\[RFC7983\]
:   [Petit-Huguenin, M.]{.refAuthor}[ and G. Salgueiro]{.refAuthor},
    [\"Multiplexing Scheme Updates for Secure Real-time Transport
    Protocol (SRTP) Extension for Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [RFC 7983]{.seriesInfo}, [DOI
    10.17487/RFC7983]{.seriesInfo}, September 2016,
    \<<https://www.rfc-editor.org/info/rfc7983>\>.
:   

\[RFC8224\]
:   [Peterson, J.]{.refAuthor}[, Jennings, C.]{.refAuthor}[,
    Rescorla, E.]{.refAuthor}[, and C. Wendt]{.refAuthor},
    [\"Authenticated Identity Management in the Session Initiation
    Protocol (SIP)\"]{.refTitle}, [RFC 8224]{.seriesInfo}, [DOI
    10.17487/RFC8224]{.seriesInfo}, February 2018,
    \<<https://www.rfc-editor.org/info/rfc8224>\>.
:   

\[RFC8839\]
:   [Petit-Huguenin, M.]{.refAuthor}[, Nandakumar, S.]{.refAuthor}[,
    Holmberg, C.]{.refAuthor}[, Keränen, A.]{.refAuthor}[, and R.
    Shpount]{.refAuthor}, [\"Session Description Protocol (SDP)
    Offer/Answer Procedures for Interactive Connectivity Establishment
    (ICE)\"]{.refTitle}, [RFC 8839]{.seriesInfo}, [DOI
    10.17487/RFC8839]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8839>\>.
:   

\[RFC8844\]
:   [Thomson, M.]{.refAuthor}[ and E. Rescorla]{.refAuthor}, [\"Unknown
    Key-Share Attacks on Uses of TLS with the Session Description
    Protocol (SDP)\"]{.refTitle}, [RFC 8844]{.seriesInfo}, [DOI
    10.17487/RFC8844]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8844>\>.
:   
:::
:::

::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to [Justin Uberti]{.contact-name}, [Martin
Thomson]{.contact-name}, [Paul Kyzivat]{.contact-name}, [Jens
Guballa]{.contact-name}, [Charles Eckel]{.contact-name}, [Gonzalo
Salgueiro]{.contact-name}, and [Paul Jones]{.contact-name} for providing
comments and suggestions on the document. [Ben Campbell]{.contact-name}
performed an Area Director review. [Paul Kyzivat]{.contact-name}
performed a Gen-ART review.[¶](#section-appendix.a-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Christer Holmberg]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
[Hirsalantie 11]{.street-address}
:::

::: {.left dir="auto"}
FI-[02420]{.postal-code} [Jorvas]{.locality}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <christer.holmberg@ericsson.com>
:::

::: {.left dir="auto"}
[Roman Shpount]{.fn .nameRole}
:::

::: {.left dir="auto"}
[TurboBridge]{.org}
:::

::: {.left dir="auto"}
[4905 Del Ray Avenue, Suite 300]{.street-address}
:::

::: {.left dir="auto"}
[Bethesda]{.locality}, [MD]{.region} [20814]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <rshpount@turbobridge.com>
:::
:::
:::
