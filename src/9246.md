  RFC 9246                  CDNI URI Signing   June 2022
  ------------------------- ------------------ -----------
  van Brandenburg, et al.   Standards Track    \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9246](https://www.rfc-editor.org/rfc/rfc9246){.eref}

Category:
:   Standards Track

Published:
:   June 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    R. van Brandenburg
    :::

    ::: org
    Tiledmedia
    :::
    :::

    ::: author
    ::: author-name
    K. Leung
    :::
    :::

    ::: author
    ::: author-name
    P. Sorber
    :::

    ::: org
    Apple, Inc.
    :::
    :::
:::

# RFC 9246 {#rfcnum}

# URI Signing for Content Delivery Network Interconnection (CDNI) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes how the concept of URI Signing supports the
content access control requirements of Content Delivery Network
Interconnection (CDNI) and proposes a URI Signing method as a JSON Web
Token (JWT) profile.[¶](#section-abstract-1){.pilcrow}

The proposed URI Signing method specifies the information needed to be
included in the URI to transmit the signed JWT, as well as the claims
needed by the signed JWT to authorize a User Agent (UA). The mechanism
described can be used both in CDNI and single Content Delivery Network
(CDN) scenarios.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9246>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Terminology](#name-terminology){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Background and Overview on URI
        Signing](#name-background-and-overview-on-){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.3}
        [1.3](#section-1.3){.xref}.  [CDNI URI Signing
        Overview](#name-cdni-uri-signing-overview){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.4}
        [1.4](#section-1.4){.xref}.  [URI Signing in a Non-CDNI
        Context](#name-uri-signing-in-a-non-cdni-c){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [JWT Format and Processing
    Requirements](#name-jwt-format-and-processing-r){.xref}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [JWT
        Claims](#name-jwt-claims){.xref}

        -   ::: {#section-toc.1-1.2.2.1.2.1}
            [2.1.1](#section-2.1.1){.xref}.  [Issuer (iss)
            Claim](#name-issuer-iss-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.2}
            [2.1.2](#section-2.1.2){.xref}.  [Subject (sub)
            Claim](#name-subject-sub-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.3}
            [2.1.3](#section-2.1.3){.xref}.  [Audience (aud)
            Claim](#name-audience-aud-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.4}
            [2.1.4](#section-2.1.4){.xref}.  [Expiry Time (exp)
            Claim](#name-expiry-time-exp-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.5}
            [2.1.5](#section-2.1.5){.xref}.  [Not Before (nbf)
            Claim](#name-not-before-nbf-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.6}
            [2.1.6](#section-2.1.6){.xref}.  [Issued At (iat)
            Claim](#name-issued-at-iat-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.7}
            [2.1.7](#section-2.1.7){.xref}.  [JWT ID (jti)
            Claim](#name-jwt-id-jti-claim){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.8}
            [2.1.8](#section-2.1.8){.xref}.  [CDNI Claim Set Version
            (cdniv) Claim](#name-cdni-claim-set-version-cdni){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.9}
            [2.1.9](#section-2.1.9){.xref}.  [CDNI Critical Claims Set
            (cdnicrit) Claim](#name-cdni-critical-claims-set-cd){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.10}
            [2.1.10](#section-2.1.10){.xref}. [Client IP Address
            (cdniip) Claim](#name-client-ip-address-cdniip-cl){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.11}
            [2.1.11](#section-2.1.11){.xref}. [CDNI URI Container
            (cdniuc) Claim](#name-cdni-uri-container-cdniuc-c){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.12}
            [2.1.12](#section-2.1.12){.xref}. [CDNI Expiration Time
            Setting (cdniets)
            Claim](#name-cdni-expiration-time-settin){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.13}
            [2.1.13](#section-2.1.13){.xref}. [CDNI Signed Token
            Transport (cdnistt)
            Claim](#name-cdni-signed-token-transport){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.14}
            [2.1.14](#section-2.1.14){.xref}. [CDNI Signed Token Depth
            (cdnistd) Claim](#name-cdni-signed-token-depth-cdn){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.15}
            [2.1.15](#section-2.1.15){.xref}. [URI Container
            Forms](#name-uri-container-forms){.xref}

            -   ::: {#section-toc.1-1.2.2.1.2.15.2.1}
                [2.1.15.1](#section-2.1.15.1){.xref}.  [URI Hash
                Container (hash:)](#name-uri-hash-container-hash){.xref}
                :::

            -   ::: {#section-toc.1-1.2.2.1.2.15.2.2}
                [2.1.15.2](#section-2.1.15.2){.xref}.  [URI Regular
                Expression Container
                (regex:)](#name-uri-regular-expression-cont){.xref}
                :::
            :::
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [JWT
        Header](#name-jwt-header){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [URI Signing Token
    Renewal](#name-uri-signing-token-renewal){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Overview](#name-overview){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Signed Token Renewal
        Mechanism](#name-signed-token-renewal-mechan){.xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [Required
            Claims](#name-required-claims){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Communicating a Signed JWT in
        Signed Token Renewal](#name-communicating-a-signed-jwt-){.xref}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [Support for Cross-Domain
            Redirection](#name-support-for-cross-domain-re){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Relationship with CDNI
    Interfaces](#name-relationship-with-cdni-inte){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [CDNI Control
        Interface](#name-cdni-control-interface){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [CDNI Footprint & Capabilities
        Advertisement
        Interface](#name-cdni-footprint-capabilities){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [CDNI Request Routing Redirection
        Interface](#name-cdni-request-routing-redire){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [CDNI Metadata
        Interface](#name-cdni-metadata-interface){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [CDNI Logging
        Interface](#name-cdni-logging-interface){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [URI Signing Message
    Flow](#name-uri-signing-message-flow){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [HTTP
        Redirection](#name-http-redirection){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [DNS
        Redirection](#name-dns-redirection){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [CDNI Payload
        Type](#name-cdni-payload-type){.xref}

        -   ::: {#section-toc.1-1.6.2.1.2.1}
            [6.1.1](#section-6.1.1){.xref}.  [CDNI UriSigning Payload
            Type](#name-cdni-urisigning-payload-typ){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [CDNI Logging Record
        Type](#name-cdni-logging-record-type){.xref}

        -   ::: {#section-toc.1-1.6.2.2.2.1}
            [6.2.1](#section-6.2.1){.xref}.  [CDNI Logging Record
            Version 2 for
            HTTP](#name-cdni-logging-record-version){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [CDNI Logging Field
        Names](#name-cdni-logging-field-names){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [CDNI URI Signing Verification
        Code](#name-cdni-uri-signing-verificati){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [CDNI URI Signing Signed Token
        Transport](#name-cdni-uri-signing-signed-tok){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.6}
        [6.6](#section-6.6){.xref}.  [JSON Web Token Claims
        Registration](#name-json-web-token-claims-regis){.xref}

        -   ::: {#section-toc.1-1.6.2.6.2.1}
            [6.6.1](#section-6.6.1){.xref}.  [Registry
            Contents](#name-registry-contents){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.7}
        [6.7](#section-6.7){.xref}.  [Expert Review
        Guidance](#name-expert-review-guidance){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Privacy](#name-privacy){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix A](#appendix-A){.xref}.  [Signed URI Package
    Example](#name-signed-uri-package-example){.xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [A.1](#appendix-A.1){.xref}.  [Simple
        Example](#name-simple-example){.xref}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [A.2](#appendix-A.2){.xref}.  [Complex
        Example](#name-complex-example){.xref}
        :::

    -   ::: {#section-toc.1-1.10.2.3}
        [A.3](#appendix-A.3){.xref}.  [Signed Token Renewal
        Example](#name-signed-token-renewal-exampl){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-B){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [](#appendix-C){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [](#appendix-D){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document describes the concept of URI Signing and how it can be
used to provide access authorization in the case of redirection between
cooperating CDNs and between a Content Service Provider (CSP) and a CDN.
The primary goal of URI Signing is to make sure that only authorized UAs
are able to access the content, with a CSP being able to authorize every
individual request. It should be noted that URI Signing is not a content
protection scheme; if a CSP wants to protect the content itself, other
mechanisms, such as Digital Rights Management (DRM), are more
appropriate. In addition to access control, URI Signing also has
benefits in reducing the impact of denial-of-service
attacks.[¶](#section-1-1){.pilcrow}

The overall problem space for CDN Interconnection (CDNI) is described in
the CDNI Problem Statement \[[RFC6707](#RFC6707){.xref}\] specification.
This document, along with the [Content Distribution Network
Interconnection (CDNI) Requirements](#RFC7337){.xref}
\[[RFC7337](#RFC7337){.xref}\] document and the [Framework for Content
Distribution Network Interconnection (CDNI)](#RFC7336){.xref}
\[[RFC7336](#RFC7336){.xref}\], describes the need for interconnected
CDNs to be able to implement an access control mechanism that enforces a
CSP\'s distribution policies.[¶](#section-1-2){.pilcrow}

Specifically, the [CDNI Framework](#RFC7336){.xref}
\[[RFC7336](#RFC7336){.xref}\] states:[¶](#section-1-3){.pilcrow}

-   [The CSP may also trust the CDN operator to perform actions such as
    delegating traffic to additional downstream CDNs, and to enforce
    per-request authorization performed by the CSP using techniques such
    as URI Signing.[¶](#section-1-4.1){.pilcrow}]{#section-1-4.1}

In particular, the following requirement is listed in the [CDNI
Requirements](#RFC7337){.xref}
\[[RFC7337](#RFC7337){.xref}\]:[¶](#section-1-5){.pilcrow}

-   ::: {#section-1-6.1}
    > []{.break}
    >
    > MI-16
    > :   {HIGH} The CDNI Metadata interface shall allow signaling of
    >     authorization checks and validation that are to be performed
    >     by the Surrogate before delivery. For example, this could
    >     potentially include the need to validate information (e.g.,
    >     Expiry time, Client IP address) required for access
    >     authorization.[¶](#section-1-6.1.1.1.2){.pilcrow}
    > :   
    :::

This document defines a method of signing URIs that allows Surrogates in
interconnected CDNs to enforce a per-request authorization initiated by
the CSP. Splitting the role of initiating per-request authorization by
the CSP and the role of verifying this authorization by the CDN allows
any arbitrary distribution policy to be enforced across CDNs without the
need of CDNs to have any awareness of the specific CSP distribution
policies.[¶](#section-1-7){.pilcrow}

The method is implemented using signed JSON Web Tokens (JWTs)
\[[RFC7519](#RFC7519){.xref}\].[¶](#section-1-8){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}

This document uses the terminology defined in the [CDNI Problem
Statement](#RFC6707){.xref}
\[[RFC6707](#RFC6707){.xref}\].[¶](#section-1.1-2){.pilcrow}

This document also uses the terminology of the [JSON Web Token
(JWT)](#RFC7519){.xref}
\[[RFC7519](#RFC7519){.xref}\].[¶](#section-1.1-3){.pilcrow}

In addition, the following terms are used throughout this
document:[¶](#section-1.1-4){.pilcrow}

[]{.break}

FCI:
:   Footprint & Capabilities Advertisement
    interface[¶](#section-1.1-5.2){.pilcrow}
:   

Signed URI:
:   A URI for which a signed JWT is
    provided.[¶](#section-1.1-5.4){.pilcrow}
:   

Target CDN URI:
:   A URI created by the CSP to direct a UA towards the upstream CDN
    (uCDN). The Target CDN URI can be signed by the CSP and verified by
    the uCDN and possibly further downstream CDNs
    (dCDNs).[¶](#section-1.1-5.6){.pilcrow}
:   

Redirection URI:
:   A URI created by the uCDN to redirect a UA towards the dCDN. The
    Redirection URI can be signed by the uCDN and verified by the dCDN.
    In a cascaded CDNI scenario, there can be more than one Redirection
    URI.[¶](#section-1.1-5.8){.pilcrow}
:   

Signed Token Renewal:
:   A series of signed JWTs that are used for subsequent access to a set
    of related resources in a CDN, such as a set of HTTP Adaptive
    Streaming files. Every time a signed JWT is used to access a
    particular resource, a new signed JWT is sent along with the
    resource that can be used to request the next resource in the set.
    When generating a new signed JWT in Signed Token Renewal, parameters
    are carried over from one signed JWT to the
    next.[¶](#section-1.1-5.10){.pilcrow}
:   
:::

::: {#background}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Background and Overview on URI Signing](#name-background-and-overview-on-){.section-name .selfRef} {#name-background-and-overview-on-}

A CSP and CDN are assumed to have a trust relationship that enables the
CSP to authorize access to a content item, which is realized in practice
by including a set of claims in a signed JWT in the URI before
redirecting a UA to the CDN. Using these attributes, it is possible for
a CDN to check an incoming content request to see whether it was
authorized by the CSP (e.g., based on a time window or pattern matching
the URI). To prevent the UA from altering the claims, the JWT
[MUST]{.bcp14} be signed.[¶](#section-1.2-1){.pilcrow}

[Figure 1](#fig_single_cdn){.xref} presents an overview of the URI
Signing mechanism in the case of a CSP with a single CDN. When the UA
browses for content on CSP\'s website (1), it receives HTML web pages
with embedded content URIs. Upon requesting these URIs, the CSP
redirects to a CDN, creating a Target CDN URI (2) (alternatively, the
Target CDN URI itself is embedded in the HTML). The Target CDN URI is
the Signed URI, which may include the IP address of the UA and/or a time
window. The Signed URI always contains a signed JWT generated by the CSP
using a shared secret or private key. Once the UA receives the response
with the Signed URI, it sends a new HTTP request using the Signed URI to
the CDN (3). Upon receiving the request, the CDN authenticates the
Signed URI by verifying the signed JWT. If applicable, the CDN checks
whether the time window is still valid in the Signed URI and the pattern
matches the URI of the request. After these claims are verified, the CDN
delivers the content (4).[¶](#section-1.2-2){.pilcrow}

Note: While using a symmetric shared key is supported, it is [NOT
RECOMMENDED]{.bcp14}. See the [Security
Considerations](#security){.xref} ([Section 7](#security){.xref}) about
the limitations of shared keys.[¶](#section-1.2-3){.pilcrow}

[]{#name-uri-signing-in-a-cdn-enviro}

::: {#fig_single_cdn}
::: {#section-1.2-4.1 .alignLeft .art-text .artwork}
                    --------
                   /        \
                   |   CSP  |< * * * * * * * * * * *
                   \        /        Trust         *
                    --------      relationship     *
                      ^  |                         *
                      |  |                         *
           1. Browse  |  | 2. Signed               *
                for   |  |    URI                  *
              content |  |                         *
                      |  v                         v
                    +------+ 3. Signed URI     --------
                    | User |----------------->/        \
                    | Agent|                  |  CDN   |
                    |      |<-----------------\        /
                    +------+ 4. Content        --------
                                Delivery
:::

[Figure 1](#figure-1){.selfRef}: [URI Signing in a CDN
Environment](#name-uri-signing-in-a-cdn-enviro){.selfRef}
:::
:::
:::

::: {#section-1.3 .section}
### [1.3.](#section-1.3){.section-number .selfRef} [CDNI URI Signing Overview](#name-cdni-uri-signing-overview){.section-name .selfRef} {#name-cdni-uri-signing-overview}

In a CDNI environment, as shown in [Figure 2](#fig_cdni_env){.xref}
below, URI Signing operates the same way in the initial steps 1 and 2,
but the later steps involve multiple CDNs delivering the content. The
main difference from the single CDN case is a redirection step between
the uCDN and the dCDN. In step 3, the UA may send an HTTP request or a
DNS request, depending on whether HTTP-based or DNS-based request
routing is used. The uCDN responds by directing the UA towards the dCDN
using either a Redirection URI (i.e., a Signed URI generated by the
uCDN) or a DNS reply, respectively (4). Once the UA receives the
response, it sends the Redirection URI/Target CDN URI to the dCDN (5).
The received URI is verified by the dCDN before delivering the content
(6).[¶](#section-1.3-1){.pilcrow}

Note: The CDNI call flows are covered in [URI Signing Message
Flow](#operation){.xref} ([Section
5](#operation){.xref}).[¶](#section-1.3-2){.pilcrow}

[]{#name-uri-signing-in-a-cdni-envir}

::: {#fig_cdni_env}
::: {#section-1.3-3.1 .alignLeft .art-text .artwork}
                                       +-------------------------+
                                       |Request Redirection Modes|
                                       +-------------------------+
                                       | a) HTTP                 |
                                       | b) DNS                  |
                                       +-------------------------+
                    --------
                   /        \< * * * * * * * * * * * * * *
                   |   CSP  |< * * * * * * * * * * *     *
                   \        /        Trust         *     *
                    --------      relationship     *     *
                      ^  |                         *     *
                      |  | 2. Signed               *     *
           1. Browse  |  |    URI in               *     *
                for   |  |    HTML                 *     *
              content |  |                         *     *
                      |  v   3.a)Signed URI        v     *
                    +------+   b)DNS request   --------  * Trust
                    | User |----------------->/        \ * relationship
                    | Agent|                  |  uCDN  | * (optional)
                    |      |<-----------------\        / *
                    +------+ 4.a)Redirection URI-------  *
                      ^  |     b)DNS Reply         ^     *
                      |  |                         *     *
                      |  |      Trust relationship *     *
                      |  |                         *     *
          6. Content  |  | 5.a)Redirection URI     *     *
             delivery |  |   b)Signed URI(after    v     v
                      |  |     DNS exchange)      --------
                      |  +---------------------->/        \ [May be
                      |                          |  dCDN  |  cascaded
                      +--------------------------\        /  CDNs]
                                                  --------
:::

[Figure 2](#figure-2){.selfRef}: [URI Signing in a CDNI
Environment](#name-uri-signing-in-a-cdni-envir){.selfRef}
:::

The trust relationships between CSP, uCDN, and dCDN have direct
implications for URI Signing. In the case shown in [Figure
2](#fig_cdni_env){.xref}, the CSP has a trust relationship with the
uCDN. The delivery of the content may be delegated to a dCDN, which has
a relationship with the uCDN but may have no relationship with the
CSP.[¶](#section-1.3-4){.pilcrow}

In CDNI, there are two methods for request routing: DNS-based and
HTTP-based. For DNS-based request routing, the Signed URI (i.e., the
Target CDN URI) provided by the CSP reaches the CDN directly. In the
case where the dCDN does not have a trust relationship with the CSP,
this means that either an asymmetric public/private key method needs to
be used for computing the signed JWT (because the CSP and dCDN are not
able to exchange symmetric shared secret keys). Shared keys [MUST
NOT]{.bcp14} be redistributed.[¶](#section-1.3-5){.pilcrow}

For HTTP-based request routing, the Signed URI (i.e., the Target CDN
URI) provided by the CSP reaches the uCDN. After this URI has been
verified by the uCDN, the uCDN creates and signs a new Redirection URI,
redirecting the UA to the dCDN. Since this new URI can have a new signed
JWT, the relationship between the dCDN and CSP is not relevant. Because
a relationship between uCDN and dCDN always exists, either asymmetric
public/private keys or symmetric shared secret keys can be used for URI
Signing with HTTP-based request routing. Note that the signed
Redirection URI [MUST]{.bcp14} maintain HTTPS as the scheme if it was
present in the original, and it [MAY]{.bcp14} be upgraded from \"http:\"
to \"https:\".[¶](#section-1.3-6){.pilcrow}

Two types of keys can be used for URI Signing: asymmetric keys and
symmetric shared keys. Asymmetric keys are based on a public/private key
pair mechanism and always contain a private key known only to the entity
signing the URI (either CSP or uCDN) and a public key for the
verification of the Signed URI. With symmetric keys, the same key is
used by both the signing entity for signing the URI and the verifying
entity for verifying the Signed URI. Regardless of the type of keys
used, the verifying entity has to obtain the key in a manner that allows
trust to be placed in the assertions made using that key (either the
public or the symmetric key). There are very different requirements
(outside the scope of this document) for distributing asymmetric keys
and symmetric keys. Key distribution for symmetric keys requires
confidentiality to prevent third parties from getting access to the key,
since they could then generate valid Signed URIs for unauthorized
requests. Key distribution for asymmetric keys does not require
confidentiality since public keys can typically be distributed openly
(because they cannot be used to sign URIs) and the corresponding private
keys are kept secret by the URI signer.[¶](#section-1.3-7){.pilcrow}

Note: While using a symmetric shared key is supported, it is [NOT
RECOMMENDED]{.bcp14}. See the [Security
Considerations](#security){.xref} ([Section 7](#security){.xref}) about
the limitations of shared keys.[¶](#section-1.3-8){.pilcrow}
:::

::: {#section-1.4 .section}
### [1.4.](#section-1.4){.section-number .selfRef} [URI Signing in a Non-CDNI Context](#name-uri-signing-in-a-non-cdni-c){.section-name .selfRef} {#name-uri-signing-in-a-non-cdni-c}

While the URI Signing method defined in this document was primarily
created for the purpose of allowing URI Signing in CDNI scenarios, i.e.,
between a uCDN and a dCDN, there is nothing in the defined URI Signing
method that precludes it from being used in a non-CDNI context. As such,
the described mechanism could be used in a single-CDN scenario such as
shown in [Figure 1](#fig_single_cdn){.xref} in [Section
1.2](#background){.xref} for example to allow a CSP that uses different
CDNs to only have to implement a single URI Signing
mechanism.[¶](#section-1.4-1){.pilcrow}
:::
:::

::: {#jwt_profile}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [JWT Format and Processing Requirements](#name-jwt-format-and-processing-r){.section-name .selfRef} {#name-jwt-format-and-processing-r}

The concept behind URI Signing is based on embedding a signed [JSON Web
Token (JWT)](#RFC7519){.xref} \[[RFC7519](#RFC7519){.xref}\] in an [HTTP
or HTTPS URI](#RFC7230){.xref} \[[RFC7230](#RFC7230){.xref}\] (see
[Section
2.7](https://www.rfc-editor.org/rfc/rfc7230#section-2.7){.relref} of
\[[RFC7230](#RFC7230){.xref}\]). The signed JWT contains a number of
claims that can be verified to ensure the UA has legitimate access to
the content.[¶](#section-2-1){.pilcrow}

This document specifies the following attribute for embedding a signed
JWT in a Target CDN URI or Redirection URI:[¶](#section-2-2){.pilcrow}

[]{.break}

URI Signing Package (URISigningPackage):
:   The URI attribute that encapsulates all the URI Signing claims in a
    signed JWT encoded format. This attribute is exposed in the Signed
    URI as a path-style parameter or a form-style
    parameter.[¶](#section-2-3.2){.pilcrow}
:   

The parameter name of the URI Signing Package Attribute is defined in
the [CDNI Metadata](#metadata){.xref} ([Section 4.4](#metadata){.xref}).
If the CDNI Metadata interface is not used, or does not include a
parameter name for the URI Signing Package Attribute, the parameter name
can be set by configuration (out of scope of this
document).[¶](#section-2-4){.pilcrow}

The URI Signing Package will be found by parsing any path-style
parameters and form-style parameters looking for a key name matching the
URI Signing Package Attribute. Both parameter styles [MUST]{.bcp14} be
supported to allow flexibility of operation. The first matching
parameter [SHOULD]{.bcp14} be taken to provide the signed JWT, though
providing more than one matching key is undefined behavior. Path-style
parameters generated in the form indicated by [Section
3.2.7](https://www.rfc-editor.org/rfc/rfc6570#section-3.2.7){.relref} of
\[[RFC6570](#RFC6570){.xref}\] and Form-style parameters generated in
the form indicated by Sections
[3.2.8](https://www.rfc-editor.org/rfc/rfc6570#section-3.2.8){.relref}
and
[3.2.9](https://www.rfc-editor.org/rfc/rfc6570#section-3.2.9){.relref}
of \[[RFC6570](#RFC6570){.xref}\] [MUST]{.bcp14} be
supported.[¶](#section-2-5){.pilcrow}

The following is an example where the URI Signing Package Attribute name
is \"token\" and the signed JWT is
\"SIGNEDJWT\":[¶](#section-2-6){.pilcrow}

::: {#section-2-7}
``` sourcecode
http://example.com/media/path?come=data&token=SIGNEDJWT&other=data
```

[¶](#section-2-7){.pilcrow}
:::

::: {#jwt_claims}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [JWT Claims](#name-jwt-claims){.section-name .selfRef} {#name-jwt-claims}

This section identifies the set of claims that can be used to enforce
the CSP distribution policy. New claims can be introduced in the future
to extend the distribution policy
capabilities.[¶](#section-2.1-1){.pilcrow}

In order to provide distribution policy flexibility, the exact subset of
claims used in a given signed JWT is a runtime decision. Claim
requirements are defined in the [CDNI Metadata](#metadata){.xref}
([Section 4.4](#metadata){.xref}). If the CDNI Metadata interface is not
used, or does not include claim requirements, the claim requirements can
be set by configuration (out of scope of this
document).[¶](#section-2.1-2){.pilcrow}

The following claims (where the \"JSON Web Token Claims\" registry claim
name is specified in parentheses below) are used to enforce the
distribution policies. All of the listed claims are mandatory to
implement in a URI Signing implementation but are not necessarily
mandatory to use in a given signed JWT. (The \"optional\" and
\"mandatory\" identifiers in square brackets refer to whether or not a
given claim [MUST]{.bcp14} be present in a URI Signing
JWT.)[¶](#section-2.1-3){.pilcrow}

Note: The time on the entities that generate and verify the Signed URI
[MUST]{.bcp14} be in sync. In the CDNI case, this means that CSP, uCDN,
and dCDN servers need to be time synchronized. It is
[RECOMMENDED]{.bcp14} to use [NTP](#RFC5905){.xref}
\[[RFC5905](#RFC5905){.xref}\] for time
synchronization.[¶](#section-2.1-4){.pilcrow}

Note: See the [Security Considerations](#security){.xref} ([Section
7](#security){.xref}) on the limitations of using an expiration time and
Client IP address for distribution policy
enforcement.[¶](#section-2.1-5){.pilcrow}

::: {#iss_claim}
::: {#section-2.1.1 .section}
#### [2.1.1.](#section-2.1.1){.section-number .selfRef} [Issuer (iss) Claim](#name-issuer-iss-claim){.section-name .selfRef} {#name-issuer-iss-claim}

Issuer (iss) \[optional\] - The semantics in [Section
4.1.1](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.1){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed. If this claim
is used, it [MUST]{.bcp14} be used to identify the Issuer (signer) of
the JWT. In particular, the recipient will have already received, in
trusted configuration, a mapping of Issuer name to one or more keys used
to sign JWTs and must verify that the JWT was signed by one of those
keys. If this claim is used and the CDN verifying the signed JWT does
not support Issuer verification, or if the Issuer in the signed JWT does
not match the list of known acceptable Issuers, or if the Issuer claim
does not match the key used to sign the JWT, the CDN [MUST]{.bcp14}
reject the request. If the received signed JWT contains an Issuer claim,
then any JWT subsequently generated for CDNI redirection [MUST]{.bcp14}
also contain an Issuer claim, and the Issuer value [MUST]{.bcp14} be
updated to identify the redirecting CDN. If the received signed JWT does
not contain an Issuer claim, an Issuer claim [MAY]{.bcp14} be added to a
signed JWT generated for CDNI
redirection.[¶](#section-2.1.1-1){.pilcrow}
:::
:::

::: {#sub_claim}
::: {#section-2.1.2 .section}
#### [2.1.2.](#section-2.1.2){.section-number .selfRef} [Subject (sub) Claim](#name-subject-sub-claim){.section-name .selfRef} {#name-subject-sub-claim}

Subject (sub) \[optional\] - The semantics in [Section
4.1.2](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.2){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed. If this claim
is used, it [MUST]{.bcp14} be a JSON Web Encryption
([JWE](#RFC7516){.xref} \[[RFC7516](#RFC7516){.xref}\]) Object in
compact serialization form, because it contains personally identifiable
information. This claim contains information about the Subject (for
example, a user or an agent) that [MAY]{.bcp14} be used to verify the
signed JWT. If the received signed JWT contains a Subject claim, then
any JWT subsequently generated for CDNI redirection [MUST]{.bcp14} also
contain a Subject claim, and the Subject value [MUST]{.bcp14} be the
same as in the received signed JWT. A signed JWT generated for CDNI
redirection [MUST NOT]{.bcp14} add a Subject claim if no Subject claim
existed in the received signed JWT.[¶](#section-2.1.2-1){.pilcrow}
:::
:::

::: {#aud_claim}
::: {#section-2.1.3 .section}
#### [2.1.3.](#section-2.1.3){.section-number .selfRef} [Audience (aud) Claim](#name-audience-aud-claim){.section-name .selfRef} {#name-audience-aud-claim}

Audience (aud) \[optional\] - The semantics in [Section
4.1.3](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed. This claim is
used to ensure that the CDN verifying the JWT is an intended recipient
of the request. The claim [MUST]{.bcp14} contain an identity belonging
to the chain of entities involved in processing the request (e.g.,
identifying the CSP or any CDN in the chain) that the recipient is
configured to use for the processing of this request. A CDN
[MAY]{.bcp14} modify the claim as long it can generate a valid
signature.[¶](#section-2.1.3-1){.pilcrow}
:::
:::

::: {#exp_claim}
::: {#section-2.1.4 .section}
#### [2.1.4.](#section-2.1.4){.section-number .selfRef} [Expiry Time (exp) Claim](#name-expiry-time-exp-claim){.section-name .selfRef} {#name-expiry-time-exp-claim}

Expiry Time (exp) \[optional\] - The semantics in [Section
4.1.4](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed, though URI
Signing implementations [MUST NOT]{.bcp14} allow for any
time-synchronization \"leeway\". If this claim is used and the CDN
verifying the signed JWT does not support Expiry Time verification, or
if the Expiry Time in the signed JWT corresponds to a time equal to or
earlier than the time of the content request, the CDN [MUST]{.bcp14}
reject the request. If the received signed JWT contains an Expiry Time
claim, then any JWT subsequently generated for CDNI redirection
[MUST]{.bcp14} also contain an Expiry Time claim, and the Expiry Time
value [MUST]{.bcp14} be the same as in the received signed JWT. A signed
JWT generated for CDNI redirection [MUST NOT]{.bcp14} add an Expiry Time
claim if no Expiry Time claim existed in the received signed
JWT.[¶](#section-2.1.4-1){.pilcrow}
:::
:::

::: {#nbf_claim}
::: {#section-2.1.5 .section}
#### [2.1.5.](#section-2.1.5){.section-number .selfRef} [Not Before (nbf) Claim](#name-not-before-nbf-claim){.section-name .selfRef} {#name-not-before-nbf-claim}

Not Before (nbf) \[optional\] - The semantics in [Section
4.1.5](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed, though URI
Signing implementations [MUST NOT]{.bcp14} allow for any
time-synchronization \"leeway\". If this claim is used and the CDN
verifying the signed JWT does not support Not Before time verification,
or if the Not Before time in the signed JWT corresponds to a time later
than the time of the content request, the CDN [MUST]{.bcp14} reject the
request. If the received signed JWT contains a Not Before time claim,
then any JWT subsequently generated for CDNI redirection [MUST]{.bcp14}
also contain a Not Before time claim, and the Not Before time value
[MUST]{.bcp14} be the same as in the received signed JWT. A signed JWT
generated for CDNI redirection [MUST NOT]{.bcp14} add a Not Before time
claim if no Not Before time claim existed in the received signed
JWT.[¶](#section-2.1.5-1){.pilcrow}
:::
:::

::: {#iat_claim}
::: {#section-2.1.6 .section}
#### [2.1.6.](#section-2.1.6){.section-number .selfRef} [Issued At (iat) Claim](#name-issued-at-iat-claim){.section-name .selfRef} {#name-issued-at-iat-claim}

Issued At (iat) \[optional\] - The semantics in [Section
4.1.6](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.6){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed. If the
received signed JWT contains an Issued At claim, then any JWT
subsequently generated for CDNI redirection [MUST]{.bcp14} also contain
an Issued At claim, and the Issued At value [MUST]{.bcp14} be updated to
identify the time the new JWT was generated. If the received signed JWT
does not contain an Issued At claim, an Issued At claim [MAY]{.bcp14} be
added to a signed JWT generated for CDNI
redirection.[¶](#section-2.1.6-1){.pilcrow}
:::
:::

::: {#jti_claim}
::: {#section-2.1.7 .section}
#### [2.1.7.](#section-2.1.7){.section-number .selfRef} [JWT ID (jti) Claim](#name-jwt-id-jti-claim){.section-name .selfRef} {#name-jwt-id-jti-claim}

JWT ID (jti) \[optional\] - The semantics in [Section
4.1.7](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.7){.relref} of
\[[RFC7519](#RFC7519){.xref}\] [MUST]{.bcp14} be followed. A JWT ID can
be used to prevent replay attacks if the CDN stores a list of all
previously used values and verifies that the value in the current JWT
has never been used before. If the signed JWT contains a JWT ID claim
and the CDN verifying the signed JWT either does not support JWT ID
storage or has previously seen the value used in a request for the same
content, then the CDN [MUST]{.bcp14} reject the request. If the received
signed JWT contains a JWT ID claim, then any JWT subsequently generated
for CDNI redirection [MUST]{.bcp14} also contain a JWT ID claim, and the
value [MUST]{.bcp14} be the same as in the received signed JWT. If the
received signed JWT does not contain a JWT ID claim, a JWT ID claim
[MUST NOT]{.bcp14} be added to a signed JWT generated for CDNI
redirection. Sizing of the JWT ID is application dependent given the
desired security constraints.[¶](#section-2.1.7-1){.pilcrow}
:::
:::

::: {#cdniv_claim}
::: {#section-2.1.8 .section}
#### [2.1.8.](#section-2.1.8){.section-number .selfRef} [CDNI Claim Set Version (cdniv) Claim](#name-cdni-claim-set-version-cdni){.section-name .selfRef} {#name-cdni-claim-set-version-cdni}

CDNI Claim Set Version (cdniv) \[optional\] - The CDNI Claim Set Version
(cdniv) claim provides a means within a signed JWT to tie the claim set
to a specific version of this specification. The cdniv claim is intended
to allow changes in and facilitate upgrades across specifications. The
type is a JSON integer and the value [MUST]{.bcp14} be set to \"1\" for
this version of the specification. In the absence of this claim, the
value is assumed to be \"1\". For future versions, this claim will be
mandatory. Implementations [MUST]{.bcp14} reject signed JWTs with
unsupported CDNI Claim Set versions.[¶](#section-2.1.8-1){.pilcrow}
:::
:::

::: {#cdnicrit_claim}
::: {#section-2.1.9 .section}
#### [2.1.9.](#section-2.1.9){.section-number .selfRef} [CDNI Critical Claims Set (cdnicrit) Claim](#name-cdni-critical-claims-set-cd){.section-name .selfRef} {#name-cdni-critical-claims-set-cd}

CDNI Critical Claims Set (cdnicrit) \[optional\] - The CDNI Critical
Claims Set (cdnicrit) claim indicates that extensions to this
specification are being used that [MUST]{.bcp14} be understood and
processed. Its value is a comma-separated listing of claims in the
Signed JWT that use those extensions. If any of the listed extension
claims are not understood and supported by the recipient, then the
Signed JWT [MUST]{.bcp14} be rejected. Producers [MUST NOT]{.bcp14}
include claim names defined by this specification, duplicate names, or
names that do not occur as claim names within the Signed JWT in the
cdnicrit list. Producers [MUST NOT]{.bcp14} use the empty list \"\" as
the cdnicrit value. Recipients [MAY]{.bcp14} consider the Signed JWT to
be invalid if the cdnicrit list contains any claim names defined by this
specification or if any other constraints on its use are violated. This
claim [MUST]{.bcp14} be understood and processed by all
implementations.[¶](#section-2.1.9-1){.pilcrow}
:::
:::

::: {#cdniip_claim}
::: {#section-2.1.10 .section}
#### [2.1.10.](#section-2.1.10){.section-number .selfRef} [Client IP Address (cdniip) Claim](#name-client-ip-address-cdniip-cl){.section-name .selfRef} {#name-client-ip-address-cdniip-cl}

Client IP Address (cdniip) \[optional\] - The Client IP Address (cdniip)
claim holds an IP address or IP prefix for which the Signed URI is
valid. This is represented in CIDR notation with dotted decimal format
for [IPv4 addresses](#RFC0791){.xref} \[[RFC0791](#RFC0791){.xref}\] or
canonical text representation for [IPv6 addresses](#RFC5952){.xref}
\[[RFC5952](#RFC5952){.xref}\]. The request [MUST]{.bcp14} be rejected
if sourced from a client outside the specified IP range. Since the
Client IP is considered personally identifiable information, this field
[MUST]{.bcp14} be a JSON Web Encryption ([JWE](#RFC7516){.xref}
\[[RFC7516](#RFC7516){.xref}\]) Object in compact serialization form. If
the CDN verifying the signed JWT does not support Client IP
verification, or if the Client IP in the signed JWT does not match the
source IP address in the content request, the CDN [MUST]{.bcp14} reject
the request. The type of this claim is a JSON string that contains the
JWE. If the received signed JWT contains a Client IP claim, then any JWT
subsequently generated for CDNI redirection [MUST]{.bcp14} also contain
a Client IP claim, and the Client IP value [MUST]{.bcp14} be the same as
in the received signed JWT. A signed JWT generated for CDNI redirection
[MUST NOT]{.bcp14} add a Client IP claim if no Client IP claim existed
in the received signed JWT.[¶](#section-2.1.10-1){.pilcrow}

It should be noted that use of this claim can cause issues, for example,
in situations with dual-stack IPv4 and IPv6 networks, MPTCP, QUIC, and
mobile clients switching from Wi-Fi to Cellular networks where the
client\'s source address can change, even between address families. This
claim exists mainly for legacy feature parity reasons; therefore, use of
this claim should be done judiciously. An example of a reasonable use
case would be making a signed JWT for an internal preview of an asset
where the end consumer understands that they must be originated from the
same IP for the entirety of the session. Using this claim at large is
[NOT RECOMMENDED]{.bcp14}.[¶](#section-2.1.10-2){.pilcrow}
:::
:::

::: {#cdniuc_claim}
::: {#section-2.1.11 .section}
#### [2.1.11.](#section-2.1.11){.section-number .selfRef} [CDNI URI Container (cdniuc) Claim](#name-cdni-uri-container-cdniuc-c){.section-name .selfRef} {#name-cdni-uri-container-cdniuc-c}

URI Container (cdniuc) \[mandatory\] - The URI Container (cdniuc) holds
the URI representation before a URI Signing Package is added. This
representation can take one of several forms detailed in [Section
2.1.15](#uri_container_forms){.xref}. If the URI Container used in the
signed JWT does not match the URI of the content request, the CDN
verifying the signed JWT [MUST]{.bcp14} reject the request. When
comparing the URI, the percent encoded form as defined in [Section
2.1](https://www.rfc-editor.org/rfc/rfc3986#section-2.1){.relref} of
\[[RFC3986](#RFC3986){.xref}\] [MUST]{.bcp14} be used. When redirecting
a URI, the CDN generating the new signed JWT [MAY]{.bcp14} change the
URI Container to comport with the URI being used in the
redirection.[¶](#section-2.1.11-1){.pilcrow}
:::
:::

::: {#cdniets_claim}
::: {#section-2.1.12 .section}
#### [2.1.12.](#section-2.1.12){.section-number .selfRef} [CDNI Expiration Time Setting (cdniets) Claim](#name-cdni-expiration-time-settin){.section-name .selfRef} {#name-cdni-expiration-time-settin}

CDNI Expiration Time Setting (cdniets) \[optional\] - The CDNI
Expiration Time Setting (cdniets) claim provides a means for setting the
value of the Expiry Time (exp) claim when generating a subsequent signed
JWT in Signed Token Renewal. Its type is a JSON numeric value. It
denotes the number of seconds to be added to the time at which the JWT
is verified that gives the value of the Expiry Time (exp) claim of the
next signed JWT. The CDNI Expiration Time Setting (cdniets) [SHOULD
NOT]{.bcp14} be used when not using Signed Token Renewal and
[MUST]{.bcp14} be present when using Signed Token
Renewal.[¶](#section-2.1.12-1){.pilcrow}
:::
:::

::: {#cdnistt_claim}
::: {#section-2.1.13 .section}
#### [2.1.13.](#section-2.1.13){.section-number .selfRef} [CDNI Signed Token Transport (cdnistt) Claim](#name-cdni-signed-token-transport){.section-name .selfRef} {#name-cdni-signed-token-transport}

CDNI Signed Token Transport (cdnistt) \[optional\] - The CDNI Signed
Token Transport (cdnistt) claim provides a means of signaling the method
through which a new signed JWT is transported from the CDN to the UA and
vice versa for the purpose of Signed Token Renewal. Its type is a JSON
integer. Values for this claim are defined in [Section
6.5](#sec.IANA.cdnistt){.xref}. If using this claim, you [MUST]{.bcp14}
also specify a CDNI Expiration Time Setting (cdniets) as noted
above.[¶](#section-2.1.13-1){.pilcrow}
:::
:::

::: {#cdnistd_claim}
::: {#section-2.1.14 .section}
#### [2.1.14.](#section-2.1.14){.section-number .selfRef} [CDNI Signed Token Depth (cdnistd) Claim](#name-cdni-signed-token-depth-cdn){.section-name .selfRef} {#name-cdni-signed-token-depth-cdn}

CDNI Signed Token Depth (cdnistd) \[optional\] - The CDNI Signed Token
Depth (cdnistd) claim is used to associate a subsequent signed JWT,
generated as the result of a CDNI Signed Token Transport claim, with a
specific URI subset. Its type is a JSON integer. Signed JWTs [MUST
NOT]{.bcp14} use a negative value for the CDNI Signed Token Depth
claim.[¶](#section-2.1.14-1){.pilcrow}

If the transport used for Signed Token Transport allows the CDN to
associate the path component of a URI with tokens (e.g., an HTTP Cookie
Path as described in [Section
4.1.2.4](https://www.rfc-editor.org/rfc/rfc6265#section-4.1.2.4){.relref}
of \[[RFC6265](#RFC6265){.xref}\]), the CDNI Signed Token Depth value is
the number of path segments that should be considered significant for
this association. A CDNI Signed Token Depth of zero means that the
client [SHOULD]{.bcp14} be directed to return the token with requests
for any path. If the CDNI Signed Token Depth is greater than zero, then
the CDN [SHOULD]{.bcp14} send the client a token to return for future
requests wherein the first CDNI Signed Token Depth segments of the path
match the first CDNI Signed Token Depth segments of the Signed URI path.
This matching [MUST]{.bcp14} use the URI with the token removed, as
specified in [Section
2.1.15](#uri_container_forms){.xref}.[¶](#section-2.1.14-2){.pilcrow}

If the URI path to match contains fewer segments than the CDNI Signed
Token Depth claim, a signed JWT [MUST NOT]{.bcp14} be generated for the
purposes of Signed Token Renewal. If the CDNI Signed Token Depth claim
is omitted, it means the same thing as if its value were zero. If the
received signed JWT contains a CDNI Signed Token Depth claim, then any
JWT subsequently generated for CDNI redirection or Signed Token
Transport [MUST]{.bcp14} also contain a CDNI Signed Token Depth claim,
and the value [MUST]{.bcp14} be the same as in the received signed
JWT.[¶](#section-2.1.14-3){.pilcrow}
:::
:::

::: {#uri_container_forms}
::: {#section-2.1.15 .section}
#### [2.1.15.](#section-2.1.15){.section-number .selfRef} [URI Container Forms](#name-uri-container-forms){.section-name .selfRef} {#name-uri-container-forms}

The URI Container (cdniuc) claim takes one of the following forms:
\'hash:\' or \'regex:\'. More forms may be added in the future to extend
the capabilities.[¶](#section-2.1.15-1){.pilcrow}

Before comparing a URI with contents of this container, the following
steps [MUST]{.bcp14} be performed:[¶](#section-2.1.15-2){.pilcrow}

-   [Prior to verification, remove the signed JWT from the URI. This
    removal is only for the purpose of determining if the URI matches;
    all other purposes will use the original URI. If the signed JWT is
    terminated by anything other than a sub-delimiter (as defined in
    [Section
    2.2](https://www.rfc-editor.org/rfc/rfc3986#section-2.2){.relref} of
    \[[RFC3986](#RFC3986){.xref}\]), everything from the reserved
    character (as defined in [Section
    2.2](https://www.rfc-editor.org/rfc/rfc3986#section-2.2){.relref} of
    \[[RFC3986](#RFC3986){.xref}\]) that precedes the URI Signing
    Package Attribute to the last character of the signed JWT will be
    removed, inclusive. Otherwise, everything from the first character
    of the URI Signing Package Attribute to the sub-delimiter that
    terminates the signed JWT will be removed,
    inclusive.[¶](#section-2.1.15-3.1){.pilcrow}]{#section-2.1.15-3.1}
-   [Normalize the URI according to [Section
    2.7.3](https://www.rfc-editor.org/rfc/rfc7230#section-2.7.3){.relref}
    of \[[RFC7230](#RFC7230){.xref}\] and Sections
    [6.2.2](https://www.rfc-editor.org/rfc/rfc3986#section-6.2.2){.relref}
    and
    [6.2.3](https://www.rfc-editor.org/rfc/rfc3986#section-6.2.3){.relref}
    of \[[RFC3986](#RFC3986){.xref}\]. This applies to both generation
    and verification of the signed
    JWT.[¶](#section-2.1.15-3.2){.pilcrow}]{#section-2.1.15-3.2}

::: {#uri_container_forms_hash}
::: {#section-2.1.15.1 .section}
##### [2.1.15.1.](#section-2.1.15.1){.section-number .selfRef} [URI Hash Container (hash:)](#name-uri-hash-container-hash){.section-name .selfRef} {#name-uri-hash-container-hash}

Prefixed with \'hash:\', this string is a URL Segment form ([Section
5](https://www.rfc-editor.org/rfc/rfc6920#section-5){.relref} of
\[[RFC6920](#RFC6920){.xref}\]) of the
URI.[¶](#section-2.1.15.1-1){.pilcrow}
:::
:::

::: {#uri_container_forms_regex}
::: {#section-2.1.15.2 .section}
##### [2.1.15.2.](#section-2.1.15.2){.section-number .selfRef} [URI Regular Expression Container (regex:)](#name-uri-regular-expression-cont){.section-name .selfRef} {#name-uri-regular-expression-cont}

Prefixed with \'regex:\', this string is any regular expression
compatible with POSIX (Section 9 of \[[POSIX.1](#POSIX.1){.xref}\])
Extended Regular Expression used to match against the requested URI.
These regular expressions [MUST]{.bcp14} be evaluated in the POSIX
locale (Section 7.2 of
\[[POSIX.1](#POSIX.1){.xref}\]).[¶](#section-2.1.15.2-1){.pilcrow}

Note: Because \'\\\' has special meaning in JSON
\[[RFC8259](#RFC8259){.xref}\] as the escape character within JSON
strings, the regular expression character \'\\\' [MUST]{.bcp14} be
escaped as \'\\\\\'.[¶](#section-2.1.15.2-2){.pilcrow}

An example of a \'regex:\' is the
following:[¶](#section-2.1.15.2-3){.pilcrow}

::: {#section-2.1.15.2-4}
``` sourcecode
[^:]*\\://[^/]*/dir/content/quality_[^/]*/segment.{3}\\.mp4(\\?.*)?
```

[¶](#section-2.1.15.2-4){.pilcrow}
:::

Note: Due to computational complexity of executing arbitrary regular
expressions, it is [RECOMMENDED]{.bcp14} to only execute after verifying
the JWT to ensure its authenticity.[¶](#section-2.1.15.2-5){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#jwt_header}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [JWT Header](#name-jwt-header){.section-name .selfRef} {#name-jwt-header}

The header of the JWT [MAY]{.bcp14} be passed via the CDNI Metadata
interface instead of being included in the URISigningPackage. The header
value [MUST]{.bcp14} be transmitted in the serialized encoded form and
prepended to the JWT payload and signature passed in the
URISigningPackage prior to verification. This reduces the size of the
signed JWT token.[¶](#section-2.2-1){.pilcrow}
:::
:::
:::
:::

::: {#uri_signing_token_renewal}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [URI Signing Token Renewal](#name-uri-signing-token-renewal){.section-name .selfRef} {#name-uri-signing-token-renewal}

::: {#token_renewal_intro}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Overview](#name-overview){.section-name .selfRef} {#name-overview}

For content that is delivered via HTTP in a segmented fashion, such as
[MPEG-DASH](#MPEG-DASH){.xref} \[[MPEG-DASH](#MPEG-DASH){.xref}\] or
[HTTP Live Streaming (HLS)](#RFC8216){.xref}
\[[RFC8216](#RFC8216){.xref}\], special provisions need to be made in
order to ensure URI Signing can be applied. In general, segmented
protocols work by breaking large objects (e.g., videos) into a sequence
of small independent segments. Such segments are then referenced by a
separate manifest file, which either includes a list of URLs to the
segments or specifies an algorithm through which a User Agent can
construct the URLs to the segments. Requests for segments therefore
originate from the manifest file and, unless the URLs in the manifest
file point to the CSP, are not subjected to redirection and URI Signing.
This opens up a vulnerability to malicious User Agents sharing the
manifest file and deep linking to the
segments.[¶](#section-3.1-1){.pilcrow}

One method for dealing with this vulnerability would be to include, in
the manifest itself, Signed URIs that point to the individual segments.
There exist a number of issues with that approach. First, it requires
the CDN delivering the manifest to rewrite the manifest file for each
User Agent, which would require the CDN to be aware of the exact
segmentation protocol used. Secondly, it could also require the
expiration time of the Signed URIs to be valid for an extended duration
if the content described by the manifest is meant to be consumed in real
time. For instance, if the manifest file were to contain a segmented
video stream of more than 30 minutes in length, Signed URIs would
require to be valid for at least 30 minutes, thereby reducing their
effectiveness and that of the URI Signing mechanism in general. For a
more detailed analysis of how segmented protocols such as HTTP Adaptive
Streaming protocols affect CDNI, see [Models for
HTTP-Adaptive-Streaming-Aware Content Distribution Network
Interconnection (CDNI)](#RFC6983){.xref}
\[[RFC6983](#RFC6983){.xref}\].[¶](#section-3.1-2){.pilcrow}

The method described in this section allows CDNs to use URI Signing for
segmented content without having to include the Signed URIs in the
manifest files themselves.[¶](#section-3.1-3){.pilcrow}
:::
:::

::: {#uri_signing_mechanism}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Signed Token Renewal Mechanism](#name-signed-token-renewal-mechan){.section-name .selfRef} {#name-signed-token-renewal-mechan}

In order to allow for effective access control of segmented content, the
URI Signing mechanism defined in this section is based on a method
through which subsequent segment requests can be linked together. As
part of the JWT verification procedure, the CDN can generate a new
signed JWT that the UA can use to do a subsequent request. More
specifically, whenever a UA successfully retrieves a segment, it
receives, in the HTTP 2xx Successful message, a signed JWT that it can
use whenever it requests the next segment. As long as each successive
signed JWT is correctly verified before a new one is generated, the
model is not broken, and the User Agent can successfully retrieve
additional segments. Given the fact that with segmented protocols it is
usually not possible to determine a priori which segment will be
requested next (i.e., to allow for seeking within the content and for
switching to a different representation), the Signed Token Renewal uses
the URI Regular Expression Container scoping mechanisms in the URI
Container (cdniuc) claim to allow a signed JWT to be valid for more than
one URL.[¶](#section-3.2-1){.pilcrow}

In order for this renewal of signed JWTs to work, it is necessary for a
UA to extract the signed JWT from the HTTP 2xx Successful message of an
earlier request and use it to retrieve the next segment. The exact
mechanism by which the client does this is outside the scope of this
document. However, in order to also support legacy UAs that do not
include any specific provisions for the handling of signed JWTs,
[Section 3.3](#communicating_token){.xref} defines a mechanism using
HTTP Cookies \[[RFC6265](#RFC6265){.xref}\] that allows such UAs to
support the concept of renewing signed JWTs without requiring any
additional UA support.[¶](#section-3.2-2){.pilcrow}

::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Required Claims](#name-required-claims){.section-name .selfRef} {#name-required-claims}

The [cdnistt claim](#cdnistt_claim){.xref} ([Section
2.1.13](#cdnistt_claim){.xref}) and [cdniets
claim](#cdniets_claim){.xref} ([Section 2.1.12](#cdniets_claim){.xref})
[MUST]{.bcp14} both be present for Signed Token Renewal. cdnistt
[MAY]{.bcp14} be set to a value of \'0\' to mean no Signed Token
Renewal, but there still [MUST]{.bcp14} be a corresponding cdniets that
verifies as a JSON number. However, if use of Signed Token Renewal is
not desired, it is [RECOMMENDED]{.bcp14} to simply omit
both.[¶](#section-3.2.1-1){.pilcrow}
:::
:::
:::

::: {#communicating_token}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Communicating a Signed JWT in Signed Token Renewal](#name-communicating-a-signed-jwt-){.section-name .selfRef} {#name-communicating-a-signed-jwt-}

This section assumes the value of the CDNI Signed Token Transport
(cdnistt) claim has been set to 1.[¶](#section-3.3-1){.pilcrow}

When using the Signed Token Renewal mechanism, the signed JWT is
transported to the UA via a \'URISigningPackage\' cookie added to the
HTTP 2xx Successful message along with the content being returned to the
UA, or to the HTTP 3xx Redirection message in case the UA is redirected
to a different server.[¶](#section-3.3-2){.pilcrow}

::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [Support for Cross-Domain Redirection](#name-support-for-cross-domain-re){.section-name .selfRef} {#name-support-for-cross-domain-re}

For security purposes, the use of cross-domain cookies is not supported
in some application environments. As a result, the Cookie-based method
for transport of the Signed Token described in [Section
3.3](#communicating_token){.xref} might break if used in combination
with an HTTP 3xx Redirection response where the target URL is in a
different domain. In such scenarios, Signed Token Renewal of a signed
JWT [SHOULD]{.bcp14} be communicated via the query string instead, in a
similar fashion to how regular signed JWTs (outside of Signed Token
Renewal) are communicated. Note the value of the CDNI Signed Token
Transport (cdnistt) claim [MUST]{.bcp14} be set to
2.[¶](#section-3.3.1-1){.pilcrow}

Note that the process described herein only works in cases where both
the manifest file and segments constituting the segmented content are
delivered from the same domain. In other words, any redirection between
different domains needs to be carried out while retrieving the manifest
file.[¶](#section-3.3.1-2){.pilcrow}
:::
:::
:::
:::
:::

::: {#cdni_interfaces}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Relationship with CDNI Interfaces](#name-relationship-with-cdni-inte){.section-name .selfRef} {#name-relationship-with-cdni-inte}

Some of the CDNI Interfaces need enhancements to support URI Signing. A
dCDN that supports URI Signing needs to be able to advertise this
capability to the uCDN. The uCDN needs to select a dCDN based on such
capability when the CSP requires access control to enforce its
distribution policy via URI Signing. Also, the uCDN needs to be able to
distribute via the CDNI Metadata interface the information necessary to
allow the dCDN to verify a Signed URI. Events that pertain to URI
Signing (e.g., request denial or delivery after an access authorization
decision has been made) need to be included in the logs communicated
through the CDNI Logging interface.[¶](#section-4-1){.pilcrow}

::: {#control}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [CDNI Control Interface](#name-cdni-control-interface){.section-name .selfRef} {#name-cdni-control-interface}

URI Signing has no impact on this
interface.[¶](#section-4.1-1){.pilcrow}
:::
:::

::: {#advertisement}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [CDNI Footprint & Capabilities Advertisement Interface](#name-cdni-footprint-capabilities){.section-name .selfRef} {#name-cdni-footprint-capabilities}

The CDNI Request Routing: Footprint and Capabilities Semantics document
\[[RFC8008](#RFC8008){.xref}\] defines support for advertising CDNI
Metadata capabilities via CDNI Payload Type. The CDNI Payload Type
registered in [Section 6.1](#sec.IANA.payload){.xref} can be used for
capability advertisement.[¶](#section-4.2-1){.pilcrow}
:::
:::

::: {#redirection}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [CDNI Request Routing Redirection Interface](#name-cdni-request-routing-redire){.section-name .selfRef} {#name-cdni-request-routing-redire}

The [CDNI Request Routing Redirection Interface](#RFC7975){.xref}
\[[RFC7975](#RFC7975){.xref}\] describes the recursive request
redirection method. For URI Signing, the uCDN signs the URI provided by
the dCDN. URI Signing therefore has no impact on this
interface.[¶](#section-4.3-1){.pilcrow}
:::
:::

::: {#metadata}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [CDNI Metadata Interface](#name-cdni-metadata-interface){.section-name .selfRef} {#name-cdni-metadata-interface}

The [CDNI Metadata Interface](#RFC8006){.xref}
\[[RFC8006](#RFC8006){.xref}\] describes the CDNI Metadata distribution
needed to enable content acquisition and delivery. For URI Signing, a
new CDNI Metadata object is specified.[¶](#section-4.4-1){.pilcrow}

The UriSigning Metadata object contains information to enable URI
Signing and verification by a dCDN. The UriSigning properties are
defined below.[¶](#section-4.4-2){.pilcrow}

-   ::: {#section-4.4-3.1}
    Property: enforce[¶](#section-4.4-3.1.1){.pilcrow}

    -   [[]{.break}]{#section-4.4-3.1.2.1}

        Description:
        :   URI Signing enforcement flag. Specifically, this flag
            indicates if the access to content is subject to URI
            Signing. URI Signing requires the dCDN to ensure that the
            URI is signed and verified before delivering content.
            Otherwise, the dCDN does not perform verification,
            regardless of whether or not the URI is
            signed.[¶](#section-4.4-3.1.2.1.1.2){.pilcrow}
        :   

        Type:
        :   Boolean[¶](#section-4.4-3.1.2.1.1.4){.pilcrow}
        :   

        Mandatory-to-Specify:
        :   No. The default is
            true.[¶](#section-4.4-3.1.2.1.1.6){.pilcrow}
        :   
    :::

-   ::: {#section-4.4-3.2}
    Property: issuers[¶](#section-4.4-3.2.1){.pilcrow}

    -   [[]{.break}]{#section-4.4-3.2.2.1}

        Description:
        :   A list of valid Issuers against which the Issuer claim in
            the signed JWT may be
            cross-referenced.[¶](#section-4.4-3.2.2.1.1.2){.pilcrow}
        :   

        Type:
        :   Array of Strings[¶](#section-4.4-3.2.2.1.1.4){.pilcrow}
        :   

        Mandatory-to-Specify:
        :   No. The default is an empty list. An empty list means that
            any Issuer in the trusted key store of Issuers is
            acceptable.[¶](#section-4.4-3.2.2.1.1.6){.pilcrow}
        :   
    :::

-   ::: {#section-4.4-3.3}
    Property: package-attribute[¶](#section-4.4-3.3.1){.pilcrow}

    -   [[]{.break}]{#section-4.4-3.3.2.1}

        Description:
        :   The attribute name to use for the URI Signing
            Package.[¶](#section-4.4-3.3.2.1.1.2){.pilcrow}
        :   

        Type:
        :   String[¶](#section-4.4-3.3.2.1.1.4){.pilcrow}
        :   

        Mandatory-to-Specify:
        :   No. The default is
            \"URISigningPackage\".[¶](#section-4.4-3.3.2.1.1.6){.pilcrow}
        :   
    :::

-   ::: {#section-4.4-3.4}
    Property: jwt-header[¶](#section-4.4-3.4.1){.pilcrow}

    -   [[]{.break}]{#section-4.4-3.4.2.1}

        Description:
        :   The header part of JWT that is used for verifying a signed
            JWT when the JWT token in the URI Signing Package does not
            contain a header
            part.[¶](#section-4.4-3.4.2.1.1.2){.pilcrow}
        :   

        Type:
        :   String[¶](#section-4.4-3.4.2.1.1.4){.pilcrow}
        :   

        Mandatory-to-Specify:
        :   No. By default, the header is assumed to be included in the
            JWT token.[¶](#section-4.4-3.4.2.1.1.6){.pilcrow}
        :   
    :::

The following is an example of a URI Signing metadata payload with all
default values:[¶](#section-4.4-4){.pilcrow}

::: {#section-4.4-5}
``` {.lang-json .sourcecode}
{
  "generic-metadata-type": "MI.UriSigning"
  "generic-metadata-value": {}
}
```

[¶](#section-4.4-5){.pilcrow}
:::

The following is an example of a URI Signing metadata payload with
explicit values:[¶](#section-4.4-6){.pilcrow}

::: {#section-4.4-7}
``` {.lang-json .sourcecode}
{
  "generic-metadata-type": "MI.UriSigning"
  "generic-metadata-value":
    {
      "enforce": true,
      "issuers": ["csp", "ucdn1", "ucdn2"],
      "package-attribute": "usp",
      "jwt-header":
        {
            "alg": "ES256",
            "kid": "P5UpOv0eMq1wcxLf7WxIg09JdSYGYFDOWkldueaImf0"
        }
    }
}
```

[¶](#section-4.4-7){.pilcrow}
:::
:::
:::

::: {#logging}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [CDNI Logging Interface](#name-cdni-logging-interface){.section-name .selfRef} {#name-cdni-logging-interface}

For URI Signing, the dCDN reports that enforcement of the access control
was applied to the request for content delivery. When the request is
denied due to enforcement of URI Signing, the reason is
logged.[¶](#section-4.5-1){.pilcrow}

The following CDNI Logging field for URI Signing [SHOULD]{.bcp14} be
supported in the HTTP Request Logging Record as specified in \"[Content
Distribution Network Interconnection (CDNI) Logging
Interface](#RFC7937){.xref}\" \[[RFC7937](#RFC7937){.xref}\] using the
new \"cdni_http_request_v2\" record-type registered in [Section
6.2.1](#sec.IANA.record_type.cdni_http_request_v2){.xref}.[¶](#section-4.5-2){.pilcrow}

-   ::: {#section-4.5-3.1}
    s-uri-signing (mandatory):[¶](#section-4.5-3.1.1){.pilcrow}

    []{.break}

    Format:
    :   3DIGIT[¶](#section-4.5-3.1.2.2){.pilcrow}
    :   

    Field value:
    :   this characterizes the URI Signing verification performed by the
        Surrogate on the request. The allowed values are registered in
        [Section
        6.4](#sec.IANA.field.s-uri-signing.values){.xref}.[¶](#section-4.5-3.1.2.4){.pilcrow}
    :   

    Occurrence:
    :   there [MUST]{.bcp14} be zero or exactly one instance of this
        field.[¶](#section-4.5-3.1.2.6){.pilcrow}
    :   
    :::

-   ::: {#section-4.5-3.2}
    s-uri-signing-deny-reason
    (optional):[¶](#section-4.5-3.2.1){.pilcrow}

    []{.break}

    Format:
    :   QSTRING[¶](#section-4.5-3.2.2.2){.pilcrow}
    :   

    Field value:
    :   a string for providing further information in case the signed
        JWT was rejected, e.g., for debugging
        purposes.[¶](#section-4.5-3.2.2.4){.pilcrow}
    :   

    Occurrence:
    :   there [MUST]{.bcp14} be zero or exactly one instance of this
        field.[¶](#section-4.5-3.2.2.6){.pilcrow}
    :   
    :::
:::
:::
:::
:::

::: {#operation}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [URI Signing Message Flow](#name-uri-signing-message-flow){.section-name .selfRef} {#name-uri-signing-message-flow}

URI Signing supports both HTTP-based and DNS-based request routing.
[JSON Web Token (JWT)](#RFC7519){.xref} \[[RFC7519](#RFC7519){.xref}\]
defines a compact, URL-safe means of representing claims to be
transferred between two parties. The claims in a Signed JWT are encoded
as a JSON object that is used as the payload of a JSON Web Signature
(JWS) structure enabling the claims to be digitally signed or integrity
protected with a Message Authentication Code
(MAC).[¶](#section-5-1){.pilcrow}

::: {#http}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [HTTP Redirection](#name-http-redirection){.section-name .selfRef} {#name-http-redirection}

For HTTP-based request routing, a set of information that is unique to a
given end user content request is included in a Signed JWT, using key
information that is specific to a pair of adjacent CDNI hops (e.g.,
between the CSP and the uCDN or between the uCDN and a dCDN). This
allows a CDNI hop to ascertain the authenticity of a given request
received from a previous CDNI hop.[¶](#section-5.1-1){.pilcrow}

The URI Signing method (assuming HTTP redirection, iterative request
routing, and a CDN path with two CDNs) includes the following
steps:[¶](#section-5.1-2){.pilcrow}

[]{#name-http-based-request-routing-}

::: {#fig_http_routing}
::: {#section-5.1-3.1 .alignLeft .art-text .artwork}
         End-User           dCDN                 uCDN                 CSP
         |                    |                    |                    |
         |               1.CDNI FCI used to        |                    |
         |        advertise URI Signing capability |                    |
         |                    |------------------->|                    |
         |                    |                    |                    |
         |              2.Provides information to verify Signed JWT     |
         |                    |                    |<-------------------|
         |                    |                    |                    |
         |        3.CDNI Metadata interface used to|                    |
         |           provide URI Signing attributes|                    |
         |                    |<-------------------|                    |
         :                    :                    :                    :
         :   (Later in time)  :                    :                    :
         |4.Authorization request                  |                    |
         |------------------------------------------------------------->|
         |                    |                    |  [Apply distribution
         |                    |                    |   policy]          |
         |                    |                    |                    |
         |                    |             (ALT: Authorization decision)
         |5.Request is denied |                    |      <Negative>    |
         |<-------------------------------------------------------------|
         |                    |                    |                    |
         |6.CSP provides Signed URI                |      <Positive>    |
         |<-------------------------------------------------------------|
         |                    |                    |                    |
         |7.Content request   |                    |                    |
         |---------------------------------------->| [Verify URI        |
         |                    |                    |  signature]        |
         |                    |                    |                    |
         |                    |    (ALT: Verification result)           |
         |8.Request is denied |          <Negative>|                    |
         |<----------------------------------------|                    |
         |                    |                    |                    |
         |9.Re-sign URI and redirect to  <Positive>|                    |
         |  dCDN (newly Signed URI)                |                    |
         |<----------------------------------------|                    |
         |                    |                    |                    |
         |10.Content request  |                    |                    |
         |------------------->| [Verify URI        |                    |
         |                    |  signature]        |                    |
         |                    |                    |                    |
         |    (ALT: Verification result)           |                    |
         |11.Request is denied| <Negative>         |                    |
         |<-------------------|                    |                    |
         |                    |                    |                    |
         |12.Content delivery | <Positive>         |                    |
         |<-------------------|                    |                    |
         :                    :                    :                    :
         :   (Later in time)  :                    :                    :
         |13.CDNI Logging interface to include URI Signing information  |
         |                    |------------------->|                    |
:::

[Figure 3](#figure-3){.selfRef}: [HTTP-Based Request Routing with URI
Signing](#name-http-based-request-routing-){.selfRef}
:::

1.  [Using the CDNI Footprint & Capabilities Advertisement interface,
    the dCDN advertises its capabilities including URI Signing support
    to the uCDN.[¶](#section-5.1-4.1){.pilcrow}]{#section-5.1-4.1}
2.  [CSP provides to the uCDN the information needed to verify Signed
    URIs from that CSP. For example, this information will include one
    or more keys used for
    validation.[¶](#section-5.1-4.2){.pilcrow}]{#section-5.1-4.2}
3.  [Using the CDNI Metadata interface, the uCDN communicates to a dCDN
    the information needed to verify Signed URIs from the uCDN for the
    given CSP. For example, this information may include the URI query
    string parameter name for the URI Signing Package Attribute in
    addition to keys used for
    validation.[¶](#section-5.1-4.3){.pilcrow}]{#section-5.1-4.3}
4.  [When a UA requests a piece of protected content from the CSP, the
    CSP makes a specific authorization decision for this unique request
    based on its local distribution
    policy.[¶](#section-5.1-4.4){.pilcrow}]{#section-5.1-4.4}
5.  [If the authorization decision is negative, the CSP rejects the
    request and sends an error code (e.g., 403 Forbidden) in the HTTP
    response.[¶](#section-5.1-4.5){.pilcrow}]{#section-5.1-4.5}
6.  [If the authorization decision is positive, the CSP computes a
    Signed JWT that is based on unique parameters of that request and
    conveys it to the end user as the URI to use to request the
    content.[¶](#section-5.1-4.6){.pilcrow}]{#section-5.1-4.6}
7.  [On receipt of the corresponding content request, the uCDN verifies
    the Signed JWT in the URI using the information provided by the
    CSP.[¶](#section-5.1-4.7){.pilcrow}]{#section-5.1-4.7}
8.  [If the verification result is negative, the uCDN rejects the
    request and sends an error code 403 Forbidden in the HTTP
    response.[¶](#section-5.1-4.8){.pilcrow}]{#section-5.1-4.8}
9.  [If the verification result is positive, the uCDN computes a Signed
    JWT that is based on unique parameters of that request and provides
    it to the end user as the URI to use to further request the content
    from the dCDN.[¶](#section-5.1-4.9){.pilcrow}]{#section-5.1-4.9}
10. [On receipt of the corresponding content request, the dCDN verifies
    the Signed JWT in the Signed URI using the information provided by
    the uCDN in the CDNI
    Metadata.[¶](#section-5.1-4.10){.pilcrow}]{#section-5.1-4.10}
11. [If the verification result is negative, the dCDN rejects the
    request and sends an error code 403 Forbidden in the HTTP
    response.[¶](#section-5.1-4.11){.pilcrow}]{#section-5.1-4.11}
12. [If the verification result is positive, the dCDN serves the request
    and delivers the
    content.[¶](#section-5.1-4.12){.pilcrow}]{#section-5.1-4.12}
13. [At a later time, the dCDN reports logging events that include URI
    Signing
    information.[¶](#section-5.1-4.13){.pilcrow}]{#section-5.1-4.13}

With HTTP-based request routing, URI Signing matches well the general
chain of trust model of CDNI both with symmetric and asymmetric keys
because the key information only needs to be specific to a pair of
adjacent CDNI hops.[¶](#section-5.1-5){.pilcrow}

Note: While using a symmetric shared key is supported, it is [NOT
RECOMMENDED]{.bcp14}. See the [Security
Considerations](#security){.xref} ([Section 7](#security){.xref}) about
the limitations of shared keys.[¶](#section-5.1-6){.pilcrow}
:::
:::

::: {#dns}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [DNS Redirection](#name-dns-redirection){.section-name .selfRef} {#name-dns-redirection}

For DNS-based request routing, the CSP and uCDN must agree on a trust
model appropriate to the security requirements of the CSP\'s particular
content. Use of asymmetric public/private keys allows for unlimited
distribution of the public key to dCDNs. However, if a shared secret key
is required, then the distribution [SHOULD]{.bcp14} be performed by the
CSP directly.[¶](#section-5.2-1){.pilcrow}

Note: While using a symmetric shared key is supported, it is [NOT
RECOMMENDED]{.bcp14}. See the [Security
Considerations](#security){.xref} ([Section 7](#security){.xref}) about
the limitations of shared keys.[¶](#section-5.2-2){.pilcrow}

The URI Signing method (assuming iterative DNS request routing and a CDN
path with two CDNs) includes the following
steps.[¶](#section-5.2-3){.pilcrow}

[]{#name-dns-based-request-routing-w}

::: {#fig_dns_routing}
::: {#section-5.2-4.1 .alignLeft .art-text .artwork}
         End-User            dCDN                 uCDN                CSP
         |                    |                    |                    |
         |               1.CDNI FCI used to        |                    |
         |        advertise URI Signing capability |                    |
         |                    |------------------->|                    |
         |                    |                    |                    |
         |              2.Provides information to verify Signed JWT     |
         |                    |                    |<-------------------|
         |        3.CDNI Metadata interface used to|                    |
         |           provide URI Signing attributes|                    |
         |                    |<-------------------|                    |
         :                    :                    :                    :
         :   (Later in time)  :                    :                    :
         |4.Authorization request                  |                    |
         |------------------------------------------------------------->|
         |                    |                    |  [Apply distribution
         |                    |                    |   policy]          |
         |                    |                    |                    |
         |                    |             (ALT: Authorization decision)
         |5.Request is denied |                    |      <Negative>    |
         |<-------------------------------------------------------------|
         |                    |                    |                    |
         |6.Provides Signed URI                    |      <Positive>    |
         |<-------------------------------------------------------------|
         |                    |                    |                    |
         |7.DNS request       |                    |                    |
         |---------------------------------------->|                    |
         |                    |                    |                    |
         |8.Redirect DNS to dCDN                   |                    |
         |<----------------------------------------|                    |
         |                    |                    |                    |
         |9.DNS request       |                    |                    |
         |------------------->|                    |                    |
         |                    |                    |                    |
         |10.IP address of Surrogate               |                    |
         |<-------------------|                    |                    |
         |                    |                    |                    |
         |11.Content request  |                    |                    |
         |------------------->| [Verify URI        |                    |
         |                    |  signature]        |                    |
         |                    |                    |                    |
         |    (ALT: Verification result)           |                    |
         |12.Request is denied| <Negative>         |                    |
         |<-------------------|                    |                    |
         |                    |                    |                    |
         |13.Content delivery | <Positive>         |                    |
         |<-------------------|                    |                    |
         :                    :                    :                    :
         :   (Later in time)  :                    :                    :
         |14.CDNI Logging interface to report URI Signing information   |
         |                    |------------------->|                    |
:::

[Figure 4](#figure-4){.selfRef}: [DNS-based Request Routing with URI
Signing](#name-dns-based-request-routing-w){.selfRef}
:::

1.  [Using the CDNI Footprint & Capabilities Advertisement interface,
    the dCDN advertises its capabilities including URI Signing support
    to the uCDN.[¶](#section-5.2-5.1){.pilcrow}]{#section-5.2-5.1}
2.  [CSP provides to the uCDN the information needed to verify Signed
    JWTs from that CSP. For example, this information will include one
    or more keys used for
    validation.[¶](#section-5.2-5.2){.pilcrow}]{#section-5.2-5.2}
3.  [Using the CDNI Metadata interface, the uCDN communicates to a dCDN
    the information needed to verify Signed JWTs from the CSP (e.g., the
    URI query string parameter name for the URI Signing Package
    Attribute). In the case of symmetric shared key, the uCDN [MUST
    NOT]{.bcp14} share the key with a
    dCDN.[¶](#section-5.2-5.3){.pilcrow}]{#section-5.2-5.3}
4.  [When a UA requests a piece of protected content from the CSP, the
    CSP makes a specific authorization decision for this unique request
    based on its local distribution
    policy.[¶](#section-5.2-5.4){.pilcrow}]{#section-5.2-5.4}
5.  [If the authorization decision is negative, the CSP rejects the
    request and sends an error code (e.g., 403 Forbidden) in the HTTP
    response.[¶](#section-5.2-5.5){.pilcrow}]{#section-5.2-5.5}
6.  [If the authorization decision is positive, the CSP computes a
    Signed JWT that is based on unique parameters of that request and
    includes it in the URI provided to the end user to request the
    content.[¶](#section-5.2-5.6){.pilcrow}]{#section-5.2-5.6}
7.  [The end user sends a DNS request to the
    uCDN.[¶](#section-5.2-5.7){.pilcrow}]{#section-5.2-5.7}
8.  [On receipt of the DNS request, the uCDN redirects the request to
    the dCDN.[¶](#section-5.2-5.8){.pilcrow}]{#section-5.2-5.8}
9.  [The end user sends a DNS request to the
    dCDN.[¶](#section-5.2-5.9){.pilcrow}]{#section-5.2-5.9}
10. [On receipt of the DNS request, the dCDN responds with IP address of
    one of its
    Surrogates.[¶](#section-5.2-5.10){.pilcrow}]{#section-5.2-5.10}
11. [On receipt of the corresponding content request, the dCDN verifies
    the Signed JWT in the URI using the information provided by the uCDN
    in the CDNI
    Metadata.[¶](#section-5.2-5.11){.pilcrow}]{#section-5.2-5.11}
12. [If the verification result is negative, the dCDN rejects the
    request and sends an error code 403 Forbidden in the HTTP
    response.[¶](#section-5.2-5.12){.pilcrow}]{#section-5.2-5.12}
13. [If the verification result is positive, the dCDN serves the request
    and delivers the
    content.[¶](#section-5.2-5.13){.pilcrow}]{#section-5.2-5.13}
14. [At a later time, dCDN reports logging events that includes URI
    Signing
    information.[¶](#section-5.2-5.14){.pilcrow}]{#section-5.2-5.14}

With DNS-based request routing, URI Signing matches well the general
chain of trust model of CDNI when used with asymmetric keys because the
only key information that needs to be distributed across multiple,
possibly untrusted, CDNI hops is the public key, which is generally not
confidential.[¶](#section-5.2-6){.pilcrow}

With DNS-based request routing, URI Signing does not match well with the
general chain of trust model of CDNI when used with symmetric keys
because the symmetric key information needs to be distributed across
multiple CDNI hops to CDNs with which the CSP may not have a trust
relationship. This raises a security concern for applicability of URI
Signing with symmetric keys in case of DNS-based inter-CDN request
routing. Due to these flaws, this architecture [MUST NOT]{.bcp14} be
implemented.[¶](#section-5.2-7){.pilcrow}

Note: While using a symmetric shared key is supported, it is [NOT
RECOMMENDED]{.bcp14}. See the [Security
Considerations](#security){.xref} ([Section 7](#security){.xref}) about
the limitations of shared keys.[¶](#section-5.2-8){.pilcrow}
:::
:::
:::
:::

::: {#sec.IANA}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#sec.IANA.payload}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [CDNI Payload Type](#name-cdni-payload-type){.section-name .selfRef} {#name-cdni-payload-type}

IANA has registered the following CDNI Payload Type under the IANA
\"CDNI Payload Types\" registry:[¶](#section-6.1-1){.pilcrow}

  Payload Type    Specification
  --------------- ---------------
  MI.UriSigning   RFC 9246

  : [Table 1](#table-1){.selfRef}

::: {#sec.IANA.payload.UriSigning}
::: {#section-6.1.1 .section}
#### [6.1.1.](#section-6.1.1){.section-number .selfRef} [CDNI UriSigning Payload Type](#name-cdni-urisigning-payload-typ){.section-name .selfRef} {#name-cdni-urisigning-payload-typ}

[]{.break}

Purpose:
:   The purpose of this payload type is to distinguish UriSigning
    Metadata interface (MI) objects (and any associated capability
    advertisement).[¶](#section-6.1.1-1.2){.pilcrow}
:   

Interface:
:   MI/FCI[¶](#section-6.1.1-1.4){.pilcrow}
:   

Encoding:
:   see [Section 4.4](#metadata){.xref}[¶](#section-6.1.1-1.6){.pilcrow}
:   
:::
:::
:::
:::

::: {#sec.IANA.logging_record}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [CDNI Logging Record Type](#name-cdni-logging-record-type){.section-name .selfRef} {#name-cdni-logging-record-type}

IANA has registered the following CDNI Logging record-type under the
IANA \"CDNI Logging record-types\"
registry:[¶](#section-6.2-1){.pilcrow}

  record-types           Reference   Description
  ---------------------- ----------- -------------------------------------------------------------------------------------------------------------------
  cdni_http_request_v2   RFC 9246    Extension to CDNI Logging Record version 1 for content delivery using HTTP, to include URI Signing Logging fields

  : [Table 2](#table-2){.selfRef}

::: {#sec.IANA.record_type.cdni_http_request_v2}
::: {#section-6.2.1 .section}
#### [6.2.1.](#section-6.2.1){.section-number .selfRef} [CDNI Logging Record Version 2 for HTTP](#name-cdni-logging-record-version){.section-name .selfRef} {#name-cdni-logging-record-version}

The \"cdni_http_request_v2\" record-type supports all of the fields
supported by the \"cdni_http_request_v1\" record-type
\[[RFC7937](#RFC7937){.xref}\] plus the two additional fields
\"s-uri-signing\" and \"s-uri-signing-deny-reason\", registered by this
document in [Section 6.3](#sec.IANA.fields){.xref}. The name, format,
field value, and occurrence information for the two new fields can be
found in [Section 4.5](#logging){.xref} of this
document.[¶](#section-6.2.1-1){.pilcrow}
:::
:::
:::
:::

::: {#sec.IANA.fields}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [CDNI Logging Field Names](#name-cdni-logging-field-names){.section-name .selfRef} {#name-cdni-logging-field-names}

IANA has registered the following CDNI Logging fields under the IANA
\"CDNI Logging Field Names\" registry:[¶](#section-6.3-1){.pilcrow}

  Field Name                  Reference
  --------------------------- -----------
  s-uri-signing               RFC 9246
  s-uri-signing-deny-reason   RFC 9246

  : [Table 3](#table-3){.selfRef}
:::
:::

::: {#sec.IANA.field.s-uri-signing.values}
::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [CDNI URI Signing Verification Code](#name-cdni-uri-signing-verificati){.section-name .selfRef} {#name-cdni-uri-signing-verificati}

IANA has created a new \"CDNI URI Signing Verification Code\"
subregistry in the \"Content Delivery Networks Interconnection (CDNI)
Parameters\" registry. The \"CDNI URI Signing Verification Code\"
namespace defines the valid values associated with the s-uri-signing
CDNI Logging field. The CDNI URI Signing Verification Code is a 3DIGIT
value as defined in [Section 4.5](#logging){.xref}. Additions to the
CDNI URI Signing Verification Code namespace will conform to the
\"Specification Required\" policy as defined in
\[[RFC8126](#RFC8126){.xref}\]. Updates to this subregistry are expected
to be infrequent.[¶](#section-6.4-1){.pilcrow}

  Value   Reference   Description
  ------- ----------- ----------------------------------------------------------------------------------------------------------------------------------------
  000     RFC 9246    No signed JWT verification performed
  200     RFC 9246    Signed JWT verification performed and verified
  400     RFC 9246    Signed JWT verification performed and rejected because of incorrect signature
  401     RFC 9246    Signed JWT verification performed and rejected because of Issuer enforcement
  402     RFC 9246    Signed JWT verification performed and rejected because of Subject enforcement
  403     RFC 9246    Signed JWT verification performed and rejected because of Audience enforcement
  404     RFC 9246    Signed JWT verification performed and rejected because of Expiration Time enforcement
  405     RFC 9246    Signed JWT verification performed and rejected because of Not Before enforcement
  406     RFC 9246    Signed JWT verification performed and rejected because only one of CDNI Signed Token Transport or CDNI Expiration Time Setting present
  407     RFC 9246    Signed JWT verification performed and rejected because of JWT ID enforcement
  408     RFC 9246    Signed JWT verification performed and rejected because of Version enforcement
  409     RFC 9246    Signed JWT verification performed and rejected because of Critical Extension enforcement
  410     RFC 9246    Signed JWT verification performed and rejected because of Client IP enforcement
  411     RFC 9246    Signed JWT verification performed and rejected because of URI Container enforcement
  500     RFC 9246    Unable to perform signed JWT verification because of malformed URI

  : [Table 4](#table-4){.selfRef}
:::
:::

::: {#sec.IANA.cdnistt}
::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [CDNI URI Signing Signed Token Transport](#name-cdni-uri-signing-signed-tok){.section-name .selfRef} {#name-cdni-uri-signing-signed-tok}

IANA has created a new \"CDNI URI Signing Signed Token Transport\"
subregistry in the \"Content Delivery Networks Interconnection (CDNI)
Parameters\" registry. The \"CDNI URI Signing Signed Token Transport\"
namespace defines the valid values that may be in the Signed Token
Transport (cdnistt) JWT claim. Additions to the Signed Token Transport
namespace conform to the \"Specification Required\" policy as defined in
\[[RFC8126](#RFC8126){.xref}\]. Updates to this subregistry are expected
to be infrequent.[¶](#section-6.5-1){.pilcrow}

The following table defines the initial Enforcement Information
Elements:[¶](#section-6.5-2){.pilcrow}

  Value   Description                                   RFC
  ------- --------------------------------------------- ----------
  0       Designates token transport is not enabled     RFC 9246
  1       Designates token transport via cookie         RFC 9246
  2       Designates token transport via query string   RFC 9246

  : [Table 5](#table-5){.selfRef}
:::
:::

::: {#ClaimsReg}
::: {#section-6.6 .section}
### [6.6.](#section-6.6){.section-number .selfRef} [JSON Web Token Claims Registration](#name-json-web-token-claims-regis){.section-name .selfRef} {#name-json-web-token-claims-regis}

This specification registers the following claims in the IANA \"JSON Web
Token Claims\" registry \[[IANA.JWT.Claims](#IANA.JWT.Claims){.xref}\]
established by
\[[RFC7519](#RFC7519){.xref}\].[¶](#section-6.6-1){.pilcrow}

::: {#ClaimsContents}
::: {#section-6.6.1 .section}
#### [6.6.1.](#section-6.6.1){.section-number .selfRef} [Registry Contents](#name-registry-contents){.section-name .selfRef} {#name-registry-contents}

[]{.break}

Claim Name:
:   `cdniv`[¶](#section-6.6.1-1.2){.pilcrow}
:   

Claim Description:
:   CDNI Claim Set Version[¶](#section-6.6.1-1.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-1.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.8](#cdniv_claim){.xref} of RFC
    9246[¶](#section-6.6.1-1.8){.pilcrow}
:   

[]{.break}

Claim Name:
:   `cdnicrit`[¶](#section-6.6.1-2.2){.pilcrow}
:   

Claim Description:
:   CDNI Critical Claims Set[¶](#section-6.6.1-2.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-2.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.9](#cdnicrit_claim){.xref} of RFC
    9246[¶](#section-6.6.1-2.8){.pilcrow}
:   

[]{.break}

Claim Name:
:   `cdniip`[¶](#section-6.6.1-3.2){.pilcrow}
:   

Claim Description:
:   CDNI IP Address[¶](#section-6.6.1-3.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-3.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.10](#cdniip_claim){.xref} of RFC
    9246[¶](#section-6.6.1-3.8){.pilcrow}
:   

[]{.break}

Claim Name:
:   `cdniuc`[¶](#section-6.6.1-4.2){.pilcrow}
:   

Claim Description:
:   CDNI URI Container[¶](#section-6.6.1-4.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-4.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.11](#cdniuc_claim){.xref} of RFC
    9246[¶](#section-6.6.1-4.8){.pilcrow}
:   

[]{.break}

Claim Name:
:   `cdniets`[¶](#section-6.6.1-5.2){.pilcrow}
:   

Claim Description:
:   CDNI Expiration Time Setting for Signed Token
    Renewal[¶](#section-6.6.1-5.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-5.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.12](#cdniets_claim){.xref} of RFC
    9246[¶](#section-6.6.1-5.8){.pilcrow}
:   

[]{.break}

Claim Name:
:   `cdnistt`[¶](#section-6.6.1-6.2){.pilcrow}
:   

Claim Description:
:   CDNI Signed Token Transport Method for Signed Token
    Renewal[¶](#section-6.6.1-6.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-6.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.13](#cdnistt_claim){.xref} of RFC
    9246[¶](#section-6.6.1-6.8){.pilcrow}
:   

[]{.break}

Claim Name:
:   `cdnistd`[¶](#section-6.6.1-7.2){.pilcrow}
:   

Claim Description:
:   CDNI Signed Token Depth[¶](#section-6.6.1-7.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.6.1-7.6){.pilcrow}
:   

Specification Document(s):
:   [Section 2.1.14](#cdnistd_claim){.xref} of RFC
    9246[¶](#section-6.6.1-7.8){.pilcrow}
:   
:::
:::
:::
:::

::: {#expertreview}
::: {#section-6.7 .section}
### [6.7.](#section-6.7){.section-number .selfRef} [Expert Review Guidance](#name-expert-review-guidance){.section-name .selfRef} {#name-expert-review-guidance}

Generally speaking, we should determine the registration has a rational
justification and does not duplicate a previous registration. Early
assignment should be permissible as long as there is a reasonable
expectation that the specification will become formalized. Expert
Reviewers should be empowered to make determinations, but generally
speaking they should allow new claims that do not otherwise introduce
conflicts with implementation or things that may lead to confusion. They
should also follow the guidelines of [Section
5](https://www.rfc-editor.org/rfc/rfc8126#section-5){.relref} of
\[[RFC8126](#RFC8126){.xref}\] when
sensible.[¶](#section-6.7-1){.pilcrow}
:::
:::
:::
:::

::: {#security}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document describes the concept of URI Signing and how it can be
used to provide access authorization in the case of CDNI. The primary
goal of URI Signing is to make sure that only authorized UAs are able to
access the content, with a CSP being able to authorize every individual
request. It should be noted that URI Signing is not a content protection
scheme; if a CSP wants to protect the content itself, other mechanisms,
such as DRM, are more appropriate.[¶](#section-7-1){.pilcrow}

CDNI URI Signing Signed Tokens leverage JSON Web Tokens and thus,
guidelines in \[[RFC8725](#RFC8725){.xref}\] are applicable for all JWT
interactions.[¶](#section-7-2){.pilcrow}

In general, it holds that the level of protection against illegitimate
access can be increased by including more claims in the signed JWT. The
current version of this document includes claims for enforcing Issuer,
Client IP Address, Not Before time, and Expiration Time; however, this
list can be extended with other more complex attributes that are able to
provide some form of protection against some of the vulnerabilities
highlighted below.[¶](#section-7-3){.pilcrow}

That said, there are a number of aspects that limit the level of
security offered by URI Signing and that anybody implementing URI
Signing should be aware of.[¶](#section-7-4){.pilcrow}

[]{.break}

Replay attacks:
:   A (valid) Signed URI may be used to perform replay attacks. The
    vulnerability to replay attacks can be reduced by picking a
    relatively short window between the Not Before time and Expiration
    Time attributes, although this is limited by the fact that any
    HTTP-based request needs a window of at least a couple of seconds to
    prevent sudden network issues from denying legitimate UAs access to
    the content. One may also reduce exposure to replay attacks by
    including a unique one-time access ID via the JWT ID attribute (jti
    claim). Whenever the dCDN receives a request with a given unique ID,
    it adds that ID to the list of \'used\' IDs. In the case an
    illegitimate UA tries to use the same URI through a replay attack,
    the dCDN can deny the request based on the already used access ID.
    This list should be kept bounded. A reasonable approach would be to
    expire the entries based on the exp claim value. If no exp claim is
    present, then a simple Least Recently Used (LRU) cache could be
    used; however, this would allow values to eventually be
    reused.[¶](#section-7-5.2){.pilcrow}
:   

Illegitimate clients behind a NAT:
:   In cases where there are multiple users behind the same NAT, all
    users will have the same IP address from the point of view of the
    dCDN. This results in the dCDN not being able to distinguish between
    different users based on Client IP Address, which can lead to
    illegitimate users being able to access the content. One way to
    reduce exposure to this kind of attack is to not only check for
    Client IP but also for other attributes, e.g., attributes that can
    be found in HTTP headers. However, this may be easily circumvented
    by a sophisticated attacker.[¶](#section-7-5.4){.pilcrow}
:   

A shared key distributed between CSP and uCDN is more likely to be
compromised. Since this key can be used to legitimately sign a URL for
content access authorization, it is important to know the implications
of a compromised shared key. While using a shared key scheme can be
convenient, this architecture is [NOT RECOMMENDED]{.bcp14} due to the
risks associated. It is included for legacy feature parity and is highly
discouraged in new implementations.[¶](#section-7-6){.pilcrow}

If a shared key usable for signing is compromised, an attacker can use
it to perform a denial-of-service attack by forcing the CDN to evaluate
prohibitively expensive regular expressions embedded in a URI Container
(cdniuc) claim. As a result, compromised keys should be timely revoked
in order to prevent exploitation.[¶](#section-7-7){.pilcrow}

The URI Container (cdniuc) claim can be given a wildcard value. This,
combined with the fact that it is the only mandatory claim, means you
can effectively make a skeleton key. Doing this does not sufficiently
limit the scope of the JWT and is [NOT RECOMMENDED]{.bcp14}. The only
way to prevent such a key from being used after it is distributed is to
revoke the signing key so it no longer
validates.[¶](#section-7-8){.pilcrow}
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Privacy](#name-privacy){.section-name .selfRef} {#name-privacy}

The privacy protection concerns described in \"[Content Distribution
Network Interconnection (CDNI) Logging Interface](#RFC7937){.xref}\"
\[[RFC7937](#RFC7937){.xref}\] apply when the client\'s IP address
(cdniip) or Subject (sub) is embedded in the Signed URI. For this
reason, the mechanism described in [Section 2](#jwt_profile){.xref}
encrypts the Client IP or Subject before including it in the URI Signing
Package (and thus the URL itself).[¶](#section-8-1){.pilcrow}
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[POSIX.1\]
:   [The Open Group]{.refAuthor}, [\"IEEE Standard for Information
    Technology \-- Portable Operating System Interface (POSIX(TM)) Base
    Specifications, Issue 7\"]{.refTitle}, [(Revision of IEEE Std
    1003.1-2008) ]{.refContent}, [IEEE Std 1003.1-2017]{.seriesInfo},
    January 2018,
    \<<https://pubs.opengroup.org/onlinepubs/9699919799/>\>.
:   

\[RFC0791\]
:   [Postel, J.]{.refAuthor}, [\"Internet Protocol\"]{.refTitle}, [STD
    5]{.seriesInfo}, [RFC 791]{.seriesInfo}, [DOI
    10.17487/RFC0791]{.seriesInfo}, September 1981,
    \<<https://www.rfc-editor.org/info/rfc791>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3986\]
:   [Berners-Lee, T.]{.refAuthor}, [Fielding, R.]{.refAuthor}, and [L.
    Masinter]{.refAuthor}, [\"Uniform Resource Identifier (URI): Generic
    Syntax\"]{.refTitle}, [STD 66]{.seriesInfo}, [RFC
    3986]{.seriesInfo}, [DOI 10.17487/RFC3986]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3986>\>.
:   

\[RFC5905\]
:   [Mills, D.]{.refAuthor}, [Martin, J., Ed.]{.refAuthor},
    [Burbank, J.]{.refAuthor}, and [W. Kasch]{.refAuthor}, [\"Network
    Time Protocol Version 4: Protocol and Algorithms
    Specification\"]{.refTitle}, [RFC 5905]{.seriesInfo}, [DOI
    10.17487/RFC5905]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5905>\>.
:   

\[RFC5952\]
:   [Kawamura, S.]{.refAuthor} and [M. Kawashima]{.refAuthor}, [\"A
    Recommendation for IPv6 Address Text Representation\"]{.refTitle},
    [RFC 5952]{.seriesInfo}, [DOI 10.17487/RFC5952]{.seriesInfo}, August
    2010, \<<https://www.rfc-editor.org/info/rfc5952>\>.
:   

\[RFC6265\]
:   [Barth, A.]{.refAuthor}, [\"HTTP State Management
    Mechanism\"]{.refTitle}, [RFC 6265]{.seriesInfo}, [DOI
    10.17487/RFC6265]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6265>\>.
:   

\[RFC6570\]
:   [Gregorio, J.]{.refAuthor}, [Fielding, R.]{.refAuthor},
    [Hadley, M.]{.refAuthor}, [Nottingham, M.]{.refAuthor}, and [D.
    Orchard]{.refAuthor}, [\"URI Template\"]{.refTitle}, [RFC
    6570]{.seriesInfo}, [DOI 10.17487/RFC6570]{.seriesInfo}, March 2012,
    \<<https://www.rfc-editor.org/info/rfc6570>\>.
:   

\[RFC6707\]
:   [Niven-Jenkins, B.]{.refAuthor}, [Le Faucheur, F.]{.refAuthor}, and
    [N. Bitar]{.refAuthor}, [\"Content Distribution Network
    Interconnection (CDNI) Problem Statement\"]{.refTitle}, [RFC
    6707]{.seriesInfo}, [DOI 10.17487/RFC6707]{.seriesInfo}, September
    2012, \<<https://www.rfc-editor.org/info/rfc6707>\>.
:   

\[RFC6920\]
:   [Farrell, S.]{.refAuthor}, [Kutscher, D.]{.refAuthor},
    [Dannewitz, C.]{.refAuthor}, [Ohlman, B.]{.refAuthor},
    [Keranen, A.]{.refAuthor}, and [P. Hallam-Baker]{.refAuthor},
    [\"Naming Things with Hashes\"]{.refTitle}, [RFC 6920]{.seriesInfo},
    [DOI 10.17487/RFC6920]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6920>\>.
:   

\[RFC7230\]
:   [Fielding, R., Ed.]{.refAuthor} and [J. Reschke, Ed.]{.refAuthor},
    [\"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and
    Routing\"]{.refTitle}, [RFC 7230]{.seriesInfo}, [DOI
    10.17487/RFC7230]{.seriesInfo}, June 2014,
    \<<https://www.rfc-editor.org/info/rfc7230>\>.
:   

\[RFC7516\]
:   [Jones, M.]{.refAuthor} and [J. Hildebrand]{.refAuthor}, [\"JSON Web
    Encryption (JWE)\"]{.refTitle}, [RFC 7516]{.seriesInfo}, [DOI
    10.17487/RFC7516]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7516>\>.
:   

\[RFC7519\]
:   [Jones, M.]{.refAuthor}, [Bradley, J.]{.refAuthor}, and [N.
    Sakimura]{.refAuthor}, [\"JSON Web Token (JWT)\"]{.refTitle}, [RFC
    7519]{.seriesInfo}, [DOI 10.17487/RFC7519]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7519>\>.
:   

\[RFC7937\]
:   [Le Faucheur, F., Ed.]{.refAuthor}, [Bertrand, G., Ed.]{.refAuthor},
    [Oprescu, I., Ed.]{.refAuthor}, and [R. Peterkofsky]{.refAuthor},
    [\"Content Distribution Network Interconnection (CDNI) Logging
    Interface\"]{.refTitle}, [RFC 7937]{.seriesInfo}, [DOI
    10.17487/RFC7937]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7937>\>.
:   

\[RFC8006\]
:   [Niven-Jenkins, B.]{.refAuthor}, [Murray, R.]{.refAuthor},
    [Caulfield, M.]{.refAuthor}, and [K. Ma]{.refAuthor}, [\"Content
    Delivery Network Interconnection (CDNI) Metadata\"]{.refTitle}, [RFC
    8006]{.seriesInfo}, [DOI 10.17487/RFC8006]{.seriesInfo}, December
    2016, \<<https://www.rfc-editor.org/info/rfc8006>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8259\]
:   [Bray, T., Ed.]{.refAuthor}, [\"The JavaScript Object Notation
    (JSON) Data Interchange Format\"]{.refTitle}, [STD 90]{.seriesInfo},
    [RFC 8259]{.seriesInfo}, [DOI 10.17487/RFC8259]{.seriesInfo},
    December 2017, \<<https://www.rfc-editor.org/info/rfc8259>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[IANA.JWT.Claims\]
:   [IANA]{.refAuthor}, [\"JSON Web Token (JWT)\"]{.refTitle},
    \<<https://www.iana.org/assignments/jwt>\>.
:   

\[MPEG-DASH\]
:   [ISO]{.refAuthor}, [\"Information technology \-- Dynamic adaptive
    streaming over HTTP (DASH) \-- Part 1: Media presentation
    description and segment formats\"]{.refTitle}, [ISO/IEC
    23009-1:2019]{.seriesInfo}, [Edition 4]{.seriesInfo}, December 2019,
    \<<https://www.iso.org/standard/79329.html>\>.
:   

\[RFC6983\]
:   [van Brandenburg, R.]{.refAuthor}, [van Deventer, O.]{.refAuthor},
    [Le Faucheur, F.]{.refAuthor}, and [K. Leung]{.refAuthor}, [\"Models
    for HTTP-Adaptive-Streaming-Aware Content Distribution Network
    Interconnection (CDNI)\"]{.refTitle}, [RFC 6983]{.seriesInfo}, [DOI
    10.17487/RFC6983]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6983>\>.
:   

\[RFC7336\]
:   [Peterson, L.]{.refAuthor}, [Davie, B.]{.refAuthor}, and [R. van
    Brandenburg, Ed.]{.refAuthor}, [\"Framework for Content Distribution
    Network Interconnection (CDNI)\"]{.refTitle}, [RFC
    7336]{.seriesInfo}, [DOI 10.17487/RFC7336]{.seriesInfo}, August
    2014, \<<https://www.rfc-editor.org/info/rfc7336>\>.
:   

\[RFC7337\]
:   [Leung, K., Ed.]{.refAuthor} and [Y. Lee, Ed.]{.refAuthor},
    [\"Content Distribution Network Interconnection (CDNI)
    Requirements\"]{.refTitle}, [RFC 7337]{.seriesInfo}, [DOI
    10.17487/RFC7337]{.seriesInfo}, August 2014,
    \<<https://www.rfc-editor.org/info/rfc7337>\>.
:   

\[RFC7517\]
:   [Jones, M.]{.refAuthor}, [\"JSON Web Key (JWK)\"]{.refTitle}, [RFC
    7517]{.seriesInfo}, [DOI 10.17487/RFC7517]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7517>\>.
:   

\[RFC7975\]
:   [Niven-Jenkins, B., Ed.]{.refAuthor} and [R. van Brandenburg,
    Ed.]{.refAuthor}, [\"Request Routing Redirection Interface for
    Content Delivery Network (CDN) Interconnection\"]{.refTitle}, [RFC
    7975]{.seriesInfo}, [DOI 10.17487/RFC7975]{.seriesInfo}, October
    2016, \<<https://www.rfc-editor.org/info/rfc7975>\>.
:   

\[RFC8008\]
:   [Seedorf, J.]{.refAuthor}, [Peterson, J.]{.refAuthor},
    [Previdi, S.]{.refAuthor}, [van Brandenburg, R.]{.refAuthor}, and
    [K. Ma]{.refAuthor}, [\"Content Delivery Network Interconnection
    (CDNI) Request Routing: Footprint and Capabilities
    Semantics\"]{.refTitle}, [RFC 8008]{.seriesInfo}, [DOI
    10.17487/RFC8008]{.seriesInfo}, December 2016,
    \<<https://www.rfc-editor.org/info/rfc8008>\>.
:   

\[RFC8216\]
:   [Pantos, R., Ed.]{.refAuthor} and [W. May]{.refAuthor}, [\"HTTP Live
    Streaming\"]{.refTitle}, [RFC 8216]{.seriesInfo}, [DOI
    10.17487/RFC8216]{.seriesInfo}, August 2017,
    \<<https://www.rfc-editor.org/info/rfc8216>\>.
:   

\[RFC8725\]
:   [Sheffer, Y.]{.refAuthor}, [Hardt, D.]{.refAuthor}, and [M.
    Jones]{.refAuthor}, [\"JSON Web Token Best Current
    Practices\"]{.refTitle}, [BCP 225]{.seriesInfo}, [RFC
    8725]{.seriesInfo}, [DOI 10.17487/RFC8725]{.seriesInfo}, February
    2020, \<<https://www.rfc-editor.org/info/rfc8725>\>.
:   
:::
:::

::: {#sup_example}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Signed URI Package Example](#name-signed-uri-package-example){.section-name .selfRef} {#name-signed-uri-package-example}

This section contains three examples of token usage: a simple example
with only the required claim present, a complex example that
demonstrates the full JWT claims set, including an encrypted Client IP
Address (cdniip), and one that uses a Signed Token
Renewal.[¶](#appendix-A-1){.pilcrow}

Note: All of the examples have empty space added to improve formatting
and readability, but are not present in the generated
content.[¶](#appendix-A-2){.pilcrow}

All examples use the following JWK Set
\[[RFC7517](#RFC7517){.xref}\]:[¶](#appendix-A-3){.pilcrow}

::: {#appendix-A-4}
``` {.lang-json .sourcecode}
{ "keys": [
  {
    "kty": "EC",
    "kid": "P5UpOv0eMq1wcxLf7WxIg09JdSYGYFDOWkldueaImf0",
    "use": "sig",
    "alg": "ES256",
    "crv": "P-256",
    "x": "be807S4O7dzB6I4hTiCUvmxCI6FuxWba1xYBlLSSsZ8",
    "y": "rOGC4vI69g-WF9AGEVI37sNNwbjIzBxSjLvIL7f3RBA"
  },
  {
    "kty": "EC",
    "kid": "P5UpOv0eMq1wcxLf7WxIg09JdSYGYFDOWkldueaImf0",
    "use": "sig",
    "alg": "ES256",
    "crv": "P-256",
    "x": "be807S4O7dzB6I4hTiCUvmxCI6FuxWba1xYBlLSSsZ8",
    "y": "rOGC4vI69g-WF9AGEVI37sNNwbjIzBxSjLvIL7f3RBA",
    "d": "yaowezrCLTU6yIwUL5RQw67cHgvZeMTLVZXjUGb1A1M"
  },
  {
    "kty": "oct",
    "kid": "f-WbjxBC3dPuI3d24kP2hfvos7Qz688UTi6aB0hN998",
    "use": "enc",
    "alg": "A128GCM",
    "k": "4uFxxV7fhNmrtiah2d1fFg"
  }
]}
```

[¶](#appendix-A-4){.pilcrow}
:::

Note: They are the public signing key, the private signing key, and the
shared secret encryption key, respectively. The public and private
signing keys have the same fingerprint and only vary by the \'d\'
parameter that is missing from the public signing
key.[¶](#appendix-A-5){.pilcrow}

::: {#simple_example}
::: {#appendix-A.1 .section}
### [A.1.](#appendix-A.1){.section-number .selfRef} [Simple Example](#name-simple-example){.section-name .selfRef} {#name-simple-example}

This example is a simple common usage example containing a minimal
subset of claims that the authors find most
useful.[¶](#appendix-A.1-1){.pilcrow}

The JWT Claim Set before signing:[¶](#appendix-A.1-2){.pilcrow}

Note: \"sha-256;2tderfWPa86Ku7YnzW51YUp7dGUjBS_3SW3ELx4hmWY\" is the URL
Segment form ([Section
5](https://www.rfc-editor.org/rfc/rfc6920#section-5){.relref} of
\[[RFC6920](#RFC6920){.xref}\]) of
\"http://cdni.example/foo/bar\".[¶](#appendix-A.1-3){.pilcrow}

::: {#appendix-A.1-4}
``` {.lang-json .sourcecode}
{
  "exp": 1646867369,
  "iss": "uCDN Inc",
  "cdniuc":
    "hash:sha-256;2tderfWPa86Ku7YnzW51YUp7dGUjBS_3SW3ELx4hmWY"
}
```

[¶](#appendix-A.1-4){.pilcrow}
:::

The signed JWT:[¶](#appendix-A.1-5){.pilcrow}

::: {#appendix-A.1-6}
``` sourcecode
eyJhbGciOiJFUzI1NiIsImtpZCI6IlA1VXBPdjBlTXExd2N4TGY3V3hJZzA5SmRTWU
dZRkRPV2tsZHVlYUltZjAifQ.eyJleHAiOjE2NDY4NjczNjksImlzcyI6InVDRE4gS
W5jIiwiY2RuaXVjIjoiaGFzaDpzaGEtMjU2OzJ0ZGVyZldQYTg2S3U3WW56VzUxWVV
wN2RHVWpCU18zU1czRUx4NGhtV1kifQ.TaNlJM3D96i_9J9XvlICO6FUIDFTqt3E2Y
JkEUOLfcH0b89wYRKTbJ9Yj6h_GRgSoZoQO0cps3yUPcWGK3smCw
```

[¶](#appendix-A.1-6){.pilcrow}
:::
:::
:::

::: {#complex_example}
::: {#appendix-A.2 .section}
### [A.2.](#appendix-A.2){.section-number .selfRef} [Complex Example](#name-complex-example){.section-name .selfRef} {#name-complex-example}

This example uses all fields except for those dealing with Signed Token
Renewal, including Client IP Address (cdniip) and Subject (sub), which
are encrypted. This significantly increases the size of the signed JWT
token.[¶](#appendix-A.2-1){.pilcrow}

JWE for Client IP Address (cdniip) of
\[2001:db8::1/32\]:[¶](#appendix-A.2-2){.pilcrow}

::: {#appendix-A.2-3}
``` sourcecode
eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIiwia2lkIjoiZi1XYmp4QkMzZFB1ST
NkMjRrUDJoZnZvczdRejY4OFVUaTZhQjBoTjk5OCJ9..aUDDFEQBIc3nWjOb.bGXWT
HPkntmPCKn0pPPNEQ.iyTttnFybO2YBLqwl_YSjA
```

[¶](#appendix-A.2-3){.pilcrow}
:::

JWE for Subject (sub) of \"UserToken\":[¶](#appendix-A.2-4){.pilcrow}

::: {#appendix-A.2-5}
``` sourcecode
eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIiwia2lkIjoiZi1XYmp4QkMzZFB1ST
NkMjRrUDJoZnZvczdRejY4OFVUaTZhQjBoTjk5OCJ9..CLAu80xclc8Bp-Ui.6P1A3
F6ip2Dv.CohdtLLpgBnTvRJQCFuz-g
```

[¶](#appendix-A.2-5){.pilcrow}
:::

The JWT Claim Set before signing:[¶](#appendix-A.2-6){.pilcrow}

::: {#appendix-A.2-7}
``` {.lang-json .sourcecode}
{
  "aud": "dCDN LLC",
  "sub": "eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIiwia2lkIjoiZi1XYmp4
QkMzZFB1STNkMjRrUDJoZnZvczdRejY4OFVUaTZhQjBoTjk5OCJ9..CLAu80xclc8B
p-Ui.6P1A3F6ip2Dv.CohdtLLpgBnTvRJQCFuz-g",
  "cdniip": "eyJlbmMiOiJBMTI4R0NNIiwiYWxnIjoiZGlyIiwia2lkIjoiZi1XY
mp4QkMzZFB1STNkMjRrUDJoZnZvczdRejY4OFVUaTZhQjBoTjk5OCJ9..aUDDFEQBI
c3nWjOb.bGXWTHPkntmPCKn0pPPNEQ.iyTttnFybO2YBLqwl_YSjA",
  "cdniv": 1,
  "exp": 1646867369,
  "iat": 1646694569,
  "iss": "uCDN Inc",
  "jti": "5DAafLhZAfhsbe",
  "nbf": 1646780969,
  "cdniuc": "regex:http://cdni\\.example/foo/bar/[0-9]{3}\\.png"
}
```

[¶](#appendix-A.2-7){.pilcrow}
:::

The signed JWT:[¶](#appendix-A.2-8){.pilcrow}

::: {#appendix-A.2-9}
``` sourcecode
eyJhbGciOiJFUzI1NiIsImtpZCI6IlA1VXBPdjBlTXExd2N4TGY3V3hJZzA5SmRTWU
dZRkRPV2tsZHVlYUltZjAifQ.eyJhdWQiOiJkQ0ROIExMQyIsInN1YiI6ImV5Smxib
U1pT2lKQk1USTRSME5OSWl3aVlXeG5Jam9pWkdseUlpd2lhMmxrSWpvaVppMVhZbXA
0UWtNelpGQjFTVE5rTWpSclVESm9ablp2Y3pkUmVqWTRPRlZVYVRaaFFqQm9Uams1T
0NKOS4uQ0xBdTgweGNsYzhCcC1VaS42UDFBM0Y2aXAyRHYuQ29oZHRMTHBnQm5UdlJ
KUUNGdXotZyIsImNkbmlpcCI6ImV5SmxibU1pT2lKQk1USTRSME5OSWl3aVlXeG5Ja
m9pWkdseUlpd2lhMmxrSWpvaVppMVhZbXA0UWtNelpGQjFTVE5rTWpSclVESm9ablp
2Y3pkUmVqWTRPRlZVYVRaaFFqQm9Uams1T0NKOS4uYVVEREZFUUJJYzNuV2pPYi5iR
1hXVEhQa250bVBDS24wcFBQTkVRLml5VHR0bkZ5Yk8yWUJMcXdsX1lTakEiLCJjZG5
pdiI6MSwiZXhwIjoxNjQ2ODY3MzY5LCJpYXQiOjE2NDY2OTQ1NjksImlzcyI6InVDR
E4gSW5jIiwianRpIjoiNURBYWZMaFpBZmhzYmUiLCJuYmYiOjE2NDY3ODA5NjksImN
kbml1YyI6InJlZ2V4Omh0dHA6Ly9jZG5pXFwuZXhhbXBsZS9mb28vYmFyL1swLTlde
zN9XFwucG5nIn0.IjmVX0uD5MYqArc-M08uEsEeoDQn8kuYXZ9HGHDmDDxsHikT0c8
jcX8xYD0z3LzQclMG65i1kT2sRbZ7isUw8w
```

[¶](#appendix-A.2-9){.pilcrow}
:::
:::
:::

::: {#token_renewal_example}
::: {#appendix-A.3 .section}
### [A.3.](#appendix-A.3){.section-number .selfRef} [Signed Token Renewal Example](#name-signed-token-renewal-exampl){.section-name .selfRef} {#name-signed-token-renewal-exampl}

This example uses fields for Signed Token
Renewal.[¶](#appendix-A.3-1){.pilcrow}

The JWT Claim Set before signing:[¶](#appendix-A.3-2){.pilcrow}

::: {#appendix-A.3-3}
``` {.lang-json .sourcecode}
{
  "cdniets": 30,
  "cdnistt": 1,
  "cdnistd": 2,
  "exp": 1646867369,
  "cdniuc": "regex:http://cdni\\.example/foo/bar/[0-9]{3}\\.ts"
}
```

[¶](#appendix-A.3-3){.pilcrow}
:::

The signed JWT:[¶](#appendix-A.3-4){.pilcrow}

::: {#appendix-A.3-5}
``` sourcecode
eyJhbGciOiJFUzI1NiIsImtpZCI6IlA1VXBPdjBlTXExd2N4TGY3V3hJZzA5SmRTWU
dZRkRPV2tsZHVlYUltZjAifQ.eyJjZG5pZXRzIjozMCwiY2RuaXN0dCI6MSwiY2Rua
XN0ZCI6MiwiZXhwIjoxNjQ2ODY3MzY5LCJjZG5pdWMiOiJyZWdleDpodHRwOi8vY2R
uaVxcLmV4YW1wbGUvZm9vL2Jhci9bMC05XXszfVxcLnRzIn0.tlPvoKw3BCClw4Lx9
PQu7MK6b2IN55ZoCPSaxovGK0zS53Wpb1MbJBow7G8LiGR39h6-2Iq7PWUSr3MdTIz
HYw
```

[¶](#appendix-A.3-5){.pilcrow}
:::

Once the server verifies the signed JWT it will return a new signed JWT
with an updated Expiry Time (exp) as shown below. Note the Expiry Time
is increased by the expiration time setting (cdniets)
value.[¶](#appendix-A.3-6){.pilcrow}

The JWT Claim Set before signing:[¶](#appendix-A.3-7){.pilcrow}

::: {#appendix-A.3-8}
``` {.lang-json .sourcecode}
{
  "cdniets": 30,
  "cdnistt": 1,
  "cdnistd": 2,
  "exp": 1646867399,
  "cdniuc": "regex:http://cdni\\.example/foo/bar/[0-9]{3}\\.ts"
}
```

[¶](#appendix-A.3-8){.pilcrow}
:::

The signed JWT:[¶](#appendix-A.3-9){.pilcrow}

::: {#appendix-A.3-10}
``` sourcecode
eyJhbGciOiJFUzI1NiIsImtpZCI6IlA1VXBPdjBlTXExd2N4TGY3V3hJZzA5SmRTWU
dZRkRPV2tsZHVlYUltZjAifQ.eyJjZG5pZXRzIjozMCwiY2RuaXN0dCI6MSwiY2Rua
XN0ZCI6MiwiZXhwIjoxNjQ2ODY3Mzk5LCJjZG5pdWMiOiJyZWdleDpodHRwOi8vY2R
uaVxcLmV4YW1wbGUvZm9vL2Jhci9bMC05XXszfVxcLnRzIn0.ivY5d_fKGd-OHTpUs
8uJUrnHvt-rduzu5H4zM7167pUUAghub53FqDQ5G16jRYX2sY73mA_uLpYDdb-CPts
8FA
```

[¶](#appendix-A.3-10){.pilcrow}
:::
:::
:::
:::
:::

::: {#appendix-B .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The authors would like to thank the following people for their
contributions in reviewing this document and providing feedback: [Scott
Leibrand]{.contact-name}, [Kevin Ma]{.contact-name}, [Ben
Niven-Jenkins]{.contact-name}, [Thierry Magnien]{.contact-name}, [Dan
York]{.contact-name}, [Bhaskar Bhupalam]{.contact-name}, [Matt
Caulfield]{.contact-name}, [Samuel Rajakumar]{.contact-name}, [Iuniana
Oprescu]{.contact-name}, [Leif Hedstrom]{.contact-name}, [Gancho
Tenev]{.contact-name}, [Brian Campbell]{.contact-name}, and [Chris
Lemmons]{.contact-name}.[¶](#appendix-B-1){.pilcrow}
:::

::: {#appendix-C .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

In addition, the authors would also like to make special mentions for
certain people who contributed significant sections to this
document.[¶](#appendix-C-1){.pilcrow}

-   ::: {#appendix-C-2.1}
    [Matt Caulfield]{.contact-name} provided content for [Section
    4.4](#metadata){.xref}, \"CDNI Metadata
    Interface\".[¶](#appendix-C-2.1.1){.pilcrow}
    :::

-   ::: {#appendix-C-2.2}
    [Emmanuel Thomas]{.contact-name} provided content for HTTP Adaptive
    Streaming.[¶](#appendix-C-2.2.1){.pilcrow}
    :::

-   ::: {#appendix-C-2.3}
    [Matt Miller]{.contact-name} provided consultation on JWT usage as
    well as code to generate working JWT
    examples.[¶](#appendix-C-2.3.1){.pilcrow}
    :::
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Ray van Brandenburg]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Tiledmedia]{.org}
:::

::: {.left dir="auto"}
[Anna van Buerenplein 1]{.street-address}
:::

::: {.left dir="auto"}
[2595DA]{.postal-code} [Den Haag]{.locality}
:::

::: {.left dir="auto"}
[Netherlands]{.country-name}
:::

::: tel
Phone: [+31 88 866 7000](tel:+31%2088%20866%207000){.tel}
:::

::: email
Email: <ray@tiledmedia.com>
:::

::: {.left dir="auto"}
[Kent Leung]{.fn .nameRole}
:::

::: email
Email: <mail4kentl@gmail.com>
:::

::: {.left dir="auto"}
[Phil Sorber]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Apple, Inc.]{.org}
:::

::: {.left dir="auto"}
[Suite 410]{.extended-address}
:::

::: {.left dir="auto"}
[1800 Wazee Street]{.street-address}
:::

::: {.left dir="auto"}
[Denver]{.locality}, [CO]{.region} [80202]{.postal-code}
:::

::: {.left dir="auto"}
[United States]{.country-name}
:::

::: email
Email: <sorber@apple.com>
:::
:::
:::
