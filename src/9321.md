  RFC 9321              Signature Validation Token   October 2022
  --------------------- ---------------------------- --------------
  Santesson & Housley   Informational                \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [9321](https://www.rfc-editor.org/rfc/rfc9321){.eref}

Category:
:   Informational

Published:
:   October 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    S. Santesson
    :::

    ::: org
    IDsec Solutions
    :::
    :::

    ::: author
    ::: author-name
    R. Housley
    :::

    ::: org
    Vigil Security
    :::
    :::
:::

# RFC 9321 {#rfcnum}

# Signature Validation Token {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

Electronic signatures have a limited lifespan with respect to the time
period that they can be validated and determined to be authentic. The
Signature Validation Token (SVT) defined in this specification provides
evidence that asserts the validity of an electronic signature. The SVT
is provided by a trusted authority, which asserts that a particular
signature was successfully validated according to defined procedures at
a certain time. Any future validation of that electronic signature can
be satisfied by validating the SVT without any need to also validate the
original electronic signature or the associated digital certificates.
The SVT supports electronic signatures in Cryptographic Message Syntax
(CMS), XML, PDF, and JSON documents.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9321>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.auto .internal
    .xref}.  [Introduction](#name-introduction){.internal .xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.auto .internal
    .xref}.  [Definitions](#name-definitions){.internal .xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.auto .internal .xref}.  [Signature Validation
    Token](#name-signature-validation-token){.internal .xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.auto .internal .xref}.  [Signature
        Validation Token
        Function](#name-signature-validation-token-){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.auto .internal .xref}.  [Signature
        Validation Token
        Syntax](#name-signature-validation-token-s){.internal .xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.auto .internal .xref}.  [Data
            Types](#name-data-types){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.auto .internal .xref}.  [Signature
            Validation Token JWT
            Claims](#name-signature-validation-token-j){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.3}
            [3.2.3](#section-3.2.3){.auto .internal
            .xref}.  [SigValidation Object
            Class](#name-sigvalidation-object-class){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.4}
            [3.2.4](#section-3.2.4){.auto .internal .xref}.  [Signature
            Claims Object
            Class](#name-signature-claims-object-cla){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.5}
            [3.2.5](#section-3.2.5){.auto .internal
            .xref}.  [SigReference Claims Object
            Class](#name-sigreference-claims-object-){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.6}
            [3.2.6](#section-3.2.6){.auto .internal
            .xref}.  [SignedDataReference Claims Object
            Class](#name-signeddatareference-claims-){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.7}
            [3.2.7](#section-3.2.7){.auto .internal
            .xref}.  [PolicyValidation Claims Object
            Class](#name-policyvalidation-claims-obj){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.8}
            [3.2.8](#section-3.2.8){.auto .internal
            .xref}.  [TimeValidation Claims Object
            Class](#name-timevalidation-claims-objec){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.9}
            [3.2.9](#section-3.2.9){.auto .internal
            .xref}.  [CertReference Claims Object
            Class](#name-certreference-claims-object){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.10}
            [3.2.10](#section-3.2.10){.auto .internal .xref}. [SVT JOSE
            Header](#name-svt-jose-header){.internal .xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.auto .internal
    .xref}.  [Profiles](#name-profiles){.internal .xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.auto .internal .xref}.  [Defined
        Profiles](#name-defined-profiles){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.auto .internal .xref}.  [Signature Verification
    with an SVT](#name-signature-verification-with){.internal .xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.auto .internal .xref}.  [IANA
    Considerations](#name-iana-considerations){.internal .xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.auto .internal .xref}.  [Claim Names
        Registration](#name-claim-names-registration){.internal .xref}

        -   ::: {#section-toc.1-1.6.2.1.2.1}
            [6.1.1](#section-6.1.1){.auto .internal .xref}.  [Registry
            Contents](#name-registry-contents){.internal .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.auto .internal .xref}.  [Header Parameter
        Names Registration](#name-header-parameter-names-regi){.internal
        .xref}

        -   ::: {#section-toc.1-1.6.2.2.2.1}
            [6.2.1](#section-6.2.1){.auto .internal .xref}.  [Registry
            Contents](#name-registry-contents-2){.internal .xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.auto .internal .xref}.  [Security
    Considerations](#name-security-considerations){.internal .xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.auto .internal .xref}.  [Level of
        Reliance](#name-level-of-reliance){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.auto .internal .xref}.  [Aging
        Algorithms](#name-aging-algorithms){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.auto .internal
    .xref}.  [References](#name-references){.internal .xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.auto .internal .xref}.  [Normative
        References](#name-normative-references){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.auto .internal .xref}.  [Informative
        References](#name-informative-references){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [Appendix A](#appendix-A){.auto .internal .xref}.  [XML Signature
    Profile](#name-xml-signature-profile){.internal .xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [A.1](#appendix-A.1){.auto .internal
        .xref}.  [Notation](#name-notation){.internal .xref}

        -   ::: {#section-toc.1-1.9.2.1.2.1}
            [A.1.1](#appendix-A.1.1){.auto .internal
            .xref}.  [References to XML Elements from XML
            Schemas](#name-references-to-xml-elements-){.internal .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [A.2](#appendix-A.2){.auto .internal .xref}.  [SVT in XML
        Documents](#name-svt-in-xml-documents){.internal .xref}

        -   ::: {#section-toc.1-1.9.2.2.2.1}
            [A.2.1](#appendix-A.2.1){.auto .internal
            .xref}.  [SignatureValidationToken Signature
            Property](#name-signaturevalidationtoken-si){.internal
            .xref}
            :::

        -   ::: {#section-toc.1-1.9.2.2.2.2}
            [A.2.2](#appendix-A.2.2){.auto .internal .xref}.  [Multiple
            SVTs in an XML
            Signature](#name-multiple-svts-in-an-xml-sig){.internal
            .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [A.3](#appendix-A.3){.auto .internal .xref}.  [XML Signature SVT
        Claims](#name-xml-signature-svt-claims){.internal .xref}

        -   ::: {#section-toc.1-1.9.2.3.2.1}
            [A.3.1](#appendix-A.3.1){.auto .internal .xref}.  [XML
            Profile Identifier](#name-xml-profile-identifier){.internal
            .xref}
            :::

        -   ::: {#section-toc.1-1.9.2.3.2.2}
            [A.3.2](#appendix-A.3.2){.auto .internal .xref}.  [XML
            Signature Reference
            Data](#name-xml-signature-reference-dat){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.9.2.3.2.3}
            [A.3.3](#appendix-A.3.3){.auto .internal .xref}.  [XML
            Signed Data Reference
            Data](#name-xml-signed-data-reference-d){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.9.2.3.2.4}
            [A.3.4](#appendix-A.3.4){.auto .internal .xref}.  [XML
            Signer Certificate
            References](#name-xml-signer-certificate-refe){.internal
            .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.4}
        [A.4](#appendix-A.4){.auto .internal .xref}.  [JOSE
        Header](#name-jose-header){.internal .xref}

        -   ::: {#section-toc.1-1.9.2.4.2.1}
            [A.4.1](#appendix-A.4.1){.auto .internal .xref}.  [SVT
            Signing Key
            Reference](#name-svt-signing-key-reference){.internal .xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix B](#appendix-B){.auto .internal .xref}.  [PDF Signature
    Profile](#name-pdf-signature-profile){.internal .xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [B.1](#appendix-B.1){.auto .internal .xref}.  [SVTs in PDF
        Documents](#name-svts-in-pdf-documents){.internal .xref}

        -   ::: {#section-toc.1-1.10.2.1.2.1}
            [B.1.1](#appendix-B.1.1){.auto .internal .xref}.  [SVT
            Extension to Timestamp
            Tokens](#name-svt-extension-to-timestamp-){.internal .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [B.2](#appendix-B.2){.auto .internal .xref}.  [PDF Signature SVT
        Claims](#name-pdf-signature-svt-claims){.internal .xref}

        -   ::: {#section-toc.1-1.10.2.2.2.1}
            [B.2.1](#appendix-B.2.1){.auto .internal .xref}.  [PDF
            Profile Identifier](#name-pdf-profile-identifier){.internal
            .xref}
            :::

        -   ::: {#section-toc.1-1.10.2.2.2.2}
            [B.2.2](#appendix-B.2.2){.auto .internal .xref}.  [PDF
            Signature Reference
            Data](#name-pdf-signature-reference-dat){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.10.2.2.2.3}
            [B.2.3](#appendix-B.2.3){.auto .internal .xref}.  [PDF
            Signed Data Reference
            Data](#name-pdf-signed-data-reference-d){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.10.2.2.2.4}
            [B.2.4](#appendix-B.2.4){.auto .internal .xref}.  [PDF
            Signer Certificate
            References](#name-pdf-signer-certificate-refe){.internal
            .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.10.2.3}
        [B.3](#appendix-B.3){.auto .internal .xref}.  [JOSE
        Header](#name-jose-header-2){.internal .xref}

        -   ::: {#section-toc.1-1.10.2.3.2.1}
            [B.3.1](#appendix-B.3.1){.auto .internal .xref}.  [SVT
            Signing Key
            Reference](#name-svt-signing-key-reference-2){.internal
            .xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix C](#appendix-C){.auto .internal .xref}.  [JWS
    Profile](#name-jws-profile){.internal .xref}

    -   ::: {#section-toc.1-1.11.2.1}
        [C.1](#appendix-C.1){.auto .internal .xref}.  [SVT in
        JWS](#name-svt-in-jws){.internal .xref}

        -   ::: {#section-toc.1-1.11.2.1.2.1}
            [C.1.1](#appendix-C.1.1){.auto .internal .xref}.  [\"svt\"
            Header Parameter](#name-svt-header-parameter){.internal
            .xref}
            :::

        -   ::: {#section-toc.1-1.11.2.1.2.2}
            [C.1.2](#appendix-C.1.2){.auto .internal .xref}.  [Multiple
            SVTs in a JWS
            Signature](#name-multiple-svts-in-a-jws-sign){.internal
            .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [C.2](#appendix-C.2){.auto .internal .xref}.  [JWS Signature SVT
        Claims](#name-jws-signature-svt-claims){.internal .xref}

        -   ::: {#section-toc.1-1.11.2.2.2.1}
            [C.2.1](#appendix-C.2.1){.auto .internal .xref}.  [JWS
            Profile Identifier](#name-jws-profile-identifier){.internal
            .xref}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.2}
            [C.2.2](#appendix-C.2.2){.auto .internal .xref}.  [JWS
            Signature Reference
            Data](#name-jws-signature-reference-dat){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.3}
            [C.2.3](#appendix-C.2.3){.auto .internal .xref}.  [JWS
            Signed Data Reference
            Data](#name-jws-signed-data-reference-d){.internal .xref}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.4}
            [C.2.4](#appendix-C.2.4){.auto .internal .xref}.  [JWS
            Signer Certificate
            References](#name-jws-signer-certificate-refe){.internal
            .xref}
            :::
        :::

    -   ::: {#section-toc.1-1.11.2.3}
        [C.3](#appendix-C.3){.auto .internal .xref}.  [SVT JOSE
        Header](#name-svt-jose-header-2){.internal .xref}

        -   ::: {#section-toc.1-1.11.2.3.2.1}
            [C.3.1](#appendix-C.3.1){.auto .internal .xref}.  [SVT
            Signing Key
            Reference](#name-svt-signing-key-reference-3){.internal
            .xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix D](#appendix-D){.auto .internal
    .xref}.  [Schemas](#name-schemas){.internal .xref}

    -   ::: {#section-toc.1-1.12.2.1}
        [D.1](#appendix-D.1){.auto .internal .xref}.  [Concise Data
        Definition Language
        (CDDL)](#name-concise-data-definition-lan){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [D.2](#appendix-D.2){.auto .internal .xref}.  [JSON
        Schema](#name-json-schema){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [Appendix E](#appendix-E){.auto .internal
    .xref}.  [Examples](#name-examples){.internal .xref}
    :::

-   ::: {#section-toc.1-1.14}
    [](#appendix-F){.auto .internal .xref}[Authors\'
    Addresses](#name-authors-addresses){.internal .xref}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

Electronic signatures have a limited lifespan regarding when they can be
validated and determined to be authentic. Many factors make it more
difficult to validate electronic signatures over time. For
example:[¶](#section-1-1){.pilcrow}

-   [Trusted information about the validity of the certificate
    containing the signer\'s public key is not
    available.[¶](#section-1-2.1){.pilcrow}]{#section-1-2.1}
-   [Trusted information about the time when the signature was actually
    created is not
    available.[¶](#section-1-2.2){.pilcrow}]{#section-1-2.2}
-   [Algorithms used to create the electronic signature may no longer be
    considered secure at the time of validation and may therefore no
    longer be available in software
    libraries.[¶](#section-1-2.3){.pilcrow}]{#section-1-2.3}
-   [Services necessary to validate the signature are no longer
    available at the time of
    validation.[¶](#section-1-2.4){.pilcrow}]{#section-1-2.4}
-   [Supporting evidence such as certification authority (CA)
    certificates, Online Certificate Status Protocol (OCSP) responses,
    Certificate Revocation Lists (CRLs), or timestamps is not available
    or can\'t be
    validated.[¶](#section-1-2.5){.pilcrow}]{#section-1-2.5}

The challenges to validation of an electronic signature increase over
time, and eventually it may simply be impossible to verify the signature
with a sufficient level of assurance.[¶](#section-1-3){.pilcrow}

Existing standards, such as the ETSI XAdES \[[XADES](#XADES){.cite
.xref}\] profile for XML signatures \[[XMLDSIG11](#XMLDSIG11){.cite
.xref}\], ETSI PAdES \[[PADES](#PADES){.cite .xref}\] profile for PDF
signatures \[[ISOPDF2](#ISOPDF2){.cite .xref}\], and ETSI CAdES
\[[CADES](#CADES){.cite .xref}\] profile for CMS signatures
\[[RFC5652](#RFC5652){.cite .xref}\], can be used to extend the time
within which a signature can be validated at the cost of significant
complexity, which involves storing and validating significant amounts of
external evidence data such as revocation data, signature time stamps,
and archival time stamps.[¶](#section-1-4){.pilcrow}

The Signature Validation Token (SVT) defined in this specification takes
a trusted signature validation process as an input and preserves the
validation result for the associated signature and signed document. The
SVT asserts that a particular electronic signature was successfully
validated by a trusted authority according to defined procedures at a
certain time. Those procedures [MUST]{.bcp14} include checks that the
signature match the signed document, checks that the signature can be
validated by the signing certificate, and checks that the signing
certificate pass certificate path validation \[[RFC5280](#RFC5280){.cite
.xref}\]. Those procedures [MAY]{.bcp14} also include checks associated
with a particular trust policy such as that an acceptable certificate
policy \[[RFC5280](#RFC5280){.cite .xref}\] \[[RFC3647](#RFC3647){.cite
.xref}\] was used to issue the signer\'s certificate and checks that an
acceptable signature policy was used by the signer
\[[RFC3125](#RFC3125){.cite .xref}\].[¶](#section-1-5){.pilcrow}

Once the SVT is issued by a trusted authority, any future validation of
that electronic signature can be satisfied by validating the SVT without
any need to also revalidate the original electronic
signature.[¶](#section-1-6){.pilcrow}

As the SVT is used to preserve validation results obtained through
applying existing standards for signature validation, it is
complementary to and not a replacement for such standards, including the
ETSI standards for long-term validation listed above. The SVT does,
however, have the potentially positive effect that it may significantly
reduce the need to apply complex long-term validation and preservation
techniques for signature validation if an SVT is issued and applied to
the signed document at an early stage where the signature can be
validated without support of large amounts of external evidence. The use
of SVTs may therefore drastically reduce the complexity of revalidation
of old archived electronic signatures.[¶](#section-1-7){.pilcrow}

The SVT can be signed with private keys and algorithms that provide
confidence for a considerable time period. In fact, multiple SVTs can be
used to offer greater assurance. For example, one SVT could be produced
with a large RSA private key, a second one with a strong elliptic curve,
and a third one with a quantum safe digital signature algorithm to
protect against advances in computing power and cryptanalytic
capabilities. Further, the trusted authority can add additional SVTs in
the future using fresh private keys and signatures to extend the
lifetime of the SVTs if necessary.[¶](#section-1-8){.pilcrow}
:::
:::

::: {#defs}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Definitions](#name-definitions){.section-name .selfRef} {#name-definitions}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.cite .xref}\]
\[[RFC8174](#RFC8174){.cite .xref}\] when, and only when, they appear in
all capitals, as shown here.[¶](#section-2-1){.pilcrow}

This document use the following terms:[¶](#section-2-2){.pilcrow}

[]{.break}

Signed Data:
:   The data covered by a particular electronic signature. This is
    typically equivalent to the signed content of a document, and it
    represents the data that the signer intended to sign. In some cases,
    such as in some XML signatures, the Signed Data can be the
    collection of several data fragments each referenced by the
    signature. In the case of PDF, this is the data covered by the
    \"ByteRange\" parameter in the signature dictionary. In JSON Web
    Signature (JWS), this is the unencoded payload data (before
    base64url encoding).[¶](#section-2-3.2){.pilcrow}
:   

Signed Bytes:
:   These are the actual bytes of data that were hashed and signed by
    the digital signature algorithm. In most cases, this is not the
    actual Signed Data but a collection of signature metadata that
    includes references (hash) of the Signed Data as well as information
    about algorithms and other data bound to a signature. In XML, this
    is the canonicalized SignedInfo element. In CMS and PDF signatures,
    this is the DER-encoded SignedAttributes structure. In JWS, this is
    the protected header and payload data formatted according to
    \[[RFC7515](#RFC7515){.cite .xref}\].[¶](#section-2-3.4){.pilcrow}
:   

When these terms are used as defined in this section, they appear with a
capitalized first letter.[¶](#section-2-4){.pilcrow}
:::
:::

::: {#svt}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Signature Validation Token](#name-signature-validation-token){.section-name .selfRef} {#name-signature-validation-token}

::: {#svt-function}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Signature Validation Token Function](#name-signature-validation-token-){.section-name .selfRef} {#name-signature-validation-token-}

The Signature Validation Token (SVT) is created by a trusted service to
assert evidence of successful electronic signature validation using a
well-defined and trustworthy signature validation process. The SVT binds
the validation result to the validated signature, the document signed by
the signature, and the certificate of the signer. This allows a relying
party to verify the validity of a signed document without having to
revalidate the original signature or to reuse any of its associated
cryptographic algorithms for as long as the SVT itself can be validated.
The SVT achieves this by binding the following information to a specific
electronic signature:[¶](#section-3.1-1){.pilcrow}

-   [A unique identification of the electronic
    signature.[¶](#section-3.1-2.1){.pilcrow}]{#section-3.1-2.1}
-   [The data and metadata signed by the electronic
    signature.[¶](#section-3.1-2.2){.pilcrow}]{#section-3.1-2.2}
-   [The signer\'s certificate that was validated as part of electronic
    signature
    verification.[¶](#section-3.1-2.3){.pilcrow}]{#section-3.1-2.3}
-   [The certification path that was used to validate the signer\'s
    certificate.[¶](#section-3.1-2.4){.pilcrow}]{#section-3.1-2.4}
-   [An assertion providing evidence of signature verification, the time
    the verification was performed, the procedures used to verify the
    electronic signature, and the outcome of the
    verification.[¶](#section-3.1-2.5){.pilcrow}]{#section-3.1-2.5}
-   [An assertion providing evidence of the time at which the signature
    is known to have existed, the procedures used to validate the time
    of existence, and the outcome of the
    validation.[¶](#section-3.1-2.6){.pilcrow}]{#section-3.1-2.6}

The SVT aims to support long-term validation that can be further
extended into the future by applying the following
strategies:[¶](#section-3.1-3){.pilcrow}

-   [by using secure algorithms with long life expectancy when signing
    the SVT[¶](#section-3.1-4.1){.pilcrow}]{#section-3.1-4.1}
-   [by reissuing the SVT before it becomes insecure or is considered
    expired[¶](#section-3.1-4.2){.pilcrow}]{#section-3.1-4.2}
-   [optionally, by issuing multiple SVTs with different algorithms to
    provide redundancy in case one algorithm is
    broken[¶](#section-3.1-4.3){.pilcrow}]{#section-3.1-4.3}
:::
:::

::: {#svt-syntax}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Signature Validation Token Syntax](#name-signature-validation-token-s){.section-name .selfRef} {#name-signature-validation-token-s}

The SVT is carried in a JSON Web Token (JWT) as defined in
\[[RFC7519](#RFC7519){.cite .xref}\].[¶](#section-3.2-1){.pilcrow}

::: {#svt-syntax-dt}
::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Data Types](#name-data-types){.section-name .selfRef} {#name-data-types}

The contents of claims in an SVT are specified using the following data
types:[¶](#section-3.2.1-1){.pilcrow}

[]{.break}

String:
:   JSON Data Type of string that contains an arbitrary case-sensitive
    string value.[¶](#section-3.2.1-2.2){.pilcrow}
:   

Base64Binary:
:   JSON Data Type of string that contains a Base64-encoded byte array
    of binary data.[¶](#section-3.2.1-2.4){.pilcrow}
:   

StringOrURI:
:   JSON Data Type of string that contains an arbitrary string or a URI
    as defined in \[[RFC7519](#RFC7519){.cite .xref}\]. It is
    [REQUIRED]{.bcp14} to contain the colon character (\":\") to be a
    URI.[¶](#section-3.2.1-2.6){.pilcrow}
:   

URI:
:   JSON Data Type of string that contains a URI as defined in
    \[[RFC7519](#RFC7519){.cite
    .xref}\].[¶](#section-3.2.1-2.8){.pilcrow}
:   

Integer:
:   JSON Data Type of number that contains a 32-bit signed integer value
    (from -2^31^ to 2^31^-1).[¶](#section-3.2.1-2.10){.pilcrow}
:   

Long:
:   JSON Data Type of number that contains a 64-bit signed integer value
    (from -2^63^ to 2^63^-1).[¶](#section-3.2.1-2.12){.pilcrow}
:   

NumericDate:
:   JSON Data Type of number that contains data as defined in
    \[[RFC7519](#RFC7519){.cite .xref}\], which is the number of seconds
    from 1970-01-01T00:00:00Z UTC until the specified UTC date/time,
    ignoring leap seconds.[¶](#section-3.2.1-2.14){.pilcrow}
:   

Boolean:
:   JSON Data Type of boolean that contains the explicit value of true
    or false.[¶](#section-3.2.1-2.16){.pilcrow}
:   

Object\<Class>:
:   A JSON object holding a claims object of a class defined in this
    specification (see [Section 3.2.2](#svt-syntax-claim){.auto
    .internal .xref}).[¶](#section-3.2.1-2.18){.pilcrow}
:   

Map\<Type>:
:   A JSON object with name-value pairs where the value is an object of
    the specified Type in the notation. For example, Map\<String> is a
    JSON object with name-value pairs where all values are of type
    String.[¶](#section-3.2.1-2.20){.pilcrow}
:   

Array:
:   A JSON array of a specific data type as defined in this section. An
    array is expressed in this specification by square brackets. For
    example, \[String\] indicates an array of String values, and
    \[Object\<DocHash>\] indicates an array of DocHash
    objects.[¶](#section-3.2.1-2.22){.pilcrow}
:   

Null:
:   A JSON null that represents an absent value. A claim with a null
    value is equivalent with an absent
    claim.[¶](#section-3.2.1-2.24){.pilcrow}
:   
:::
:::

::: {#svt-syntax-claim}
::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [Signature Validation Token JWT Claims](#name-signature-validation-token-j){.section-name .selfRef} {#name-signature-validation-token-j}

The SVT [MUST]{.bcp14} contain only JWT claims in the following
list:[¶](#section-3.2.2-1){.pilcrow}

[]{.break}

\"jti\":
:   A String data type that is a \"JWT ID\" registered claim according
    to \[[RFC7519](#RFC7519){.cite .xref}\]. It is [RECOMMENDED]{.bcp14}
    that the identifier holds a hexadecimal string representation of a
    128-bit unsigned integer. An SVT [MUST]{.bcp14} contain one \"JWT
    ID\" claim.[¶](#section-3.2.2-2.2){.pilcrow}
:   

\"iss\":
:   A StringOrURI data type that is an \"Issuer\" registered claim
    according to \[[RFC7519](#RFC7519){.cite .xref}\], which is an
    arbitrary unique identifier of the SVT issuer. This value
    [SHOULD]{.bcp14} have the value of a URI based on a domain owned by
    the issuer. An SVT [MUST]{.bcp14} contain one \"Issuer\"
    claim.[¶](#section-3.2.2-2.4){.pilcrow}
:   

\"iat\":
:   A NumericDate data type that is an \"Issued At\" registered claim
    according to \[[RFC7519](#RFC7519){.cite .xref}\], which expresses
    the time when this SVT was issued. An SVT [MUST]{.bcp14} contain one
    \"Issued At\" claim.[¶](#section-3.2.2-2.6){.pilcrow}
:   

\"aud\":
:   A \[StringOrURI\] data type or a StringOrURI data type that is an
    \"Audience\" registered claim according to
    \[[RFC7519](#RFC7519){.cite .xref}\]. The audience claim is an array
    of one or more identifiers, identifying intended recipients of the
    SVT. Each identifier [MAY]{.bcp14} identify a single entity, a group
    of entities, or a common policy adopted by a group of entities. If
    only one value is provided, it [MAY]{.bcp14} be provided as a single
    StringOrURI data type value instead of as an array of values.
    Inclusion of the \"Audience\" claim in an SVT is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.2-2.8){.pilcrow}
:   

\"exp\":
:   A NumericDate data type that is an \"Expiration Time\" registered
    claim according to \[[RFC7519](#RFC7519){.cite .xref}\], which
    expresses the time when services and responsibilities related to
    this SVT are no longer provided by the SVT issuer. The precise
    meaning of the expiration time claim is defined by local policies.
    See implementation note below. Inclusion of the \"Expiration Time\"
    claim in an SVT is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.2-2.10){.pilcrow}
:   

\"sig_val_claims\":
:   An Object\<SigValidation> data type that contains signature
    validation claims for this SVT extending the standard registered JWT
    claims above. An SVT [MUST]{.bcp14} contain one sig_val_claims
    claim.[¶](#section-3.2.2-2.12){.pilcrow}
:   

Note: An SVT asserts that a particular validation process was undertaken
at a stated time. This fact never changes and never expires. However,
some other aspects of the SVT such as liability for false claims or
service provision related to a specific SVT may expire after a certain
period of time, such as a service where an old SVT can be upgraded to a
new SVT signed with fresh keys and
algorithms.[¶](#section-3.2.2-3){.pilcrow}
:::
:::

::: {#sigvalidation-obj-class}
::: {#section-3.2.3 .section}
#### [3.2.3.](#section-3.2.3){.section-number .selfRef} [SigValidation Object Class](#name-sigvalidation-object-class){.section-name .selfRef} {#name-sigvalidation-object-class}

The sig_val_claims JWT claim uses the SigValidation object class. A
SigValidation object holds all custom claims, and a SigValidation object
contains the following parameters:[¶](#section-3.2.3-1){.pilcrow}

[]{.break}

\"ver\":
:   A String data type representing the version. This parameter
    [MUST]{.bcp14} be present and the version in this specification
    indicated by the value \"1.0\".[¶](#section-3.2.3-2.2){.pilcrow}
:   

\"profile\":
:   A StringOrURI data type representing the name of a profile that
    defines conventions followed for specific claims and any extension
    points used by the SVT issuer. This parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.3-2.4){.pilcrow}
:   

\"hash_algo\":
:   A URI data type that identifies the hash algorithm used to compute
    the hash values within the SVT. The URI identifier [MUST]{.bcp14} be
    one defined in \[[RFC9231](#RFC9231){.cite .xref}\] or in the IANA
    registry defined by this specification. This parameter
    [MUST]{.bcp14} be present.[¶](#section-3.2.3-2.6){.pilcrow}
:   

\"sig\":
:   An \[Object\<Signature>\] data type that gives information about
    validated electronic signatures as an array of Signature objects. If
    the SVT contains signature validation evidence for more than one
    signature, then each signature is represented by a separate
    Signature object. At least one Signature object [MUST]{.bcp14} be
    present.[¶](#section-3.2.3-2.8){.pilcrow}
:   

\"ext\":
:   A Map\<String> data type that provides additional claims related to
    the SVT. Extension claims are added at the discretion of the SVT
    issuer; however, extension claims [MUST]{.bcp14} follow any
    conventions defined in a profile of this specification (see [Section
    4](#profiles){.auto .internal .xref}). Inclusion of this parameter
    is [OPTIONAL]{.bcp14}.[¶](#section-3.2.3-2.10){.pilcrow}
:   
:::
:::

::: {#signature-obj-class}
::: {#section-3.2.4 .section}
#### [3.2.4.](#section-3.2.4){.section-number .selfRef} [Signature Claims Object Class](#name-signature-claims-object-cla){.section-name .selfRef} {#name-signature-claims-object-cla}

The sig parameter in the SigValidation object class uses the Signature
object class. The Signature object contains claims related to signature
validation evidence for one signature, and it contains the following
parameters:[¶](#section-3.2.4-1){.pilcrow}

[]{.break}

\"sig_ref\":
:   An Object\<SigReference> data type that contains reference
    information identifying the target signature. This parameter
    [MUST]{.bcp14} be present.[¶](#section-3.2.4-2.2){.pilcrow}
:   

\"sig_data_ref\":
:   An \[Object\<SignedDataReference>\] data type that contains an array
    of references to Signed Data that was signed by the target
    electronic signature. At least one SignedDataReference object
    [MUST]{.bcp14} be present.[¶](#section-3.2.4-2.4){.pilcrow}
:   

\"signer_cert_ref\":
:   An Object\<CertReference> data type that references the signer\'s
    certificate and optionally references a supporting certification
    path that was used to verify the target electronic signature. This
    parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.4-2.6){.pilcrow}
:   

\"sig_val\":
:   An \[Object\<PolicyValidation>\] data type that contains an array of
    results of signature verification according to defined procedures.
    At least one PolicyValidation object [MUST]{.bcp14} be
    present.[¶](#section-3.2.4-2.8){.pilcrow}
:   

\"time_val\":
:   An \[Object\<TimeValidation>\] data type that contains an array of
    time verification results showing that the target signature has
    existed at a specific time in the past. Inclusion of this parameter
    is [OPTIONAL]{.bcp14}.[¶](#section-3.2.4-2.10){.pilcrow}
:   

\"ext\":
:   A MAP\<String> data type that provides additional claims related to
    the target signature. Extension claims are added at the discretion
    of the SVT issuer; however, extension claims [MUST]{.bcp14} follow
    any conventions defined in a profile of this specification (see
    [Section 4](#profiles){.auto .internal .xref}). Inclusion of this
    parameter is [OPTIONAL]{.bcp14}.[¶](#section-3.2.4-2.12){.pilcrow}
:   
:::
:::

::: {#sigreference-obj-class}
::: {#section-3.2.5 .section}
#### [3.2.5.](#section-3.2.5){.section-number .selfRef} [SigReference Claims Object Class](#name-sigreference-claims-object-){.section-name .selfRef} {#name-sigreference-claims-object-}

The sig_ref parameter in the Signature object class uses the
SigReference object class. The SigReference object provides information
used to match the Signature claims object to a specific target
electronic signature and to verify the integrity of the target signature
value and Signed Bytes, and it contains the following
parameters:[¶](#section-3.2.5-1){.pilcrow}

[]{.break}

\"id\":
:   A String data type that contains an identifier assigned to the
    target signature. Inclusion of this parameter is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.5-2.2){.pilcrow}
:   

\"sig_hash\":
:   A Base64Binary data type that contains a hash value of the target
    electronic signature value. This parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.5-2.4){.pilcrow}
:   

\"sb_hash\":
:   A Base64Binary data type that contains a hash value of the Signed
    Bytes of the target electronic signature. This parameter
    [MUST]{.bcp14} be present.[¶](#section-3.2.5-2.6){.pilcrow}
:   
:::
:::

::: {#signeddatareference-obj-class}
::: {#section-3.2.6 .section}
#### [3.2.6.](#section-3.2.6){.section-number .selfRef} [SignedDataReference Claims Object Class](#name-signeddatareference-claims-){.section-name .selfRef} {#name-signeddatareference-claims-}

The sig_data_ref parameter in the Signature object class uses the
SignedDataReference object class. The SignedDataReference object
provides information used to verify the target electronic signature
references to Signed Data as well as to verify the integrity of all data
that is signed by the target signature, and it contains the following
parameters:[¶](#section-3.2.6-1){.pilcrow}

[]{.break}

\"ref\":
:   A String data type that contains a reference identifier for the data
    or data fragment covered by the target electronic signature. This
    parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.6-2.2){.pilcrow}
:   

\"hash\":
:   A Base64Binary data type that contains the hash value for the data
    covered by the target electronic signature. This parameter
    [MUST]{.bcp14} be present.[¶](#section-3.2.6-2.4){.pilcrow}
:   
:::
:::

::: {#policyval-obj-class}
::: {#section-3.2.7 .section}
#### [3.2.7.](#section-3.2.7){.section-number .selfRef} [PolicyValidation Claims Object Class](#name-policyvalidation-claims-obj){.section-name .selfRef} {#name-policyvalidation-claims-obj}

The sig_val parameter in the Signature object class uses the
PolicyValidation object class. The PolicyValidation object provides
information about the result of a validation process according to a
specific policy, and it contains the following
parameters:[¶](#section-3.2.7-1){.pilcrow}

[]{.break}

\"pol\":
:   A StringOrURI data type that contains the identifier of the policy
    governing the electronic signature verification process. This
    parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.7-2.2){.pilcrow}
:   

\"res\":
:   A String data type that contains the result of the electronic
    signature verification process. The value [MUST]{.bcp14} be one of
    \"PASSED\", \"FAILED\", or \"INDETERMINATE\" as defined by
    \[[ETSI319102-1](#ETSI319102-1){.cite .xref}\]. This parameter
    [MUST]{.bcp14} be present.[¶](#section-3.2.7-2.4){.pilcrow}
:   

\"msg\":
:   A String data type that contains a message describing the result.
    Inclusion of this parameter is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.7-2.6){.pilcrow}
:   

\"ext\":
:   A MAP\<String> data type that provides additional claims related to
    the target signature. Extension claims are added at the discretion
    of the SVT issuer; however, extension claims [MUST]{.bcp14} follow
    any conventions defined in a profile of this specification (see
    [Section 4](#profiles){.auto .internal .xref}). Inclusion of this
    parameter is [OPTIONAL]{.bcp14}.[¶](#section-3.2.7-2.8){.pilcrow}
:   
:::
:::

::: {#timever-obj-class}
::: {#section-3.2.8 .section}
#### [3.2.8.](#section-3.2.8){.section-number .selfRef} [TimeValidation Claims Object Class](#name-timevalidation-claims-objec){.section-name .selfRef} {#name-timevalidation-claims-objec}

The time_val parameter in the Signature object class uses the
TimeValidation object class. The TimeValidation claims object provides
information about the result of validating evidence of time asserting
that the target signature existed at a particular time in the past.
Evidence of time is typically a timestamp according to
\[[RFC3161](#RFC3161){.cite .xref}\], but other types of evidence may be
used such as a previously issued SVT for this signature. The
TimeValidation claims object contains the following
parameters:[¶](#section-3.2.8-1){.pilcrow}

[]{.break}

\"time\":
:   A NumericDate data type that contains the verified time. This
    parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.8-2.2){.pilcrow}
:   

\"type\":
:   A StringOrURI data type that contains an identifier of the type of
    evidence of time. This parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.8-2.4){.pilcrow}
:   

\"iss\":
:   A StringOrURI data type that contains an identifier of the entity
    that issued the evidence of time. This parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.8-2.6){.pilcrow}
:   

\"id\":
:   A String data type that contains an unique identifier assigned to
    the evidence of time. Inclusion of this parameter is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.8-2.8){.pilcrow}
:   

\"hash\":
:   A Base64Binary data type that contains the hash value of the
    validated evidence of time. Inclusion of this parameter is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.8-2.10){.pilcrow}
:   

\"val\":
:   An \[Object\<PolicyValidation>\] data type that contains an array of
    results of the time evidence validation according to defined
    validation procedures. Inclusion of this parameter is
    [OPTIONAL]{.bcp14}.[¶](#section-3.2.8-2.12){.pilcrow}
:   

\"ext\":
:   A MAP\<String> data type that provides additional claims related to
    the target signature. Extension claims are added at the discretion
    of the SVT issuer; however, extension claims [MUST]{.bcp14} follow
    any conventions defined in a profile of this specification (see
    [Section 4](#profiles){.auto .internal .xref}). Inclusion of this
    parameter is [OPTIONAL]{.bcp14}.[¶](#section-3.2.8-2.14){.pilcrow}
:   
:::
:::

::: {#certref-obj-class}
::: {#section-3.2.9 .section}
#### [3.2.9.](#section-3.2.9){.section-number .selfRef} [CertReference Claims Object Class](#name-certreference-claims-object){.section-name .selfRef} {#name-certreference-claims-object}

The signer_cert_ref parameter in the Signature object class uses the
CertReference object class. The CertReference object references a single
X.509 certificate or a X.509 certification path either by providing the
certificate data or by providing hash references for certificates that
can be located in the target electronic signature, and it contains the
following parameters:[¶](#section-3.2.9-1){.pilcrow}

[]{.break}

\"type\":
:   A StringOrURI data type that contains an identifier of the type of
    reference. The type identifier [MUST]{.bcp14} be one of the
    identifiers defined below, an identifier specified by the selected
    profile, or a URI identifier. This parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.9-2.2){.pilcrow}
:   

\"ref\":
:   A \[String\] data type that contains an array of string parameters
    according to conventions defined by the type identifier. At least
    one parameter [MUST]{.bcp14} be
    present.[¶](#section-3.2.9-2.4){.pilcrow}
:   

The following type identifiers are
defined:[¶](#section-3.2.9-3){.pilcrow}

[]{.break}

\"chain\":
:   The ref contains an array of Base64-encoded X.509 certificates
    \[[RFC5280](#RFC5280){.cite .xref}\]. The certificates
    [MUST]{.bcp14} be provided in the order starting with the end entity
    certificate. Any following certificate must be able to validate the
    signature on the previous certificate in the
    array.[¶](#section-3.2.9-4.2){.pilcrow}
:   

\"chain_hash\":
:   The ref contains an array of one or more Base64-encoded hash values
    where each hash value is a hash over a X.509 certificate
    \[[RFC5280](#RFC5280){.cite .xref}\] used to validate the signature.
    The certificates [MUST]{.bcp14} be provided in the order starting
    with the end entity certificate. Any following certificate must be
    able to validate the signature on the previous certificate in the
    array. This option [MUST NOT]{.bcp14} be used unless all hashed
    certificates are present in the target electronic
    signature.[¶](#section-3.2.9-4.4){.pilcrow}
:   

Note: All certificates referenced using the identifiers above are X.509
certificates. Profiles of this specification [MAY]{.bcp14} define
alternative types of public key containers; however, a major function of
these referenced certificates is not just to reference the public key
but also to provide the subject name of the signer. It is therefore
important for the full function of an SVT that the referenced public key
container also provides the means to identify the
signer.[¶](#section-3.2.9-5){.pilcrow}
:::
:::

::: {#svt-jose-header}
::: {#section-3.2.10 .section}
#### [3.2.10.](#section-3.2.10){.section-number .selfRef} [SVT JOSE Header](#name-svt-jose-header){.section-name .selfRef} {#name-svt-jose-header}

The SVT JWT [MUST]{.bcp14} contain the following JSON Object Signing and
Encryption (JOSE) header parameters in accordance with [Section
5](https://www.rfc-editor.org/rfc/rfc7519#section-5){.relref} of
\[[RFC7519](#RFC7519){.cite .xref}\]:[¶](#section-3.2.10-1){.pilcrow}

[]{.break}

\"typ\":
:   This parameter [MUST]{.bcp14} have the string value \"JWT\" (upper
    case).[¶](#section-3.2.10-2.2){.pilcrow}
:   

\"alg\":
:   This parameter identifies the algorithm used to sign the SVT JWT.
    The algorithm identifier [MUST]{.bcp14} be specified in
    \[[RFC7518](#RFC7518){.cite .xref}\] or the IANA \"JSON Web
    Signature and Encryption Algorithms\" registry
    \[[IANA-JOSE-REG](#IANA-JOSE-REG){.cite .xref}\]. The specified
    signature hash algorithm [MUST]{.bcp14} be identical to the hash
    algorithm specified in the hash_algo parameter of the SigValidation
    object within the sig_val_claims
    claim.[¶](#section-3.2.10-2.4){.pilcrow}
:   

The SVT header [MUST]{.bcp14} contain a public key or a reference to a
public key used to verify the signature on the SVT in accordance with
\[[RFC7515](#RFC7515){.cite .xref}\]. Each profile, as discussed in
[Section 4](#profiles){.auto .internal .xref}, [MUST]{.bcp14} define the
requirements for how the key or key reference is included in the
header.[¶](#section-3.2.10-3){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#profiles}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Profiles](#name-profiles){.section-name .selfRef} {#name-profiles}

Each signed document and signature type will have to define the precise
content and use of several claims in the SVT.[¶](#section-4-1){.pilcrow}

At a minimum, each profile [MUST]{.bcp14}
define:[¶](#section-4-2){.pilcrow}

-   [The identifier of the
    profile[¶](#section-4-3.1){.pilcrow}]{#section-4-3.1}
-   [How to reference the Signed Data content of the signed
    document[¶](#section-4-3.2){.pilcrow}]{#section-4-3.2}
-   [How to reference the target electronic signature and the Signed
    Bytes of the signature[¶](#section-4-3.3){.pilcrow}]{#section-4-3.3}
-   [How to reference certificates supporting each electronic
    signature[¶](#section-4-3.4){.pilcrow}]{#section-4-3.4}
-   [How to include public keys or references to public keys in the
    SVT[¶](#section-4-3.5){.pilcrow}]{#section-4-3.5}
-   [Whether each electronic signature is supported by a single SVT, or
    one SVT may support multiple electronic signatures of the same
    document[¶](#section-4-3.6){.pilcrow}]{#section-4-3.6}

A profile [MAY]{.bcp14} also define:[¶](#section-4-4){.pilcrow}

-   [Explicit information on how to perform signature validation based
    on an SVT[¶](#section-4-5.1){.pilcrow}]{#section-4-5.1}
-   [How to attach an SVT to an electronic signature or signed
    document[¶](#section-4-5.2){.pilcrow}]{#section-4-5.2}

::: {#defined-profiles}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Defined Profiles](#name-defined-profiles){.section-name .selfRef} {#name-defined-profiles}

The following profiles are defined in appendixes of this
document:[¶](#section-4.1-1){.pilcrow}

[]{.break}

[Appendix A](#appendix-xml-profile){.auto .internal .xref}:
:   XML Signature Profile[¶](#section-4.1-2.2){.pilcrow}
:   

[Appendix B](#appendix-pdf-profile){.auto .internal .xref}:
:   PDF Signature Profile[¶](#section-4.1-2.4){.pilcrow}
:   

[Appendix C](#appendix-jws-profile){.auto .internal .xref}:
:   JWS Profile[¶](#section-4.1-2.6){.pilcrow}
:   

Other documents [MAY]{.bcp14} define other profiles that [MAY]{.bcp14}
complement, amend, or supersede these
profiles.[¶](#section-4.1-3){.pilcrow}
:::
:::
:::
:::

::: {#signature-verification-with-a-svt}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Signature Verification with an SVT](#name-signature-verification-with){.section-name .selfRef} {#name-signature-verification-with}

Signature verification based on an SVT [MUST]{.bcp14} follow these
steps:[¶](#section-5-1){.pilcrow}

1.  [Locate all available SVTs available for the signed document that
    are relevant for the target electronic
    signature.[¶](#section-5-2.1){.pilcrow}]{#section-5-2.1}
2.  [Select the most recent SVT that can be successfully validated and
    meets the requirement of the relying
    party.[¶](#section-5-2.2){.pilcrow}]{#section-5-2.2}
3.  [Verify the integrity of the signature and the Signed Bytes of the
    target electronic signature using the sig_ref
    claim.[¶](#section-5-2.3){.pilcrow}]{#section-5-2.3}
4.  [Verify that the Signed Data reference in the original electronic
    signature matches the reference values in the sig_data_ref
    claim.[¶](#section-5-2.4){.pilcrow}]{#section-5-2.4}
5.  [Verify the integrity of referenced Signed Data using provided hash
    values in the sig_data_ref
    claim.[¶](#section-5-2.5){.pilcrow}]{#section-5-2.5}
6.  [Obtain the verified certificates supporting the asserted electronic
    signature verification through the signer_cert_ref
    claim.[¶](#section-5-2.6){.pilcrow}]{#section-5-2.6}
7.  [Verify that signature validation policy results satisfy the
    requirements of the relying
    party.[¶](#section-5-2.7){.pilcrow}]{#section-5-2.7}
8.  [Verify that verified time results satisfy the context for the use
    of the signed
    document.[¶](#section-5-2.8){.pilcrow}]{#section-5-2.8}

After successfully performing these steps, signature validity is
established as well as the trusted signer certificate binding the
identity of the signer to the electronic
signature.[¶](#section-5-3){.pilcrow}
:::
:::

::: {#iana}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#claim-names-reg}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Claim Names Registration](#name-claim-names-registration){.section-name .selfRef} {#name-claim-names-registration}

IANA has registered the \"sig_val_claims\" claim name in the \"JSON Web
Token Claims\" registry established by [Section
10.1](https://www.rfc-editor.org/rfc/rfc7519#section-10.1){.relref} of
\[[RFC7519](#RFC7519){.cite .xref}\].[¶](#section-6.1-1){.pilcrow}

::: {#clname-reg-contents}
::: {#section-6.1.1 .section}
#### [6.1.1.](#section-6.1.1){.section-number .selfRef} [Registry Contents](#name-registry-contents){.section-name .selfRef} {#name-registry-contents}

[]{.break}

Claim Name:
:   sig_val_claims[¶](#section-6.1.1-1.2){.pilcrow}
:   

Claim Description:
:   Signature Validation Token[¶](#section-6.1.1-1.4){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.1.1-1.6){.pilcrow}
:   

Specification Document(s):
:   [Section 3.2.3](#sigvalidation-obj-class){.auto .internal .xref} of
    RFC 9321[¶](#section-6.1.1-1.8){.pilcrow}
:   
:::
:::
:::
:::

::: {#iana-header-params}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Header Parameter Names Registration](#name-header-parameter-names-regi){.section-name .selfRef} {#name-header-parameter-names-regi}

IANA has registered the \"svt\" Header Parameter in the \"JSON Web
Signature and Encryption Header Parameters\" registry established by
\[[RFC7515](#RFC7515){.cite .xref}\].[¶](#section-6.2-1){.pilcrow}

::: {#iana-header-params-reg}
::: {#section-6.2.1 .section}
#### [6.2.1.](#section-6.2.1){.section-number .selfRef} [Registry Contents](#name-registry-contents-2){.section-name .selfRef} {#name-registry-contents-2}

[]{.break}

Header Parameter Name:
:   svt[¶](#section-6.2.1-1.2){.pilcrow}
:   

Header Parameter Description:
:   Signature Validation Token[¶](#section-6.2.1-1.4){.pilcrow}
:   

Header Parameter Usage Location(s):
:   JWS[¶](#section-6.2.1-1.6){.pilcrow}
:   

Change Controller:
:   IESG[¶](#section-6.2.1-1.8){.pilcrow}
:   

Specification Document(s):
:   [Appendix C.1.1](#svt-header){.auto .internal .xref} of RFC
    9321[¶](#section-6.2.1-1.10){.pilcrow}
:   
:::
:::
:::
:::
:::
:::

::: {#seccons}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

::: {#seccon-lvl-of-reliance}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Level of Reliance](#name-level-of-reliance){.section-name .selfRef} {#name-level-of-reliance}

An SVT allows a signature verifier to still validate the original
signature using the original signature data and to use the information
in the SVT selectively to confirm the validity and integrity of the
original data, such as confirming the integrity of Signed Data or the
validity of the signer\'s certificate, etc.[¶](#section-7.1-1){.pilcrow}

Another way to use an SVT is to completely rely on the validation
conclusion provided by the SVT and to omit revalidation of the original
signature value and original certificate status checking
data.[¶](#section-7.1-2){.pilcrow}

This choice is a decision made by the verifier according to its own
policy and risk assessment.[¶](#section-7.1-3){.pilcrow}

However, even when relying on the SVT validation conclusion of an SVT,
it is vital to still verify that the present SVT is correctly associated
with the document and signature that is being validated by validating
the hashed reference data in the SVT of the signature, signing
certificate chain, Signed Data, and the Signed
Bytes.[¶](#section-7.1-4){.pilcrow}
:::
:::

::: {#seccon-aging-algos}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Aging Algorithms](#name-aging-algorithms){.section-name .selfRef} {#name-aging-algorithms}

Even if the SVT provides protection against algorithms becoming weakened
or broken over time, this protection is only valid for as long as the
algorithms used to sign the SVT are still considered secure. It is
advisable to reissue SVTs in cases where an algorithm protecting the SVT
is getting close to its end of life.[¶](#section-7.2-1){.pilcrow}

One way to increase the resistance of algorithms becoming insecure, is
to issue multiple SVTs for the same signature with different algorithms
and key lengths where one algorithm could still be secure even if the
corresponding algorithm used in the alternative SVT is
broken.[¶](#section-7.2-2){.pilcrow}
:::
:::
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[CADES\]
:   [ETSI]{.refAuthor}, [\"Electronic Signatures and Infrastructures
    (ESI); CAdES digital signatures; Part 1: Building blocks and CAdES
    baseline signatures\"]{.refTitle}, [v1.1.1]{.refContent}, [ETSI EN
    319 122-1]{.seriesInfo}, April 2016.
:   

\[ETSI319102-1\]
:   [ETSI]{.refAuthor}, [\"Electronic Signatures and Infrastructures
    (ESI); Procedures for Creation and Validation of AdES Digital
    Signatures; Part 1: Creation and Validation\"]{.refTitle},
    [v1.1.1]{.refContent}, [ETSI EN 319 102-1]{.seriesInfo}, May 2016.
:   

\[IANA-JOSE-REG\]
:   [IANA]{.refAuthor}, [\"JSON Object Signing and Encryption
    (JOSE)\"]{.refTitle}, \<<https://www.iana.org/assignments/jose/>\>.
:   

\[ISOPDF2\]
:   [ISO]{.refAuthor}, [\"Document management \-- Portable document
    format \-- Part 2: PDF 2.0\"]{.refTitle}, [ISO
    32000-2:2020]{.seriesInfo}, December 2020.
:   

\[PADES\]
:   [ETSI]{.refAuthor}, [\"Electronic Signatures and Infrastructures
    (ESI); PAdES digital signatures; Part 1: Building blocks and PAdES
    baseline signatures\"]{.refTitle}, [v1.1.1]{.refContent}, [ETSI EN
    319 142-1]{.seriesInfo}, April 2016.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3125\]
:   [Ross, J.]{.refAuthor}, [Pinkas, D.]{.refAuthor}, and [N.
    Pope]{.refAuthor}, [\"Electronic Signature Policies\"]{.refTitle},
    [RFC 3125]{.seriesInfo}, [DOI 10.17487/RFC3125]{.seriesInfo},
    September 2001, \<<https://www.rfc-editor.org/info/rfc3125>\>.
:   

\[RFC3161\]
:   [Adams, C.]{.refAuthor}, [Cain, P.]{.refAuthor},
    [Pinkas, D.]{.refAuthor}, and [R. Zuccherato]{.refAuthor},
    [\"Internet X.509 Public Key Infrastructure Time-Stamp Protocol
    (TSP)\"]{.refTitle}, [RFC 3161]{.seriesInfo}, [DOI
    10.17487/RFC3161]{.seriesInfo}, August 2001,
    \<<https://www.rfc-editor.org/info/rfc3161>\>.
:   

\[RFC3647\]
:   [Chokhani, S.]{.refAuthor}, [Ford, W.]{.refAuthor},
    [Sabett, R.]{.refAuthor}, [Merrill, C.]{.refAuthor}, and [S.
    Wu]{.refAuthor}, [\"Internet X.509 Public Key Infrastructure
    Certificate Policy and Certification Practices
    Framework\"]{.refTitle}, [RFC 3647]{.seriesInfo}, [DOI
    10.17487/RFC3647]{.seriesInfo}, November 2003,
    \<<https://www.rfc-editor.org/info/rfc3647>\>.
:   

\[RFC5035\]
:   [Schaad, J.]{.refAuthor}, [\"Enhanced Security Services (ESS)
    Update: Adding CertID Algorithm Agility\"]{.refTitle}, [RFC
    5035]{.seriesInfo}, [DOI 10.17487/RFC5035]{.seriesInfo}, August
    2007, \<<https://www.rfc-editor.org/info/rfc5035>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}, [Santesson, S.]{.refAuthor},
    [Farrell, S.]{.refAuthor}, [Boeyen, S.]{.refAuthor},
    [Housley, R.]{.refAuthor}, and [W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC5652\]
:   [Housley, R.]{.refAuthor}, [\"Cryptographic Message Syntax
    (CMS)\"]{.refTitle}, [STD 70]{.seriesInfo}, [RFC 5652]{.seriesInfo},
    [DOI 10.17487/RFC5652]{.seriesInfo}, September 2009,
    \<<https://www.rfc-editor.org/info/rfc5652>\>.
:   

\[RFC7515\]
:   [Jones, M.]{.refAuthor}, [Bradley, J.]{.refAuthor}, and [N.
    Sakimura]{.refAuthor}, [\"JSON Web Signature (JWS)\"]{.refTitle},
    [RFC 7515]{.seriesInfo}, [DOI 10.17487/RFC7515]{.seriesInfo}, May
    2015, \<<https://www.rfc-editor.org/info/rfc7515>\>.
:   

\[RFC7518\]
:   [Jones, M.]{.refAuthor}, [\"JSON Web Algorithms (JWA)\"]{.refTitle},
    [RFC 7518]{.seriesInfo}, [DOI 10.17487/RFC7518]{.seriesInfo}, May
    2015, \<<https://www.rfc-editor.org/info/rfc7518>\>.
:   

\[RFC7519\]
:   [Jones, M.]{.refAuthor}, [Bradley, J.]{.refAuthor}, and [N.
    Sakimura]{.refAuthor}, [\"JSON Web Token (JWT)\"]{.refTitle}, [RFC
    7519]{.seriesInfo}, [DOI 10.17487/RFC7519]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7519>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC9231\]
:   [Eastlake 3rd, D.]{.refAuthor}, [\"Additional XML Security Uniform
    Resource Identifiers (URIs)\"]{.refTitle}, [RFC 9231]{.seriesInfo},
    [DOI 10.17487/RFC9231]{.seriesInfo}, July 2022,
    \<<https://www.rfc-editor.org/info/rfc9231>\>.
:   

\[XADES\]
:   [ETSI]{.refAuthor}, [\"Electronic Signatures and Infrastructures
    (ESI); XAdES digital signatures; Part 1: Building blocks and XAdES
    baseline signatures\"]{.refTitle}, [v1.1.1]{.refContent}, [ETSI EN
    319 132-1]{.seriesInfo}, April 2016.
:   

\[XMLDSIG11\]
:   [Eastlake 3rd, D.]{.refAuthor}, [Reagle, J.]{.refAuthor},
    [Solo, D.]{.refAuthor}, [Hirsch, F.]{.refAuthor},
    [Nystrom, M.]{.refAuthor}, [Roessler, T.]{.refAuthor}, and [K.
    Yiu]{.refAuthor}, [\"XML Signature Syntax and Processing Version
    1.1\"]{.refTitle}, [W3C Proposed Recommendation]{.seriesInfo},
    April 2013. [Latest version available at
    <https://www.w3.org/TR/xmldsig-core1/>.]{.annotation}
:   
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC8610\]
:   [Birkholz, H.]{.refAuthor}, [Vigano, C.]{.refAuthor}, and [C.
    Bormann]{.refAuthor}, [\"Concise Data Definition Language (CDDL): A
    Notational Convention to Express Concise Binary Object
    Representation (CBOR) and JSON Data Structures\"]{.refTitle}, [RFC
    8610]{.seriesInfo}, [DOI 10.17487/RFC8610]{.seriesInfo}, June 2019,
    \<<https://www.rfc-editor.org/info/rfc8610>\>.
:   
:::
:::

::: {#appendix-xml-profile}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [XML Signature Profile](#name-xml-signature-profile){.section-name .selfRef} {#name-xml-signature-profile}

This appendix defines a profile for implementing SVTs with a signed XML
document and defines the following aspects of SVT
usage:[¶](#appendix-A-1){.pilcrow}

-   [How to include reference data related to XML signatures and XML
    documents in an SVT[¶](#appendix-A-2.1){.pilcrow}]{#appendix-A-2.1}
-   [How to add an SVT token to an XML
    signature[¶](#appendix-A-2.2){.pilcrow}]{#appendix-A-2.2}

XML documents can have any number of signature elements, signing an
arbitrary number of fragments of XML documents. The actual signature
element may be included in the signed XML document (enveloped), include
the Signed Data (enveloping), or may be separate from the signed content
(detached).[¶](#appendix-A-3){.pilcrow}

To provide a generic solution for any type of XML signature, an SVT is
added to each XML signature element within the XML signature
\<ds:Object> element.[¶](#appendix-A-4){.pilcrow}

::: {#notation}
::: {#appendix-A.1 .section}
### [A.1.](#appendix-A.1){.section-number .selfRef} [Notation](#name-notation){.section-name .selfRef} {#name-notation}

::: {#ref-to-xml-elements}
::: {#appendix-A.1.1 .section}
#### [A.1.1.](#appendix-A.1.1){.section-number .selfRef} [References to XML Elements from XML Schemas](#name-references-to-xml-elements-){.section-name .selfRef} {#name-references-to-xml-elements-}

When referring to elements from the W3C XML Signature namespace
(<https://www.w3.org/2000/09/xmldsig#>), the following syntax is
used:[¶](#appendix-A.1.1-1){.pilcrow}

-   [\<ds:Signature>[¶](#appendix-A.1.1-2.1){.pilcrow}]{#appendix-A.1.1-2.1}

When referring to elements from the ETSI XAdES XML Signature namespace
(<https://uri.etsi.org/01903/v1.3.2#>), the following syntax is
used:[¶](#appendix-A.1.1-3){.pilcrow}

-   [\<xades:CertDigest>[¶](#appendix-A.1.1-4.1){.pilcrow}]{#appendix-A.1.1-4.1}

When referring to elements defined in this specification
(<http://id.swedenconnect.se/svt/1.0/sig-prop/ns>), the following syntax
is used:[¶](#appendix-A.1.1-5){.pilcrow}

-   [\<svt:Element>[¶](#appendix-A.1.1-6.1){.pilcrow}]{#appendix-A.1.1-6.1}
:::
:::
:::
:::

::: {#svt-in-xml}
::: {#appendix-A.2 .section}
### [A.2.](#appendix-A.2){.section-number .selfRef} [SVT in XML Documents](#name-svt-in-xml-documents){.section-name .selfRef} {#name-svt-in-xml-documents}

When SVTs are provided for XML signatures, then one SVT [MUST]{.bcp14}
be provided for each XML signature.[¶](#appendix-A.2-1){.pilcrow}

An SVT embedded within the XML signature element [MUST]{.bcp14} be
placed in a \<svt:SignatureValidationToken> element as defined in
[Appendix A.2.1](#signaturevalidationtoken-signature-property){.auto
.internal .xref}.[¶](#appendix-A.2-2){.pilcrow}

::: {#signaturevalidationtoken-signature-property}
::: {#appendix-A.2.1 .section}
#### [A.2.1.](#appendix-A.2.1){.section-number .selfRef} [SignatureValidationToken Signature Property](#name-signaturevalidationtoken-si){.section-name .selfRef} {#name-signaturevalidationtoken-si}

The \<svt:SignatureValidationToken> element [MUST]{.bcp14} be placed in
a \<ds:SignatureProperty> element in accordance with
\[[XMLDSIG11](#XMLDSIG11){.cite .xref}\]. The \<ds:SignatureProperty>
element [MUST]{.bcp14} be placed inside a \<ds:SignatureProperties>
element inside a \<ds:Object> element inside a \<ds:Signature>
element.[¶](#appendix-A.2.1-1){.pilcrow}

Note: \[[XMLDSIG11](#XMLDSIG11){.cite .xref}\] requires the Target
attribute to be present in \<ds:SignatureProperty>, referencing the
signature targeted by this signature property. If an SVT is added to a
signature that does not have an Id attribute, implementations
[SHOULD]{.bcp14} add an Id attribute to the \<ds:Signature> element and
reference that Id in the Target attribute. This Id attribute and Target
attribute value matching is required by the
\[[XMLDSIG11](#XMLDSIG11){.cite .xref}\] standard, but it is redundant
in the context of SVT validation as the SVT already contains information
that uniquely identifies the target signature. Validation applications
[SHOULD NOT]{.bcp14} reject an SVT token because of Id and Target
attribute mismatch and [MUST]{.bcp14} rely on matching against a
signature using signed information in the SVT
itself.[¶](#appendix-A.2.1-2){.pilcrow}

The \<svt:SignatureValidationToken> element is defined by the following
XML Schema:[¶](#appendix-A.2.1-3){.pilcrow}

::: {#appendix-A.2.1-4}
``` {.lang-xml .sourcecode}
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified"
    targetNamespace="http://id.swedenconnect.se/svt/1.0/sig-prop/ns"
    xmlns:svt="http://id.swedenconnect.se/svt/1.0/sig-prop/ns">

  <xs:element name="SignatureValidationToken"
      type="svt:SignatureValidationTokenType" />

  <xs:complexType name="SignatureValidationTokenType">
    <xs:simpleContent>
      <xs:extension base="xs:string">
      </xs:extension>
    </xs:simpleContent>
  </xs:complexType>

</xs:schema>
```

[¶](#appendix-A.2.1-4){.pilcrow}
:::

The SVT token [MUST]{.bcp14} be included as a string representation of
the SVT JWT. Note that this is the string representation of the JWT
without further encoding. The SVT [MUST NOT]{.bcp14} be represented by
the Base64-encoded bytes of the JWT
string.[¶](#appendix-A.2.1-5){.pilcrow}

Example:[¶](#appendix-A.2.1-6){.pilcrow}

::: {#appendix-A.2.1-7}
``` {.lang-xml .sourcecode}
<ds:Signature Id="MySignatureId">
  ...
  <ds:Object>
    <ds:SignatureProperties>
      <ds:SignatureProperty Target="#MySignatureId">
        <svt:SignatureValidationToken>
              eyJ0eXAiOiJKV1QiLCJhb...2aNZ
        </svt:SignatureValidationToken>
      </ds:SignatureProperty>
    </ds:SignatureProperties>
  </ds:Object>
</ds:Signature>
```

[¶](#appendix-A.2.1-7){.pilcrow}
:::
:::
:::

::: {#xml-multiple-svt-tokens}
::: {#appendix-A.2.2 .section}
#### [A.2.2.](#appendix-A.2.2){.section-number .selfRef} [Multiple SVTs in an XML Signature](#name-multiple-svts-in-an-xml-sig){.section-name .selfRef} {#name-multiple-svts-in-an-xml-sig}

If a new SVT is stored in a signature that already contains a previously
issued SVT, implementations can choose either to replace the existing
SVT or to store the new SVT in addition to the existing
SVT.[¶](#appendix-A.2.2-1){.pilcrow}

If the new SVT is stored in addition to the old SVT, it [SHOULD]{.bcp14}
be stored in a new \<ds:SignatureProperty> element inside the existing
\<ds:SignatureProperties> element where the old SVT is
located.[¶](#appendix-A.2.2-2){.pilcrow}

For interoperability robustness, signature validation applications
[MUST]{.bcp14} be able to handle signatures where the new SVT is located
in a new \<ds:Object> element.[¶](#appendix-A.2.2-3){.pilcrow}
:::
:::
:::
:::

::: {#xml-svt-claims}
::: {#appendix-A.3 .section}
### [A.3.](#appendix-A.3){.section-number .selfRef} [XML Signature SVT Claims](#name-xml-signature-svt-claims){.section-name .selfRef} {#name-xml-signature-svt-claims}

::: {#xml-profile-identifier}
::: {#appendix-A.3.1 .section}
#### [A.3.1.](#appendix-A.3.1){.section-number .selfRef} [XML Profile Identifier](#name-xml-profile-identifier){.section-name .selfRef} {#name-xml-profile-identifier}

When this profile is used, the SigValidation object [MUST]{.bcp14}
contain a \"profile\" claim with the value
\"XML\".[¶](#appendix-A.3.1-1){.pilcrow}
:::
:::

::: {#xml-signature-reference-data}
::: {#appendix-A.3.2 .section}
#### [A.3.2.](#appendix-A.3.2){.section-number .selfRef} [XML Signature Reference Data](#name-xml-signature-reference-dat){.section-name .selfRef} {#name-xml-signature-reference-dat}

The SVT Signature object [MUST]{.bcp14} contain a \"sig_ref\" claim
(SigReference object) with the following
elements:[¶](#appendix-A.3.2-1){.pilcrow}

[]{.break}

\"id\":
:   The Id-attribute of the XML signature, if
    present.[¶](#appendix-A.3.2-2.2){.pilcrow}
:   

\"sig_hash\":
:   The hash over the signature value
    bytes.[¶](#appendix-A.3.2-2.4){.pilcrow}
:   

\"sb_hash\":
:   The hash over the canonicalized \<ds:SignedInfo> element (the bytes
    the XML signature algorithm has signed to generate the signature
    value).[¶](#appendix-A.3.2-2.6){.pilcrow}
:   
:::
:::

::: {#xml-signed-data-reference}
::: {#appendix-A.3.3 .section}
#### [A.3.3.](#appendix-A.3.3){.section-number .selfRef} [XML Signed Data Reference Data](#name-xml-signed-data-reference-d){.section-name .selfRef} {#name-xml-signed-data-reference-d}

The SVT Signature object [MUST]{.bcp14} contain one instance of the
\"sig_data\" claim (SignedData object) for each \<ds:Reference> element
in the \<ds:SignedInfo> element. The \"sig_data\" claim [MUST]{.bcp14}
contain the following elements:[¶](#appendix-A.3.3-1){.pilcrow}

[]{.break}

\"ref\":
:   The value of the URI attribute of the corresponding \<ds:Reference>
    element.[¶](#appendix-A.3.3-2.2){.pilcrow}
:   

\"hash\":
:   The hash of all bytes that were identified by the corresponding
    \<ds:Reference> element after applying all identified
    canonicalization and transformation algorithms. These are the same
    bytes that are hashed by the hash value in the \<ds:DigestValue>
    element inside the \<ds:Reference>
    element.[¶](#appendix-A.3.3-2.4){.pilcrow}
:   
:::
:::

::: {#xml-signer-certificate-references}
::: {#appendix-A.3.4 .section}
#### [A.3.4.](#appendix-A.3.4){.section-number .selfRef} [XML Signer Certificate References](#name-xml-signer-certificate-refe){.section-name .selfRef} {#name-xml-signer-certificate-refe}

The SVT Signature object [MUST]{.bcp14} contain a \"signer_cert_ref\"
claim (CertReference object). The \"type\" parameter of the
\"signer_cert_ref\" claim [MUST]{.bcp14} be either \"chain\" or
\"chain_hash\".[¶](#appendix-A.3.4-1){.pilcrow}

-   [The \"chain\" type [MUST]{.bcp14} be used when signature validation
    was performed using one or more certificates where some or all of
    the certificates in the chain are not present in the target
    signature.[¶](#appendix-A.3.4-2.1){.pilcrow}]{#appendix-A.3.4-2.1}
-   [The \"chain_hash\" type [MUST]{.bcp14} be used when signature
    validation was performed using one or more certificates where all of
    the certificates are present in the target
    signature.[¶](#appendix-A.3.4-2.2){.pilcrow}]{#appendix-A.3.4-2.2}
:::
:::
:::
:::

::: {#xml-jose-header}
::: {#appendix-A.4 .section}
### [A.4.](#appendix-A.4){.section-number .selfRef} [JOSE Header](#name-jose-header){.section-name .selfRef} {#name-jose-header}

::: {#xml-svt-signing-key-reference}
::: {#appendix-A.4.1 .section}
#### [A.4.1.](#appendix-A.4.1){.section-number .selfRef} [SVT Signing Key Reference](#name-svt-signing-key-reference){.section-name .selfRef} {#name-svt-signing-key-reference}

The SVT JOSE header for XML signatures must contain one of the following
header parameters in accordance with \[[RFC7515](#RFC7515){.cite
.xref}\] for storing a reference to the public key used to verify the
signature on the SVT:[¶](#appendix-A.4.1-1){.pilcrow}

[]{.break}

\"x5c\":
:   Holds an X.509 certificate \[[RFC5280](#RFC5280){.cite .xref}\] or a
    chain of certificates. The certificate holding the public key that
    verifies the signature on the SVT [MUST]{.bcp14} be the first
    certificate in the chain.[¶](#appendix-A.4.1-2.2){.pilcrow}
:   

\"kid\":
:   A key identifier holding the Base64-encoded hash value of the
    certificate that can verify the signature on the SVT. The hash
    algorithm [MUST]{.bcp14} be the same hash algorithm used when
    signing the SVT as specified by the \"`alg`\" Header
    Parameter.[¶](#appendix-A.4.1-2.4){.pilcrow}
:   
:::
:::
:::
:::
:::
:::

::: {#appendix-pdf-profile}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [PDF Signature Profile](#name-pdf-signature-profile){.section-name .selfRef} {#name-pdf-signature-profile}

This appendix defines a profile for implementing SVTs with a signed PDF
document, and it defines the following aspects of SVT
usage:[¶](#appendix-B-1){.pilcrow}

-   [How to include reference data related to PDF signatures and PDF
    documents in an SVT.[¶](#appendix-B-2.1){.pilcrow}]{#appendix-B-2.1}
-   [How to add an SVT token to a PDF
    document.[¶](#appendix-B-2.2){.pilcrow}]{#appendix-B-2.2}

PDF document signatures are added as incremental updates to the signed
PDF document and signs all data of the PDF document up until the current
signature. When more than one signature is added to a PDF document the
previous signature is signed by the next signature and can not be
updated with additional data after this
event.[¶](#appendix-B-3){.pilcrow}

To minimize the impact on PDF documents with multiple signatures and to
stay backwards compatible with PDF software that does not understand
SVTs, PDF documents add one SVT token for all signatures of the PDF as
an extension to a document timestamp added to the signed PDF as an
incremental update. This SVT covers all signatures of the signed
PDF.[¶](#appendix-B-4){.pilcrow}

::: {#svt-in-pdf}
::: {#appendix-B.1 .section}
### [B.1.](#appendix-B.1){.section-number .selfRef} [SVTs in PDF Documents](#name-svts-in-pdf-documents){.section-name .selfRef} {#name-svts-in-pdf-documents}

The SVT for a signed PDF document [MAY]{.bcp14} provide signature
validation information about any of the present signatures in the PDF.
The SVT [MUST]{.bcp14} contain a separate \"sig\" claim (Signature
object) for each signature on the PDF that is covered by the
SVT.[¶](#appendix-B.1-1){.pilcrow}

An SVT added to a signed PDF document [MUST]{.bcp14} be added to a
document timestamp in accordance with ISO 32000-2:2020
\[[ISOPDF2](#ISOPDF2){.cite .xref}\].[¶](#appendix-B.1-2){.pilcrow}

The document timestamp contains an \[[RFC3161](#RFC3161){.cite .xref}\]
timestamp token (TSTInfo) in EncapsulatedContentInfo of the CMS
signature. The SVT [MUST]{.bcp14} be added to the timestamp token
(TSTInfo) as an Extension object as defined in [Appendix
B.1.1](#svt-extension-to-timestamps){.auto .internal
.xref}.[¶](#appendix-B.1-3){.pilcrow}

::: {#svt-extension-to-timestamps}
::: {#appendix-B.1.1 .section}
#### [B.1.1.](#appendix-B.1.1){.section-number .selfRef} [SVT Extension to Timestamp Tokens](#name-svt-extension-to-timestamp-){.section-name .selfRef} {#name-svt-extension-to-timestamp-}

The SVT extension is an Extension suitable to be included in TSTInfo as
defined by \[[RFC3161](#RFC3161){.cite
.xref}\].[¶](#appendix-B.1.1-1){.pilcrow}

The SVT extension is identified by the Object Identifier (OID)
1.2.752.201.5.2.[¶](#appendix-B.1.1-2){.pilcrow}

This extension data (OCTET STRING) holds the bytes of SVT JWT,
represented as a UTF-8-encoded string.[¶](#appendix-B.1.1-3){.pilcrow}

This extension [MUST NOT]{.bcp14} be marked
critical.[¶](#appendix-B.1.1-4){.pilcrow}

Note: Extensions in timestamp tokens according to
\[[RFC3161](#RFC3161){.cite .xref}\] are imported from the definition of
the X.509 certificate extensions defined in \[[RFC5280](#RFC5280){.cite
.xref}\].[¶](#appendix-B.1.1-5){.pilcrow}
:::
:::
:::
:::

::: {#pdf-svt-claims}
::: {#appendix-B.2 .section}
### [B.2.](#appendix-B.2){.section-number .selfRef} [PDF Signature SVT Claims](#name-pdf-signature-svt-claims){.section-name .selfRef} {#name-pdf-signature-svt-claims}

::: {#pdf-profile-identifier}
::: {#appendix-B.2.1 .section}
#### [B.2.1.](#appendix-B.2.1){.section-number .selfRef} [PDF Profile Identifier](#name-pdf-profile-identifier){.section-name .selfRef} {#name-pdf-profile-identifier}

When this profile is used, the SigValidation object [MUST]{.bcp14}
contain a \"profile\" claim with the value
\"PDF\".[¶](#appendix-B.2.1-1){.pilcrow}
:::
:::

::: {#pdf-signature-reference-data}
::: {#appendix-B.2.2 .section}
#### [B.2.2.](#appendix-B.2.2){.section-number .selfRef} [PDF Signature Reference Data](#name-pdf-signature-reference-dat){.section-name .selfRef} {#name-pdf-signature-reference-dat}

The SVT Signature object [MUST]{.bcp14} contain a \"sig_ref\" claim
(SigReference object) with the following
elements:[¶](#appendix-B.2.2-1){.pilcrow}

[]{.break}

\"id\":
:   Absent or a Null value.[¶](#appendix-B.2.2-2.2){.pilcrow}
:   

\"sig_hash\":
:   The hash over the signature value
    bytes.[¶](#appendix-B.2.2-2.4){.pilcrow}
:   

\"sb_hash\":
:   The hash over the DER-encoded SignedAttributes in
    SignerInfo.[¶](#appendix-B.2.2-2.6){.pilcrow}
:   
:::
:::

::: {#pdf-signed-data-reference}
::: {#appendix-B.2.3 .section}
#### [B.2.3.](#appendix-B.2.3){.section-number .selfRef} [PDF Signed Data Reference Data](#name-pdf-signed-data-reference-d){.section-name .selfRef} {#name-pdf-signed-data-reference-d}

The SVT Signature object [MUST]{.bcp14} contain one instance of the
\"sig_data\" claim (SignedData object) with the following
elements:[¶](#appendix-B.2.3-1){.pilcrow}

[]{.break}

\"ref\":
:   The string representation of the ByteRange value of the PDF
    signature dictionary of the target signature. This is a sequence of
    integers separated by space where each integer pair specifies the
    start index and length of a byte
    range.[¶](#appendix-B.2.3-2.2){.pilcrow}
:   

\"hash\":
:   The hash of all bytes identified by the ByteRange value. This is the
    concatenation of all byte ranges identified by the ByteRange
    value.[¶](#appendix-B.2.3-2.4){.pilcrow}
:   
:::
:::

::: {#pdf-signer-certificate-references}
::: {#appendix-B.2.4 .section}
#### [B.2.4.](#appendix-B.2.4){.section-number .selfRef} [PDF Signer Certificate References](#name-pdf-signer-certificate-refe){.section-name .selfRef} {#name-pdf-signer-certificate-refe}

The SVT Signature object [MUST]{.bcp14} contain a \"signer_cert_ref\"
claim (CertReference object). The \"type\" parameter of the
\"signer_cert_ref\" claim [MUST]{.bcp14} be either \"chain\" or
\"chain_hash\".[¶](#appendix-B.2.4-1){.pilcrow}

-   [The \"chain\" type [MUST]{.bcp14} be used when signature validation
    was performed using one or more certificates where some or all of
    the certificates in the chain are not present in the target
    signature.[¶](#appendix-B.2.4-2.1){.pilcrow}]{#appendix-B.2.4-2.1}
-   [The \"chain_hash\" type [MUST]{.bcp14} be used when signature
    validation was performed using one or more certificates where all of
    the certificates are present in the target
    signature.[¶](#appendix-B.2.4-2.2){.pilcrow}]{#appendix-B.2.4-2.2}

Note: The referenced signer certificate [MUST]{.bcp14} match any
certificates referenced using ESSCertID or ESSCertIDv2 from
\[[RFC5035](#RFC5035){.cite .xref}\].[¶](#appendix-B.2.4-3){.pilcrow}
:::
:::
:::
:::

::: {#pdf-jose-header}
::: {#appendix-B.3 .section}
### [B.3.](#appendix-B.3){.section-number .selfRef} [JOSE Header](#name-jose-header-2){.section-name .selfRef} {#name-jose-header-2}

::: {#pdf-svt-signing-key-reference}
::: {#appendix-B.3.1 .section}
#### [B.3.1.](#appendix-B.3.1){.section-number .selfRef} [SVT Signing Key Reference](#name-svt-signing-key-reference-2){.section-name .selfRef} {#name-svt-signing-key-reference-2}

The SVT JOSE header must contain one of the following header parameters
in accordance with \[[RFC7515](#RFC7515){.cite .xref}\] for storing a
reference to the public key used to verify the signature on the
SVT:[¶](#appendix-B.3.1-1){.pilcrow}

[]{.break}

\"x5c\":
:   Holds an X.509 certificate \[[RFC5280](#RFC5280){.cite .xref}\] or a
    chain of certificates. The certificate holding the public key that
    verifies the signature on the SVT [MUST]{.bcp14} be the first
    certificate in the chain.[¶](#appendix-B.3.1-2.2){.pilcrow}
:   

\"kid\":
:   A key identifier holding the Base64-encoded hash value of the
    certificate that can verify the signature on the SVT. The hash
    algorithm [MUST]{.bcp14} be the same hash algorithm used when
    signing the SVT as specified by the \"`alg`\" Header Parameter. The
    referenced certificate [SHOULD]{.bcp14} be the same certificate that
    was used to sign the document timestamp that contains the
    SVT.[¶](#appendix-B.3.1-2.4){.pilcrow}
:   
:::
:::
:::
:::
:::
:::

::: {#appendix-jws-profile}
::: {#appendix-C .section}
## [Appendix C.](#appendix-C){.section-number .selfRef} [JWS Profile](#name-jws-profile){.section-name .selfRef} {#name-jws-profile}

This appendix defines a profile for implementing SVTs with a JWS signed
payload according to \[[RFC7515](#RFC7515){.cite .xref}\], and it
defines the following aspects of SVT usage:[¶](#appendix-C-1){.pilcrow}

-   [How to include reference data related to JWS signatures in an
    SVT.[¶](#appendix-C-2.1){.pilcrow}]{#appendix-C-2.1}
-   [How to add an SVT token to JWS
    signatures.[¶](#appendix-C-2.2){.pilcrow}]{#appendix-C-2.2}

A JWS may have one or more signatures, depending on its serialization
format, signing the same payload data. A JWS either contains the data to
be signed (enveloping) or may sign any externally associated payload
data (detached).[¶](#appendix-C-3){.pilcrow}

To provide a generic solution for JWS, an SVT is added to each present
signature as a JWS Unprotected Header. If a JWS includes multiple
signatures, then each signature includes its own
SVT.[¶](#appendix-C-4){.pilcrow}

::: {#svt-in-jws}
::: {#appendix-C.1 .section}
### [C.1.](#appendix-C.1){.section-number .selfRef} [SVT in JWS](#name-svt-in-jws){.section-name .selfRef} {#name-svt-in-jws}

An SVT token [MAY]{.bcp14} be added to any signature of a JWS to support
validation of that signature. If more than one signature is present,
then each present SVT [MUST]{.bcp14} provide information exclusively
related to one associated signature and [MUST NOT]{.bcp14} include
information about any other signature in the
JWS.[¶](#appendix-C.1-1){.pilcrow}

Each SVT is stored in its associated signature\'s \"svt\" header as
defined in [Appendix C.1.1](#svt-header){.auto .internal
.xref}.[¶](#appendix-C.1-2){.pilcrow}

::: {#svt-header}
::: {#appendix-C.1.1 .section}
#### [C.1.1.](#appendix-C.1.1){.section-number .selfRef} [\"svt\" Header Parameter](#name-svt-header-parameter){.section-name .selfRef} {#name-svt-header-parameter}

The \"svt\" (Signature Validation Token) Header Parameter is used to
contain an array of SVT tokens to support validation of the associated
signature. Each SVT token in the array has the format of a JWT as
defined in \[[RFC7519](#RFC7519){.cite .xref}\] and is stored using its
natural string representation without further wrapping or
encoding.[¶](#appendix-C.1.1-1){.pilcrow}

The \"svt\" Header Parameter, when used, [MUST]{.bcp14} be included as a
JWS Unprotected Header.[¶](#appendix-C.1.1-2){.pilcrow}

Note: A JWS Unprotected Header is not supported with JWS Compact
Serialization. A consequence of adding an SVT token to a JWS is
therefore that JWS JSON Serialization [MUST]{.bcp14} be used either in
the form of general JWS JSON Serialization (for one or more signatures)
or in the form of flattened JWS JSON Serialization (optionally used when
only one signature is present in the
JWS).[¶](#appendix-C.1.1-3){.pilcrow}
:::
:::

::: {#jws-multiple-svt-tokens}
::: {#appendix-C.1.2 .section}
#### [C.1.2.](#appendix-C.1.2){.section-number .selfRef} [Multiple SVTs in a JWS Signature](#name-multiple-svts-in-a-jws-sign){.section-name .selfRef} {#name-multiple-svts-in-a-jws-sign}

If a new SVT is stored in a signature that already contains a previously
issued SVT, implementations can choose either to replace the existing
SVT or to store the new SVT in addition to the existing
SVT.[¶](#appendix-C.1.2-1){.pilcrow}

If a JWS signature already contains an array of SVTs and a new SVT is to
be added, then the new SVT [MUST]{.bcp14} be added to the array of SVT
tokens in the existing \"svt\" Header
Parameter.[¶](#appendix-C.1.2-2){.pilcrow}
:::
:::
:::
:::

::: {#jws-svt-claims}
::: {#appendix-C.2 .section}
### [C.2.](#appendix-C.2){.section-number .selfRef} [JWS Signature SVT Claims](#name-jws-signature-svt-claims){.section-name .selfRef} {#name-jws-signature-svt-claims}

::: {#jws-profile-identifier}
::: {#appendix-C.2.1 .section}
#### [C.2.1.](#appendix-C.2.1){.section-number .selfRef} [JWS Profile Identifier](#name-jws-profile-identifier){.section-name .selfRef} {#name-jws-profile-identifier}

When this profile is used, the SigValidation object [MUST]{.bcp14}
contain a \"profile\" claim with the value
\"JWS\".[¶](#appendix-C.2.1-1){.pilcrow}
:::
:::

::: {#jws-signature-reference-data}
::: {#appendix-C.2.2 .section}
#### [C.2.2.](#appendix-C.2.2){.section-number .selfRef} [JWS Signature Reference Data](#name-jws-signature-reference-dat){.section-name .selfRef} {#name-jws-signature-reference-dat}

The SVT Signature object [MUST]{.bcp14} contain a \"sig_ref\" claim
(SigReference object) with the following
elements:[¶](#appendix-C.2.2-1){.pilcrow}

[]{.break}

\"sig_hash\":
:   The hash over the associated signature value (the bytes of the
    base64url-decoded signature
    parameter).[¶](#appendix-C.2.2-2.2){.pilcrow}
:   

\"sb_hash\":
:   The hash over all bytes signed by the associated signature (the JWS
    Signing Input according to \[[RFC7515](#RFC7515){.cite
    .xref}\]).[¶](#appendix-C.2.2-2.4){.pilcrow}
:   
:::
:::

::: {#jws-signed-data-reference}
::: {#appendix-C.2.3 .section}
#### [C.2.3.](#appendix-C.2.3){.section-number .selfRef} [JWS Signed Data Reference Data](#name-jws-signed-data-reference-d){.section-name .selfRef} {#name-jws-signed-data-reference-d}

The SVT Signature object [MUST]{.bcp14} contain one instance of the
\"sig_data\" claim (SignedData object) with the following
elements:[¶](#appendix-C.2.3-1){.pilcrow}

[]{.break}

\"ref\":

:   This parameter [MUST]{.bcp14} hold one of the following three
    possible values:[¶](#appendix-C.2.3-2.2.1){.pilcrow}

    1.  [The explicit string value \"payload\" if the signed JWS Payload
        is embedded in a \"payload\" member of the
        JWS.[¶](#appendix-C.2.3-2.2.2.1){.pilcrow}]{#appendix-C.2.3-2.2.2.1}
    2.  [The explicit string value \"detached\" if the JWS signs
        detached payload data without explicit
        reference.[¶](#appendix-C.2.3-2.2.2.2){.pilcrow}]{#appendix-C.2.3-2.2.2.2}
    3.  [A URI that can be used to identify or fetch the detached Signed
        Data. The means to determine the URI for the detached Signed
        Data is outside the scope of this
        specification.[¶](#appendix-C.2.3-2.2.2.3){.pilcrow}]{#appendix-C.2.3-2.2.2.3}

:   

\"hash\":
:   The hash over the JWS Payload data bytes (not its base64url-encoded
    string representation).[¶](#appendix-C.2.3-2.4){.pilcrow}
:   
:::
:::

::: {#jws-signer-certificate-references}
::: {#appendix-C.2.4 .section}
#### [C.2.4.](#appendix-C.2.4){.section-number .selfRef} [JWS Signer Certificate References](#name-jws-signer-certificate-refe){.section-name .selfRef} {#name-jws-signer-certificate-refe}

The SVT Signature object [MUST]{.bcp14} contain a \"signer_cert_ref\"
claim (CertReference object). The \"type\" parameter of the
\"signer_cert_ref\" claim [MUST]{.bcp14} be either \"chain\" or
\"chain_hash\".[¶](#appendix-C.2.4-1){.pilcrow}

-   [The \"chain\" type [MUST]{.bcp14} be used when signature validation
    was performed using one or more certificates where some or all of
    the certificates in the chain are not present in the target
    signature.[¶](#appendix-C.2.4-2.1){.pilcrow}]{#appendix-C.2.4-2.1}
-   [The \"chain_hash\" type [MUST]{.bcp14} be used when signature
    validation was performed using one or more certificates where all of
    the certificates are present in the target signature JOSE header
    using the \"x5c\" Header
    Parameter.[¶](#appendix-C.2.4-2.2){.pilcrow}]{#appendix-C.2.4-2.2}
:::
:::
:::
:::

::: {#jws-svt-jose-header}
::: {#appendix-C.3 .section}
### [C.3.](#appendix-C.3){.section-number .selfRef} [SVT JOSE Header](#name-svt-jose-header-2){.section-name .selfRef} {#name-svt-jose-header-2}

::: {#jws-svt-signing-key-reference}
::: {#appendix-C.3.1 .section}
#### [C.3.1.](#appendix-C.3.1){.section-number .selfRef} [SVT Signing Key Reference](#name-svt-signing-key-reference-3){.section-name .selfRef} {#name-svt-signing-key-reference-3}

The SVT JOSE header must contain one of the following header parameters
in accordance with \[[RFC7515](#RFC7515){.cite .xref}\] for storing a
reference to the public key used to verify the signature on the
SVT:[¶](#appendix-C.3.1-1){.pilcrow}

[]{.break}

\"x5c\":
:   Holds an X.509 certificate \[[RFC5280](#RFC5280){.cite .xref}\] or a
    chain of certificates. The certificate holding the public key that
    verifies the signature on the SVT [MUST]{.bcp14} be the first
    certificate in the chain.[¶](#appendix-C.3.1-2.2){.pilcrow}
:   

\"kid\":
:   A key identifier holding the Base64-encoded hash value of the
    certificate that can verify the signature on the SVT. The hash
    algorithm [MUST]{.bcp14} be the same hash algorithm used when
    signing the SVT as specified by the \"`alg`\" Header
    Parameter.[¶](#appendix-C.3.1-2.4){.pilcrow}
:   
:::
:::
:::
:::
:::
:::

::: {#schema-appendix}
::: {#appendix-D .section}
## [Appendix D.](#appendix-D){.section-number .selfRef} [Schemas](#name-schemas){.section-name .selfRef} {#name-schemas}

::: {#concise-data-definition-language-cddl}
::: {#appendix-D.1 .section}
### [D.1.](#appendix-D.1){.section-number .selfRef} [Concise Data Definition Language (CDDL)](#name-concise-data-definition-lan){.section-name .selfRef} {#name-concise-data-definition-lan}

The following informative CDDL \[[RFC8610](#RFC8610){.cite .xref}\]
expresses the structure of an SVT token:[¶](#appendix-D.1-1){.pilcrow}

::: {#appendix-D.1-2}
``` {.breakable .lang-cddl .sourcecode}
svt = {
  jti: text
  iss: text
  iat: uint
  ? aud: text / [* text]
  ? exp: uint
  sig_val_claims: SigValClaims
}

SigValClaims = {
  ver: text
  profile: text
  hash_algo: text
  sig: [+ Signature]
  ? ext: Extension
}

Signature = {
  sig_ref: SigReference
  sig_data_ref: [+ SignedDataReference]
  signer_cert_ref: CertReference
  sig_val: [+ PolicyValidation]
  ? time_val: [* TimeValidation]
  ? ext: Extension
}

SigReference = {
  ? id: text / null
  sig_hash: binary-value
  sb_hash: binary-value
}

SignedDataReference = {
  ref: text
  hash: binary-value
}


CertReference = {
  type: "chain" / "chain_hash"
  ref: [+ text]
}

PolicyValidation = {
  pol: text
  res: "PASSED" / "FAILED" / "INDETERMINATE"
  ? msg: text / null
  ? ext: Extension
}

TimeValidation = {
  "time": uint
  type: text
  iss: text
  ? id: text / null
  ? hash: binary-value / null
  ? val: [* PolicyValidation]
  ? ext: Extension
}


Extension = {
  + text => text
} / null

binary-value = text             ; base64 classic with padding
```

[¶](#appendix-D.1-2){.pilcrow}
:::
:::
:::

::: {#json-schema}
::: {#appendix-D.2 .section}
### [D.2.](#appendix-D.2){.section-number .selfRef} [JSON Schema](#name-json-schema){.section-name .selfRef} {#name-json-schema}

The following informative JSON schema describes the syntax of the SVT
token payload.[¶](#appendix-D.2-1){.pilcrow}

::: {#appendix-D.2-2}
``` {.breakable .lang-json .sourcecode}
{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "Signature Validation Token JSON Schema",
    "description": "Schema defining the payload format for SVTs",
    "type": "object",
    "required": [
        "jti",
        "iss",
        "iat",
        "sig_val_claims"
    ],
    "properties": {
        "jti": {
            "description": "JWT ID",
            "type": "string"
        },
        "iss": {
            "description": "Issuer",
            "type": "string"
        },
        "iat": {
            "description": "Issued At",
            "type": "integer"
        },
        "aud": {
            "description": "Audience",
            "type": [
                "string",
                "array"
            ],
            "items": {"type": "string"}
        },
        "exp": {
            "description": "Expiration time (seconds since epoch)",
            "type": "integer"
        },
        "sig_val_claims": {
            "description": "Signature validation claims",
            "type": "object",
            "required": [
                "ver",
                "profile",
                "hash_algo",
                "sig"
            ],
            "properties": {
                "ver": {
                    "description": "Version",
                    "type": "string"
                },
                "profile": {
                    "description": "Implementation profile",
                    "type": "string"
                },
                "hash_algo": {
                    "description": "Hash algorithm URI",
                    "type": "string"
                },
                "sig": {
                    "description": "Validated signatures",
                    "type": "array",
                    "items": {
                        "$ref": "#/$def/Signature"
                    },
                    "minItems": 1
                },
                "ext": {
                    "description": "Extension map",
                    "$ref": "#/$def/Extension"
                }
            },
            "additionalProperties": false
        }
    },
"additionalProperties": false,
"$def": {
         "Signature":{
             "type": "object",
             "required": [
                 "sig_ref",
                 "sig_data_ref",
                 "signer_cert_ref",
                 "sig_val"
             ],
             "properties": {
                 "sig_ref": {
                     "description": "Signature Reference",
                     "$ref": "#/$def/SigReference"
                 },
                 "sig_data_ref": {
                     "description": "Signed data array",
                     "type": "array",
                     "items": {
                         "$ref" : "#/$def/SignedDataReference"
                     },
                     "minItems": 1
                 },
                 "signer_cert_ref": {
                     "description": "Signer certificate reference",
                     "$ref": "#/$def/CertReference"
                 },
                 "sig_val": {
                     "description": "Signature validation results",
                     "type": "array",
                     "items": {
                         "$ref": "#/$def/PolicyValidation"
                     },
                     "minItems": 1
                 },
                 "time_val": {
                     "description": "Time validations",
                     "type": "array",
                     "items": {
                         "$ref": "#/$def/TimeValidation"
                     }
                 },
                "ext": {
                    "description": "Extension map",
                    "$ref": "#/$def/Extension"
                }
             },
             "additionalProperties": false
         },
         "SigReference":{
             "type": "object",
             "required": [
                 "sig_hash",
                 "sb_hash"
             ],
             "properties": {
                 "sig_hash": {
                     "description": "Hash of the signature value",
                     "type": "string",
                     "format": "base64"
                 },
                 "sb_hash": {
                     "description": "Hash of the Signed Bytes",
                     "type": "string",
                     "format": "base64"
                 },
                 "id": {
                     "description": "Signature ID reference",
                     "type": ["string","null"]
                 }
             },
            "additionalProperties": false
         },
         "SignedDataReference": {
             "type": "object",
             "required": [
                 "ref",
                 "hash"
             ],
             "properties": {
                 "ref": {
                     "description": "Reference to the signed data",
                     "type": "string"
                 },
                 "hash": {
                     "description": "Signed data hash",
                     "type": "string",
                     "format": "base64"
                 }
             },
            "additionalProperties": false
         },
         "CertReference":{
             "type": "object",
             "required": [
                 "type",
                 "ref"
             ],
             "properties": {
                 "type": {
                     "description": "Type of certificate reference",
                     "type": "string",
                     "enum": ["chain","chain_hash"]
                 },
                 "ref": {
                     "description": "Certificate reference data",
                     "type": "array",
                     "items": {
                         "type": "string",
                         "format": "base64"
                     },
                     "minItems": 1
                 }
             },
            "additionalProperties": false
         },
         "PolicyValidation":{
             "type": "object",
             "required": [
                 "pol",
                 "res"
             ],
             "properties": {
                 "pol": {
                     "description": "Policy identifier",
                     "type": "string"
                 },
                 "res": {
                     "description": "Signature validation result",
                     "type": "string",
                     "enum": ["PASSED","FAILED","INDETERMINATE"]
                 },
                 "msg": {
                     "description": "Message",
                     "type": ["string","null"]
                 },
                 "ext": {
                    "description": "Extension map",
                    "$ref": "#/$def/Extension"
                }
             },
            "additionalProperties": false
         },
         "TimeValidation":{
             "type": "object",
             "required": [
                 "time",
                 "type",
                 "iss"
             ],
             "properties": {
                 "time": {
                     "description": "Verified time",
                     "type": "integer"
                 },
                 "type": {
                     "description": "Type of time validation proof",
                     "type": "string"
                 },
                 "iss": {
                     "description": "Issuer of the time proof",
                     "type": "string"
                 },
                 "id": {
                     "description": "Time evidence identifier",
                     "type": ["string","null"]

                 },
                 "hash": {
                     "description": "Hash of time evidence",
                     "type": ["string","null"],
                     "format": "base64"
                 },
                 "val": {
                     "description": "Validation result",
                     "type": "array",
                     "items": {
                         "$ref": "#/$def/PolicyValidation"
                     }
                 },
                 "ext": {
                    "description": "Extension map",
                    "$ref": "#/$def/Extension"
                }
             },
            "additionalProperties": false
         },
         "Extension": {
           "description": "Extension map",
           "type": ["object","null"],
           "required": [],
           "additionalProperties": {
               "type": "string"
           }
         }
     }
}
```

[¶](#appendix-D.2-2){.pilcrow}
:::
:::
:::
:::
:::

::: {#appendix-examples}
::: {#appendix-E .section}
## [Appendix E.](#appendix-E){.section-number .selfRef} [Examples](#name-examples){.section-name .selfRef} {#name-examples}

The following example illustrates a basic SVT according to this
specification issued for a signed PDF
document.[¶](#appendix-E-1){.pilcrow}

Note: Line breaks in the decoded example are inserted for readability.
Line breaks are not allowed in valid JSON
data.[¶](#appendix-E-2){.pilcrow}

Signature validation token JWT:[¶](#appendix-E-3){.pilcrow}

::: {#appendix-E-4}
``` sourcecode
eyJraWQiOiJPZW5JKzQzNEpoYnZmRG50ZlZcLzhyT3hHN0ZrdnlqYUtWSmFWcUlG
QlhvaFZoQWU1Zks4YW5vdjFTNjg4cjdLYmFsK2Z2cGFIMWo4aWJnNTJRQnkxUFE9
PSIsInR5cCI6IkpXVCIsImFsZyI6IlJTNTEyIn0.eyJhdWQiOiJodHRwOlwvXC9l
eGFtcGxlLmNvbVwvYXVkaWVuY2UxIiwiaXNzIjoiaHR0cHM6XC9cL3N3ZWRlbmNv
bm5lY3Quc2VcL3ZhbGlkYXRvciIsImlhdCI6MTYwMzQ1ODQyMSwianRpIjoiNGQx
Mzk2ZjFmZjcyOGY0MGQ1MjQwM2I2MWM1NzQ0ODYiLCJzaWdfdmFsX2NsYWltcyI6
eyJzaWciOlt7ImV4dCI6bnVsbCwic2lnX3ZhbCI6W3sibXNnIjoiT0siLCJleHQi
Om51bGwsInJlcyI6IlBBU1NFRCIsInBvbCI6Imh0dHA6XC9cL2lkLnN3ZWRlbmNv
bm5lY3Quc2VcL3N2dFwvc2lndmFsLXBvbGljeVwvdHMtcGtpeFwvMDEifV0sInNp
Z19yZWYiOnsic2lnX2hhc2giOiJ5Y2VQVkxJemRjcEs5N0lZT2hGSWYxbnk3OUht
SUNiU1Z6SWVaTmJpem83ckdJd0hOTjB6WElTeUtHakN2bm9uT2FRR2ZMXC9QM3ZE
dEI4OHlLU1dlWGc9PSIsImlkIjoiaWQtNzM5ODljNmZjMDYzNjM2YWI1ZTc1M2Yx
MGY3NTc0NjciLCJzYl9oYXNoIjoiQm9QVjRXQ0E5c0FJYWhqSzFIYWpmRnhpK0F6
QzRKR1R1ZjM5VzNaV2pjekRDVVJ4ZGM5WWV0ZUh0Y3hHVmVnZ3B4SEo3NVwvY1E3
SE4xZERkbGl5SXdnPT0ifSwic2lnbmVyX2NlcnRfcmVmIjp7InJlZiI6WyIxK2Fh
SmV0ZzdyZWxFUmxVRFlFaVU0WklaaFQ0UlV2aUlRWnVLN28xR0ZLYVRQUTZ5K2t4
XC9QTnREcnB1cVE2WGZya0g5d1lESzRleTB5NFdyTkVybnc9PSIsImg0UER4YjVa
S214MWVUU3F2VnZZRzhnMzNzMDVKendCK05nRUhGVTRnYzl0cUcwa2dIa2Y2VzNv
THprVHd3dXJJaDZZOUFhZlpZcWMyelAycEUycDRRPT0iLCJEZDJDNXNCMElPUWVN
Vm5FQmtNNVE5Vzk2bUJITnd3YTJ0elhNcytMd3VZY09VdlBrcnlHUjBhUEc4Tzlu
SVAzbGJ3NktqUTFoRG1SazZ6Qzh4MmpkZz09Il0sInR5cGUiOiJjaGFpbl9oYXNo
In0sInNpZ19kYXRhX3JlZiI6W3sicmVmIjoiIiwiaGFzaCI6IkZjR3BPT2Y4aWxj
UHQyMUdEZDJjR25MR0R4UlM1ajdzdk00YXBwMkg0MWRERUxtMkN6Y2VUWTAybmRl
SmZXamludG1RMzc2SWxYVE9BcjMxeXpZenNnPT0ifSx7InJlZiI6IiN4YWRlcy0x
MWExNTVkOTJiZjU1Nzc0NjEzYmI3YjY2MTQ3N2NmZCIsImhhc2giOiJLUmtnYlo2
UFwvbmhVNjNJTWswR2lVZlVcL0RUd3ZlWWl0ZVFrd0dlSnFDNUJ6VE5WOGJRYnBl
ZFRUdVdKUHhxdkowUlk4NGh3bTdlWVwvZzBIckFPZWdLdz09In1dLCJ0aW1lX3Zh
bCI6W119XSwiZXh0IjpudWxsLCJ2ZXIiOiIxLjAiLCJwcm9maWxlIjoiWE1MIiwi
aGFzaF9hbGdvIjoiaHR0cDpcL1wvd3d3LnczLm9yZ1wvMjAwMVwvMDRcL3htbGVu
YyNzaGE1MTIifX0.TdHCoIUSZj2zMINKg7E44-8VE_mJq6TG1OoPwnYSs_hyUbuX
mrLJpuk8GR5YrndeOucPUYAwPxHt_f68JIQyFTi0agO9VJjn1R7Pj3Jt6WG9pYVN
n5LH-D1maxD11ZxxbcYeHbsstd2Sy2uMa3BdpsstGdPymSmc6GxY5uJoL0-5vwo_
3l-4Bb3LCTiuxYPcmztKIbDy2hEgJ3Hx1K4HF0SHgn3InpqBev3hm2SLw3hH5BCM
rywBAhHYE6OGE0aOJ6ktA5UP0jIIHfaw9i1wIiJtHTaGuvtyWSLk5cshmun9Hkdk
kRTA75bzuq0Iyd0qh070rA8Gje-s4Tw4xzttgKx1KSkvy8n5FqvzWdsZvclCG2mY
Y9rMxh_7607NXcxajAP4yDOoKNs5nm937ULe0vCN8a7WTrFuiaGjry7HhzRM4C5A
qxbDOBXPLyoMr4qn4LRJCHxOeLZ6o3ugvDOOWsyjk3eliyBwDu8qJH7UmyicLxDc
Cr0hUK_kvREqjD2Z
```

[¶](#appendix-E-4){.pilcrow}
:::

Decoded JWT Header:[¶](#appendix-E-5){.pilcrow}

::: {#appendix-E-6}
``` sourcecode
{
  "kid":"OenI+434JhbvfDntfV\/8rOxG7FkvyjaKVJaVqIFBXohVhAe5fK8anov
         1S688r7Kbal+fvpaH1j8ibg52QBy1PQ==",
  "typ":"JWT",
  "alg":"RS512"
}
```

[¶](#appendix-E-6){.pilcrow}
:::

Decoded JWT Claims:[¶](#appendix-E-7){.pilcrow}

::: {#appendix-E-8}
``` sourcecode
{
  "aud" : "http://example.com/audience1",
  "iss" : "https://swedenconnect.se/validator",
  "iat" : 1603458421,
  "jti" : "4d1396f1ff728f40d52403b61c574486",
  "sig_val_claims" : {
    "sig" : [ {
      "ext" : null,
      "sig_val" : [ {
        "msg" : "OK",
        "ext" : null,
        "res" : "PASSED",
        "pol" : "http://id.swedenconnect.se/svt/sigval-policy/
                 ts-pkix/01"
      } ],
      "sig_ref" : {
        "sig_hash" : "ycePVLIzdcpK97IYOhFIf1ny79HmICbSVzIeZNbizo7rGIw
                      HNN0zXISyKGjCvnonOaQGfL/P3vDtB88yKSWeXg==",
        "id" : "id-73989c6fc063636ab5e753f10f757467",
        "sb_hash" : "BoPV4WCA9sAIahjK1HajfFxi+AzC4JGTuf39W3ZWjczDCURx
                     dc9YeteHtcxGVeggpxHJ75/cQ7HN1dDdliyIwg=="
      },
      "signer_cert_ref" : {
        "ref" : [ "1+aaJetg7relERlUDYEiU4ZIZhT4RUviIQZuK7o1GFKaTPQ6y+
                   kx/PNtDrpuqQ6XfrkH9wYDK4ey0y4WrNErnw==",
                  "h4PDxb5ZKmx1eTSqvVvYG8g33s05JzwB+NgEHFU4gc9tqG0kgH
                   kf6W3oLzkTwwurIh6Y9AafZYqc2zP2pE2p4Q==",
                  "Dd2C5sB0IOQeMVnEBkM5Q9W96mBHNwwa2tzXMs+LwuYcOUvPkr
                   yGR0aPG8O9nIP3lbw6KjQ1hDmRk6zC8x2jdg==" ],
        "type" : "chain_hash"
      },
      "sig_data_ref" : [ {
        "ref" : "",
        "hash" : "FcGpOOf8ilcPt21GDd2cGnLGDxRS5j7svM4app2H41dDELm2Czc
                  eTY02ndeJfWjintmQ376IlXTOAr31yzYzsg=="
      }, {
        "ref" : "#xades-11a155d92bf55774613bb7b661477cfd",
        "hash" : "KRkgbZ6P/nhU63IMk0GiUfU/DTwveYiteQkwGeJqC5BzTNV8bQb
                  pedTTuWJPxqvJ0RY84hwm7eY/g0HrAOegKw=="
      } ],
      "time_val" : [ ]
    } ],
    "ext" : null,
    "ver" : "1.0",
    "profile" : "XML",
    "hash_algo" : "http://www.w3.org/2001/04/xmlenc#sha512"
  }
}
```

[¶](#appendix-E-8){.pilcrow}
:::
:::
:::

::: {#authors-addresses}
::: {#appendix-F .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Stefan Santesson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[IDsec Solutions AB]{.org}
:::

::: {.left dir="auto"}
[Forskningsbyn Ideon]{.street-address}
:::

::: {.left dir="auto"}
SE-[223 70]{.postal-code} [Lund]{.locality}
:::

::: {.left dir="auto"}
[Sweden]{.country-name}
:::

::: email
Email: <sts@aaa-sec.com>
:::

::: {.left dir="auto"}
[Russ Housley]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Vigil Security, LLC]{.org}
:::

::: {.left dir="auto"}
[516 Dranesville Road]{.street-address}
:::

::: {.left dir="auto"}
[Herndon]{.locality}, [VA]{.region} [20170]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <housley@vigilsec.com>
:::
:::
:::
