  RFC 9242   Intermediate IKEv2 Exchange   May 2022
  ---------- ----------------------------- ----------
  Smyslov    Standards Track               \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9242](https://www.rfc-editor.org/rfc/rfc9242){.eref}

Category:
:   Standards Track

Published:
:   May 2022

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    V. Smyslov
    :::

    ::: org
    ELVIS-PLUS
    :::
    :::
:::

# RFC 9242 {#rfcnum}

# Intermediate Exchange in the Internet Key Exchange Protocol Version 2 (IKEv2) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document defines a new exchange, called \"Intermediate Exchange\",
for the Internet Key Exchange Protocol Version 2 (IKEv2). This exchange
can be used for transferring large amounts of data in the process of
IKEv2 Security Association (SA) establishment. An example of the need to
do this is using key exchange methods resistant to Quantum Computers
(QCs) for IKE SA establishment. The Intermediate Exchange makes it
possible to use the existing IKE fragmentation mechanism (which cannot
be used in the initial IKEv2 exchange), helping to avoid IP
fragmentation of large IKE messages if they need to be sent before IKEv2
SA is established.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9242>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology and
    Notation](#name-terminology-and-notation){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Intermediate Exchange
    Details](#name-intermediate-exchange-detai){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Support for Intermediate Exchange
        Negotiation](#name-support-for-intermediate-ex){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Using Intermediate
        Exchange](#name-using-intermediate-exchange){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [The IKE_INTERMEDIATE Exchange
        Protection and
        Authentication](#name-the-ike_intermediate-exchan){.xref}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [Protection of
            IKE_INTERMEDIATE
            Messages](#name-protection-of-ike_intermedi){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.2}
            [3.3.2](#section-3.3.2){.xref}.  [Authentication of
            IKE_INTERMEDIATE
            Exchanges](#name-authentication-of-ike_inter){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Error Handling in the
        IKE_INTERMEDIATE
        Exchange](#name-error-handling-in-the-ike_i){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Interaction with Other IKEv2
    Extensions](#name-interaction-with-other-ikev){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [Appendix A](#appendix-A){.xref}.  [Example of IKE_INTERMEDIATE
    Exchange](#name-example-of-ike_intermediate){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [](#appendix-B){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [](#appendix-C){.xref}[Author\'s
    Address](#name-authors-address){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Internet Key Exchange Protocol Version 2 (IKEv2) defined in
\[[RFC7296](#RFC7296){.xref}\] uses UDP as a transport for its messages.
If the size of a message is larger than the Path MTU (PMTU), IP
fragmentation takes place, which has been shown to cause operational
challenges in certain network configurations and devices. The problem is
described in more detail in \[[RFC7383](#RFC7383){.xref}\], which also
defines an extension to IKEv2 called \"IKE fragmentation\". This
extension allows IKE messages to be fragmented at the IKE level,
eliminating possible issues caused by IP fragmentation. However, IKE
fragmentation cannot be used in the initial IKEv2 exchange
(IKE_SA_INIT). In most cases, this limitation is not a problem, since
the IKE_SA_INIT messages are usually small enough not to cause IP
fragmentation.[¶](#section-1-1){.pilcrow}

However, the situation has been changing recently. One example of the
need to transfer large amounts of data before an IKE SA is created is
using the QC-resistant key exchange methods in IKEv2. Recent progress in
quantum computing has led to concern that classical Diffie-Hellman key
exchange methods will become insecure in the relatively near future and
should be replaced with QC-resistant ones. Currently, most QC-resistant
key exchange methods have large public keys. If these keys are exchanged
in the IKE_SA_INIT exchange, then IP fragmentation will probably take
place; therefore, all the problems caused by it will become
inevitable.[¶](#section-1-2){.pilcrow}

A possible solution to this problem would be to use TCP as a transport
for IKEv2, as defined in \[[RFC8229](#RFC8229){.xref}\]. However, this
approach has significant drawbacks and is intended to be a last resort
when UDP transport is completely blocked by intermediate network
devices.[¶](#section-1-3){.pilcrow}

This specification describes a way to transfer a large amount of data in
IKEv2 using UDP transport. For this purpose, the document defines a new
exchange for IKEv2 called \"Intermediate Exchange\" or
\"IKE_INTERMEDIATE\". One or more of these exchanges may take place
right after the IKE_SA_INIT exchange and prior to the IKE_AUTH exchange.
The IKE_INTERMEDIATE exchange messages can be fragmented using the IKE
fragmentation mechanism, so these exchanges may be used to transfer
large amounts of data that don\'t fit into the IKE_SA_INIT exchange
without causing IP fragmentation.[¶](#section-1-4){.pilcrow}

The Intermediate Exchange can be used to transfer large public keys of
QC-resistant key exchange methods, but its application is not limited to
this use case. This exchange can also be used whenever some data needs
to be transferred before the IKE_AUTH exchange and for some reason the
IKE_SA_INIT exchange is not suited for this purpose. This document
defines the IKE_INTERMEDIATE exchange without tying it to any specific
use case. It is expected that separate specifications will define for
which purposes and how the IKE_INTERMEDIATE exchange is used in IKEv2.
Some considerations must be taken into account when designing such
specifications:[¶](#section-1-5){.pilcrow}

-   [The IKE_INTERMEDIATE exchange is not intended for bulk transfer.
    This document doesn\'t set a hard cap on the amount of data that can
    be safely transferred using this mechanism, as it depends on its
    application. However, in most cases, it is anticipated that the
    amount of data will be limited to tens of kilobytes (a few hundred
    kilobytes in extreme cases), which is believed to cause no network
    problems (see \[[RFC6928](#RFC6928){.xref}\] as an example of
    experiments with sending similar amounts of data in the first TCP
    flight). See also [Section 5](#security){.xref} for the discussion
    of possible DoS attack vectors when the amount of data sent in the
    IKE_INTERMEDIATE exchange is too
    large.[¶](#section-1-6.1){.pilcrow}]{#section-1-6.1}
-   [It is expected that the IKE_INTERMEDIATE exchange will only be used
    for transferring data that is needed to establish IKE SA and not for
    data that can be sent later when this SA is
    established.[¶](#section-1-6.2){.pilcrow}]{#section-1-6.2}
:::

::: {#mustshouldmay}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology and Notation](#name-terminology-and-notation){.section-name .selfRef} {#name-terminology-and-notation}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

It is expected that readers are familiar with the terms used in the
IKEv2 specification \[[RFC7296](#RFC7296){.xref}\]. Notation for the
payloads contained in IKEv2 messages is defined in [Section
1.2](https://www.rfc-editor.org/rfc/rfc7296#section-1.2){.relref} of
\[[RFC7296](#RFC7296){.xref}\].[¶](#section-2-2){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Intermediate Exchange Details](#name-intermediate-exchange-detai){.section-name .selfRef} {#name-intermediate-exchange-detai}

::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Support for Intermediate Exchange Negotiation](#name-support-for-intermediate-ex){.section-name .selfRef} {#name-support-for-intermediate-ex}

The initiator indicates its support for Intermediate Exchange by
including a notification of type INTERMEDIATE_EXCHANGE_SUPPORTED in the
IKE_SA_INIT request message. If the responder also supports this
exchange, it includes this notification in the response
message.[¶](#section-3.1-1){.pilcrow}

::: {#section-3.1-2 .alignLeft .art-text .artwork}
    Initiator                                 Responder
    -----------                               -----------
    HDR, SAi1, KEi, Ni,
    [N(INTERMEDIATE_EXCHANGE_SUPPORTED)] -->
                                       <-- HDR, SAr1, KEr, Nr, [CERTREQ],
                                     [N(INTERMEDIATE_EXCHANGE_SUPPORTED)]

[¶](#section-3.1-2){.pilcrow}
:::

The INTERMEDIATE_EXCHANGE_SUPPORTED is a Status Type IKEv2 notification
with Notify Message Type 16438. When it is sent, the Protocol ID and SPI
Size fields in the Notify payload are both set to 0. This specification
doesn\'t define any data that this notification may contain, so the
Notification Data is left empty. However, future enhancements to this
specification may override this. Implementations [MUST]{.bcp14} ignore
non-empty Notification Data if they don\'t understand its
purpose.[¶](#section-3.1-3){.pilcrow}
:::

::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Using Intermediate Exchange](#name-using-intermediate-exchange){.section-name .selfRef} {#name-using-intermediate-exchange}

If both peers indicated their support for the Intermediate Exchange, the
initiator may use one or more these exchanges to transfer additional
data. Using the Intermediate Exchange is optional; the initiator may
find it unnecessary even when support for this exchange has been
negotiated.[¶](#section-3.2-1){.pilcrow}

The Intermediate Exchange is denoted as IKE_INTERMEDIATE; its Exchange
Type is 43.[¶](#section-3.2-2){.pilcrow}

::: {#section-3.2-3 .alignLeft .art-text .artwork}
    Initiator                                 Responder
    -----------                               -----------
    HDR, ..., SK {...}  -->
                                         <--  HDR, ..., SK {...}

[¶](#section-3.2-3){.pilcrow}
:::

The initiator may use several IKE_INTERMEDIATE exchanges if necessary.
Since window size is initially set to 1 for both peers ([Section
2.3](https://www.rfc-editor.org/rfc/rfc7296#section-2.3){.relref} of
\[[RFC7296](#RFC7296){.xref}\]), these exchanges [MUST]{.bcp14} be
sequential and [MUST]{.bcp14} all be completed before the IKE_AUTH
exchange is initiated. The IKE SA [MUST NOT]{.bcp14} be considered as
established until the IKE_AUTH exchange is successfully
completed.[¶](#section-3.2-4){.pilcrow}

The Message IDs for IKE_INTERMEDIATE exchanges [MUST]{.bcp14} be chosen
according to the standard IKEv2 rule, described in [Section
2.2](https://www.rfc-editor.org/rfc/rfc7296#section-2.2){.relref} of
\[[RFC7296](#RFC7296){.xref}\], i.e., it is set to 1 for the first
IKE_INTERMEDIATE exchange, 2 for the next (if any), and so on.
Implementations [MUST]{.bcp14} verify that Message IDs in the
IKE_INTERMEDIATE messages they receive actually follow this rule. The
Message ID for the first pair of IKE_AUTH messages is one more than the
value used in the last IKE_INTERMEDIATE
exchange.[¶](#section-3.2-5){.pilcrow}

If the presence of NAT is detected in the IKE_SA_INIT exchange via
NAT_DETECTION_SOURCE_IP and NAT_DETECTION_DESTINATION_IP notifications,
then the peers switch to port 4500 in the first IKE_INTERMEDIATE
exchange and use this port for all subsequent exchanges, as described in
[Section
2.23](https://www.rfc-editor.org/rfc/rfc7296#section-2.23){.relref} of
\[[RFC7296](#RFC7296){.xref}\].[¶](#section-3.2-6){.pilcrow}

The content of the IKE_INTERMEDIATE exchange messages depends on the
data being transferred and will be defined by specifications utilizing
this exchange. However, since the main motivation for the
IKE_INTERMEDIATE exchange is to avoid IP fragmentation when large
amounts of data need to be transferred prior to the IKE_AUTH exchange,
the Encrypted payload [MUST]{.bcp14} be present in the IKE_INTERMEDIATE
exchange messages, and payloads containing large amounts of data
[MUST]{.bcp14} be placed inside it. This will allow IKE fragmentation
\[[RFC7383](#RFC7383){.xref}\] to take place, provided it is supported
by the peers and negotiated in the initial
exchange.[¶](#section-3.2-7){.pilcrow}

[Appendix A](#example){.xref} contains an example of using an
IKE_INTERMEDIATE exchange in creating an IKE
SA.[¶](#section-3.2-8){.pilcrow}
:::

::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [The IKE_INTERMEDIATE Exchange Protection and Authentication](#name-the-ike_intermediate-exchan){.section-name .selfRef} {#name-the-ike_intermediate-exchan}

::: {#protection}
::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [Protection of IKE_INTERMEDIATE Messages](#name-protection-of-ike_intermedi){.section-name .selfRef} {#name-protection-of-ike_intermedi}

The keys SK_e\[i/r\] and SK_a\[i/r\] for the protection of
IKE_INTERMEDIATE exchanges are computed in the standard fashion, as
defined in [Section
2.14](https://www.rfc-editor.org/rfc/rfc7296#section-2.14){.relref} of
\[[RFC7296](#RFC7296){.xref}\].[¶](#section-3.3.1-1){.pilcrow}

Every subsequent IKE_INTERMEDIATE exchange uses the most recently
calculated IKE SA keys before this exchange is started. So, the first
IKE_INTERMEDIATE exchange always uses SK_e\[i/r\] and SK_a\[i/r\] keys
that were computed as a result of the IKE_SA_INIT exchange. If
additional key exchange is performed in the first IKE_INTERMEDIATE
exchange, resulting in the update of SK_e\[i/r\] and SK_a\[i/r\], then
these updated keys are used for protection of the second
IKE_INTERMEDIATE exchange. Otherwise, the original SK_e\[i/r\] and
SK_a\[i/r\] keys are used again, and so
on.[¶](#section-3.3.1-2){.pilcrow}

Once all the IKE_INTERMEDIATE exchanges are completed, the most recently
calculated SK_e\[i/r\] and SK_a\[i/r\] keys are used for protection of
the IKE_AUTH exchange and all subsequent
exchanges.[¶](#section-3.3.1-3){.pilcrow}
:::
:::

::: {#section-3.3.2 .section}
#### [3.3.2.](#section-3.3.2){.section-number .selfRef} [Authentication of IKE_INTERMEDIATE Exchanges](#name-authentication-of-ike_inter){.section-name .selfRef} {#name-authentication-of-ike_inter}

The IKE_INTERMEDIATE messages must be authenticated in the IKE_AUTH
exchange, which is performed by adding their content into the AUTH
payload calculation. It is anticipated that in many use cases,
IKE_INTERMEDIATE messages will be fragmented using the IKE fragmentation
\[[RFC7383](#RFC7383){.xref}\] mechanism. According to
\[[RFC7383](#RFC7383){.xref}\], when IKE fragmentation is negotiated,
the initiator may first send a request message in unfragmented form, but
later turn on IKE fragmentation and resend it fragmented if no response
is received after a few retransmissions. In addition, peers may resend a
fragmented message using different fragment sizes to perform simple PMTU
discovery.[¶](#section-3.3.2-1){.pilcrow}

The requirement to support this behavior makes authentication
challenging: it is not appropriate to add on-the-wire content of the
IKE_INTERMEDIATE messages into the AUTH payload calculation, because
implementations are generally unaware of which form these messages are
received by peers. Instead, a more complex scheme is used;
authentication is performed by adding the content of these messages
before their encryption and possible fragmentation, so that the data to
be authenticated doesn\'t depend on the form the messages are delivered
in.[¶](#section-3.3.2-2){.pilcrow}

If one or more IKE_INTERMEDIATE exchanges took place, the definition of
the blob to be signed (or MACed) from [Section
2.15](https://www.rfc-editor.org/rfc/rfc7296#section-2.15){.relref} of
\[[RFC7296](#RFC7296){.xref}\] is modified as
follows:[¶](#section-3.3.2-3){.pilcrow}

::: {#section-3.3.2-4}
``` sourcecode
InitiatorSignedOctets = RealMsg1 | NonceRData | MACedIDForI | IntAuth
ResponderSignedOctets = RealMsg2 | NonceIData | MACedIDForR | IntAuth

IntAuth =  IntAuth_iN | IntAuth_rN | IKE_AUTH_MID

IntAuth_i1 = prf(SK_pi1,              IntAuth_i1A [| IntAuth_i1P])
IntAuth_i2 = prf(SK_pi2, IntAuth_i1 | IntAuth_i2A [| IntAuth_i2P])
IntAuth_i3 = prf(SK_pi3, IntAuth_i2 | IntAuth_i3A [| IntAuth_i3P])
...
IntAuth_iN = prf(SK_piN, IntAuth_iN-1 | IntAuth_iNA [| IntAuth_iNP])

IntAuth_r1 = prf(SK_pr1,              IntAuth_r1A [| IntAuth_r1P])
IntAuth_r2 = prf(SK_pr2, IntAuth_r1 | IntAuth_r2A [| IntAuth_r2P])
IntAuth_r3 = prf(SK_pr3, IntAuth_r2 | IntAuth_r3A [| IntAuth_r3P])
...
IntAuth_rN = prf(SK_prN, IntAuth_rN-1 | IntAuth_rNA [| IntAuth_rNP])
```

[¶](#section-3.3.2-4){.pilcrow}
:::

The essence of this modification is that a new chunk called \"IntAuth\"
is appended to the string of octets that is signed (or MACed) by the
peers. IntAuth consists of three parts: IntAuth_iN, IntAuth_rN, and
IKE_AUTH_MID.[¶](#section-3.3.2-5){.pilcrow}

The IKE_AUTH_MID chunk is a value of the Message ID field from the IKE
Header of the first round of the IKE_AUTH exchange. It is represented as
a four-octet integer in network byte order (in other words, exactly as
it appears on the wire).[¶](#section-3.3.2-6){.pilcrow}

The IntAuth_iN and IntAuth_rN chunks represent the cumulative result of
applying the negotiated Pseudorandom Function (PRF) to all
IKE_INTERMEDIATE exchange messages sent during IKE SA establishment by
the initiator and the responder, respectively. After the first
IKE_INTERMEDIATE exchange is complete, peers calculate the IntAuth_i1
value by applying the negotiated PRF to the content of the request
message from this exchange and calculate the IntAuth_r1 value by
applying the negotiated PRF to the content of the response message. For
every subsequent IKE_INTERMEDIATE exchange (if any), peers recalculate
these values as follows: after the nth exchange is complete, they
compute IntAuth\_\[i/r\]n by applying the negotiated PRF to the
concatenation of IntAuth\_\[i/r\](n-1) (computed for the previous
IKE_INTERMEDIATE exchange) and the content of the request (for
IntAuth_in) or response (for IntAuth_rn) messages from this exchange.
After all IKE_INTERMEDIATE exchanges are over, the resulted
IntAuth\_\[i/r\]N values (assuming N exchanges took place) are used in
computing the AUTH payload.[¶](#section-3.3.2-7){.pilcrow}

For the purpose of calculating the IntAuth\_\[i/r\]\* values, the
content of the IKE_INTERMEDIATE messages is represented as two chunks of
data: mandatory IntAuth\_\[i/r\]\*A, optionally followed by
IntAuth\_\[i/r\]\*P.[¶](#section-3.3.2-8){.pilcrow}

The IntAuth\_\[i/r\]\*A chunk consists of the sequence of octets from
the first octet of the IKE Header (not including the prepended four
octets of zeros, if UDP encapsulation or TCP encapsulation of ESP
packets is used) to the last octet of the generic header of the
Encrypted payload. The scope of IntAuth\_\[i/r\]\*A is identical to the
scope of Associated Data defined for the use of AEAD algorithms in IKEv2
(see [Section
5.1](https://www.rfc-editor.org/rfc/rfc5282#section-5.1){.relref} of
\[[RFC5282](#RFC5282){.xref}\]), which is stressed by using the \"A\"
suffix in its name. Note that calculation of IntAuth\_\[i/r\]\*A
doesn\'t depend on whether an AEAD algorithm or a plain cipher is used
in IKE SA.[¶](#section-3.3.2-9){.pilcrow}

The IntAuth\_\[i/r\]\*P chunk is present if the Encrypted payload is not
empty. It consists of the content of the Encrypted payload that is fully
formed but not yet encrypted. The Initialization Vector, Padding, Pad
Length, and Integrity Checksum Data fields (see [Section
3.14](https://www.rfc-editor.org/rfc/rfc7296#section-3.14){.relref} of
\[[RFC7296](#RFC7296){.xref}\]) are not included into the calculation.
In other words, the IntAuth\_\[i/r\]\*P chunk is the inner payloads of
the Encrypted payload in plaintext form, which is stressed by using the
\"P\" suffix in its name.[¶](#section-3.3.2-10){.pilcrow}

[]{#name-data-to-authenticate-in-the}

::: {#layout}
::: {#section-3.3.2-11.1 .alignLeft .art-text .artwork}
                         1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ^ ^
    |                       IKE SA Initiator's SPI                  | | |
    |                                                               | | |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ I |
    |                       IKE SA Responder's SPI                  | K |
    |                                                               | E |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+   |
    |  Next Payload | MjVer | MnVer | Exchange Type |     Flags     | H |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ d |
    |                          Message ID                           | r A
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | |
    |                       Adjusted Length                         | | |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ v |
    |                                                               |   |
    ~                 Unencrypted payloads (if any)                 ~   |
    |                                                               |   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ^ |
    | Next Payload  |C|  RESERVED   |    Adjusted Payload Length    | | |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ | v
    |                                                               | |
    ~                     Initialization Vector                     ~ E
    |                                                               | E
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ c ^
    |                                                               | r |
    ~             Inner payloads (not yet encrypted)                ~   P
    |                                                               | P |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ l v
    |              Padding (0-255 octets)           |  Pad Length   | d
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ |
    |                                                               | |
    ~                    Integrity Checksum Data                    ~ |
    |                                                               | |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ v
:::

[Figure 1](#figure-1){.selfRef}: [Data to Authenticate in the
IKE_INTERMEDIATE Exchange
Messages](#name-data-to-authenticate-in-the){.selfRef}
:::

[Figure 1](#layout){.xref} illustrates the layout of the
IntAuth\_\[i/r\]\*A (denoted as A) and the IntAuth\_\[i/r\]\*P (denoted
as P) chunks in case the Encrypted payload is not
empty.[¶](#section-3.3.2-12){.pilcrow}

For the purpose of prf calculation, the Length field in the IKE Header
and the Payload Length field in the Encrypted payload header are
adjusted so that they don\'t count the lengths of Initialization Vector,
Integrity Checksum Data, Padding, and Pad Length fields. In other words,
the Length field in the IKE Header (denoted as Adjusted Length in
[Figure 1](#layout){.xref}) is set to the sum of the lengths of
IntAuth\_\[i/r\]\*A and IntAuth\_\[i/r\]\*P, and the Payload Length
field in the Encrypted payload header (denoted as Adjusted Payload
Length in [Figure 1](#layout){.xref}) is set to the length of
IntAuth\_\[i/r\]\*P plus the size of the Encrypted payload header (four
octets).[¶](#section-3.3.2-13){.pilcrow}

The prf calculations [MUST]{.bcp14} be applied to whole messages only,
before possible IKE fragmentation. This ensures that the IntAuth will be
the same regardless of whether or not IKE fragmentation takes place. If
the message was received in fragmented form, it [MUST]{.bcp14} be
reconstructed before calculating the prf as if it were received
unfragmented. While reconstructing, the RESERVED field in the
reconstructed Encrypted payload header [MUST]{.bcp14} be set to the
value of the RESERVED field in the Encrypted Fragment payload header
from the first fragment (with the Fragment Number field set to
1).[¶](#section-3.3.2-14){.pilcrow}

Note that it is possible to avoid actual reconstruction of the message
by incrementally calculating prf on decrypted (or ready to be encrypted)
fragments. However, care must be taken to properly replace the content
of the Next Header and the Length fields so that the result of computing
the prf is the same as if it were computed on the reconstructed
message.[¶](#section-3.3.2-15){.pilcrow}

Each calculation of IntAuth\_\[i/r\]\* uses its own keys SK_p\[i/r\]\*,
which are the most recently updated SK_p\[i/r\] keys available before
the corresponded IKE_INTERMEDIATE exchange is started. The first
IKE_INTERMEDIATE exchange always uses the SK_p\[i/r\] keys that were
computed in the IKE_SA_INIT exchange as SK_p\[i/r\]1. If the first
IKE_INTERMEDIATE exchange performs additional key exchange resulting in
an SK_p\[i/r\] update, then these updated SK_p\[i/r\] keys are used as
SK_p\[i/r\]2; otherwise, the original SK_p\[i/r\] keys are used, and so
on. Note that if keys are updated, then for any given IKE_INTERMEDIATE
exchange, the keys SK_e\[i/r\] and SK_a\[i/r\] used for protection of
its messages (see [Section 3.3.1](#protection){.xref}) and the key
SK_p\[i/r\] for its authentication are always from the same
generation.[¶](#section-3.3.2-16){.pilcrow}
:::
:::

::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Error Handling in the IKE_INTERMEDIATE Exchange](#name-error-handling-in-the-ike_i){.section-name .selfRef} {#name-error-handling-in-the-ike_i}

Since messages of the IKE_INTERMEDIATE exchange are not authenticated
until the IKE_AUTH exchange successfully completes, possible errors need
to be handled with care. There is a trade-off between providing better
diagnostics of the problem and risk of becoming part of a DoS attack.
Sections
[2.21.1](https://www.rfc-editor.org/rfc/rfc7296#section-2.21.1){.relref}
and
[2.21.2](https://www.rfc-editor.org/rfc/rfc7296#section-2.21.2){.relref}
of \[[RFC7296](#RFC7296){.xref}\] describe how errors are handled in
initial IKEv2 exchanges; these considerations are also applied to the
IKE_INTERMEDIATE exchange with the qualification that not all error
notifications may appear in the IKE_INTERMEDIATE exchange (for example,
errors concerning authentication are generally only applicable to the
IKE_AUTH exchange).[¶](#section-3.4-1){.pilcrow}
:::
:::

::: {#interaction}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Interaction with Other IKEv2 Extensions](#name-interaction-with-other-ikev){.section-name .selfRef} {#name-interaction-with-other-ikev}

The IKE_INTERMEDIATE exchanges [MAY]{.bcp14} be used during the IKEv2
Session Resumption \[[RFC5723](#RFC5723){.xref}\] between the
IKE_SESSION_RESUME and the IKE_AUTH exchanges. To be able to use it,
peers [MUST]{.bcp14} negotiate support for Intermediate Exchange by
including INTERMEDIATE_EXCHANGE_SUPPORTED notifications in the
IKE_SESSION_RESUME messages. Note that a flag denoting whether peers
supported the IKE_INTERMEDIATE exchange is not stored in the resumption
ticket and is determined each time from the IKE_SESSION_RESUME
exchange.[¶](#section-4-1){.pilcrow}
:::
:::

::: {#security}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The data that is transferred by means of the IKE_INTERMEDIATE exchanges
is not authenticated until the subsequent IKE_AUTH exchange is complete.
However, if the data is placed inside the Encrypted payload, then it is
protected from passive eavesdroppers. In addition, the peers can be
certain that they receive messages from the party they performed the
IKE_SA_INIT exchange with if they can successfully verify the Integrity
Checksum Data of the Encrypted payload.[¶](#section-5-1){.pilcrow}

The main application for the Intermediate Exchange is to transfer large
amounts of data before an IKE SA is set up, without causing IP
fragmentation. For that reason, it is expected that IKE fragmentation
will be employed in IKE_INTERMEDIATE exchanges in most cases. [Section
5](https://www.rfc-editor.org/rfc/rfc7383#section-5){.relref} of
\[[RFC7383](#RFC7383){.xref}\] contains security considerations for IKE
fragmentation.[¶](#section-5-2){.pilcrow}

Since authentication of peers occurs only in the IKE_AUTH exchange, a
malicious initiator may use the Intermediate Exchange to mount a DoS
attack on the responder. In this case, it starts creating an IKE SA,
negotiates using the Intermediate Exchanges, and transfers a lot of data
to the responder that may also require computationally expensive
processing. Then, it aborts the SA establishment before the IKE_AUTH
exchange. Specifications utilizing the Intermediate Exchange [MUST
NOT]{.bcp14} allow an unlimited number of these exchanges to take place
at the initiator\'s discretion. It is recommended that these
specifications be defined in such a way that the responder would know
(possibly via negotiation with the initiator) the exact number of these
exchanges that need to take place. In other words, after the IKE_SA_INIT
exchange is complete, it is preferred that both the initiator and the
responder know the exact number of IKE_INTERMEDIATE exchanges they have
to perform; it is possible that some IKE_INTERMEDIATE exchanges are
optional and are performed at the initiator\'s discretion, but if a
specification defines optional use of IKE_INTERMEDIATE, then the maximum
number of these exchanges must be hard capped by the corresponding
specification. In addition, \[[RFC8019](#RFC8019){.xref}\] provides
guidelines for the responder of how to deal with DoS attacks during IKE
SA establishment.[¶](#section-5-3){.pilcrow}

Note that if an attacker was able to break the key exchange in real time
(e.g., by means of a quantum computer), then the security of the
IKE_INTERMEDIATE exchange would degrade. In particular, such an attacker
would be able to both read data contained in the Encrypted payload and
forge it. The forgery would become evident in the IKE_AUTH exchange
(provided the attacker cannot break the employed authentication
mechanism), but the ability to inject forged IKE_INTERMEDIATE exchange
messages with a valid Integrity Check Value (ICV) would allow the
attacker to mount a DoS attack. Moreover, in this situation, if the
negotiated PRF was not secure against a second preimage attack with
known key, then the attacker could forge the IKE_INTERMEDIATE exchange
messages without later being detected in the IKE_AUTH exchange. To do
this, the attacker would find the same IntAuth\_\[i/r\]\* value for the
forged message as for the original.[¶](#section-5-4){.pilcrow}
:::
:::

::: {#iana}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document defines a new Exchange Type in the \"IKEv2 Exchange
Types\" registry:[¶](#section-6-1){.pilcrow}

[]{#name-ikev2-exchange-types}

::: {#IKE_INTERMEDIATE}
  Value   Exchange Type      Reference
  ------- ------------------ -----------
  43      IKE_INTERMEDIATE   RFC 9242

  : [Table 1](#table-1){.selfRef}: [IKEv2 Exchange
  Types](#name-ikev2-exchange-types){.selfRef}
:::

This document also defines a new Notify Message Type in the \"IKEv2
Notify Message Types - Status Types\"
registry:[¶](#section-6-3){.pilcrow}

[]{#name-ikev2-notify-message-types-}

::: {#INTERMEDIATE_EXCHANGE_SUPPORTED}
  Value   NOTIFY MESSAGES - STATUS TYPES    Reference
  ------- --------------------------------- -----------
  16438   INTERMEDIATE_EXCHANGE_SUPPORTED   RFC 9242

  : [Table 2](#table-2){.selfRef}: [IKEv2 Notify Message Types - Status
  Types](#name-ikev2-notify-message-types-){.selfRef}
:::
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC7296\]
:   [Kaufman, C.]{.refAuthor}, [Hoffman, P.]{.refAuthor},
    [Nir, Y.]{.refAuthor}, [Eronen, P.]{.refAuthor}, and [T.
    Kivinen]{.refAuthor}, [\"Internet Key Exchange Protocol Version 2
    (IKEv2)\"]{.refTitle}, [STD 79]{.seriesInfo}, [RFC
    7296]{.seriesInfo}, [DOI 10.17487/RFC7296]{.seriesInfo}, October
    2014, \<<https://www.rfc-editor.org/info/rfc7296>\>.
:   

\[RFC7383\]
:   [Smyslov, V.]{.refAuthor}, [\"Internet Key Exchange Protocol Version
    2 (IKEv2) Message Fragmentation\"]{.refTitle}, [RFC
    7383]{.seriesInfo}, [DOI 10.17487/RFC7383]{.seriesInfo}, November
    2014, \<<https://www.rfc-editor.org/info/rfc7383>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC5282\]
:   [Black, D.]{.refAuthor} and [D. McGrew]{.refAuthor}, [\"Using
    Authenticated Encryption Algorithms with the Encrypted Payload of
    the Internet Key Exchange version 2 (IKEv2) Protocol\"]{.refTitle},
    [RFC 5282]{.seriesInfo}, [DOI 10.17487/RFC5282]{.seriesInfo}, August
    2008, \<<https://www.rfc-editor.org/info/rfc5282>\>.
:   

\[RFC5723\]
:   [Sheffer, Y.]{.refAuthor} and [H. Tschofenig]{.refAuthor},
    [\"Internet Key Exchange Protocol Version 2 (IKEv2) Session
    Resumption\"]{.refTitle}, [RFC 5723]{.seriesInfo}, [DOI
    10.17487/RFC5723]{.seriesInfo}, January 2010,
    \<<https://www.rfc-editor.org/info/rfc5723>\>.
:   

\[RFC6928\]
:   [Chu, J.]{.refAuthor}, [Dukkipati, N.]{.refAuthor},
    [Cheng, Y.]{.refAuthor}, and [M. Mathis]{.refAuthor}, [\"Increasing
    TCP\'s Initial Window\"]{.refTitle}, [RFC 6928]{.seriesInfo}, [DOI
    10.17487/RFC6928]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6928>\>.
:   

\[RFC8019\]
:   [Nir, Y.]{.refAuthor} and [V. Smyslov]{.refAuthor}, [\"Protecting
    Internet Key Exchange Protocol Version 2 (IKEv2) Implementations
    from Distributed Denial-of-Service Attacks\"]{.refTitle}, [RFC
    8019]{.seriesInfo}, [DOI 10.17487/RFC8019]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8019>\>.
:   

\[RFC8229\]
:   [Pauly, T.]{.refAuthor}, [Touati, S.]{.refAuthor}, and [R.
    Mantha]{.refAuthor}, [\"TCP Encapsulation of IKE and IPsec
    Packets\"]{.refTitle}, [RFC 8229]{.seriesInfo}, [DOI
    10.17487/RFC8229]{.seriesInfo}, August 2017,
    \<<https://www.rfc-editor.org/info/rfc8229>\>.
:   
:::
:::

::: {#example}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Example of IKE_INTERMEDIATE Exchange](#name-example-of-ike_intermediate){.section-name .selfRef} {#name-example-of-ike_intermediate}

This appendix contains an example of the messages using IKE_INTERMEDIATE
exchanges. This appendix is purely informative; if it disagrees with the
body of this document, the other text is considered
correct.[¶](#appendix-A-1){.pilcrow}

In this example, there is one IKE_SA_INIT exchange and two
IKE_INTERMEDIATE exchanges, followed by the IKE_AUTH exchange to
authenticate all initial exchanges. The xxx in the HDR(xxx,MID=yyy)
indicates the Exchange Type, and yyy indicates the Message ID used for
that exchange. The keys used for each SK {} payload are indicated in the
parenthesis after the SK. Otherwise, the payload notation is the same as
is used in \[[RFC7296](#RFC7296){.xref}\].[¶](#appendix-A-2){.pilcrow}

::: {#appendix-A-3 .alignLeft .art-text .artwork}
    Initiator                         Responder
    -----------                       -----------
    HDR(IKE_SA_INIT,MID=0),
    SAi1, KEi, Ni,
    N(INTERMEDIATE_EXCHANGE_SUPPORTED)  -->

                                 <--  HDR(IKE_SA_INIT,MID=0),
                                      SAr1, KEr, Nr, [CERTREQ],
                                      N(INTERMEDIATE_EXCHANGE_SUPPORTED)

[¶](#appendix-A-3){.pilcrow}
:::

At this point, peers calculate SK\_\* and store them as SK\_\*1.
SK_e\[i/r\]1 and SK_a\[i/r\]1 will be used to protect the first
IKE_INTERMEDIATE exchange, and SK_p\[i/r\]1 will be used for its
authentication.[¶](#appendix-A-4){.pilcrow}

::: {#appendix-A-5 .alignLeft .art-text .artwork}
    Initiator                         Responder
    -----------                       -----------
    HDR(IKE_INTERMEDIATE,MID=1),
    SK(SK_ei1,SK_ai1) {...}  -->

             <Calculate IntAuth_i1 = prf(SK_pi1, ...)>

                                 <--  HDR(IKE_INTERMEDIATE,MID=1),
                                      SK(SK_er1,SK_ar1) {...}

             <Calculate IntAuth_r1 = prf(SK_pr1, ...)>

[¶](#appendix-A-5){.pilcrow}
:::

If the SK\_\*1 keys are updated (e.g., as a result of a new key
exchange) after completing this IKE_INTERMEDIATE exchange, then the
peers store the updated keys as SK\_\*2; otherwise, they use SK\_\*1 as
SK\_\*2. SK_e\[i/r\]2 and SK_a\[i/r\]2 will be used to protect the
second IKE_INTERMEDIATE exchange, and SK_p\[i/r\]2 will be used for its
authentication.[¶](#appendix-A-6){.pilcrow}

::: {#appendix-A-7 .alignLeft .art-text .artwork}
    Initiator                         Responder
    -----------                       -----------
    HDR(IKE_INTERMEDIATE,MID=2),
    SK(SK_ei2,SK_ai2) {...}  -->

             <Calculate IntAuth_i2 = prf(SK_pi2, ...)>

                                 <--  HDR(IKE_INTERMEDIATE,MID=2),
                                      SK(SK_er2,SK_ar2) {...}

             <Calculate IntAuth_r2 = prf(SK_pr2, ...)>

[¶](#appendix-A-7){.pilcrow}
:::

If the SK\_\*2 keys are updated (e.g., as a result of a new key
exchange) after completing the second IKE_INTERMEDIATE exchange, then
the peers store the updated keys as SK\_\*3; otherwise, they use SK\_\*2
as SK\_\*3. SK_e\[i/r\]3 and SK_a\[i/r\]3 will be used to protect the
IKE_AUTH exchange, SK_p\[i/r\]3 will be used for authentication, and
SK_d3 will be used for derivation of other keys (e.g., for Child
SAs).[¶](#appendix-A-8){.pilcrow}

::: {#appendix-A-9 .alignLeft .art-text .artwork}
    Initiator                         Responder
    -----------                       -----------
    HDR(IKE_AUTH,MID=3),
    SK(SK_ei3,SK_ai3)
    {IDi, [CERT,] [CERTREQ,]
    [IDr,] AUTH, SAi2, TSi, TSr}  -->
                                 <--  HDR(IKE_AUTH,MID=3),
                                      SK(SK_er3,SK_ar3)
                                      {IDr, [CERT,] AUTH, SAr2, TSi, TSr}

[¶](#appendix-A-9){.pilcrow}
:::

In this example, two IKE_INTERMEDIATE exchanges took place; therefore,
SK\_\*3 keys would be used as SK\_\* keys for further cryptographic
operations in the context of the created IKE SA, as defined in
\[[RFC7296](#RFC7296){.xref}\].[¶](#appendix-A-10){.pilcrow}
:::
:::

::: {#appendix-B .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The idea to use an Intermediate Exchange between the IKE_SA_INIT and
IKE_AUTH exchanges was first suggested by [Tero Kivinen]{.contact-name}.
He also helped to write the example IKE_INTERMEDIATE exchange shown in
[Appendix A](#example){.xref}. [Scott Fluhrer]{.contact-name} and
[Daniel Van Geest]{.contact-name} identified a possible problem with
authentication of the IKE_INTERMEDIATE exchange and helped to resolve
it. The author is grateful to [Tobias Brunner]{.contact-name}, who
raised good questions concerning authentication of the IKE_INTERMEDIATE
exchange and proposed how to make the size of authentication chunks
constant regardless of the number of exchanges. The author is also
grateful to [Paul Wouters]{.contact-name} and [Benjamin
Kaduk]{.contact-name}, who suggested a lot of text improvements for the
document.[¶](#appendix-B-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-C .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Valery Smyslov]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ELVIS-PLUS]{.org}
:::

::: {.left dir="auto"}
[PO Box 81]{.street-address}
:::

::: {.left dir="auto"}
[Moscow (Zelenograd)]{.locality}
:::

::: {.left dir="auto"}
[124460]{.postal-code}
:::

::: {.left dir="auto"}
[Russian Federation]{.country-name}
:::

::: tel
Phone: [+7 495 276 0211](tel:+7%20495%20276%200211){.tel}
:::

::: email
Email: <svan@elvis.ru>
:::
:::
:::
