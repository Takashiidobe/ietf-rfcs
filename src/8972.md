  RFC 8972         STAMP Extensions   January 2021
  ---------------- ------------------ --------------
  Mirsky, et al.   Standards Track    \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8972](https://www.rfc-editor.org/rfc/rfc8972){.eref}

Updates:
:   [8762](https://www.rfc-editor.org/rfc/rfc8762){.eref}

Category:
:   Standards Track

Published:
:   January 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    G. Mirsky
    :::

    ::: org
    ZTE Corp.
    :::
    :::

    ::: author
    ::: author-name
    X. Min
    :::

    ::: org
    ZTE Corp.
    :::
    :::

    ::: author
    ::: author-name
    H. Nydell
    :::

    ::: org
    Accedian Networks
    :::
    :::

    ::: author
    ::: author-name
    R. Foote
    :::

    ::: org
    Nokia
    :::
    :::

    ::: author
    ::: author-name
    A. Masputra
    :::

    ::: org
    Apple Inc.
    :::
    :::

    ::: author
    ::: author-name
    E. Ruffini
    :::

    ::: org
    OutSys
    :::
    :::
:::

# RFC 8972 {#rfcnum}

# Simple Two-Way Active Measurement Protocol Optional Extensions {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes optional extensions to Simple Two-way Active
Measurement Protocol (STAMP) that enable measurement of performance
metrics. The document also defines a STAMP Test Session Identifier and
thus updates RFC 8762.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8972>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions Used in This
    Document](#name-conventions-used-in-this-do){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Acronyms](#name-acronyms){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [STAMP Test Session
    Identifier](#name-stamp-test-session-identifi){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [TLV Extensions to
    STAMP](#name-tlv-extensions-to-stamp){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Extra Padding
        TLV](#name-extra-padding-tlv){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Location
        TLV](#name-location-tlv){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [Location
            Sub-TLVs](#name-location-sub-tlvs){.xref}[¶](#section-toc.1-1.4.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [Theory of Operation of
            Location
            TLV](#name-theory-of-operation-of-loca){.xref}[¶](#section-toc.1-1.4.2.2.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Timestamp Information
        TLV](#name-timestamp-information-tlv){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Class of Service
        TLV](#name-class-of-service-tlv){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [Direct Measurement
        TLV](#name-direct-measurement-tlv){.xref}[¶](#section-toc.1-1.4.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.6}
        [4.6](#section-4.6){.xref}.  [Access Report
        TLV](#name-access-report-tlv){.xref}[¶](#section-toc.1-1.4.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.7}
        [4.7](#section-4.7){.xref}.  [Follow-Up Telemetry
        TLV](#name-follow-up-telemetry-tlv){.xref}[¶](#section-toc.1-1.4.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.8}
        [4.8](#section-4.8){.xref}.  [HMAC
        TLV](#name-hmac-tlv){.xref}[¶](#section-toc.1-1.4.2.8.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [STAMP TLV Types
        Subregistry](#name-stamp-tlv-types-subregistry){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [STAMP TLV Flags
        Subregistry](#name-stamp-tlv-flags-subregistry){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [STAMP Sub-TLV Types
        Subregistry](#name-stamp-sub-tlv-types-subregi){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [STAMP Synchronization Sources
        Subregistry](#name-stamp-synchronization-sourc){.xref}[¶](#section-toc.1-1.5.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [STAMP Timestamping Methods
        Subregistry](#name-stamp-timestamping-methods-){.xref}[¶](#section-toc.1-1.5.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [STAMP Return Codes
        Subregistry](#name-stamp-return-codes-subregis){.xref}[¶](#section-toc.1-1.5.2.6.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [](#section-appendix.a){.xref}[Acknowledgments](#name-acknowledgments){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [](#section-appendix.b){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [](#section-appendix.c){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Simple Two-way Active Measurement Protocol (STAMP)
\[[RFC8762](#RFC8762){.xref}\] defines the STAMP base functionalities.
This document specifies the use of optional extensions that use
Type-Length-Value (TLV) encoding. Such extensions enhance the STAMP base
functions, such as measurement of one-way and round-trip delay, latency,
packet loss, packet duplication, and out-of-order delivery of test
packets. This specification defines optional STAMP extensions, their
formats, and the theory of operation. Also, a STAMP Test Session
Identifier is defined as an update of the base STAMP specification
\[[RFC8762](#RFC8762){.xref}\].[¶](#section-1-1){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions Used in This Document](#name-conventions-used-in-this-do){.section-name .selfRef} {#name-conventions-used-in-this-do}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Acronyms](#name-acronyms){.section-name .selfRef} {#name-acronyms}

[]{.break}

BDS
:   BeiDou Navigation Satellite System[¶](#section-2.1-1.2){.pilcrow}
:   

BITS
:   Building Integrated Timing Supply[¶](#section-2.1-1.4){.pilcrow}
:   

CoS
:   Class of Service[¶](#section-2.1-1.6){.pilcrow}
:   

DSCP
:   Differentiated Services Code Point[¶](#section-2.1-1.8){.pilcrow}
:   

ECN
:   Explicit Congestion Notification[¶](#section-2.1-1.10){.pilcrow}
:   

GLONASS
:   Global Orbiting Navigation Satellite
    System[¶](#section-2.1-1.12){.pilcrow}
:   

GPS
:   Global Positioning System
    \[[GPS](#GPS){.xref}\][¶](#section-2.1-1.14){.pilcrow}
:   

HMAC
:   Hashed Message Authentication Code[¶](#section-2.1-1.16){.pilcrow}
:   

LORAN-C
:   Long Range Navigation System Version
    C[¶](#section-2.1-1.18){.pilcrow}
:   

MBZ
:   Must Be Zero[¶](#section-2.1-1.20){.pilcrow}
:   

NTP
:   Network Time Protocol
    \[[RFC5905](#RFC5905){.xref}\][¶](#section-2.1-1.22){.pilcrow}
:   

PMF
:   Performance Measurement Function[¶](#section-2.1-1.24){.pilcrow}
:   

PTP
:   Precision Time Protocol
    \[[IEEE.1588.2008](#IEEE.1588.2008){.xref}\][¶](#section-2.1-1.26){.pilcrow}
:   

RP
:   Reverse Path[¶](#section-2.1-1.28){.pilcrow}
:   

SMI
:   Structure of Management Information[¶](#section-2.1-1.30){.pilcrow}
:   

SSID
:   STAMP Session Identifier[¶](#section-2.1-1.32){.pilcrow}
:   

SSU
:   Synchronization Supply Unit[¶](#section-2.1-1.34){.pilcrow}
:   

STAMP
:   Simple Two-way Active Measurement
    Protocol[¶](#section-2.1-1.36){.pilcrow}
:   

TLV
:   Type-Length-Value[¶](#section-2.1-1.38){.pilcrow}
:   
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.2-1){.pilcrow}
:::
:::

::: {#test-identifier-sec}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [STAMP Test Session Identifier](#name-stamp-test-session-identifi){.section-name .selfRef} {#name-stamp-test-session-identifi}

The STAMP Session-Sender transmits test packets to the STAMP
Session-Reflector. The STAMP Session-Reflector receives the
Session-Sender\'s packet and acts according to the configuration and
optional control information communicated in the Session-Sender\'s test
packet. STAMP defines two different test packet formats: one for packets
transmitted by the STAMP Session-Sender and one for packets transmitted
by the STAMP Session-Reflector. STAMP supports two modes:
unauthenticated and authenticated. Unauthenticated STAMP test packets
are compatible on the wire with unauthenticated TWAMP-Test
\[[RFC5357](#RFC5357){.xref}\] packets.[¶](#section-3-1){.pilcrow}

By default, STAMP uses symmetrical packets, i.e., the size of the packet
transmitted by the Session-Reflector equals the size of the packet
received by the Session-Reflector.[¶](#section-3-2){.pilcrow}

A STAMP Session is identified by the 4-tuple (source and destination IP
addresses, source and destination UDP port numbers). A STAMP
Session-Sender [MAY]{.bcp14} generate a locally unique STAMP Session
Identifier (SSID). The SSID is a two-octet, non-zero unsigned integer.
The SSID generation policy is implementation specific.
\[[NUM-IDS-GEN](#I-D.irtf-pearg-numeric-ids-generation){.xref}\]
thoroughly analyzes common algorithms for identifier generation and
their vulnerabilities. For example, an implementation can use the
algorithms described in [Section
7.1](https://tools.ietf.org/html/draft-irtf-pearg-numeric-ids-generation-06#section-7.1){.relref}
of \[[NUM-IDS-GEN](#I-D.irtf-pearg-numeric-ids-generation){.xref}\]. An
implementation [MUST NOT]{.bcp14} assign the same identifier to
different STAMP test sessions. A Session-Sender [MAY]{.bcp14} use the
SSID to identify a STAMP test session. If the SSID is used, it
[MUST]{.bcp14} be present in each test packet of the given test session.
In the unauthenticated mode, the SSID is located as displayed in [Figure
1](#session-sender-unauthenticated-format){.xref}.[¶](#section-3-3){.pilcrow}

[]{#name-the-format-of-an-extended-s}

::: {#session-sender-unauthenticated-format}
::: {#section-3-4.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Sequence Number                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Timestamp                            |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |         Error Estimate        |             SSID              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       |                                                               |
       |                         MBZ (28 octets)                       |
       |                                                               |
       |                                                               |
       |                                                               |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                            TLVs                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 1](#figure-1){.selfRef}: [The Format of an Extended STAMP
Session-Sender Test Packet in Unauthenticated
Mode](#name-the-format-of-an-extended-s){.selfRef}
:::

An implementation of the STAMP Session-Reflector that supports this
specification [MUST]{.bcp14} identify a STAMP Session using the SSID in
combination with elements of the usual 4-tuple for the session. Before a
test session commences, a Session-Reflector [MUST]{.bcp14} be
provisioned with all the elements that identify the STAMP Session. A
STAMP Session-Reflector [MUST]{.bcp14} discard non-matching STAMP test
packets. The means of provisioning the STAMP Session identification is
outside the scope of this specification. A conforming implementation of
a STAMP Session-Reflector [MUST]{.bcp14} copy the SSID value from the
received test packet and put it into the reflected packet, as displayed
in [Figure
2](#session-reflector-unauthenticated-format){.xref}.[¶](#section-3-5){.pilcrow}

[]{#name-the-format-of-an-extended-st}

::: {#session-reflector-unauthenticated-format}
::: {#section-3-6.1 .artwork .art-text .alignLeft}
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Sequence Number                        |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Timestamp                            |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |         Error Estimate        |           SSID                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Receive Timestamp                    |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                 Session-Sender Sequence Number                |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                  Session-Sender Timestamp                     |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Session-Sender Error Estimate |           MBZ                 |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |Ses-Sender TTL |                   MBZ                         |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                            TLVs                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 2](#figure-2){.selfRef}: [The Format of an Extended STAMP
Session-Reflector Test Packet in Unauthenticated
Mode](#name-the-format-of-an-extended-st){.selfRef}
:::

A STAMP Session-Reflector that does not support this specification will
return the zeroed SSID field in the reflected STAMP test packet. The
Session-Sender [MAY]{.bcp14} stop the session if it receives a zeroed
SSID field. An implementation of a Session-Sender [MUST]{.bcp14} support
control of its behavior in such a scenario. If the test session is not
stopped, the Session-Sender can, for example, send a base STAMP packet
\[[RFC8762](#RFC8762){.xref}\] or continue transmitting STAMP test
packets with the SSID.[¶](#section-3-7){.pilcrow}

The location of the SSID field in the authenticated mode is shown in
Figures [3](#session-sender-authenticated-format){.xref} and
[4](#session-reflector-authenticated-format){.xref}.[¶](#section-3-8){.pilcrow}

[]{#name-the-format-of-an-extended-sta}

::: {#session-sender-authenticated-format}
::: {#section-3-9.1 .artwork .art-text .alignLeft}
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                      Sequence Number                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                      MBZ (12 octets)                          |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                        Timestamp                              |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |        Error Estimate         |            SSID               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                                                               ~
     |                         MBZ (68 octets)                       |
     ~                                                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                                                               |
     |                       HMAC (16 octets)                        |
     |                                                               |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                            TLVs                               ~
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 3](#figure-3){.selfRef}: [The Format of an Extended STAMP
Session-Sender Test Packet in Authenticated
Mode](#name-the-format-of-an-extended-sta){.selfRef}
:::

[]{#name-the-format-of-an-extended-stam}

::: {#session-reflector-authenticated-format}
::: {#section-3-10.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Sequence Number                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        MBZ (12 octets)                        |
       |                                                               |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Timestamp                            |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |         Error Estimate        |            SSID               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        MBZ (4 octets)                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Receive Timestamp                      |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        MBZ (8 octets)                         |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                 Session-Sender Sequence Number                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        MBZ (12 octets)                        |
       |                                                               |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                 Session-Sender Timestamp                      |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | Session-Sender Error Estimate |                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
       |                        MBZ (6 octets)                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |Ses-Sender TTL |                                               |
       +-+-+-+-+-+-+-+-+                                               +
       |                                                               |
       |                        MBZ (15 octets)                        |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        HMAC (16 octets)                       |
       |                                                               |
       |                                                               |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                            TLVs                               ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 4](#figure-4){.selfRef}: [The Format of an Extended STAMP
Session-Reflector Test Packet in Authenticated
Mode](#name-the-format-of-an-extended-stam){.selfRef}
:::
:::
:::

::: {#stamp-extension-section}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [TLV Extensions to STAMP](#name-tlv-extensions-to-stamp){.section-name .selfRef} {#name-tlv-extensions-to-stamp}

The Type-Length-Value (TLV) encoding scheme provides a flexible
extension mechanism for optional informational elements. TLV is an
optional field in the STAMP test packet. Multiple TLVs [MAY]{.bcp14} be
placed in a STAMP test packet. Additional TLVs may be enclosed within a
given TLV, subject to the semantics of the (outer) TLV in question. TLVs
have a one-octet STAMP TLV Flags field, a one-octet Type field, and a
two-octet Length field that is equal to the length of the Value field in
octets. If a Type value for a TLV or sub-TLV is in the range for Private
Use \[[RFC8126](#RFC8126){.xref}\], the length [MUST]{.bcp14} be at
least 4, and the first four octets [MUST]{.bcp14} be that vendor\'s
Structure of Management Information (SMI) Private Enterprise Code, as
recorded in IANA\'s \"SMI Network Management Private Enterprise Codes\"
subregistry, in network octet order. The rest of the Value field is
private to the vendor. The following sections describe the use of TLVs
for STAMP that extend the STAMP capability beyond its base
specification.[¶](#section-4-1){.pilcrow}

[]{#name-tlv-format-in-a-stamp-exten}

::: {#tlv-format}
::: {#section-4-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|     Type      |           Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                            Value                              ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 5](#figure-5){.selfRef}: [TLV Format in a STAMP Extended
Packet](#name-tlv-format-in-a-stamp-exten){.selfRef}
:::

The fields are defined as follows:[¶](#section-4-3){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. The detailed format and interpretation of flags
    defined in this specification are
    below.[¶](#section-4-4.2){.pilcrow}
:   

Type:
:   A one-octet field that characterizes the interpretation of the Value
    field. It is allocated by IANA, as specified in [Section
    5.1](#iana-stamp-tlv-registry){.xref}.[¶](#section-4-4.4){.pilcrow}
:   

Length:
:   A two-octet field equal to the length of the Value field in
    octets.[¶](#section-4-4.6){.pilcrow}
:   

Value:
:   A variable-length field. Its interpretation and encoding are
    determined by the value of the Type
    field.[¶](#section-4-4.8){.pilcrow}
:   

All multi-byte fields in TLVs defined in this specification are in
network byte order.[¶](#section-4-5){.pilcrow}

The format of the STAMP TLV Flags is displayed in [Figure
6](#tlv-flags-format){.xref}, and the location of flags is defined in
[Section 5.2](#iana-tlv-flags-reg){.xref}.[¶](#section-4-6){.pilcrow}

[]{#name-stamp-tlv-flags-format}

::: {#tlv-flags-format}
::: {#section-4-7.1 .artwork .art-text .alignLeft}
        0 1 2 3 4 5 6 7
       +-+-+-+-+-+-+-+-+
       |U|M|I|R|R|R|R|R|
       +-+-+-+-+-+-+-+-+
:::

[Figure 6](#figure-6){.selfRef}: [STAMP TLV Flags
Format](#name-stamp-tlv-flags-format){.selfRef}
:::

The fields are defined as follows:[¶](#section-4-8){.pilcrow}

[]{.break}

U (Unrecognized):
:   A one-bit flag. A Session-Sender [MUST]{.bcp14} set the U flag to 1
    before transmitting an extended STAMP test packet. A
    Session-Reflector [MUST]{.bcp14} set the U flag to 1 if the
    Session-Reflector has not understood the TLV. Otherwise, the
    Session-Reflector [MUST]{.bcp14} set the U flag in the reflected
    packet to 0.[¶](#section-4-9.2){.pilcrow}
:   

M (Malformed):
:   A one-bit flag. A Session-Sender [MUST]{.bcp14} set the M flag to 0
    before transmitting an extended STAMP test packet. A
    Session-Reflector [MUST]{.bcp14} set the M flag to 1 if the
    Session-Reflector determined the TLV is malformed, i.e., the Length
    field value is not valid for the particular type, or the remaining
    length of the extended STAMP packet is less than the size of the
    TLV. Otherwise, the Session-Reflector [MUST]{.bcp14} set the M flag
    in the reflected packet to 0.[¶](#section-4-9.4){.pilcrow}
:   

I (Integrity):
:   A one-bit flag. A Session-Sender [MUST]{.bcp14} set the I flag to 0
    before transmitting an extended STAMP test packet. A
    Session-Reflector [MUST]{.bcp14} set the I flag to 1 if the STAMP
    extensions have failed HMAC verification ([Section
    4.8](#hmac-sec){.xref}). Otherwise, the Session-Reflector
    [MUST]{.bcp14} set the I flag in the reflected packet to
    0.[¶](#section-4-9.6){.pilcrow}
:   

R:
:   Reserved flags for future use. These flags [MUST]{.bcp14} be zeroed
    on transmit and ignored on receipt.[¶](#section-4-9.8){.pilcrow}
:   

A STAMP node, whether Session-Sender or Session-Reflector, receiving a
test packet [MUST]{.bcp14} determine whether the packet is a base STAMP
packet or whether it includes one or more TLVs. The node [MUST]{.bcp14}
compare the value in the Length field of the UDP header and the length
of the base STAMP test packet in the mode, unauthenticated or
authenticated, based on the configuration of the particular STAMP test
session. If the difference between the two values is greater than the
length of the UDP header, then the test packet includes one or more
STAMP TLVs that immediately follow the base STAMP test packet. A
Session-Reflector that does not support STAMP extensions will not
process but copy them into the reflected packet, as defined in [Section
4.3](https://www.rfc-editor.org/rfc/rfc8762#section-4.3){.relref} of
\[[RFC8762](#RFC8762){.xref}\]. A Session-Reflector that supports TLVs
will indicate specific TLVs that it did not process by setting the U
flag to 1 in those TLVs.[¶](#section-4-10){.pilcrow}

A STAMP Session-Sender that has received a reflected STAMP test packet
with extension TLVs [MUST]{.bcp14} validate each
TLV:[¶](#section-4-11){.pilcrow}

-   [If the U flag is set, the STAMP system [MUST]{.bcp14} skip the
    processing of the
    TLV.[¶](#section-4-12.1){.pilcrow}]{#section-4-12.1}
-   [If the M flag is set, the STAMP system [MUST]{.bcp14} stop
    processing the remainder of the extended STAMP
    packet.[¶](#section-4-12.2){.pilcrow}]{#section-4-12.2}
-   [If the I flag is set, the STAMP system [MUST]{.bcp14} discard all
    TLVs and [MUST]{.bcp14} stop processing the remainder of the
    extended STAMP
    packet.[¶](#section-4-12.3){.pilcrow}]{#section-4-12.3}
-   [If an implementation of a Session-Reflector does not recognize the
    Type field value, it [MUST]{.bcp14} include a copy of the TLV in the
    reflected STAMP packet. The Session-Reflector [MUST]{.bcp14} set the
    U flag to 1. The Session-Reflector [MUST]{.bcp14} skip the
    processing of the unrecognized
    TLV.[¶](#section-4-12.4){.pilcrow}]{#section-4-12.4}
-   [If a TLV is malformed, the processing of extension TLVs
    [MUST]{.bcp14} be stopped. The Session-Reflector [MUST]{.bcp14} copy
    the remainder of the received extended STAMP packet into the
    reflected STAMP packet. The Session-Reflector [MUST]{.bcp14} set the
    M flag to 1.[¶](#section-4-12.5){.pilcrow}]{#section-4-12.5}

::: {#padding-tlv-section}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Extra Padding TLV](#name-extra-padding-tlv){.section-name .selfRef} {#name-extra-padding-tlv}

[]{#name-extra-padding-tlv-2}

::: {#padding-tlv-figuret}
::: {#section-4.1-1.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|      Type     |           Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       ~                         Extra Padding                         ~
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 7](#figure-7){.selfRef}: [Extra Padding
TLV](#name-extra-padding-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.1-2){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.1-3.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 1 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.1-3.4){.pilcrow}
:   

Length:
:   A two-octet field equal to the length of the Extra Padding field in
    octets.[¶](#section-4.1-3.6){.pilcrow}
:   

Extra Padding:
:   This field [SHOULD]{.bcp14} be filled by a sequence of pseudorandom
    numbers. The field [MAY]{.bcp14} be filled with all zeros. An
    implementation [MUST]{.bcp14} control the content of the Extra
    Padding field.[¶](#section-4.1-3.8){.pilcrow}
:   

The Extra Padding TLV is similar to the Packet Padding field in a
TWAMP-Test packet \[[RFC5357](#RFC5357){.xref}\]. The use of the Extra
Padding TLV is [RECOMMENDED]{.bcp14} to perform a STAMP test using test
packets that are larger than the base STAMP packet
\[[RFC8762](#RFC8762){.xref}\]. The length of the base STAMP packet is
44 octets in the unauthenticated mode or 112 octets in the authenticated
mode. The Extra Padding TLV [MAY]{.bcp14} be present more than one time
in an extended STAMP test packet.[¶](#section-4.1-4){.pilcrow}
:::
:::

::: {#location-info-section}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Location TLV](#name-location-tlv){.section-name .selfRef} {#name-location-tlv}

STAMP Session-Senders [MAY]{.bcp14} include the variable-size Location
TLV to query location information from the Session-Reflector. The
Session-Sender [MUST NOT]{.bcp14} fill any information fields except for
the STAMP TLV Flags, Type, and Length fields. The Session-Reflector
[MUST]{.bcp14} verify that the TLV is well formed. If it is not, the
Session-Reflector follows the procedure defined in [Section
4](#stamp-extension-section){.xref} for a malformed
TLV.[¶](#section-4.2-1){.pilcrow}

[]{#name-location-tlv-2}

::: {#location-tlv-figuret}
::: {#section-4.2-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|      Type     |           Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |        Destination Port       |          Source Port          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                         Sub-TLVs                              ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 8](#figure-8){.selfRef}: [Location
TLV](#name-location-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.2-3){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.2-4.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 2 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.2-4.4){.pilcrow}
:   

Length:
:   A two-octet field equal to the length of the Value field in
    octets.[¶](#section-4.2-4.6){.pilcrow}
:   

Destination Port:
:   A two-octet UDP destination port number of the received STAMP
    packet.[¶](#section-4.2-4.8){.pilcrow}
:   

Source Port:
:   A two-octet UDP source port number of the received STAMP
    packet.[¶](#section-4.2-4.10){.pilcrow}
:   

Sub-TLVs:
:   A sequence of sub-TLVs, as defined further in this section. The
    sub-TLVs are used by the Session-Sender to request location
    information with generic sub-TLV types, and the Session-Reflector
    responds with the corresponding more-specific sub-TLVs for the type
    of address (e.g., IPv4 or IPv6) used at the
    Session-Reflector.[¶](#section-4.2-4.12){.pilcrow}
:   

Note that all fields not filled by either a Session-Sender or
Session-Reflector are transmitted with all bits set to
zero.[¶](#section-4.2-5){.pilcrow}

::: {#location-sub-tlv-sec}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [Location Sub-TLVs](#name-location-sub-tlvs){.section-name .selfRef} {#name-location-sub-tlvs}

A sub-TLV in the Location TLV uses the format displayed in [Figure
5](#tlv-format){.xref}. Handling of the U and M flags in the sub-TLV is
as defined in [Section 4](#stamp-extension-section){.xref}. The I flag
[MUST]{.bcp14} be set by a Session-Sender and Session-Reflector to 0
before transmission and its value ignored on receipt. The following
types of sub-TLVs for the Location TLV are defined in this specification
([Table 5](#sub-tlv-type-tbl){.xref} lists the Type
values):[¶](#section-4.2.1-1){.pilcrow}

[]{.break}

Source MAC Address sub-TLV:
:   A 12-octet sub-TLV. The Type value is 1. The value of the Length
    field [MUST]{.bcp14} be equal to 8. The Value field is an 8-octet
    MBZ field that [MUST]{.bcp14} be zeroed on transmission and ignored
    on receipt.[¶](#section-4.2.1-2.2){.pilcrow}
:   

Source EUI-48 Address sub-TLV:

:   A 12-octet sub-TLV that includes the EUI-48 source MAC address. The
    Type value is 2. The value of the Length field [MUST]{.bcp14} be
    equal to 8.[¶](#section-4.2.1-2.4.1){.pilcrow}

    []{#name-the-value-field-of-the-sour}

    ::: {#eui-48-tlv-figure}
    ::: {#section-4.2.1-2.4.2.1 .artwork .art-text .alignLeft}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                        EUI-48  Address                        |
        +                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                               |            MBZ                |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :::

    [Figure 9](#figure-9){.selfRef}: [The Value Field of the Source
    EUI-48 Address Sub-TLV](#name-the-value-field-of-the-sour){.selfRef}
    :::

    The Value field consists of the following fields ([Figure
    9](#eui-48-tlv-figure){.xref}):[¶](#section-4.2.1-2.4.3){.pilcrow}

    []{.break}

    EUI-48 Address:
    :   A six-octet field.[¶](#section-4.2.1-2.4.4.2){.pilcrow}
    :   

    MBZ:
    :   A two-octet field. It [MUST]{.bcp14} be zeroed on transmission
        and ignored on receipt.[¶](#section-4.2.1-2.4.4.4){.pilcrow}
    :   

:   

Source EUI-64 Address sub-TLV:
:   A 12-octet sub-TLV that includes the EUI-64 source MAC address. The
    Type value is 3. The value of the Length field [MUST]{.bcp14} be
    equal to 8. The Value field consists of an eight-octet EUI-64
    field.[¶](#section-4.2.1-2.6){.pilcrow}
:   

Destination IP Address sub-TLV:
:   A 20-octet sub-TLV. The Type value is 4. The value of the Length
    field [MUST]{.bcp14} be equal to 16. The Value field consists of a
    16-octet MBZ field that [MUST]{.bcp14} be zeroed on transmit and
    ignored on receipt.[¶](#section-4.2.1-2.8){.pilcrow}
:   

Destination IPv4 Address sub-TLV:

:   A 20-octet sub-TLV that includes the IPv4 destination address. The
    Type value is 5. The value of the Length field [MUST]{.bcp14} be
    equal to 16.[¶](#section-4.2.1-2.10.1){.pilcrow}

    []{#name-ipv4-address-in-a-sub-tlvs-}

    ::: {#ipv4-value-figure}
    ::: {#section-4.2.1-2.10.2.1 .artwork .art-text .alignLeft}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                         IPv4 Address                          |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        ~                        MBZ (12 octets)                        ~
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :::

    [Figure 10](#figure-10){.selfRef}: [IPv4 Address in a Sub-TLV\'s
    Value Field](#name-ipv4-address-in-a-sub-tlvs-){.selfRef}
    :::

    The Value field consists of the following fields ([Figure
    10](#ipv4-value-figure){.xref}):[¶](#section-4.2.1-2.10.3){.pilcrow}

    []{.break}

    IPv4 Address:
    :   A four-octet field.[¶](#section-4.2.1-2.10.4.2){.pilcrow}
    :   

    MBZ:
    :   A 12-octet field. It [MUST]{.bcp14} be zeroed on transmit and
        ignored on receipt.[¶](#section-4.2.1-2.10.4.4){.pilcrow}
    :   

:   

Destination IPv6 Address sub-TLV:
:   A 20-octet sub-TLV that includes the IPv6 destination address. The
    Type value is 6. The value of the Length field [MUST]{.bcp14} be
    equal to 16. The Value field is a 16-octet IPv6 Address
    field.[¶](#section-4.2.1-2.12){.pilcrow}
:   

Source IP Address sub-TLV:
:   A 20-octet sub-TLV. The Type value is 7. The value of the Length
    field [MUST]{.bcp14} be equal to 16. The Value field is a 16-octet
    MBZ field that [MUST]{.bcp14} be zeroed on transmit and ignored on
    receipt.[¶](#section-4.2.1-2.14){.pilcrow}
:   

Source IPv4 Address sub-TLV:

:   A 20-octet sub-TLV that includes the IPv4 source address. The Type
    value is 8. The value of the Length field [MUST]{.bcp14} be equal to
    16. The Value field consists of the following fields ([Figure
    10](#ipv4-value-figure){.xref}):[¶](#section-4.2.1-2.16.1){.pilcrow}

    []{.break}

    IPv4 Address:
    :   A four-octet field.[¶](#section-4.2.1-2.16.2.2){.pilcrow}
    :   

    MBZ:
    :   A 12-octet field. It [MUST]{.bcp14} be zeroed on transmit and
        ignored on receipt.[¶](#section-4.2.1-2.16.2.4){.pilcrow}
    :   

:   

Source IPv6 Address sub-TLV:
:   A 20-octet sub-TLV that includes the IPv6 source address. The Type
    value is 9. The value of the Length field [MUST]{.bcp14} be equal to
    16. The Value field is a 16-octet IPv6 Address
    field.[¶](#section-4.2.1-2.18){.pilcrow}
:   
:::
:::

::: {#location-operation-sec}
::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [Theory of Operation of Location TLV](#name-theory-of-operation-of-loca){.section-name .selfRef} {#name-theory-of-operation-of-loca}

The Session-Reflector that received an extended STAMP packet with the
Location TLV [MUST]{.bcp14} include in the reflected packet the Location
TLV with a length equal to the Location TLV length in the received
packet. Based on the local policy, the Session-Reflector [MAY]{.bcp14}
leave some fields unreported by filling them with zeroes. An
implementation of the stateful Session-Reflector [MUST]{.bcp14} provide
control for managing such policies.[¶](#section-4.2.2-1){.pilcrow}

A Session-Sender [MAY]{.bcp14} include the Source MAC Address sub-TLV in
the Location TLV. If the Session-Reflector receives the Location TLV
that includes the Source MAC Address sub-TLV, it [MUST]{.bcp14} include
the Source EUI-48 Address sub-TLV if the source MAC address of the
received extended test packet is in EUI-48 format. And the
Session-Reflector [MUST]{.bcp14} copy the value of the source MAC
address in the EUI-48 field. Otherwise, the Session-Reflector
[MUST]{.bcp14} use the Source EUI-64 Address sub-TLV and [MUST]{.bcp14}
copy the value of the Source MAC Address from the received packet into
the EUI-64 field. If the received extended STAMP test packet does not
have the Source MAC Address, the Session-Reflector [MUST]{.bcp14} zero
the EUI-64 field before transmitting the reflected
packet.[¶](#section-4.2.2-2){.pilcrow}

A Session-Sender [MAY]{.bcp14} include the Destination IP Address
sub-TLV in the Location TLV. If the Session-Reflector receives the
Location TLV that includes the Destination IP Address sub-TLV, it
[MUST]{.bcp14} include the Destination IPv4 Address sub-TLV if the
source IP address of the received extended test packet is of the IPv4
address family. And the Session-Reflector [MUST]{.bcp14} copy the value
of the destination IP address in the IPv4 Address field. Otherwise, the
Session-Reflector [MUST]{.bcp14} use the Destination IPv6 Address
sub-TLV and [MUST]{.bcp14} copy the value of the destination IP address
from the received packet into the IPv6 Address
field.[¶](#section-4.2.2-3){.pilcrow}

A Session-Sender [MAY]{.bcp14} include the Source IP Address sub-TLV in
the Location TLV. If the Session-Reflector receives the Location TLV
that includes the Source IP Address sub-TLV, it [MUST]{.bcp14} include
the Source IPv4 Address sub-TLV if the source IP address of the received
extended test packet is of the IPv4 address family. And the
Session-Reflector [MUST]{.bcp14} copy the value of the source IP address
in the IPv4 Address field. Otherwise, the Session-Reflector
[MUST]{.bcp14} use the Source IPv6 Address sub-TLV and [MUST]{.bcp14}
copy the value of the source IP address from the received packet into
the IPv6 Address field.[¶](#section-4.2.2-4){.pilcrow}

The Location TLV [MAY]{.bcp14} be used to determine the last-hop IP
addresses, ports, and last-hop MAC address for STAMP packets. The MAC
address can indicate a path switch on the last hop. The IP addresses and
UDP ports will indicate if there is a NAT router on the path. It allows
the Session-Sender to identify the IP address of the Session-Reflector
behind the NAT and detect changes in the NAT mapping that could result
in sending the STAMP packets to the wrong
Session-Reflector.[¶](#section-4.2.2-5){.pilcrow}
:::
:::
:::
:::

::: {#timestamp-info-section}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Timestamp Information TLV](#name-timestamp-information-tlv){.section-name .selfRef} {#name-timestamp-information-tlv}

The STAMP Session-Sender [MAY]{.bcp14} include the Timestamp Information
TLV to request information from the Session-Reflector. The
Session-Sender [MUST NOT]{.bcp14} fill any information fields except for
STAMP TLV Flags, Type, and Length. All other fields [MUST]{.bcp14} be
filled with zeroes. The Session-Reflector [MUST]{.bcp14} validate the
Length value of the TLV. If the value of the Length field is invalid,
the Session-Reflector follows the procedure defined in [Section
4](#stamp-extension-section){.xref} for a malformed
TLV.[¶](#section-4.3-1){.pilcrow}

[]{#name-timestamp-information-tlv-2}

::: {#timestamp-tlv-figuret}
::: {#section-4.3-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|      Type     |           Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Sync Src In  | Timestamp In  | Sync Src Out  | Timestamp Out |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ~                    Optional sub-TLVs                          ~
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 11](#figure-11){.selfRef}: [Timestamp Information
TLV](#name-timestamp-information-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.3-3){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.3-4.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 3 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.3-4.4){.pilcrow}
:   

Length:
:   A two-octet field, set equal to the length of the Value field in
    octets ([Figure
    5](#tlv-format){.xref}).[¶](#section-4.3-4.6){.pilcrow}
:   

Sync Src In:
:   A one-octet field that characterizes the source of clock
    synchronization at the ingress of a Session-Reflector. There are
    several methods for synchronizing the clock, e.g., the Network Time
    Protocol (NTP) \[[RFC5905](#RFC5905){.xref}\]. [Table
    7](#ssync-source-new-tbl){.xref} lists the possible
    values.[¶](#section-4.3-4.8){.pilcrow}
:   

Timestamp In:
:   A one-octet field that characterizes the method by which the ingress
    of the Session-Reflector obtained the timestamp T2. A timestamp may
    be obtained with hardware assistance via a software API from a local
    wall clock or from a remote clock (the latter is referred to as a
    \"control plane\"). [Table 9](#timestamp-method-new-tbl){.xref}
    lists the possible values.[¶](#section-4.3-4.10){.pilcrow}
:   

Sync Src Out:
:   A one-octet field that characterizes the source of clock
    synchronization at the egress of the Session-Reflector. [Table
    7](#ssync-source-new-tbl){.xref} lists the possible
    values.[¶](#section-4.3-4.12){.pilcrow}
:   

Timestamp Out:
:   A one-octet field that characterizes the method by which the egress
    of the Session-Reflector obtained the timestamp T3. [Table
    9](#timestamp-method-new-tbl){.xref} lists the possible
    values.[¶](#section-4.3-4.14){.pilcrow}
:   

Optional sub-TLVs:
:   An optional variable-length field.[¶](#section-4.3-4.16){.pilcrow}
:   
:::
:::

::: {#cos-info-section}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Class of Service TLV](#name-class-of-service-tlv){.section-name .selfRef} {#name-class-of-service-tlv}

The STAMP Session-Sender [MAY]{.bcp14} include a Class of Service (CoS)
TLV in the STAMP test packet. The format of the CoS TLV is presented in
[Figure 12](#cos-tlv-figure){.xref}.[¶](#section-4.4-1){.pilcrow}

[]{#name-class-of-service-tlv-2}

::: {#cos-tlv-figure}
::: {#section-4.4-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|      Type     |           Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   DSCP1   |   DSCP2   |ECN| RP|          Reserved             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 12](#figure-12){.selfRef}: [Class of Service
TLV](#name-class-of-service-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.4-3){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.4-4.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 4 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.4-4.4){.pilcrow}
:   

Length:
:   A two-octet field, set equal to the value
    4.[¶](#section-4.4-4.6){.pilcrow}
:   

DSCP1:
:   The Differentiated Services Code Point (DSCP) intended by the
    Session-Sender to be used as the DSCP value of the reflected test
    packet.[¶](#section-4.4-4.8){.pilcrow}
:   

DSCP2:
:   The received value in the DSCP field at the ingress of the
    Session-Reflector.[¶](#section-4.4-4.10){.pilcrow}
:   

ECN:
:   The received value in the ECN field at the ingress of the
    Session-Reflector.[¶](#section-4.4-4.12){.pilcrow}
:   

RP (Reverse Path):
:   A two-bit field. A Session-Sender [MUST]{.bcp14} set the value of
    the RP field to 0 on transmission.[¶](#section-4.4-4.14){.pilcrow}
:   

Reserved:
:   A 16-bit field that [MUST]{.bcp14} be zeroed on transmission and
    ignored on receipt.[¶](#section-4.4-4.16){.pilcrow}
:   

A STAMP Session-Reflector that receives a test packet with the CoS TLV
[MUST]{.bcp14} include the CoS TLV in the reflected test packet. Also,
the Session-Reflector [MUST]{.bcp14} copy the value of the DSCP and ECN
fields of the IP header of the received STAMP test packet into the DSCP2
field in the reflected test packet. Finally, the Session-Reflector
[MUST]{.bcp14} use the local policy to verify whether the CoS
corresponding to the value of the DSCP1 field is permitted in the
domain. If it is, the Session-Reflector [MUST]{.bcp14} set the DSCP
field\'s value in the IP header of the reflected test packet equal to
the value of the DSCP1 field of the received test packet. Otherwise, the
Session-Reflector [MUST]{.bcp14} use the DSCP value of the received
STAMP packet and set the value of the RP field to 1. Upon receiving the
reflected packet, if the value of the RP field is 0, the Session-Sender
will save the DSCP and ECN values for analysis of the CoS in the reverse
direction. If the value of the RP field in the received reflected packet
is 1, only CoS in the forward direction can be
analyzed.[¶](#section-4.4-5){.pilcrow}

Re-mapping of CoS can be used to provide multiple services (e.g., 2G,
3G, LTE in mobile backhaul networks) over the same network.  But if it
is misconfigured, then it is often difficult to diagnose the root cause
of excessive packet drops of higher-level service while packet drops for
lower service packets are at a normal level.  Using a CoS TLV in STAMP
testing helps to troubleshoot the existing problem and also verify
whether Diffserv policies are processing CoS as required by the
configuration.[¶](#section-4.4-6){.pilcrow}
:::
:::

::: {#direct-measurement-section}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [Direct Measurement TLV](#name-direct-measurement-tlv){.section-name .selfRef} {#name-direct-measurement-tlv}

The Direct Measurement TLV enables collection of the number of
in-profile packets, i.e., packets that form a specific data flow, that
had been transmitted and received by the Session-Sender and
Session-Reflector, respectively. The definition of \"in-profile packet\"
is outside the scope of this document and is left to the test operators
to determine.[¶](#section-4.5-1){.pilcrow}

[]{#name-direct-measurement-tlv-2}

::: {#direct-tlv-figuret}
::: {#section-4.5-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|      Type     |           Length              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |              Session-Sender Tx counter  (S_TxC)               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |             Session-Reflector Rx counter  (R_RxC)             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |             Session-Reflector Tx counter  (R_TxC)             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 13](#figure-13){.selfRef}: [Direct Measurement
TLV](#name-direct-measurement-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.5-3){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.5-4.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 5 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.5-4.4){.pilcrow}
:   

Length:
:   A two-octet field equal to the length of the Value field in octets.
    The Length field value [MUST]{.bcp14} equal 12
    octets.[¶](#section-4.5-4.6){.pilcrow}
:   

Session-Sender Tx counter (S_TxC):
:   A four-octet field. The Session-Sender [MUST]{.bcp14} set its value
    equal to the number of the transmitted in-profile
    packets.[¶](#section-4.5-4.8){.pilcrow}
:   

Session-Reflector Rx counter (R_RxC):
:   A four-octet field. It [MUST]{.bcp14} be zeroed by the
    Session-Sender on transmit and ignored by the Session-Reflector on
    receipt. The Session-Reflector [MUST]{.bcp14} fill it with the value
    of in-profile packets received.[¶](#section-4.5-4.10){.pilcrow}
:   

Session-Reflector Tx counter (R_TxC):
:   A four-octet field. It [MUST]{.bcp14} be zeroed by the
    Session-Sender and ignored by the Session-Reflector on receipt. The
    Session-Reflector [MUST]{.bcp14} fill it with the value of the
    transmitted in-profile packets.[¶](#section-4.5-4.12){.pilcrow}
:   

A Session-Sender [MAY]{.bcp14} include the Direct Measurement TLV in a
STAMP test packet. If the received STAMP test packet includes the Direct
Measurement TLV, the Session-Reflector [MUST]{.bcp14} include it in the
reflected test packet. The Session-Reflector [MUST]{.bcp14} copy the
value from the S_TxC field of the received test packet into the same
field of the reflected packet before its
transmission.[¶](#section-4.5-5){.pilcrow}
:::
:::

::: {#access-avail-sec}
::: {#section-4.6 .section}
### [4.6.](#section-4.6){.section-number .selfRef} [Access Report TLV](#name-access-report-tlv){.section-name .selfRef} {#name-access-report-tlv}

A STAMP Session-Sender [MAY]{.bcp14} include an Access Report TLV
([Figure 14](#access-tlv-fig){.xref}) to indicate changes to the access
network status to the Session-Reflector. The definition of an access
network is outside the scope of this
document.[¶](#section-4.6-1){.pilcrow}

[]{#name-access-report-tlv-2}

::: {#access-tlv-fig}
::: {#section-4.6-2.1 .artwork .art-text .alignLeft}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |STAMP TLV Flags|     Type      |           Length              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |   ID  |  Resv |  Return Code  |          Reserved             |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 14](#figure-14){.selfRef}: [Access Report
TLV](#name-access-report-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.6-3){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.6-4.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 6 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.6-4.4){.pilcrow}
:   

Length:
:   A two-octet field, set equal to the value
    4.[¶](#section-4.6-4.6){.pilcrow}
:   

ID (Access ID):

:   A four-bit field that identifies the access network, e.g., 3GPP
    (Radio Access Technologies specified by 3GPP) or non-3GPP (accesses
    that are not specified by 3GPP) \[[TS23501](#TS23501){.xref}\]. The
    value is one of the following:[¶](#section-4.6-4.8.1){.pilcrow}

    []{.break}

    1:
    :   3GPP Network[¶](#section-4.6-4.8.2.2){.pilcrow}
    :   

    2:
    :   Non-3GPP Network[¶](#section-4.6-4.8.2.4){.pilcrow}
    :   

    All other values are invalid; a TLV that contains values other than
    \'1\' or \'2\' [MUST]{.bcp14} be
    discarded.[¶](#section-4.6-4.8.3){.pilcrow}

:   

Resv:
:   A four-bit field that [MUST]{.bcp14} be zeroed on transmission and
    ignored on receipt.[¶](#section-4.6-4.10){.pilcrow}
:   

Return Code:
:   A one-octet field that identifies the report signal, e.g., available
    or unavailable. The value is supplied to the STAMP endpoint through
    some mechanism that is outside the scope of this document. [Section
    5.6](#iana-return-code-reg){.xref} lists the possible
    values.[¶](#section-4.6-4.12){.pilcrow}
:   

Reserved:
:   A two-octet field that [MUST]{.bcp14} be zeroed on transmission and
    ignored on receipt.[¶](#section-4.6-4.14){.pilcrow}
:   

The STAMP Session-Sender that includes the Access Report TLV sets the
value of the Access ID field according to the type of access network it
reports on. Also, the Session-Sender sets the value of the Return Code
field to reflect the operational state of the access network. The
mechanism to determine the state of the access network is outside the
scope of this specification. A STAMP Session-Reflector that received the
test packet with the Access Report TLV [MUST]{.bcp14} include the Access
Report TLV in the reflected test packet. The Session-Reflector
[MUST]{.bcp14} set the value of the Access ID and Return Code fields
equal to the values of the corresponding fields from the test packet it
has received.[¶](#section-4.6-5){.pilcrow}

The Session-Sender [MUST]{.bcp14} also arm a retransmission timer after
sending a test packet that includes the Access Report TLV. This timer
[MUST]{.bcp14} be disarmed upon reception of the reflected STAMP test
packet that includes the Access Report TLV. In the event the timer
expires before such a packet is received, the Session-Sender
[MUST]{.bcp14} retransmit the STAMP test packet that contains the Access
Report TLV. This retransmission [SHOULD]{.bcp14} be repeated up to four
times before the procedure is aborted. Setting the value for the
retransmission timer is based on local policies and the network
environment. The default value of the retransmission timer for the
Access Report TLV [SHOULD]{.bcp14} be three seconds. An implementation
[MUST]{.bcp14} provide control of the retransmission timer value and the
number of retransmissions.[¶](#section-4.6-6){.pilcrow}

The Access Report TLV is used by the Performance Measurement Function
(PMF) components of the Access Steering, Switching, and Splitting
feature for 5G networks \[[TS23501](#TS23501){.xref}\]. The PMF
component in the User Equipment acts as the STAMP Session-Sender, and
the PMF component in the User Plane Function acts as the STAMP
Session-Reflector.[¶](#section-4.6-7){.pilcrow}
:::
:::

::: {#follow-up-tlv}
::: {#section-4.7 .section}
### [4.7.](#section-4.7){.section-number .selfRef} [Follow-Up Telemetry TLV](#name-follow-up-telemetry-tlv){.section-name .selfRef} {#name-follow-up-telemetry-tlv}

A Session-Reflector might be able to put only an \"SW Local\" (see
[Table 9](#timestamp-method-new-tbl){.xref}) timestamp in the Follow-Up
Timestamp field. But the hosting system might provide a timestamp closer
to the start of the actual packet transmission even though it is not
possible to deliver the information to the Session-Sender in time for
the packet itself. This timestamp might nevertheless be important for
the Session-Sender, as it improves the accuracy of network delay
measurement by minimizing the impact of egress queuing delays on the
measurement.[¶](#section-4.7-1){.pilcrow}

A STAMP Session-Sender [MAY]{.bcp14} include the Follow-Up Telemetry TLV
to request information from the Session-Reflector. The Session-Sender
[MUST]{.bcp14} set the Follow-Up Telemetry Type and Length fields to
their appropriate values. The Sequence Number and Follow-Up Timestamp
fields [MUST]{.bcp14} be zeroed on transmission by the Session-Sender
and ignored by the Session-Reflector upon receipt of the STAMP test
packet that includes the Follow-Up Telemetry TLV. The Session-Reflector
[MUST]{.bcp14} validate the Length value of the STAMP test packet. If
the value of the Length field is invalid, the Session-Reflector
[MUST]{.bcp14} zero the Sequence Number and Follow-Up Timestamp fields
and set the M flag in the STAMP TLV Flags field in the reflected packet.
If the Session-Reflector is in the stateless mode (defined in [Section
4.2](https://www.rfc-editor.org/rfc/rfc8762#section-4.2){.relref} of
\[[RFC8762](#RFC8762){.xref}\]), it [MUST]{.bcp14} zero the Sequence
Number and Follow-Up Timestamp fields.[¶](#section-4.7-2){.pilcrow}

[]{#name-follow-up-telemetry-tlv-2}

::: {#follow-up-tlv-fig}
::: {#section-4.7-3.1 .artwork .art-text .alignLeft}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |STAMP TLV Flags|      Type     |           Length              |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                        Sequence Number                        |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |                      Follow-Up Timestamp                      |
        |                                                               |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |  Timestamp M  |                     Reserved                  |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 15](#figure-15){.selfRef}: [Follow-Up Telemetry
TLV](#name-follow-up-telemetry-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.7-4){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.7-5.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 7 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.7-5.4){.pilcrow}
:   

Length:
:   A two-octet field, set equal to the value 16
    octets.[¶](#section-4.7-5.6){.pilcrow}
:   

Sequence Number:
:   A four-octet field indicating the sequence number of the last packet
    reflected in the same STAMP test session. Since the
    Session-Reflector runs in the stateful mode (defined in [Section
    4.2](https://www.rfc-editor.org/rfc/rfc8762#section-4.2){.relref} of
    \[[RFC8762](#RFC8762){.xref}\]), it is the Session-Reflector\'s
    Sequence Number of the previous reflected
    packet.[¶](#section-4.7-5.8){.pilcrow}
:   

Follow-Up Timestamp:
:   An eight-octet field, with the format indicated by the Z flag of the
    Error Estimate field of the STAMP base packet, which is contained in
    this reflected test packet transmitted by a Session-Reflector, as
    described in [Section
    4.2.1](https://www.rfc-editor.org/rfc/rfc8762#section-4.2.1){.relref}
    of \[[RFC8762](#RFC8762){.xref}\]. It carries the timestamp when the
    reflected packet with the specified sequence number was
    sent.[¶](#section-4.7-5.10){.pilcrow}
:   

Timestamp M(ode):
:   A one-octet field that characterizes the method by which the entity
    that transmits a reflected STAMP packet obtained the Follow-Up
    Timestamp. [Table 9](#timestamp-method-new-tbl){.xref} lists the
    possible values.[¶](#section-4.7-5.12){.pilcrow}
:   

Reserved:
:   A three-octet field. Its value [MUST]{.bcp14} be zeroed on
    transmission and ignored on receipt.[¶](#section-4.7-5.14){.pilcrow}
:   
:::
:::

::: {#hmac-sec}
::: {#section-4.8 .section}
### [4.8.](#section-4.8){.section-number .selfRef} [HMAC TLV](#name-hmac-tlv){.section-name .selfRef} {#name-hmac-tlv}

The STAMP authenticated mode protects the integrity of data collected in
the STAMP base packet. STAMP extensions are designed to provide valuable
information about the condition of a network, and protecting the
integrity of that data is also essential. All authenticated STAMP base
packets (per Sections
[4.2.2](https://www.rfc-editor.org/rfc/rfc8762#section-4.2.2){.relref}
and
[4.3.2](https://www.rfc-editor.org/rfc/rfc8762#section-4.3.2){.relref}
of \[[RFC8762](#RFC8762){.xref}\]) compatible with this specification
[MUST]{.bcp14} additionally authenticate the optional TLVs by including
the keyed Hashed Message Authentication Code (HMAC) TLV, with the sole
exception of when there is only one TLV present and it is the Extended
Padding TLV. The HMAC TLV [MUST]{.bcp14} follow all TLVs included in a
STAMP test packet except for the Extra Padding TLV. If the HMAC TLV
appears in any other position in a STAMP extended test packet, then the
situation [MUST]{.bcp14} be processed as HMAC verification failure, as
defined below in this section. The HMAC TLV [MAY]{.bcp14} be used to
protect the integrity of STAMP extensions in the STAMP unauthenticated
mode. An implementation of STAMP extensions [MUST]{.bcp14} provide
controls to enable the integrity protection of STAMP extensions in the
STAMP unauthenticated mode.[¶](#section-4.8-1){.pilcrow}

[]{#name-hmac-tlv-2}

::: {#hmac-tlv-fig}
::: {#section-4.8-3.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |STAMP TLV Flags|      Type     |             Length            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       |                              HMAC                             |
       |                                                               |
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 16](#figure-16){.selfRef}: [HMAC
TLV](#name-hmac-tlv-2){.selfRef}
:::

The fields are defined as follows:[¶](#section-4.8-4){.pilcrow}

[]{.break}

STAMP TLV Flags:
:   An eight-bit field. Its format is presented in [Figure
    6](#tlv-flags-format){.xref}.[¶](#section-4.8-5.2){.pilcrow}
:   

Type:
:   A one-octet field. Value 8 has been allocated by IANA ([Section
    5.1](#iana-stamp-tlv-registry){.xref}).[¶](#section-4.8-5.4){.pilcrow}
:   

Length:
:   A two-octet field, set equal to the value 16
    octets.[¶](#section-4.8-5.6){.pilcrow}
:   

HMAC:
:   A 16-octet field that carries the HMAC digest of the text of all
    preceding TLVs.[¶](#section-4.8-5.8){.pilcrow}
:   

As defined in \[[RFC8762](#RFC8762){.xref}\], STAMP uses HMAC-SHA-256
truncated to 128 bits (see \[[RFC4868](#RFC4868){.xref}\]). All
considerations regarding using the key listed in [Section
4.4](https://www.rfc-editor.org/rfc/rfc8762#section-4.4){.relref} of
\[[RFC8762](#RFC8762){.xref}\] are fully applicable to the use of the
HMAC TLV. Key management and the mechanisms to distribute the HMAC key
are outside the scope of this specification. The HMAC TLV is anticipated
to track updates in the base STAMP protocol
\[[RFC8762](#RFC8762){.xref}\], including the use of more advanced
cryptographic algorithms. HMAC is calculated as defined in
\[[RFC2104](#RFC2104){.xref}\] over text as the concatenation of the
Sequence Number field of the base STAMP packet and all preceding TLVs.
The digest then [MUST]{.bcp14} be truncated to 128 bits and written into
the HMAC field. If the HMAC TLV is present in the extended STAMP test
packet, e.g., in the authenticated mode, HMAC [MUST]{.bcp14} be verified
before using any data in the included STAMP TLVs. If HMAC verification
by the Session-Reflector fails, then the Session-Reflector
[MUST]{.bcp14} stop processing the received extended STAMP test packet.
The Session-Reflector [MUST]{.bcp14} copy the TLVs from the received
STAMP test packet into the reflected packet. The Session-Reflector
[MUST]{.bcp14} set the I flag in each TLV copied over into the reflected
packet to 1 before transmitting the reflected test packet. If the
Session-Sender receives the extended STAMP test packet with I flag set
to 1, then the Session-Sender [MUST]{.bcp14} stop processing TLVs in the
reflected test packet. If HMAC verification by the Session-Sender fails,
then the Session-Sender [MUST]{.bcp14} stop processing TLVs in the
reflected extended STAMP packet.[¶](#section-4.8-6){.pilcrow}
:::
:::
:::
:::

::: {#iana-consider}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

IANA has created the following subregistries under the \"Simple Two-way
Active Measurement Protocol (STAMP) TLV Types\"
registry.[¶](#section-5-1){.pilcrow}

::: {#iana-stamp-tlv-registry}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [STAMP TLV Types Subregistry](#name-stamp-tlv-types-subregistry){.section-name .selfRef} {#name-stamp-tlv-types-subregistry}

IANA has created the \"STAMP TLV Types\" subregistry. The code points in
this registry are allocated according to the registration procedures
\[[RFC8126](#RFC8126){.xref}\] described in [Table
1](#iana-stamp-type-tbl){.xref}.[¶](#section-5.1-1){.pilcrow}

[]{#name-registration-procedures-for}

::: {#iana-stamp-type-tbl}
  Range       Registration Procedures
  ----------- -------------------------
  1 - 175     IETF Review
  176 - 239   First Come First Served
  240 - 251   Experimental Use
  252 - 254   Private Use

  : [Table 1](#table-1){.selfRef}: [Registration Procedures for the
  STAMP TLV Types
  Subregistry](#name-registration-procedures-for){.selfRef}
:::

Per this document, IANA has allocated the following values in the
\"STAMP TLV Types\" subregistry:[¶](#section-5.1-3){.pilcrow}

[]{#name-stamp-tlv-types}

::: {#stamp-new-type-tbl}
  Value   Description             Reference
  ------- ----------------------- -----------
  0       Reserved                RFC 8972
  1       Extra Padding           RFC 8972
  2       Location                RFC 8972
  3       Timestamp Information   RFC 8972
  4       Class of Service        RFC 8972
  5       Direct Measurement      RFC 8972
  6       Access Report           RFC 8972
  7       Follow-Up Telemetry     RFC 8972
  8       HMAC                    RFC 8972
  255     Reserved                RFC 8972

  : [Table 2](#table-2){.selfRef}: [STAMP TLV
  Types](#name-stamp-tlv-types){.selfRef}
:::
:::
:::

::: {#iana-tlv-flags-reg}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [STAMP TLV Flags Subregistry](#name-stamp-tlv-flags-subregistry){.section-name .selfRef} {#name-stamp-tlv-flags-subregistry}

IANA has created the \"STAMP TLV Flags\" subregistry. The registration
procedure is \"IETF Review\" \[[RFC8126](#RFC8126){.xref}\]. The flags
are 8 bits. Per this document, IANA has allocated the following bit
positions in the \"STAMP TLV Flags\"
subregistry.[¶](#section-5.2-1){.pilcrow}

[]{#name-stamp-tlv-flags}

::: {#tlv-flags-new-tbl}
  Bit position   Symbol   Description              Reference
  -------------- -------- ------------------------ -----------
  0              U        Unrecognized TLV         RFC 8972
  1              M        Malformed TLV            RFC 8972
  2              I        Integrity check failed   RFC 8972

  : [Table 3](#table-3){.selfRef}: [STAMP TLV
  Flags](#name-stamp-tlv-flags){.selfRef}
:::
:::
:::

::: {#iana-sub-tlv-registry}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [STAMP Sub-TLV Types Subregistry](#name-stamp-sub-tlv-types-subregi){.section-name .selfRef} {#name-stamp-sub-tlv-types-subregi}

IANA has created the \"STAMP Sub-TLV Types\" subregistry. The code
points in this registry are allocated according to the registration
procedures \[[RFC8126](#RFC8126){.xref}\] described in [Table
4](#iana-sub-type-tbl){.xref}.[¶](#section-5.3-1){.pilcrow}

[]{#name-registration-procedures-for-}

::: {#iana-sub-type-tbl}
  Range       Registration Procedures
  ----------- -------------------------
  1 - 175     IETF Review
  176 - 239   First Come First Served
  240 - 251   Experimental Use
  252 - 254   Private Use

  : [Table 4](#table-4){.selfRef}: [Registration Procedures for the
  STAMP Sub-TLV Types
  Subregistry](#name-registration-procedures-for-){.selfRef}
:::

Per this document, IANA has allocated the following values in the
\"STAMP Sub-TLV Types\" subregistry:[¶](#section-5.3-3){.pilcrow}

[]{#name-stamp-sub-tlv-types}

::: {#sub-tlv-type-tbl}
  Value   Description                TLV Used   Reference
  ------- -------------------------- ---------- -----------
  0       Reserved                              RFC 8972
  1       Source MAC Address         Location   RFC 8972
  2       Source EUI-48 Address      Location   RFC 8972
  3       Source EUI-64 Address      Location   RFC 8972
  4       Destination IP Address     Location   RFC 8972
  5       Destination IPv4 Address   Location   RFC 8972
  6       Destination IPv6 Address   Location   RFC 8972
  7       Source IP Address          Location   RFC 8972
  8       Source IPv4 Address        Location   RFC 8972
  9       Source IPv6 Address        Location   RFC 8972
  255     Reserved                              RFC 8972

  : [Table 5](#table-5){.selfRef}: [STAMP Sub-TLV
  Types](#name-stamp-sub-tlv-types){.selfRef}
:::
:::
:::

::: {#iana-sync-source-reg}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [STAMP Synchronization Sources Subregistry](#name-stamp-synchronization-sourc){.section-name .selfRef} {#name-stamp-synchronization-sourc}

IANA has created the \"STAMP Synchronization Sources\" subregistry. The
code points in this registry are allocated according to the registration
procedures \[[RFC8126](#RFC8126){.xref}\] described in [Table
6](#iana-sync-source-tbl){.xref}.[¶](#section-5.4-1){.pilcrow}

[]{#name-registration-procedures-for-t}

::: {#iana-sync-source-tbl}
  Range       Registration Procedures
  ----------- -------------------------
  1 - 127     IETF Review
  128 - 239   First Come First Served
  240 - 249   Experimental Use
  250 - 254   Private Use

  : [Table 6](#table-6){.selfRef}: [Registration Procedures for the
  STAMP Synchronization Sources
  Subregistry](#name-registration-procedures-for-t){.selfRef}
:::

Per this document, IANA has allocated the following values in the
\"STAMP Synchronization Sources\"
subregistry:[¶](#section-5.4-3){.pilcrow}

[]{#name-stamp-synchronization-source}

::: {#ssync-source-new-tbl}
  Value   Description                       Reference
  ------- --------------------------------- -----------
  0       Reserved                          RFC 8972
  1       NTP                               RFC 8972
  2       PTP                               RFC 8972
  3       SSU/BITS                          RFC 8972
  4       GPS/GLONASS/LORAN-C/BDS/Galileo   RFC 8972
  5       Local free-running                RFC 8972
  255     Reserved                          RFC 8972

  : [Table 7](#table-7){.selfRef}: [STAMP Synchronization
  Sources](#name-stamp-synchronization-source){.selfRef}
:::
:::
:::

::: {#iana-tiemstamp-methog-reg}
::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [STAMP Timestamping Methods Subregistry](#name-stamp-timestamping-methods-){.section-name .selfRef} {#name-stamp-timestamping-methods-}

IANA has created the \"STAMP Timestamping Methods\" subregistry. The
code points in this registry are allocated according to the registration
procedures \[[RFC8126](#RFC8126){.xref}\] described in [Table
8](#iana-timestamp-method-tbl){.xref}.[¶](#section-5.5-1){.pilcrow}

[]{#name-registration-procedures-for-th}

::: {#iana-timestamp-method-tbl}
  Range       Registration Procedures
  ----------- -------------------------
  1 - 127     IETF Review
  128 - 239   First Come First Served
  240 - 249   Experimental Use
  250 - 254   Private Use

  : [Table 8](#table-8){.selfRef}: [Registration Procedures for the
  STAMP Timestamping Methods
  Subregistry](#name-registration-procedures-for-th){.selfRef}
:::

Per this document, IANA has allocated the following values in the
\"STAMP Timestamping Methods\" subregistry:[¶](#section-5.5-3){.pilcrow}

[]{#name-stamp-timestamping-methods}

::: {#timestamp-method-new-tbl}
  Value   Description     Reference
  ------- --------------- -----------
  0       Reserved        RFC 8972
  1       HW Assist       RFC 8972
  2       SW Local        RFC 8972
  3       Control Plane   RFC 8972
  255     Reserved        RFC 8972

  : [Table 9](#table-9){.selfRef}: [STAMP Timestamping
  Methods](#name-stamp-timestamping-methods){.selfRef}
:::
:::
:::

::: {#iana-return-code-reg}
::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [STAMP Return Codes Subregistry](#name-stamp-return-codes-subregis){.section-name .selfRef} {#name-stamp-return-codes-subregis}

IANA has created the \"STAMP Return Codes\" subregistry. The code points
in this registry are allocated according to the registration procedures
\[[RFC8126](#RFC8126){.xref}\] described in [Table
10](#iana-return-code-tbl){.xref}.[¶](#section-5.6-1){.pilcrow}

[]{#name-registration-procedures-for-the}

::: {#iana-return-code-tbl}
  Range       Registration Procedures
  ----------- -------------------------
  1 - 127     IETF Review
  128 - 239   First Come First Served
  240 - 249   Experimental Use
  250 - 254   Private Use

  : [Table 10](#table-10){.selfRef}: [Registration Procedures for the
  STAMP Return Codes
  Subregistry](#name-registration-procedures-for-the){.selfRef}
:::

Per this document, IANA has allocated the following values in the
\"STAMP Return Codes\" subregistry:[¶](#section-5.6-3){.pilcrow}

[]{#name-stamp-return-codes}

::: {#return-code-new-tbl}
  Value   Description           Reference
  ------- --------------------- -----------
  0       Reserved              RFC 8972
  1       Network available     RFC 8972
  2       Network unavailable   RFC 8972
  255     Reserved              RFC 8972

  : [Table 11](#table-11){.selfRef}: [STAMP Return
  Codes](#name-stamp-return-codes){.selfRef}
:::
:::
:::
:::
:::

::: {#security}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document defines extensions to STAMP \[[RFC8762](#RFC8762){.xref}\]
and inherits all the security considerations applicable to the base
protocol. Additionally, the HMAC TLV is defined in this document. Though
the HMAC TLV protects the integrity of STAMP extensions, it does not
protect against a replay attack. The use of the HMAC TLV is discussed in
detail in [Section 4.8](#hmac-sec){.xref}.[¶](#section-6-1){.pilcrow}

To protect against a malformed TLV, an implementation of a
Session-Sender and Session-Reflector
[MUST]{.bcp14}:[¶](#section-6-2){.pilcrow}

-   [check the setting of the M flag
    and[¶](#section-6-3.1){.pilcrow}]{#section-6-3.1}
-   [validate the Length field
    value.[¶](#section-6-3.2){.pilcrow}]{#section-6-3.2}

As this specification defines the mechanism to test DSCP mapping, this
document inherits all the security considerations discussed in
\[[RFC2474](#RFC2474){.xref}\]. Monitoring and optional control of DSCP
using the CoS TLV may be used across the Internet so that the
Session-Sender and the Session-Reflector are located in domains that use
different CoS profiles. Thus, it is essential that an operator verify
the set of CoS values that is used in the Session-Reflector\'s domain.
Also, an implementation of a Session-Reflector [SHOULD]{.bcp14} support
a local policy to confirm whether the value sent by the Session-Sender
can be used as the value of the DSCP field. [Section
4.4](#cos-info-section){.xref} defines the use of that local
policy.[¶](#section-6-4){.pilcrow}
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2104\]
:   [Krawczyk, H.]{.refAuthor}[, Bellare, M.]{.refAuthor}[, and R.
    Canetti]{.refAuthor}, [\"HMAC: Keyed-Hashing for Message
    Authentication\"]{.refTitle}, [RFC 2104]{.seriesInfo}, [DOI
    10.17487/RFC2104]{.seriesInfo}, February 1997,
    \<<https://www.rfc-editor.org/info/rfc2104>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8762\]
:   [Mirsky, G.]{.refAuthor}[, Jun, G.]{.refAuthor}[,
    Nydell, H.]{.refAuthor}[, and R. Foote]{.refAuthor}, [\"Simple
    Two-Way Active Measurement Protocol\"]{.refTitle}, [RFC
    8762]{.seriesInfo}, [DOI 10.17487/RFC8762]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8762>\>.
:   
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[GPS\]
:   [\"Global Positioning System (GPS) Standard Positioning Service
    (SPS) Performance Standard\"]{.refTitle}, [GPS SPS 5th
    Edition]{.seriesInfo}, April 2020.
:   

\[IEEE.1588.2008\]
:   [\"IEEE Standard for a Precision Clock Synchronization Protocol for
    Networked Measurement and Control Systems\"]{.refTitle}, [IEEE Std.
    1588-2008]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2008.4579760]{.seriesInfo}, July 2008,
    \<<https://doi.org/10.1109/IEEESTD.2008.4579760>\>.
:   

\[NUM-IDS-GEN\]
:   [Gont, F.]{.refAuthor}[ and I. Arce]{.refAuthor}, [\"On the
    Generation of Transient Numeric Identifiers\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-irtf-pearg-numeric-ids-generation-06]{.seriesInfo}, 13 January
    2021,
    \<<https://tools.ietf.org/html/draft-irtf-pearg-numeric-ids-generation-06>\>.
:   

\[RFC2474\]
:   [Nichols, K.]{.refAuthor}[, Blake, S.]{.refAuthor}[,
    Baker, F.]{.refAuthor}[, and D. Black]{.refAuthor}, [\"Definition of
    the Differentiated Services Field (DS Field) in the IPv4 and IPv6
    Headers\"]{.refTitle}, [RFC 2474]{.seriesInfo}, [DOI
    10.17487/RFC2474]{.seriesInfo}, December 1998,
    \<<https://www.rfc-editor.org/info/rfc2474>\>.
:   

\[RFC4868\]
:   [Kelly, S.]{.refAuthor}[ and S. Frankel]{.refAuthor}, [\"Using
    HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with
    IPsec\"]{.refTitle}, [RFC 4868]{.seriesInfo}, [DOI
    10.17487/RFC4868]{.seriesInfo}, May 2007,
    \<<https://www.rfc-editor.org/info/rfc4868>\>.
:   

\[RFC5357\]
:   [Hedayat, K.]{.refAuthor}[, Krzanowski, R.]{.refAuthor}[,
    Morton, A.]{.refAuthor}[, Yum, K.]{.refAuthor}[, and J.
    Babiarz]{.refAuthor}, [\"A Two-Way Active Measurement Protocol
    (TWAMP)\"]{.refTitle}, [RFC 5357]{.seriesInfo}, [DOI
    10.17487/RFC5357]{.seriesInfo}, October 2008,
    \<<https://www.rfc-editor.org/info/rfc5357>\>.
:   

\[RFC5905\]
:   [Mills, D.]{.refAuthor}[, Martin, J., Ed.]{.refAuthor}[,
    Burbank, J.]{.refAuthor}[, and W. Kasch]{.refAuthor}, [\"Network
    Time Protocol Version 4: Protocol and Algorithms
    Specification\"]{.refTitle}, [RFC 5905]{.seriesInfo}, [DOI
    10.17487/RFC5905]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5905>\>.
:   

\[TS23501\]
:   [3GPP]{.refAuthor}, [\"Technical Specification Group Services and
    System Aspects; System Architecture for the 5G System (5GS); Stage 2
    (Release 16)\"]{.refTitle}, [3GPP TS 23.501]{.seriesInfo}, 2019.
:   
:::
:::

::: {#section-appendix.a .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors very much appreciate the thorough review and thoughtful
comments received from [Tianran Zhou]{.contact-name}, [Rakesh
Gandhi]{.contact-name}, [Yuezhong Song]{.contact-name}, and [Yali
Wang]{.contact-name}. The authors express their gratitude to [Al
Morton]{.contact-name} for his comments and valuable suggestions. The
authors greatly appreciate the comments and thoughtful suggestions
received from [Martin
Duke]{.contact-name}.[¶](#section-appendix.a-1){.pilcrow}
:::

::: {#section-appendix.b .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The following individual contributed text to this
document:[¶](#section-appendix.b-1){.pilcrow}

::: {.left dir="auto"}
[Guo Jun]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ZTE Corporation]{.org}
:::

::: {.left dir="auto"}
[68# Zijinghua Road]{.street-address}
:::

::: {.left dir="auto"}
[Nanjing]{.locality}
:::

::: {.left dir="auto"}
[Jiangsu]{.region}, [210012]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: tel
Phone: [+86 18105183663](tel:+86%2018105183663){.tel}
:::

::: email
Email: <guo.jun2@zte.com.cn>
:::
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Greg Mirsky]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ZTE Corp.]{.org}
:::

::: email
Email: <gregimirsky@gmail.com>
:::

::: {.left dir="auto"}
[Xiao Min]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ZTE Corp.]{.org}
:::

::: email
Email: <xiao.min2@zte.com.cn>
:::

::: {.left dir="auto"}
[Henrik Nydell]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Accedian Networks]{.org}
:::

::: email
Email: <hnydell@accedian.com>
:::

::: {.left dir="auto"}
[Richard Foote]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: email
Email: <footer.foote@nokia.com>
:::

::: {.left dir="auto"}
[Adi Masputra]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Apple Inc.]{.org}
:::

::: {.left dir="auto"}
[One Apple Park Way]{.street-address}
:::

::: {.left dir="auto"}
[Cupertino]{.locality}, [CA]{.region} [95014]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <adi@apple.com>
:::

::: {.left dir="auto"}
[Ernesto Ruffini]{.fn .nameRole}
:::

::: {.left dir="auto"}
[OutSys]{.org}
:::

::: {.left dir="auto"}
[via Caracciolo, 65]{.street-address}
:::

::: {.left dir="auto"}
[20155]{.postal-code} [Milan]{.locality}
:::

::: {.left dir="auto"}
[Italy]{.country-name}
:::

::: email
Email: <eruffini@outsys.org>
:::
:::
:::
