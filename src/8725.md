  RFC 8725          JWT BCP                 February 2020
  ----------------- ----------------------- ---------------
  Sheffer, et al.   Best Current Practice   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8725](https://www.rfc-editor.org/rfc/rfc8725){.eref}

BCP:
:   225

Updates:
:   [7519](https://www.rfc-editor.org/rfc/rfc7519){.eref}

Category:
:   Best Current Practice

Published:
:   February 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    Y. Sheffer
    :::

    ::: org
    Intuit
    :::
    :::

    ::: author
    ::: author-name
    D. Hardt
    :::
    :::

    ::: author
    ::: author-name
    M. Jones
    :::

    ::: org
    Microsoft
    :::
    :::
:::

# RFC 8725 {#rfcnum}

# JSON Web Token Best Current Practices {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

JSON Web Tokens, also known as JWTs, are URL-safe JSON-based security
tokens that contain a set of claims that can be signed and/or encrypted.
JWTs are being widely used and deployed as a simple security token
format in numerous protocols and applications, both in the area of
digital identity and in other application areas. This Best Current
Practices document updates RFC 7519 to provide actionable guidance
leading to secure implementation and deployment of
JWTs.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This memo documents an Internet Best Current
Practice.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on BCPs
is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8725>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Target
        Audience](#name-target-audience){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Conventions Used in this
        Document](#name-conventions-used-in-this-do){.xref}[¶](#section-toc.1-1.1.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Threats and
    Vulnerabilities](#name-threats-and-vulnerabilities){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Weak Signatures and Insufficient
        Signature
        Validation](#name-weak-signatures-and-insuffi){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Weak Symmetric
        Keys](#name-weak-symmetric-keys){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Incorrect Composition of
        Encryption and
        Signature](#name-incorrect-composition-of-en){.xref}[¶](#section-toc.1-1.2.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.4}
        [2.4](#section-2.4){.xref}.  [Plaintext Leakage through Analysis
        of Ciphertext
        Length](#name-plaintext-leakage-through-a){.xref}[¶](#section-toc.1-1.2.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.5}
        [2.5](#section-2.5){.xref}.  [Insecure Use of Elliptic Curve
        Encryption](#name-insecure-use-of-elliptic-cu){.xref}[¶](#section-toc.1-1.2.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.6}
        [2.6](#section-2.6){.xref}.  [Multiplicity of JSON
        Encodings](#name-multiplicity-of-json-encodi){.xref}[¶](#section-toc.1-1.2.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.7}
        [2.7](#section-2.7){.xref}.  [Substitution
        Attacks](#name-substitution-attacks){.xref}[¶](#section-toc.1-1.2.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.8}
        [2.8](#section-2.8){.xref}.  [Cross-JWT
        Confusion](#name-cross-jwt-confusion){.xref}[¶](#section-toc.1-1.2.2.8.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.9}
        [2.9](#section-2.9){.xref}.  [Indirect Attacks on the
        Server](#name-indirect-attacks-on-the-ser){.xref}[¶](#section-toc.1-1.2.2.9.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Best
    Practices](#name-best-practices){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Perform Algorithm
        Verification](#name-perform-algorithm-verificat){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Use Appropriate
        Algorithms](#name-use-appropriate-algorithms){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Validate All Cryptographic
        Operations](#name-validate-all-cryptographic-){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Validate Cryptographic
        Inputs](#name-validate-cryptographic-inpu){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Ensure Cryptographic Keys Have
        Sufficient
        Entropy](#name-ensure-cryptographic-keys-h){.xref}[¶](#section-toc.1-1.3.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [Avoid Compression of Encryption
        Inputs](#name-avoid-compression-of-encryp){.xref}[¶](#section-toc.1-1.3.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Use
        UTF-8](#name-use-utf-8){.xref}[¶](#section-toc.1-1.3.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.8}
        [3.8](#section-3.8){.xref}.  [Validate Issuer and
        Subject](#name-validate-issuer-and-subject){.xref}[¶](#section-toc.1-1.3.2.8.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.9}
        [3.9](#section-3.9){.xref}.  [Use and Validate
        Audience](#name-use-and-validate-audience){.xref}[¶](#section-toc.1-1.3.2.9.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.10}
        [3.10](#section-3.10){.xref}. [Do Not Trust Received
        Claims](#name-do-not-trust-received-claim){.xref}[¶](#section-toc.1-1.3.2.10.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.11}
        [3.11](#section-3.11){.xref}. [Use Explicit
        Typing](#name-use-explicit-typing){.xref}[¶](#section-toc.1-1.3.2.11.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.12}
        [3.12](#section-3.12){.xref}. [Use Mutually Exclusive Validation
        Rules for Different Kinds of
        JWTs](#name-use-mutually-exclusive-vali){.xref}[¶](#section-toc.1-1.3.2.12.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

JSON Web Tokens, also known as JWTs \[[RFC7519](#RFC7519){.xref}\], are
URL-safe JSON-based security tokens that contain a set of claims that
can be signed and/or encrypted. The JWT specification has seen rapid
adoption because it encapsulates security-relevant information in one
easy-to-protect location, and because it is easy to implement using
widely available tools. One application area in which JWTs are commonly
used is representing digital identity information, such as OpenID
Connect ID Tokens \[[OpenID.Core](#OpenID.Core){.xref}\] and OAuth 2.0
\[[RFC6749](#RFC6749){.xref}\] access tokens and refresh tokens, the
details of which are deployment-specific.[¶](#section-1-1){.pilcrow}

Since the JWT specification was published, there have been several
widely published attacks on implementations and deployments. Such
attacks are the result of under-specified security mechanisms, as well
as incomplete implementations and incorrect usage by
applications.[¶](#section-1-2){.pilcrow}

The goal of this document is to facilitate secure implementation and
deployment of JWTs. Many of the recommendations in this document are
about implementation and use of the cryptographic mechanisms underlying
JWTs that are defined by JSON Web Signature (JWS)
\[[RFC7515](#RFC7515){.xref}\], JSON Web Encryption (JWE)
\[[RFC7516](#RFC7516){.xref}\], and JSON Web Algorithms (JWA)
\[[RFC7518](#RFC7518){.xref}\]. Others are about use of the JWT claims
themselves.[¶](#section-1-3){.pilcrow}

These are intended to be minimum recommendations for the use of JWTs in
the vast majority of implementation and deployment scenarios. Other
specifications that reference this document can have stricter
requirements related to one or more aspects of the format, based on
their particular circumstances; when that is the case, implementers are
advised to adhere to those stricter requirements. Furthermore, this
document provides a floor, not a ceiling, so stronger options are always
allowed (e.g., depending on differing evaluations of the importance of
cryptographic strength vs. computational
load).[¶](#section-1-4){.pilcrow}

Community knowledge about the strength of various algorithms and
feasible attacks can change quickly, and experience shows that a Best
Current Practice (BCP) document about security is a point-in-time
statement. Readers are advised to seek out any errata or updates that
apply to this document.[¶](#section-1-5){.pilcrow}

::: {#target-audience}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Target Audience](#name-target-audience){.section-name .selfRef} {#name-target-audience}

The intended audiences of this document
are:[¶](#section-1.1-1){.pilcrow}

-   [Implementers of JWT libraries (and the JWS and JWE libraries used
    by those
    libraries),[¶](#section-1.1-2.1){.pilcrow}]{#section-1.1-2.1}
-   [Implementers of code that uses such libraries (to the extent that
    some mechanisms may not be provided by libraries, or until they
    are), and[¶](#section-1.1-2.2){.pilcrow}]{#section-1.1-2.2}
-   [Developers of specifications that rely on JWTs, both inside and
    outside the IETF.[¶](#section-1.1-2.3){.pilcrow}]{#section-1.1-2.3}
:::
:::

::: {#conventions-used-in-this-document}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Conventions Used in this Document](#name-conventions-used-in-this-do){.section-name .selfRef} {#name-conventions-used-in-this-do}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.2-1){.pilcrow}
:::
:::
:::
:::

::: {#threats-and-vulnerabilities}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Threats and Vulnerabilities](#name-threats-and-vulnerabilities){.section-name .selfRef} {#name-threats-and-vulnerabilities}

This section lists some known and possible problems with JWT
implementations and deployments. Each problem description is followed by
references to one or more mitigations to those
problems.[¶](#section-2-1){.pilcrow}

::: {#weak-signatures-and-insufficient-signature-validation}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Weak Signatures and Insufficient Signature Validation](#name-weak-signatures-and-insuffi){.section-name .selfRef} {#name-weak-signatures-and-insuffi}

Signed JSON Web Tokens carry an explicit indication of the signing
algorithm, in the form of the \"alg\" Header Parameter, to facilitate
cryptographic agility. This, in conjunction with design flaws in some
libraries and applications, has led to several
attacks:[¶](#section-2.1-1){.pilcrow}

-   [The algorithm can be changed to \"none\" by an attacker, and some
    libraries would trust this value and \"validate\" the JWT without
    checking any
    signature.[¶](#section-2.1-2.1){.pilcrow}]{#section-2.1-2.1}
-   [An \"RS256\" (RSA, 2048 bit) parameter value can be changed into
    \"HS256\" (HMAC, SHA-256), and some libraries would try to validate
    the signature using HMAC-SHA256 and using the RSA public key as the
    HMAC shared secret (see \[[McLean](#McLean){.xref}\] and
    \[[CVE-2015-9235](#CVE-2015-9235){.xref}\]).[¶](#section-2.1-2.2){.pilcrow}]{#section-2.1-2.2}

For mitigations, see Sections [3.1](#algorithm-verification){.xref} and
[3.2](#appropriate-algorithms){.xref}.[¶](#section-2.1-3){.pilcrow}
:::
:::

::: {#weak-symmetric-keys}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Weak Symmetric Keys](#name-weak-symmetric-keys){.section-name .selfRef} {#name-weak-symmetric-keys}

In addition, some applications use a keyed Message Authentication Code
(MAC) algorithm, such as \"HS256\", to sign tokens but supply a weak
symmetric key with insufficient entropy (such as a human-memorable
password). Such keys are vulnerable to offline brute-force or dictionary
attacks once an attacker gets hold of such a token
\[[Langkemper](#Langkemper){.xref}\].[¶](#section-2.2-1){.pilcrow}

For mitigations, see [Section
3.5](#key-entropy){.xref}.[¶](#section-2.2-2){.pilcrow}
:::
:::

::: {#incorrect-composition-of-encryption-and-signature}
::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Incorrect Composition of Encryption and Signature](#name-incorrect-composition-of-en){.section-name .selfRef} {#name-incorrect-composition-of-en}

Some libraries that decrypt a JWE-encrypted JWT to obtain a JWS-signed
object do not always validate the internal
signature.[¶](#section-2.3-1){.pilcrow}

For mitigations, see [Section
3.3](#validate-crypto){.xref}.[¶](#section-2.3-2){.pilcrow}
:::
:::

::: {#plaintext-leakage-through-analysis-of-ciphertext-length}
::: {#section-2.4 .section}
### [2.4.](#section-2.4){.section-number .selfRef} [Plaintext Leakage through Analysis of Ciphertext Length](#name-plaintext-leakage-through-a){.section-name .selfRef} {#name-plaintext-leakage-through-a}

Many encryption algorithms leak information about the length of the
plaintext, with a varying amount of leakage depending on the algorithm
and mode of operation. This problem is exacerbated when the plaintext is
initially compressed, because the length of the compressed plaintext
and, thus, the ciphertext depends not only on the length of the original
plaintext but also on its content. Compression attacks are particularly
powerful when there is attacker-controlled data in the same compression
space as secret data, which is the case for some attacks on
HTTPS.[¶](#section-2.4-1){.pilcrow}

See \[[Kelsey](#Kelsey){.xref}\] for general background on compression
and encryption and \[[Alawatugoda](#Alawatugoda){.xref}\] for a specific
example of attacks on HTTP cookies.[¶](#section-2.4-2){.pilcrow}

For mitigations, see [Section
3.6](#no-compression){.xref}.[¶](#section-2.4-3){.pilcrow}
:::
:::

::: {#insecure-use-of-elliptic-curve-encryption}
::: {#section-2.5 .section}
### [2.5.](#section-2.5){.section-number .selfRef} [Insecure Use of Elliptic Curve Encryption](#name-insecure-use-of-elliptic-cu){.section-name .selfRef} {#name-insecure-use-of-elliptic-cu}

Per \[[Sanso](#Sanso){.xref}\], several Javascript Object Signing and
Encryption (JOSE) libraries fail to validate their inputs correctly when
performing elliptic curve key agreement (the \"ECDH-ES\" algorithm). An
attacker that is able to send JWEs of its choosing that use invalid
curve points and observe the cleartext outputs resulting from decryption
with the invalid curve points can use this vulnerability to recover the
recipient\'s private key.[¶](#section-2.5-1){.pilcrow}

For mitigations, see [Section
3.4](#validate-inputs){.xref}.[¶](#section-2.5-2){.pilcrow}
:::
:::

::: {#multiplicity-of-json-encodings}
::: {#section-2.6 .section}
### [2.6.](#section-2.6){.section-number .selfRef} [Multiplicity of JSON Encodings](#name-multiplicity-of-json-encodi){.section-name .selfRef} {#name-multiplicity-of-json-encodi}

Previous versions of the JSON format, such as the obsoleted
\[[RFC7159](#RFC7159){.xref}\], allowed several different character
encodings: UTF-8, UTF-16, and UTF-32. This is not the case anymore, with
the latest standard \[[RFC8259](#RFC8259){.xref}\] only allowing UTF-8
except for internal use within a \"closed ecosystem\". This ambiguity,
where older implementations and those used within closed environments
may generate non-standard encodings, may result in the JWT being
misinterpreted by its recipient. This, in turn, could be used by a
malicious sender to bypass the recipient\'s validation
checks.[¶](#section-2.6-1){.pilcrow}

For mitigations, see [Section
3.7](#use-utf8){.xref}.[¶](#section-2.6-2){.pilcrow}
:::
:::

::: {#substitution}
::: {#section-2.7 .section}
### [2.7.](#section-2.7){.section-number .selfRef} [Substitution Attacks](#name-substitution-attacks){.section-name .selfRef} {#name-substitution-attacks}

There are attacks in which one recipient will be given a JWT that was
intended for it and will attempt to use it at a different recipient for
which that JWT was not intended. For instance, if an OAuth 2.0
\[[RFC6749](#RFC6749){.xref}\] access token is legitimately presented to
an OAuth 2.0 protected resource for which it is intended, that protected
resource might then present that same access token to a different
protected resource for which the access token is not intended, in an
attempt to gain access. If such situations are not caught, this can
result in the attacker gaining access to resources that it is not
entitled to access.[¶](#section-2.7-1){.pilcrow}

For mitigations, see Sections [3.8](#validate-iss-sub){.xref} and
[3.9](#use-aud){.xref}.[¶](#section-2.7-2){.pilcrow}
:::
:::

::: {#cross-jwt-confusion}
::: {#section-2.8 .section}
### [2.8.](#section-2.8){.section-number .selfRef} [Cross-JWT Confusion](#name-cross-jwt-confusion){.section-name .selfRef} {#name-cross-jwt-confusion}

As JWTs are being used by more different protocols in diverse
application areas, it becomes increasingly important to prevent cases of
JWT tokens that have been issued for one purpose being subverted and
used for another. Note that this is a specific type of substitution
attack. If the JWT could be used in an application context in which it
could be confused with other kinds of JWTs, then mitigations
[MUST]{.bcp14} be employed to prevent these substitution
attacks.[¶](#section-2.8-1){.pilcrow}

For mitigations, see Sections [3.8](#validate-iss-sub){.xref},
[3.9](#use-aud){.xref}, [3.11](#use-typ){.xref}, and
[3.12](#preventing-confusion){.xref}.[¶](#section-2.8-2){.pilcrow}
:::
:::

::: {#indirect-attacks-on-the-server}
::: {#section-2.9 .section}
### [2.9.](#section-2.9){.section-number .selfRef} [Indirect Attacks on the Server](#name-indirect-attacks-on-the-ser){.section-name .selfRef} {#name-indirect-attacks-on-the-ser}

Various JWT claims are used by the recipient to perform lookup
operations, such as database and Lightweight Directory Access Protocol
(LDAP) searches. Others include URLs that are similarly looked up by the
server. Any of these claims can be used by an attacker as vectors for
injection attacks or server-side request forgery (SSRF)
attacks.[¶](#section-2.9-1){.pilcrow}

For mitigations, see [Section
3.10](#do-not-trust-claims){.xref}.[¶](#section-2.9-2){.pilcrow}
:::
:::
:::
:::

::: {#BP}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Best Practices](#name-best-practices){.section-name .selfRef} {#name-best-practices}

The best practices listed below should be applied by practitioners to
mitigate the threats listed in the preceding
section.[¶](#section-3-1){.pilcrow}

::: {#algorithm-verification}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Perform Algorithm Verification](#name-perform-algorithm-verificat){.section-name .selfRef} {#name-perform-algorithm-verificat}

Libraries [MUST]{.bcp14} enable the caller to specify a supported set of
algorithms and [MUST NOT]{.bcp14} use any other algorithms when
performing cryptographic operations. The library [MUST]{.bcp14} ensure
that the \"alg\" or \"enc\" header specifies the same algorithm that is
used for the cryptographic operation. Moreover, each key [MUST]{.bcp14}
be used with exactly one algorithm, and this [MUST]{.bcp14} be checked
when the cryptographic operation is
performed.[¶](#section-3.1-1){.pilcrow}
:::
:::

::: {#appropriate-algorithms}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Use Appropriate Algorithms](#name-use-appropriate-algorithms){.section-name .selfRef} {#name-use-appropriate-algorithms}

As [Section
5.2](https://www.rfc-editor.org/rfc/rfc7515#section-5.2){.relref} of
\[[RFC7515](#RFC7515){.xref}\] says, \"it is an application decision
which algorithms may be used in a given context. Even if a JWS can be
successfully validated, unless the algorithm(s) used in the JWS are
acceptable to the application, it [SHOULD]{.bcp14} consider the JWS to
be invalid.\"[¶](#section-3.2-1){.pilcrow}

Therefore, applications [MUST]{.bcp14} only allow the use of
cryptographically current algorithms that meet the security requirements
of the application. This set will vary over time as new algorithms are
introduced and existing algorithms are deprecated due to discovered
cryptographic weaknesses. Applications [MUST]{.bcp14} therefore be
designed to enable cryptographic agility.[¶](#section-3.2-2){.pilcrow}

That said, if a JWT is cryptographically protected end-to-end by a
transport layer, such as TLS using cryptographically current algorithms,
there may be no need to apply another layer of cryptographic protections
to the JWT. In such cases, the use of the \"none\" algorithm can be
perfectly acceptable. The \"none\" algorithm should only be used when
the JWT is cryptographically protected by other means. JWTs using
\"none\" are often used in application contexts in which the content is
optionally signed; then, the URL-safe claims representation and
processing can be the same in both the signed and unsigned cases. JWT
libraries [SHOULD NOT]{.bcp14} generate JWTs using \"none\" unless
explicitly requested to do so by the caller. Similarly, JWT libraries
[SHOULD NOT]{.bcp14} consume JWTs using \"none\" unless explicitly
requested by the caller.[¶](#section-3.2-3){.pilcrow}

Applications [SHOULD]{.bcp14} follow these algorithm-specific
recommendations:[¶](#section-3.2-4){.pilcrow}

-   [Avoid all RSA-PKCS1 v1.5 encryption algorithms
    (\[[RFC8017](#RFC8017){.xref}\], [Section
    7.2](https://www.rfc-editor.org/rfc/rfc8017#section-7.2){.relref}),
    preferring RSAES-OAEP (\[[RFC8017](#RFC8017){.xref}\], [Section
    7.1](https://www.rfc-editor.org/rfc/rfc8017#section-7.1){.relref}).[¶](#section-3.2-5.1){.pilcrow}]{#section-3.2-5.1}
-   [Elliptic Curve Digital Signature Algorithm (ECDSA) signatures
    \[[ANSI-X962-2005](#ANSI-X962-2005){.xref}\] require a unique random
    value for every message that is signed. If even just a few bits of
    the random value are predictable across multiple messages, then the
    security of the signature scheme may be compromised. In the worst
    case, the private key may be recoverable by an attacker. To counter
    these attacks, JWT libraries [SHOULD]{.bcp14} implement ECDSA using
    the deterministic approach defined in
    \[[RFC6979](#RFC6979){.xref}\]. This approach is completely
    compatible with existing ECDSA verifiers and so can be implemented
    without new algorithm identifiers being
    required.[¶](#section-3.2-5.2){.pilcrow}]{#section-3.2-5.2}
:::
:::

::: {#validate-crypto}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Validate All Cryptographic Operations](#name-validate-all-cryptographic-){.section-name .selfRef} {#name-validate-all-cryptographic-}

All cryptographic operations used in the JWT [MUST]{.bcp14} be validated
and the entire JWT [MUST]{.bcp14} be rejected if any of them fail to
validate. This is true not only of JWTs with a single set of Header
Parameters but also for Nested JWTs in which both outer and inner
operations [MUST]{.bcp14} be validated using the keys and algorithms
supplied by the application.[¶](#section-3.3-1){.pilcrow}
:::
:::

::: {#validate-inputs}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Validate Cryptographic Inputs](#name-validate-cryptographic-inpu){.section-name .selfRef} {#name-validate-cryptographic-inpu}

Some cryptographic operations, such as Elliptic Curve Diffie-Hellman key
agreement (\"ECDH-ES\"), take inputs that may contain invalid values.
This includes points not on the specified elliptic curve or other
invalid points (e.g., \[[Valenta](#Valenta){.xref}\], Section 7.1). The
JWS/JWE library itself must validate these inputs before using them, or
it must use underlying cryptographic libraries that do so (or
both!).[¶](#section-3.4-1){.pilcrow}

Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES) ephemeral
public key (epk) inputs should be validated according to the
recipient\'s chosen elliptic curve. For the NIST prime-order curves
P-256, P-384, and P-521, validation [MUST]{.bcp14} be performed
according to Section 5.6.2.3.4 (ECC Partial Public-Key Validation
Routine) of \"Recommendation for Pair-Wise Key-Establishment Schemes
Using Discrete Logarithm Cryptography\"
\[[nist-sp-800-56a-r3](#nist-sp-800-56a-r3){.xref}\]. If the \"X25519\"
or \"X448\" \[[RFC8037](#RFC8037){.xref}\] algorithms are used, then the
security considerations in \[[RFC8037](#RFC8037){.xref}\]
apply.[¶](#section-3.4-2){.pilcrow}
:::
:::

::: {#key-entropy}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Ensure Cryptographic Keys Have Sufficient Entropy](#name-ensure-cryptographic-keys-h){.section-name .selfRef} {#name-ensure-cryptographic-keys-h}

The Key Entropy and Random Values advice in [Section
10.1](https://www.rfc-editor.org/rfc/rfc7515#section-10.1){.relref} of
\[[RFC7515](#RFC7515){.xref}\] and the Password Considerations in
[Section
8.8](https://www.rfc-editor.org/rfc/rfc7518#section-8.8){.relref} of
\[[RFC7518](#RFC7518){.xref}\] [MUST]{.bcp14} be followed. In
particular, human-memorizable passwords [MUST NOT]{.bcp14} be directly
used as the key to a keyed-MAC algorithm such as \"HS256\". Moreover,
passwords should only be used to perform key encryption, rather than
content encryption, as described in [Section
4.8](https://www.rfc-editor.org/rfc/rfc7518#section-4.8){.relref} of
\[[RFC7518](#RFC7518){.xref}\]. Note that even when used for key
encryption, password-based encryption is still subject to brute-force
attacks.[¶](#section-3.5-1){.pilcrow}
:::
:::

::: {#no-compression}
::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [Avoid Compression of Encryption Inputs](#name-avoid-compression-of-encryp){.section-name .selfRef} {#name-avoid-compression-of-encryp}

Compression of data [SHOULD NOT]{.bcp14} be done before encryption,
because such compressed data often reveals information about the
plaintext.[¶](#section-3.6-1){.pilcrow}
:::
:::

::: {#use-utf8}
::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Use UTF-8](#name-use-utf-8){.section-name .selfRef} {#name-use-utf-8}

\[[RFC7515](#RFC7515){.xref}\], \[[RFC7516](#RFC7516){.xref}\], and
\[[RFC7519](#RFC7519){.xref}\] all specify that UTF-8 be used for
encoding and decoding JSON used in Header Parameters and JWT Claims
Sets. This is also in line with the latest JSON specification
\[[RFC8259](#RFC8259){.xref}\]. Implementations and applications
[MUST]{.bcp14} do this and not use or admit the use of other Unicode
encodings for these purposes.[¶](#section-3.7-1){.pilcrow}
:::
:::

::: {#validate-iss-sub}
::: {#section-3.8 .section}
### [3.8.](#section-3.8){.section-number .selfRef} [Validate Issuer and Subject](#name-validate-issuer-and-subject){.section-name .selfRef} {#name-validate-issuer-and-subject}

When a JWT contains an \"iss\" (issuer) claim, the application
[MUST]{.bcp14} validate that the cryptographic keys used for the
cryptographic operations in the JWT belong to the issuer. If they do
not, the application [MUST]{.bcp14} reject the
JWT.[¶](#section-3.8-1){.pilcrow}

The means of determining the keys owned by an issuer is
application-specific. As one example, OpenID Connect
\[[OpenID.Core](#OpenID.Core){.xref}\] issuer values are \"https\" URLs
that reference a JSON metadata document that contains a \"jwks_uri\"
value that is an \"https\" URL from which the issuer\'s keys are
retrieved as a JWK Set \[[RFC7517](#RFC7517){.xref}\]. This same
mechanism is used by \[[RFC8414](#RFC8414){.xref}\]. Other applications
may use different means of binding keys to
issuers.[¶](#section-3.8-2){.pilcrow}

Similarly, when the JWT contains a \"sub\" (subject) claim, the
application [MUST]{.bcp14} validate that the subject value corresponds
to a valid subject and/or issuer-subject pair at the application. This
may include confirming that the issuer is trusted by the application. If
the issuer, subject, or the pair are invalid, the application
[MUST]{.bcp14} reject the JWT.[¶](#section-3.8-3){.pilcrow}
:::
:::

::: {#use-aud}
::: {#section-3.9 .section}
### [3.9.](#section-3.9){.section-number .selfRef} [Use and Validate Audience](#name-use-and-validate-audience){.section-name .selfRef} {#name-use-and-validate-audience}

If the same issuer can issue JWTs that are intended for use by more than
one relying party or application, the JWT [MUST]{.bcp14} contain an
\"aud\" (audience) claim that can be used to determine whether the JWT
is being used by an intended party or was substituted by an attacker at
an unintended party.[¶](#section-3.9-1){.pilcrow}

In such cases, the relying party or application [MUST]{.bcp14} validate
the audience value, and if the audience value is not present or not
associated with the recipient, it [MUST]{.bcp14} reject the
JWT.[¶](#section-3.9-2){.pilcrow}
:::
:::

::: {#do-not-trust-claims}
::: {#section-3.10 .section}
### [3.10.](#section-3.10){.section-number .selfRef} [Do Not Trust Received Claims](#name-do-not-trust-received-claim){.section-name .selfRef} {#name-do-not-trust-received-claim}

The \"kid\" (key ID) header is used by the relying application to
perform key lookup. Applications should ensure that this does not create
SQL or LDAP injection vulnerabilities by validating and/or sanitizing
the received value.[¶](#section-3.10-1){.pilcrow}

Similarly, blindly following a \"jku\" (JWK set URL) or \"x5u\" (X.509
URL) header, which may contain an arbitrary URL, could result in
server-side request forgery (SSRF) attacks. Applications
[SHOULD]{.bcp14} protect against such attacks, e.g., by matching the URL
to a whitelist of allowed locations and ensuring no cookies are sent in
the GET request.[¶](#section-3.10-2){.pilcrow}
:::
:::

::: {#use-typ}
::: {#section-3.11 .section}
### [3.11.](#section-3.11){.section-number .selfRef} [Use Explicit Typing](#name-use-explicit-typing){.section-name .selfRef} {#name-use-explicit-typing}

Sometimes, one kind of JWT can be confused for another. If a particular
kind of JWT is subject to such confusion, that JWT can include an
explicit JWT type value, and the validation rules can specify checking
the type. This mechanism can prevent such confusion. Explicit JWT typing
is accomplished by using the \"typ\" Header Parameter. For instance, the
\[[RFC8417](#RFC8417){.xref}\] specification uses the
\"application/secevent+jwt\" media type to perform explicit typing of
Security Event Tokens (SETs).[¶](#section-3.11-1){.pilcrow}

Per the definition of \"typ\" in [Section
4.1.9](https://www.rfc-editor.org/rfc/rfc7515#section-4.1.9){.relref} of
\[[RFC7515](#RFC7515){.xref}\], it is [RECOMMENDED]{.bcp14} that the
\"application/\" prefix be omitted from the \"typ\" value. Therefore,
for example, the \"typ\" value used to explicitly include a type for a
SET [SHOULD]{.bcp14} be \"secevent+jwt\". When explicit typing is
employed for a JWT, it is [RECOMMENDED]{.bcp14} that a media type name
of the format \"application/example+jwt\" be used, where \"example\" is
replaced by the identifier for the specific kind of
JWT.[¶](#section-3.11-2){.pilcrow}

When applying explicit typing to a Nested JWT, the \"typ\" Header
Parameter containing the explicit type value [MUST]{.bcp14} be present
in the inner JWT of the Nested JWT (the JWT whose payload is the JWT
Claims Set). In some cases, the same \"typ\" Header Parameter value will
be present in the outer JWT as well, to explicitly type the entire
Nested JWT.[¶](#section-3.11-3){.pilcrow}

Note that the use of explicit typing may not achieve disambiguation from
existing kinds of JWTs, as the validation rules for existing kinds of
JWTs often do not use the \"typ\" Header Parameter value. Explicit
typing is [RECOMMENDED]{.bcp14} for new uses of
JWTs.[¶](#section-3.11-4){.pilcrow}
:::
:::

::: {#preventing-confusion}
::: {#section-3.12 .section}
### [3.12.](#section-3.12){.section-number .selfRef} [Use Mutually Exclusive Validation Rules for Different Kinds of JWTs](#name-use-mutually-exclusive-vali){.section-name .selfRef} {#name-use-mutually-exclusive-vali}

Each application of JWTs defines a profile specifying the required and
optional JWT claims and the validation rules associated with them. If
more than one kind of JWT can be issued by the same issuer, the
validation rules for those JWTs [MUST]{.bcp14} be written such that they
are mutually exclusive, rejecting JWTs of the wrong kind. To prevent
substitution of JWTs from one context into another, application
developers may employ a number of
strategies:[¶](#section-3.12-1){.pilcrow}

-   [Use explicit typing for different kinds of JWTs. Then the distinct
    \"typ\" values can be used to differentiate between the different
    kinds of JWTs.[¶](#section-3.12-2.1){.pilcrow}]{#section-3.12-2.1}
-   [Use different sets of required claims or different required claim
    values. Then the validation rules for one kind of JWT will reject
    those with different claims or
    values.[¶](#section-3.12-2.2){.pilcrow}]{#section-3.12-2.2}
-   [Use different sets of required Header Parameters or different
    required Header Parameter values. Then the validation rules for one
    kind of JWT will reject those with different Header Parameters or
    values.[¶](#section-3.12-2.3){.pilcrow}]{#section-3.12-2.3}
-   [Use different keys for different kinds of JWTs. Then the keys used
    to validate one kind of JWT will fail to validate other kinds of
    JWTs.[¶](#section-3.12-2.4){.pilcrow}]{#section-3.12-2.4}
-   [Use different \"aud\" values for different uses of JWTs from the
    same issuer. Then audience validation will reject JWTs substituted
    into inappropriate
    contexts.[¶](#section-3.12-2.5){.pilcrow}]{#section-3.12-2.5}
-   [Use different issuers for different kinds of JWTs. Then the
    distinct \"iss\" values can be used to segregate the different kinds
    of JWTs.[¶](#section-3.12-2.6){.pilcrow}]{#section-3.12-2.6}

Given the broad diversity of JWT usage and applications, the best
combination of types, required claims, values, Header Parameters, key
usages, and issuers to differentiate among different kinds of JWTs will,
in general, be application-specific. As discussed in [Section
3.11](#use-typ){.xref}, for new JWT applications, the use of explicit
typing is [RECOMMENDED]{.bcp14}.[¶](#section-3.12-3){.pilcrow}
:::
:::
:::
:::

::: {#security-considerations}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This entire document is about security considerations when implementing
and deploying JSON Web Tokens.[¶](#section-4-1){.pilcrow}
:::
:::

::: {#iana-considerations}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-5-1){.pilcrow}
:::
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[nist-sp-800-56a-r3\]
:   [Barker, E.]{.refAuthor}[, Chen, L.]{.refAuthor}[,
    Roginsky, A.]{.refAuthor}[, Vassilev, A.]{.refAuthor}[, and R.
    Davis]{.refAuthor}, [\"Recommendation for Pair-Wise
    Key-Establishment Schemes Using Discrete Logarithm
    Cryptography\"]{.refTitle}, [NIST Special Publication 800-56A
    Revision 3]{.seriesInfo}, [DOI
    10.6028/NIST.SP.800-56Ar3]{.seriesInfo}, April 2018,
    \<<https://doi.org/10.6028/NIST.SP.800-56Ar3>\>.

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.

\[RFC6979\]
:   [Pornin, T.]{.refAuthor}, [\"Deterministic Usage of the Digital
    Signature Algorithm (DSA) and Elliptic Curve Digital Signature
    Algorithm (ECDSA)\"]{.refTitle}, [RFC 6979]{.seriesInfo}, [DOI
    10.17487/RFC6979]{.seriesInfo}, August 2013,
    \<<https://www.rfc-editor.org/info/rfc6979>\>.

\[RFC7515\]
:   [Jones, M.]{.refAuthor}[, Bradley, J.]{.refAuthor}[, and N.
    Sakimura]{.refAuthor}, [\"JSON Web Signature (JWS)\"]{.refTitle},
    [RFC 7515]{.seriesInfo}, [DOI 10.17487/RFC7515]{.seriesInfo}, May
    2015, \<<https://www.rfc-editor.org/info/rfc7515>\>.

\[RFC7516\]
:   [Jones, M.]{.refAuthor}[ and J. Hildebrand]{.refAuthor}, [\"JSON Web
    Encryption (JWE)\"]{.refTitle}, [RFC 7516]{.seriesInfo}, [DOI
    10.17487/RFC7516]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7516>\>.

\[RFC7518\]
:   [Jones, M.]{.refAuthor}, [\"JSON Web Algorithms (JWA)\"]{.refTitle},
    [RFC 7518]{.seriesInfo}, [DOI 10.17487/RFC7518]{.seriesInfo}, May
    2015, \<<https://www.rfc-editor.org/info/rfc7518>\>.

\[RFC7519\]
:   [Jones, M.]{.refAuthor}[, Bradley, J.]{.refAuthor}[, and N.
    Sakimura]{.refAuthor}, [\"JSON Web Token (JWT)\"]{.refTitle}, [RFC
    7519]{.seriesInfo}, [DOI 10.17487/RFC7519]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7519>\>.

\[RFC8017\]
:   [Moriarty, K., Ed.]{.refAuthor}[, Kaliski, B.]{.refAuthor}[,
    Jonsson, J.]{.refAuthor}[, and A. Rusch]{.refAuthor}, [\"PKCS #1:
    RSA Cryptography Specifications Version 2.2\"]{.refTitle}, [RFC
    8017]{.seriesInfo}, [DOI 10.17487/RFC8017]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8017>\>.

\[RFC8037\]
:   [Liusvaara, I.]{.refAuthor}, [\"CFRG Elliptic Curve Diffie-Hellman
    (ECDH) and Signatures in JSON Object Signing and Encryption
    (JOSE)\"]{.refTitle}, [RFC 8037]{.seriesInfo}, [DOI
    10.17487/RFC8037]{.seriesInfo}, January 2017,
    \<<https://www.rfc-editor.org/info/rfc8037>\>.

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.

\[RFC8259\]
:   [Bray, T., Ed.]{.refAuthor}, [\"The JavaScript Object Notation
    (JSON) Data Interchange Format\"]{.refTitle}, [STD 90]{.seriesInfo},
    [RFC 8259]{.seriesInfo}, [DOI 10.17487/RFC8259]{.seriesInfo},
    December 2017, \<<https://www.rfc-editor.org/info/rfc8259>\>.
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[Alawatugoda\]
:   [Alawatugoda, J.]{.refAuthor}[, Stebila, D.]{.refAuthor}[, and C.
    Boyd]{.refAuthor}, [\"Protecting Encrypted Cookies from Compression
    Side-Channel Attacks\"]{.refTitle}, [Financial Cryptography and Data
    Security, pp. 86-106]{.refContent}, [DOI
    10.1007/978-3-662-47854-7_6]{.seriesInfo}, July 2015,
    \<<https://doi.org/10.1007/978-3-662-47854-7_6>\>.

\[ANSI-X962-2005\]
:   [American National Standards Institute]{.refAuthor}, [\"Public Key
    Cryptography for the Financial Services Industry: the Elliptic Curve
    Digital Signature Algorithm (ECDSA)\"]{.refTitle}, [ANSI
    X9.62-2005]{.seriesInfo}, November 2005.

\[CVE-2015-9235\]
:   [NIST]{.refAuthor}, [\"CVE-2015-9235 Detail\"]{.refTitle}, [National
    Vulnerability Database]{.refContent}, May 2018,
    \<<https://nvd.nist.gov/vuln/detail/CVE-2015-9235>\>.

\[Kelsey\]
:   [Kelsey, J.]{.refAuthor}, [\"Compression and Information Leakage of
    Plaintext\"]{.refTitle}, [Fast Software Encryption, pp.
    263-276]{.refContent}, [DOI 10.1007/3-540-45661-9_21]{.seriesInfo},
    July 2002, \<<https://doi.org/10.1007/3-540-45661-9_21>\>.

\[Langkemper\]
:   [Langkemper, S.]{.refAuthor}, [\"Attacking JWT
    authentication\"]{.refTitle}, September 2016,
    \<<https://www.sjoerdlangkemper.nl/2016/09/28/attacking-jwt-authentication/>\>.

\[McLean\]
:   [McLean, T.]{.refAuthor}, [\"Critical vulnerabilities in JSON Web
    Token libraries\"]{.refTitle}, March 2015,
    \<<https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/>\>.

\[OpenID.Core\]
:   [Sakimura, N.]{.refAuthor}[, Bradley, J.]{.refAuthor}[,
    Jones, M.]{.refAuthor}[, de Medeiros, B.]{.refAuthor}[, and C.
    Mortimore]{.refAuthor}, [\"OpenID Connect Core 1.0 incorporating
    errata set 1\"]{.refTitle}, November 2014,
    \<<https://openid.net/specs/openid-connect-core-1_0.html>\>.

\[RFC6749\]
:   [Hardt, D., Ed.]{.refAuthor}, [\"The OAuth 2.0 Authorization
    Framework\"]{.refTitle}, [RFC 6749]{.seriesInfo}, [DOI
    10.17487/RFC6749]{.seriesInfo}, October 2012,
    \<<https://www.rfc-editor.org/info/rfc6749>\>.

\[RFC7159\]
:   [Bray, T., Ed.]{.refAuthor}, [\"The JavaScript Object Notation
    (JSON) Data Interchange Format\"]{.refTitle}, [RFC
    7159]{.seriesInfo}, [DOI 10.17487/RFC7159]{.seriesInfo}, March 2014,
    \<<https://www.rfc-editor.org/info/rfc7159>\>.

\[RFC7517\]
:   [Jones, M.]{.refAuthor}, [\"JSON Web Key (JWK)\"]{.refTitle}, [RFC
    7517]{.seriesInfo}, [DOI 10.17487/RFC7517]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7517>\>.

\[RFC8414\]
:   [Jones, M.]{.refAuthor}[, Sakimura, N.]{.refAuthor}[, and J.
    Bradley]{.refAuthor}, [\"OAuth 2.0 Authorization Server
    Metadata\"]{.refTitle}, [RFC 8414]{.seriesInfo}, [DOI
    10.17487/RFC8414]{.seriesInfo}, June 2018,
    \<<https://www.rfc-editor.org/info/rfc8414>\>.

\[RFC8417\]
:   [Hunt, P., Ed.]{.refAuthor}[, Jones, M.]{.refAuthor}[,
    Denniss, W.]{.refAuthor}[, and M. Ansari]{.refAuthor}, [\"Security
    Event Token (SET)\"]{.refTitle}, [RFC 8417]{.seriesInfo}, [DOI
    10.17487/RFC8417]{.seriesInfo}, July 2018,
    \<<https://www.rfc-editor.org/info/rfc8417>\>.

\[Sanso\]
:   [Sanso, A.]{.refAuthor}, [\"Critical Vulnerability Uncovered in JSON
    Encryption\"]{.refTitle}, March 2017,
    \<<https://blogs.adobe.com/security/2017/03/critical-vulnerability-uncovered-in-json-encryption.html>\>.

\[Valenta\]
:   [Valenta, L.]{.refAuthor}[, Sullivan, N.]{.refAuthor}[,
    Sanso, A.]{.refAuthor}[, and N. Heninger]{.refAuthor}, [\"In search
    of CurveSwap: Measuring elliptic curve implementations in the
    wild\"]{.refTitle}, March 2018, \<<https://ia.cr/2018/298>\>.
:::
:::

::: {#acknowledgements}
::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to [Antonio Sanso]{.contact-name} for bringing the \"ECDH-ES\"
invalid point attack to the attention of JWE and JWT implementers. [Tim
McLean]{.contact-name} published the RSA/HMAC confusion attack
\[[McLean](#McLean){.xref}\]. Thanks to [Nat Sakimura]{.contact-name}
for advocating the use of explicit typing. Thanks to [Neil
Madden]{.contact-name} for his numerous comments, and to [Carsten
Bormann]{.contact-name}, [Brian Campbell]{.contact-name}, [Brian
Carpenter]{.contact-name}, [Alissa Cooper]{.contact-name}, [Roman
Danyliw]{.contact-name}, [Ben Kaduk]{.contact-name}, [Mirja
Kühlewind]{.contact-name}, [Barry Leiba]{.contact-name}, [Eric
Rescorla]{.contact-name}, [Adam Roach]{.contact-name}, [Martin
Vigoureux]{.contact-name}, and [Éric Vyncke]{.contact-name} for their
reviews.[¶](#section-appendix.a-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Yaron Sheffer]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Intuit]{.org}
:::

::: email
Email: <yaronf.ietf@gmail.com>
:::

::: {.left dir="auto"}
[Dick Hardt]{.fn .nameRole}
:::

::: email
Email: <dick.hardt@gmail.com>
:::

::: {.left dir="auto"}
[Michael B. Jones]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Microsoft]{.org}
:::

::: email
Email: <mbj@microsoft.com>
:::

::: url
URI: <https://self-issued.info/>
:::
:::
:::
