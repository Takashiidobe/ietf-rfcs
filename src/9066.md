  RFC 9066          DOTS Signal Call Home   December 2021
  ----------------- ----------------------- ---------------
  Reddy.K, et al.   Standards Track         \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9066](https://www.rfc-editor.org/rfc/rfc9066){.eref}

Category:
:   Standards Track

Published:
:   December 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    T. Reddy.K
    :::

    ::: org
    Akamai
    :::
    :::

    ::: author
    ::: author-name
    M. Boucadair, [Ed.]{.editor}
    :::

    ::: org
    Orange
    :::
    :::

    ::: author
    ::: author-name
    J. Shallow
    :::
    :::
:::

# RFC 9066 {#rfcnum}

# Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel Call Home {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies the Denial-of-Service Open Threat Signaling
(DOTS) signal channel Call Home, which enables a Call Home DOTS server
to initiate a secure connection to a Call Home DOTS client and to
receive attack traffic information from the Call Home DOTS client. The
Call Home DOTS server in turn uses the attack traffic information to
identify compromised devices launching outgoing DDoS attacks and take
appropriate mitigation action(s).[¶](#section-abstract-1){.pilcrow}

The DOTS signal channel Call Home is not specific to home networks; the
solution targets any deployment in which it is required to block DDoS
attack traffic closer to the source(s) of a DDoS
attack.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9066>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Applicability
    Scope](#name-applicability-scope){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Coexistence of a Base DOTS Signal Channel
    and DOTS Call Home](#name-coexistence-of-a-base-dots-){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [DOTS Signal Channel Call
    Home](#name-dots-signal-channel-call-hom){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Procedure](#name-procedure){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [DOTS Signal Channel
        Variations](#name-dots-signal-channel-variati){.xref}

        -   ::: {#section-toc.1-1.5.2.2.2.1}
            [5.2.1](#section-5.2.1){.xref}.  [Heartbeat
            Mechanism](#name-heartbeat-mechanism){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.2}
            [5.2.2](#section-5.2.2){.xref}.  [Redirected
            Signaling](#name-redirected-signaling){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [DOTS Signal Channel
        Extension](#name-dots-signal-channel-extensi){.xref}

        -   ::: {#section-toc.1-1.5.2.3.2.1}
            [5.3.1](#section-5.3.1){.xref}.  [Mitigation
            Request](#name-mitigation-request){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.2}
            [5.3.2](#section-5.3.2){.xref}.  [Address Sharing
            Considerations](#name-address-sharing-considerati){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [DOTS Signal Call Home YANG
    Module](#name-dots-signal-call-home-yang-){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Tree
        Structure](#name-tree-structure){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [YANG/JSON Mapping Parameters to
        CBOR](#name-yang-json-mapping-parameter){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [YANG
        Module](#name-yang-module){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [DOTS Signal Channel CBOR Mappings
        Registry](#name-dots-signal-channel-cbor-ma){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [New DOTS Conflict
        Cause](#name-new-dots-conflict-cause){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [DOTS Signal Call Home YANG
        Module](#name-dots-signal-call-home-yang-m){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Privacy
    Considerations](#name-privacy-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix A](#appendix-A){.xref}.  [Some Home Network
    Issues](#name-some-home-network-issues){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix B](#appendix-B){.xref}.  [Disambiguating Base DOTS Signal
    vs. DOTS Call Home](#name-disambiguating-base-dots-si){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [](#appendix-C){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.14}
    [](#appendix-D){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [](#appendix-E){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Distributed Denial-of-Service Open Threat Signaling (DOTS) signal
channel protocol \[[RFC9132](#RFC9132){.xref}\] is used to carry
information about a network resource or a network (or a part thereof)
that is under a Distributed Denial-of-Service (DDoS) attack
\[[RFC4732](#RFC4732){.xref}\]. Such information is sent by a DOTS
client to one or multiple DOTS servers so that appropriate mitigation
actions are undertaken on traffic deemed suspicious. Various use cases
are discussed in
\[[RFC8903](#RFC8903){.xref}\].[¶](#section-1-1){.pilcrow}

However, \[[RFC9132](#RFC9132){.xref}\] only covers how to mitigate when
being attacked (i.e., protecting a network from inbound DDoS attacks).
It does not cover how to control the attacks close to their source(s)
that are misusing network resources (i.e., outbound DDoS attacks). In
particular, the DOTS signal protocol does not discuss cooperative DDoS
mitigation between the network hosting an attack source and the Internet
Service Provider (ISP) to suppress the outbound DDoS attack traffic
originating from that network. As a reminder, the base basic DOTS
architecture is depicted in [Figure 1](#basea){.xref} ([Section
2](https://www.rfc-editor.org/rfc/rfc8811#section-2){.relref} of
\[[RFC8811](#RFC8811){.xref}\]).[¶](#section-1-2){.pilcrow}

[]{#name-basic-dots-architecture}

::: {#basea}
::: {#section-1-3.1 .alignCenter .art-text .artwork}
    +-----------+            +-------------+
    | Mitigator | ~~~~~~~~~~ | DOTS Server |
    +-----------+            +-------------+
                                    |
                                    |
                                    |
    +---------------+        +-------------+
    | Attack Target | ~~~~~~ | DOTS Client |
    +---------------+        +-------------+
:::

[Figure 1](#figure-1){.selfRef}: [Basic DOTS
Architecture](#name-basic-dots-architecture){.selfRef}
:::

[Appendix A](#home){.xref} details why the rise of Internet of Things
(IoT) compounds the possibility of these being used as malicious actors
that need to be controlled. Similar issues can be encountered in
enterprise networks, data centers, etc. The ISP offering a DDoS
mitigation service can detect outgoing DDoS attack traffic originating
from its subscribers, or the ISP may receive filtering rules (e.g.,
using BGP Flowspec \[[RFC8955](#RFC8955){.xref}\]
\[[RFC8956](#RFC8956){.xref}\]) from a transit provider to filter,
block, or rate-limit DDoS attack traffic originating from the ISP\'s
subscribers to a downstream target. Nevertheless, the DOTS signal
channel does not provide means for the ISP to request blocking such
attacks close to the sources without altering legitimate traffic. This
document fills that void by specifying an extension to the DOTS signal
channel: DOTS signal channel Call Home.[¶](#section-1-4){.pilcrow}

Note: Another design approach would be to extend the DOTS signal channel
with a new attribute to explicitly indicate whether a mitigation request
concerns an outbound DDoS attack. In such an approach, it is assumed
that a DOTS server is deployed within the domain that is hosting the
attack source(s), while a DOTS client is enabled within an upstream
network (e.g., access network). However, initiating a DOTS signal
channel from an upstream network to a source network is complicated
because of the presence of translators and firewalls. Moreover, the use
of the same signal channel to handle both inbound and outbound attacks
complicates both the heartbeat and redirection mechanisms that are
executed as a function of the attack direction (see Sections
[5.2.1](#hb){.xref} and [5.2.2](#redirect){.xref}). Also, the DOTS
server will be subject to fingerprinting (e.g., using scanning tools)
and DoS attacks (e.g., by having the DOTS server perform computationally
expensive operations). Various management and deployment considerations
that motivate the Call Home functionality are listed in [Section
1.1](https://www.rfc-editor.org/rfc/rfc8071#section-1.1){.relref} of
\[[RFC8071](#RFC8071){.xref}\].[¶](#section-1-5){.pilcrow}

\"DOTS signal channel Call Home\" (or \"DOTS Call Home\" for short)
refers to a DOTS signal channel established at the initiative of a DOTS
server thanks to a role reversal at the (D)TLS layer ([Section
5.1](#proc){.xref}). That is, the DOTS server initiates a secure
connection to a DOTS client and uses that connection to receive the
attack traffic information (e.g., attack sources) from the DOTS
client.[¶](#section-1-6){.pilcrow}

A high-level DOTS Call Home functional architecture is shown in [Figure
2](#fa){.xref}. Attack source(s) are within the DOTS server
domain.[¶](#section-1-7){.pilcrow}

[]{#name-basic-dots-signal-channel-c}

::: {#fa}
::: {#section-1-8.1 .alignCenter .art-text .artwork}
                                   Scope
                         +.-.-.-.-.-.-.-.-.-.-.-.+
    +---------------+    :    +-------------+    :
    |    Alert      | ~~~:~~~ |  Call Home  |    :
    |               |    :    | DOTS client |    :
    +---------------+    :    +------+------+    :
                         :           |           :
                         :           |           :
                         :           |           :
    +---------------+    :    +------+------+    :
    |    Attack     | ~~~:~~~ |  Call Home  |    :
    |   Source(s)   |    :    | DOTS server |    :
    +---------------+    :    +-------------+    :
                         +.-.-.-.-.-.-.-.-.-.-.-.+
:::

[Figure 2](#figure-2){.selfRef}: [Basic DOTS Signal Channel Call Home
Functional Architecture](#name-basic-dots-signal-channel-c){.selfRef}
:::

DOTS agents involved in the DOTS Call Home otherwise adhere to the DOTS
roles as defined in \[[RFC8612](#RFC8612){.xref}\]. For clarity, this
document uses \"Call Home DOTS client\" (or \"Call Home DOTS server\")
to refer to a DOTS client (or DOTS server) deployed in a Call Home
scenario ([Figure 2](#fa){.xref}). Call Home DOTS agents may (or may
not) be co-located with DOTS agents that are compliant with
\[[RFC9132](#RFC9132){.xref}\] (see [Section 4](#coex){.xref} for more
details).[¶](#section-1-9){.pilcrow}

A Call Home DOTS client relies upon a variety of triggers to make use of
the Call Home function (e.g., scrubbing the traffic from the attack
source or receiving an alert from an attack target, a peer DDoS
Mitigation System (DMS), or a transit provider). The definition of these
triggers is deployment specific. It is therefore out of the scope of
this document to elaborate on how these triggers are made available to a
Call Home DOTS client.[¶](#section-1-10){.pilcrow}

In a typical deployment scenario, the Call Home DOTS server is enabled
on a Customer Premises Equipment (CPE), which is aligned with recent
trends to enrich the CPE with advanced security features. For example,
the DOTS Call Home service can be part of services supported by an
ISP-managed CPE or a managed security service subscribed to by the user.
Unlike classic DOTS deployments \[[RFC8903](#RFC8903){.xref}\], a Call
Home DOTS server maintains a single DOTS signal channel session for each
DOTS-capable upstream provisioning domain
\[[DOTS-MULTIHOMING](#I-D.ietf-dots-multihoming){.xref}\].[¶](#section-1-11){.pilcrow}

For instance, the Call Home DOTS server in the home network initiates
the signal channel Call Home in \"idle\" time; subsequently, the Call
Home DOTS client in the ISP environment can initiate a mitigation
request whenever the ISP detects there is an attack from a compromised
device in the DOTS server domain (i.e., from within the home
network).[¶](#section-1-12){.pilcrow}

The Call Home DOTS server uses the DDoS attack traffic information to
identify the compromised device in its domain that is responsible for
launching the DDoS attack, optionally notifies a network administrator,
and takes appropriate mitigation action(s). For example, a mitigation
action can be to quarantine the compromised device or block its traffic
to the attack target(s) until the mitigation request is
withdrawn.[¶](#section-1-13){.pilcrow}

This document assumes that Call Home DOTS servers are provisioned with a
way to know how to reach the upstream Call Home DOTS client(s), which
could occur by a variety of means (e.g.,
\[[RFC8973](#RFC8973){.xref}\]). The specification of such means are out
of scope of this document.[¶](#section-1-14){.pilcrow}

More information about the applicability scope of the DOTS signal
channel Call Home is provided in [Section
3](#as){.xref}.[¶](#section-1-15){.pilcrow}
:::
:::

::: {#notation}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

The reader should be familiar with the terms defined in [Section
1.2](https://www.rfc-editor.org/rfc/rfc8612#section-1.2){.relref} of
\[[RFC8612](#RFC8612){.xref}\].[¶](#section-2-2){.pilcrow}

\"DDoS Mitigation System (DMS)\" refers to a system that performs DDoS
mitigation.[¶](#section-2-3){.pilcrow}

\"Base DOTS signal channel\" refers to
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-2-4){.pilcrow}

The meaning of the symbols in YANG tree diagrams are defined in
\[[RFC8340](#RFC8340){.xref}\] and
\[[RFC8791](#RFC8791){.xref}\].[¶](#section-2-5){.pilcrow}

(D)TLS is used for statements that apply to both Transport Layer
Security (TLS) \[[RFC8446](#RFC8446){.xref}\] and Datagram Transport
Layer Security (DTLS) \[[RFC6347](#RFC6347){.xref}\]
\[[DTLS13](#I-D.ietf-tls-dtls13){.xref}\]. Specific terms are used for
any statement that applies to either protocol
alone.[¶](#section-2-6){.pilcrow}
:::
:::

::: {#as}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Applicability Scope](#name-applicability-scope){.section-name .selfRef} {#name-applicability-scope}

The problems discussed in [Section 1](#introduction){.xref} may be
encountered in many deployments (e.g., home networks, enterprise
networks, transit networks, data centers). The solution specified in
this document can be used for those deployments to block DDoS attack
traffic closer to the source(s) of the attack. That is, attacks that are
issued, e.g., from within an enterprise network or a data center will
thus be blocked before exiting these
networks.[¶](#section-3-1){.pilcrow}

An instantiation of the Call Home functional architecture is depicted in
[Figure 3](#pb){.xref}.[¶](#section-3-2){.pilcrow}

[]{#name-dots-signal-channel-call-ho}

::: {#pb}
::: {#section-3-3.1 .alignCenter .art-text .artwork}
                    +-------------+
                    |Attack Target|
                    +-----+-------+
                          | /\      Target Network
    ......................|.||....................
                 .--------+-||-------.
                (           ||        )-.
              .'            ||           '
              (  Internet   ||            )
               (            ||          -'
                '-(         ||          )
                   '------+-||---------'
    ......................|.||.....................
                 .--------+-||-------.      Network
                (           ||        )-.  Provider
              .' Call Home  ||           '   (DMS)
              ( DOTS client ||            )
               (            ||          -'
                '-(         ||          )
                   '------+-||---------'
    ......................|.||.......................
                 .--------+-||-------. Source Network
                (           ||        )-.
              .' Call Home  ||           '
              ( DOTS server || Outbound   )
               (            ||   DDoS   -'
                '-(         ||  Attack  )
                   '------+-||---------'
                          | ||
                    +-----+-++----+
                    |Attack Source|
                    +-------------+
:::

[Figure 3](#figure-3){.selfRef}: [DOTS Signal Channel Call Home
Reference Architecture](#name-dots-signal-channel-call-ho){.selfRef}
:::

It is out of the scope of this document to identify an exhaustive list
of such deployments.[¶](#section-3-4){.pilcrow}

Call Home DOTS agent relationships are similar to those discussed in
[Section
2.3](https://www.rfc-editor.org/rfc/rfc8811#section-2.3){.relref} of
\[[RFC8811](#RFC8811){.xref}\]. For example, multiple Call Home DOTS
servers of the same domain can be associated with the same Call Home
DOTS client. A Call Home DOTS client may decide to contact these Call
Home DOTS servers sequentially, fork a mitigation request to all of
them, or select one Call Home DOTS server to place a mitigation request.
Such a decision is implementation specific.[¶](#section-3-5){.pilcrow}

For some mitigations, feedback may be required from an administrator to
confirm a filtering action. The means to seek an administrator\'s
consent are deployment specific. Indeed, a variety of implementation
options can be considered for any given Call Home DOTS deployment, such
as push notifications using a dedicated application, Syslog, etc. It is
out of the scope of this document to make recommendations about how such
interactions are implemented (see [Figure
2](#fa){.xref}).[¶](#section-3-6){.pilcrow}

The Call Home DOTS server can be enabled on a border router or a
dedicated appliance. For the particular case of home networks, the Call
Home DOTS server functionality can be enabled on a managed CPE or
bundled with a CPE management application that is provided by an ISP to
its subscribers. These managed services are likely to be designed to
hide the complexity of managing (including configuring) the CPE. For
example, managed CPEs support the means to notify the user when a new
device is detected in order to seek confirmation as to whether or not
access should be granted to the device. These means can be upgraded to
interface with the Call Home DOTS server. Customized settings can be
configured by users to control the notifications (e.g., triggers, type)
and default actions.[¶](#section-3-7){.pilcrow}
:::
:::

::: {#coex}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Coexistence of a Base DOTS Signal Channel and DOTS Call Home](#name-coexistence-of-a-base-dots-){.section-name .selfRef} {#name-coexistence-of-a-base-dots-}

The DOTS signal channel Call Home does not require or preclude the
activation of the base DOTS signal channel
\[[RFC9132](#RFC9132){.xref}\]. Some sample deployment schemes are
discussed in this section for illustration
purposes.[¶](#section-4-1){.pilcrow}

The network that hosts an attack source may also be subject to inbound
DDoS attacks. In that case, both the base DOTS signal channel and DOTS
signal channel Call Home may be enabled as shown in [Figure
4](#merged){.xref} (same DMS provider) or [Figure 5](#merged1){.xref}
(distinct DMS providers).[¶](#section-4-2){.pilcrow}

[]{#name-activation-of-a-base-dots-s}

::: {#merged}
::: {#section-4-3.1 .alignCenter .art-text .artwork}
        DOTS Signal Channel      Base DOTS
            Call Home          Signal Channel
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
       :          +------+ :: +------+          :
       :          | DOTS | :: | DOTS |          :
       :          |client| :: |server|          :
       :          +--+---+ :: +---+--+          :
       :     /\      |     ::     |             : Network
       :     ||      |     ::     |             :Provider
       :     ||      |     ::     |             :  (DMS)
    ...:.....||......|.....::.....|.............:........
    Outbound ||      |     ::     |       || Inbound
      DDoS   ||      |     ::     |       ||   DDoS
     Attack  ||      |     ::     |       \/  Attack
       :          +--+---+ :: +---+--+          :
       :          | DOTS | :: | DOTS |          :
       :          |server| :: |client|          :
       :          +------+ :: +------+          :
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
                       Network #A
:::

[Figure 4](#figure-4){.selfRef}: [Activation of a Base DOTS Signal
Channel and Call Home (Same DMS
Provider)](#name-activation-of-a-base-dots-s){.selfRef}
:::

Note that a DMS provider may not be on the default forwarding path of
inbound DDoS attack traffic targeting a network (e.g., Network #B in
[Figure 5](#merged1){.xref}). Nevertheless, the DOTS signal channel Call
Home requires the DMS provider to be on the default forwarding path of
the outbound traffic from a given network.[¶](#section-4-4){.pilcrow}

[]{#name-activation-of-a-base-dots-si}

::: {#merged1}
::: {#section-4-5.1 .alignCenter .art-text .artwork}
        DOTS Signal Channel      Base DOTS
            Call Home          Signal Channel
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
       : Network  +------+ :: +------+   Third  :
       : Provider | DOTS | :: | DOTS |   Party  :
       :  (DMS)   |client| :: |server|    DMS   :
       :          +--+---+ :: +---+--+ Provider :
       :     /\      |     ::     |             :
       :     ||      |     ::     |             :
       :     ||      |     ::     |             :
    ...:.....||......|.....::.....|.............:........
    Outbound ||      |     ::     |       || Inbound
      DDoS   ||      |     ::     |       ||   DDoS
     Attack  ||      |     ::     |       \/  Attack
       :          +--+---+ :: +---+--+          :
       :          | DOTS | :: | DOTS |          :
       :          |server| :: |client|          :
       :          +------+ :: +------+          :
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
                       Network #B
:::

[Figure 5](#figure-5){.selfRef}: [Activation of a Base DOTS Signal
Channel and Call Home (Distinct DMS
Providers)](#name-activation-of-a-base-dots-si){.selfRef}
:::

Figures [6](#snode){.xref} and [7](#snode2){.xref} depict examples where
the same node embeds both base DOTS and Call Home DOTS agents. For
example, a DOTS server and a Call Home DOTS client may be enabled on the
same device within the infrastructure of a DMS provider (e.g., Node #i
in [Figure 6](#snode){.xref}), or a DOTS client and a Call Home DOTS
server may be enabled on the same device within a source network (e.g.,
Node #j with Network #D shown in [Figure
7](#snode2){.xref}).[¶](#section-4-6){.pilcrow}

Whether the same or distinct nodes are used to host base DOTS and Call
Home DOTS agents is specific to each domain.[¶](#section-4-7){.pilcrow}

[]{#name-the-same-node-embedding-a-c}

::: {#snode}
::: {#section-4-8.1 .alignCenter .art-text .artwork}
        DOTS Signal Channel      Base DOTS
            Call Home          Signal Channel
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
       :        +----------------------+        :
       :        |       Node #i        |        :
       :        | +------+    +------+ |        :
       :        | | DOTS |    | DOTS | |        :
       :        | |client|    |server| |        :
       :        | +--+---+    +---+--+ |        :
       :        +----|-----::-----|----+        : Network
       :     /\      |     ::     |             :Provider
       :     ||      |     ::     |             :  (DMS)
    ...:.....||......|.....::.....|.............:........
    Outbound ||      |     ::     |       || Inbound
      DDoS   ||      |     ::     |       ||   DDoS
     Attack  ||      |     ::     |       \/  Attack
       :          +--+---+ :: +---+--+          :
       :          | DOTS | :: | DOTS |          :
       :          |server| :: |client|          :
       :          +------+ :: +------+          :
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
                       Network #C
:::

[Figure 6](#figure-6){.selfRef}: [The Same Node Embedding a Call Home
DOTS Client and a DOTS Server at the Network Provider\'s
Side](#name-the-same-node-embedding-a-c){.selfRef}
:::

[]{#name-the-same-node-embedding-bot}

::: {#snode2}
::: {#section-4-9.1 .alignCenter .art-text .artwork}
        DOTS Signal Channel      Base DOTS
            Call Home          Signal Channel
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
       :        +----------------------+        :
       :        |       Node #k        |        :
       :        | +------+    +------+ |        :
       :        | | DOTS |    | DOTS | |        :
       :        | |client|    |server| |        :
       :        | +--+---+    +---+--+ |        :
       :        +----|-----::-----|----+        : Network
       :     /\      |     ::     |             :Provider
       :     ||      |     ::     |             :  (DMS)
    ...:.....||......|.....::.....|.............:........
    Outbound ||      |     ::     |       || Inbound
      DDoS   ||      |     ::     |       ||   DDoS
     Attack  ||      |     ::     |       \/  Attack
       :        +----|-----::-----|----+        :
       :        | +--+---+    +---+--+ |        :
       :        | | DOTS |    | DOTS | |        :
       :        | |server|    |client| |        :
       :        | +------+    +------+ |        :
       :        |       Node #j        |        :
       :        +----------------------+        :
       +-.-.-.-.-.-.-.-.-.-++-.-.-.-.-.-.-.-.-.-+
                       Network #D
:::

[Figure 7](#figure-7){.selfRef}: [The Same Node Embedding both a DOTS
Client and a Call Home DOTS
Server](#name-the-same-node-embedding-bot){.selfRef}
:::

[Appendix B](#app){.xref} elaborates on the considerations to
unambiguously distinguish DOTS messages that belong to each of these
channels.[¶](#section-4-10){.pilcrow}
:::
:::

::: {#spec}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [DOTS Signal Channel Call Home](#name-dots-signal-channel-call-hom){.section-name .selfRef} {#name-dots-signal-channel-call-hom}

::: {#proc}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Procedure](#name-procedure){.section-name .selfRef} {#name-procedure}

The DOTS signal channel Call Home preserves all but one of the DOTS
client/server roles in the DOTS protocol stack, as compared to the
client-initiated DOTS signal channel protocol
\[[RFC9132](#RFC9132){.xref}\]. The role reversal that occurs is at the
(D)TLS layer; that is, (1) the Call Home DOTS server acts as a DTLS
client, and the Call Home DOTS client acts as a DTLS server; or (2) the
Call Home DOTS server acts as a TLS client initiating the underlying TCP
connection, and the Call Home DOTS client acts as a TLS server. The Call
Home DOTS server initiates a (D)TLS handshake to the Call Home DOTS
client.[¶](#section-5.1-1){.pilcrow}

For example, a home network element (e.g., home router) co-located with
a Call Home DOTS server is the (D)TLS client. That is, the Call Home
DOTS server assumes the role of the (D)TLS client, but the network
element\'s role as a DOTS server remains the
same.[¶](#section-5.1-2){.pilcrow}

Existing certificate chains and mutual authentication mechanisms between
the DOTS agents are unaffected by the Call Home function. From a
deployment standpoint, and given the scale of Call Home DOTS servers
that may be involved, enabling means for automating the provisioning of
credentials on Call Home DOTS servers to authenticate to the Call Home
DOTS client is encouraged. It is out of the scope of this document to
elaborate on these means.[¶](#section-5.1-3){.pilcrow}

[Figure 8](#signalch){.xref} illustrates a sample DOTS Call Home flow
exchange:[¶](#section-5.1-4){.pilcrow}

[]{#name-dots-signal-channel-call-home}

::: {#signalch}
::: {#section-5.1-5.1 .alignLeft .art-text .artwork}
               +-----------+                        +-----------+
               | Call Home |                        | Call Home |
               |    DOTS   |                        |    DOTS   |
               |   server  |                        |   client  |
               +-----+-----+                        +-----+-----+
               (D)TLS client                        (D)TLS server
                     |                                    |
                     |         1. (D)TLS connection       |
                     |----------------------------------->|
                     |         2. Mitigation request      |
                     |<-----------------------------------|
                     |              ...                   |
:::

[Figure 8](#figure-8){.selfRef}: [DOTS Signal Channel Call Home Sequence
Diagram](#name-dots-signal-channel-call-home){.selfRef}
:::

The DOTS signal channel Call Home procedure is as
follows:[¶](#section-5.1-6){.pilcrow}

1.  ::: {#section-5.1-7.1}
    If UDP transport is used, the Call Home DOTS server begins by
    initiating a DTLS connection to the Call Home DOTS
    client.[¶](#section-5.1-7.1.1){.pilcrow}

    If TCP is used, the Call Home DOTS server begins by initiating a TCP
    connection to the Call Home DOTS client. Once connected, the Call
    Home DOTS server continues to initiate a TLS connection to the Call
    Home DOTS client.[¶](#section-5.1-7.1.2){.pilcrow}

    Peer DOTS agents may have mutual agreement to use a specific port
    number, such as by explicit configuration or dynamic discovery
    \[[RFC8973](#RFC8973){.xref}\]. The interaction between the base
    DOTS signal channel and the Call Home is discussed in [Appendix
    B](#app){.xref}.[¶](#section-5.1-7.1.3){.pilcrow}

    The Happy Eyeballs mechanism explained in [Section
    4.3](https://www.rfc-editor.org/rfc/rfc9132#section-4.3){.relref} of
    \[[RFC9132](#RFC9132){.xref}\] is used for initiating (D)TLS
    connections.[¶](#section-5.1-7.1.4){.pilcrow}
    :::

2.  ::: {#section-5.1-7.2}
    Using this (D)TLS connection, the Call Home DOTS client may request,
    withdraw, or retrieve the status of mitigation requests. The Call
    Home DOTS client supplies the source information by means of new
    attributes defined in [Section
    5.3.1](#mitigation){.xref}.[¶](#section-5.1-7.2.1){.pilcrow}

    The heartbeat mechanism used for the DOTS Call Home deviates from
    the one defined in [Section
    4.7](https://www.rfc-editor.org/rfc/rfc9132#section-4.7){.relref} of
    \[[RFC9132](#RFC9132){.xref}\]. [Section 5.2.1](#hb){.xref}
    specifies the behavior to be followed by Call Home DOTS
    agents.[¶](#section-5.1-7.2.2){.pilcrow}
    :::
:::
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [DOTS Signal Channel Variations](#name-dots-signal-channel-variati){.section-name .selfRef} {#name-dots-signal-channel-variati}

::: {#hb}
::: {#section-5.2.1 .section}
#### [5.2.1.](#section-5.2.1){.section-number .selfRef} [Heartbeat Mechanism](#name-heartbeat-mechanism){.section-name .selfRef} {#name-heartbeat-mechanism}

Once the (D)TLS section is established between the DOTS agents, the Call
Home DOTS client contacts the Call Home DOTS server to retrieve the
session configuration parameters ([Section
4.5](https://www.rfc-editor.org/rfc/rfc9132#section-4.5){.relref} of
\[[RFC9132](#RFC9132){.xref}\]). The Call Home DOTS server adjusts the
\"heartbeat-interval\" to accommodate binding timers used by on-path
NATs and firewalls. Heartbeats will then be exchanged by the DOTS agents
following the instructions retrieved using the signal channel session
configuration exchange.[¶](#section-5.2.1-1){.pilcrow}

It is the responsibility of Call Home DOTS servers to ensure that
on-path translators/firewalls are maintaining a binding so that the same
external IP address and/or port number is retained for the DOTS signal
channel session. A Call Home DOTS client [MAY]{.bcp14} trigger their
heartbeat requests immediately after receiving heartbeat probes from its
peer Call Home DOTS server.[¶](#section-5.2.1-2){.pilcrow}

When an outgoing attack that saturates the outgoing link from the Call
Home DOTS server is detected and reported by a Call Home DOTS client,
the latter [MUST]{.bcp14} continue to use the DOTS signal channel even
if no traffic is received from the Call Home DOTS
server.[¶](#section-5.2.1-3){.pilcrow}

If the Call Home DOTS server receives traffic from the Call Home DOTS
client, the Call Home DOTS server [MUST]{.bcp14} continue to use the
DOTS signal channel even if the threshold of allowed missing heartbeats
(\"missing-hb-allowed\") is reached.[¶](#section-5.2.1-4){.pilcrow}

If the Call Home DOTS server does not receive any traffic from the peer
Call Home DOTS client during the time span required to exhaust the
maximum \"missing-hb-allowed\" threshold, the Call Home DOTS server
concludes the session is disconnected. Then, the Call Home DOTS server
[MUST]{.bcp14} try to establish a new DOTS signal channel session,
preferably by resuming the (D)TLS
session.[¶](#section-5.2.1-5){.pilcrow}
:::
:::

::: {#redirect}
::: {#section-5.2.2 .section}
#### [5.2.2.](#section-5.2.2){.section-number .selfRef} [Redirected Signaling](#name-redirected-signaling){.section-name .selfRef} {#name-redirected-signaling}

A Call Home DOTS server [MUST NOT]{.bcp14} support the redirected
signaling mechanism as specified in [Section
4.6](https://www.rfc-editor.org/rfc/rfc9132#section-4.6){.relref} of
\[[RFC9132](#RFC9132){.xref}\] (i.e., a 5.03 response that conveys an
alternate DOTS server\'s Fully Qualified Domain Name (FQDN) or IP
address(es)). A Call Home DOTS client [MUST]{.bcp14} silently discard
such a message as only a Call Home DOTS server can initiate a new (D)TLS
connection.[¶](#section-5.2.2-1){.pilcrow}

If a Call Home DOTS client wants to redirect a Call Home DOTS server to
another Call Home DOTS client, it [MUST]{.bcp14} send a Non-confirmable
PUT request to the predefined resource \".well-known/dots/redirect\"
with the following attributes in the body of the PUT
request:[¶](#section-5.2.2-2){.pilcrow}

[]{.break}

alt-ch-client:

:   The FQDN of an alternate Call Home DOTS client. It is also presented
    as a reference identifier for authentication
    purposes.[¶](#section-5.2.2-3.2.1){.pilcrow}

    This is a mandatory attribute for DOTS signal Call Home. It [MUST
    NOT]{.bcp14} be used for base DOTS signal channel
    operations.[¶](#section-5.2.2-3.2.2){.pilcrow}

:   

alt-ch-client-record:

:   List of IP addresses for the alternate Call Home DOTS client. If no
    \"alt-ch-client-record\" is provided, the Call Home DOTS server
    passes the \"alt-ch-client\" name to a name resolution library to
    retrieve one or more IP addresses of the alternate Call Home DOTS
    client.[¶](#section-5.2.2-3.4.1){.pilcrow}

    This is an optional attribute for DOTS signal Call Home. It [MUST
    NOT]{.bcp14} be used for base DOTS signal channel
    operations.[¶](#section-5.2.2-3.4.2){.pilcrow}

:   

ttl:

:   The Time To Live (TTL) of the alternate Call Home DOTS client. That
    is, the time interval in which the alternate Call Home DOTS client
    may be cached for use by a Call Home DOTS
    server.[¶](#section-5.2.2-3.6.1){.pilcrow}

    This is an optional attribute for DOTS signal Call Home. It [MUST
    NOT]{.bcp14} be used for base DOTS signal channel
    operations.[¶](#section-5.2.2-3.6.2){.pilcrow}

:   

On receipt of this PUT request, the Call Home DOTS server responds with
a 2.01 (Created), closes this connection, and establishes a connection
with the new Call Home DOTS client. The processing of the TTL is defined
in [Section
4.6](https://www.rfc-editor.org/rfc/rfc9132#section-4.6){.relref} of
\[[RFC9132](#RFC9132){.xref}\]. If the Call Home DOTS server cannot
service the PUT request, the response is rejected with a 4.00 (Bad
Request).[¶](#section-5.2.2-4){.pilcrow}

[Figure 9](#red-example){.xref} shows a PUT request example to convey
the alternate Call Home DOTS client \"alt-call-home-client.example\"
together with its IP addresses 2001:db8:6401::1 and 2001:db8:6401::2.
The validity of this alternate Call Home DOTS client is 10
minutes.[¶](#section-5.2.2-5){.pilcrow}

[]{#name-example-of-a-put-request-fo}

::: {#red-example}
::: {#section-5.2.2-6.1}
``` {.lang-coap .sourcecode}
   Header: PUT (Code=0.03)
   Uri-Path: ".well-known"
   Uri-Path: "dots"
   Uri-Path: "redirect"
   Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
   Uri-Path: "mid=123"
   Content-Format: "application/dots+cbor"

   {
     "ietf-dots-signal-channel:redirected-signal": {
       "ietf-dots-call-home:alt-ch-client":
                     "alt-call-home-client.example",
       "ietf-dots-call-home:alt-ch-client-record": [
          "2001:db8:6401::1",
          "2001:db8:6401::2"
        ],
       "ietf-dots-call-home:ttl": 600
   }
```
:::

[Figure 9](#figure-9){.selfRef}: [Example of a PUT Request for
Redirected Signaling](#name-example-of-a-put-request-fo){.selfRef}
:::

[Figure 9](#red-example){.xref} uses the JSON encoding of YANG-modeled
data for the CoAP message body. The same encoding is used in [Figure
10](#example){.xref} ([Section
5.3.1](#mitigation){.xref}).[¶](#section-5.2.2-7){.pilcrow}
:::
:::
:::

::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [DOTS Signal Channel Extension](#name-dots-signal-channel-extensi){.section-name .selfRef} {#name-dots-signal-channel-extensi}

::: {#mitigation}
::: {#section-5.3.1 .section}
#### [5.3.1.](#section-5.3.1){.section-number .selfRef} [Mitigation Request](#name-mitigation-request){.section-name .selfRef} {#name-mitigation-request}

This specification extends the mitigation request defined in [Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\] to convey the attack source information
(e.g., source prefixes, source port numbers). The DOTS client conveys
the following new parameters in the Concise Binary Object Representation
(CBOR) body of the mitigation request:[¶](#section-5.3.1-1){.pilcrow}

[]{.break}

source-prefix:

:   A list of attacker IP prefixes used to attack the target. Prefixes
    are represented using Classless Inter-Domain Routing (CIDR) notation
    ([BCP 122](#RFC4632){.xref}
    \[[RFC4632](#RFC4632){.xref}\]).[¶](#section-5.3.1-2.2.1){.pilcrow}

    As a reminder, the prefix length [MUST]{.bcp14} be less than or
    equal to 32 (or 128) for IPv4 (or
    IPv6).[¶](#section-5.3.1-2.2.2){.pilcrow}

    The prefix list [MUST NOT]{.bcp14} include broadcast, loopback, or
    multicast addresses. These addresses are considered invalid values.
    Note that link-local addresses are allowed. The Call Home DOTS
    client [MUST]{.bcp14} validate that attacker prefixes are within the
    scope of the Call Home DOTS server domain (e.g., prefixes assigned
    to the Call Home DOTS server domain or networks it services). This
    check is meant to avoid contacting Call Home DOTS servers that are
    not entitled to enforce actions on specific
    prefixes.[¶](#section-5.3.1-2.2.3){.pilcrow}

    This is an optional attribute for the base DOTS signal channel
    operations.[¶](#section-5.3.1-2.2.4){.pilcrow}

:   

source-port-range:

:   A list of port numbers used by the attack traffic
    flows.[¶](#section-5.3.1-2.4.1){.pilcrow}

    A port range is defined by two bounds, a lower port number
    (\"lower-port\") and an upper port number (\"upper-port\"). When
    only \"lower-port\" is present, it represents a single port
    number.[¶](#section-5.3.1-2.4.2){.pilcrow}

    For TCP, UDP, Stream Control Transmission Protocol (SCTP)
    \[[RFC4960](#RFC4960){.xref}\], or Datagram Congestion Control
    Protocol (DCCP) \[[RFC4340](#RFC4340){.xref}\], a range of ports can
    be any subrange of 0-65535 \-- for example, 0-1023, 1024-65535, or
    1024-49151.[¶](#section-5.3.1-2.4.3){.pilcrow}

    This is an optional attribute for the base DOTS signal channel
    operations.[¶](#section-5.3.1-2.4.4){.pilcrow}

:   

source-icmp-type-range:

:   A list of ICMP types used by the attack traffic flows. An ICMP type
    range is defined by two bounds, a lower ICMP type (lower-type) and
    an upper ICMP type (upper-type). When only \"lower-type\" is
    present, it represents a single ICMP type. Both ICMP
    \[[RFC0792](#RFC0792){.xref}\] and ICMPv6
    \[[RFC4443](#RFC4443){.xref}\] types are supported. Whether ICMP or
    ICMPv6 types are to be used is determined by the address family of
    the \"target-prefix\".[¶](#section-5.3.1-2.6.1){.pilcrow}

    This is an optional attribute for the base DOTS signal channel
    operations.[¶](#section-5.3.1-2.6.2){.pilcrow}

:   

The \"source-prefix\" parameter is a mandatory attribute when the attack
traffic information is signaled by a Call Home DOTS client (i.e., the
Call Home scenario depicted in [Figure 8](#signalch){.xref}). The
\"target-prefix\" attribute [MUST]{.bcp14} be included in the mitigation
request signaling the attack information to a Call Home DOTS server. The
\"target-uri\" or \"target-fqdn\" parameters can be included in a
mitigation request for diagnostic purposes to notify the Call Home DOTS
server domain administrator but [SHOULD NOT]{.bcp14} be used to
determine the target IP addresses. \"alias-name\" is unlikely to be
conveyed in a Call Home mitigation request given that a target may be
any IP resource and that there is no incentive for a Call Home DOTS
server (embedded, for example, in a CPE) to maintain
aliases.[¶](#section-5.3.1-3){.pilcrow}

In order to help attack source identification by a Call Home DOTS
server, the Call Home DOTS client [SHOULD]{.bcp14} include in its
mitigation request additional information such as \"source-port-range\"
or \"source-icmp-type-range\" to disambiguate nodes sharing the same
\"source-prefix\". IPv6 addresses/prefixes are sufficient to uniquely
identify a network endpoint, without need for port numbers or ICMP type
information. While this is also possible for IPv4, it is much less often
the case than for IPv6. More address sharing implications on the setting
of source information (\"source-prefix\", \"source-port-range\") are
discussed in [Section
5.3.2](#nat){.xref}.[¶](#section-5.3.1-4){.pilcrow}

Only immediate mitigation requests (i.e., \"trigger-mitigation\" set to
\"true\") are allowed; Call Home DOTS clients [MUST NOT]{.bcp14} send
requests with \"trigger-mitigation\" set to \"false\". Such requests
[MUST]{.bcp14} be discarded by the Call Home DOTS server with a 4.00
(Bad Request).[¶](#section-5.3.1-5){.pilcrow}

An example of a mitigation request sent by a Call Home DOTS client is
shown in [Figure 10](#example){.xref}.[¶](#section-5.3.1-6){.pilcrow}

[]{#name-an-example-of-a-mitigation-}

::: {#example}
::: {#section-5.3.1-7.1}
``` {.lang-json .sourcecode}
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=56"
  Content-Format: "application/dots+cbor"

  {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "2001:db8:c000::/128"
           ],
          "ietf-dots-call-home:source-prefix": [
             "2001:db8:123::1/128"
           ],
          "lifetime": 3600
        }
      ]
    }
  }
```
:::

[Figure 10](#figure-10){.selfRef}: [An Example of a Mitigation Request
Issued by a Call Home DOTS
Client](#name-an-example-of-a-mitigation-){.selfRef}
:::

The Call Home DOTS server [MUST]{.bcp14} check that the
\"source-prefix\" is within the scope of the Call Home DOTS server
domain. Note that in a DOTS Call Home scenario, the Call Home DOTS
server considers, by default, that any routable IP prefix enclosed in
\"target-prefix\" is within the scope of the Call Home DOTS client.
Invalid mitigation requests are handled as per [Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-5.3.1-8){.pilcrow}

Note: These validation checks do not apply when the source information
is included as a hint in the context of the base DOTS signal
channel.[¶](#section-5.3.1-9){.pilcrow}

Call Home DOTS server domain administrator consent [MAY]{.bcp14} be
required to block the traffic from the compromised device to the attack
target. An implementation [MAY]{.bcp14} have a configuration knob to
block the traffic from the compromised device to the attack target with
or without DOTS server domain administrator
consent.[¶](#section-5.3.1-10){.pilcrow}

If consent from the Call Home DOTS server domain administrator is
required, the Call Home DOTS server replies with 2.01 (Created) and the
\"status\" code set to 1 (attack-mitigation-in-progress). Then, the
mechanisms defined in [Section
4.4.2](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2){.relref} of
\[[RFC9132](#RFC9132){.xref}\] are followed by the DOTS agents to update
the mitigation status. In particular, if the attack traffic is blocked,
the Call Home DOTS server informs the Call Home DOTS client that the
attack is being mitigated (i.e., by setting the \"status\" code to 2
(attack-successfully-mitigated)).[¶](#section-5.3.1-11){.pilcrow}

If the attack traffic information is identified by the Call Home DOTS
server or the Call Home DOTS server domain administrator as legitimate
traffic, the mitigation request is rejected with a 4.09 (Conflict)
(e.g., when no consent is required from an administrator) or a
notification message with the \"conflict-clause\" ([Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\]) set to the following new
value:[¶](#section-5.3.1-12){.pilcrow}

[]{.break}

4:
:   Mitigation request rejected. This code is returned by the DOTS
    server to indicate the attack traffic has been classified as
    legitimate traffic.[¶](#section-5.3.1-13.2){.pilcrow}
:   

Once the request is validated by the Call Home DOTS server, appropriate
actions are enforced to block the attack traffic within the source
network. For example, if the Call Home DOTS server is embedded in a CPE,
it can program the packet processor to punt all the traffic from the
compromised device to the target to slow path. The CPE inspects the
punted slow path traffic to detect and block the outgoing DDoS attack
traffic or quarantine the device (e.g., using MAC-level filtering) until
it is remediated and notifies the CPE administrator about the
compromised device. Note that the Call Home DOTS client is informed
about the progress of the attack mitigation following the rules in
[Section
4.4.2](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2){.relref} of
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-5.3.1-14){.pilcrow}

The DOTS agents follow the same procedures specified in
\[[RFC9132](#RFC9132){.xref}\] for managing a mitigation
request.[¶](#section-5.3.1-15){.pilcrow}
:::
:::

::: {#nat}
::: {#section-5.3.2 .section}
#### [5.3.2.](#section-5.3.2){.section-number .selfRef} [Address Sharing Considerations](#name-address-sharing-considerati){.section-name .selfRef} {#name-address-sharing-considerati}

[Figure 11](#ex1){.xref} depicts an example of a network provider that
hosts a Call Home DOTS client and deploys a Carrier-Grade NAT (CGN)
between the DOTS client domain and DOTS server domain. In such cases,
communicating an external IP address in a mitigation request by a Call
Home DOTS client is likely to be discarded by the Call Home DOTS server
because the external IP address is not visible locally to the Call Home
DOTS server ([Figure 11](#ex1){.xref}). The Call Home DOTS server is
only aware of the internal IP addresses/prefixes bound to its domain
(i.e., those used in the internal realm shown in [Figure
11](#ex1){.xref}). Thus, Call Home DOTS clients that are aware of the
presence of on-path CGNs [MUST NOT]{.bcp14} include the external IP
address and/or port number identifying the suspect attack source (i.e.,
those used in the external realm shown in [Figure 11](#ex1){.xref}) but
[MUST]{.bcp14} include the internal IP address and/or port number. To
that aim, the Call Home DOTS client [SHOULD]{.bcp14} rely on mechanisms,
such as those described in \[[RFC8512](#RFC8512){.xref}\] or
\[[RFC8513](#RFC8513){.xref}\], to retrieve the internal IP address and
port number that are mapped to an external IP address and port number.
For the particular case of NAT64 \[[RFC6146](#RFC6146){.xref}\], if the
target address is an IPv4 address, the IPv4-converted IPv6 address of
this target address \[[RFC6052](#RFC6052){.xref}\] [SHOULD]{.bcp14} be
used.[¶](#section-5.3.2-1){.pilcrow}

[]{#name-example-of-a-cgn-between-do}

::: {#ex1}
::: {#section-5.3.2-2.1 .alignCenter .art-text .artwork}
      N |        .-------------------.
      E |       (                     )-.
      T |     .'                         '
      W |     (        Call Home          )
      O |      (      DOTS client       -'
      R |       '-(                     )
      K |          '-------+-----------'
        |                  |
      P |                  |
      R |              +---+---+
      O |              |  CGN  |        External Realm
      V |..............|       |......................
      I |              |       |        Internal Realm
      D |              +---+---+
      E |                  |
      R |                  |
       ---                 |
                 .---------+---------.
                (                     )-.
              .'     Source Network      '
              (                           )
               (        Call Home        -'
                '-(    DOTS server      )
                   '------+------------'
                          |
                    +-----+-------+
                    |Attack Source|
                    +-------------+
:::

[Figure 11](#figure-11){.selfRef}: [Example of a CGN between DOTS
Domains](#name-example-of-a-cgn-between-do){.selfRef}
:::

If a Mapping of Address and Port (MAP) Border Relay
\[[RFC7597](#RFC7597){.xref}\] or Lightweight Address Family Transition
Router (lwAFTR) \[[RFC7596](#RFC7596){.xref}\] is enabled in the
provider\'s domain to service its customers, the identification of an
attack source bound to an IPv4 address/prefix [MUST]{.bcp14} also rely
on source port numbers because the same IPv4 address is assigned to
multiple customers. The port information is required to unambiguously
identify the source of an attack.[¶](#section-5.3.2-3){.pilcrow}

If a translator is enabled on the boundaries of the domain hosting the
Call Home DOTS server (e.g., a CPE with NAT enabled as shown in Figures
[12](#ex2){.xref} and [13](#ex2b){.xref}), the Call Home DOTS server
uses the attack traffic information conveyed in a mitigation request to
find the internal source IP address of the compromised device and blocks
the traffic from the compromised device traffic to the attack target
until the mitigation request is withdrawn. The Call Home DOTS server
proceeds with a NAT mapping table lookup using the attack information
(or a subset thereof) as a key. The lookup can be local ([Figure
12](#ex2){.xref}) or via a dedicated administration interface that is
offered by the CPE ([Figure 13](#ex2b){.xref}). This identification
allows the suspicious device to be isolated while avoiding disturbances
of other services.[¶](#section-5.3.2-4){.pilcrow}

[]{#name-example-of-a-dots-server-do}

::: {#ex2}
::: {#section-5.3.2-5.1 .alignCenter .art-text .artwork}
                 .-------------------.
                (                     )-.
              .'   Network Provider (DMS)'
              (                           )
               (        Call Home       -'
                '-(    DOTS client      )
                   '-------+-----------'
                           |
       ---             +---+---+
      S |              |  CPE  |  External Realm
      O |..............|       |................
      U |              |  NAT  |  Internal Realm
      R |              +---+---+
      C |                  |
      E |        .---------+---------.
        |       (                     )-.
      N |     .'                         '
      E |     (          Call Home        )
      T |      (        DOTS server     -'
      W |       '-(                     )
      O |          '-------+-----------'
      R |                  |
      K |           +------+------+
        |           |Attack Source|
                    +-------------+
:::

[Figure 12](#figure-12){.selfRef}: [Example of a DOTS Server Domain with
a NAT Embedded in a CPE](#name-example-of-a-dots-server-do){.selfRef}
:::

[]{#name-example-of-a-call-home-dots}

::: {#ex2b}
::: {#section-5.3.2-6.1 .alignCenter .art-text .artwork}
                 .-------------------.
                (                     )-.
              .'  Network Provider (DMS) '
              (                           )
               (        Call Home       -'
                '-(    DOTS client      )
                   '---------+---------'
                             |
       ---             +-----+-----+
      S |              |  CPE/NAT  |  External Realm
      O |..............|           |................
      U |              | Call Home |  Internal Realm
      R |              |DOTS server|
      C |              +-----+-----+
      E |                    |
        |        .-----------+-------.
        |       (                     )-.
      N |     .'                         '
      E |     (     Local Area Network    )
      T |      (                        -'
      W |       '-(                     )
      O |          '--------+----------'
      R |                   |
      K |            +------+------+
        |            |Attack Source|
                     +-------------+
:::

[Figure 13](#figure-13){.selfRef}: [Example of a Call Home DOTS Server
and a NAT Embedded in a
CPE](#name-example-of-a-call-home-dots){.selfRef}
:::

If, for any reason, address sharing is deployed in both source and
provider networks, both Call Home DOTS agents have to proceed with
address mapping lookups following the behavior specified in reference to
[Figure 11](#ex1){.xref} (network provider) and Figures
[12](#ex2){.xref} and [13](#ex2b){.xref} (source
network).[¶](#section-5.3.2-7){.pilcrow}
:::
:::
:::
:::
:::

::: {#YANG}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [DOTS Signal Call Home YANG Module](#name-dots-signal-call-home-yang-){.section-name .selfRef} {#name-dots-signal-call-home-yang-}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Tree Structure](#name-tree-structure){.section-name .selfRef} {#name-tree-structure}

This document augments the \"ietf-dots-signal-channel\" (dots-signal)
DOTS signal YANG module defined in \[[RFC9132](#RFC9132){.xref}\] for
signaling the attack traffic information. This document defines the YANG
module \"ietf-dots-call-home\", which has the following tree
structure:[¶](#section-6.1-1){.pilcrow}

::: {#section-6.1-2}
``` {.lang-yangtree .sourcecode}
module: ietf-dots-call-home

  augment-structure /dots-signal:dots-signal/dots-signal:message-type
                    /dots-signal:mitigation-scope/dots-signal:scope:
    +-- source-prefix*            inet:ip-prefix
    +-- source-port-range* [lower-port]
    |  +-- lower-port    inet:port-number
    |  +-- upper-port?   inet:port-number
    +-- source-icmp-type-range* [lower-type]
       +-- lower-type    uint8
       +-- upper-type?   uint8
  augment-structure /dots-signal:dots-signal/dots-signal:message-type
                    /dots-signal:redirected-signal:
    +-- (type)?
       +--:(call-home-only)
          +-- alt-ch-client           inet:domain-name
          +-- alt-ch-client-record*   inet:ip-address
          +-- ttl?                    uint32
```

[¶](#section-6.1-2){.pilcrow}
:::
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [YANG/JSON Mapping Parameters to CBOR](#name-yang-json-mapping-parameter){.section-name .selfRef} {#name-yang-json-mapping-parameter}

The YANG/JSON mapping parameters to CBOR are listed in [Table
1](#table1){.xref}.[¶](#section-6.2-1){.pilcrow}

Note: Implementers must check that the mapping output provided by their
YANG-to-CBOR encoding schemes is aligned with the content of [Table
1](#table1){.xref}.[¶](#section-6.2-2){.pilcrow}

[]{#name-yang-json-mapping-parameters}

::: {#table1}
  -------------------------------------------------------------------------------------------------------------
  Parameter Name                                YANG Type          CBOR Key Value CBOR Major     JSON Type
                                                                                  Type &         
                                                                                  Information    
  --------------------------------------------- ------------------ -------------- -------------- --------------
  ietf-dots-call-home:​source-prefix            leaf-list          32768          4 array\       Array String
                                                inet:​ip-prefix                   3 text string  

  ietf-dots-call-home:​source-port-range        list               32769          4 array        Array

  ietf-dots-call-home:​source-icmp-type-range   list               32770          4 array        Array

  lower-type                                    uint8              32771          0 unsigned     Number

  upper-type                                    uint8              32772          0 unsigned     Number

  ietf-dots-call-home:​alt-ch-client            inet: domain-name  32773          3 text string  String

  ietf-dots-call-home:​alt-ch-client-record     leaf-list          32774          4 array\       Array\
                                                inet:​ip-address                  3 text string  String

  ietf-dots-call-home:​ttl                      uint32             32775          0 unsigned     Number
  -------------------------------------------------------------------------------------------------------------

  : [Table 1](#table-1){.selfRef}: [YANG/JSON Mapping Parameters to
  CBOR](#name-yang-json-mapping-parameters){.selfRef}
:::

The YANG/JSON mappings to CBOR for \"lower-port\" and \"upper-port\" are
already defined in Table 5 of
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-6.2-4){.pilcrow}
:::

::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [YANG Module](#name-yang-module){.section-name .selfRef} {#name-yang-module}

This module uses the common YANG types defined in
\[[RFC6991](#RFC6991){.xref}\] and the data structure extension defined
in \[[RFC8791](#RFC8791){.xref}\].[¶](#section-6.3-1){.pilcrow}

::: {#section-6.3-2}
``` {.lang-yang .sourcecode}
<CODE BEGINS> file "ietf-dots-call-home@2021-12-09.yang"

module ietf-dots-call-home {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-dots-call-home";
  prefix dots-call-home;

  import ietf-inet-types {
    prefix inet;
    reference
      "Section 4 of RFC 6991";
  }
  import ietf-dots-signal-channel {
    prefix dots-signal;
    reference
      "RFC 9132: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }
  import ietf-yang-structure-ext {
    prefix sx;
    reference
      "RFC 8791: YANG Data Structure Extensions";
  }

  organization
    "IETF DDoS Open Threat Signaling (DOTS) Working Group";
  contact
    "WG Web:   <https://datatracker.ietf.org/wg/dots/>
     WG List:  <mailto:dots@ietf.org>

     Author:  Konda, Tirumaleswar Reddy
              <mailto:kondtir@gmail.com>;

     Author:  Mohamed Boucadair
              <mailto:mohamed.boucadair@orange.com>;

     Author:  Jon Shallow
              <mailto:ietf-supjps@jpshallow.com>";
  description
    "This module contains YANG definitions for the signaling
     messages exchanged between a DOTS client and a DOTS server
     for the Call Home deployment scenario.

     Copyright (c) 2021 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 9066; see
     the RFC itself for full legal notices.";

  revision 2021-12-09 {
    description
      "Initial revision.";
    reference
      "RFC 9066: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Call Home";
  }
  sx:augment-structure "/dots-signal:dots-signal"
                     + "/dots-signal:message-type"
                     + "/dots-signal:mitigation-scope"
                     + "/dots-signal:scope" {
    description
      "Attack source details.";
    leaf-list source-prefix {
      type inet:ip-prefix;
      description
        "IPv4 or IPv6 prefix identifying the attack source(s).";
    }
    list source-port-range {
      key "lower-port";
      description
        "Port range. When only lower-port is
         present, it represents a single port number.";
      leaf lower-port {
        type inet:port-number;
        description
          "Lower port number of the port range.";
      }
      leaf upper-port {
        type inet:port-number;
        must '. >= ../lower-port' {
          error-message
            "The upper port number must be greater than
             or equal to the lower port number.";
        }
        description
          "Upper port number of the port range.";
      }
    }
    list source-icmp-type-range {
      key "lower-type";
      description
        "ICMP/ICMPv6 type range. When only lower-type is
         present, it represents a single ICMP/ICMPv6 type.

         The address family of the target-prefix is used
         to determine whether ICMP or ICMPv6 is used.";
      leaf lower-type {
        type uint8;
        description
          "Lower ICMP/ICMPv6 type of the ICMP type range.";
        reference
          "RFC 792: Internet Control Message Protocol
           RFC 4443: Internet Control Message Protocol (ICMPv6)
                     for the Internet Protocol Version 6 (IPv6)
                     Specification.";
      }
      leaf upper-type {
        type uint8;
        must '. >= ../lower-type' {
          error-message
            "The upper ICMP/ICMPv6 type must be greater than
             or equal to the lower ICMP type.";
        }
        description
          "Upper type of the ICMP type range.";
        reference
          "RFC 792: Internet Control Message Protocol
           RFC 4443: Internet Control Message Protocol (ICMPv6)
                     for the Internet Protocol Version 6 (IPv6)
                     Specification.";
      }
    }
  }
  sx:augment-structure "/dots-signal:dots-signal"
                     + "/dots-signal:message-type"
                     + "/dots-signal:redirected-signal" {
    description
      "Augments the redirected signal to communicate an
       alternate Call Home DOTS client.";
    choice type {
      description
        "Indicates the type of the DOTS session (e.g., base
         DOTS signal channel, DOTS Call Home).";
      case call-home-only {
        description
          "These attributes appear only in a signal Call Home
           channel message from a Call Home DOTS client
           to a Call Home DOTS server.";
        leaf alt-ch-client {
          type inet:domain-name;
          mandatory true;
          description
            "FQDN of an alternate Call Home DOTS client.

             This name is also presented as a reference
             identifier for authentication purposes.";
        }
        leaf-list alt-ch-client-record {
          type inet:ip-address;
          description
            "List of IP addresses for the alternate Call
             Home DOTS client.

             If this data node is not present, a Call Home
             DOTS server resolves the alt-ch-client into
             one or more IP addresses.";
        }
        leaf ttl {
          type uint32;
          units "seconds";
          description
            "The Time To Live (TTL) of the alternate Call Home
             DOTS client.";
          reference
            "Section 4.6 of RFC 9132";
        }
      }
    }
  }
}

<CODE ENDS>
```

[¶](#section-6.3-2){.pilcrow}
:::
:::
:::
:::

::: {#IANA}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#map}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [DOTS Signal Channel CBOR Mappings Registry](#name-dots-signal-channel-cbor-ma){.section-name .selfRef} {#name-dots-signal-channel-cbor-ma}

This specification registers the following comprehension-optional
parameters ([Table 2](#table2){.xref}) in the IANA \"DOTS Signal Channel
CBOR Key Values\" registry
\[[Key-Map](#Key-Map){.xref}\].[¶](#section-7.1-1){.pilcrow}

[]{#name-assigned-dots-signal-channe}

::: {#table2}
  Parameter Name                                CBOR Key Value   CBOR Major Type   Change Controller   Reference
  --------------------------------------------- ---------------- ----------------- ------------------- -----------
  ietf-dots-call-home:​source-prefix            32768            4                 IESG                RFC 9066
  ietf-dots-call-home:​source-port-range        32769            4                 IESG                RFC 9066
  ietf-dots-call-home:​source-icmp-type-range   32770            4                 IESG                RFC 9066
  lower-type                                    32771            0                 IESG                RFC 9066
  upper-type                                    32772            0                 IESG                RFC 9066
  ietf-dots-call-home:​alt-ch-client            32773            3                 IESG                RFC 9066
  ietf-dots-call-home:​alt-ch-client-record     32774            4                 IESG                RFC 9066
  ietf-dots-call-home:​ttl                      32775            0                 IESG                RFC 9066

  : [Table 2](#table-2){.selfRef}: [Assigned DOTS Signal Channel CBOR
  Key Values](#name-assigned-dots-signal-channe){.selfRef}
:::
:::
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [New DOTS Conflict Cause](#name-new-dots-conflict-cause){.section-name .selfRef} {#name-new-dots-conflict-cause}

Per this document, IANA has assigned a new code from the \"DOTS Signal
Channel Conflict Cause Codes\" registry
\[[Cause](#Cause){.xref}\].[¶](#section-7.2-1){.pilcrow}

[]{#name-assigned-dots-signal-channel}

  Code   Label                                 Description                                                                                                                                       Reference
  ------ ------------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------- -----------
  4      request-rejected-legitimate-traffic   Mitigation request rejected. This code is returned by the DOTS server to indicate the attack traffic has been classified as legitimate traffic.   RFC 9066

  : [Table 3](#table-3){.selfRef}: [Assigned DOTS Signal Channel
  Conflict Cause Code](#name-assigned-dots-signal-channel){.selfRef}
:::

::: {#yang}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [DOTS Signal Call Home YANG Module](#name-dots-signal-call-home-yang-m){.section-name .selfRef} {#name-dots-signal-call-home-yang-m}

Per this document, IANA has registered the following URI in the \"ns\"
subregistry within the \"IETF XML Registry\"
\[[RFC3688](#RFC3688){.xref}\]:[¶](#section-7.3-1){.pilcrow}

[]{.break}

URI:
:   urn:ietf:params:xml:ns:yang:ietf-dots-call-home[¶](#section-7.3-2.2){.pilcrow}
:   

Registrant Contact:
:   The IETF.[¶](#section-7.3-2.4){.pilcrow}
:   

XML:
:   N/A; the requested URI is an XML
    namespace.[¶](#section-7.3-2.6){.pilcrow}
:   

Per this document, IANA has registered the following YANG module in the
\"YANG Module Names\" subregistry \[[RFC6020](#RFC6020){.xref}\] within
the \"YANG Parameters\" registry:[¶](#section-7.3-3){.pilcrow}

[]{.break}

name:
:   ietf-dots-call-home[¶](#section-7.3-4.2){.pilcrow}
:   

namespace:
:   urn:ietf:params:xml:ns:yang:ietf-dots-call-home[¶](#section-7.3-4.4){.pilcrow}
:   

maintained by IANA:
:   N[¶](#section-7.3-4.6){.pilcrow}
:   

prefix:
:   dots-call-home[¶](#section-7.3-4.8){.pilcrow}
:   

reference:
:   RFC 9066[¶](#section-7.3-4.10){.pilcrow}
:   
:::
:::
:::
:::

::: {#security}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document deviates from classic DOTS signal channel usage by having
the DOTS server initiate the (D)TLS connection. Security considerations
related to the DOTS signal channel discussed in [Section
11](https://www.rfc-editor.org/rfc/rfc9132#section-11){.relref} of
\[[RFC9132](#RFC9132){.xref}\] and (D)TLS early data discussed in
[Section 7](https://www.rfc-editor.org/rfc/rfc9132#section-7){.relref}
of \[[RFC9132](#RFC9132){.xref}\] [MUST]{.bcp14} be considered. DOTS
agents [MUST]{.bcp14} authenticate each other using (D)TLS before a DOTS
signal channel session is considered valid.[¶](#section-8-1){.pilcrow}

The Call Home function enables a Call Home DOTS server to be reachable
by only the intended Call Home DOTS client. Appropriate filters (e.g.,
access control lists) can be installed on the Call Home DOTS server and
network between the Call Home DOTS agents so that only communications
from a trusted Call Home DOTS client to the Call Home DOTS server are
allowed. These filters can be automatically installed by a Call Home
DOTS server based on the configured or discovered peer Call Home DOTS
client(s).[¶](#section-8-2){.pilcrow}

An attacker may launch a DoS attack on the DOTS client by having it
perform computationally expensive operations before deducing that the
attacker doesn\'t possess a valid key. For instance, in TLS 1.3
\[[RFC8446](#RFC8446){.xref}\], the ServerHello message contains a key
share value based on an expensive asymmetric key operation for key
establishment. Common precautions mitigating DoS attacks are
recommended, such as temporarily adding the source address to a
drop-list after a set number of unsuccessful authentication
attempts.[¶](#section-8-3){.pilcrow}

The DOTS signal Call Home channel can be misused by a misbehaving Call
Home DOTS client by arbitrarily signaling legitimate traffic as being
attack traffic or falsifying mitigation signals so that some sources are
disconnected or some traffic is rate-limited. Such misbehaving Call Home
DOTS clients may include sources identified by IP addresses that are
used for internal use only (that is, these addresses are not visible
outside a Call Home DOTS server domain). Absent explicit policy (e.g.,
the Call Home DOTS client and server are managed by the same
administrative entity), such requests should be discarded by the Call
Home DOTS server. More generally, Call Home DOTS servers should not
blindly trust mitigation requests from Call Home DOTS clients. For
example, Call Home DOTS servers could use the attack flow information
contained in a mitigation request to enable a full-fledged packet
inspection function to inspect all the traffic from the compromised
device to the target. They could also redirect the traffic from the
potentially compromised device to the target towards a DDoS mitigation
system that can scrub the suspicious traffic without blindly blocking
all traffic from the indicated attack source to the target. Call Home
DOTS servers can also seek the consent of the DOTS server domain
administrator to block the traffic from the potentially compromised
device to the target (see [Section 5.3.1](#mitigation){.xref}). The
means to seek consent are implementation
specific.[¶](#section-8-4){.pilcrow}

Call Home DOTS agents may interact with on-path address sharing
functions to retrieve an internal IP address / external IP address
mapping ([Section 5.3.2](#nat){.xref}) identifying an attack source.
Blocking access or manipulating the mapping information will complicate
DDoS attack mitigation close to an attack source. Additional security
considerations are specific to the actual mechanism used to access that
mapping (refer, e.g., to [Section
4](https://www.rfc-editor.org/rfc/rfc8512#section-4){.relref} of
\[[RFC8512](#RFC8512){.xref}\] or [Section
4](https://www.rfc-editor.org/rfc/rfc8513#section-4){.relref} of
\[[RFC8513](#RFC8513){.xref}\]).[¶](#section-8-5){.pilcrow}

This document augments YANG data structures that are meant to be used as
an abstract representation of DOTS signal channel Call Home messages. As
such, the \"ietf-dots-call-home\" module does not introduce any new
vulnerabilities beyond those specified above and in
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-8-6){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Privacy Considerations](#name-privacy-considerations){.section-name .selfRef} {#name-privacy-considerations}

The considerations discussed in \[[RFC6973](#RFC6973){.xref}\] were
taken into account to assess whether the DOTS Call Home introduces
privacy threats.[¶](#section-9-1){.pilcrow}

Concretely, the protocol does not leak any new information that can be
used to ease surveillance. In particular, the Call Home DOTS server is
not required to share information that is local to its network (e.g.,
internal identifiers of an attack source) with the Call Home DOTS
client. Also, the recommended data to be included in Call Home DOTS
messages is a subset of the Layer 3 / Layer 4 information that can be
learned from the overall traffic flows that exit the Call Home DOTS
server domain. Furthermore, Call Home DOTS clients do not publicly
reveal attack identification information; that information is encrypted
and only shared with an authorized entity in the domain to which the IP
address/prefix is assigned, from which an attack was
issued.[¶](#section-9-2){.pilcrow}

The DOTS Call Home does not preclude the validation of mitigation
requests received from a Call Home DOTS client. For example, a security
service running on the CPE may require an administrator\'s consent
before the CPE acts upon the mitigation request indicated by the Call
Home DOTS client. How the consent is obtained is out of scope of this
document.[¶](#section-9-3){.pilcrow}

Note that a Call Home DOTS server can seek an administrator\'s consent,
validate the request by inspecting the relevant traffic for attack
signatures, or proceed with both courses of
action.[¶](#section-9-4){.pilcrow}

The DOTS Call Home is only advisory in nature. Concretely, the DOTS Call
Home does not impose any action to be enforced within the network
hosting an attack source; it is up to the Call Home DOTS server (and/or
network administrator) to decide whether and which actions are
required.[¶](#section-9-5){.pilcrow}

Moreover, the DOTS Call Home avoids misattribution by appropriately
identifying the network to which a suspect attack source belongs (e.g.,
address sharing issues discussed in [Section
5.3.1](#mitigation){.xref}).[¶](#section-9-6){.pilcrow}

Triggers to send a DOTS mitigation request to a Call Home DOTS server
are deployment specific. For example, a Call Home DOTS client may rely
on the output of some DDoS detection systems (flow exports or similar
functions) deployed within the DOTS client domain to detect potential
outbound DDoS attacks or may rely on abuse claims received from remote
victim networks. These systems may be misused to track users and infer
their activities. Such misuses are not required to achieve the
functionality defined in this document (that is, protect the Internet
and avoid altering the IP reputation of source networks). It is out of
the scope to identify privacy threats specific to given attack detection
technology. The reader may refer, for example, to [Section
11.8](https://www.rfc-editor.org/rfc/rfc7011#section-11.8){.relref} of
\[[RFC7011](#RFC7011){.xref}\].[¶](#section-9-7){.pilcrow}
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0792\]
:   [Postel, J.]{.refAuthor}, [\"Internet Control Message
    Protocol\"]{.refTitle}, [STD 5]{.seriesInfo}, [RFC
    792]{.seriesInfo}, [DOI 10.17487/RFC0792]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc792>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3688\]
:   [Mealling, M.]{.refAuthor}, [\"The IETF XML Registry\"]{.refTitle},
    [BCP 81]{.seriesInfo}, [RFC 3688]{.seriesInfo}, [DOI
    10.17487/RFC3688]{.seriesInfo}, January 2004,
    \<<https://www.rfc-editor.org/info/rfc3688>\>.
:   

\[RFC4443\]
:   [Conta, A.]{.refAuthor}, [Deering, S.]{.refAuthor}, and [M. Gupta,
    Ed.]{.refAuthor}, [\"Internet Control Message Protocol (ICMPv6) for
    the Internet Protocol Version 6 (IPv6) Specification\"]{.refTitle},
    [STD 89]{.seriesInfo}, [RFC 4443]{.seriesInfo}, [DOI
    10.17487/RFC4443]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4443>\>.
:   

\[RFC6020\]
:   [Bjorklund, M., Ed.]{.refAuthor}, [\"YANG - A Data Modeling Language
    for the Network Configuration Protocol (NETCONF)\"]{.refTitle}, [RFC
    6020]{.seriesInfo}, [DOI 10.17487/RFC6020]{.seriesInfo}, October
    2010, \<<https://www.rfc-editor.org/info/rfc6020>\>.
:   

\[RFC6052\]
:   [Bao, C.]{.refAuthor}, [Huitema, C.]{.refAuthor},
    [Bagnulo, M.]{.refAuthor}, [Boucadair, M.]{.refAuthor}, and [X.
    Li]{.refAuthor}, [\"IPv6 Addressing of IPv4/IPv6
    Translators\"]{.refTitle}, [RFC 6052]{.seriesInfo}, [DOI
    10.17487/RFC6052]{.seriesInfo}, October 2010,
    \<<https://www.rfc-editor.org/info/rfc6052>\>.
:   

\[RFC6146\]
:   [Bagnulo, M.]{.refAuthor}, [Matthews, P.]{.refAuthor}, and [I. van
    Beijnum]{.refAuthor}, [\"Stateful NAT64: Network Address and
    Protocol Translation from IPv6 Clients to IPv4
    Servers\"]{.refTitle}, [RFC 6146]{.seriesInfo}, [DOI
    10.17487/RFC6146]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6146>\>.
:   

\[RFC6347\]
:   [Rescorla, E.]{.refAuthor} and [N. Modadugu]{.refAuthor},
    [\"Datagram Transport Layer Security Version 1.2\"]{.refTitle}, [RFC
    6347]{.seriesInfo}, [DOI 10.17487/RFC6347]{.seriesInfo}, January
    2012, \<<https://www.rfc-editor.org/info/rfc6347>\>.
:   

\[RFC6991\]
:   [Schoenwaelder, J., Ed.]{.refAuthor}, [\"Common YANG Data
    Types\"]{.refTitle}, [RFC 6991]{.seriesInfo}, [DOI
    10.17487/RFC6991]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6991>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   

\[RFC8791\]
:   [Bierman, A.]{.refAuthor}, [Björklund, M.]{.refAuthor}, and [K.
    Watsen]{.refAuthor}, [\"YANG Data Structure
    Extensions\"]{.refTitle}, [RFC 8791]{.seriesInfo}, [DOI
    10.17487/RFC8791]{.seriesInfo}, June 2020,
    \<<https://www.rfc-editor.org/info/rfc8791>\>.
:   

\[RFC9132\]
:   [Boucadair, M., Ed.]{.refAuthor}, [Shallow, J.]{.refAuthor}, and [T.
    Reddy.K]{.refAuthor}, [\"Distributed Denial-of-Service Open Threat
    Signaling (DOTS) Signal Channel Specification\"]{.refTitle}, [RFC
    9132]{.seriesInfo}, [DOI 10.17487/RFC9132]{.seriesInfo}, September
    2021, \<<https://www.rfc-editor.org/info/rfc9132>\>.
:   
:::

::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[Cause\]
:   [IANA]{.refAuthor}, [\"DOTS Signal Channel Conflict Cause
    Codes\"]{.refTitle}, \<<https://www.iana.org/assignments/dots/>\>.
:   

\[DOTS-MULTIHOMING\]
:   [Boucadair, M.]{.refAuthor}, [Reddy, T.]{.refAuthor}, and [W.
    Pan]{.refAuthor}, [\"Multi-homing Deployment Considerations for
    Distributed-Denial-of-Service Open Threat Signaling
    (DOTS)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-dots-multihoming-09]{.seriesInfo}, 2
    December 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-dots-multihoming-09>\>.
:   

\[DTLS13\]
:   [Rescorla, E.]{.refAuthor}, [Tschofenig, H.]{.refAuthor}, and [N.
    Modadugu]{.refAuthor}, [\"The Datagram Transport Layer Security
    (DTLS) Protocol Version 1.3\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-tls-dtls13-43]{.seriesInfo}, 30 April 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-tls-dtls13-43>\>.
:   

\[I2NSF-TERMS\]
:   [Hares, S.]{.refAuthor}, [Strassner, J.]{.refAuthor}, [Lopez, D.
    R.]{.refAuthor}, [Xia, L.]{.refAuthor}, and [H.
    Birkholz]{.refAuthor}, [\"Interface to Network Security Functions
    (I2NSF) Terminology\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-i2nsf-terminology-08]{.seriesInfo}, 5
    July 2019,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-i2nsf-terminology-08>\>.
:   

\[Key-Map\]
:   [IANA]{.refAuthor}, [\"DOTS Signal Channel CBOR Key
    Values\"]{.refTitle}, \<<https://www.iana.org/assignments/dots/>\>.
:   

\[RFC2663\]
:   [Srisuresh, P.]{.refAuthor} and [M. Holdrege]{.refAuthor}, [\"IP
    Network Address Translator (NAT) Terminology and
    Considerations\"]{.refTitle}, [RFC 2663]{.seriesInfo}, [DOI
    10.17487/RFC2663]{.seriesInfo}, August 1999,
    \<<https://www.rfc-editor.org/info/rfc2663>\>.
:   

\[RFC4340\]
:   [Kohler, E.]{.refAuthor}, [Handley, M.]{.refAuthor}, and [S.
    Floyd]{.refAuthor}, [\"Datagram Congestion Control Protocol
    (DCCP)\"]{.refTitle}, [RFC 4340]{.seriesInfo}, [DOI
    10.17487/RFC4340]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4340>\>.
:   

\[RFC4632\]
:   [Fuller, V.]{.refAuthor} and [T. Li]{.refAuthor}, [\"Classless
    Inter-domain Routing (CIDR): The Internet Address Assignment and
    Aggregation Plan\"]{.refTitle}, [BCP 122]{.seriesInfo}, [RFC
    4632]{.seriesInfo}, [DOI 10.17487/RFC4632]{.seriesInfo}, August
    2006, \<<https://www.rfc-editor.org/info/rfc4632>\>.
:   

\[RFC4732\]
:   [Handley, M., Ed.]{.refAuthor}, [Rescorla, E., Ed.]{.refAuthor}, and
    [IAB]{.refAuthor}, [\"Internet Denial-of-Service
    Considerations\"]{.refTitle}, [RFC 4732]{.seriesInfo}, [DOI
    10.17487/RFC4732]{.seriesInfo}, December 2006,
    \<<https://www.rfc-editor.org/info/rfc4732>\>.
:   

\[RFC4949\]
:   [Shirey, R.]{.refAuthor}, [\"Internet Security Glossary, Version
    2\"]{.refTitle}, [FYI 36]{.seriesInfo}, [RFC 4949]{.seriesInfo},
    [DOI 10.17487/RFC4949]{.seriesInfo}, August 2007,
    \<<https://www.rfc-editor.org/info/rfc4949>\>.
:   

\[RFC4960\]
:   [Stewart, R., Ed.]{.refAuthor}, [\"Stream Control Transmission
    Protocol\"]{.refTitle}, [RFC 4960]{.seriesInfo}, [DOI
    10.17487/RFC4960]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4960>\>.
:   

\[RFC6398\]
:   [Le Faucheur, F., Ed.]{.refAuthor}, [\"IP Router Alert
    Considerations and Usage\"]{.refTitle}, [BCP 168]{.seriesInfo}, [RFC
    6398]{.seriesInfo}, [DOI 10.17487/RFC6398]{.seriesInfo}, October
    2011, \<<https://www.rfc-editor.org/info/rfc6398>\>.
:   

\[RFC6973\]
:   [Cooper, A.]{.refAuthor}, [Tschofenig, H.]{.refAuthor},
    [Aboba, B.]{.refAuthor}, [Peterson, J.]{.refAuthor},
    [Morris, J.]{.refAuthor}, [Hansen, M.]{.refAuthor}, and [R.
    Smith]{.refAuthor}, [\"Privacy Considerations for Internet
    Protocols\"]{.refTitle}, [RFC 6973]{.seriesInfo}, [DOI
    10.17487/RFC6973]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6973>\>.
:   

\[RFC7011\]
:   [Claise, B., Ed.]{.refAuthor}, [Trammell, B., Ed.]{.refAuthor}, and
    [P. Aitken]{.refAuthor}, [\"Specification of the IP Flow Information
    Export (IPFIX) Protocol for the Exchange of Flow
    Information\"]{.refTitle}, [STD 77]{.seriesInfo}, [RFC
    7011]{.seriesInfo}, [DOI 10.17487/RFC7011]{.seriesInfo}, September
    2013, \<<https://www.rfc-editor.org/info/rfc7011>\>.
:   

\[RFC7596\]
:   [Cui, Y.]{.refAuthor}, [Sun, Q.]{.refAuthor},
    [Boucadair, M.]{.refAuthor}, [Tsou, T.]{.refAuthor},
    [Lee, Y.]{.refAuthor}, and [I. Farrer]{.refAuthor}, [\"Lightweight
    4over6: An Extension to the Dual-Stack Lite
    Architecture\"]{.refTitle}, [RFC 7596]{.seriesInfo}, [DOI
    10.17487/RFC7596]{.seriesInfo}, July 2015,
    \<<https://www.rfc-editor.org/info/rfc7596>\>.
:   

\[RFC7597\]
:   [Troan, O., Ed.]{.refAuthor}, [Dec, W.]{.refAuthor},
    [Li, X.]{.refAuthor}, [Bao, C.]{.refAuthor},
    [Matsushima, S.]{.refAuthor}, [Murakami, T.]{.refAuthor}, and [T.
    Taylor, Ed.]{.refAuthor}, [\"Mapping of Address and Port with
    Encapsulation (MAP-E)\"]{.refTitle}, [RFC 7597]{.seriesInfo}, [DOI
    10.17487/RFC7597]{.seriesInfo}, July 2015,
    \<<https://www.rfc-editor.org/info/rfc7597>\>.
:   

\[RFC8071\]
:   [Watsen, K.]{.refAuthor}, [\"NETCONF Call Home and RESTCONF Call
    Home\"]{.refTitle}, [RFC 8071]{.seriesInfo}, [DOI
    10.17487/RFC8071]{.seriesInfo}, February 2017,
    \<<https://www.rfc-editor.org/info/rfc8071>\>.
:   

\[RFC8340\]
:   [Bjorklund, M.]{.refAuthor} and [L. Berger, Ed.]{.refAuthor},
    [\"YANG Tree Diagrams\"]{.refTitle}, [BCP 215]{.seriesInfo}, [RFC
    8340]{.seriesInfo}, [DOI 10.17487/RFC8340]{.seriesInfo}, March 2018,
    \<<https://www.rfc-editor.org/info/rfc8340>\>.
:   

\[RFC8512\]
:   [Boucadair, M., Ed.]{.refAuthor}, [Sivakumar, S.]{.refAuthor},
    [Jacquenet, C.]{.refAuthor}, [Vinapamula, S.]{.refAuthor}, and [Q.
    Wu]{.refAuthor}, [\"A YANG Module for Network Address Translation
    (NAT) and Network Prefix Translation (NPT)\"]{.refTitle}, [RFC
    8512]{.seriesInfo}, [DOI 10.17487/RFC8512]{.seriesInfo}, January
    2019, \<<https://www.rfc-editor.org/info/rfc8512>\>.
:   

\[RFC8513\]
:   [Boucadair, M.]{.refAuthor}, [Jacquenet, C.]{.refAuthor}, and [S.
    Sivakumar]{.refAuthor}, [\"A YANG Data Model for Dual-Stack Lite
    (DS-Lite)\"]{.refTitle}, [RFC 8513]{.seriesInfo}, [DOI
    10.17487/RFC8513]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8513>\>.
:   

\[RFC8517\]
:   [Dolson, D., Ed.]{.refAuthor}, [Snellman, J.]{.refAuthor},
    [Boucadair, M., Ed.]{.refAuthor}, and [C. Jacquenet]{.refAuthor},
    [\"An Inventory of Transport-Centric Functions Provided by
    Middleboxes: An Operator Perspective\"]{.refTitle}, [RFC
    8517]{.seriesInfo}, [DOI 10.17487/RFC8517]{.seriesInfo}, February
    2019, \<<https://www.rfc-editor.org/info/rfc8517>\>.
:   

\[RFC8576\]
:   [Garcia-Morchon, O.]{.refAuthor}, [Kumar, S.]{.refAuthor}, and [M.
    Sethi]{.refAuthor}, [\"Internet of Things (IoT) Security: State of
    the Art and Challenges\"]{.refTitle}, [RFC 8576]{.seriesInfo}, [DOI
    10.17487/RFC8576]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8576>\>.
:   

\[RFC8612\]
:   [Mortensen, A.]{.refAuthor}, [Reddy, T.]{.refAuthor}, and [R.
    Moskowitz]{.refAuthor}, [\"DDoS Open Threat Signaling (DOTS)
    Requirements\"]{.refTitle}, [RFC 8612]{.seriesInfo}, [DOI
    10.17487/RFC8612]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8612>\>.
:   

\[RFC8811\]
:   [Mortensen, A., Ed.]{.refAuthor}, [Reddy.K, T., Ed.]{.refAuthor},
    [Andreasen, F.]{.refAuthor}, [Teague, N.]{.refAuthor}, and [R.
    Compton]{.refAuthor}, [\"DDoS Open Threat Signaling (DOTS)
    Architecture\"]{.refTitle}, [RFC 8811]{.seriesInfo}, [DOI
    10.17487/RFC8811]{.seriesInfo}, August 2020,
    \<<https://www.rfc-editor.org/info/rfc8811>\>.
:   

\[RFC8903\]
:   [Dobbins, R.]{.refAuthor}, [Migault, D.]{.refAuthor},
    [Moskowitz, R.]{.refAuthor}, [Teague, N.]{.refAuthor},
    [Xia, L.]{.refAuthor}, and [K. Nishizuka]{.refAuthor}, [\"Use Cases
    for DDoS Open Threat Signaling\"]{.refTitle}, [RFC
    8903]{.seriesInfo}, [DOI 10.17487/RFC8903]{.seriesInfo}, May 2021,
    \<<https://www.rfc-editor.org/info/rfc8903>\>.
:   

\[RFC8955\]
:   [Loibl, C.]{.refAuthor}, [Hares, S.]{.refAuthor},
    [Raszuk, R.]{.refAuthor}, [McPherson, D.]{.refAuthor}, and [M.
    Bacher]{.refAuthor}, [\"Dissemination of Flow Specification
    Rules\"]{.refTitle}, [RFC 8955]{.seriesInfo}, [DOI
    10.17487/RFC8955]{.seriesInfo}, December 2020,
    \<<https://www.rfc-editor.org/info/rfc8955>\>.
:   

\[RFC8956\]
:   [Loibl, C., Ed.]{.refAuthor}, [Raszuk, R., Ed.]{.refAuthor}, and [S.
    Hares, Ed.]{.refAuthor}, [\"Dissemination of Flow Specification
    Rules for IPv6\"]{.refTitle}, [RFC 8956]{.seriesInfo}, [DOI
    10.17487/RFC8956]{.seriesInfo}, December 2020,
    \<<https://www.rfc-editor.org/info/rfc8956>\>.
:   

\[RFC8973\]
:   [Boucadair, M.]{.refAuthor} and [T. Reddy.K]{.refAuthor}, [\"DDoS
    Open Threat Signaling (DOTS) Agent Discovery\"]{.refTitle}, [RFC
    8973]{.seriesInfo}, [DOI 10.17487/RFC8973]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8973>\>.
:   

\[RS\]
:   [RSnake]{.refAuthor}, [\"Slowloris HTTP DoS\"]{.refTitle},
    \<<https://web.archive.org/web/20150315054838/http://ha.ckers.org/slowloris/>\>.
:   

\[Sec-by-design\]
:   [UK Department for Digital, Culture, Media & Sport]{.refAuthor},
    [\"Secure by Design: Improving the cyber security of consumer
    Internet of Things Report\"]{.refTitle}, March 2018,
    \<<https://www.gov.uk/government/publications/secure-by-design-report>\>.
:   
:::
:::

::: {#home}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Some Home Network Issues](#name-some-home-network-issues){.section-name .selfRef} {#name-some-home-network-issues}

Internet of Things (IoT) devices are becoming more and more prevalent,
in particular in home networks. With compute and memory becoming cheaper
and cheaper, various types of IoT devices become available in the
consumer market at affordable prices. But on the downside, there is a
corresponding threat since most of these IoT devices are bought
off-the-shelf and most manufacturers haven\'t considered security in the
product design (e.g., \[[Sec-by-design](#Sec-by-design){.xref}\]). IoT
devices deployed in home networks can be easily compromised, they often
do not have an easy mechanism to upgrade, and even when upgradable, IoT
manufacturers may cease manufacture and/or discontinue patching
vulnerabilities on IoT devices (Sections
[5.4](https://www.rfc-editor.org/rfc/rfc8576#section-5.4){.relref} and
[5.5](https://www.rfc-editor.org/rfc/rfc8576#section-5.5){.relref} of
\[[RFC8576](#RFC8576){.xref}\]). These vulnerable and compromised
devices will continue to be used for a long period of time in the home,
and the end-user does not know that IoT devices in his/her home are
compromised. The compromised IoT devices are typically used for
launching DDoS attacks ([Section
3](https://www.rfc-editor.org/rfc/rfc8576#section-3){.relref} of
\[[RFC8576](#RFC8576){.xref}\]) on victims while the owner/administrator
of the home network is not aware about such misbehaviors. Similar to
other DDoS attacks, the victim in this attack can be an application
server, a host, a router, a firewall, or an entire network. Such
misbehaviors can cause collateral damage that will affect end users, and
can also harm the reputation of an Internet Service Provider (ISP) for
being a source of attack traffic.[¶](#appendix-A-1){.pilcrow}

Nowadays, network devices in a home network can offer network security
functions (e.g., firewall \[[RFC4949](#RFC4949){.xref}\] or Intrusion
Protection System (IPS) service
\[[I2NSF-TERMS](#I-D.ietf-i2nsf-terminology){.xref}\] on a home router)
to protect the devices connected to the home network from both external
and internal attacks. It is natural to seek to provide DDoS defense in
these devices as well, and over the years several techniques have been
identified to detect DDoS attacks; some of these techniques can be
enabled on home network devices but most of them are used within the
ISP\'s network.[¶](#appendix-A-2){.pilcrow}

Some of the DDoS attacks like spoofed RST or FIN packets, Slowloris
\[[RS](#RS){.xref}\], and Transport Layer Security (TLS) renegotiation
are difficult to detect on a home network device without adversely
affecting its performance. The reason is that typically home devices
such as home routers have fast path to boost the throughput. For every
new TCP/UDP flow, only the first few packets are punted through the slow
path. Hence, it is not possible to detect various DDoS attacks in the
slow path, since the attack payload is sent to the target server after
the flow is switched to fast path. The reader may refer to [Section
2](https://www.rfc-editor.org/rfc/rfc6398#section-2){.relref} of
\[[RFC6398](#RFC6398){.xref}\] for a brief definition of slow and fast
paths.[¶](#appendix-A-3){.pilcrow}

Deep Packet Inspection (DPI) of all the packets of a flow would be able
to detect some of the attacks. However, a full-fledged DPI to detect
these type of DDoS attacks is functionally or operationally not possible
for all the devices attached to the home network because of the memory
and CPU limitations of the home routers. Furthermore, for certain DDoS
attacks the logic needed to distinguish legitimate traffic from attack
traffic on a per-packet basis is complex. This complexity is because
that the packet itself may look \"legitimate\" and no attack signature
can be identified. The anomaly can be identified only after detailed
statistical analysis. In addition, network security services in home
networks may not be able to detect all types of DDoS attacks using DPI.
ISPs offering DDoS mitigation services have a DDoS detection capability
that relies upon anomaly detection to identify zero day DDoS attacks and
to detect DDoS attacks that cannot be detected using signatures and
rate-limit techniques.[¶](#appendix-A-4){.pilcrow}

ISPs can detect some DDoS attacks originating from a home network (e.g.,
[Section
2.6](https://www.rfc-editor.org/rfc/rfc8517#section-2.6){.relref} of
\[[RFC8517](#RFC8517){.xref}\]), but the ISP usually does not have a
mechanism to detect which device in the home network is generating the
DDoS attack traffic. The primary reason for this is that devices in an
IPv4 home network are typically behind a Network Address Translation
(NAT) border \[[RFC2663](#RFC2663){.xref}\]. Even in case of an IPv6
home network, although the ISP can identify the infected device in the
home network launching the DDoS traffic by tracking its unique IPv6
address, the infected device can easily change its IPv6 address to evade
remediation. A security function on the local home network is better
positioned to track the compromised device across IPv6 address (and
potentially even MAC address) changes and thus ensure that remediation
remains in place across such events.[¶](#appendix-A-5){.pilcrow}
:::
:::

::: {#app}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [Disambiguating Base DOTS Signal vs. DOTS Call Home](#name-disambiguating-base-dots-si){.section-name .selfRef} {#name-disambiguating-base-dots-si}

With the DOTS signal channel Call Home, there is a chance that two DOTS
agents can simultaneously establish two DOTS signal channels with
different directions (base DOTS signal channel and DOTS signal channel
Call Home). Here is one example drawn from the home network.
Nevertheless, the outcome of the discussion is not specific to these
networks, but applies to any DOTS Call Home
scenario.[¶](#appendix-B-1){.pilcrow}

In the Call Home scenario, the Call Home DOTS server in, for example,
the home network can mitigate the DDoS attacks launched by the
compromised device in its domain by receiving the mitigation request
sent by the Call Home DOTS client in the ISP environment. In addition,
the DOTS client in the home network can initiate a mitigation request to
the DOTS server in the ISP environment to ask for help when the home
network is under a DDoS attack. Such Call Home DOTS server and DOTS
client in the home network can co-locate in the same home network
element (e.g., the Customer Premises Equipment). In this case, with the
same peer at the same time the home network element will have the base
DOTS signal channel defined in \[[RFC9132](#RFC9132){.xref}\] and the
DOTS signal channel Call Home defined in this specification. Thus, these
two signal channels need to be distinguished when they are both
supported. Two approaches have been considered for distinguishing the
two DOTS signal channels, but only the one that using the dedicated port
number has been chosen as the best choice.[¶](#appendix-B-2){.pilcrow}

By using a dedicated port number for each, these two signal channels can
be separated unambiguously and easily. For example, the CPE uses the
port number 4646 allocated in \[[RFC9132](#RFC9132){.xref}\] to initiate
the basic signal channel to the ISP when it acts as the DOTS client, and
uses another port number to initiate the signal channel Call Home. Based
on the different port numbers, the ISP can directly decide which kind of
procedures should follow immediately after it receives the DOTS
messages. This approach just requires two (D)TLS sessions to be
established respectively for the basic signal channel and signal channel
Call Home.[¶](#appendix-B-3){.pilcrow}

The other approach is signaling the role of each DOTS agent (e.g., by
using the DOTS data channel as depicted in [Figure 14](#data){.xref}).
For example, the DOTS agent in the home network first initiates a DOTS
data channel to the peer DOTS agent in the ISP environment, at this time
the DOTS agent in the home network is the DOTS client and the peer DOTS
agent in the ISP environment is the DOTS server. After that, the DOTS
agent in the home network retrieves the DOTS Call Home capability of the
peer DOTS agent. If the peer supports the DOTS Call Home, the DOTS agent
needs to subscribe to the peer to use this extension. Then, the reversal
of DOTS role can be recognized as done by both DOTS agents. When the
DOTS agent in the ISP environment, which now is the DOTS client, wants
to filter the attackers\' traffic, it requests the DOTS agent in the
home network, which now is the DOTS server, for
help.[¶](#appendix-B-4){.pilcrow}

[]{#name-example-of-dots-data-channe}

::: {#data}
::: {#appendix-B-5.1}
``` {.lang-yangtree .sourcecode}
  augment /ietf-data:dots-data/ietf-data:capabilities:
      +--ro call-home-support?   boolean
    augment /ietf-data:dots-data/ietf-data:dots-client:
      +--rw call-home-enable?   boolean
```
:::

[Figure 14](#figure-14){.selfRef}: [Example of DOTS Data Channel
Augmentation](#name-example-of-dots-data-channe){.selfRef}
:::

Signaling the role will complicate the DOTS protocols, and this
complexity is not required in context where the DOTS Call Home is not
required or only when the DOTS Call Home is needed. Besides, the DOTS
data channel may not work during attack time. Even if changing the above
example from using the DOTS data channel to the DOTS signal channel, the
more procedures will still reduce the efficiency. Using the dedicated
port number is much easier and more concise compared to the second
approach, and its cost that establishing two (D)TLS sessions is much
less. So, using a dedicated port number for the DOTS Call Home is
recommended in this specification. The dedicated port number can be
configured locally or discovered using means such as
\[[RFC8973](#RFC8973){.xref}\].[¶](#appendix-B-6){.pilcrow}
:::
:::

::: {#ack}
::: {#appendix-C .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to [Wei Pei]{.contact-name}, [Xia Liang]{.contact-name}, [Roman
Danyliw]{.contact-name}, [Dan Wing]{.contact-name}, [Toema
Gavrichenkov]{.contact-name}, [Daniel Migault]{.contact-name}, [Sean
Turner]{.contact-name}, and [Valery Smyslov]{.contact-name} for the
comments.[¶](#appendix-C-1){.pilcrow}

[Benjamin Kaduk]{.contact-name}\'s AD review is valuable. Many thanks to
him for the detailed review.[¶](#appendix-C-2){.pilcrow}

Thanks to [Radia Perlman]{.contact-name} and [David
Schinazi]{.contact-name} for the directorate
reviews.[¶](#appendix-C-3){.pilcrow}

Thanks to [Ebben Aries]{.contact-name} for the YANG Doctors
review.[¶](#appendix-C-4){.pilcrow}

Thanks to [Éric Vyncke]{.contact-name}, [Roman Danyliw]{.contact-name},
[Barry Leiba]{.contact-name}, [Robert Wilton]{.contact-name}, and [Erik
Kline]{.contact-name} for the IESG review.[¶](#appendix-C-5){.pilcrow}
:::
:::

::: {#contr}
::: {#appendix-D .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The following individuals have contributed to this
document:[¶](#appendix-D-1){.pilcrow}

::: {.left dir="auto"}
[Joshi Harsha]{.fn .nameRole}
:::

::: {.left dir="auto"}
[McAfee, Inc.]{.org}
:::

::: {.left dir="auto"}
[Embassy Golf Link Business Park]{.street-address}
:::

::: {.left dir="auto"}
[Bangalore]{.locality} [560071]{.postal-code}
:::

::: {.left dir="auto"}
[Karnataka]{.region}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <harsha_joshi@mcafee.com>
:::

::: {.left dir="auto"}
[Wei Pan]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <william.panwei@huawei.com>
:::
:::
:::

::: {#authors-addresses}
::: {#appendix-E .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Tirumaleswar Reddy.K]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Akamai]{.org}
:::

::: {.left dir="auto"}
[Embassy Golf Link Business Park]{.street-address}
:::

::: {.left dir="auto"}
[Bangalore]{.locality} [560071]{.postal-code}
:::

::: {.left dir="auto"}
[Karnataka]{.region}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <kondtir@gmail.com>
:::

::: {.left dir="auto"}
[Mohamed Boucadair ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Orange]{.org}
:::

::: {.left dir="auto"}
[35000]{.postal-code} [Rennes]{.locality}
:::

::: {.left dir="auto"}
[France]{.country-name}
:::

::: email
Email: <mohamed.boucadair@orange.com>
:::

::: {.left dir="auto"}
[Jon Shallow]{.fn .nameRole}
:::

::: {.left dir="auto"}
[United Kingdom]{.country-name}
:::

::: email
Email: <supjps-ietf@jpshallow.com>
:::
:::
:::
