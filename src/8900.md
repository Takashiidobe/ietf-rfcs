  RFC 8900         IP Fragmentation Fragile   September 2020
  ---------------- -------------------------- ----------------
  Bonica, et al.   Best Current Practice      \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8900](https://www.rfc-editor.org/rfc/rfc8900){.eref}

BCP:
:   230

Category:
:   Best Current Practice

Published:
:   September 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    R. Bonica
    :::

    ::: org
    Juniper Networks
    :::
    :::

    ::: author
    ::: author-name
    F. Baker
    :::

    ::: org
    Unaffiliated
    :::
    :::

    ::: author
    ::: author-name
    G. Huston
    :::

    ::: org
    APNIC
    :::
    :::

    ::: author
    ::: author-name
    R. Hinden
    :::

    ::: org
    Check Point Software
    :::
    :::

    ::: author
    ::: author-name
    O. Troan
    :::

    ::: org
    Cisco
    :::
    :::

    ::: author
    ::: author-name
    F. Gont
    :::

    ::: org
    SI6 Networks
    :::
    :::
:::

# RFC 8900 {#rfcnum}

# IP Fragmentation Considered Fragile {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes IP fragmentation and explains how it introduces
fragility to Internet communication.[¶](#section-abstract-1){.pilcrow}

This document also proposes alternatives to IP fragmentation and
provides recommendations for developers and network
operators.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This memo documents an Internet Best Current
Practice.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on BCPs
is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8900>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [IP
    Fragmentation](#name-ip-fragmentation){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Links, Paths, MTU, and
        PMTU](#name-links-paths-mtu-and-pmtu){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Fragmentation
        Procedures](#name-fragmentation-procedures){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Upper-Layer Reliance on IP
        Fragmentation](#name-upper-layer-reliance-on-ip-){.xref}[¶](#section-toc.1-1.2.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Increased
    Fragility](#name-increased-fragility){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Virtual
        Reassembly](#name-virtual-reassembly){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Policy-Based
        Routing](#name-policy-based-routing){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Network Address Translation
        (NAT)](#name-network-address-translation){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Stateless
        Firewalls](#name-stateless-firewalls){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Equal-Cost Multipath, Link
        Aggregate Groups, and Stateless Load
        Balancers](#name-equal-cost-multipath-link-a){.xref}[¶](#section-toc.1-1.3.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [IPv4 Reassembly Errors at High
        Data
        Rates](#name-ipv4-reassembly-errors-at-h){.xref}[¶](#section-toc.1-1.3.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Security
        Vulnerabilities](#name-security-vulnerabilities){.xref}[¶](#section-toc.1-1.3.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.8}
        [3.8](#section-3.8){.xref}.  [PMTU Black-Holing Due to ICMP
        Loss](#name-pmtu-black-holing-due-to-ic){.xref}[¶](#section-toc.1-1.3.2.8.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.8.2.1}
            [3.8.1](#section-3.8.1){.xref}.  [Transient
            Loss](#name-transient-loss){.xref}[¶](#section-toc.1-1.3.2.8.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.2}
            [3.8.2](#section-3.8.2){.xref}.  [Incorrect Implementation
            of Security
            Policy](#name-incorrect-implementation-of){.xref}[¶](#section-toc.1-1.3.2.8.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.3}
            [3.8.3](#section-3.8.3){.xref}.  [Persistent Loss Caused by
            Anycast](#name-persistent-loss-caused-by-a){.xref}[¶](#section-toc.1-1.3.2.8.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.4}
            [3.8.4](#section-3.8.4){.xref}.  [Persistent Loss Caused by
            Unidirectional
            Routing](#name-persistent-loss-caused-by-u){.xref}[¶](#section-toc.1-1.3.2.8.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.9}
        [3.9](#section-3.9){.xref}.  [Black-Holing Due to Filtering or
        Loss](#name-black-holing-due-to-filteri){.xref}[¶](#section-toc.1-1.3.2.9.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Alternatives to IP
    Fragmentation](#name-alternatives-to-ip-fragment){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Transport-Layer
        Solutions](#name-transport-layer-solutions){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Application-Layer
        Solutions](#name-application-layer-solutions){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Applications That Rely on IPv6
    Fragmentation](#name-applications-that-rely-on-i){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Domain Name Service
        (DNS)](#name-domain-name-service-dns){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Open Shortest Path First
        (OSPF)](#name-open-shortest-path-first-os){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Packet-in-Packet
        Encapsulations](#name-packet-in-packet-encapsulat){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [UDP Applications Enhancing
        Performance](#name-udp-applications-enhancing-){.xref}[¶](#section-toc.1-1.5.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Recommendations](#name-recommendations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [For Application and Protocol
        Developers](#name-for-application-and-protoco){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [For System
        Developers](#name-for-system-developers){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [For Middlebox
        Developers](#name-for-middlebox-developers){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [For ECMP, LAG, and Load-Balancer
        Developers And
        Operators](#name-for-ecmp-lag-and-load-balan){.xref}[¶](#section-toc.1-1.6.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [For Network
        Operators](#name-for-network-operators){.xref}[¶](#section-toc.1-1.6.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

Operational experience \[[Kent](#Kent){.xref}\]
\[[Huston](#Huston){.xref}\] \[[RFC7872](#RFC7872){.xref}\] reveals that
IP fragmentation introduces fragility to Internet communication. This
document describes IP fragmentation and explains the fragility it
introduces. It also proposes alternatives to IP fragmentation and
provides recommendations for developers and network
operators.[¶](#section-1-1){.pilcrow}

While this document identifies issues associated with IP fragmentation,
it does not recommend deprecation. Legacy protocols that depend upon IP
fragmentation would do well to be updated to remove that dependency.
However, some applications and environments (see [Section
5](#rely){.xref}) require IP fragmentation. In these cases, the protocol
will continue to rely on IP fragmentation, but the designer should be
aware that fragmented packets may result in black holes. A design should
include appropriate safeguards.[¶](#section-1-2){.pilcrow}

Rather than deprecating IP fragmentation, this document recommends that
upper-layer protocols address the problem of fragmentation at their
layer, reducing their reliance on IP fragmentation to the greatest
degree possible.[¶](#section-1-3){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [IP Fragmentation](#name-ip-fragmentation){.section-name .selfRef} {#name-ip-fragmentation}

::: {#pmtu}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Links, Paths, MTU, and PMTU](#name-links-paths-mtu-and-pmtu){.section-name .selfRef} {#name-links-paths-mtu-and-pmtu}

An Internet path connects a source node to a destination node. A path
may contain links and routers. If a path contains more than one link,
the links are connected in series, and a router connects each link to
the next.[¶](#section-2.1-1){.pilcrow}

Internet paths are dynamic. Assume that the path from one node to
another contains a set of links and routers. If a link or a router
fails, the path can also change so that it includes a different set of
links and routers.[¶](#section-2.1-2){.pilcrow}

Each link is constrained by the number of octets that it can convey in a
single IP packet. This constraint is called the link Maximum
Transmission Unit (MTU). [IPv4](#RFC0791){.xref}
\[[RFC0791](#RFC0791){.xref}\] requires every link to support an MTU of
68 octets or greater (see [NOTE 1](#note-1){.xref}).
[IPv6](#RFC8200){.xref} \[[RFC8200](#RFC8200){.xref}\] similarly
requires every link to support an MTU of 1280 octets or greater. These
are called the IPv4 and IPv6 minimum link
MTUs.[¶](#section-2.1-3){.pilcrow}

Some links, and some ways of using links, result in additional variable
overhead. For the simple case of tunnels, this document defers to other
documents. For other cases, such as MPLS, this document considers the
link MTU to include appropriate allowance for any such
overhead.[¶](#section-2.1-4){.pilcrow}

Likewise, each Internet path is constrained by the number of octets that
it can convey in a single IP packet. This constraint is called the Path
MTU (PMTU). For any given path, the PMTU is equal to the smallest of its
link MTUs. Because Internet paths are dynamic, PMTU is also
dynamic.[¶](#section-2.1-5){.pilcrow}

For reasons described below, source nodes estimate the PMTU between
themselves and destination nodes. A source node can produce extremely
conservative PMTU estimates in which:[¶](#section-2.1-6){.pilcrow}

-   [The estimate for each IPv4 path is equal to the IPv4 minimum link
    MTU.[¶](#section-2.1-7.1){.pilcrow}]{#section-2.1-7.1}
-   [The estimate for each IPv6 path is equal to the IPv6 minimum link
    MTU.[¶](#section-2.1-7.2){.pilcrow}]{#section-2.1-7.2}

While these conservative estimates are guaranteed to be less than or
equal to the actual PMTU, they are likely to be much less than the
actual PMTU. This may adversely affect upper-layer protocol
performance.[¶](#section-2.1-8){.pilcrow}

By executing Path MTU Discovery (PMTUD) procedures
\[[RFC1191](#RFC1191){.xref}\] \[[RFC8201](#RFC8201){.xref}\], a source
node can maintain a less conservative estimate of the PMTU between
itself and a destination node. In PMTUD, the source node produces an
initial PMTU estimate. This initial estimate is equal to the MTU of the
first link along the path to the destination node. It can be greater
than the actual PMTU.[¶](#section-2.1-9){.pilcrow}

Having produced an initial PMTU estimate, the source node sends
non-fragmentable IP packets to the destination node (see [NOTE
2](#note-2){.xref}). If one of these packets is larger than the actual
PMTU, a downstream router will not be able to forward the packet through
the next link along the path. Therefore, the downstream router drops the
packet and sends an Internet Control Message Protocol (ICMP)
\[[RFC0792](#RFC0792){.xref}\] \[[RFC4443](#RFC4443){.xref}\] Packet Too
Big (PTB) message to the source node (see [NOTE 3](#note-3){.xref}). The
ICMP PTB message indicates the MTU of the link through which the packet
could not be forwarded. The source node uses this information to refine
its PMTU estimate.[¶](#section-2.1-10){.pilcrow}

PMTUD produces a running estimate of the PMTU between a source node and
a destination node. Because PMTU is dynamic, the PMTU estimate can be
larger than the actual PMTU. In order to detect PMTU increases, PMTUD
occasionally resets the PMTU estimate to its initial value and repeats
the procedure described above.[¶](#section-2.1-11){.pilcrow}

Ideally, PMTUD operates as described above. However, in some scenarios,
PMTUD fails. For example:[¶](#section-2.1-12){.pilcrow}

-   [PMTUD relies on the network\'s ability to deliver ICMP PTB messages
    to the source node. If the network cannot deliver ICMP PTB messages
    to the source node, PMTUD
    fails.[¶](#section-2.1-13.1){.pilcrow}]{#section-2.1-13.1}
-   [PMTUD is susceptible to attack because ICMP messages are easily
    [forged](#RFC5927){.xref} \[[RFC5927](#RFC5927){.xref}\] and not
    authenticated by the receiver. Such attacks can cause PMTUD to
    produce unnecessarily conservative PMTU
    estimates.[¶](#section-2.1-13.2){.pilcrow}]{#section-2.1-13.2}

[]{.break}

::: {#note-1}
NOTE 1:
:::

In IPv4, every host must be able to reassemble a packet whose length is
less than or equal to 576 octets. However, the IPv4 minimum link MTU is
not 576. Section
[3.2](https://www.rfc-editor.org/rfc/rfc791#section-3.2){.relref} of
[RFC 791](#RFC0791){.xref} \[[RFC0791](#RFC0791){.xref}\] explicitly
states that the IPv4 minimum link MTU is 68
octets.[¶](#section-2.1-14.2){.pilcrow}

::: {#note-2}
NOTE 2:
:::

A non-fragmentable packet can be fragmented at its source. However, it
cannot be fragmented by a downstream node. An IPv4 packet whose Don\'t
Fragment (DF) bit is set to 0 is fragmentable. An IPv4 packet whose DF
bit is set to 1 is non-fragmentable. All IPv6 packets are also
non-fragmentable.[¶](#section-2.1-14.4){.pilcrow}

::: {#note-3}
NOTE 3:
:::

The ICMP PTB message has two instantiations. In
[ICMPv4](#RFC0792){.xref} \[[RFC0792](#RFC0792){.xref}\], the ICMP PTB
message is a Destination Unreachable message with Code equal to 4
(fragmentation needed and DF set). This message was augmented by
\[[RFC1191](#RFC1191){.xref}\] to indicate the MTU of the link through
which the packet could not be forwarded. In [ICMPv6](#RFC4443){.xref}
\[[RFC4443](#RFC4443){.xref}\], the ICMP PTB message is a Packet Too Big
Message with Code equal to 0. This message also indicates the MTU of the
link through which the packet could not be
forwarded.[¶](#section-2.1-14.6){.pilcrow}
:::
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Fragmentation Procedures](#name-fragmentation-procedures){.section-name .selfRef} {#name-fragmentation-procedures}

When an upper-layer protocol submits data to the underlying IP module,
and the resulting IP packet\'s length is greater than the PMTU, the
packet is divided into fragments. Each fragment includes an IP header
and a portion of the original packet.[¶](#section-2.2-1){.pilcrow}

\[[RFC0791](#RFC0791){.xref}\] describes IPv4 fragmentation procedures.
An IPv4 packet whose DF bit is set to 1 may be fragmented by the source
node, but may not be fragmented by a downstream router. An IPv4 packet
whose DF bit is set to 0 may be fragmented by the source node or by a
downstream router. When an IPv4 packet is fragmented, all IP options
(which are within the IPv4 header) appear in the first fragment, but
only options whose \"copy\" bit is set to 1 appear in subsequent
fragments.[¶](#section-2.2-2){.pilcrow}

\[[RFC8200](#RFC8200){.xref}\], notably in Section
[4.5](https://www.rfc-editor.org/rfc/rfc8200#section-4.5){.relref},
describes IPv6 fragmentation procedures. An IPv6 packet may be
fragmented only at the source node. When an IPv6 packet is fragmented,
all extension headers appear in the first fragment, but only
per-fragment headers appear in subsequent fragments. Per-fragment
headers include the following:[¶](#section-2.2-3){.pilcrow}

-   [The IPv6 header.[¶](#section-2.2-4.1){.pilcrow}]{#section-2.2-4.1}
-   [The Hop-by-Hop Options header (if
    present).[¶](#section-2.2-4.2){.pilcrow}]{#section-2.2-4.2}
-   [The Destination Options header (if present and if it precedes a
    Routing header).[¶](#section-2.2-4.3){.pilcrow}]{#section-2.2-4.3}
-   [The Routing header (if
    present).[¶](#section-2.2-4.4){.pilcrow}]{#section-2.2-4.4}
-   [The Fragment
    header.[¶](#section-2.2-4.5){.pilcrow}]{#section-2.2-4.5}

In IPv4, the upper-layer header usually appears in the first fragment,
due to the sizes of the headers involved. In IPv6, the upper-layer
header must appear in the first fragment.[¶](#section-2.2-5){.pilcrow}
:::

::: {#upper}
::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Upper-Layer Reliance on IP Fragmentation](#name-upper-layer-reliance-on-ip-){.section-name .selfRef} {#name-upper-layer-reliance-on-ip-}

Upper-layer protocols can operate in the following
modes:[¶](#section-2.3-1){.pilcrow}

-   [Do not rely on IP
    fragmentation.[¶](#section-2.3-2.1){.pilcrow}]{#section-2.3-2.1}
-   [Rely on IP fragmentation by the source node
    only.[¶](#section-2.3-2.2){.pilcrow}]{#section-2.3-2.2}
-   [Rely on IP fragmentation by any
    node.[¶](#section-2.3-2.3){.pilcrow}]{#section-2.3-2.3}

Upper-layer protocols running over IPv4 can operate in all of the
above-mentioned modes. Upper-layer protocols running over IPv6 can
operate in the first and second modes only.[¶](#section-2.3-3){.pilcrow}

Upper-layer protocols that operate in the first two modes (above)
require access to the PMTU estimate. In order to fulfill this
requirement, they can:[¶](#section-2.3-4){.pilcrow}

-   [Estimate the PMTU to be equal to the IPv4 or IPv6 minimum link
    MTU.[¶](#section-2.3-5.1){.pilcrow}]{#section-2.3-5.1}
-   [Access the estimate that PMTUD
    produced.[¶](#section-2.3-5.2){.pilcrow}]{#section-2.3-5.2}
-   [Execute PMTUD procedures
    themselves.[¶](#section-2.3-5.3){.pilcrow}]{#section-2.3-5.3}
-   [Execute Packetization Layer PMTUD (PLPMTUD) procedures
    \[[RFC4821](#RFC4821){.xref}\]
    \[[RFC8899](#RFC8899){.xref}\].[¶](#section-2.3-5.4){.pilcrow}]{#section-2.3-5.4}

According to PLPMTUD procedures, the upper-layer protocol maintains a
running PMTU estimate. It does so by sending probe packets of various
sizes to its upper-layer peer and receiving acknowledgements. This
strategy differs from PMTUD in that it relies on acknowledgement of
received messages, as opposed to ICMP PTB messages concerning dropped
messages. Therefore, PLPMTUD does not rely on the network\'s ability to
deliver ICMP PTB messages to the source.[¶](#section-2.3-6){.pilcrow}
:::
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Increased Fragility](#name-increased-fragility){.section-name .selfRef} {#name-increased-fragility}

This section explains how IP fragmentation introduces fragility to
Internet communication.[¶](#section-3-1){.pilcrow}

::: {#virtualreassembly}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Virtual Reassembly](#name-virtual-reassembly){.section-name .selfRef} {#name-virtual-reassembly}

Virtual reassembly is a procedure in which a device conceptually
reassembles a packet, forwards its fragments, and discards the
reassembled copy. In [Address plus Port (A+P)](#RFC6346){.xref}
\[[RFC6346](#RFC6346){.xref}\] and [Carrier Grade NAT
(CGN)](#RFC6888){.xref} \[[RFC6888](#RFC6888){.xref}\], virtual
reassembly is required in order to correctly translate fragment
addresses. It could be useful to address the problems in Sections
[3.2](#mb){.xref}, [3.3](#nat){.xref}, [3.4](#statelessfirewall){.xref},
and [3.5](#ecmp){.xref}.[¶](#section-3.1-1){.pilcrow}

Virtual reassembly is computationally expensive and holds state for
indeterminate periods of time. Therefore, it is prone to errors and
[attacks](#at){.xref} ([Section
3.7](#at){.xref}).[¶](#section-3.1-2){.pilcrow}
:::
:::

::: {#mb}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Policy-Based Routing](#name-policy-based-routing){.section-name .selfRef} {#name-policy-based-routing}

IP fragmentation causes problems for routers that implement policy-based
routing.[¶](#section-3.2-1){.pilcrow}

When a router receives a packet, it identifies the next hop on route to
the packet\'s destination and forwards the packet to that next hop. In
order to identify the next hop, the router interrogates a local data
structure called the Forwarding Information Base
(FIB).[¶](#section-3.2-2){.pilcrow}

Normally, the FIB contains destination-based entries that map a
destination prefix to a next hop. Policy-based routing allows
destination-based and policy-based entries to coexist in the same FIB. A
policy-based FIB entry maps multiple fields, drawn from either the IP or
transport-layer header, to a next hop.[¶](#section-3.2-3){.pilcrow}

[]{#name-policy-based-routing-fib}

::: {#FIB}
  Entry   Type                Dest. Prefix      Next Hdr / Dest. Port   Next Hop
  ------- ------------------- ----------------- ----------------------- ---------------
  1       Destination-based   2001:db8::1/128   Any / Any               2001:db8:2::2
  2       Policy-based        2001:db8::1/128   TCP / 80                2001:db8:3::3

  : [Table 1](#table-1){.selfRef}: [Policy-Based Routing
  FIB](#name-policy-based-routing-fib){.selfRef}
:::

Assume that a router maintains the FIB in [Table 1](#FIB){.xref}. The
first FIB entry is destination-based. It maps a destination prefix
2001:db8::1/128 to a next hop 2001:db8:2::2. The second FIB entry is
policy-based. It maps the same destination prefix 2001:db8::1/128 and a
destination port (TCP / 80) to a different next hop (2001:db8:3::3). The
second entry is more specific than the
first.[¶](#section-3.2-6){.pilcrow}

When the router receives the first fragment of a packet that is destined
for TCP port 80 on 2001:db8::1, it interrogates the FIB. Both FIB
entries satisfy the query. The router selects the second FIB entry
because it is more specific and forwards the packet to
2001:db8:3::3.[¶](#section-3.2-7){.pilcrow}

When the router receives the second fragment of the packet, it
interrogates the FIB again. This time, only the first FIB entry
satisfies the query, because the second fragment contains no indication
that the packet is destined for TCP port 80. Therefore, the router
selects the first FIB entry and forwards the packet to
2001:db8:2::2.[¶](#section-3.2-8){.pilcrow}

Policy-based routing is also known as filter-based
forwarding.[¶](#section-3.2-9){.pilcrow}
:::
:::

::: {#nat}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Network Address Translation (NAT)](#name-network-address-translation){.section-name .selfRef} {#name-network-address-translation}

IP fragmentation causes problems for Network Address Translation (NAT)
devices. When a NAT device detects a new, outbound flow, it maps that
flow\'s source port and IP address to another source port and IP
address. Having created that mapping, the NAT device
translates:[¶](#section-3.3-1){.pilcrow}

-   [The source IP address and source port on each outbound
    packet.[¶](#section-3.3-2.1){.pilcrow}]{#section-3.3-2.1}
-   [The destination IP address and destination port on each inbound
    packet.[¶](#section-3.3-2.2){.pilcrow}]{#section-3.3-2.2}

[A+P](#RFC6346){.xref} \[[RFC6346](#RFC6346){.xref}\] and [Carrier Grade
NAT (CGN)](#RFC6888){.xref} \[[RFC6888](#RFC6888){.xref}\] are two
common NAT strategies. In both approaches, the NAT device must virtually
reassemble fragmented packets in order to translate and forward each
fragment.[¶](#section-3.3-4){.pilcrow}
:::
:::

::: {#statelessfirewall}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Stateless Firewalls](#name-stateless-firewalls){.section-name .selfRef} {#name-stateless-firewalls}

As discussed in more detail in [Section 3.7](#at){.xref}, IP
fragmentation causes problems for stateless firewalls whose rules
include TCP and UDP ports. Because port information is only available in
the first fragment and not available in the subsequent fragments, the
firewall is limited to the following
options:[¶](#section-3.4-1){.pilcrow}

-   [Accept all subsequent fragments, possibly admitting certain classes
    of attack.[¶](#section-3.4-2.1){.pilcrow}]{#section-3.4-2.1}
-   [Block all subsequent fragments, possibly blocking legitimate
    traffic.[¶](#section-3.4-2.2){.pilcrow}]{#section-3.4-2.2}

Neither option is attractive.[¶](#section-3.4-3){.pilcrow}
:::
:::

::: {#ecmp}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Equal-Cost Multipath, Link Aggregate Groups, and Stateless Load Balancers](#name-equal-cost-multipath-link-a){.section-name .selfRef} {#name-equal-cost-multipath-link-a}

IP fragmentation causes problems for Equal-Cost Multipath (ECMP), Link
Aggregate Groups (LAG), and other stateless load-distribution
technologies. In order to assign a packet or packet fragment to a link,
an intermediate node executes a hash (i.e., load-distributing)
algorithm. The following paragraphs describe a commonly deployed hash
algorithm.[¶](#section-3.5-1){.pilcrow}

If the packet or packet fragment contains a transport-layer header, the
algorithm accepts the following 5-tuple as
input:[¶](#section-3.5-2){.pilcrow}

-   [IP Source
    Address.[¶](#section-3.5-3.1){.pilcrow}]{#section-3.5-3.1}
-   [IP Destination
    Address.[¶](#section-3.5-3.2){.pilcrow}]{#section-3.5-3.2}
-   [IPv4 Protocol or IPv6 Next
    Header.[¶](#section-3.5-3.3){.pilcrow}]{#section-3.5-3.3}
-   [transport-layer source
    port.[¶](#section-3.5-3.4){.pilcrow}]{#section-3.5-3.4}
-   [transport-layer destination
    port.[¶](#section-3.5-3.5){.pilcrow}]{#section-3.5-3.5}

If the packet or packet fragment does not contain a transport-layer
header, the algorithm accepts only the following 3-tuple as
input:[¶](#section-3.5-4){.pilcrow}

-   [IP Source
    Address.[¶](#section-3.5-5.1){.pilcrow}]{#section-3.5-5.1}
-   [IP Destination
    Address.[¶](#section-3.5-5.2){.pilcrow}]{#section-3.5-5.2}
-   [IPv4 Protocol or IPv6 Next
    Header.[¶](#section-3.5-5.3){.pilcrow}]{#section-3.5-5.3}

Therefore, non-fragmented packets belonging to a flow can be assigned to
one link while fragmented packets belonging to the same flow can be
divided between that link and another. This can cause suboptimal load
distribution.[¶](#section-3.5-6){.pilcrow}

\[[RFC6438](#RFC6438){.xref}\] offers a partial solution to this problem
for IPv6 devices only. According to
\[[RFC6438](#RFC6438){.xref}\]:[¶](#section-3.5-7){.pilcrow}

> At intermediate routers that perform load distribution, the hash
> algorithm used to determine the outgoing component-link in an ECMP
> and/or LAG toward the next hop [MUST]{.bcp14} minimally include the
> 3-tuple {dest addr, source addr, flow label} and [MAY]{.bcp14} also
> include the remaining components of the
> 5-tuple.[¶](#section-3.5-8){.pilcrow}

If the algorithm includes only the 3-tuple {dest addr, source addr, flow
label}, it will assign all fragments belonging to a packet to the same
link. (See \[[RFC6437](#RFC6437){.xref}\] and
\[[RFC7098](#RFC7098){.xref}\]).[¶](#section-3.5-9){.pilcrow}

In order to avoid the problem described above, implementations
[SHOULD]{.bcp14} implement the recommendations provided in [Section
6.4](#lagrec){.xref} of this document.[¶](#section-3.5-10){.pilcrow}
:::
:::

::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [IPv4 Reassembly Errors at High Data Rates](#name-ipv4-reassembly-errors-at-h){.section-name .selfRef} {#name-ipv4-reassembly-errors-at-h}

IPv4 fragmentation is not sufficiently robust for use under some
conditions in today\'s Internet. At high data rates, the 16-bit IP
identification field is not large enough to prevent duplicate IDs,
resulting in frequent incorrectly assembled IP fragments, and the TCP
and UDP checksums are insufficient to prevent the resulting corrupted
datagrams from being delivered to upper-layer protocols.
\[[RFC4963](#RFC4963){.xref}\] describes some easily reproduced
experiments demonstrating the problem and discusses some of the
operational implications of these
observations.[¶](#section-3.6-1){.pilcrow}

These reassembly issues do not occur as frequently in IPv6 because the
IPv6 identification field is 32 bits long.[¶](#section-3.6-2){.pilcrow}
:::

::: {#at}
::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Security Vulnerabilities](#name-security-vulnerabilities){.section-name .selfRef} {#name-security-vulnerabilities}

Security researchers have documented several attacks that exploit IP
fragmentation. The following are examples:[¶](#section-3.7-1){.pilcrow}

-   [Overlapping fragment attacks \[[RFC1858](#RFC1858){.xref}\]
    \[[RFC3128](#RFC3128){.xref}\]
    \[[RFC5722](#RFC5722){.xref}\].[¶](#section-3.7-2.1){.pilcrow}]{#section-3.7-2.1}
-   [Resource exhaustion
    attacks.[¶](#section-3.7-2.2){.pilcrow}]{#section-3.7-2.2}
-   [Attacks based on predictable fragment identification values
    \[[RFC7739](#RFC7739){.xref}\].[¶](#section-3.7-2.3){.pilcrow}]{#section-3.7-2.3}
-   [Evasion of Network Intrusion Detection Systems (NIDS)
    \[[Ptacek1998](#Ptacek1998){.xref}\].[¶](#section-3.7-2.4){.pilcrow}]{#section-3.7-2.4}

In the overlapping fragment attack, an attacker constructs a series of
packet fragments. The first fragment contains an IP header, a
transport-layer header, and some transport-layer payload. This fragment
complies with local security policy and is allowed to pass through a
stateless firewall. A second fragment, having a nonzero offset, overlaps
with the first fragment. The second fragment also passes through the
stateless firewall. When the packet is reassembled, the transport-layer
header from the first fragment is overwritten by data from the second
fragment. The reassembled packet does not comply with local security
policy. Had it traversed the firewall in one piece, the firewall would
have rejected it.[¶](#section-3.7-3){.pilcrow}

A stateless firewall cannot protect against the overlapping fragment
attack. However, destination nodes can protect against the overlapping
fragment attack by implementing the procedures described in RFC 1858,
RFC 3128, and RFC 8200. These reassembly procedures detect the overlap
and discard the packet.[¶](#section-3.7-4){.pilcrow}

The fragment reassembly algorithm is a stateful procedure in an
otherwise stateless protocol. Therefore, it can be exploited by resource
exhaustion attacks. An attacker can construct a series of fragmented
packets with one fragment missing from each packet so that the
reassembly is impossible. Thus, this attack causes resource exhaustion
on the destination node, possibly denying reassembly services to other
flows. This type of attack can be mitigated by flushing fragment
reassembly buffers when necessary, at the expense of possibly dropping
legitimate fragments.[¶](#section-3.7-5){.pilcrow}

Each IP fragment contains an \"Identification\" field that destination
nodes use to reassemble fragmented packets. Some implementations set the
Identification field to a predictable value, thus making it easy for an
attacker to forge malicious IP fragments that would cause the reassembly
procedure for legitimate packets to fail.[¶](#section-3.7-6){.pilcrow}

NIDS aims at identifying malicious activity by analyzing network
traffic. Ambiguity in the possible result of the fragment reassembly
process may allow an attacker to evade these systems. Many of these
systems try to mitigate some of these evasion techniques (e.g., by
computing all possible outcomes of the fragment reassembly process, at
the expense of increased processing
requirements).[¶](#section-3.7-7){.pilcrow}
:::
:::

::: {#PTB}
::: {#section-3.8 .section}
### [3.8.](#section-3.8){.section-number .selfRef} [PMTU Black-Holing Due to ICMP Loss](#name-pmtu-black-holing-due-to-ic){.section-name .selfRef} {#name-pmtu-black-holing-due-to-ic}

As mentioned in [Section 2.3](#upper){.xref}, upper-layer protocols can
be configured to rely on PMTUD. Because PMTUD relies upon the network to
deliver ICMP PTB messages, those protocols also rely on the networks to
deliver ICMP PTB messages.[¶](#section-3.8-1){.pilcrow}

According to \[[RFC4890](#RFC4890){.xref}\], ICMPv6 PTB messages must
not be filtered. However, ICMP PTB delivery is not reliable. It is
subject to both transient and persistent
loss.[¶](#section-3.8-2){.pilcrow}

Transient loss of ICMP PTB messages can cause transient PMTU black
holes. When the conditions contributing to transient loss abate, the
network regains its ability to deliver ICMP PTB messages and
connectivity between the source and destination nodes is restored.
[Section 3.8.1](#transLoss){.xref} of this document describes conditions
that lead to transient loss of ICMP PTB
messages.[¶](#section-3.8-3){.pilcrow}

Persistent loss of ICMP PTB messages can cause persistent black holes.
Sections [3.8.2](#CPE){.xref}, [3.8.3](#Anycast){.xref}, and
[3.8.4](#unidirectional){.xref} of this document describe conditions
that lead to persistent loss of ICMP PTB
messages.[¶](#section-3.8-4){.pilcrow}

The problem described in this section is specific to PMTUD. It does not
occur when the upper-layer protocol obtains its PMTU estimate from
PLPMTUD or from any other source.[¶](#section-3.8-5){.pilcrow}

::: {#transLoss}
::: {#section-3.8.1 .section}
#### [3.8.1.](#section-3.8.1){.section-number .selfRef} [Transient Loss](#name-transient-loss){.section-name .selfRef} {#name-transient-loss}

The following factors can contribute to transient loss of ICMP PTB
messages:[¶](#section-3.8.1-1){.pilcrow}

-   [Network
    congestion.[¶](#section-3.8.1-2.1){.pilcrow}]{#section-3.8.1-2.1}
-   [Packet
    corruption.[¶](#section-3.8.1-2.2){.pilcrow}]{#section-3.8.1-2.2}
-   [Transient routing
    loops.[¶](#section-3.8.1-2.3){.pilcrow}]{#section-3.8.1-2.3}
-   [ICMP rate
    limiting.[¶](#section-3.8.1-2.4){.pilcrow}]{#section-3.8.1-2.4}

The effect of rate limiting may be severe, as RFC 4443 recommends strict
rate limiting of ICMPv6 traffic.[¶](#section-3.8.1-3){.pilcrow}
:::
:::

::: {#CPE}
::: {#section-3.8.2 .section}
#### [3.8.2.](#section-3.8.2){.section-number .selfRef} [Incorrect Implementation of Security Policy](#name-incorrect-implementation-of){.section-name .selfRef} {#name-incorrect-implementation-of}

Incorrect implementation of security policy can cause persistent loss of
ICMP PTB messages.[¶](#section-3.8.2-1){.pilcrow}

For example, assume that a Customer Premises Equipment (CPE) router
implements the following zone-based security
policy:[¶](#section-3.8.2-2){.pilcrow}

-   [Allow any traffic to flow from the inside zone to the outside
    zone.[¶](#section-3.8.2-3.1){.pilcrow}]{#section-3.8.2-3.1}
-   [Do not allow any traffic to flow from the outside zone to the
    inside zone unless it is part of an existing flow (i.e., it was
    elicited by an outbound
    packet).[¶](#section-3.8.2-3.2){.pilcrow}]{#section-3.8.2-3.2}

When a correct implementation of the above-mentioned security policy
receives an ICMP PTB message, it examines the ICMP PTB payload in order
to determine whether the original packet (i.e., the packet that elicited
the ICMP PTB message) belonged to an existing flow. If the original
packet belonged to an existing flow, the implementation allows the ICMP
PTB to flow from the outside zone to the inside zone. If not, the
implementation discards the ICMP PTB
message.[¶](#section-3.8.2-4){.pilcrow}

When an incorrect implementation of the above-mentioned security policy
receives an ICMP PTB message, it discards the packet because its source
address is not associated with an existing
flow.[¶](#section-3.8.2-5){.pilcrow}

The security policy described above has been implemented incorrectly on
many consumer CPE routers.[¶](#section-3.8.2-6){.pilcrow}
:::
:::

::: {#Anycast}
::: {#section-3.8.3 .section}
#### [3.8.3.](#section-3.8.3){.section-number .selfRef} [Persistent Loss Caused by Anycast](#name-persistent-loss-caused-by-a){.section-name .selfRef} {#name-persistent-loss-caused-by-a}

Anycast can cause persistent loss of ICMP PTB messages. Consider the
example below:[¶](#section-3.8.3-1){.pilcrow}

A DNS client sends a request to an anycast address. The network routes
that DNS request to the nearest instance of that anycast address (i.e.,
a DNS server). The DNS server generates a response and sends it back to
the DNS client. While the response does not exceed the DNS server\'s
PMTU estimate, it does exceed the actual
PMTU.[¶](#section-3.8.3-2){.pilcrow}

A downstream router drops the packet and sends an ICMP PTB message the
packet\'s source (i.e., the anycast address). The network routes the
ICMP PTB message to the anycast instance closest to the downstream
router. That anycast instance may not be the DNS server that originated
the DNS response. It may be another DNS server with the same anycast
address. The DNS server that originated the response may never receive
the ICMP PTB message and may never update its PMTU
estimate.[¶](#section-3.8.3-3){.pilcrow}
:::
:::

::: {#unidirectional}
::: {#section-3.8.4 .section}
#### [3.8.4.](#section-3.8.4){.section-number .selfRef} [Persistent Loss Caused by Unidirectional Routing](#name-persistent-loss-caused-by-u){.section-name .selfRef} {#name-persistent-loss-caused-by-u}

Unidirectional routing can cause persistent loss of ICMP PTB messages.
Consider the example below:[¶](#section-3.8.4-1){.pilcrow}

A source node sends a packet to a destination node. All intermediate
nodes maintain a route to the destination node but do not maintain a
route to the source node. In this case, when an intermediate node
encounters an MTU issue, it cannot send an ICMP PTB message to the
source node.[¶](#section-3.8.4-2){.pilcrow}
:::
:::
:::
:::

::: {#section-3.9 .section}
### [3.9.](#section-3.9){.section-number .selfRef} [Black-Holing Due to Filtering or Loss](#name-black-holing-due-to-filteri){.section-name .selfRef} {#name-black-holing-due-to-filteri}

In RFC 7872, researchers sampled Internet paths to determine whether
they would convey packets that contain IPv6 extension headers. Sampled
paths terminated at popular Internet sites (e.g., popular web, mail, and
DNS servers).[¶](#section-3.9-1){.pilcrow}

The study revealed that at least 28% of the sampled paths did not convey
packets containing the IPv6 Fragment extension header. In most cases,
fragments were dropped in the destination autonomous system. In other
cases, the fragments were dropped in transit autonomous
systems.[¶](#section-3.9-2){.pilcrow}

Another [study](#Huston){.xref} \[[Huston](#Huston){.xref}\] confirmed
this finding. It reported that 37% of sampled endpoints used
IPv6-capable DNS resolvers that were incapable of receiving a fragmented
IPv6 response.[¶](#section-3.9-3){.pilcrow}

It is difficult to determine why network operators drop fragments.
Possible causes follow:[¶](#section-3.9-4){.pilcrow}

-   [Hardware inability to process fragmented
    packets.[¶](#section-3.9-5.1){.pilcrow}]{#section-3.9-5.1}
-   [Failure to change vendor
    defaults.[¶](#section-3.9-5.2){.pilcrow}]{#section-3.9-5.2}
-   [Unintentional
    misconfiguration.[¶](#section-3.9-5.3){.pilcrow}]{#section-3.9-5.3}
-   [Intentional configuration (e.g., network operators consciously
    chooses to drop IPv6 fragments in order to address the issues raised
    in Sections [3.2](#mb){.xref} through [3.8](#PTB){.xref},
    above.)[¶](#section-3.9-5.4){.pilcrow}]{#section-3.9-5.4}
:::
:::

::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Alternatives to IP Fragmentation](#name-alternatives-to-ip-fragment){.section-name .selfRef} {#name-alternatives-to-ip-fragment}

::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Transport-Layer Solutions](#name-transport-layer-solutions){.section-name .selfRef} {#name-transport-layer-solutions}

The [Transport Control Protocol (TCP)](#RFC0793){.xref}
\[[RFC0793](#RFC0793){.xref}\]) can be operated in a mode that does not
require IP fragmentation.[¶](#section-4.1-1){.pilcrow}

Applications submit a stream of data to TCP. TCP divides that stream of
data into segments, with no segment exceeding the TCP Maximum Segment
Size (MSS). Each segment is encapsulated in a TCP header and submitted
to the underlying IP module. The underlying IP module prepends an IP
header and forwards the resulting packet.[¶](#section-4.1-2){.pilcrow}

If the TCP MSS is sufficiently small, then the underlying IP module
never produces a packet whose length is greater than the actual PMTU.
Therefore, IP fragmentation is not
required.[¶](#section-4.1-3){.pilcrow}

TCP offers the following mechanisms for MSS
management:[¶](#section-4.1-4){.pilcrow}

-   [Manual
    configuration.[¶](#section-4.1-5.1){.pilcrow}]{#section-4.1-5.1}
-   [PMTUD.[¶](#section-4.1-5.2){.pilcrow}]{#section-4.1-5.2}
-   [PLPMTUD.[¶](#section-4.1-5.3){.pilcrow}]{#section-4.1-5.3}

Manual configuration is always applicable. If the MSS is configured to a
sufficiently low value, the IP layer will never produce a packet whose
length is greater than the protocol minimum link MTU. However, manual
configuration prevents TCP from taking advantage of larger link
MTUs.[¶](#section-4.1-6){.pilcrow}

Upper-layer protocols can implement PMTUD in order to discover and take
advantage of larger Path MTUs. However, as mentioned in [Section
2.1](#pmtu){.xref}, PMTUD relies upon the network to deliver ICMP PTB
messages. Therefore, PMTUD can only provide an estimate of the PMTU in
environments where the risk of ICMP PTB loss is acceptable (e.g., known
to not be filtered).[¶](#section-4.1-7){.pilcrow}

By contrast, PLPMTUD does not rely upon the network\'s ability to
deliver ICMP PTB messages. It utilizes probe messages sent as TCP
segments to determine whether the probed PMTU can be successfully used
across the network path. In PLPMTUD, probing is separated from
congestion control, so that loss of a TCP probe segment does not cause a
reduction of the congestion control window.
\[[RFC4821](#RFC4821){.xref}\] defines PLPMTUD procedures for
TCP.[¶](#section-4.1-8){.pilcrow}

While TCP will never knowingly cause the underlying IP module to emit a
packet that is larger than the PMTU estimate, it can cause the
underlying IP module to emit a packet that is larger than the actual
PMTU. For example, if routing changes and as a result the PMTU becomes
smaller, TCP will not know until the ICMP PTB message arrives. If this
occurs, the packet is dropped, the PMTU estimate is updated, the segment
is divided into smaller segments, and each smaller segment is submitted
to the underlying IP module.[¶](#section-4.1-9){.pilcrow}

The [Datagram Congestion Control Protocol (DCCP)](#RFC4340){.xref}
\[[RFC4340](#RFC4340){.xref}\] and the [Stream Control Transmission
Protocol (SCTP)](#RFC4960){.xref} \[[RFC4960](#RFC4960){.xref}\] also
can be operated in a mode that does not require IP fragmentation. They
both accept data from an application and divide that data into segments,
with no segment exceeding a maximum size.[¶](#section-4.1-10){.pilcrow}

DCCP offers manual configuration, PMTUD, and PLPMTUD as mechanisms for
managing that maximum size. Datagram protocols can also implement
PLPMTUD to estimate the PMTU via \[[RFC8899](#RFC8899){.xref}\]. This
proposes procedures for performing PLPMTUD with UDP, UDP options, SCTP,
QUIC, and other datagram protocols.[¶](#section-4.1-11){.pilcrow}

Currently, [User Datagram Protocol (UDP)](#RFC0768){.xref}
\[[RFC0768](#RFC0768){.xref}\] lacks a fragmentation mechanism of its
own and relies on IP fragmentation. However,
\[[UDP-OPTIONS](#I-D.ietf-tsvwg-udp-options){.xref}\] proposes a
fragmentation mechanism for UDP.[¶](#section-4.1-12){.pilcrow}
:::

::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Application-Layer Solutions](#name-application-layer-solutions){.section-name .selfRef} {#name-application-layer-solutions}

\[[RFC8085](#RFC8085){.xref}\] recognizes that IP fragmentation reduces
the reliability of Internet communication. It also recognizes that UDP
lacks a fragmentation mechanism of its own and relies on IP
fragmentation. Therefore, \[[RFC8085](#RFC8085){.xref}\] offers the
following advice regarding applications the run over the
UDP:[¶](#section-4.2-1){.pilcrow}

> An application [SHOULD NOT]{.bcp14} send UDP datagrams that result in
> IP packets that exceed the Maximum Transmission Unit (MTU) along the
> path to the destination. Consequently, an application [SHOULD]{.bcp14}
> either use the path MTU information provided by the IP layer or
> implement Path MTU Discovery (PMTUD) itself
> \[[RFC1191](#RFC1191){.xref}\] \[[RFC1981](#RFC1981){.xref}\]
> \[[RFC4821](#RFC4821){.xref}\] to determine whether the path to a
> destination will support its desired message size without
> fragmentation.[¶](#section-4.2-2){.pilcrow}

RFC 8085 continues:[¶](#section-4.2-3){.pilcrow}

> Applications that do not follow the recommendation to do PMTU/PLPMTUD
> discovery [SHOULD]{.bcp14} still avoid sending UDP datagrams that
> would result in IP packets that exceed the path MTU. Because the
> actual path MTU is unknown, such applications [SHOULD]{.bcp14} fall
> back to sending messages that are shorter than the default effective
> MTU for sending (EMTU_S in \[[RFC1122](#RFC1122){.xref}\]). For IPv4,
> EMTU_S is the smaller of 576 bytes and the first-hop MTU
> \[[RFC1122](#RFC1122){.xref}\]. For IPv6, EMTU_S is 1280 bytes
> \[[RFC2460](#RFC2460){.xref}\]. The effective PMTU for a directly
> connected destination (with no routers on the path) is the configured
> interface MTU, which could be less than the maximum link payload size.
> Transmission of minimum-sized UDP datagrams is inefficient over paths
> that support a larger PMTU, which is a second reason to implement PMTU
> discovery.[¶](#section-4.2-4){.pilcrow}

RFC 8085 assumes that for IPv4 an EMTU_S of 576 is sufficiently small to
be supported by most current Internet paths, even though the IPv4
minimum link MTU is 68 octets.[¶](#section-4.2-5){.pilcrow}

This advice applies equally to any application that runs directly over
IP.[¶](#section-4.2-6){.pilcrow}
:::
:::

::: {#rely}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Applications That Rely on IPv6 Fragmentation](#name-applications-that-rely-on-i){.section-name .selfRef} {#name-applications-that-rely-on-i}

The following applications rely on IPv6
fragmentation:[¶](#section-5-1){.pilcrow}

-   [[DNS](#RFC1035){.xref}
    \[[RFC1035](#RFC1035){.xref}\].[¶](#section-5-2.1){.pilcrow}]{#section-5-2.1}
-   [[OSPFv2](#RFC2328){.xref}
    \[[RFC2328](#RFC2328){.xref}\].[¶](#section-5-2.2){.pilcrow}]{#section-5-2.2}
-   [[OSPFv3](#RFC5340){.xref}
    \[[RFC5340](#RFC5340){.xref}\].[¶](#section-5-2.3){.pilcrow}]{#section-5-2.3}
-   [Packet-in-packet
    encapsulations.[¶](#section-5-2.4){.pilcrow}]{#section-5-2.4}

Each of these applications relies on IPv6 fragmentation to a varying
degree. In some cases, that reliance is essential and cannot be broken
without fundamentally changing the protocol. In other cases, that
reliance is incidental, and most implementations already take
appropriate steps to avoid fragmentation.[¶](#section-5-3){.pilcrow}

This list is not comprehensive, and other protocols that rely on IP
fragmentation may exist. They are not specifically considered in the
context of this document.[¶](#section-5-4){.pilcrow}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Domain Name Service (DNS)](#name-domain-name-service-dns){.section-name .selfRef} {#name-domain-name-service-dns}

DNS relies on UDP for efficiency, and the consequence is the use of IP
fragmentation for large responses, as permitted by the Extension
Mechanisms for DNS (EDNS0) options in the query. It is possible to
mitigate the issue of fragmentation-based packet loss by having queries
use smaller EDNS0 UDP buffer sizes or by having the DNS server limit the
size of its UDP responses to some self-imposed maximum packet size that
may be less than the preferred EDNS0 UDP buffer size. In both cases,
large responses are truncated in the DNS, signaling to the client to
re-query using TCP to obtain the complete response. However, the
operational issue of the partial level of support for DNS over TCP,
particularly in the case where IPv6 transport is being used, becomes a
limiting factor of the efficacy of this approach
\[[Damas](#Damas){.xref}\].[¶](#section-5.1-1){.pilcrow}

Larger DNS responses can normally be avoided by aggressively pruning the
Additional section of DNS responses. One scenario where such pruning is
ineffective is in the use of DNSSEC, where large key sizes act to
increase the response size to certain DNS queries. There is no effective
response to this situation within the DNS other than using smaller
cryptographic keys and adopting of DNSSEC administrative practices that
attempt to keep DNS response as short as
possible.[¶](#section-5.1-2){.pilcrow}
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Open Shortest Path First (OSPF)](#name-open-shortest-path-first-os){.section-name .selfRef} {#name-open-shortest-path-first-os}

OSPF implementations can emit messages large enough to cause
fragmentation. However, in order to optimize performance, most OSPF
implementations restrict their maximum message size to a value that will
not cause fragmentation.[¶](#section-5.2-1){.pilcrow}
:::

::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Packet-in-Packet Encapsulations](#name-packet-in-packet-encapsulat){.section-name .selfRef} {#name-packet-in-packet-encapsulat}

This document acknowledges that in some cases, packets must be
fragmented within IP-in-IP tunnels. Therefore, this document makes no
additional recommendations regarding IP-in-IP
tunnels.[¶](#section-5.3-1){.pilcrow}

In this document, packet-in-packet encapsulations include
[IP-in-IP](#RFC2003){.xref} \[[RFC2003](#RFC2003){.xref}\], [Generic
Routing Encapsulation (GRE)](#RFC2784){.xref}
\[[RFC2784](#RFC2784){.xref}\], [GRE-in-UDP](#RFC8086){.xref}
\[[RFC8086](#RFC8086){.xref}\], and [Generic Packet Tunneling in
IPv6](#RFC2473){.xref} \[[RFC2473](#RFC2473){.xref}\].
\[[RFC4459](#RFC4459){.xref}\] describes fragmentation issues associated
with all of the above-mentioned
encapsulations.[¶](#section-5.3-2){.pilcrow}

The fragmentation strategy described for GRE in
\[[RFC7588](#RFC7588){.xref}\] has been deployed for all of the
above-mentioned encapsulations. This strategy does not rely on IP
fragmentation except in one corner case. (See [Section
3.3.2.2](https://www.rfc-editor.org/rfc/rfc7588#section-3.3.2.2){.relref}
of \[[RFC7588](#RFC7588){.xref}\] and [Section
7.1](https://www.rfc-editor.org/rfc/rfc2473#section-7.1){.relref} of
\[[RFC2473](#RFC2473){.xref}\].) [Section
3.3](https://www.rfc-editor.org/rfc/rfc7676#section-3.3){.relref} of
\[[RFC7676](#RFC7676){.xref}\] further describes this corner
case.[¶](#section-5.3-3){.pilcrow}

See \[[TUNNELS](#I-D.ietf-intarea-tunnels){.xref}\] for further
discussion.[¶](#section-5.3-4){.pilcrow}
:::

::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [UDP Applications Enhancing Performance](#name-udp-applications-enhancing-){.section-name .selfRef} {#name-udp-applications-enhancing-}

Some UDP applications rely on IP fragmentation to achieve acceptable
levels of performance. These applications use UDP datagram sizes that
are larger than the Path MTU so that more data can be conveyed between
the application and the kernel in a single system
call.[¶](#section-5.4-1){.pilcrow}

To pick one example, the [Licklider Transmission Protocol
(LTP)](#RFC5326){.xref} \[[RFC5326](#RFC5326){.xref}\], which is in
current use on the International Space Station (ISS), uses UDP datagram
sizes larger than the Path MTU to achieve acceptable levels of
performance even though this invokes IP fragmentation. More generally,
SNMP and video applications may transmit an application-layer quantum of
data, depending on the network layer to fragment and reassemble as
needed.[¶](#section-5.4-2){.pilcrow}
:::
:::
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Recommendations](#name-recommendations){.section-name .selfRef} {#name-recommendations}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [For Application and Protocol Developers](#name-for-application-and-protoco){.section-name .selfRef} {#name-for-application-and-protoco}

Developers [SHOULD NOT]{.bcp14} develop new protocols or applications
that rely on IP fragmentation. When a new protocol or application is
deployed in an environment that does not fully support IP fragmentation,
it [SHOULD]{.bcp14} operate correctly, either in its default
configuration or in a specified alternative
configuration.[¶](#section-6.1-1){.pilcrow}

While there may be controlled environments where IP fragmentation works
reliably, this is a deployment issue and can not be known to someone
developing a new protocol or application. It is not recommended that new
protocols or applications be developed that rely on IP fragmentation.
Protocols and applications that rely on IP fragmentation will work less
reliably on the Internet.[¶](#section-6.1-2){.pilcrow}

Legacy protocols that depend upon IP fragmentation [SHOULD]{.bcp14} be
updated to break that dependency. However, in some cases, there may be
no viable alternative to IP fragmentation (e.g., IPSEC tunnel mode,
IP-in-IP encapsulation). Applications and protocols cannot necessarily
know or control whether they use lower layers or network paths that rely
on such fragmentation. In these cases, the protocol will continue to
rely on IP fragmentation but should only be used in environments where
IP fragmentation is known to be supported.[¶](#section-6.1-3){.pilcrow}

Protocols may be able to avoid IP fragmentation by using a sufficiently
small MTU (e.g., The protocol minimum link MTU), disabling IP
fragmentation, and ensuring that the transport protocol in use adapts
its segment size to the MTU. Other protocols may deploy a sufficiently
reliable PMTU discovery mechanism (e.g.,
PLPMTUD).[¶](#section-6.1-4){.pilcrow}

UDP applications [SHOULD]{.bcp14} abide by the recommendations stated in
[Section
3.2](https://www.rfc-editor.org/rfc/rfc8085#section-3.2){.relref} of
\[[RFC8085](#RFC8085){.xref}\].[¶](#section-6.1-5){.pilcrow}
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [For System Developers](#name-for-system-developers){.section-name .selfRef} {#name-for-system-developers}

Software libraries [SHOULD]{.bcp14} include provision for PLPMTUD for
each supported transport protocol.[¶](#section-6.2-1){.pilcrow}
:::

::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [For Middlebox Developers](#name-for-middlebox-developers){.section-name .selfRef} {#name-for-middlebox-developers}

Middleboxes, which are systems that \"transparently\" perform policy
functions on passing traffic but do not participate in the routing
system, should process IP fragments in a manner that is consistent with
\[[RFC0791](#RFC0791){.xref}\] and \[[RFC8200](#RFC8200){.xref}\]. In
many cases, middleboxes must maintain state in order to achieve this
goal.[¶](#section-6.3-1){.pilcrow}

Price and performance considerations frequently motivate network
operators to deploy stateless middleboxes. These stateless middleboxes
may perform suboptimally, process IP fragments in a manner that is not
compliant with RFC 791 or RFC 8200, or even discard IP fragments
completely. Such behaviors are [NOT RECOMMENDED]{.bcp14}. If a middlebox
implements nonstandard behavior with respect to IP fragmentation, then
that behavior [MUST]{.bcp14} be clearly
documented.[¶](#section-6.3-2){.pilcrow}
:::

::: {#lagrec}
::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [For ECMP, LAG, and Load-Balancer Developers And Operators](#name-for-ecmp-lag-and-load-balan){.section-name .selfRef} {#name-for-ecmp-lag-and-load-balan}

In their default configuration, when the IPv6 Flow Label is not equal to
zero, IPv6 devices that implement Equal-Cost Multipath (ECMP) Routing as
described in [OSPF](#RFC2328){.xref} \[[RFC2328](#RFC2328){.xref}\] and
other routing protocols, [Link Aggregation Grouping
(LAG)](#RFC7424){.xref} \[[RFC7424](#RFC7424){.xref}\], or other
load-distribution technologies [SHOULD]{.bcp14} accept only the
following fields as input to their hash
algorithm:[¶](#section-6.4-1){.pilcrow}

-   [IP Source
    Address.[¶](#section-6.4-2.1){.pilcrow}]{#section-6.4-2.1}
-   [IP Destination
    Address.[¶](#section-6.4-2.2){.pilcrow}]{#section-6.4-2.2}
-   [Flow Label.[¶](#section-6.4-2.3){.pilcrow}]{#section-6.4-2.3}

Operators [SHOULD]{.bcp14} deploy these devices in their default
configuration.[¶](#section-6.4-3){.pilcrow}

These recommendations are similar to those presented in
\[[RFC6438](#RFC6438){.xref}\] and \[[RFC7098](#RFC7098){.xref}\]. They
differ in that they specify a default
configuration.[¶](#section-6.4-4){.pilcrow}
:::
:::

::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [For Network Operators](#name-for-network-operators){.section-name .selfRef} {#name-for-network-operators}

Operators [MUST]{.bcp14} ensure proper PMTUD operation in their network,
including making sure the network generates PTB packets when dropping
packets too large compared to outgoing interface MTU. However,
implementations [MAY]{.bcp14} rate limit the generation of ICMP messages
per \[[RFC1812](#RFC1812){.xref}\] and
\[[RFC4443](#RFC4443){.xref}\].[¶](#section-6.5-1){.pilcrow}

As per RFC 4890, network operators [MUST NOT]{.bcp14} filter ICMPv6 PTB
messages unless they are known to be forged or otherwise illegitimate.
As stated in [Section 3.8](#PTB){.xref}, filtering ICMPv6 PTB packets
causes PMTUD to fail. Many upper-layer protocols rely on
PMTUD.[¶](#section-6.5-2){.pilcrow}

As per RFC 8200, network operators [MUST NOT]{.bcp14} deploy IPv6 links
whose MTU is less than 1280 octets.[¶](#section-6.5-3){.pilcrow}

Network operators [SHOULD NOT]{.bcp14} filter IP fragments if they are
known to have originated at a domain name server or be destined for a
domain name server. This is because domain name services are critical to
operation of the Internet.[¶](#section-6.5-4){.pilcrow}
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-7-1){.pilcrow}
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document mitigates some of the security considerations associated
with IP fragmentation by discouraging its use. It does not introduce any
new security vulnerabilities, because it does not introduce any new
alternatives to IP fragmentation. Instead, it recommends well-understood
alternatives.[¶](#section-8-1){.pilcrow}
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0768\]
:   [Postel, J.]{.refAuthor}, [\"User Datagram Protocol\"]{.refTitle},
    [STD 6]{.seriesInfo}, [RFC 768]{.seriesInfo}, [DOI
    10.17487/RFC0768]{.seriesInfo}, August 1980,
    \<<https://www.rfc-editor.org/info/rfc768>\>.
:   

\[RFC0791\]
:   [Postel, J.]{.refAuthor}, [\"Internet Protocol\"]{.refTitle}, [STD
    5]{.seriesInfo}, [RFC 791]{.seriesInfo}, [DOI
    10.17487/RFC0791]{.seriesInfo}, September 1981,
    \<<https://www.rfc-editor.org/info/rfc791>\>.
:   

\[RFC0792\]
:   [Postel, J.]{.refAuthor}, [\"Internet Control Message
    Protocol\"]{.refTitle}, [STD 5]{.seriesInfo}, [RFC
    792]{.seriesInfo}, [DOI 10.17487/RFC0792]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc792>\>.
:   

\[RFC0793\]
:   [Postel, J.]{.refAuthor}, [\"Transmission Control
    Protocol\"]{.refTitle}, [STD 7]{.seriesInfo}, [RFC
    793]{.seriesInfo}, [DOI 10.17487/RFC0793]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc793>\>.
:   

\[RFC1035\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - implementation and
    specification\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1035]{.seriesInfo}, [DOI 10.17487/RFC1035]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1035>\>.
:   

\[RFC1191\]
:   [Mogul, J.]{.refAuthor}[ and S. Deering]{.refAuthor}, [\"Path MTU
    discovery\"]{.refTitle}, [RFC 1191]{.seriesInfo}, [DOI
    10.17487/RFC1191]{.seriesInfo}, November 1990,
    \<<https://www.rfc-editor.org/info/rfc1191>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4443\]
:   [Conta, A.]{.refAuthor}[, Deering, S.]{.refAuthor}[, and M. Gupta,
    Ed.]{.refAuthor}, [\"Internet Control Message Protocol (ICMPv6) for
    the Internet Protocol Version 6 (IPv6) Specification\"]{.refTitle},
    [STD 89]{.seriesInfo}, [RFC 4443]{.seriesInfo}, [DOI
    10.17487/RFC4443]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4443>\>.
:   

\[RFC4821\]
:   [Mathis, M.]{.refAuthor}[ and J. Heffner]{.refAuthor},
    [\"Packetization Layer Path MTU Discovery\"]{.refTitle}, [RFC
    4821]{.seriesInfo}, [DOI 10.17487/RFC4821]{.seriesInfo}, March 2007,
    \<<https://www.rfc-editor.org/info/rfc4821>\>.
:   

\[RFC6437\]
:   [Amante, S.]{.refAuthor}[, Carpenter, B.]{.refAuthor}[,
    Jiang, S.]{.refAuthor}[, and J. Rajahalme]{.refAuthor}, [\"IPv6 Flow
    Label Specification\"]{.refTitle}, [RFC 6437]{.seriesInfo}, [DOI
    10.17487/RFC6437]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6437>\>.
:   

\[RFC6438\]
:   [Carpenter, B.]{.refAuthor}[ and S. Amante]{.refAuthor}, [\"Using
    the IPv6 Flow Label for Equal Cost Multipath Routing and Link
    Aggregation in Tunnels\"]{.refTitle}, [RFC 6438]{.seriesInfo}, [DOI
    10.17487/RFC6438]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6438>\>.
:   

\[RFC8085\]
:   [Eggert, L.]{.refAuthor}[, Fairhurst, G.]{.refAuthor}[, and G.
    Shepherd]{.refAuthor}, [\"UDP Usage Guidelines\"]{.refTitle}, [BCP
    145]{.seriesInfo}, [RFC 8085]{.seriesInfo}, [DOI
    10.17487/RFC8085]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8085>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8200\]
:   [Deering, S.]{.refAuthor}[ and R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [STD
    86]{.seriesInfo}, [RFC 8200]{.seriesInfo}, [DOI
    10.17487/RFC8200]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8200>\>.
:   

\[RFC8201\]
:   [McCann, J.]{.refAuthor}[, Deering, S.]{.refAuthor}[,
    Mogul, J.]{.refAuthor}[, and R. Hinden, Ed.]{.refAuthor}, [\"Path
    MTU Discovery for IP version 6\"]{.refTitle}, [STD 87]{.seriesInfo},
    [RFC 8201]{.seriesInfo}, [DOI 10.17487/RFC8201]{.seriesInfo}, July
    2017, \<<https://www.rfc-editor.org/info/rfc8201>\>.
:   

\[RFC8899\]
:   [Fairhurst, G.]{.refAuthor}[, Jones, T.]{.refAuthor}[,
    Tüxen, M.]{.refAuthor}[, Rüngeler, I.]{.refAuthor}[, and T.
    Völker]{.refAuthor}, [\"Packetization Layer Path MTU Discovery for
    Datagram Transports\"]{.refTitle}, [RFC 8899]{.seriesInfo}, [DOI
    10.17487/RFC8899]{.seriesInfo}, September 2020,
    \<<https://www.rfc-editor.org/info/rfc8899>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[Damas\]
:   [Damas, J.]{.refAuthor}[ and G. Huston]{.refAuthor}, [\"Measuring
    ATR\"]{.refTitle}, April 2018,
    \<<http://www.potaroo.net/ispcol/2018-04/atr.html>\>.
:   

\[Huston\]
:   [Huston, G.]{.refAuthor}, [\"IPv6, Large UDP Packets and the
    DNS\"]{.refTitle}, August 2017,
    \<<http://www.potaroo.net/ispcol/2017-08/xtn-hdrs.html>\>.
:   

\[Kent\]
:   [Kent, C.]{.refAuthor}[ and J. Mogul]{.refAuthor}, [\"Fragmentation
    Considered Harmful\"]{.refTitle}, [SIGCOMM \'87: Proceedings of the
    ACM workshop on Frontiers in computer communications
    technology]{.refContent}, [DOI 10.1145/55482.55524]{.seriesInfo},
    August 1987,
    \<<http://www.hpl.hp.com/techreports/Compaq-DEC/WRL-87-3.pdf>\>.
:   

\[Ptacek1998\]
:   [Ptacek, T. H.]{.refAuthor}[ and T. N. Newsham]{.refAuthor},
    [\"Insertion, Evasion and Denial of Service: Eluding Network
    Intrusion Detection\"]{.refTitle}, 1998,
    \<<http://www.aciri.org/vern/Ptacek-Newsham-Evasion-98.ps>\>.
:   

\[RFC1122\]
:   [Braden, R., Ed.]{.refAuthor}, [\"Requirements for Internet Hosts -
    Communication Layers\"]{.refTitle}, [STD 3]{.seriesInfo}, [RFC
    1122]{.seriesInfo}, [DOI 10.17487/RFC1122]{.seriesInfo}, October
    1989, \<<https://www.rfc-editor.org/info/rfc1122>\>.
:   

\[RFC1812\]
:   [Baker, F., Ed.]{.refAuthor}, [\"Requirements for IP Version 4
    Routers\"]{.refTitle}, [RFC 1812]{.seriesInfo}, [DOI
    10.17487/RFC1812]{.seriesInfo}, June 1995,
    \<<https://www.rfc-editor.org/info/rfc1812>\>.
:   

\[RFC1858\]
:   [Ziemba, G.]{.refAuthor}[, Reed, D.]{.refAuthor}[, and P.
    Traina]{.refAuthor}, [\"Security Considerations for IP Fragment
    Filtering\"]{.refTitle}, [RFC 1858]{.seriesInfo}, [DOI
    10.17487/RFC1858]{.seriesInfo}, October 1995,
    \<<https://www.rfc-editor.org/info/rfc1858>\>.
:   

\[RFC1981\]
:   [McCann, J.]{.refAuthor}[, Deering, S.]{.refAuthor}[, and J.
    Mogul]{.refAuthor}, [\"Path MTU Discovery for IP version
    6\"]{.refTitle}, [RFC 1981]{.seriesInfo}, [DOI
    10.17487/RFC1981]{.seriesInfo}, August 1996,
    \<<https://www.rfc-editor.org/info/rfc1981>\>.
:   

\[RFC2003\]
:   [Perkins, C.]{.refAuthor}, [\"IP Encapsulation within
    IP\"]{.refTitle}, [RFC 2003]{.seriesInfo}, [DOI
    10.17487/RFC2003]{.seriesInfo}, October 1996,
    \<<https://www.rfc-editor.org/info/rfc2003>\>.
:   

\[RFC2328\]
:   [Moy, J.]{.refAuthor}, [\"OSPF Version 2\"]{.refTitle}, [STD
    54]{.seriesInfo}, [RFC 2328]{.seriesInfo}, [DOI
    10.17487/RFC2328]{.seriesInfo}, April 1998,
    \<<https://www.rfc-editor.org/info/rfc2328>\>.
:   

\[RFC2460\]
:   [Deering, S.]{.refAuthor}[ and R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [RFC
    2460]{.seriesInfo}, [DOI 10.17487/RFC2460]{.seriesInfo}, December
    1998, \<<https://www.rfc-editor.org/info/rfc2460>\>.
:   

\[RFC2473\]
:   [Conta, A.]{.refAuthor}[ and S. Deering]{.refAuthor}, [\"Generic
    Packet Tunneling in IPv6 Specification\"]{.refTitle}, [RFC
    2473]{.seriesInfo}, [DOI 10.17487/RFC2473]{.seriesInfo}, December
    1998, \<<https://www.rfc-editor.org/info/rfc2473>\>.
:   

\[RFC2784\]
:   [Farinacci, D.]{.refAuthor}[, Li, T.]{.refAuthor}[,
    Hanks, S.]{.refAuthor}[, Meyer, D.]{.refAuthor}[, and P.
    Traina]{.refAuthor}, [\"Generic Routing Encapsulation
    (GRE)\"]{.refTitle}, [RFC 2784]{.seriesInfo}, [DOI
    10.17487/RFC2784]{.seriesInfo}, March 2000,
    \<<https://www.rfc-editor.org/info/rfc2784>\>.
:   

\[RFC3128\]
:   [Miller, I.]{.refAuthor}, [\"Protection Against a Variant of the
    Tiny Fragment Attack (RFC 1858)\"]{.refTitle}, [RFC
    3128]{.seriesInfo}, [DOI 10.17487/RFC3128]{.seriesInfo}, June 2001,
    \<<https://www.rfc-editor.org/info/rfc3128>\>.
:   

\[RFC4340\]
:   [Kohler, E.]{.refAuthor}[, Handley, M.]{.refAuthor}[, and S.
    Floyd]{.refAuthor}, [\"Datagram Congestion Control Protocol
    (DCCP)\"]{.refTitle}, [RFC 4340]{.seriesInfo}, [DOI
    10.17487/RFC4340]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4340>\>.
:   

\[RFC4459\]
:   [Savola, P.]{.refAuthor}, [\"MTU and Fragmentation Issues with
    In-the-Network Tunneling\"]{.refTitle}, [RFC 4459]{.seriesInfo},
    [DOI 10.17487/RFC4459]{.seriesInfo}, April 2006,
    \<<https://www.rfc-editor.org/info/rfc4459>\>.
:   

\[RFC4890\]
:   [Davies, E.]{.refAuthor}[ and J. Mohacsi]{.refAuthor},
    [\"Recommendations for Filtering ICMPv6 Messages in
    Firewalls\"]{.refTitle}, [RFC 4890]{.seriesInfo}, [DOI
    10.17487/RFC4890]{.seriesInfo}, May 2007,
    \<<https://www.rfc-editor.org/info/rfc4890>\>.
:   

\[RFC4960\]
:   [Stewart, R., Ed.]{.refAuthor}, [\"Stream Control Transmission
    Protocol\"]{.refTitle}, [RFC 4960]{.seriesInfo}, [DOI
    10.17487/RFC4960]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4960>\>.
:   

\[RFC4963\]
:   [Heffner, J.]{.refAuthor}[, Mathis, M.]{.refAuthor}[, and B.
    Chandler]{.refAuthor}, [\"IPv4 Reassembly Errors at High Data
    Rates\"]{.refTitle}, [RFC 4963]{.seriesInfo}, [DOI
    10.17487/RFC4963]{.seriesInfo}, July 2007,
    \<<https://www.rfc-editor.org/info/rfc4963>\>.
:   

\[RFC5326\]
:   [Ramadas, M.]{.refAuthor}[, Burleigh, S.]{.refAuthor}[, and S.
    Farrell]{.refAuthor}, [\"Licklider Transmission Protocol -
    Specification\"]{.refTitle}, [RFC 5326]{.seriesInfo}, [DOI
    10.17487/RFC5326]{.seriesInfo}, September 2008,
    \<<https://www.rfc-editor.org/info/rfc5326>\>.
:   

\[RFC5340\]
:   [Coltun, R.]{.refAuthor}[, Ferguson, D.]{.refAuthor}[,
    Moy, J.]{.refAuthor}[, and A. Lindem]{.refAuthor}, [\"OSPF for
    IPv6\"]{.refTitle}, [RFC 5340]{.seriesInfo}, [DOI
    10.17487/RFC5340]{.seriesInfo}, July 2008,
    \<<https://www.rfc-editor.org/info/rfc5340>\>.
:   

\[RFC5722\]
:   [Krishnan, S.]{.refAuthor}, [\"Handling of Overlapping IPv6
    Fragments\"]{.refTitle}, [RFC 5722]{.seriesInfo}, [DOI
    10.17487/RFC5722]{.seriesInfo}, December 2009,
    \<<https://www.rfc-editor.org/info/rfc5722>\>.
:   

\[RFC5927\]
:   [Gont, F.]{.refAuthor}, [\"ICMP Attacks against TCP\"]{.refTitle},
    [RFC 5927]{.seriesInfo}, [DOI 10.17487/RFC5927]{.seriesInfo}, July
    2010, \<<https://www.rfc-editor.org/info/rfc5927>\>.
:   

\[RFC6346\]
:   [Bush, R., Ed.]{.refAuthor}, [\"The Address plus Port (A+P) Approach
    to the IPv4 Address Shortage\"]{.refTitle}, [RFC 6346]{.seriesInfo},
    [DOI 10.17487/RFC6346]{.seriesInfo}, August 2011,
    \<<https://www.rfc-editor.org/info/rfc6346>\>.
:   

\[RFC6888\]
:   [Perreault, S., Ed.]{.refAuthor}[, Yamagata, I.]{.refAuthor}[,
    Miyakawa, S.]{.refAuthor}[, Nakagawa, A.]{.refAuthor}[, and H.
    Ashida]{.refAuthor}, [\"Common Requirements for Carrier-Grade NATs
    (CGNs)\"]{.refTitle}, [BCP 127]{.seriesInfo}, [RFC
    6888]{.seriesInfo}, [DOI 10.17487/RFC6888]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6888>\>.
:   

\[RFC7098\]
:   [Carpenter, B.]{.refAuthor}[, Jiang, S.]{.refAuthor}[, and W.
    Tarreau]{.refAuthor}, [\"Using the IPv6 Flow Label for Load
    Balancing in Server Farms\"]{.refTitle}, [RFC 7098]{.seriesInfo},
    [DOI 10.17487/RFC7098]{.seriesInfo}, January 2014,
    \<<https://www.rfc-editor.org/info/rfc7098>\>.
:   

\[RFC7424\]
:   [Krishnan, R.]{.refAuthor}[, Yong, L.]{.refAuthor}[,
    Ghanwani, A.]{.refAuthor}[, So, N.]{.refAuthor}[, and B.
    Khasnabish]{.refAuthor}, [\"Mechanisms for Optimizing Link
    Aggregation Group (LAG) and Equal-Cost Multipath (ECMP) Component
    Link Utilization in Networks\"]{.refTitle}, [RFC 7424]{.seriesInfo},
    [DOI 10.17487/RFC7424]{.seriesInfo}, January 2015,
    \<<https://www.rfc-editor.org/info/rfc7424>\>.
:   

\[RFC7588\]
:   [Bonica, R.]{.refAuthor}[, Pignataro, C.]{.refAuthor}[, and J.
    Touch]{.refAuthor}, [\"A Widely Deployed Solution to the Generic
    Routing Encapsulation (GRE) Fragmentation Problem\"]{.refTitle},
    [RFC 7588]{.seriesInfo}, [DOI 10.17487/RFC7588]{.seriesInfo}, July
    2015, \<<https://www.rfc-editor.org/info/rfc7588>\>.
:   

\[RFC7676\]
:   [Pignataro, C.]{.refAuthor}[, Bonica, R.]{.refAuthor}[, and S.
    Krishnan]{.refAuthor}, [\"IPv6 Support for Generic Routing
    Encapsulation (GRE)\"]{.refTitle}, [RFC 7676]{.seriesInfo}, [DOI
    10.17487/RFC7676]{.seriesInfo}, October 2015,
    \<<https://www.rfc-editor.org/info/rfc7676>\>.
:   

\[RFC7739\]
:   [Gont, F.]{.refAuthor}, [\"Security Implications of Predictable
    Fragment Identification Values\"]{.refTitle}, [RFC
    7739]{.seriesInfo}, [DOI 10.17487/RFC7739]{.seriesInfo}, February
    2016, \<<https://www.rfc-editor.org/info/rfc7739>\>.
:   

\[RFC7872\]
:   [Gont, F.]{.refAuthor}[, Linkova, J.]{.refAuthor}[,
    Chown, T.]{.refAuthor}[, and W. Liu]{.refAuthor}, [\"Observations on
    the Dropping of Packets with IPv6 Extension Headers in the Real
    World\"]{.refTitle}, [RFC 7872]{.seriesInfo}, [DOI
    10.17487/RFC7872]{.seriesInfo}, June 2016,
    \<<https://www.rfc-editor.org/info/rfc7872>\>.
:   

\[RFC8086\]
:   [Yong, L., Ed.]{.refAuthor}[, Crabbe, E.]{.refAuthor}[,
    Xu, X.]{.refAuthor}[, and T. Herbert]{.refAuthor}, [\"GRE-in-UDP
    Encapsulation\"]{.refTitle}, [RFC 8086]{.seriesInfo}, [DOI
    10.17487/RFC8086]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8086>\>.
:   

\[TUNNELS\]
:   [Touch, J.]{.refAuthor}[ and M. Townsley]{.refAuthor}, [\"IP Tunnels
    in the Internet Architecture\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-intarea-tunnels-10]{.seriesInfo}, 12 September 2019,
    \<<https://tools.ietf.org/html/draft-ietf-intarea-tunnels-10>\>.
:   

\[UDP-OPTIONS\]
:   [Touch, J.]{.refAuthor}, [\"Transport Options for UDP\"]{.refTitle},
    [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-tsvwg-udp-options-08]{.seriesInfo}, 12 September 2019,
    \<<https://tools.ietf.org/html/draft-ietf-tsvwg-udp-options-08>\>.
:   
:::
:::

::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to [Mikael Abrahamsson]{.contact-name}, [Brian
Carpenter]{.contact-name}, [Silambu Chelvan]{.contact-name}, [Lorenzo
Colitti]{.contact-name}, [Gorry Fairhurst]{.contact-name}, [Joel
Halpern]{.contact-name}, [Mike Heard]{.contact-name}, [Tom
Herbert]{.contact-name}, [Tatuya Jinmei]{.contact-name}, [Suresh
Krishnan]{.contact-name}, [Jen Linkova]{.contact-name}, [Paolo
Lucente]{.contact-name}, [Manoj Nayak]{.contact-name}, [Eric
Nygren]{.contact-name}, [Fred Templin]{.contact-name}, and [Joe
Touch]{.contact-name} for their
comments.[¶](#section-appendix.a-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Ron Bonica]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Juniper Networks]{.org}
:::

::: {.left dir="auto"}
[2251 Corporate Park Drive]{.street-address}
:::

::: {.left dir="auto"}
[Herndon]{.locality}, [Virginia]{.region} [20171]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <rbonica@juniper.net>
:::

::: {.left dir="auto"}
[Fred Baker]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Unaffiliated]{.org}
:::

::: {.left dir="auto"}
[Santa Barbara]{.locality}, [California]{.region} [93117]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <FredBaker.IETF@gmail.com>
:::

::: {.left dir="auto"}
[Geoff Huston]{.fn .nameRole}
:::

::: {.left dir="auto"}
[APNIC]{.org}
:::

::: {.left dir="auto"}
[6 Cordelia St]{.street-address}
:::

::: {.left dir="auto"}
[Brisbane]{.locality} [4101 QLD]{.region}
:::

::: {.left dir="auto"}
[Australia]{.country-name}
:::

::: email
Email: <gih@apnic.net>
:::

::: {.left dir="auto"}
[Robert M. Hinden]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Check Point Software]{.org}
:::

::: {.left dir="auto"}
[959 Skyway Road]{.street-address}
:::

::: {.left dir="auto"}
[San Carlos]{.locality}, [California]{.region} [94070]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <bob.hinden@gmail.com>
:::

::: {.left dir="auto"}
[Ole Troan]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco]{.org}
:::

::: {.left dir="auto"}
[Philip Pedersens vei 1]{.street-address}
:::

::: {.left dir="auto"}
[N-1366 Lysaker]{.locality}
:::

::: {.left dir="auto"}
[Norway]{.country-name}
:::

::: email
Email: <ot@cisco.com>
:::

::: {.left dir="auto"}
[Fernando Gont]{.fn .nameRole}
:::

::: {.left dir="auto"}
[SI6 Networks]{.org}
:::

::: {.left dir="auto"}
[Evaristo Carriego 2644]{.street-address}
:::

::: {.left dir="auto"}
[Haedo]{.locality}
:::

::: {.left dir="auto"}
[Provincia de Buenos Aires]{.region}
:::

::: {.left dir="auto"}
[Argentina]{.country-name}
:::

::: email
Email: <fgont@si6networks.com>
:::
:::
:::
