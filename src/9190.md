  RFC 9190                 EAP-TLS 1.3       February 2022
  ------------------------ ----------------- ---------------
  Preuß Mattsson & Sethi   Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9190](https://www.rfc-editor.org/rfc/rfc9190){.eref}

Updates:
:   [5216](https://www.rfc-editor.org/rfc/rfc5216){.eref}

Category:
:   Standards Track

Published:
:   February 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    J. Preuß Mattsson
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    M. Sethi
    :::

    ::: org
    Ericsson
    :::
    :::
:::

# RFC 9190 {#rfcnum}

# EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3 {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The Extensible Authentication Protocol (EAP), defined in RFC 3748,
provides a standard mechanism for support of multiple authentication
methods. This document specifies the use of EAP-TLS with TLS 1.3 while
remaining backwards compatible with existing implementations of EAP-TLS.
TLS 1.3 provides significantly improved security and privacy, and
reduced latency when compared to earlier versions of TLS. EAP-TLS with
TLS 1.3 (EAP-TLS 1.3) further improves security and privacy by always
providing forward secrecy, never disclosing the peer identity, and by
mandating use of revocation checking when compared to EAP-TLS with
earlier versions of TLS. This document also provides guidance on
authentication, authorization, and resumption for EAP-TLS in general
(regardless of the underlying TLS version used). This document updates
RFC 5216.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9190>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Requirements and
        Terminology](#name-requirements-and-terminolog){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Protocol
    Overview](#name-protocol-overview){.xref}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Overview of the EAP-TLS
        Conversation](#name-overview-of-the-eap-tls-con){.xref}

        -   ::: {#section-toc.1-1.2.2.1.2.1}
            [2.1.1](#section-2.1.1){.xref}.  [Authentication](#name-authentication){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.2}
            [2.1.2](#section-2.1.2){.xref}.  [Ticket
            Establishment](#name-ticket-establishment){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.3}
            [2.1.3](#section-2.1.3){.xref}.  [Resumption](#name-resumption){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.4}
            [2.1.4](#section-2.1.4){.xref}.  [Termination](#name-termination){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.5}
            [2.1.5](#section-2.1.5){.xref}.  [No Peer
            Authentication](#name-no-peer-authentication){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.6}
            [2.1.6](#section-2.1.6){.xref}.  [Hello Retry
            Request](#name-hello-retry-request){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.7}
            [2.1.7](#section-2.1.7){.xref}.  [Identity](#name-identity){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.8}
            [2.1.8](#section-2.1.8){.xref}.  [Privacy](#name-privacy){.xref}
            :::

        -   ::: {#section-toc.1-1.2.2.1.2.9}
            [2.1.9](#section-2.1.9){.xref}.  [Fragmentation](#name-fragmentation){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Identity
        Verification](#name-identity-verification){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Key
        Hierarchy](#name-key-hierarchy){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.4}
        [2.4](#section-2.4){.xref}.  [Parameter Negotiation and
        Compliance
        Requirements](#name-parameter-negotiation-and-c){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.5}
        [2.5](#section-2.5){.xref}.  [EAP State
        Machines](#name-eap-state-machines){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Detailed Description of the EAP-TLS
    Protocol](#name-detailed-description-of-the){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Security
        Claims](#name-security-claims){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Peer and Server
        Identities](#name-peer-and-server-identities){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Certificate
        Validation](#name-certificate-validation){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Certificate
        Revocation](#name-certificate-revocation){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Packet Modification
        Attacks](#name-packet-modification-attacks){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [Authorization](#name-authorization){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.7}
        [5.7](#section-5.7){.xref}.  [Resumption](#name-resumption-2){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.8}
        [5.8](#section-5.8){.xref}.  [Privacy
        Considerations](#name-privacy-considerations){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.9}
        [5.9](#section-5.9){.xref}.  [Pervasive
        Monitoring](#name-pervasive-monitoring){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.10}
        [5.10](#section-5.10){.xref}. [Discovered
        Vulnerabilities](#name-discovered-vulnerabilities){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.11}
        [5.11](#section-5.11){.xref}. [Cross-Protocol
        Attacks](#name-cross-protocol-attacks){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Informative
        references](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [Appendix A](#appendix-A){.xref}.  [Updated
    References](#name-updated-references){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [](#appendix-B){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [](#appendix-C){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [](#appendix-D){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Extensible Authentication Protocol (EAP), defined in
\[[RFC3748](#RFC3748){.xref}\], provides a standard mechanism for
support of multiple authentication methods. EAP-TLS
\[[RFC5216](#RFC5216){.xref}\] specifies an EAP authentication method
with certificate-based mutual authentication utilizing the TLS handshake
protocol for cryptographic algorithms and protocol version negotiation
and establishment of shared secret keying material. EAP-TLS is widely
supported for authentication and key establishment in IEEE 802.11
\[[IEEE-802.11](#IEEE-802.11){.xref}\] (Wi-Fi) and IEEE 802.1AE
\[[IEEE-802.1AE](#IEEE-802.1AE){.xref}\] (MACsec) networks using IEEE
802.1X \[[IEEE-802.1X](#IEEE-802.1X){.xref}\] and it\'s the default
mechanism for certificate-based authentication in 3GPP 5G
\[[TS.33.501](#TS.33.501){.xref}\] and MulteFire
\[[MulteFire](#MulteFire){.xref}\] networks. Many other EAP methods such
as Flexible Authentication via Secure Tunneling (EAP-FAST)
\[[RFC4851](#RFC4851){.xref}\], Tunneled Transport Layer Security
(EAP-TTLS) \[[RFC5281](#RFC5281){.xref}\], the Tunnel Extensible
Authentication Protocol (TEAP) \[[RFC7170](#RFC7170){.xref}\], as well
as vendor-specific EAP methods such as the Protected Extensible
Authentication Protocol (PEAP) \[[PEAP](#PEAP){.xref}\], depend on TLS
and EAP-TLS.[¶](#section-1-1){.pilcrow}

EAP-TLS \[[RFC5216](#RFC5216){.xref}\] references TLS 1.0
\[[RFC2246](#RFC2246){.xref}\] and TLS 1.1
\[[RFC4346](#RFC4346){.xref}\] but can also work with TLS 1.2
\[[RFC5246](#RFC5246){.xref}\]. TLS 1.0 and 1.1 are formally deprecated
and prohibited from being negotiated or used
\[[RFC8996](#RFC8996){.xref}\]. Weaknesses found in TLS 1.2 as well as
new requirements for security, privacy, and reduced latency have led to
the specification of TLS 1.3 \[[RFC8446](#RFC8446){.xref}\], which
obsoletes TLS 1.2 \[[RFC5246](#RFC5246){.xref}\]. TLS 1.3 is in large
part a complete remodeling of the TLS handshake protocol including a
different message flow, different handshake messages, different key
schedule, different cipher suites, different resumption mechanism,
different privacy protection, and different record padding. This means
that significant parts of the normative text in the previous EAP-TLS
specification \[[RFC5216](#RFC5216){.xref}\] are not applicable to
EAP-TLS with TLS 1.3. Therefore, aspects such as resumption, privacy
handling, and key derivation need to be appropriately addressed for
EAP-TLS with TLS 1.3.[¶](#section-1-2){.pilcrow}

This document updates \[[RFC5216](#RFC5216){.xref}\] to define how to
use EAP-TLS with TLS 1.3. When older TLS versions are negotiated, RFC
5216 applies to maintain backwards compatibility. However, this document
does provide additional guidance on authentication, authorization, and
resumption for EAP-TLS regardless of the underlying TLS version used.
This document only describes differences compared to
\[[RFC5216](#RFC5216){.xref}\]. When EAP-TLS is used with TLS 1.3, some
references are updated as specified in [Appendix A](#updateref){.xref}.
All message flows are example message flows specific to TLS 1.3 and do
not apply to TLS 1.2. Since EAP-TLS couples the TLS handshake state
machine with the EAP state machine, it is possible that new versions of
TLS will cause incompatibilities that introduce failures or security
issues if they are not carefully integrated into the EAP-TLS protocol.
Therefore, implementations [MUST]{.bcp14} limit the maximum TLS version
they use to 1.3, unless later versions are explicitly enabled by the
administrator.[¶](#section-1-3){.pilcrow}

This document specifies EAP-TLS 1.3 and does not specify how other
TLS-based EAP methods use TLS 1.3. The specification for how other
TLS-based EAP methods use TLS 1.3 is left to other documents such as
\[[TLS-EAP-TYPES](#I-D.ietf-emu-tls-eap-types){.xref}\].[¶](#section-1-4){.pilcrow}

In addition to the improved security and privacy offered by TLS 1.3,
there are other significant benefits of using EAP-TLS with TLS 1.3.
Privacy, which in EAP-TLS means that no information about the underlying
peer identity is disclosed, is mandatory and achieved without any
additional round trips. Revocation checking is mandatory and simplified
with Online Certificate Status Protocol (OCSP) stapling, and TLS 1.3
introduces more possibilities to reduce fragmentation when compared to
earlier versions of TLS.[¶](#section-1-5){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Requirements and Terminology](#name-requirements-and-terminolog){.section-name .selfRef} {#name-requirements-and-terminolog}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}

Readers are expected to be familiar with the terms and concepts used in
EAP-TLS \[[RFC5216](#RFC5216){.xref}\] and TLS
\[[RFC8446](#RFC8446){.xref}\]. The term EAP-TLS peer is used for the
entity acting as EAP peer and TLS client. The term EAP-TLS server is
used for the entity acting as EAP server and TLS
server.[¶](#section-1.1-2){.pilcrow}

This document follows the terminology from
\[[TLS-bis](#I-D.ietf-tls-rfc8446bis){.xref}\] where the master secret
is renamed to the main secret and the exporter_master_secret is renamed
to the exporter_secret.[¶](#section-1.1-3){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Protocol Overview](#name-protocol-overview){.section-name .selfRef} {#name-protocol-overview}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Overview of the EAP-TLS Conversation](#name-overview-of-the-eap-tls-con){.section-name .selfRef} {#name-overview-of-the-eap-tls-con}

This section updates [Section
2.1](https://www.rfc-editor.org/rfc/rfc5216#section-2.1){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.1-1){.pilcrow}

If the TLS implementation correctly implements TLS version negotiation,
EAP-TLS will automatically leverage that capability. The EAP-TLS
implementation needs to know which version of TLS was negotiated to
correctly support EAP-TLS 1.3 as well as to maintain backward
compatibility with EAP-TLS 1.2.[¶](#section-2.1-2){.pilcrow}

TLS 1.3 changes both the message flow and the handshake messages
compared to earlier versions of TLS. Therefore, much of [Section
2.1](https://www.rfc-editor.org/rfc/rfc5216#section-2.1){.relref} of
\[[RFC5216](#RFC5216){.xref}\] does not apply for TLS 1.3. Except for
Sections [2.2](#identity){.xref} and [5.7](#secres){.xref}, this update
applies only when TLS 1.3 is negotiated. When TLS 1.2 is negotiated,
then \[[RFC5216](#RFC5216){.xref}\]
applies.[¶](#section-2.1-3){.pilcrow}

TLS 1.3 introduces several new handshake messages including
HelloRetryRequest, NewSessionTicket, and KeyUpdate. In general, these
messages will be handled by the underlying TLS libraries and are not
visible to EAP-TLS; however, there are a few things to
note:[¶](#section-2.1-4){.pilcrow}

-   [The HelloRetryRequest is used by the server to reject the
    parameters offered in the ClientHello and suggest new parameters.
    When this message is encountered, it will increase the number of
    round trips used by the
    protocol.[¶](#section-2.1-5.1){.pilcrow}]{#section-2.1-5.1}
-   [The NewSessionTicket message is used to convey resumption
    information and is covered in Sections [2.1.2](#ticket){.xref} and
    [2.1.3](#resumption){.xref}.[¶](#section-2.1-5.2){.pilcrow}]{#section-2.1-5.2}
-   [The KeyUpdate message is used to update the traffic keys used on a
    TLS connection. EAP-TLS does not encrypt significant amounts of data
    so this functionality is not needed. Implementations [SHOULD
    NOT]{.bcp14} send this message; however, some TLS libraries may
    automatically generate and process this
    message.[¶](#section-2.1-5.3){.pilcrow}]{#section-2.1-5.3}
-   [Early Data [MUST NOT]{.bcp14} be used in EAP-TLS. EAP-TLS servers
    [MUST NOT]{.bcp14} send an early_data extension and clients [MUST
    NOT]{.bcp14} send an EndOfEarlyData
    message.[¶](#section-2.1-5.4){.pilcrow}]{#section-2.1-5.4}
-   [Post-handshake authentication [MUST NOT]{.bcp14} be used in
    EAP-TLS. Clients [MUST NOT]{.bcp14} send a \"post_handshake_auth\"
    extension and Servers [MUST NOT]{.bcp14} request post-handshake
    client
    authentication.[¶](#section-2.1-5.5){.pilcrow}]{#section-2.1-5.5}

After receiving an EAP-Request packet with EAP-Type=EAP-TLS as described
in \[[RFC5216](#RFC5216){.xref}\], the conversation will continue with
the TLS handshake protocol encapsulated in the data fields of
EAP-Response and EAP-Request packets. When EAP-TLS is used with TLS
version 1.3, the formatting and processing of the TLS handshake
[SHALL]{.bcp14} be done as specified in version 1.3 of TLS. This update
only lists additional and different requirements, restrictions, and
processing compared to \[[RFC8446](#RFC8446){.xref}\] and
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-2.1-6){.pilcrow}

::: {#section_auth}
::: {#section-2.1.1 .section}
#### [2.1.1.](#section-2.1.1){.section-number .selfRef} [Authentication](#name-authentication){.section-name .selfRef} {#name-authentication}

This section updates [Section
2.1.1](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.1){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.1.1-1){.pilcrow}

The EAP-TLS server [MUST]{.bcp14} authenticate with a certificate and
[SHOULD]{.bcp14} require the EAP-TLS peer to authenticate with a
certificate. Certificates can be of any type supported by TLS including
raw public keys. Pre-Shared Key (PSK) authentication [SHALL NOT]{.bcp14}
be used except for resumption. The full handshake in EAP-TLS with TLS
1.3 always provides forward secrecy by exchange of ephemeral
\"key_share\" extensions in the ClientHello and ServerHello (e.g.,
containing Ephemeral Elliptic Curve Diffie-Hellman (ECDHE) public keys).
SessionID is deprecated in TLS 1.3; see Sections
[4.1.2](https://www.rfc-editor.org/rfc/rfc8446#section-4.1.2){.relref}
and
[4.1.3](https://www.rfc-editor.org/rfc/rfc8446#section-4.1.3){.relref}
of \[[RFC8446](#RFC8446){.xref}\]. TLS 1.3 introduced early application
data that like all application data (other than the protected success
indication described below) is not used in EAP-TLS; see [Section
4.2.10](https://www.rfc-editor.org/rfc/rfc8446#section-4.2.10){.relref}
of \[[RFC8446](#RFC8446){.xref}\] for additional information on the
\"early_data\" extension. Resumption is handled as described in [Section
2.1.3](#resumption){.xref}. As a protected success indication
\[[RFC3748](#RFC3748){.xref}\], the EAP-TLS server always sends TLS
application data 0x00; see [Section 2.5](#state){.xref}. Note that a TLS
implementation [MAY]{.bcp14} not allow the EAP-TLS layer to control in
which order things are sent and the application data [MAY]{.bcp14}
therefore be sent before a NewSessionTicket. TLS application data 0x00
is therefore to be interpreted as success after the EAP-Request that
contains TLS application data 0x00. After the EAP-TLS server has sent an
EAP-Request containing the TLS application data 0x00 and received an
EAP-Response packet of EAP-Type=EAP-TLS and no data, the EAP-TLS server
sends EAP-Success.[¶](#section-2.1.1-2){.pilcrow}

[Figure 1](#figbase1){.xref} shows an example message flow for a
successful EAP-TLS full handshake with mutual authentication (and
neither HelloRetryRequest nor post-handshake messages are
sent).[¶](#section-2.1.1-3){.pilcrow}

[]{#name-eap-tls-mutual-authenticati}

::: {#figbase1}
::: {#section-2.1.1-4.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                               TLS CertificateRequest,
                                                      TLS Certificate,
                                                TLS CertificateVerify,
                                 <--------               TLS Finished)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Certificate,
     TLS CertificateVerify,
     TLS Finished)               -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <-------- (TLS Application Data 0x00)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Success
:::

[Figure 1](#figure-1){.selfRef}: [EAP-TLS Mutual
Authentication](#name-eap-tls-mutual-authenticati){.selfRef}
:::
:::
:::

::: {#ticket}
::: {#section-2.1.2 .section}
#### [2.1.2.](#section-2.1.2){.section-number .selfRef} [Ticket Establishment](#name-ticket-establishment){.section-name .selfRef} {#name-ticket-establishment}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-2.1.2-1){.pilcrow}

To enable resumption when using EAP-TLS with TLS 1.3, the EAP-TLS server
[MUST]{.bcp14} send one or more post-handshake NewSessionTicket messages
(each associated with a PSK, a PSK identity, a ticket lifetime, and
other parameters) in the initial authentication. Note that TLS 1.3
\[[RFC8446](#RFC8446){.xref}\] limits the ticket lifetime to a maximum
of 604800 seconds (7 days) and EAP-TLS servers [MUST]{.bcp14} respect
this upper limit when issuing tickets. The NewSessionTicket is sent
after the EAP-TLS server has received the client Finished message in the
initial authentication. The NewSessionTicket can be sent in the same
flight as the TLS server Finished or later. The PSK associated with the
ticket depends on the client Finished and cannot be pre-computed (so as
to be sent in the same flight as the TLS server Finished) in handshakes
with client authentication. The NewSessionTicket message [MUST
NOT]{.bcp14} include an \"early_data\" extension. If the \"early_data\"
extension is received, then it [MUST]{.bcp14} be ignored. Servers should
take into account that fewer NewSessionTickets will likely be needed in
EAP-TLS than in the usual HTTPS connection scenario. In most cases, a
single NewSessionTicket will be sufficient. A mechanism by which clients
can specify the desired number of tickets needed for future connections
is defined in
\[[TICKET-REQUESTS](#I-D.ietf-tls-ticketrequests){.xref}\].[¶](#section-2.1.2-2){.pilcrow}

[Figure 2](#figbase2){.xref} shows an example message flow for a
successful EAP-TLS full handshake with mutual authentication and ticket
establishment of a single ticket.[¶](#section-2.1.2-3){.pilcrow}

[]{#name-eap-tls-ticket-establishmen}

::: {#figbase2}
::: {#section-2.1.2-4.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                               TLS CertificateRequest,
                                                      TLS Certificate,
                                                TLS CertificateVerify,
                                 <--------               TLS Finished)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Certificate,
     TLS CertificateVerify,
     TLS Finished)               -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                (TLS NewSessionTicket,
                                 <-------- (TLS Application Data 0x00)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Success
:::

[Figure 2](#figure-2){.selfRef}: [EAP-TLS Ticket
Establishment](#name-eap-tls-ticket-establishmen){.selfRef}
:::
:::
:::

::: {#resumption}
::: {#section-2.1.3 .section}
#### [2.1.3.](#section-2.1.3){.section-number .selfRef} [Resumption](#name-resumption){.section-name .selfRef} {#name-resumption}

This section updates [Section
2.1.2](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.2){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.1.3-1){.pilcrow}

EAP-TLS is typically used with client authentication and typically
fragments the TLS flights into a large number of EAP-requests and
EAP-responses. Resumption significantly reduces the number of round
trips and enables the EAP-TLS server to omit database lookups needed
during a full handshake with client authentication. TLS 1.3 replaces the
session resumption mechanisms in earlier versions of TLS with a new PSK
exchange. When EAP-TLS is used with TLS version 1.3, EAP-TLS
[SHALL]{.bcp14} use a resumption mechanism compatible with version 1.3
of TLS.[¶](#section-2.1.3-2){.pilcrow}

For TLS 1.3, resumption is described in [Section
2.2](https://www.rfc-editor.org/rfc/rfc8446#section-2.2){.relref} of
\[[RFC8446](#RFC8446){.xref}\]. If the client has received a
NewSessionTicket message from the EAP-TLS server, the client can use the
PSK identity associated with the ticket to negotiate the use of the
associated PSK. If the EAP-TLS server accepts it, then the resumed
session has been deemed to be authenticated and securely associated with
the prior authentication or resumption. It is up to the EAP-TLS peer to
use resumption, but it is [RECOMMENDED]{.bcp14} that the EAP-TLS peer
use resumption if it has a valid ticket that has not been used before.
It is left to the EAP-TLS server whether to accept resumption, but it is
[RECOMMENDED]{.bcp14} that the EAP-TLS server accept resumption if the
ticket that was issued is still valid. However, the EAP-TLS server
[MAY]{.bcp14} choose to require a full handshake. In the case a full
handshake is required, the negotiation proceeds as if the session was a
new authentication, and the resumption attempt is ignored. The
requirements of Sections [2.1.1](#section_auth){.xref} and
[2.1.2](#ticket){.xref} then apply in their entirety. As described in
[Appendix
C.4](https://www.rfc-editor.org/rfc/rfc8446#appendix-C.4){.relref} of
\[[RFC8446](#RFC8446){.xref}\], reuse of a ticket allows passive
observers to correlate different connections. EAP-TLS peers and EAP-TLS
servers [SHOULD]{.bcp14} follow the client tracking preventions in
[Appendix
C.4](https://www.rfc-editor.org/rfc/rfc8446#appendix-C.4){.relref} of
\[[RFC8446](#RFC8446){.xref}\].[¶](#section-2.1.3-3){.pilcrow}

It is [RECOMMENDED]{.bcp14} to use Network Access Identifiers (NAIs)
with the same realm during resumption and the original full handshake.
This requirement allows EAP packets to be routed to the same destination
as the original full handshake. If this recommendation is not followed,
resumption is likely impossible. When NAI reuse can be done without
privacy implications, it is [RECOMMENDED]{.bcp14} to use the same NAI in
the resumption as was used in the original full handshake
\[[RFC7542](#RFC7542){.xref}\]. For example, the NAI \@realm can safely
be reused since it does not provide any specific information to
associate a user\'s resumption attempt with the original full handshake.
However, reusing the NAI P2ZIM2F+OEVAO21nNWg2bVpgNnU=\@realm enables an
on-path attacker to associate a resumption attempt with the original
full handshake. The TLS PSK identity is typically derived by the TLS
implementation and may be an opaque blob without a routable realm. The
TLS PSK identity on its own is therefore unsuitable as an NAI in the
Identity Response.[¶](#section-2.1.3-4){.pilcrow}

[Figure 3](#figresumption){.xref} shows an example message flow for a
subsequent successful EAP-TLS resumption handshake where both sides
authenticate via a PSK provisioned via an earlier NewSessionTicket and
where the server provisions a single new
ticket.[¶](#section-2.1.3-5){.pilcrow}

[]{#name-eap-tls-resumption}

::: {#figresumption}
::: {#section-2.1.3-6.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello
     + pre_shared_key)           -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                 <--------               TLS Finished,
                                                 TLS NewSessionTicket)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Finished)               -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <-------- (TLS Application Data 0x00)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Success
:::

[Figure 3](#figure-3){.selfRef}: [EAP-TLS
Resumption](#name-eap-tls-resumption){.selfRef}
:::

As specified in [Section
2.2](https://www.rfc-editor.org/rfc/rfc8446#section-2.2){.relref} of
\[[RFC8446](#RFC8446){.xref}\], the EAP-TLS peer [SHOULD]{.bcp14} supply
a \"key_share\" extension when attempting resumption, which allows the
EAP-TLS server to potentially decline resumption and fall back to a full
handshake. If the EAP-TLS peer did not supply a \"key_share\" extension
when attempting resumption, the EAP-TLS server needs to send a
HelloRetryRequest to signal that additional information is needed to
complete the handshake, and the EAP-TLS peer needs to send a second
ClientHello containing that information. Providing a \"key_share\" and
using the \"psk_dhe_ke\" pre-shared key exchange mode is also important
in order to limit the impact of a key compromise. When using
\"psk_dhe_ke\", TLS 1.3 provides forward secrecy meaning that compromise
of the PSK used for resumption does not compromise any earlier
connections. The \"psk_dh_ke\" key exchange mode [MUST]{.bcp14} be used
for resumption unless the deployment has a local requirement to allow
configuration of other mechanisms.[¶](#section-2.1.3-7){.pilcrow}
:::
:::

::: {#section-2.1.4 .section}
#### [2.1.4.](#section-2.1.4){.section-number .selfRef} [Termination](#name-termination){.section-name .selfRef} {#name-termination}

This section updates [Section
2.1.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.1.4-1){.pilcrow}

TLS 1.3 changes both the message flow and the handshake messages
compared to earlier versions of TLS. Therefore, some normative text in
[Section
2.1.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\] does not apply for TLS 1.3. The two
paragraphs below replace the corresponding paragraphs in [Section
2.1.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\] when EAP-TLS is used with TLS 1.3. The
other paragraphs in [Section
2.1.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\] still apply with the exception that
SessionID is deprecated.[¶](#section-2.1.4-2){.pilcrow}

If the EAP-TLS peer authenticates successfully, the EAP-TLS server
[MUST]{.bcp14} send an EAP-Request packet with EAP-Type=EAP-TLS
containing TLS records conforming to the version of TLS used. The
message flow ends with a protected success indication from the EAP-TLS
server, followed by an EAP-Response packet of EAP-Type=EAP-TLS and no
data from the EAP-TLS peer, followed by EAP-Success from the
server.[¶](#section-2.1.4-3){.pilcrow}

If the EAP-TLS server authenticates successfully, the EAP-TLS peer
[MUST]{.bcp14} send an EAP-Response message with EAP-Type=EAP-TLS
containing TLS records conforming to the version of TLS
used.[¶](#section-2.1.4-4){.pilcrow}

Figures [4](#figterm1){.xref}, [5](#figterm2){.xref}, and
[6](#figterm3){.xref} illustrate message flows in several cases where
the EAP-TLS peer or EAP-TLS server sends a TLS Error alert message. In
earlier versions of TLS, error alerts could be warnings or fatal. In TLS
1.3, error alerts are always fatal and the only alerts sent at warning
level are \"close_notify\" and \"user_canceled\", both of which indicate
that the connection is not going to continue normally; see
\[[RFC8446](#RFC8446){.xref}\].[¶](#section-2.1.4-5){.pilcrow}

In TLS 1.3 \[[RFC8446](#RFC8446){.xref}\], error alerts are not
mandatory to send after a fatal error condition. Failure to send TLS
Error alerts means that the peer or server would have no way of
determining what went wrong. EAP-TLS 1.3 strengthens this requirement.
Whenever an implementation encounters a fatal error condition, it
[MUST]{.bcp14} send an appropriate TLS Error
alert.[¶](#section-2.1.4-6){.pilcrow}

[Figure 4](#figterm1){.xref} shows an example message flow where the
EAP-TLS server rejects the ClientHello with an error alert. The EAP-TLS
server can also partly reject the ClientHello with a HelloRetryRequest;
see [Section 2.1.6](#helloretry){.xref}.[¶](#section-2.1.4-7){.pilcrow}

[]{#name-eap-tls-server-rejection-of}

::: {#figterm1}
::: {#section-2.1.4-8.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------           (TLS Error Alert)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Failure
:::

[Figure 4](#figure-4){.selfRef}: [EAP-TLS Server Rejection of
ClientHello](#name-eap-tls-server-rejection-of){.selfRef}
:::

[Figure 5](#figterm2){.xref} shows an example message flow where EAP-TLS
server authentication is unsuccessful and the EAP-TLS peer sends a TLS
Error alert.[¶](#section-2.1.4-9){.pilcrow}

[]{#name-eap-tls-unsuccessful-eap-tl}

::: {#figterm2}
::: {#section-2.1.4-10.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                               TLS CertificateRequest,
                                                      TLS Certificate,
                                                TLS CertificateVerify,
                                 <--------               TLS Finished)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Error Alert)
                                 -------->
                                 <--------               EAP-Failure
:::

[Figure 5](#figure-5){.selfRef}: [EAP-TLS Unsuccessful EAP-TLS Server
Authentication](#name-eap-tls-unsuccessful-eap-tl){.selfRef}
:::

[Figure 6](#figterm3){.xref} shows an example message flow where the
EAP-TLS server authenticates to the EAP-TLS peer successfully, but the
EAP-TLS peer fails to authenticate to the EAP-TLS server and the server
sends a TLS Error alert.[¶](#section-2.1.4-11){.pilcrow}

[]{#name-eap-tls-unsuccessful-client}

::: {#figterm3}
::: {#section-2.1.4-12.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                               TLS CertificateRequest,
                                                      TLS Certificate,
                                                TLS CertificateVerify,
                                 <--------               TLS Finished)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Certificate,
     TLS CertificateVerify,
     TLS Finished)               -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------           (TLS Error Alert)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Failure
:::

[Figure 6](#figure-6){.selfRef}: [EAP-TLS Unsuccessful Client
Authentication](#name-eap-tls-unsuccessful-client){.selfRef}
:::
:::

::: {#section-2.1.5 .section}
#### [2.1.5.](#section-2.1.5){.section-number .selfRef} [No Peer Authentication](#name-no-peer-authentication){.section-name .selfRef} {#name-no-peer-authentication}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-2.1.5-1){.pilcrow}

[Figure 7](#figbase3){.xref} shows an example message flow for a
successful EAP-TLS full handshake without peer authentication (e.g.,
emergency services, as described in
\[[RFC7406](#RFC7406){.xref}\]).[¶](#section-2.1.5-2){.pilcrow}

[]{#name-eap-tls-without-peer-authen}

::: {#figbase3}
::: {#section-2.1.5-3.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                                      TLS Certificate,
                                                TLS CertificateVerify,
                                 <--------               TLS Finished)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Finished)               -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <-------- (TLS Application Data 0x00)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Success
:::

[Figure 7](#figure-7){.selfRef}: [EAP-TLS without Peer
Authentication](#name-eap-tls-without-peer-authen){.selfRef}
:::
:::

::: {#helloretry}
::: {#section-2.1.6 .section}
#### [2.1.6.](#section-2.1.6){.section-number .selfRef} [Hello Retry Request](#name-hello-retry-request){.section-name .selfRef} {#name-hello-retry-request}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-2.1.6-1){.pilcrow}

As defined in TLS 1.3 \[[RFC8446](#RFC8446){.xref}\], EAP-TLS servers
can send a HelloRetryRequest message in response to a ClientHello if the
EAP-TLS server finds an acceptable set of parameters but the initial
ClientHello does not contain all the needed information to continue the
handshake. One use case is if the EAP-TLS server does not support the
groups in the \"key_share\" extension (or there is no \"key_share\"
extension) but supports one of the groups in the \"supported_groups\"
extension. In this case, the client should send a new ClientHello with a
\"key_share\" that the EAP-TLS server
supports.[¶](#section-2.1.6-2){.pilcrow}

[Figure 8](#fighelloretryrequest){.xref} shows an example message flow
for a successful EAP-TLS full handshake with mutual authentication and
HelloRetryRequest. Note the extra round trip as a result of the
HelloRetryRequest.[¶](#section-2.1.6-3){.pilcrow}

[]{#name-eap-tls-with-hello-retry-re}

::: {#fighelloretryrequest}
::: {#section-2.1.6-4.1 .alignLeft .art-text .artwork}
     EAP-TLS Peer                                      EAP-TLS Server

                                                          EAP-Request/
                                 <--------                   Identity
     EAP-Response/
     Identity (Privacy-Friendly) -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <--------                 (TLS Start)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                               (TLS HelloRetryRequest)
                                 <--------
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS ClientHello)            -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                                     (TLS ServerHello,
                                              TLS EncryptedExtensions,
                                               TLS CertificateRequest,
                                                      TLS Certificate,
                                                TLS CertificateVerify,
                                                         TLS Finished)
     EAP-Response/
     EAP-Type=EAP-TLS
    (TLS Certificate,
     TLS CertificateVerify,
     TLS Finished)               -------->
                                                          EAP-Request/
                                                     EAP-Type=EAP-TLS
                                 <-------- (TLS Application Data 0x00)
     EAP-Response/
     EAP-Type=EAP-TLS            -------->
                                 <--------                EAP-Success
:::

[Figure 8](#figure-8){.selfRef}: [EAP-TLS with Hello Retry
Request](#name-eap-tls-with-hello-retry-re){.selfRef}
:::
:::
:::

::: {#section-2.1.7 .section}
#### [2.1.7.](#section-2.1.7){.section-number .selfRef} [Identity](#name-identity){.section-name .selfRef} {#name-identity}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-2.1.7-1){.pilcrow}

It is [RECOMMENDED]{.bcp14} to use anonymous NAIs
\[[RFC7542](#RFC7542){.xref}\] in the Identity Response as such
identities are routable and privacy-friendly. While opaque blobs are
allowed by \[[RFC3748](#RFC3748){.xref}\], such identities are [NOT
RECOMMENDED]{.bcp14} as they are not routable and should only be
considered in local deployments where the EAP-TLS peer, EAP
authenticator, and EAP-TLS server all belong to the same network. Many
client certificates contain an identity such as an email address, which
is already in NAI format. When the client certificate contains an NAI as
subject name or alternative subject name, an anonymous NAI
[SHOULD]{.bcp14} be derived from the NAI in the certificate; see
[Section 2.1.8](#privacy){.xref}. More details on identities are
described in Sections [2.1.3](#resumption){.xref},
[2.1.8](#privacy){.xref}, [2.2](#identity){.xref}, and
[5.8](#privcon){.xref}.[¶](#section-2.1.7-2){.pilcrow}
:::

::: {#privacy}
::: {#section-2.1.8 .section}
#### [2.1.8.](#section-2.1.8){.section-number .selfRef} [Privacy](#name-privacy){.section-name .selfRef} {#name-privacy}

This section updates [Section
2.1.4](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.4){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.1.8-1){.pilcrow}

EAP-TLS 1.3 significantly improves privacy when compared to earlier
versions of EAP-TLS. EAP-TLS 1.3 forbids cipher suites without
confidentiality, which means that TLS 1.3 is always encrypting large
parts of the TLS handshake including the certificate
messages.[¶](#section-2.1.8-2){.pilcrow}

EAP-TLS peer and server implementations supporting TLS 1.3
[MUST]{.bcp14} support anonymous Network Access Identifiers (NAIs)
([Section
2.4](https://www.rfc-editor.org/rfc/rfc7542#section-2.4){.relref} of
\[[RFC7542](#RFC7542){.xref}\]). A client supporting TLS 1.3 [MUST
NOT]{.bcp14} send its username (or any other permanent identifiers) in
cleartext in the Identity Response (or any message used instead of the
Identity Response). Following \[[RFC7542](#RFC7542){.xref}\], it is
[RECOMMENDED]{.bcp14} to omit the username (i.e., the NAI is \@realm),
but other constructions such as a fixed username (e.g.,
anonymous\@realm) or an encrypted username (e.g.,
xCZINCPTK5+7y81CrSYbPg+RKPE3OTrYLn4AQc4AC2U=\@realm) are allowed. Note
that the NAI [MUST]{.bcp14} be a UTF-8 string as defined by the grammar
in [Section
2.2](https://www.rfc-editor.org/rfc/rfc7542#section-2.2){.relref} of
\[[RFC7542](#RFC7542){.xref}\].[¶](#section-2.1.8-3){.pilcrow}

The HelloRequest message used for privacy in EAP-TLS 1.2 does not exist
in TLS 1.3 but as the certificate messages in TLS 1.3 are encrypted,
there is no need to send an empty certificate_list and perform a second
handshake for privacy (as needed by EAP-TLS with earlier versions of
TLS). When EAP-TLS is used with TLS version 1.3, the EAP-TLS peer and
EAP-TLS server [SHALL]{.bcp14} follow the processing specified by
version 1.3 of TLS. This means that the EAP-TLS peer only sends an empty
certificate_list if it does not have an appropriate certificate to send,
and the EAP-TLS server [MAY]{.bcp14} treat an empty certificate_list as
a terminal condition.[¶](#section-2.1.8-4){.pilcrow}

EAP-TLS with TLS 1.3 is always used with privacy. This does not add any
extra round trips and the message flow with privacy is just the normal
message flow as shown in [Figure
1](#figbase1){.xref}.[¶](#section-2.1.8-5){.pilcrow}
:::
:::

::: {#section-2.1.9 .section}
#### [2.1.9.](#section-2.1.9){.section-number .selfRef} [Fragmentation](#name-fragmentation){.section-name .selfRef} {#name-fragmentation}

This section updates [Section
2.1.5](https://www.rfc-editor.org/rfc/rfc5216#section-2.1.5){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.1.9-1){.pilcrow}

Including ContentType (1 byte), ProtocolVersion (2 bytes), and length (2
bytes) headers, a single TLS record may be up to 16645 octets in length.
EAP-TLS fragmentation support is provided through addition of a flags
octet within the EAP-Response and EAP-Request packets, as well as a
(conditional) TLS Message Length field of four octets. Implementations
[MUST NOT]{.bcp14} set the L bit in unfragmented messages, but they
[MUST]{.bcp14} accept unfragmented messages with and without the L bit
set.[¶](#section-2.1.9-2){.pilcrow}

Some EAP implementations and access networks may limit the number of EAP
packet exchanges that can be handled. To avoid fragmentation, it is
[RECOMMENDED]{.bcp14} to keep the sizes of EAP-TLS peer, EAP-TLS server,
and trust anchor certificates small and the length of the certificate
chains short. In addition, it is [RECOMMENDED]{.bcp14} to use mechanisms
that reduce the sizes of Certificate messages. For a detailed discussion
on reducing message sizes to prevent fragmentation, see
\[[RFC9191](#RFC9191){.xref}\].[¶](#section-2.1.9-3){.pilcrow}
:::
:::

::: {#identity}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Identity Verification](#name-identity-verification){.section-name .selfRef} {#name-identity-verification}

This section replaces [Section
2.2](https://www.rfc-editor.org/rfc/rfc5216#section-2.2){.relref} of
\[[RFC5216](#RFC5216){.xref}\] with the following discussion. The
guidance in this section is relevant for EAP-TLS in general (regardless
of the underlying TLS version used).[¶](#section-2.2-1){.pilcrow}

The EAP peer identity provided in the EAP-Response/Identity is not
authenticated by EAP-TLS. Unauthenticated information [MUST NOT]{.bcp14}
be used for accounting purposes or to give authorization. The
authenticator and the EAP-TLS server [MAY]{.bcp14} examine the identity
presented in EAP-Response/Identity for purposes such as routing and EAP
method selection. EAP-TLS servers [MAY]{.bcp14} reject conversations if
the identity does not match their policy. Note that this also applies to
resumption; see Sections [2.1.3](#resumption){.xref},
[5.6](#secauth){.xref}, and
[5.7](#secres){.xref}.[¶](#section-2.2-2){.pilcrow}

The EAP server identity in the TLS server certificate is typically a
fully qualified domain name (FQDN) in the SubjectAltName (SAN)
extension. Since EAP-TLS deployments may use more than one EAP server,
each with a different certificate, EAP peer implementations
[SHOULD]{.bcp14} allow for the configuration of one or more trusted root
certificates (CA certificate) to authenticate the server certificate and
one or more server names to match against the SubjectAltName (SAN)
extension in the server certificate. If any of the configured names
match any of the names in the SAN extension, then the name check passes.
To simplify name matching, an EAP-TLS deployment can assign a name to
represent an authorized EAP server and EAP Server certificates can
include this name in the list of SANs for each certificate that
represents an EAP-TLS server. If server name matching is not used, then
it degrades the confidence that the EAP server with which it is
interacting is authoritative for the given network. If name matching is
not used with a public root CA, then effectively any server can obtain a
certificate that will be trusted for EAP authentication by the peer.
While this guidance to verify domain names is new, and was not mentioned
in \[[RFC5216](#RFC5216){.xref}\], it has been widely implemented in
EAP-TLS peers. As such, it is believed that this section contains
minimal new interoperability or implementation requirements on EAP-TLS
peers and can be applied to earlier versions of
TLS.[¶](#section-2.2-3){.pilcrow}

The process of configuring a root CA certificate and a server name is
non-trivial; therefore, automated methods of provisioning are
[RECOMMENDED]{.bcp14}. For example, the eduroam federation
\[[RFC7593](#RFC7593){.xref}\] provides a Configuration Assistant Tool
(CAT) to automate the configuration process. In the absence of a trusted
root CA certificate (user configured or system-wide), EAP peers
[MAY]{.bcp14} implement a trust on first use (TOFU) mechanism where the
peer trusts and stores the server certificate during the first
connection attempt. The EAP peer ensures that the server presents the
same stored certificate on subsequent interactions. Use of a TOFU
mechanism does not allow for the server certificate to change without
out-of-band validation of the certificate and is therefore not suitable
for many deployments including ones where multiple EAP servers are
deployed for high availability. TOFU mechanisms increase the
susceptibility to traffic interception attacks and should only be used
if there are adequate controls in place to mitigate this
risk.[¶](#section-2.2-4){.pilcrow}
:::
:::

::: {#keyhierarchy}
::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Key Hierarchy](#name-key-hierarchy){.section-name .selfRef} {#name-key-hierarchy}

This section updates [Section
2.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by replacing it in accordance with the
following discussion.[¶](#section-2.3-1){.pilcrow}

TLS 1.3 replaces the TLS pseudorandom function (PRF) used in earlier
versions of TLS with the HMAC-based Key Derivation Function (HKDF) and
completely changes the key schedule. The key hierarchies shown in
[Section
2.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\] are therefore not correct when EAP-TLS is
used with TLS version 1.3. For TLS 1.3 the key schedule is described in
[Section
7.1](https://www.rfc-editor.org/rfc/rfc8446#section-7.1){.relref} of
\[[RFC8446](#RFC8446){.xref}\].[¶](#section-2.3-2){.pilcrow}

When EAP-TLS is used with TLS version 1.3, the Key_Material and
Method-Id [SHALL]{.bcp14} be derived from the exporter_secret using the
TLS exporter interface \[[RFC5705](#RFC5705){.xref}\] (for TLS 1.3, this
is defined in [Section
7.5](https://www.rfc-editor.org/rfc/rfc8446#section-7.5){.relref} of
\[[RFC8446](#RFC8446){.xref}\]). Type is the value of the EAP Type field
defined in [Section
2](https://www.rfc-editor.org/rfc/rfc3748#section-2){.relref} of
\[[RFC3748](#RFC3748){.xref}\]. For EAP-TLS, the Type field has value
0x0D.[¶](#section-2.3-3){.pilcrow}

::: {#section-2.3-4}
``` sourcecode
Type = 0x0D
Key_Material = TLS-Exporter("EXPORTER_EAP_TLS_Key_Material",
                            Type, 128)
Method-Id    = TLS-Exporter("EXPORTER_EAP_TLS_Method-Id",
                            Type, 64)
Session-Id   = Type || Method-Id
```

[¶](#section-2.3-4){.pilcrow}
:::

The MSK and EMSK are derived from the Key_Material in the same manner as
with EAP-TLS \[[RFC5216](#RFC5216){.xref}\], [Section
2.3](https://www.rfc-editor.org/rfc/rfc5216#section-2.3){.relref}. The
definitions are repeated below for
simplicity:[¶](#section-2.3-5){.pilcrow}

::: {#section-2.3-6}
``` sourcecode
MSK          = Key_Material(0, 63)
EMSK         = Key_Material(64, 127)
```

[¶](#section-2.3-6){.pilcrow}
:::

Other TLS-based EAP methods can use the TLS exporter in a similar
fashion; see
\[[TLS-EAP-TYPES](#I-D.ietf-emu-tls-eap-types){.xref}\].[¶](#section-2.3-7){.pilcrow}

\[[RFC5247](#RFC5247){.xref}\] deprecates the use of an Initialization
Vector (IV). Thus, RECV-IV and SEND-IV are not exported in EAP-TLS with
TLS 1.3. As noted in \[[RFC5247](#RFC5247){.xref}\], lower layers use
the MSK in a lower-layer-dependent manner. EAP-TLS with TLS 1.3 exports
the MSK and does not specify how it is used by lower
layers.[¶](#section-2.3-8){.pilcrow}

Note that the key derivation [MUST]{.bcp14} use the length values given
above. While in TLS 1.2 and earlier it was possible to truncate the
output by requesting less data from the TLS-Exporter function, this
practice is not possible with TLS 1.3. If an implementation intends to
use only a part of the output of the TLS-Exporter function, then it
[MUST]{.bcp14} ask for the full output and then only use the desired
part. Failure to do so will result in incorrect values being calculated
for the above keying material.[¶](#section-2.3-9){.pilcrow}

By using the TLS exporter, EAP-TLS can use any TLS 1.3 implementation
that provides a public API for the exporter. Note that when TLS 1.2 is
used with the EAP-TLS exporter \[[RFC5705](#RFC5705){.xref}\] it
generates the same key material as in EAP-TLS
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-2.3-10){.pilcrow}
:::
:::

::: {#section-2.4 .section}
### [2.4.](#section-2.4){.section-number .selfRef} [Parameter Negotiation and Compliance Requirements](#name-parameter-negotiation-and-c){.section-name .selfRef} {#name-parameter-negotiation-and-c}

This section updates [Section
2.4](https://www.rfc-editor.org/rfc/rfc5216#section-2.4){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-2.4-1){.pilcrow}

TLS 1.3 cipher suites are defined differently than in earlier versions
of TLS (see [Appendix
B.4](https://www.rfc-editor.org/rfc/rfc8446#appendix-B.4){.relref} of
\[[RFC8446](#RFC8446){.xref}\]), and the cipher suites discussed in
[Section
2.4](https://www.rfc-editor.org/rfc/rfc5216#section-2.4){.relref} of
\[[RFC5216](#RFC5216){.xref}\] can therefore not be used when EAP-TLS is
used with TLS version 1.3.[¶](#section-2.4-2){.pilcrow}

When EAP-TLS is used with TLS version 1.3, the EAP-TLS peers and EAP-TLS
servers [MUST]{.bcp14} comply with the compliance requirements
(mandatory-to-implement cipher suites, signature algorithms, key
exchange algorithms, extensions, etc.) defined in [Section
9](https://www.rfc-editor.org/rfc/rfc8446#section-9){.relref} of
\[[RFC8446](#RFC8446){.xref}\]. In EAP-TLS with TLS 1.3, only cipher
suites with confidentiality [SHALL]{.bcp14} be
supported.[¶](#section-2.4-3){.pilcrow}

While EAP-TLS does not protect any application data except for the 0x00
byte that serves as protected success indication, the negotiated cipher
suites and algorithms [MAY]{.bcp14} be used to secure data as done in
other TLS-based EAP methods.[¶](#section-2.4-4){.pilcrow}
:::

::: {#state}
::: {#section-2.5 .section}
### [2.5.](#section-2.5){.section-number .selfRef} [EAP State Machines](#name-eap-state-machines){.section-name .selfRef} {#name-eap-state-machines}

This is a new section when compared to \[[RFC5216](#RFC5216){.xref}\]
and only applies to TLS 1.3. \[[RFC4137](#RFC4137){.xref}\] offers a
proposed state machine for EAP.[¶](#section-2.5-1){.pilcrow}

TLS 1.3 \[[RFC8446](#RFC8446){.xref}\] introduces post-handshake
messages. These post-handshake messages use the handshake content type
and can be sent after the main handshake. Examples of post-handshake
messages are NewSessionTicket, which is used for resumption and
KeyUpdate, which is not useful and not expected in EAP-TLS. After
sending TLS Finished, the EAP-TLS server may send any number of
post-handshake messages in one or more
EAP-Requests.[¶](#section-2.5-2){.pilcrow}

To provide a protected success result indication and to decrease the
uncertainty for the EAP-TLS peer, the following procedure [MUST]{.bcp14}
be followed:[¶](#section-2.5-3){.pilcrow}

When an EAP-TLS server has successfully processed the TLS client
Finished and sent its last handshake message (Finished or a
post-handshake message), it sends an encrypted TLS record with
application data 0x00. The encrypted TLS record with application data
0x00 is a protected success result indication, as defined in
\[[RFC3748](#RFC3748){.xref}\]. After sending an EAP-Request that
contains the protected success result indication, the EAP-TLS server
must not send any more EAP-Requests and may only send an EAP-Success.
The EAP-TLS server [MUST NOT]{.bcp14} send an encrypted TLS record with
application data 0x00 before it has successfully processed the client
Finished and sent its last handshake
message.[¶](#section-2.5-4){.pilcrow}

TLS Error alerts [SHOULD]{.bcp14} be considered a failure result
indication, as defined in \[[RFC3748](#RFC3748){.xref}\].
Implementations following \[[RFC4137](#RFC4137){.xref}\] set the
alternate indication of failure variable altReject after sending or
receiving an error alert. After sending or receiving a TLS Error alert,
the EAP-TLS server may only send an EAP-Failure. Protected TLS Error
alerts are protected failure result indications, and unprotected TLS
Error alerts are not.[¶](#section-2.5-5){.pilcrow}

The keying material can be derived after the TLS server Finished has
been sent or received. Implementations following
\[[RFC4137](#RFC4137){.xref}\] can then set the eapKeyData and
aaaEapKeyData variables.[¶](#section-2.5-6){.pilcrow}

The keying material can be made available to lower layers and the
authenticator after the authenticated success result indication has been
sent or received. Implementations following
\[[RFC4137](#RFC4137){.xref}\] can set the eapKeyAvailable and
aaaEapKeyAvailable variables.[¶](#section-2.5-7){.pilcrow}
:::
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Detailed Description of the EAP-TLS Protocol](#name-detailed-description-of-the){.section-name .selfRef} {#name-detailed-description-of-the}

There are no updates to [Section
3](https://www.rfc-editor.org/rfc/rfc5216#section-3){.relref} of
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-3-1){.pilcrow}
:::

::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This section provides guidance to the Internet Assigned Numbers
Authority (IANA) regarding registration of values related to EAP-TLS 1.3
in accordance with
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-4-1){.pilcrow}

Per this document, IANA has added the following labels to the \"TLS
Exporter Labels\" registry defined by \[[RFC5705](#RFC5705){.xref}\].
These labels are used in derivation of Key_Material and Method-Id as
defined in [Section
2.3](#keyhierarchy){.xref}:[¶](#section-4-2){.pilcrow}

[]{#name-tls-exporter-labels}

::: {#exporter-label}
  Value                           DTLS-OK   Recommended   Note
  ------------------------------- --------- ------------- ------
  EXPORTER_EAP_TLS_Key_Material   N         Y             
  EXPORTER_EAP_TLS_Method-Id      N         Y             

  : [Table 1](#table-1){.selfRef}: [TLS Exporter
  Labels](#name-tls-exporter-labels){.selfRef}
:::
:::

::: {#seccon}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations of TLS 1.3 \[[RFC8446](#RFC8446){.xref}\]
apply to EAP-TLS 1.3.[¶](#section-5-1){.pilcrow}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Security Claims](#name-security-claims){.section-name .selfRef} {#name-security-claims}

Using EAP-TLS with TLS 1.3 does not change the security claims for
EAP-TLS as given in [Section
5.1](https://www.rfc-editor.org/rfc/rfc5216#section-5.1){.relref} of
\[[RFC5216](#RFC5216){.xref}\]. However, it strengthens several of the
claims as described in the following updates to the notes given in
[Section
5.1](https://www.rfc-editor.org/rfc/rfc5216#section-5.1){.relref} of
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-5.1-1){.pilcrow}

[]{.break}

\[1\] Mutual authentication:
:   By mandating revocation checking of certificates, the authentication
    in EAP-TLS with TLS 1.3 is stronger as authentication with revoked
    certificates will always fail.[¶](#section-5.1-2.2){.pilcrow}
:   

\[2\] Confidentiality:
:   The TLS 1.3 handshake offers much better confidentiality than
    earlier versions of TLS. EAP-TLS with TLS 1.3 mandates use of cipher
    suites that ensure confidentiality. TLS 1.3 also encrypts
    certificates and some of the extensions. When using EAP-TLS with TLS
    1.3, the use of privacy is mandatory and does not cause any
    additional round trips.[¶](#section-5.1-2.4){.pilcrow}
:   

\[3\] Cryptographic strength:
:   TLS 1.3 only defines strong algorithms without major weaknesses and
    EAP-TLS with TLS 1.3 always provides forward secrecy; see
    \[[RFC8446](#RFC8446){.xref}\]. Weak algorithms such as 3DES, CBC
    mode, RC4, SHA-1, MD5, P-192, and RSA-1024 have not been registered
    for use in TLS 1.3.[¶](#section-5.1-2.6){.pilcrow}
:   

\[4\] Cryptographic negotiation:
:   The TLS layer handles the negotiation of cryptographic parameters.
    When EAP-TLS is used with TLS 1.3, EAP-TLS inherits the
    cryptographic negotiation of the AEAD algorithm, HKDF hash
    algorithm, key exchange groups, and signature algorithm; see
    [Section
    4.1.1](https://www.rfc-editor.org/rfc/rfc8446#section-4.1.1){.relref}
    of \[[RFC8446](#RFC8446){.xref}\].[¶](#section-5.1-2.8){.pilcrow}
:   
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Peer and Server Identities](#name-peer-and-server-identities){.section-name .selfRef} {#name-peer-and-server-identities}

No updates to [Section
5.2](https://www.rfc-editor.org/rfc/rfc5216#section-5.2){.relref} of
\[[RFC5216](#RFC5216){.xref}\]. Note that [Section
2.2](#identity){.xref} has additional discussion on
identities.[¶](#section-5.2-1){.pilcrow}
:::

::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Certificate Validation](#name-certificate-validation){.section-name .selfRef} {#name-certificate-validation}

No updates to [Section
5.3](https://www.rfc-editor.org/rfc/rfc5216#section-5.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\]. In addition to [Section
5.3](https://www.rfc-editor.org/rfc/rfc5216#section-5.3){.relref} of
\[[RFC5216](#RFC5216){.xref}\], guidance on server certificate
validation can be found in
\[[RFC6125](#RFC6125){.xref}\].[¶](#section-5.3-1){.pilcrow}
:::

::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Certificate Revocation](#name-certificate-revocation){.section-name .selfRef} {#name-certificate-revocation}

This section updates [Section
5.4](https://www.rfc-editor.org/rfc/rfc5216#section-5.4){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-5.4-1){.pilcrow}

There are a number of reasons (e.g., key compromise, CA compromise,
privilege withdrawn, etc.) why EAP-TLS peer, EAP-TLS server, or sub-CA
certificates have to be revoked before their expiry date. Revocation of
the EAP-TLS server\'s certificate is complicated by the fact that the
EAP-TLS peer may not have Internet connectivity until authentication
completes.[¶](#section-5.4-2){.pilcrow}

When EAP-TLS is used with TLS 1.3, the revocation status of all the
certificates in the certificate chains [MUST]{.bcp14} be checked (except
the trust anchor). An implementation may use the Certificate Revocation
List (CRL), Online Certificate Status Protocol (OSCP), or other
standardized/proprietary methods for revocation checking. Examples of
proprietary methods are non-standard formats for distribution of
revocation lists as well as certificates with very short
lifetime.[¶](#section-5.4-3){.pilcrow}

EAP-TLS servers supporting TLS 1.3 [MUST]{.bcp14} implement Certificate
Status Requests (OCSP stapling) as specified in
\[[RFC6066](#RFC6066){.xref}\] and [Section
4.4.2.1](https://www.rfc-editor.org/rfc/rfc8446#section-4.4.2.1){.relref}
of \[[RFC8446](#RFC8446){.xref}\]. It is [RECOMMENDED]{.bcp14} that
EAP-TLS peers and EAP-TLS servers use OCSP stapling for verifying the
status of the EAP-TLS server\'s certificate chain. When an EAP-TLS peer
uses Certificate Status Requests to check the revocation status of the
EAP-TLS server\'s certificate chain, it [MUST]{.bcp14} treat a
CertificateEntry (but not the trust anchor) without a valid
CertificateStatus extension as invalid and abort the handshake with an
appropriate alert. The OCSP status handling in TLS 1.3 is different from
earlier versions of TLS; see [Section
4.4.2.1](https://www.rfc-editor.org/rfc/rfc8446#section-4.4.2.1){.relref}
of \[[RFC8446](#RFC8446){.xref}\]. In TLS 1.3, the OCSP information is
carried in the CertificateEntry containing the associated certificate
instead of a separate CertificateStatus message as in
\[[RFC6066](#RFC6066){.xref}\]. This enables sending OCSP information
for all certificates in the certificate chain (except the trust
anchor).[¶](#section-5.4-4){.pilcrow}

To enable revocation checking in situations where EAP-TLS peers do not
implement or use OCSP stapling, and where network connectivity is not
available prior to authentication completion, EAP-TLS peer
implementations [MUST]{.bcp14} also support checking for certificate
revocation after authentication completes and network connectivity is
available. An EAP peer implementation [SHOULD NOT]{.bcp14} trust the
network (and any services) until it has verified the revocation status
of the server certificate after receiving network connectivity. An EAP
peer [MUST]{.bcp14} use a secure transport to verify the revocation
status of the server certificate. An EAP peer [SHOULD NOT]{.bcp14} send
any other traffic before revocation checking for the server certificate
is complete.[¶](#section-5.4-5){.pilcrow}
:::

::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Packet Modification Attacks](#name-packet-modification-attacks){.section-name .selfRef} {#name-packet-modification-attacks}

This section updates [Section
5.5](https://www.rfc-editor.org/rfc/rfc5216#section-5.5){.relref} of
\[[RFC5216](#RFC5216){.xref}\] by amending it in accordance with the
following discussion.[¶](#section-5.5-1){.pilcrow}

As described in \[[RFC3748](#RFC3748){.xref}\] and [Section
5.5](https://www.rfc-editor.org/rfc/rfc5216#section-5.5){.relref} of
\[[RFC5216](#RFC5216){.xref}\], the only information that is integrity
and replay protected in EAP-TLS are the parts of the TLS Data that TLS
protects. All other information in the EAP-TLS message exchange
including EAP-Request and EAP-Response headers, the identity in the
Identity Response, EAP-TLS packet header fields, Type, Flags,
EAP-Success, and EAP-Failure can be modified, spoofed, or
replayed.[¶](#section-5.5-2){.pilcrow}

Protected TLS Error alerts are protected failure result indications and
enable the EAP-TLS peer and EAP-TLS server to determine that the failure
result was not spoofed by an attacker. Protected failure result
indications provide integrity and replay protection but [MAY]{.bcp14} be
unauthenticated. Protected failure results do not significantly improve
availability as TLS 1.3 treats most malformed data as a fatal
error.[¶](#section-5.5-3){.pilcrow}
:::

::: {#secauth}
::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [Authorization](#name-authorization){.section-name .selfRef} {#name-authorization}

This is a new section when compared to \[[RFC5216](#RFC5216){.xref}\].
The guidance in this section is relevant for EAP-TLS in general
(regardless of the underlying TLS version
used).[¶](#section-5.6-1){.pilcrow}

EAP servers will usually require the EAP peer to provide a valid
certificate and will fail the connection if one is not provided. Some
deployments may permit no peer authentication for some or all
connections. When peer authentication is not used, EAP-TLS server
implementations [MUST]{.bcp14} take care to limit network access
appropriately for unauthenticated peers, and implementations
[MUST]{.bcp14} use resumption with caution to ensure that a resumed
session is not granted more privilege than was intended for the original
session. An example of limiting network access would be to invoke a
vendor\'s walled garden or quarantine network
functionality.[¶](#section-5.6-2){.pilcrow}

EAP-TLS is typically encapsulated in other protocols such as PPP
\[[RFC1661](#RFC1661){.xref}\], RADIUS \[[RFC2865](#RFC2865){.xref}\],
Diameter \[[RFC6733](#RFC6733){.xref}\], or the Protocol for Carrying
Authentication for Network Access (PANA) \[[RFC5191](#RFC5191){.xref}\].
The encapsulating protocols can also provide additional, non-EAP
information to an EAP-TLS server. This information can include, but is
not limited to, information about the authenticator, information about
the EAP-TLS peer, or information about the protocol layers above or
below EAP (MAC addresses, IP addresses, port numbers, Wi-Fi Service Set
Identifiers (SSIDs), etc.). EAP-TLS servers implementing EAP-TLS inside
those protocols can make policy decisions and enforce authorization
based on a combination of information from the EAP-TLS exchange and
non-EAP information.[¶](#section-5.6-3){.pilcrow}

As noted in [Section 2.2](#identity){.xref}, the identity presented in
EAP-Response/Identity is not authenticated by EAP-TLS and is therefore
trivial for an attacker to forge, modify, or replay. Authorization and
accounting [MUST]{.bcp14} be based on authenticated information such as
information in the certificate or the PSK identity and cached data
provisioned for resumption as described in [Section
5.7](#secres){.xref}. Note that the requirements for Network Access
Identifiers (NAIs) specified in [Section
4](https://www.rfc-editor.org/rfc/rfc7542#section-4){.relref} of
\[[RFC7542](#RFC7542){.xref}\] still apply and [MUST]{.bcp14} be
followed.[¶](#section-5.6-4){.pilcrow}

EAP-TLS servers [MAY]{.bcp14} reject conversations based on non-EAP
information provided by the encapsulating protocol, for example if the
MAC address of the authenticator does not match the expected
policy.[¶](#section-5.6-5){.pilcrow}

In addition to allowing configuration of one or more trusted root
certificates (CA certificate) to authenticate the server certificate and
one or more server names to match against the SubjectAltName (SAN)
extension, EAP peer implementations [MAY]{.bcp14} allow binding the
configured acceptable SAN to a specific CA (or CAs) that should have
issued the server certificate to prevent attacks from rogue or
compromised CAs.[¶](#section-5.6-6){.pilcrow}
:::
:::

::: {#secres}
::: {#section-5.7 .section}
### [5.7.](#section-5.7){.section-number .selfRef} [Resumption](#name-resumption-2){.section-name .selfRef} {#name-resumption-2}

This is a new section when compared to \[[RFC5216](#RFC5216){.xref}\].
The guidance in this section is relevant for EAP-TLS in general
(regardless of the underlying TLS version
used).[¶](#section-5.7-1){.pilcrow}

There are a number of security issues related to resumption that are not
described in \[[RFC5216](#RFC5216){.xref}\]. The problems, guidelines,
and requirements in this section therefore apply to EAP-TLS when it is
used with any version of TLS.[¶](#section-5.7-2){.pilcrow}

When resumption occurs, it is based on cached information at the TLS
layer. To perform resumption securely, the EAP-TLS peer and EAP-TLS
server need to be able to securely retrieve authorization information
such as certificate chains from the initial full handshake. This
document uses the term \"cached data\" to describe such information.
Authorization during resumption [MUST]{.bcp14} be based on such cached
data. The EAP-TLS peer and EAP-TLS server [MAY]{.bcp14} perform fresh
revocation checks on the cached certificate data. Any security policies
for authorization [MUST]{.bcp14} be followed also for resumption. The
certificates may have been revoked since the initial full handshake and
the authorizations of the other party may have been reduced. If the
cached revocation data is not sufficiently current, the EAP-TLS peer or
EAP-TLS server [MAY]{.bcp14} force a full TLS
handshake.[¶](#section-5.7-3){.pilcrow}

There are two ways to retrieve the cached data from the original full
handshake. The first method is that the EAP-TLS server and client cache
the information locally. The cached information is identified by an
identifier. For TLS versions before 1.3, the identifier can be the
session ID; for TLS 1.3, the identifier is the PSK identity. The second
method for retrieving cached information is via
\[[RFC5077](#RFC5077){.xref}\] or \[[RFC8446](#RFC8446){.xref}\], where
the EAP-TLS server avoids storing information locally and instead
encapsulates the information into a ticket that is sent to the client
for storage. This ticket is encrypted using a key that only the EAP-TLS
server knows. Note that the client still needs to cache the original
handshake information locally and will obtain it while determining the
session ID or PSK identity to use for resumption. However, the EAP-TLS
server is able to decrypt the ticket or PSK to obtain the original
handshake information.[¶](#section-5.7-4){.pilcrow}

The EAP-TLS server or EAP client [MUST]{.bcp14} cache data during the
initial full handshake sufficient to allow authorization decisions to be
made during resumption. If cached data cannot be retrieved securely,
resumption [MUST NOT]{.bcp14} be done.[¶](#section-5.7-5){.pilcrow}

The above requirements also apply if the EAP-TLS server expects some
system to perform accounting for the session. Since accounting must be
tied to an authenticated identity, and resumption does not supply such
an identity, accounting is impossible without access to cached data.
Therefore, systems that expect to perform accounting for the session
[SHOULD]{.bcp14} cache an identifier that can be used in subsequent
accounting.[¶](#section-5.7-6){.pilcrow}

As suggested in \[[RFC8446](#RFC8446){.xref}\], EAP-TLS peers [MUST
NOT]{.bcp14} store resumption PSKs or tickets (and associated cached
data) for longer than 604800 seconds (7 days) regardless of the PSK or
ticket lifetime. The EAP-TLS peer [MAY]{.bcp14} delete them earlier
based on local policy. The cached data [MAY]{.bcp14} also be removed on
the EAP-TLS server or EAP-TLS peer if any certificate in the certificate
chain has been revoked or has expired. In all such cases, an attempt at
resumption results in a full TLS handshake
instead.[¶](#section-5.7-7){.pilcrow}

Information from the EAP-TLS exchange (e.g., the identity provided in
EAP-Response/Identity) as well as non-EAP information (e.g., IP
addresses) may change between the initial full handshake and resumption.
This change creates a \"time-of-check time-of-use\" (TOCTOU) security
vulnerability. A malicious or compromised user could supply one set of
data during the initial authentication, and a different set of data
during resumption, potentially allowing them to obtain access that they
should not have.[¶](#section-5.7-8){.pilcrow}

If any authorization, accounting, or policy decisions were made with
information that has changed between the initial full handshake and
resumption, and if change may lead to a different decision, such
decisions [MUST]{.bcp14} be reevaluated. It is [RECOMMENDED]{.bcp14}
that authorization, accounting, and policy decisions are reevaluated
based on the information given in the resumption. EAP-TLS servers
[MAY]{.bcp14} reject resumption where the information supplied during
resumption does not match the information supplied during the original
authentication. If a safe decision is not possible, EAP-TLS servers
[SHOULD]{.bcp14} reject the resumption and continue with a full
handshake.[¶](#section-5.7-9){.pilcrow}

Sections
[2.2](https://www.rfc-editor.org/rfc/rfc8446#section-2.2){.relref} and
[4.2.11](https://www.rfc-editor.org/rfc/rfc8446#section-4.2.11){.relref}
of \[[RFC8446](#RFC8446){.xref}\] provide security considerations for
TLS 1.3 resumption.[¶](#section-5.7-10){.pilcrow}
:::
:::

::: {#privcon}
::: {#section-5.8 .section}
### [5.8.](#section-5.8){.section-number .selfRef} [Privacy Considerations](#name-privacy-considerations){.section-name .selfRef} {#name-privacy-considerations}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-5.8-1){.pilcrow}

TLS 1.3 offers much better privacy than earlier versions of TLS as
discussed in [Section 2.1.8](#privacy){.xref}. In this section, we only
discuss the privacy properties of EAP-TLS with TLS 1.3. For privacy
properties of TLS 1.3 itself, see
\[[RFC8446](#RFC8446){.xref}\].[¶](#section-5.8-2){.pilcrow}

EAP-TLS sends the standard TLS 1.3 handshake messages encapsulated in
EAP packets. Additionally, the EAP-TLS peer sends an identity in the
first EAP-Response. The other fields in the EAP-TLS Request and the
EAP-TLS Response packets do not contain any cleartext privacy-sensitive
information.[¶](#section-5.8-3){.pilcrow}

Tracking of users by eavesdropping on Identity Responses or certificates
is a well-known problem in many EAP methods. When EAP-TLS is used with
TLS 1.3, all certificates are encrypted, and the username part of the
Identity Response is not revealed (e.g., using anonymous NAIs). Note
that even though all certificates are encrypted, the server\'s identity
is only protected against passive attackers while the client\'s identity
is protected against both passive and active attackers. As with other
EAP methods, even when privacy-friendly identifiers or EAP tunneling is
used, the domain name (i.e., the realm) in the NAI is still typically
visible. How much privacy-sensitive information the domain name leaks is
highly dependent on how many other users are using the same domain name
in the particular access network. If all EAP-TLS peers have the same
domain, no additional information is leaked. If a domain name is used by
a small subset of the EAP-TLS peers, it may aid an attacker in tracking
or identifying the user.[¶](#section-5.8-4){.pilcrow}

Without padding, information about the size of the client certificate is
leaked from the size of the EAP-TLS packets. The EAP-TLS packets sizes
may therefore leak information that can be used to track or identify the
user. If all client certificates have the same length, no information is
leaked. EAP-TLS peers [SHOULD]{.bcp14} use record padding; see [Section
5.4](https://www.rfc-editor.org/rfc/rfc8446#section-5.4){.relref} of
\[[RFC8446](#RFC8446){.xref}\] to reduce information leakage of
certificate sizes.[¶](#section-5.8-5){.pilcrow}

If anonymous NAIs are not used, the privacy-friendly identifiers need to
be generated with care. The identities [MUST]{.bcp14} be generated in a
cryptographically secure way so that it is computationally infeasible
for an attacker to differentiate two identities belonging to the same
user from two identities belonging to different users in the same realm.
This can be achieved, for instance, by using random or pseudo-random
usernames such as random byte strings or ciphertexts and only using the
pseudo-random usernames a single time. Note that the privacy-friendly
usernames also [MUST NOT]{.bcp14} include substrings that can be used to
relate the identity to a specific user. Similarly, privacy-friendly
usernames [MUST NOT]{.bcp14} be formed by a fixed mapping that stays the
same across multiple different
authentications.[¶](#section-5.8-6){.pilcrow}

An EAP-TLS peer with a policy allowing communication with EAP-TLS
servers supporting only TLS 1.2 without privacy and with a static RSA
key exchange is vulnerable to disclosure of the EAP-TLS peer username.
An active attacker can in this case make the EAP-TLS peer believe that
an EAP-TLS server supporting TLS 1.3 only supports TLS 1.2 without
privacy. The attacker can simply impersonate the EAP-TLS server and
negotiate TLS 1.2 with static RSA key exchange and send a TLS alert
message when the EAP-TLS peer tries to use privacy by sending an empty
certificate message. Since the attacker (impersonating the EAP-TLS
server) does not provide a proof-of-possession of the private key until
the Finished message when a static RSA key exchange is used, an EAP-TLS
peer may inadvertently disclose its identity (username) to an attacker.
Therefore, it is [RECOMMENDED]{.bcp14} for EAP-TLS peers to not use
EAP-TLS with TLS 1.2 and static RSA-based cipher suites without privacy.
This implies that an EAP-TLS peer [SHOULD NOT]{.bcp14} continue the EAP
authentication attempt if a TLS 1.2 EAP-TLS server sends an
EAP-TLS/Request with a TLS alert message in response to an empty
certificate message from the peer.[¶](#section-5.8-7){.pilcrow}
:::
:::

::: {#section-5.9 .section}
### [5.9.](#section-5.9){.section-number .selfRef} [Pervasive Monitoring](#name-pervasive-monitoring){.section-name .selfRef} {#name-pervasive-monitoring}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-5.9-1){.pilcrow}

Pervasive monitoring refers to widespread surveillance of users. In the
context of EAP-TLS, pervasive monitoring attacks can target EAP-TLS peer
devices for tracking them (and their users) when they join a network. By
encrypting more information, mandating the use of privacy, and always
providing forward secrecy, EAP-TLS with TLS 1.3 offers much better
protection against pervasive monitoring. In addition to the privacy
attacks discussed above, surveillance on a large scale may enable
tracking of a user over a wide geographical area and across different
access networks. Using information from EAP-TLS together with
information gathered from other protocols increases the risk of
identifying individual users.[¶](#section-5.9-2){.pilcrow}

In TLS 1.3, the post-handshake key update mechanism provides forward
secrecy for the traffic secrets. EAP-TLS 1.3 does not provide a similar
mechanism for MSK and EMSK. Implementation using the exported MSK and
EMSK can achieve forward secrecy by frequently deriving new keys in a
similar way as described in [Section
7.2](https://www.rfc-editor.org/rfc/rfc8446#section-7.2){.relref} of
\[[RFC8446](#RFC8446){.xref}\].[¶](#section-5.9-3){.pilcrow}
:::

::: {#section-5.10 .section}
### [5.10.](#section-5.10){.section-number .selfRef} [Discovered Vulnerabilities](#name-discovered-vulnerabilities){.section-name .selfRef} {#name-discovered-vulnerabilities}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-5.10-1){.pilcrow}

Over the years, there have been several serious attacks on earlier
versions of Transport Layer Security (TLS), including attacks on its
most commonly used ciphers and modes of operation.
\[[RFC7457](#RFC7457){.xref}\] summarizes the attacks that were known at
the time of publishing, and BCP 195 \[[RFC7525](#RFC7525){.xref}\]
\[[RFC8996](#RFC8996){.xref}\] provides recommendations and requirements
for improving the security of deployed services that use TLS. However,
many of the attacks are less serious for EAP-TLS as EAP-TLS only uses
the TLS handshake and does not protect any application data. EAP-TLS
implementations [MUST]{.bcp14} mitigate known attacks. EAP-TLS
implementations need to monitor and follow new EAP- and TLS-related
security guidance and requirements such as
\[[RFC8447](#RFC8447){.xref}\] and
\[[RFC9155](#RFC9155){.xref}\].[¶](#section-5.10-2){.pilcrow}
:::

::: {#section-5.11 .section}
### [5.11.](#section-5.11){.section-number .selfRef} [Cross-Protocol Attacks](#name-cross-protocol-attacks){.section-name .selfRef} {#name-cross-protocol-attacks}

This is a new section when compared to
\[[RFC5216](#RFC5216){.xref}\].[¶](#section-5.11-1){.pilcrow}

Allowing the same certificate to be used in multiple protocols can
potentially allow an attacker to authenticate via one protocol and then
\"resume\" that session in another protocol. [Section
2.2](#identity){.xref} suggests that certificates typically have one or
more FQDNs in the SAN extension. However, those fields are for EAP
validation only and do not indicate that the certificates are suitable
for use with HTTPS or other protocols on the named
host.[¶](#section-5.11-2){.pilcrow}

[Section 2.1.3](#resumption){.xref} suggests that authorization rules
should be reapplied on resumption but does not mandate this behavior. As
a result, this cross-protocol resumption could allow the attacker to
bypass authorization policies and to obtain undesired access to secured
systems. Along with making sure that appropriate authorization
information is available and used during resumption, using different
certificates and resumption caches for different protocols is
[RECOMMENDED]{.bcp14} to help keep different protocol usages
separate.[¶](#section-5.11-3){.pilcrow}
:::
:::
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3748\]
:   [Aboba, B.]{.refAuthor}, [Blunk, L.]{.refAuthor},
    [Vollbrecht, J.]{.refAuthor}, [Carlson, J.]{.refAuthor}, and [H.
    Levkowetz, Ed.]{.refAuthor}, [\"Extensible Authentication Protocol
    (EAP)\"]{.refTitle}, [RFC 3748]{.seriesInfo}, [DOI
    10.17487/RFC3748]{.seriesInfo}, June 2004,
    \<<https://www.rfc-editor.org/info/rfc3748>\>.
:   

\[RFC5216\]
:   [Simon, D.]{.refAuthor}, [Aboba, B.]{.refAuthor}, and [R.
    Hurst]{.refAuthor}, [\"The EAP-TLS Authentication
    Protocol\"]{.refTitle}, [RFC 5216]{.seriesInfo}, [DOI
    10.17487/RFC5216]{.seriesInfo}, March 2008,
    \<<https://www.rfc-editor.org/info/rfc5216>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}, [Santesson, S.]{.refAuthor},
    [Farrell, S.]{.refAuthor}, [Boeyen, S.]{.refAuthor},
    [Housley, R.]{.refAuthor}, and [W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC5705\]
:   [Rescorla, E.]{.refAuthor}, [\"Keying Material Exporters for
    Transport Layer Security (TLS)\"]{.refTitle}, [RFC
    5705]{.seriesInfo}, [DOI 10.17487/RFC5705]{.seriesInfo}, March 2010,
    \<<https://www.rfc-editor.org/info/rfc5705>\>.
:   

\[RFC6066\]
:   [Eastlake 3rd, D.]{.refAuthor}, [\"Transport Layer Security (TLS)
    Extensions: Extension Definitions\"]{.refTitle}, [RFC
    6066]{.seriesInfo}, [DOI 10.17487/RFC6066]{.seriesInfo}, January
    2011, \<<https://www.rfc-editor.org/info/rfc6066>\>.
:   

\[RFC6960\]
:   [Santesson, S.]{.refAuthor}, [Myers, M.]{.refAuthor},
    [Ankney, R.]{.refAuthor}, [Malpani, A.]{.refAuthor},
    [Galperin, S.]{.refAuthor}, and [C. Adams]{.refAuthor}, [\"X.509
    Internet Public Key Infrastructure Online Certificate Status
    Protocol - OCSP\"]{.refTitle}, [RFC 6960]{.seriesInfo}, [DOI
    10.17487/RFC6960]{.seriesInfo}, June 2013,
    \<<https://www.rfc-editor.org/info/rfc6960>\>.
:   

\[RFC7542\]
:   [DeKok, A.]{.refAuthor}, [\"The Network Access
    Identifier\"]{.refTitle}, [RFC 7542]{.seriesInfo}, [DOI
    10.17487/RFC7542]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7542>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Informative references](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[IEEE-802.11\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Information
    technology-Telecommunications and information exchange between
    systems Local and metropolitan area networks-Specific requirements -
    Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer
    (PHY) Specifications\"]{.refTitle}, [IEEE Std.
    802.11-2020]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2016.7786995]{.seriesInfo}, February 2021,
    \<<https://doi.org/10.1109/IEEESTD.2016.7786995>\>.
:   

\[IEEE-802.1AE\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Local and metropolitan area
    networks \-- Media Access Control (MAC) Security\"]{.refTitle},
    [IEEE Std. 802.1AE-2018]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2018.8585421]{.seriesInfo}, December 2018,
    \<<https://doi.org/10.1109/IEEESTD.2018.8585421>\>.
:   

\[IEEE-802.1X\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Local and Metropolitan Area
    Networks\--Port-Based Network Access Control\"]{.refTitle}, [IEEE
    Std. 802.1X-2020]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2020.9018454]{.seriesInfo}, February 2020,
    \<<https://doi.org/10.1109/IEEESTD.2020.9018454>\>.
:   

\[MulteFire\]
:   [MulteFire Alliance]{.refAuthor}, [\"MulteFire Release 1.1
    Specification\"]{.refTitle}, 2019.
:   

\[PEAP\]
:   [Microsoft Corporation]{.refAuthor}, [\"\[MS-PEAP\]: Protected
    Extensible Authentication Protocol (PEAP)\"]{.refTitle}, June 2021.
:   

\[RFC1661\]
:   [Simpson, W., Ed.]{.refAuthor}, [\"The Point-to-Point Protocol
    (PPP)\"]{.refTitle}, [STD 51]{.seriesInfo}, [RFC 1661]{.seriesInfo},
    [DOI 10.17487/RFC1661]{.seriesInfo}, July 1994,
    \<<https://www.rfc-editor.org/info/rfc1661>\>.
:   

\[RFC2246\]
:   [Dierks, T.]{.refAuthor} and [C. Allen]{.refAuthor}, [\"The TLS
    Protocol Version 1.0\"]{.refTitle}, [RFC 2246]{.seriesInfo}, [DOI
    10.17487/RFC2246]{.seriesInfo}, January 1999,
    \<<https://www.rfc-editor.org/info/rfc2246>\>.
:   

\[RFC2560\]
:   [Myers, M.]{.refAuthor}, [Ankney, R.]{.refAuthor},
    [Malpani, A.]{.refAuthor}, [Galperin, S.]{.refAuthor}, and [C.
    Adams]{.refAuthor}, [\"X.509 Internet Public Key Infrastructure
    Online Certificate Status Protocol - OCSP\"]{.refTitle}, [RFC
    2560]{.seriesInfo}, [DOI 10.17487/RFC2560]{.seriesInfo}, June 1999,
    \<<https://www.rfc-editor.org/info/rfc2560>\>.
:   

\[RFC2865\]
:   [Rigney, C.]{.refAuthor}, [Willens, S.]{.refAuthor},
    [Rubens, A.]{.refAuthor}, and [W. Simpson]{.refAuthor}, [\"Remote
    Authentication Dial In User Service (RADIUS)\"]{.refTitle}, [RFC
    2865]{.seriesInfo}, [DOI 10.17487/RFC2865]{.seriesInfo}, June 2000,
    \<<https://www.rfc-editor.org/info/rfc2865>\>.
:   

\[RFC3280\]
:   [Housley, R.]{.refAuthor}, [Polk, W.]{.refAuthor},
    [Ford, W.]{.refAuthor}, and [D. Solo]{.refAuthor}, [\"Internet X.509
    Public Key Infrastructure Certificate and Certificate Revocation
    List (CRL) Profile\"]{.refTitle}, [RFC 3280]{.seriesInfo}, [DOI
    10.17487/RFC3280]{.seriesInfo}, April 2002,
    \<<https://www.rfc-editor.org/info/rfc3280>\>.
:   

\[RFC4137\]
:   [Vollbrecht, J.]{.refAuthor}, [Eronen, P.]{.refAuthor},
    [Petroni, N.]{.refAuthor}, and [Y. Ohba]{.refAuthor}, [\"State
    Machines for Extensible Authentication Protocol (EAP) Peer and
    Authenticator\"]{.refTitle}, [RFC 4137]{.seriesInfo}, [DOI
    10.17487/RFC4137]{.seriesInfo}, August 2005,
    \<<https://www.rfc-editor.org/info/rfc4137>\>.
:   

\[RFC4282\]
:   [Aboba, B.]{.refAuthor}, [Beadles, M.]{.refAuthor},
    [Arkko, J.]{.refAuthor}, and [P. Eronen]{.refAuthor}, [\"The Network
    Access Identifier\"]{.refTitle}, [RFC 4282]{.seriesInfo}, [DOI
    10.17487/RFC4282]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4282>\>.
:   

\[RFC4346\]
:   [Dierks, T.]{.refAuthor} and [E. Rescorla]{.refAuthor}, [\"The
    Transport Layer Security (TLS) Protocol Version 1.1\"]{.refTitle},
    [RFC 4346]{.seriesInfo}, [DOI 10.17487/RFC4346]{.seriesInfo}, April
    2006, \<<https://www.rfc-editor.org/info/rfc4346>\>.
:   

\[RFC4851\]
:   [Cam-Winget, N.]{.refAuthor}, [McGrew, D.]{.refAuthor},
    [Salowey, J.]{.refAuthor}, and [H. Zhou]{.refAuthor}, [\"The
    Flexible Authentication via Secure Tunneling Extensible
    Authentication Protocol Method (EAP-FAST)\"]{.refTitle}, [RFC
    4851]{.seriesInfo}, [DOI 10.17487/RFC4851]{.seriesInfo}, May 2007,
    \<<https://www.rfc-editor.org/info/rfc4851>\>.
:   

\[RFC5077\]
:   [Salowey, J.]{.refAuthor}, [Zhou, H.]{.refAuthor},
    [Eronen, P.]{.refAuthor}, and [H. Tschofenig]{.refAuthor},
    [\"Transport Layer Security (TLS) Session Resumption without
    Server-Side State\"]{.refTitle}, [RFC 5077]{.seriesInfo}, [DOI
    10.17487/RFC5077]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5077>\>.
:   

\[RFC5191\]
:   [Forsberg, D.]{.refAuthor}, [Ohba, Y., Ed.]{.refAuthor},
    [Patil, B.]{.refAuthor}, [Tschofenig, H.]{.refAuthor}, and [A.
    Yegin]{.refAuthor}, [\"Protocol for Carrying Authentication for
    Network Access (PANA)\"]{.refTitle}, [RFC 5191]{.seriesInfo}, [DOI
    10.17487/RFC5191]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5191>\>.
:   

\[RFC5246\]
:   [Dierks, T.]{.refAuthor} and [E. Rescorla]{.refAuthor}, [\"The
    Transport Layer Security (TLS) Protocol Version 1.2\"]{.refTitle},
    [RFC 5246]{.seriesInfo}, [DOI 10.17487/RFC5246]{.seriesInfo}, August
    2008, \<<https://www.rfc-editor.org/info/rfc5246>\>.
:   

\[RFC5247\]
:   [Aboba, B.]{.refAuthor}, [Simon, D.]{.refAuthor}, and [P.
    Eronen]{.refAuthor}, [\"Extensible Authentication Protocol (EAP) Key
    Management Framework\"]{.refTitle}, [RFC 5247]{.seriesInfo}, [DOI
    10.17487/RFC5247]{.seriesInfo}, August 2008,
    \<<https://www.rfc-editor.org/info/rfc5247>\>.
:   

\[RFC5281\]
:   [Funk, P.]{.refAuthor} and [S. Blake-Wilson]{.refAuthor},
    [\"Extensible Authentication Protocol Tunneled Transport Layer
    Security Authenticated Protocol Version 0
    (EAP-TTLSv0)\"]{.refTitle}, [RFC 5281]{.seriesInfo}, [DOI
    10.17487/RFC5281]{.seriesInfo}, August 2008,
    \<<https://www.rfc-editor.org/info/rfc5281>\>.
:   

\[RFC6125\]
:   [Saint-Andre, P.]{.refAuthor} and [J. Hodges]{.refAuthor},
    [\"Representation and Verification of Domain-Based Application
    Service Identity within Internet Public Key Infrastructure Using
    X.509 (PKIX) Certificates in the Context of Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 6125]{.seriesInfo}, [DOI
    10.17487/RFC6125]{.seriesInfo}, March 2011,
    \<<https://www.rfc-editor.org/info/rfc6125>\>.
:   

\[RFC6733\]
:   [Fajardo, V., Ed.]{.refAuthor}, [Arkko, J.]{.refAuthor},
    [Loughney, J.]{.refAuthor}, and [G. Zorn, Ed.]{.refAuthor},
    [\"Diameter Base Protocol\"]{.refTitle}, [RFC 6733]{.seriesInfo},
    [DOI 10.17487/RFC6733]{.seriesInfo}, October 2012,
    \<<https://www.rfc-editor.org/info/rfc6733>\>.
:   

\[RFC7170\]
:   [Zhou, H.]{.refAuthor}, [Cam-Winget, N.]{.refAuthor},
    [Salowey, J.]{.refAuthor}, and [S. Hanna]{.refAuthor}, [\"Tunnel
    Extensible Authentication Protocol (TEAP) Version 1\"]{.refTitle},
    [RFC 7170]{.seriesInfo}, [DOI 10.17487/RFC7170]{.seriesInfo}, May
    2014, \<<https://www.rfc-editor.org/info/rfc7170>\>.
:   

\[RFC7406\]
:   [Schulzrinne, H.]{.refAuthor}, [McCann, S.]{.refAuthor},
    [Bajko, G.]{.refAuthor}, [Tschofenig, H.]{.refAuthor}, and [D.
    Kroeselberg]{.refAuthor}, [\"Extensions to the Emergency Services
    Architecture for Dealing With Unauthenticated and Unauthorized
    Devices\"]{.refTitle}, [RFC 7406]{.seriesInfo}, [DOI
    10.17487/RFC7406]{.seriesInfo}, December 2014,
    \<<https://www.rfc-editor.org/info/rfc7406>\>.
:   

\[RFC7457\]
:   [Sheffer, Y.]{.refAuthor}, [Holz, R.]{.refAuthor}, and [P.
    Saint-Andre]{.refAuthor}, [\"Summarizing Known Attacks on Transport
    Layer Security (TLS) and Datagram TLS (DTLS)\"]{.refTitle}, [RFC
    7457]{.seriesInfo}, [DOI 10.17487/RFC7457]{.seriesInfo}, February
    2015, \<<https://www.rfc-editor.org/info/rfc7457>\>.
:   

\[RFC7525\]
:   [Sheffer, Y.]{.refAuthor}, [Holz, R.]{.refAuthor}, and [P.
    Saint-Andre]{.refAuthor}, [\"Recommendations for Secure Use of
    Transport Layer Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [BCP 195]{.seriesInfo}, [RFC
    7525]{.seriesInfo}, [DOI 10.17487/RFC7525]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7525>\>.
:   

\[RFC7593\]
:   [Wierenga, K.]{.refAuthor}, [Winter, S.]{.refAuthor}, and [T.
    Wolniewicz]{.refAuthor}, [\"The eduroam Architecture for Network
    Roaming\"]{.refTitle}, [RFC 7593]{.seriesInfo}, [DOI
    10.17487/RFC7593]{.seriesInfo}, September 2015,
    \<<https://www.rfc-editor.org/info/rfc7593>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8447\]
:   [Salowey, J.]{.refAuthor} and [S. Turner]{.refAuthor}, [\"IANA
    Registry Updates for TLS and DTLS\"]{.refTitle}, [RFC
    8447]{.seriesInfo}, [DOI 10.17487/RFC8447]{.seriesInfo}, August
    2018, \<<https://www.rfc-editor.org/info/rfc8447>\>.
:   

\[RFC8996\]
:   [Moriarty, K.]{.refAuthor} and [S. Farrell]{.refAuthor},
    [\"Deprecating TLS 1.0 and TLS 1.1\"]{.refTitle}, [BCP
    195]{.seriesInfo}, [RFC 8996]{.seriesInfo}, [DOI
    10.17487/RFC8996]{.seriesInfo}, March 2021,
    \<<https://www.rfc-editor.org/info/rfc8996>\>.
:   

\[RFC9155\]
:   [Velvindron, L.]{.refAuthor}, [Moriarty, K.]{.refAuthor}, and [A.
    Ghedini]{.refAuthor}, [\"Deprecating MD5 and SHA-1 Signature Hashes
    in TLS 1.2 and DTLS 1.2\"]{.refTitle}, [RFC 9155]{.seriesInfo}, [DOI
    10.17487/RFC9155]{.seriesInfo}, December 2021,
    \<<https://www.rfc-editor.org/info/rfc9155>\>.
:   

\[RFC9191\]
:   [Sethi, M.]{.refAuthor}, [Preuß Mattsson, J.]{.refAuthor}, and [S.
    Turner]{.refAuthor}, [\"Handling Large Certificates and Long
    Certificate Chains in TLS-Based EAP Methods\"]{.refTitle}, [RFC
    9191]{.seriesInfo}, [DOI 10.17487/RFC9191]{.seriesInfo}, February
    2022, \<<https://www.rfc-editor.org/rfc/rfc9191>\>.
:   

\[TICKET-REQUESTS\]
:   [Pauly, T.]{.refAuthor}, [Schinazi, D.]{.refAuthor}, and [C. A.
    Wood]{.refAuthor}, [\"TLS Ticket Requests\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-tls-ticketrequests-07]{.seriesInfo}, 3 December 2020,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-tls-ticketrequests-07>\>.
:   

\[TLS-bis\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-tls-rfc8446bis-03]{.seriesInfo}, 25
    October 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8446bis-03>\>.
:   

\[TLS-EAP-TYPES\]
:   [DeKok, A.]{.refAuthor}, [\"TLS-based EAP types and TLS
    1.3\"]{.refTitle}, [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-emu-tls-eap-types-04]{.seriesInfo}, 21 January 2022,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-emu-tls-eap-types-04>\>.
:   

\[TS.33.501\]
:   [3GPP]{.refAuthor}, [\"Security architecture and procedures for 5G
    system\"]{.refTitle}, [Release 17 ]{.refContent}, [TS
    33.501]{.seriesInfo}, January 2022.
:   
:::
:::

::: {#updateref}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Updated References](#name-updated-references){.section-name .selfRef} {#name-updated-references}

The following references in \[[RFC5216](#RFC5216){.xref}\] are updated
as specified below when EAP-TLS is used with TLS
1.3.[¶](#appendix-A-1){.pilcrow}

-   ::: {#appendix-A-2.1}
    All references to \[[RFC2560](#RFC2560){.xref}\] are updated to
    refer to
    \[[RFC6960](#RFC6960){.xref}\].[¶](#appendix-A-2.1.1){.pilcrow}
    :::

-   ::: {#appendix-A-2.2}
    All references to \[[RFC3280](#RFC3280){.xref}\] are updated to
    refer to \[[RFC5280](#RFC5280){.xref}\]. References to [Section
    4.2.1.13](https://www.rfc-editor.org/rfc/rfc3280#section-4.2.1.13){.relref}
    of \[[RFC3280](#RFC3280){.xref}\] are updated to refer to [Section
    4.2.1.12](https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.12){.relref}
    of \[[RFC5280](#RFC5280){.xref}\].[¶](#appendix-A-2.2.1){.pilcrow}
    :::

-   ::: {#appendix-A-2.3}
    All references to \[[RFC4282](#RFC4282){.xref}\] are updated to
    refer to \[[RFC7542](#RFC7542){.xref}\]. References to [Section
    2.1](https://www.rfc-editor.org/rfc/rfc4282#section-2.1){.relref} of
    \[[RFC4282](#RFC4282){.xref}\] are updated to refer to [Section
    2.2](https://www.rfc-editor.org/rfc/rfc7542#section-2.2){.relref} of
    \[[RFC7542](#RFC7542){.xref}\].[¶](#appendix-A-2.3.1){.pilcrow}
    :::
:::
:::

::: {#appendix-B .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors want to thank [Bernard Aboba]{.contact-name}, [Jari
Arkko]{.contact-name}, [Terry Burton]{.contact-name}, [Alan
DeKok]{.contact-name}, [Ari Keränen]{.contact-name}, [Benjamin
Kaduk]{.contact-name}, [Jouni Malinen]{.contact-name}, [Oleg
Pekar]{.contact-name}, [Eric Rescorla]{.contact-name}, [Jim
Schaad]{.contact-name}, [Joseph Salowey]{.contact-name}, [Martin
Thomson]{.contact-name}, [Vesa Torvinen]{.contact-name}, [Hannes
Tschofenig]{.contact-name}, and [Heikki Vatiainen]{.contact-name} for
comments and suggestions on this document. Special thanks to the
Document Shepherd [Joseph
Salowey]{.contact-name}.[¶](#appendix-B-1){.pilcrow}
:::

::: {#appendix-C .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

[Alan DeKok]{.contact-name}, FreeRADIUS[¶](#appendix-C-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[John Preuß Mattsson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
SE-[164 40]{.postal-code} [Kista]{.locality}
:::

::: {.left dir="auto"}
[Sweden]{.country-name}
:::

::: email
Email: <john.mattsson@ericsson.com>
:::

::: {.left dir="auto"}
[Mohit Sethi]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
FI-[02420]{.postal-code} [Jorvas]{.locality}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <mohit@iki.fi>
:::
:::
:::
