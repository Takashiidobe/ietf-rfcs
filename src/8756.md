  RFC 8756            CNSA Suite CMC Profile   March 2020
  ------------------- ------------------------ ------------
  Jenkins & Zieglar   Informational            \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [8756](https://www.rfc-editor.org/rfc/rfc8756){.eref}

Category:
:   Informational

Published:
:   March 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    M. Jenkins
    :::

    ::: org
    NSA
    :::
    :::

    ::: author
    ::: author-name
    L. Zieglar
    :::

    ::: org
    NSA
    :::
    :::
:::

# RFC 8756 {#rfcnum}

# Commercial National Security Algorithm (CNSA) Suite Profile of Certificate Management over CMS {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies a profile of the Certificate Management over CMS
(CMC) protocol for managing X.509 public key certificates in
applications that use the Commercial National Security Algorithm (CNSA)
Suite published by the United States
Government.[¶](#section-abstract-1){.pilcrow}

The profile applies to the capabilities, configuration, and operation of
all components of US National Security Systems that manage X.509 public
key certificates over CMS. It is also appropriate for all other US
Government systems that process high-value
information.[¶](#section-abstract-2){.pilcrow}

The profile is made publicly available here for use by developers and
operators of these and any other system
deployments.[¶](#section-abstract-3){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8756>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [The Commercial National Security Algorithm
    Suite](#name-the-commercial-national-sec){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Requirements and
    Assumptions](#name-requirements-and-assumption){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Client Requirements: Generating PKI
    Requests](#name-client-requirements-generat){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Tagged Certification
        Request](#name-tagged-certification-reques){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Certificate Request
        Message](#name-certificate-request-message){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [RA
    Requirements](#name-ra-requirements){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [RA Processing of
        Requests](#name-ra-processing-of-requests){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [RA-Generated PKI
        Requests](#name-ra-generated-pki-requests){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [RA-Generated PKI
        Responses](#name-ra-generated-pki-responses){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [CA
    Requirements](#name-ca-requirements){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [CA Processing of PKI
        Requests](#name-ca-processing-of-pki-reques){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [CA-Generated PKI
        Responses](#name-ca-generated-pki-responses){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Client Requirements: Processing PKI
    Responses](#name-client-requirements-process){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Shared-Secrets](#name-shared-secrets){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix
    A](#section-appendix.a){.xref}.  [Scenarios](#name-scenarios){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}

    -   ::: {#section-toc.1-1.12.2.1}
        [A.1](#section-a.1){.xref}.  [Initial
        Enrollment](#name-initial-enrollment){.xref}[¶](#section-toc.1-1.12.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [A.2](#section-a.2){.xref}.  [Rekey](#name-rekey){.xref}[¶](#section-toc.1-1.12.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document specifies a profile of the Certificate Management over CMS
(CMC) protocol to comply with the United States National Security
Agency\'s Commercial National Security Algorithm (CNSA) Suite
\[[CNSA](#CNSA){.xref}\]. The profile applies to the capabilities,
configuration, and operation of all components of US National Security
Systems \[[SP80059](#SP80059){.xref}\]. It is also appropriate for all
other US Government systems that process high-value information. It is
made publicly available for use by developers and operators of these and
any other system deployments.[¶](#section-1-1){.pilcrow}

This document does not define any new cryptographic algorithm suites;
instead, it defines a CNSA-compliant profile of CMC. CMC is defined in
\[[RFC5272](#RFC5272){.xref}\], \[[RFC5273](#RFC5273){.xref}\], and
\[[RFC5274](#RFC5274){.xref}\] and is updated by
\[[RFC6402](#RFC6402){.xref}\]. This document profiles CMC to manage
X.509 public key certificates in compliance with the CNSA Suite
Certificate and Certificate Revocation List (CRL) profile
\[[RFC8603](#RFC8603){.xref}\]. This document specifically focuses on
defining CMC interactions for both the initial enrollment and rekey of
CNSA Suite public key certificates between a client and a Certification
Authority (CA). One or more Registration Authorities (RAs) may act as
intermediaries between the client and the CA. This profile may be
further tailored by specific communities to meet their needs. Specific
communities will also define certificate policies that implementations
need to comply with.[¶](#section-1-2){.pilcrow}

::: {#terms}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}

The terminology in \[[RFC5272](#RFC5272){.xref}\], [Section
2.1](https://www.rfc-editor.org/rfc/rfc5272#section-2.1){.relref}
applies to this profile.[¶](#section-1.1-2){.pilcrow}

The term \"certificate request\" is used to refer to a single PKCS #10
or Certificate Request Message Format (CRMF) structure. All PKI Requests
are Full PKI Requests, and all PKI Responses are Full PKI Responses; the
respective set of terms should be interpreted synonymously in this
document.[¶](#section-1.1-3){.pilcrow}
:::
:::
:::
:::

::: {#cnsa}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [The Commercial National Security Algorithm Suite](#name-the-commercial-national-sec){.section-name .selfRef} {#name-the-commercial-national-sec}

The National Security Agency (NSA) profiles commercial cryptographic
algorithms and protocols as part of its mission to support secure,
interoperable communications for US Government National Security
Systems. To this end, it publishes guidance both to assist with the US
Government transition to new algorithms and to provide vendors \-- and
the Internet community in general \-- with information concerning their
proper use and configuration within the scope of US Government National
Security Systems.[¶](#section-2-1){.pilcrow}

Recently, cryptographic transition plans have become overshadowed by the
prospect of the development of a cryptographically relevant quantum
computer. The NSA has established the Commercial National Security
Algorithm (CNSA) Suite to provide vendors and IT users near-term
flexibility in meeting their cybersecurity interoperability
requirements. The purpose behind this flexibility is to avoid having
vendors and customers make two major transitions in a relatively short
timeframe, as we anticipate a need to shift to quantum-resistant
cryptography in the near future.[¶](#section-2-2){.pilcrow}

The NSA is authoring a set of RFCs, including this one, to provide
updated guidance concerning the use of certain commonly available
commercial algorithms in IETF protocols. These RFCs can be used in
conjunction with other RFCs and cryptographic guidance (e.g., NIST
Special Publications) to properly protect Internet traffic and
data-at-rest for US Government National Security
Systems.[¶](#section-2-3){.pilcrow}
:::
:::

::: {#reqts}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Requirements and Assumptions](#name-requirements-and-assumption){.section-name .selfRef} {#name-requirements-and-assumption}

Elliptic Curve Digital Signature Algorithm (ECDSA) and Elliptic Curve
Diffie-Hellman (ECDH) key pairs are on the P-384 curve. FIPS 186-4
\[[FIPS186](#FIPS186){.xref}\], Appendix B.4 provides useful guidance
for elliptic curve key pair generation that [SHOULD]{.bcp14} be followed
by systems that conform to this document.[¶](#section-3-1){.pilcrow}

RSA key pairs (public, private) are identified by the modulus size
expressed in bits; RSA-3072 and RSA-4096 are computed using moduli of
3072 bits and 4096 bits, respectively.[¶](#section-3-2){.pilcrow}

RSA signature key pairs used in CNSA Suite-compliant implementations are
either RSA-3072 or RSA-4096. The RSA exponent e [MUST]{.bcp14} satisfy
2^16^ \< e \< 2^256^ and be odd per
\[[FIPS186](#FIPS186){.xref}\].[¶](#section-3-3){.pilcrow}

It is recognized that, while the vast majority of RSA signatures are
currently made using the RSASSA-PKCS1-v1_5 algorithm, the preferred RSA
signature scheme for new applications is RSASSA-PSS. CNSA
Suite-compliant X.509 certificates will be issued in accordance with
\[[RFC8603](#RFC8603){.xref}\], and while those certificates must be
signed and validated using RSASSA-PKCS1-v1_5, the subject\'s private key
can be used to generate signatures of either signing scheme. Where use
of RSASSA-PSS is indicated in this document, the following parameters
apply:[¶](#section-3-4){.pilcrow}

-   [The hash algorithm [MUST]{.bcp14} be id-sha384 as defined in
    \[[RFC8017](#RFC8017){.xref}\];[¶](#section-3-5.1){.pilcrow}]{#section-3-5.1}
-   [The mask generation function [MUST]{.bcp14} use the algorithm
    identifier mfg1SHA384Identifier as defined in
    \[[RFC4055](#RFC4055){.xref}\];[¶](#section-3-5.2){.pilcrow}]{#section-3-5.2}
-   [The salt length [MUST]{.bcp14} be 48 octets;
    and[¶](#section-3-5.3){.pilcrow}]{#section-3-5.3}
-   [The trailerField [MUST]{.bcp14} have value
    1.[¶](#section-3-5.4){.pilcrow}]{#section-3-5.4}

These parameters will not appear in a certificate and [MUST]{.bcp14} be
securely communicated with the signature, as required by [Section
2.2](https://www.rfc-editor.org/rfc/rfc4056#section-2.2){.relref} of
\[[RFC4056](#RFC4056){.xref}\]. Application developers are obliged to
ensure that the chosen signature scheme is appropriate for the
application and will be interoperable within the intended operating
scope of the application.[¶](#section-3-6){.pilcrow}

This document assumes that the required trust anchors have been securely
provisioned to the client and, when applicable, to any
RAs.[¶](#section-3-7){.pilcrow}

All requirements in \[[RFC5272](#RFC5272){.xref}\],
\[[RFC5273](#RFC5273){.xref}\], \[[RFC5274](#RFC5274){.xref}\], and
\[[RFC6402](#RFC6402){.xref}\] apply, except where overridden by this
profile.[¶](#section-3-8){.pilcrow}

This profile was developed with the scenarios described in [Appendix
A](#scenarios){.xref} in mind. However, use of this profile is not
limited to just those scenarios.[¶](#section-3-9){.pilcrow}

The term \"client\" in this profile typically refers to an end-entity.
However, it may instead refer to a third party acting on the
end-entity\'s behalf. The client may or may not be the entity that
actually generates the key pair, but it does perform the CMC protocol
interactions with the RA and/or CA. For example, the client may be a
token management system that communicates with a cryptographic token
through an out-of-band secure protocol.[¶](#section-3-10){.pilcrow}

This profile uses the term \"rekey\" in the same manner as CMC does
(defined in [Section
2](https://www.rfc-editor.org/rfc/rfc5272#section-2){.relref} of
\[[RFC5272](#RFC5272){.xref}\]). The profile makes no specific
statements about the ability to do \"renewal\" operations; however, the
statements applicable to \"rekey\" should be applied to \"renewal\" as
well.[¶](#section-3-11){.pilcrow}

This profile may be used to manage RA and/or CA certificates. In that
case, the RA and/or CA whose certificate is being managed is considered
to be the end-entity.[¶](#section-3-12){.pilcrow}

This profile does not discuss key establishment certification requests
from cryptographic modules that cannot generate a one-time signature
with a key establishment key for proof-of-possession purposes. In that
case, a separate profile would be needed to define the use of another
proof-of-possession technique.[¶](#section-3-13){.pilcrow}
:::
:::

::: {#client-reqts-gen}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Client Requirements: Generating PKI Requests](#name-client-requirements-generat){.section-name .selfRef} {#name-client-requirements-generat}

This section specifies the conventions employed when a client requests a
certificate from a Public Key Infrastructure
(PKI).[¶](#section-4-1){.pilcrow}

The Full PKI Request [MUST]{.bcp14} be used; it [MUST]{.bcp14} be
encapsulated in a SignedData; and the SignedData [MUST]{.bcp14} be
constructed in accordance with \[[RFC8755](#RFC8755){.xref}\]. The
PKIData content type defined in \[[RFC5272](#RFC5272){.xref}\] is used
with the following additional requirements:[¶](#section-4-2){.pilcrow}

-   ::: {#section-4-3.1}
    controlSequence [SHOULD]{.bcp14} be
    present.[¶](#section-4-3.1.1){.pilcrow}

    -   [TransactionId and SenderNonce [SHOULD]{.bcp14} be included.
        Other CMC controls [MAY]{.bcp14} be
        included.[¶](#section-4-3.1.2.1){.pilcrow}]{#section-4-3.1.2.1}

    -   ::: {#section-4-3.1.2.2}
        If the request is being authenticated using a shared-secret,
        then Identity Proof Version 2 control [MUST]{.bcp14} be included
        with the following
        constraints:[¶](#section-4-3.1.2.2.1){.pilcrow}

        -   [hashAlgId [MUST]{.bcp14} be id-sha384 for all certification
            requests (algorithm OIDs are defined in
            \[[RFC5754](#RFC5754){.xref}\]).[¶](#section-4-3.1.2.2.2.1){.pilcrow}]{#section-4-3.1.2.2.2.1}
        -   [macAlgId [MUST]{.bcp14} be HMAC-SHA384 (the Hashed Message
            Authentication Code (HMAC) algorithm is defined in
            \[[RFC4231](#RFC4231){.xref}\]).[¶](#section-4-3.1.2.2.2.2){.pilcrow}]{#section-4-3.1.2.2.2.2}
        :::

    -   [If the subject name included in the certification request is
        NULL or otherwise does not uniquely identify the end-entity,
        then the POP Link Random control [MUST]{.bcp14} be included, and
        the POP Link Witness Version 2 control [MUST]{.bcp14} be
        included in the inner PKCS #10 \[[RFC2986](#RFC2986){.xref}\] or
        Certificate Request Message Format (CRMF)
        \[[RFC4211](#RFC4211){.xref}\] request as described in Sections
        [4.1](#tgd-cert-reqst){.xref} and
        [4.2](#cert-reqst-msg){.xref}.[¶](#section-4-3.1.2.3){.pilcrow}]{#section-4-3.1.2.3}
    :::

-   [reqSequence [MUST]{.bcp14} be present. It [MUST]{.bcp14} include at
    least one tcr (see [Section 4.1](#tgd-cert-reqst){.xref}) or crm
    (see [Section 4.2](#cert-reqst-msg){.xref}) TaggedRequest. Support
    for the orm choice is
    [OPTIONAL]{.bcp14}.[¶](#section-4-3.2){.pilcrow}]{#section-4-3.2}

The private signing key used to generate the encapsulating SignedData
[MUST]{.bcp14} correspond to the public key of an existing signature
certificate unless an appropriate signature certificate does not yet
exist, such as during initial enrollment.[¶](#section-4-4){.pilcrow}

The encapsulating SignedData [MUST]{.bcp14} be generated using SHA-384
and either ECDSA on P-384 or RSA using either RSASSA-PKCS1-v1_5 or
RSASSA-PSS with an RSA-3072 or RSA-4096 key.[¶](#section-4-5){.pilcrow}

If an appropriate signature certificate does not yet exist and if a Full
PKI Request includes one or more certification requests and is
authenticated using a shared-secret (because no appropriate certificate
exists yet to authenticate the request), the Full PKI Request
[MUST]{.bcp14} be signed using the private key corresponding to the
public key of one of the requested certificates. When necessary (i.e.,
because there is no existing signature certificate and there is no
signature certification request included), a Full PKI Request
[MAY]{.bcp14} be signed using a key pair intended for use in a key
establishment certificate. However, servers are not required to allow
this behavior.[¶](#section-4-6){.pilcrow}

::: {#tgd-cert-reqst}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Tagged Certification Request](#name-tagged-certification-reques){.section-name .selfRef} {#name-tagged-certification-reques}

The reqSequence tcr choice conveys PKCS #10
\[[RFC2986](#RFC2986){.xref}\] syntax. The CertificateRequest
[MUST]{.bcp14} comply with \[[RFC5272](#RFC5272){.xref}\], [Section
3.2.1.2.1](https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.1){.relref},
with the following additional requirements:[¶](#section-4.1-1){.pilcrow}

-   ::: {#section-4.1-2.1}
    certificationRequestInfo:[¶](#section-4.1-2.1.1){.pilcrow}

    -   [subjectPublicKeyInfo [MUST]{.bcp14} be set as defined in
        [Section
        5.4](https://www.rfc-editor.org/rfc/rfc8603#section-5.4){.relref}
        of
        \[[RFC8603](#RFC8603){.xref}\].[¶](#section-4.1-2.1.2.1){.pilcrow}]{#section-4.1-2.1.2.1}

    -   ::: {#section-4.1-2.1.2.2}
        Attributes:[¶](#section-4.1-2.1.2.2.1){.pilcrow}

        -   ::: {#section-4.1-2.1.2.2.2.1}
            The ExtensionReq attribute [MUST]{.bcp14} be included with
            its contents as
            follows:[¶](#section-4.1-2.1.2.2.2.1.1){.pilcrow}

            -   [The keyUsage extension [MUST]{.bcp14} be included, and
                it [MUST]{.bcp14} be set as defined in
                \[[RFC8603](#RFC8603){.xref}\].[¶](#section-4.1-2.1.2.2.2.1.2.1){.pilcrow}]{#section-4.1-2.1.2.2.2.1.2.1}
            -   [For rekey requests, the SubjectAltName extension
                [MUST]{.bcp14} be included and set equal to the
                SubjectAltName of the certificate that is being used to
                sign the SignedData encapsulating the request (i.e., not
                the certificate being rekeyed) if the subject field of
                the certificate being used to generate the signature is
                NULL.[¶](#section-4.1-2.1.2.2.2.1.2.2){.pilcrow}]{#section-4.1-2.1.2.2.2.1.2.2}
            -   [Other extension requests [MAY]{.bcp14} be included as
                desired.[¶](#section-4.1-2.1.2.2.2.1.2.3){.pilcrow}]{#section-4.1-2.1.2.2.2.1.2.3}
            :::

        -   [The ChangeSubjectName attribute, as defined in
            \[[RFC6402](#RFC6402){.xref}\], [MUST]{.bcp14} be included
            if the Full PKI Request encapsulating this Tagged
            Certification Request is being signed by a key for which a
            certificate currently exists and the existing certificate\'s
            subject field or SubjectAltName extension does not match the
            desired subject name or SubjectAltName extension of this
            certification
            request.[¶](#section-4.1-2.1.2.2.2.2){.pilcrow}]{#section-4.1-2.1.2.2.2.2}

        -   [The POP Link Witness Version 2 attribute [MUST]{.bcp14} be
            included if the request is being authenticated using a
            shared-secret and the subject name in the certification
            request is NULL or otherwise does not uniquely identify the
            end-entity. In the POP Link Witness Version 2 attribute,
            keyGenAlgorithm [MUST]{.bcp14} be id-sha384 for
            certification requests, as defined in
            \[[RFC5754](#RFC5754){.xref}\]; macAlgorithm [MUST]{.bcp14}
            be HMAC-SHA384, as defined in
            \[[RFC4231](#RFC4231){.xref}\].[¶](#section-4.1-2.1.2.2.2.3){.pilcrow}]{#section-4.1-2.1.2.2.2.3}
        :::

    -   [signatureAlgorithm [MUST]{.bcp14} be ecdsa-with-sha384 for
        P-384 certification requests and sha384WithRSAEncryption or
        id-RSASSA-PSS for RSA-3072 and RSA-4096 certification
        requests.[¶](#section-4.1-2.1.2.3){.pilcrow}]{#section-4.1-2.1.2.3}

    -   [signature [MUST]{.bcp14} be generated using the private key
        corresponding to the public key in the CertificationRequestInfo
        for both signature and key establishment certification requests.
        The signature provides proof-of-possession of the private key to
        the
        CA.[¶](#section-4.1-2.1.2.4){.pilcrow}]{#section-4.1-2.1.2.4}
    :::
:::
:::

::: {#cert-reqst-msg}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Certificate Request Message](#name-certificate-request-message){.section-name .selfRef} {#name-certificate-request-message}

The reqSequence crm choice conveys Certificate Request Message Format
(CRMF) \[[RFC4211](#RFC4211){.xref}\] syntax. The CertReqMsg
[MUST]{.bcp14} comply with \[[RFC5272](#RFC5272){.xref}\], [Section
3.2.1.2.2](https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2){.relref},
with the following additional requirements:[¶](#section-4.2-1){.pilcrow}

-   [popo [MUST]{.bcp14} be included using the signature
    (POPOSigningKey) proof-of-possession choice and be set as defined in
    \[[RFC4211](#RFC4211){.xref}\], [Section
    4.1](https://www.rfc-editor.org/rfc/rfc4211#section-4.1){.relref}
    for both signature and key establishment certification requests. The
    POPOSigningKey poposkInput field [MUST]{.bcp14} be omitted. The
    POPOSigningKey algorithmIdentifier [MUST]{.bcp14} be
    ecdsa-with-sha384 for P-384 certification requests and
    sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096
    certification requests. The signature [MUST]{.bcp14} be generated
    using the private key corresponding to the public key in the
    CertTemplate.[¶](#section-4.2-2.1){.pilcrow}]{#section-4.2-2.1}

The CertTemplate [MUST]{.bcp14} comply with
\[[RFC5272](#RFC5272){.xref}\], [Section
3.2.1.2.2](https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2){.relref},
with the following additional requirements:[¶](#section-4.2-3){.pilcrow}

-   [If version is included, it [MUST]{.bcp14} be set to 2 as defined in
    [Section
    5.3](https://www.rfc-editor.org/rfc/rfc8603#section-5.3){.relref} of
    \[[RFC8603](#RFC8603){.xref}\].[¶](#section-4.2-4.1){.pilcrow}]{#section-4.2-4.1}

-   [publicKey [MUST]{.bcp14} be set as defined in [Section
    5.4](https://www.rfc-editor.org/rfc/rfc8603#section-5.4){.relref} of
    \[[RFC8603](#RFC8603){.xref}\].[¶](#section-4.2-4.2){.pilcrow}]{#section-4.2-4.2}

-   ::: {#section-4.2-4.3}
    Extensions:[¶](#section-4.2-4.3.1){.pilcrow}

    -   [The keyUsage extension [MUST]{.bcp14} be included, and it
        [MUST]{.bcp14} be set as defined in
        \[[RFC8603](#RFC8603){.xref}\].[¶](#section-4.2-4.3.2.1){.pilcrow}]{#section-4.2-4.3.2.1}
    -   [For rekey requests, the SubjectAltName extension [MUST]{.bcp14}
        be included and set equal to the SubjectAltName of the
        certificate that is being used to sign the SignedData
        encapsulating the request (i.e., not the certificate being
        rekeyed) if the subject name of the certificate being used to
        generate the signature is
        NULL.[¶](#section-4.2-4.3.2.2){.pilcrow}]{#section-4.2-4.3.2.2}
    -   [Other extension requests [MAY]{.bcp14} be included as
        desired.[¶](#section-4.2-4.3.2.3){.pilcrow}]{#section-4.2-4.3.2.3}
    :::

-   ::: {#section-4.2-4.4}
    Controls:[¶](#section-4.2-4.4.1){.pilcrow}

    -   [The ChangeSubjectName attribute, as defined in
        \[[RFC6402](#RFC6402){.xref}\], [MUST]{.bcp14} be included if
        the Full PKI Request encapsulating this Tagged Certification
        Request is being signed by a key for which a certificate
        currently exists and the existing certificate\'s subject name or
        SubjectAltName extension does not match the desired subject name
        or SubjectAltName extension of this certification
        request.[¶](#section-4.2-4.4.2.1){.pilcrow}]{#section-4.2-4.4.2.1}
    -   [The POP Link Witness Version 2 attribute [MUST]{.bcp14} be
        included if the request is being authenticated using a
        shared-secret and the subject name in the certification request
        is NULL or otherwise does not uniquely identify the end-entity.
        In the POP Link Witness Version 2 attribute, keyGenAlgorithm
        [MUST]{.bcp14} be id-sha384 for certification requests;
        macAlgorithm [MUST]{.bcp14} be HMAC-SHA384 when keyGenAlgorithm
        is
        id-sha384.[¶](#section-4.2-4.4.2.2){.pilcrow}]{#section-4.2-4.4.2.2}
    :::
:::
:::
:::
:::

::: {#ra_reqts}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [RA Requirements](#name-ra-requirements){.section-name .selfRef} {#name-ra-requirements}

This section addresses the optional case where one or more RAs act as
intermediaries between clients and a CA as described in [Section
7](https://www.rfc-editor.org/rfc/rfc5272#section-7){.relref} of
\[[RFC5272](#RFC5272){.xref}\]. In this section, the term \"client\"
refers to the entity from which the RA received the PKI Request. This
section is only applicable to RAs.[¶](#section-5-1){.pilcrow}

::: {#ra-proc-reqst}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [RA Processing of Requests](#name-ra-processing-of-requests){.section-name .selfRef} {#name-ra-processing-of-requests}

RAs conforming to this document [MUST]{.bcp14} ensure that only the
permitted signature, hash, and MAC algorithms described throughout this
profile are used in requests; if they are not, the RA [MUST]{.bcp14}
reject those requests. The RA [SHOULD]{.bcp14} return a CMCFailInfo with
the value of badAlg
\[[RFC5272](#RFC5272){.xref}\].[¶](#section-5.1-1){.pilcrow}

When processing end-entity-generated SignedData objects, RAs [MUST
NOT]{.bcp14} perform Cryptographic Message Syntax (CMS) Content
Constraints (CCC) certificate extension processing
\[[RFC6010](#RFC6010){.xref}\].[¶](#section-5.1-2){.pilcrow}

Other RA processing is performed as described in
\[[RFC5272](#RFC5272){.xref}\].[¶](#section-5.1-3){.pilcrow}
:::
:::

::: {#ra-gend-pki-reqst}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [RA-Generated PKI Requests](#name-ra-generated-pki-requests){.section-name .selfRef} {#name-ra-generated-pki-requests}

RAs mediate the certificate request process by collecting client
requests in batches. The RA [MUST]{.bcp14} encapsulate client-generated
PKI Requests in a new RA-signed PKI Request, it [MUST]{.bcp14} create a
Full PKI Request encapsulated in a SignedData, and the SignedData
[MUST]{.bcp14} be constructed in accordance with
\[[RFC8755](#RFC8755){.xref}\]. The PKIData content type complies with
\[[RFC5272](#RFC5272){.xref}\] with the following additional
requirements:[¶](#section-5.2-1){.pilcrow}

-   [controlSequence [MUST]{.bcp14} be present. It [MUST]{.bcp14}
    include the following CMC controls: Transaction ID, Sender Nonce,
    and Batch Requests. Other appropriate CMC controls [MAY]{.bcp14} be
    included.[¶](#section-5.2-2.1){.pilcrow}]{#section-5.2-2.1}
-   [cmsSequence [MUST]{.bcp14} be present. It contains the original,
    unmodified request(s) received from the
    client.[¶](#section-5.2-2.2){.pilcrow}]{#section-5.2-2.2}

::: {#section-5.2-3}
``` sourcecode
      SignedData (applied by the RA)
        PKIData
          controlSequence (Transaction ID, Sender Nonce,
                                               Batch Requests)
          cmsSequence
            SignedData (applied by client)
              PKIData
                controlSequence (Transaction ID, Sender Nonce)
                reqSequence
                  TaggedRequest
                  {TaggedRequest}
            {SignedData     (second client request)
              PKIData...}
```

[¶](#section-5.2-3){.pilcrow}
:::

Authorization to sign RA-generated Full PKI Requests [SHOULD]{.bcp14} be
indicated in the RA certificate by inclusion of the id-kp-cmcRA Extended
Key Usage (EKU) from \[[RFC6402](#RFC6402){.xref}\]. The RA certificate
[MAY]{.bcp14} also include the CCC certificate extension
\[[RFC6010](#RFC6010){.xref}\], or it [MAY]{.bcp14} indicate
authorization through inclusion of the CCC certificate extension alone.
The RA certificate may also be authorized through the local
configuration.[¶](#section-5.2-4){.pilcrow}

If the RA is authorized via the CCC extension, then the CCC extension
[MUST]{.bcp14} include the object identifier for the PKIData content
type. CCC [SHOULD]{.bcp14} be included if constraints are to be placed
on the content types generated.[¶](#section-5.2-5){.pilcrow}

The outer SignedData [MUST]{.bcp14} be generated using SHA-384 and
either ECDSA on P-384 or RSA using RSASSA-PKCS1-v1_5 or RSASSA-PSS with
an RSA-3072 or RSA-4096 key.[¶](#section-5.2-6){.pilcrow}

If the Full PKI Response is a successful response to a PKI Request that
only contained a Get Certificate or Get CRL control, then the algorithm
used in the response [MUST]{.bcp14} match the algorithm used in the
request.[¶](#section-5.2-7){.pilcrow}
:::
:::

::: {#ra-gend-resp}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [RA-Generated PKI Responses](#name-ra-generated-pki-responses){.section-name .selfRef} {#name-ra-generated-pki-responses}

In order for an RA certificate using the CCC certificate extension to be
authorized to generate responses, the object identifier for the
PKIResponse content type must be present in the CCC certificate
extension.[¶](#section-5.3-1){.pilcrow}
:::
:::
:::
:::

::: {#ca-reqts}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [CA Requirements](#name-ca-requirements){.section-name .selfRef} {#name-ca-requirements}

This section specifies the requirements for CAs that receive PKI
Requests and generate PKI Responses.[¶](#section-6-1){.pilcrow}

::: {#ca-proc-reqst}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [CA Processing of PKI Requests](#name-ca-processing-of-pki-reques){.section-name .selfRef} {#name-ca-processing-of-pki-reques}

CAs conforming to this document [MUST]{.bcp14} ensure that only the
permitted signature, hash, and MAC algorithms described throughout this
profile are used in requests; if they are not, the CA [MUST]{.bcp14}
reject those requests. The CA [SHOULD]{.bcp14} return a CMCStatusInfoV2
control with a CMCStatus of failed and a CMCFailInfo with the value of
badAlg \[[RFC5272](#RFC5272){.xref}\].[¶](#section-6.1-1){.pilcrow}

For requests involving an RA (i.e., batched requests), the CA
[MUST]{.bcp14} verify the RA\'s authorization. The following certificate
fields [MUST NOT]{.bcp14} be modifiable using the Modify Certification
Request control: publicKey and the keyUsage extension. The request
[MUST]{.bcp14} be rejected if an attempt to modify those certification
request fields is present. The CA [SHOULD]{.bcp14} return a
CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo
with a value of badRequest.[¶](#section-6.1-2){.pilcrow}

When processing end-entity-generated SignedData objects, CAs [MUST
NOT]{.bcp14} perform CCC certificate extension processing
\[[RFC6010](#RFC6010){.xref}\].[¶](#section-6.1-3){.pilcrow}

If a client-generated PKI Request includes the ChangeSubjectName
attribute as described in [Section 4.1](#tgd-cert-reqst){.xref} or
[4.2](#cert-reqst-msg){.xref} above, the CA [MUST]{.bcp14} ensure that
name change is authorized. The mechanism for ensuring that the name
change is authorized is out of scope. A CA that performs this check and
finds that the name change is not authorized [MUST]{.bcp14} reject the
PKI Request. The CA [SHOULD]{.bcp14} return an Extended CMC Status Info
control (CMCStatusInfoV2) with a CMCStatus of
failed.[¶](#section-6.1-4){.pilcrow}

Other processing of PKIRequests is performed as described in
\[[RFC5272](#RFC5272){.xref}\].[¶](#section-6.1-5){.pilcrow}
:::
:::

::: {#ca-gend-resp}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [CA-Generated PKI Responses](#name-ca-generated-pki-responses){.section-name .selfRef} {#name-ca-generated-pki-responses}

CAs send PKI Responses to both client-generated requests and
RA-generated requests. If a Full PKI Response is returned in direct
response to a client-generated request, it [MUST]{.bcp14} be
encapsulated in a SignedData, and the SignedData [MUST]{.bcp14} be
constructed in accordance with
\[[RFC8755](#RFC8755){.xref}\].[¶](#section-6.2-1){.pilcrow}

If the PKI Response is in response to an RA-generated PKI Request, then
the above PKI Response is encapsulated in another CA-generated PKI
Response. That PKI Response [MUST]{.bcp14} be encapsulated in a
SignedData, and the SignedData [MUST]{.bcp14} be constructed in
accordance with \[[RFC8755](#RFC8755){.xref}\]. The above PKI Response
is placed in the encapsulating PKI Response cmsSequence field. The other
fields are as above with the addition of the batch response control in
controlSequence. The following illustrates a successful CA response to
an RA-encapsulated PKI Request, both of which include Transaction IDs
and Nonces:[¶](#section-6.2-2){.pilcrow}

::: {#section-6.2-3}
``` sourcecode
      SignedData (applied by the CA)
        PKIResponse
          controlSequence (Transaction ID, Sender Nonce, Recipient
                           Nonce, Batch Response)
          cmsSequence
            SignedData (applied by CA and includes returned
                        certificates)
              PKIResponse
                controlSequence (Transaction ID, Sender Nonce,
                                 Recipient Nonce)
```

[¶](#section-6.2-3){.pilcrow}
:::

The same private key used to sign certificates [MUST NOT]{.bcp14} be
used to sign Full PKI Response messages. Instead, a separate certificate
indicating authorization to sign CMC responses [MUST]{.bcp14} be
used.[¶](#section-6.2-4){.pilcrow}

Authorization to sign Full PKI Responses [SHOULD]{.bcp14} be indicated
in the CA certificate by inclusion of the id-kp-cmcCA EKU from
\[[RFC6402](#RFC6402){.xref}\]. The CA certificate [MAY]{.bcp14} also
include the CCC certificate extension \[[RFC6010](#RFC6010){.xref}\], or
it [MAY]{.bcp14} indicate authorization through inclusion of the CCC
certificate extension alone. The CA certificate may also be authorized
through local configuration.[¶](#section-6.2-5){.pilcrow}

In order for a CA certificate using the CCC certificate extension to be
authorized to generate responses, the object identifier for the
PKIResponse content type must be present in the CCC certificate
extension. CCC [SHOULD]{.bcp14} be included if constraints are to be
placed on the content types generated.[¶](#section-6.2-6){.pilcrow}

Signatures applied to individual certificates are as required in
\[[RFC8603](#RFC8603){.xref}\].[¶](#section-6.2-7){.pilcrow}

The signature on the SignedData of a successful response to a
client-generated request, or each individual inner SignedData on the
successful response to an RA-generated request, [MUST]{.bcp14} be
generated using SHA-384 and either ECDSA on P-384 or RSA using
RSASSA-PKCS1-v1_5 or RSASSA-PSS with an RSA-3072 or RSA-4096 key. An
unsuccessful response [MUST]{.bcp14} be signed using the same key type
and algorithm that signed the request.[¶](#section-6.2-8){.pilcrow}

The outer SignedData on the Full PKI Response to any RA-generated PKI
Request [MUST]{.bcp14} be signed with the same key type and algorithm
that signed the request.[¶](#section-6.2-9){.pilcrow}

The SignedData on a successful Full PKI Response to a PKI Request that
only contained a Get Certificate or Get CRL control [MUST]{.bcp14} be
signed with the same key type and algorithm that signed the
request.[¶](#section-6.2-10){.pilcrow}
:::
:::
:::
:::

::: {#client-reqts-proc}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Client Requirements: Processing PKI Responses](#name-client-requirements-process){.section-name .selfRef} {#name-client-requirements-process}

Clients conforming to this document [MUST]{.bcp14} ensure that only the
permitted signature, hash, and MAC algorithms described throughout this
profile are used in responses; if they are not, the client
[MUST]{.bcp14} reject those responses.[¶](#section-7-1){.pilcrow}

Clients [MUST]{.bcp14} authenticate all Full PKI Responses. This
includes verifying that the PKI Response is signed by an authorized CA
or RA whose certificate validates back to a trust anchor. The authorized
CA certificate [MUST]{.bcp14} include the id-kp-cmcCA EKU and/or a CCC
extension that includes the object identifier for the PKIResponse
content type. Otherwise, the CA is determined to be authorized to sign
responses through an implementation-specific mechanism. The PKI Response
can be signed by an RA if it is an error message, if it is a response to
a Get Certificate or Get CRL request, or if the PKI Response contains an
inner PKI Response signed by a CA. In the last case, each layer of PKI
Response [MUST]{.bcp14} still contain an authorized, valid signature
signed by an entity with a valid certificate that verifies back to an
acceptable trust anchor. The authorized RA certificate [MUST]{.bcp14}
include the id-kp-cmcRA EKU and/or include a CCC extension that includes
the object identifier for the PKIResponse content type. Otherwise, the
RA is determined to be authorized to sign responses through local
configuration.[¶](#section-7-2){.pilcrow}

When a newly issued certificate is included in the PKI Response, the
client [MUST]{.bcp14} verify that the newly issued certificate\'s public
key matches the public key that the client requested. The client
[MUST]{.bcp14} also ensure that the certificate\'s signature is valid
and that the signature validates back to an acceptable trust
anchor.[¶](#section-7-3){.pilcrow}

Clients [MUST]{.bcp14} reject PKI Responses that do not pass these
tests. Local policy will determine whether the client returns a Full PKI
Response with an Extended CMC Status Info control (CMCStatusInfoV2) with
the CMCStatus set to failed to a user console, error log, or the
server.[¶](#section-7-4){.pilcrow}

If the Full PKI Response contains an Extended CMC Status Info control
with a CMCStatus set to failed, then local policy will determine whether
the client resends a duplicate certification request back to the server
or an error state is returned to a console or error
log.[¶](#section-7-5){.pilcrow}
:::
:::

::: {#shared-secrets}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Shared-Secrets](#name-shared-secrets){.section-name .selfRef} {#name-shared-secrets}

When the Identity Proof V2 and POP Link Witness V2 controls are used,
the shared-secret [MUST]{.bcp14} be randomly generated and securely
distributed. The shared-secret [MUST]{.bcp14} provide at least 192 bits
of strength.[¶](#section-8-1){.pilcrow}
:::
:::

::: {#sec-considerations}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

Protocol security considerations are found in
\[[RFC2986](#RFC2986){.xref}\], \[[RFC4211](#RFC4211){.xref}\],
\[[RFC8755](#RFC8755){.xref}\], \[[RFC5272](#RFC5272){.xref}\],
\[[RFC5273](#RFC5273){.xref}\], \[[RFC5274](#RFC5274){.xref}\],
\[[RFC8603](#RFC8603){.xref}\], and \[[RFC6402](#RFC6402){.xref}\]. When
CCC is used to authorize RA and CA certificates, then the security
considerations in \[[RFC6010](#RFC6010){.xref}\] also apply. Algorithm
security considerations are found in
\[[RFC8755](#RFC8755){.xref}\].[¶](#section-9-1){.pilcrow}

Compliant with NIST Special Publication 800-57
\[[SP80057](#SP80057){.xref}\], this profile defines proof-of-possession
of a key establishment private key by performing a digital signature.
Except for one-time proof-of-possession, a single key pair [MUST
NOT]{.bcp14} be used for both signature and key
establishment.[¶](#section-9-2){.pilcrow}

This specification requires implementations to generate key pairs and
other random values. The use of inadequate pseudorandom number
generators (PRNGs) can result in little or no security. The generation
of quality random numbers is difficult. NIST Special Publication 800-90A
\[[SP80090A](#SP80090A){.xref}\], FIPS 186-3
\[[FIPS186](#FIPS186){.xref}\], and \[[RFC4086](#RFC4086){.xref}\] offer
random number generation guidance.[¶](#section-9-3){.pilcrow}

When RAs are used, the list of authorized RAs [MUST]{.bcp14} be securely
distributed out of band to CAs.[¶](#section-9-4){.pilcrow}

Presence of the POP Link Witness Version 2 and POP Link Random
attributes protects against substitution
attacks.[¶](#section-9-5){.pilcrow}

The certificate policy for a particular environment will specify whether
expired certificates can be used to sign certification
requests.[¶](#section-9-6){.pilcrow}
:::
:::

::: {#iana-considerations}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-10-1){.pilcrow}
:::
:::

::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[CNSA\]
:   [Committee on National Security Systems]{.refAuthor}, [\"Use of
    Public Standards for Secure Information Sharing\"]{.refTitle}, [CNSS
    Policy 15]{.seriesInfo}, October 2016,
    \<<https://www.cnss.gov/CNSS/issuances/Policies.cfm>\>.

\[FIPS186\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Digital Signature Standard (DSS)\"]{.refTitle}, [DOI
    10.6028/NIST.FIPS.186-4]{.seriesInfo}, [FIPS PUB
    186-4]{.seriesInfo}, July 2013,
    \<<http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf>\>.

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.

\[RFC2986\]
:   [Nystrom, M.]{.refAuthor}[ and B. Kaliski]{.refAuthor}, [\"PKCS #10:
    Certification Request Syntax Specification Version
    1.7\"]{.refTitle}, [RFC 2986]{.seriesInfo}, [DOI
    10.17487/RFC2986]{.seriesInfo}, November 2000,
    \<<https://www.rfc-editor.org/info/rfc2986>\>.

\[RFC4055\]
:   [Schaad, J.]{.refAuthor}[, Kaliski, B.]{.refAuthor}[, and R.
    Housley]{.refAuthor}, [\"Additional Algorithms and Identifiers for
    RSA Cryptography for use in the Internet X.509 Public Key
    Infrastructure Certificate and Certificate Revocation List (CRL)
    Profile\"]{.refTitle}, [RFC 4055]{.seriesInfo}, [DOI
    10.17487/RFC4055]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4055>\>.

\[RFC4056\]
:   [Schaad, J.]{.refAuthor}, [\"Use of the RSASSA-PSS Signature
    Algorithm in Cryptographic Message Syntax (CMS)\"]{.refTitle}, [RFC
    4056]{.seriesInfo}, [DOI 10.17487/RFC4056]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4056>\>.

\[RFC4086\]
:   [Eastlake 3rd, D.]{.refAuthor}[, Schiller, J.]{.refAuthor}[, and S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.

\[RFC4211\]
:   [Schaad, J.]{.refAuthor}, [\"Internet X.509 Public Key
    Infrastructure Certificate Request Message Format
    (CRMF)\"]{.refTitle}, [RFC 4211]{.seriesInfo}, [DOI
    10.17487/RFC4211]{.seriesInfo}, September 2005,
    \<<https://www.rfc-editor.org/info/rfc4211>\>.

\[RFC4231\]
:   [Nystrom, M.]{.refAuthor}, [\"Identifiers and Test Vectors for
    HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and
    HMAC-SHA-512\"]{.refTitle}, [RFC 4231]{.seriesInfo}, [DOI
    10.17487/RFC4231]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4231>\>.

\[RFC5272\]
:   [Schaad, J.]{.refAuthor}[ and M. Myers]{.refAuthor}, [\"Certificate
    Management over CMS (CMC)\"]{.refTitle}, [RFC 5272]{.seriesInfo},
    [DOI 10.17487/RFC5272]{.seriesInfo}, June 2008,
    \<<https://www.rfc-editor.org/info/rfc5272>\>.

\[RFC5273\]
:   [Schaad, J.]{.refAuthor}[ and M. Myers]{.refAuthor}, [\"Certificate
    Management over CMS (CMC): Transport Protocols\"]{.refTitle}, [RFC
    5273]{.seriesInfo}, [DOI 10.17487/RFC5273]{.seriesInfo}, June 2008,
    \<<https://www.rfc-editor.org/info/rfc5273>\>.

\[RFC5274\]
:   [Schaad, J.]{.refAuthor}[ and M. Myers]{.refAuthor}, [\"Certificate
    Management Messages over CMS (CMC): Compliance
    Requirements\"]{.refTitle}, [RFC 5274]{.seriesInfo}, [DOI
    10.17487/RFC5274]{.seriesInfo}, June 2008,
    \<<https://www.rfc-editor.org/info/rfc5274>\>.

\[RFC5754\]
:   [Turner, S.]{.refAuthor}, [\"Using SHA2 Algorithms with
    Cryptographic Message Syntax\"]{.refTitle}, [RFC 5754]{.seriesInfo},
    [DOI 10.17487/RFC5754]{.seriesInfo}, January 2010,
    \<<https://www.rfc-editor.org/info/rfc5754>\>.

\[RFC6010\]
:   [Housley, R.]{.refAuthor}[, Ashmore, S.]{.refAuthor}[, and C.
    Wallace]{.refAuthor}, [\"Cryptographic Message Syntax (CMS) Content
    Constraints Extension\"]{.refTitle}, [RFC 6010]{.seriesInfo}, [DOI
    10.17487/RFC6010]{.seriesInfo}, September 2010,
    \<<https://www.rfc-editor.org/info/rfc6010>\>.

\[RFC6402\]
:   [Schaad, J.]{.refAuthor}, [\"Certificate Management over CMS (CMC)
    Updates\"]{.refTitle}, [RFC 6402]{.seriesInfo}, [DOI
    10.17487/RFC6402]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6402>\>.

\[RFC8017\]
:   [Moriarty, K., Ed.]{.refAuthor}[, Kaliski, B.]{.refAuthor}[,
    Jonsson, J.]{.refAuthor}[, and A. Rusch]{.refAuthor}, [\"PKCS #1:
    RSA Cryptography Specifications Version 2.2\"]{.refTitle}, [RFC
    8017]{.seriesInfo}, [DOI 10.17487/RFC8017]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8017>\>.

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.

\[RFC8603\]
:   [Jenkins, M.]{.refAuthor}[ and L. Zieglar]{.refAuthor},
    [\"Commercial National Security Algorithm (CNSA) Suite Certificate
    and Certificate Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    8603]{.seriesInfo}, [DOI 10.17487/RFC8603]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8603>\>.

\[RFC8755\]
:   [Jenkins, M.]{.refAuthor}, [\"Using Commercial National Security
    Algorithm Suite Algorithms in Secure/Multipurpose Internet Mail
    Extensions\"]{.refTitle}, [RFC 8755]{.seriesInfo}, [DOI
    10.17487/RFC8755]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8755>\>.
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[SP80057\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Recommendation for Key Management, Part 1: General\"]{.refTitle},
    [DOI 10.6028/NIST.SP.800-57pt1r4]{.seriesInfo}, [Special Publication
    800-57, Part 1, Revision 4]{.seriesInfo}, January 2016,
    \<[http://doi.org/10.6028/NIST.SP.800-57pt1r4](https://doi.org/10.6028/NIST.SP.800-57pt1r4)\>.

\[SP80059\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Guideline for Identifying an Information System as a National
    Security System\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-59]{.seriesInfo}, [Special Publication
    800-59]{.seriesInfo}, August 2003,
    \<<https://csrc.nist.gov/publications/detail/sp/800-59/final>\>.

\[SP80090A\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Recommendation for Random Number Generation Using Deterministic
    Random Bit Generators\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-90Ar1]{.seriesInfo}, [Special Publication
    800-90A Revision 1]{.seriesInfo}, June 2015,
    \<[http://doi.org/10.6028/NIST.SP.800-90Ar1](https://doi.org/10.6028/NIST.SP.800-90Ar1)\>.
:::
:::

::: {#scenarios}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Scenarios](#name-scenarios){.section-name .selfRef} {#name-scenarios}

This section illustrates several potential certificate enrollment and
rekey scenarios supported by this profile. This section does not intend
to place any limits or restrictions on the use of
CMC.[¶](#section-appendix.a-1){.pilcrow}

::: {#init_enroll}
::: {#section-a.1 .section}
## [A.1.](#section-a.1){.section-number .selfRef} [Initial Enrollment](#name-initial-enrollment){.section-name .selfRef} {#name-initial-enrollment}

This section describes three scenarios for authenticating initial
enrollment requests:[¶](#section-a.1-1){.pilcrow}

1.  [Previously certified signature key-pair (e.g., Manufacturer
    Installed
    Certificate).[¶](#section-a.1-2.1){.pilcrow}]{#section-a.1-2.1}
2.  [Shared-secret distributed securely out of
    band.[¶](#section-a.1-2.2){.pilcrow}]{#section-a.1-2.2}
3.  [RA
    authentication.[¶](#section-a.1-2.3){.pilcrow}]{#section-a.1-2.3}

::: {#prev_inst}
::: {#section-a.1.1 .section}
### [A.1.1.](#section-a.1.1){.section-number .selfRef} [Previously Certified Signature Key-Pair](#name-previously-certified-signat){.section-name .selfRef} {#name-previously-certified-signat}

In this scenario, the end-entity has a private signing key and a
corresponding public key certificate obtained from a cryptographic
module manufacturer recognized by the CA. The end-entity signs a Full
PKI Request with the private key that corresponds to the subject public
key of the previously installed signature certificate. The CA will
verify the authorization of the previously installed certificate and
issue an appropriate new certificate to the
end-entity.[¶](#section-a.1.1-1){.pilcrow}
:::
:::

::: {#ss_oob}
::: {#section-a.1.2 .section}
### [A.1.2.](#section-a.1.2){.section-number .selfRef} [Shared-Secret Distributed Securely Out of Band](#name-shared-secret-distributed-s){.section-name .selfRef} {#name-shared-secret-distributed-s}

In this scenario, the CA distributes a shared-secret out of band to the
end-entity that the end-entity uses to authenticate its certification
request. The end-entity signs the Full PKI Request with the private key
for which the certification is being requested. The end-entity includes
the Identity Proof Version 2 control to authenticate the request using
the shared-secret. The CA uses either the Identification control or the
subject name in the end-entity\'s enclosed PKCS #10
\[[RFC2986](#RFC2986){.xref}\] or CRMF \[[RFC4211](#RFC4211){.xref}\]
certification request message to identify the request. The end-entity
performs either the POP Link Witness Version 2 mechanism as described in
\[[RFC5272](#RFC5272){.xref}\], [Section
6.3.1.1](https://www.rfc-editor.org/rfc/rfc5272#section-6.3.1.1){.relref}
or the shared-secret/subject distinguished name linking mechanism as
described in \[[RFC5272](#RFC5272){.xref}\], [Section
6.3.2](https://www.rfc-editor.org/rfc/rfc5272#section-6.3.2){.relref}.
The subject name in the enclosed PKCS #10 \[[RFC2986](#RFC2986){.xref}\]
or CRMF \[[RFC4211](#RFC4211){.xref}\] certification request does not
necessarily match the issued certificate, as it may be used just to help
identify the request (and the corresponding shared-secret) to the
CA.[¶](#section-a.1.2-1){.pilcrow}
:::
:::

::: {#ra_auth}
::: {#section-a.1.3 .section}
### [A.1.3.](#section-a.1.3){.section-number .selfRef} [RA Authentication](#name-ra-authentication){.section-name .selfRef} {#name-ra-authentication}

In this scenario, the end-entity does not automatically authenticate its
enrollment request to the CA, either because the end-entity has nothing
to authenticate the request with or because the organizational policy
requires an RA\'s involvement. The end-entity creates a Full PKI Request
and sends it to an RA. The RA verifies the authenticity of the request.
If the request is approved, the RA encapsulates and signs the request as
described in [Section 4.2](#cert-reqst-msg){.xref}, forwarding the new
request on to the CA. The subject name in the PKCS #10
\[[RFC2986](#RFC2986){.xref}\] or CRMF \[[RFC4211](#RFC4211){.xref}\]
certification request is not required to match the issued certificate;
it may be used just to help identify the request to the RA and/or
CA.[¶](#section-a.1.3-1){.pilcrow}
:::
:::
:::
:::

::: {#rekey}
::: {#section-a.2 .section}
## [A.2.](#section-a.2){.section-number .selfRef} [Rekey](#name-rekey){.section-name .selfRef} {#name-rekey}

There are two scenarios to support the rekey of certificates that are
already enrolled. One addresses the rekey of signature certificates, and
the other addresses the rekey of key establishment certificates.
Typically, organizational policy will require certificates to be
currently valid to be rekeyed, and it may require initial enrollment to
be repeated when rekey is not possible. However, some organizational
policies might allow a grace period during which an expired certificate
could be used to rekey.[¶](#section-a.2-1){.pilcrow}

::: {#rk_sig}
::: {#section-a.2.1 .section}
### [A.2.1.](#section-a.2.1){.section-number .selfRef} [Rekey of Signature Certificates](#name-rekey-of-signature-certific){.section-name .selfRef} {#name-rekey-of-signature-certific}

When a signature certificate is rekeyed, the [PKCS #10](#RFC2986){.xref}
\[[RFC2986](#RFC2986){.xref}\] or [CRMF](#RFC4211){.xref}
\[[RFC4211](#RFC4211){.xref}\] certification request message enclosed in
the Full PKI Request will include the same subject name as the current
signature certificate. The Full PKI Request will be signed by the
current private key corresponding to the current signature
certificate.[¶](#section-a.2.1-1){.pilcrow}
:::
:::

::: {#rk_kes}
::: {#section-a.2.2 .section}
### [A.2.2.](#section-a.2.2){.section-number .selfRef} [Rekey of Key Establishment Certificates](#name-rekey-of-key-establishment-){.section-name .selfRef} {#name-rekey-of-key-establishment-}

When a key establishment certificate is rekeyed, the Full PKI Request
will generally be signed by the current private key corresponding to the
current signature certificate. If there is no current signature
certificate, one of the initial enrollment options in [Appendix
A.1](#init_enroll){.xref} may be used.[¶](#section-a.2.2-1){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Michael Jenkins]{.fn .nameRole}
:::

::: {.left dir="auto"}
[National Security Agency]{.org}
:::

::: email
Email: <mjjenki@nsa.gov>
:::

::: {.left dir="auto"}
[Lydia Zieglar]{.fn .nameRole}
:::

::: {.left dir="auto"}
[National Security Agency]{.org}
:::

::: email
Email: <llziegl@tycho.ncsc.mil>
:::
:::
:::
