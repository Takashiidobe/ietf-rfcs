  RFC 9060   STIR Certificate Delegation   September 2021
  ---------- ----------------------------- ----------------
  Peterson   Standards Track               \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9060](https://www.rfc-editor.org/rfc/rfc9060){.eref}

Category:
:   Standards Track

Published:
:   September 2021

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    J. Peterson
    :::

    ::: org
    Neustar
    :::
    :::
:::

# RFC 9060 {#rfcnum}

# Secure Telephone Identity Revisited (STIR) Certificate Delegation {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The Secure Telephone Identity Revisited (STIR) certificate profile
provides a way to attest authority over telephone numbers and related
identifiers for the purpose of preventing telephone number spoofing.
This specification details how that authority can be delegated from a
parent certificate to a subordinate certificate. This supports a number
of use cases, including those where service providers grant credentials
to enterprises or other customers capable of signing calls with
STIR.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9060>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Motivation](#name-motivation){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Delegation of STIR
    Certificates](#name-delegation-of-stir-certific){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Scope of
        Delegation](#name-scope-of-delegation){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Authentication Service Signing with
    Delegate Certificates](#name-authentication-service-sign){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Verification Service Behavior for Delegate
    Certificate Signatures](#name-verification-service-behavi){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Acquiring Multiple Certificates in
    STIR](#name-acquiring-multiple-certific){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Certification Authorities and Service
    Providers](#name-certification-authorities-a){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [ACME and
        Delegation](#name-acme-and-delegation){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Handling Multiple
        Certificates](#name-handling-multiple-certifica){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Alternative
    Solutions](#name-alternative-solutions){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [Privacy
    Considerations](#name-privacy-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [13](#section-13){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.13.2.1}
        [13.1](#section-13.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.13.2.2}
        [13.2](#section-13.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.14}
    [](#appendix-A){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [](#appendix-B){.xref}[Author\'s
    Address](#name-authors-address){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The [STIR problem statement](#RFC7340){.xref}
\[[RFC7340](#RFC7340){.xref}\] reviews the difficulties facing the
telephone network that are enabled by impersonation, including various
forms of robocalling, voicemail hacking, and swatting
\[[RFC7375](#RFC7375){.xref}\]. One of the most important components of
a system to prevent impersonation is the implementation of credentials
that identify the parties who control telephone numbers. The STIR
certificate specification \[[RFC8226](#RFC8226){.xref}\] describes a
credential system based on version 3 certificates
\[[X.509](#X.509){.xref}\] in accordance with
\[[RFC5280](#RFC5280){.xref}\] for that purpose. Those credentials can
then be used by STIR authentication services
\[[RFC8224](#RFC8224){.xref}\] to sign PASSporT objects
\[[RFC8225](#RFC8225){.xref}\] carried in SIP
\[[RFC3261](#RFC3261){.xref}\] requests.[¶](#section-1-1){.pilcrow}

\[[RFC8226](#RFC8226){.xref}\] specifies an extension to X.509 that
defines a Telephony Number (TN) Authorization List that may be included
by certification authorities (CAs) in certificates. This extension
provides additional information that relying parties can use when
validating transactions with the certificate. When a SIP request, for
example, arrives at a terminating administrative domain, the calling
number attested by the SIP request can be compared to the TN
Authorization List of the certificate that signed the PASSporT to
determine if the caller is authorized to use that calling
number.[¶](#section-1-2){.pilcrow}

Initial deployment of \[[RFC8226](#RFC8226){.xref}\] has focused on the
use of Service Provider Codes (SPCs) to attest to the scope of authority
of a certificate. Typically, these codes are internal telephone network
identifiers such as the Operating Company Numbers (OCNs) assigned to
carriers in the United States. However, these network identifiers are
effectively unavailable to non-carrier entities, and this has raised
questions about how such entities might best participate in STIR when
needed. Additionally, a carrier may sometimes operate numbers that are
formally assigned to another carrier. \[[RFC8226](#RFC8226){.xref}\]
gives an overview of a certificate enrollment model based on
\"delegation\", whereby the holder of a certificate might allocate a
subset of that certificate\'s authority to another party. This
specification details how delegation of authority works for STIR
certificates.[¶](#section-1-3){.pilcrow}
:::

::: {#sec-2}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

This specification also uses the following
terms:[¶](#section-2-2){.pilcrow}

[]{.break}

delegation:
:   The concept of STIR certificate delegation and its terms are defined
    in \[[RFC8226](#RFC8226){.xref}\].[¶](#section-2-3.2){.pilcrow}
:   

legitimate spoofing:
:   The practice of selecting an alternative presentation number for a
    telephone caller legitimately.[¶](#section-2-3.4){.pilcrow}
:   
:::
:::

::: {#motive}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Motivation](#name-motivation){.section-name .selfRef} {#name-motivation}

The most pressing need for delegation in STIR arises in a set of use
cases where callers want to use a particular calling number, but for
whatever reason, their outbound calls will not pass through the
authentication service of the service provider that controls that
numbering resource.[¶](#section-3-1){.pilcrow}

One example would be an enterprise that places outbound calls through a
set of service providers; for each call, a provider is chosen based on a
least-cost routing algorithm or similar local policy. The enterprise was
assigned a calling number by a particular service provider, but some
calls originating from that number will go out through other service
providers.[¶](#section-3-2){.pilcrow}

A user might also roam from their usual service provider to a different
network or administrative domain for various reasons. Most \"legitimate
spoofing\" examples are of this form, where a user wants to be able to
use the main callback number for their business as a calling party
number, even when the user is away from the
business.[¶](#section-3-3){.pilcrow}

These sorts of use cases could be addressed if the carrier who controls
the numbering resource were able to delegate a credential that could be
used to sign calls regardless of which network or administrative domain
handles the outbound routing for the call. In the absence of something
like a delegation mechanism, outbound carriers may be forced to sign
calls with credentials that do not cover the originating number in
question. Unfortunately, that practice would be difficult to distinguish
from malicious spoofing, and if it becomes widespread, it could erode
trust in STIR overall.[¶](#section-3-4){.pilcrow}
:::
:::

::: {#deleg}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Delegation of STIR Certificates](#name-delegation-of-stir-certific){.section-name .selfRef} {#name-delegation-of-stir-certific}

STIR delegate certificates are certificates containing a TNAuthList
object that have been signed with the private key of a parent
certificate that itself contains a TNAuthList object (either by value or
by reference; see [Section 4.1](#scope){.xref}). The parent certificate
needs to contain a basic constraints extension with the cA boolean set
to \"true\" \[[RFC5280](#RFC5280){.xref}\], indicating that the subject
can sign certificates. Every STIR delegate certificate identifies its
parent certificate with a standard Authority Key Identifier extension
\[[RFC5280](#RFC5280){.xref}\].[¶](#section-4-1){.pilcrow}

The authority bestowed on the holder of the delegate certificate by the
parent certificate is recorded in the delegate certificate\'s
TNAuthList. Because STIR certificates use the TNAuthList object rather
than the Subject Name for indicating the scope of their authority,
traditional name constraints \[[RFC5280](#RFC5280){.xref}\] are not
directly applicable to STIR. In a manner similar to the [Resource Public
Key Infrastructure (RPKI)](#RFC6480){.xref}
\[[RFC6480](#RFC6480){.xref}\] \"encompassing\" semantics, each delegate
certificate [MUST]{.bcp14} have a TNAuthList scope that is equal to or a
subset of its parent certificate\'s scope: it must be \"encompassed\".
For example, a parent certificate with a TNAuthList that attested
authority for the numbering range +1-212-555-1000 through 1999 could
issue a certificate to one delegate attesting authority for the range
+1-212-555-1500 through 1599 and, to another delegate, a certificate for
the individual number +1-212-555-1824.[¶](#section-4-2){.pilcrow}

Delegate certificates [MAY]{.bcp14} also contain a basic constraints
extension with the cA boolean set to \"true\", indicating that they can
sign subordinate certificates for further delegates. As only end-entity
certificates can actually sign PASSporTs, the holder of a STIR
certificate with a \"true\" cA boolean may create a separate end-entity
certificate with either an identical TNAuthList to its parent or a
subset of the parent\'s authority, which would be used to sign
PASSporTs.[¶](#section-4-3){.pilcrow}

::: {#scope}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Scope of Delegation](#name-scope-of-delegation){.section-name .selfRef} {#name-scope-of-delegation}

The TNAuthList of a STIR certificate may contain one or more SPCs, one
or more telephone number ranges, or even a mix of SPCs and telephone
number ranges. When delegating from a STIR certificate, a child
certificate may inherit from its parent either or both of the above, and
this specification explicitly permits SPC-only parent certificates to
delegate individual telephone numbers or ranges to a child certificate,
as this will be necessary in some operating environments. Depending on
the sort of numbering resources that a delegate has been assigned,
various syntaxes can be used to capture the delegated
resource.[¶](#section-4.1-1){.pilcrow}

Some non-carrier entities may be assigned large and complex allocations
of telephone numbers, which may be only partially contiguous or entirely
disparate. Allocations may also change frequently in minor or
significant ways. These resources may be so complex, dynamic, or
extensive that listing them in a certificate is prohibitively difficult.
[Section
10.1](https://www.rfc-editor.org/rfc/rfc8226#section-10.1){.relref} of
\[[RFC8226](#RFC8226){.xref}\] describes one potential way to address
this: including the TNAuthList (specified in
\[[RFC8226](#RFC8226){.xref}\]) in the certificate by reference rather
than by value, where a URL in the certificate points to a secure,
dynamically updated list of the telephone numbers in the scope of
authority of a certificate. For entities that are carriers in all but
name, another alternative is the allocation of an SPC; this yields much
the same property, as the SPC is effectively a pointer to an external
database that dynamically tracks the numbers associated with the SPC.
Either of these approaches may make sense for a given deployment.
Certification path construction as detailed below treats by-reference
TNAuthLists in a certificate as if they had been included by
value.[¶](#section-4.1-2){.pilcrow}

Other non-carrier entities may have straightforward telephone number
assignments, such as enterprises receiving a set of a thousand blocks
from a carrier that may be kept for years or decades. Particular
freephone numbers may also have a long-term association with an
enterprise and its brand. For these sorts of assignments, assigning an
SPC may seem like overkill, and using the TN ranges of the TNAuthList
(by value) is sufficient.[¶](#section-4.1-3){.pilcrow}

Whichever approach is taken to represent the delegated resource, there
are fundamental trade-offs regarding when and where in the architecture
a delegation is validated \-- that is, when the delegated TNAuthList is
checked and determined to be \"encompassed\" by the TNAuthList of its
parent. This might be performed at the time the delegate certificate is
issued, at the time that a verification service receives an inbound
call, or potentially both. It is generally desirable to offload as much
of this as possible to the certification process as verification occurs
during call setup; thus, additional network dips could lead to
perceptible delay, whereas certification happens outside of call
processing as a largely administrative function. Ideally, if a delegate
certificate can supply a by-value TN range, then a verification service
could ascertain that an attested calling party number is within the
scope of the provided certificate without requiring any additional
transactions with a service. In practice, verification services may
already incorporate network queries into their processing (for example,
to dereference the \"x5u\" field of a PASSporT) that could piggyback any
additional information needed by the verification
service.[¶](#section-4.1-4){.pilcrow}

Note that the permission semantics of the TNAuthList
\[[RFC8226](#RFC8226){.xref}\] are additive: that is, the scope of a
certificate is the superset of all of the SPCs and telephone number
ranges enumerated in the TNAuthList. As SPCs themselves are effectively
pointers to a set of telephone number ranges, and a telephone number may
belong to more than one SPC, this may introduce some redundancy to the
set of telephone numbers specified as the scope of a certificate. The
presence of one or more SPCs and one or more sets of telephone number
ranges are similarly treated additively, even if the telephone number
ranges turn out to be redundant to the scope of an
SPC.[¶](#section-4.1-5){.pilcrow}
:::
:::
:::
:::

::: {#as}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Authentication Service Signing with Delegate Certificates](#name-authentication-service-sign){.section-name .selfRef} {#name-authentication-service-sign}

Authentication service behavior varies from
\[[RFC8224](#RFC8224){.xref}\] as follows, although the same checks are
performed by the authentication service when comparing the calling party
number attested in call signaling with the scope of the authority of the
signing certificate. Authentication services [SHOULD NOT]{.bcp14} use a
delegate certificate without validating that its scope of authority is
encompassed by that of its parent certificate, and if that certificate
has its own parent, the entire certification path [SHOULD]{.bcp14} be
validated.[¶](#section-5-1){.pilcrow}

This delegation architecture does not require that a non-carrier entity
act as its own authentication service. That function may be performed by
any authentication service that holds the private key corresponding to
the delegate certificate, including one run by an outbound service
provider, a third party in an enterprise\'s outbound call path, or in
the SIP User Agent itself.[¶](#section-5-2){.pilcrow}

Note that authentication services creating a PASSporT for a call signed
with a delegate certificate [MUST]{.bcp14} provide an \"x5u\" link
corresponding to the entire certification path rather than just the
delegate certificate used to sign the call, as described in [Section
7](#chain){.xref}.[¶](#section-5-3){.pilcrow}
:::
:::

::: {#vs}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Verification Service Behavior for Delegate Certificate Signatures](#name-verification-service-behavi){.section-name .selfRef} {#name-verification-service-behavi}

The responsibility of a verification service validating PASSporTs signed
with delegate certificates, while largely following baseline
specifications \[[RFC8224](#RFC8224){.xref}\] and
\[[RFC8225](#RFC8225){.xref}\], requires some additional procedures.
When the verification service dereferences the \"x5u\" parameter, it
will acquire a certificate list rather than a single certificate. It
[MUST]{.bcp14} then validate all of the credentials in the list,
identifying the parent certificate for each delegate through its
Authority Key Identifier extension.[¶](#section-6-1){.pilcrow}

While relying parties ordinarily have significant latitude in
certification path construction when validating a certification path,
STIR assumes a more rigid hierarchical subordination model rather than
one where relying parties may want to derive their own certification
path to particular trust anchors. If the certificates acquired from the
\"x5u\" element of a PASSporT do not lead to an anchor that the
verification service trusts, it treats the validation no differently
than it would when a non-delegated certificate was issued by an
untrusted root; in SIP, it [MAY]{.bcp14} return a 437 \"Unsupported
Credential\" response if the call should be failed for lack of a valid
Identity header.[¶](#section-6-2){.pilcrow}
:::
:::

::: {#chain}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Acquiring Multiple Certificates in STIR](#name-acquiring-multiple-certific){.section-name .selfRef} {#name-acquiring-multiple-certific}

[PASSporT](#RFC8225){.xref} \[[RFC8225](#RFC8225){.xref}\] uses the
\"x5u\" element to convey the URL where verification services can
acquire the certificate used to sign a PASSporT. This value is mirrored
by the \"info\" parameter of the Identity header when a PASSporT is
conveyed via SIP. Commonly, this is an HTTPS
URI.[¶](#section-7-1){.pilcrow}

When a STIR delegate certificate is used to sign a PASSporT, the \"x5u\"
element in the PASSporT will contain a URI indicating where a
certificate list is available. While the baseline JSON Web Signature
(JWS) also supports an \"x5c\" element specifically for certificate
chains, in operational practice, certification paths are already being
delivered in the STIR environment via the \"x5u\" element, so this
specification RECOMMENDS that implementations continue to use \"x5u\".
\"x5c\" is [OPTIONAL]{.bcp14} for environments where it is known to be
supported. That list will be a concatenation of certificates encoded
with Privacy Enhanced Mail (PEM) of the type
\"application/pem-certificate-chain\" defined in
\[[RFC8555](#RFC8555){.xref}\]. The [certificate path](#RFC5280){.xref}
\[[RFC5280](#RFC5280){.xref}\] ordering [MUST]{.bcp14} be ordered from
the signer to the trust anchor. The list begins with the certificate
used to sign the PASSporT, followed by its parent, and then any
subsequent grandparents, great-grandparents, and so on. The key
identifier in the Authority Key Identifier extension in the first
certificate [MUST]{.bcp14} appear in the Subject Key Identifier
extension in the second certificate. The key identifier pairing
[MUST]{.bcp14} match in this way throughout the entire chain of
certificates. Note that [Automatic Certificate Management Environment
(ACME)](#RFC8555){.xref} \[[RFC8555](#RFC8555){.xref}\] requires the
first element in a pem-certificate-chain to be an end-entity
certificate.[¶](#section-7-2){.pilcrow}
:::
:::

::: {#sp}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Certification Authorities and Service Providers](#name-certification-authorities-a){.section-name .selfRef} {#name-certification-authorities-a}

Once a telephone service provider has received a CA certificate
attesting to their numbering resources, they may delegate resources from
it as they see fit. Note that the allocation to a service provider of a
certificate with a basic constraints extension with the cA boolean set
to \"true\" does not require that a service provider act as a
certification authority itself; serving as a certification authority is
a function requiring specialized expertise and infrastructure.
Certification authorities are, for example, responsible for maintaining
certificate revocation lists and related functions as well as publishing
certification practice statements. A third-party certification
authority, including the same one that issued the service provider its
parent certificate, could act as the CA that issues delegate
certificates for the service provider if the necessary business
relationships permit it. A service provider might in this case act as a
Token Authority (see [Section 8.1](#acme){.xref}) granting its customers
permissions to receive certificates from the
CA.[¶](#section-8-1){.pilcrow}

Note that if the same CA that issued the parent certificate is also
issuing a delegate certificate, it may be possible to shorten the
certification path, which reduces the work required of verification
services. The trade-off here is that if the CA simply issued a
non-delegate certificate (whose parent is the CA\'s trust anchor) with
the proper TNAuthList value, relying parties might not be able to
ascertain which service provider owned those telephone numbers,
information that might be used to make an authorization decision on the
terminating side. However, some additional object in the certificate
outside of the TNAuthList could preserve that information; this is a
potential area for future work, and longer certification paths are the
only mechanism currently defined.[¶](#section-8-2){.pilcrow}

All CAs must detail in their practices and policies a requirement to
validate that the \"encompassing\" of a delegate certificate is done by
its parent. Note that this requires that CAs have access to the
necessary industry databases to ascertain whether, for example, a
particular telephone number is encompassed by an SPC. Alternatively, a
CA may acquire an Authority Token (see [Section 8.1](#acme){.xref}) that
affirms that a delegation is in the proper scope. Exactly what
operational practices this entails may vary in different national
telephone administrations and are thus left to the [Certificate Policy /
Certification Practice Statement (CP/CPS)](#RFC3647){.xref}
\[[RFC3647](#RFC3647){.xref}\].[¶](#section-8-3){.pilcrow}

::: {#acme}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [ACME and Delegation](#name-acme-and-delegation){.section-name .selfRef} {#name-acme-and-delegation}

STIR deployments commonly use [ACME](#RFC8555){.xref}
\[[RFC8555](#RFC8555){.xref}\] for certificate acquisition, and it is
anticipated that delegate certificates will also be acquired through an
ACME interface. An entity can acquire a certificate from a particular CA
by requesting an [Authority
Token](#I-D.ietf-acme-authority-token){.xref}
\[[ACME-CHAL](#I-D.ietf-acme-authority-token){.xref}\] from the parent
with the desired
[TNAuthList](#I-D.ietf-acme-authority-token-tnauthlist){.xref}
\[[ACME-TOKEN](#I-D.ietf-acme-authority-token-tnauthlist){.xref}\]
object. Note that if the client intends to do further subdelegation of
its own, it should request a token with the \"ca\" Authority Token flag
set.[¶](#section-8.1-1){.pilcrow}

The entity then presents that Authority Token to a CA to acquire a STIR
delegate certificate. ACME returns an
\"application/pem-certificate-chain\" object, and that object would be
suitable for publication as an HTTPS resource for retrieval with the
PASSporT \"x5u\" mechanism as discussed in [Section 7](#chain){.xref}.
If the Certificate Signing Request (CSR) presented to the ACME server is
for a certificate with the cA boolean set to \"true\", then the ACME
server makes a policy decision to determine whether or not it is
appropriate to issue that certificate to the requesting entity. That
policy decision will be reflected by the \"ca\" flag in the Authority
Token.[¶](#section-8.1-2){.pilcrow}

Service providers that want the capability to rapidly age out delegated
certificates can rely on the ACME Short-Term, Automatically Renewed
(STAR) \[[RFC8739](#RFC8739){.xref}\] mechanism to automate the process
of short-term certificate expiry.[¶](#section-8.1-3){.pilcrow}
:::
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Handling Multiple Certificates](#name-handling-multiple-certifica){.section-name .selfRef} {#name-handling-multiple-certifica}

In some deployments, non-carrier entities may receive telephone numbers
from several different carriers. This could lead to enterprises needing
to maintain a sort of STIR keyring, with different certificates
delegated to them from different providers. These certificates are
potentially issued by different CAs, which enterprises choose between
when signing a call. This could be the case regardless of which syntax
is used in the TNAuthList to represent the scope of the delegation (see
[Section 4.1](#scope){.xref}). As noted in [Section 8](#sp){.xref}, if
the parent certs use the same CA, it may be possible to shorten the
certification path.[¶](#section-8.2-1){.pilcrow}

For non-carrier entities handling a small number of certificates, this
is probably not a significant burden. For cases where it becomes
burdensome, a few potential approaches exist. A delegate certificate
could be cross-certified with another delegate certificate via an
Authority Information Access (AIA) field containing the URL of a
Certificate Authority Issuer so that a signer would only need to sign
with a single certificate to inherit the privileges of the other
certificate(s) with which it has cross-certified. In very complex
delegation cases, it might make more sense to establish a bridge CA that
cross-certifies with all of the certificates held by the enterprise
rather than requiring a mesh of cross-certification between a large
number of certificates. Again, this bridge CA function would likely be
performed by some existing CA in the STIR ecosystem. These procedures
would, however, complicate the fairly straightforward certification path
reconstruction approach described in [Section 7](#chain){.xref} and
would require further specification.[¶](#section-8.2-2){.pilcrow}
:::
:::
:::

::: {#alt}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Alternative Solutions](#name-alternative-solutions){.section-name .selfRef} {#name-alternative-solutions}

At the time this specification was written, STIR was only starting to
see deployment. In some future environment, the policies that govern CAs
may not permit them to issue intermediate certificates with a TNAuthList
object and a cA boolean set to \"true\" in the basic constraints
certificate extension \[[RFC5280](#RFC5280){.xref}\]. Similar problems
in the web PKI space motivated the development of TLS subcerts
\[[TLS-CRED](#I-D.ietf-tls-subcerts){.xref}\], which substitutes a
signed \"delegated credential\" token for a certificate for such
environments. A comparable mechanism could be developed for the STIR
space, which would allow STIR certificates to sign a data object that
contains effectively the same data as the delegate certificate specified
here, including a public key that could sign PASSporTs. The TLS subcerts
system has further explored leveraging ACME to issue short-lived
certificates for temporary delegation as a means of obviating the need
for revocation. Specification of a mechanism similar to TLS subcerts for
STIR is future work and will be undertaken only if the market requires
it.[¶](#section-9-1){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-10-1){.pilcrow}
:::
:::

::: {#priv}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [Privacy Considerations](#name-privacy-considerations){.section-name .selfRef} {#name-privacy-considerations}

Any STIR certificate that identifies a narrow range of telephone numbers
potentially exposes information about the entities that are placing
calls. As such a telephone number range is a necessary superset of the
calling party number that is openly signaled during call setup, the
privacy risks associated with this mechanism are not substantially
greater than baseline STIR. See \[[RFC8224](#RFC8224){.xref}\] for
guidance on the use of anonymization mechanisms in
STIR.[¶](#section-11-1){.pilcrow}
:::
:::

::: {#Security}
::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document is entirely about security. As delegation can allow
signing-in scenarios where unauthenticated \"legitimate\" spoofing would
otherwise be used, the hope is that delegation will improve the overall
security of the STIR ecosystem. For further information on certificate
security and practices, see \[[RFC5280](#RFC5280){.xref}\], particularly
its security considerations. Also see the security considerations of
\[[RFC8226](#RFC8226){.xref}\] for general guidance on the implications
of the use of certificates in STIR and \[[RFC7375](#RFC7375){.xref}\]
for the STIR threat model.[¶](#section-12-1){.pilcrow}

Much of the security of delegation depends on the implementation of the
encompassing semantics described in [Section 4](#deleg){.xref}. When
delegating from an SPC-based TNAuthList to a set of telephone number
ranges, understanding the encompassing semantics may require access to
industry databases that track the numbering assets of service providers
associated with a given SPC. In some operating environments, such
databases might not exist. How encompassing is policed is therefore a
matter outside the scope of this document and specific to operational
profiles of STIR.[¶](#section-12-2){.pilcrow}

The use of by-reference TNAuthLists as described in [Section
4](#deleg){.xref} means that the TNAuthList associated with a
certificate can change over time; see the security considerations of
\[[RFC3986](#RFC3986){.xref}\] for more on the implications of this
property. It is considered a useful feature here due to the potential
dynamism of large lists of telephone numbers, but this dynamism means
that a relying party might at one point accept that a particular
telephone number is associated with a certificate but later reject it
for the same certificate as the dynamic list changes. Also note that if
the HTTPS service housing the by-reference telephone number list is
improperly secured, that too can lead to vulnerabilities. Ultimately,
the CA that issued a delegated certificate populates the URL in the AIA
field and is responsible for making a secure selection. Service
providers acting as CAs are directed to the cautionary words about
running a CA in [Section 8](#sp){.xref} regarding the obligations this
entails for certificate revocation and so
on.[¶](#section-12-3){.pilcrow}
:::
:::

::: {#section-13 .section}
## [13.](#section-13){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-13.1 .section}
### [13.1.](#section-13.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3986\]
:   [Berners-Lee, T.]{.refAuthor}, [Fielding, R.]{.refAuthor}, and [L.
    Masinter]{.refAuthor}, [\"Uniform Resource Identifier (URI): Generic
    Syntax\"]{.refTitle}, [STD 66]{.seriesInfo}, [RFC
    3986]{.seriesInfo}, [DOI 10.17487/RFC3986]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3986>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}, [Santesson, S.]{.refAuthor},
    [Farrell, S.]{.refAuthor}, [Boeyen, S.]{.refAuthor},
    [Housley, R.]{.refAuthor}, and [W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8224\]
:   [Peterson, J.]{.refAuthor}, [Jennings, C.]{.refAuthor},
    [Rescorla, E.]{.refAuthor}, and [C. Wendt]{.refAuthor},
    [\"Authenticated Identity Management in the Session Initiation
    Protocol (SIP)\"]{.refTitle}, [RFC 8224]{.seriesInfo}, [DOI
    10.17487/RFC8224]{.seriesInfo}, February 2018,
    \<<https://www.rfc-editor.org/info/rfc8224>\>.
:   

\[RFC8225\]
:   [Wendt, C.]{.refAuthor} and [J. Peterson]{.refAuthor}, [\"PASSporT:
    Personal Assertion Token\"]{.refTitle}, [RFC 8225]{.seriesInfo},
    [DOI 10.17487/RFC8225]{.seriesInfo}, February 2018,
    \<<https://www.rfc-editor.org/info/rfc8225>\>.
:   

\[RFC8226\]
:   [Peterson, J.]{.refAuthor} and [S. Turner]{.refAuthor}, [\"Secure
    Telephone Identity Credentials: Certificates\"]{.refTitle}, [RFC
    8226]{.seriesInfo}, [DOI 10.17487/RFC8226]{.seriesInfo}, February
    2018, \<<https://www.rfc-editor.org/info/rfc8226>\>.
:   

\[RFC8555\]
:   [Barnes, R.]{.refAuthor}, [Hoffman-Andrews, J.]{.refAuthor},
    [McCarney, D.]{.refAuthor}, and [J. Kasten]{.refAuthor},
    [\"Automatic Certificate Management Environment
    (ACME)\"]{.refTitle}, [RFC 8555]{.seriesInfo}, [DOI
    10.17487/RFC8555]{.seriesInfo}, March 2019,
    \<<https://www.rfc-editor.org/info/rfc8555>\>.
:   
:::

::: {#section-13.2 .section}
### [13.2.](#section-13.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ACME-CHAL\]
:   [Peterson, J.]{.refAuthor}, [Barnes, M.]{.refAuthor},
    [Hancock, D.]{.refAuthor}, and [C. Wendt]{.refAuthor}, [\"ACME
    Challenges Using an Authority Token\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-acme-authority-token-06]{.seriesInfo}, 12 July 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-acme-authority-token-06>\>.
:   

\[ACME-TOKEN\]
:   [Wendt, C.]{.refAuthor}, [Hancock, D.]{.refAuthor},
    [Barnes, M.]{.refAuthor}, and [J. Peterson]{.refAuthor},
    [\"TNAuthList profile of ACME Authority Token\"]{.refTitle}, [Work
    in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-acme-authority-token-tnauthlist-08]{.seriesInfo}, 27
    March 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-acme-authority-token-tnauthlist-08>\>.
:   

\[RFC3261\]
:   [Rosenberg, J.]{.refAuthor}, [Schulzrinne, H.]{.refAuthor},
    [Camarillo, G.]{.refAuthor}, [Johnston, A.]{.refAuthor},
    [Peterson, J.]{.refAuthor}, [Sparks, R.]{.refAuthor},
    [Handley, M.]{.refAuthor}, and [E. Schooler]{.refAuthor}, [\"SIP:
    Session Initiation Protocol\"]{.refTitle}, [RFC 3261]{.seriesInfo},
    [DOI 10.17487/RFC3261]{.seriesInfo}, June 2002,
    \<<https://www.rfc-editor.org/info/rfc3261>\>.
:   

\[RFC3647\]
:   [Chokhani, S.]{.refAuthor}, [Ford, W.]{.refAuthor},
    [Sabett, R.]{.refAuthor}, [Merrill, C.]{.refAuthor}, and [S.
    Wu]{.refAuthor}, [\"Internet X.509 Public Key Infrastructure
    Certificate Policy and Certification Practices
    Framework\"]{.refTitle}, [RFC 3647]{.seriesInfo}, [DOI
    10.17487/RFC3647]{.seriesInfo}, November 2003,
    \<<https://www.rfc-editor.org/info/rfc3647>\>.
:   

\[RFC6480\]
:   [Lepinski, M.]{.refAuthor} and [S. Kent]{.refAuthor}, [\"An
    Infrastructure to Support Secure Internet Routing\"]{.refTitle},
    [RFC 6480]{.seriesInfo}, [DOI 10.17487/RFC6480]{.seriesInfo},
    February 2012, \<<https://www.rfc-editor.org/info/rfc6480>\>.
:   

\[RFC7340\]
:   [Peterson, J.]{.refAuthor}, [Schulzrinne, H.]{.refAuthor}, and [H.
    Tschofenig]{.refAuthor}, [\"Secure Telephone Identity Problem
    Statement and Requirements\"]{.refTitle}, [RFC 7340]{.seriesInfo},
    [DOI 10.17487/RFC7340]{.seriesInfo}, September 2014,
    \<<https://www.rfc-editor.org/info/rfc7340>\>.
:   

\[RFC7375\]
:   [Peterson, J.]{.refAuthor}, [\"Secure Telephone Identity Threat
    Model\"]{.refTitle}, [RFC 7375]{.seriesInfo}, [DOI
    10.17487/RFC7375]{.seriesInfo}, October 2014,
    \<<https://www.rfc-editor.org/info/rfc7375>\>.
:   

\[RFC8739\]
:   [Sheffer, Y.]{.refAuthor}, [Lopez, D.]{.refAuthor}, [Gonzalez de
    Dios, O.]{.refAuthor}, [Pastor Perales, A.]{.refAuthor}, and [T.
    Fossati]{.refAuthor}, [\"Support for Short-Term, Automatically
    Renewed (STAR) Certificates in the Automated Certificate Management
    Environment (ACME)\"]{.refTitle}, [RFC 8739]{.seriesInfo}, [DOI
    10.17487/RFC8739]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8739>\>.
:   

\[TLS-CRED\]
:   [Barnes, R.]{.refAuthor}, [Iyengar, S.]{.refAuthor},
    [Sullivan, N.]{.refAuthor}, and [E. Rescorla]{.refAuthor},
    [\"Delegated Credentials for TLS\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-tls-subcerts-10]{.seriesInfo}, 24 January 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-tls-subcerts-10>\>.
:   

\[X.509\]
:   [ITU-T]{.refAuthor}, [\"Information technology - Open Systems
    Interconnection - The Directory: Public-key and attribute
    certificate frameworks\"]{.refTitle}, [ITU-T Recommendation
    X.509]{.seriesInfo}, October 2016,
    \<<https://www.itu.int/rec/T-REC-X.509>\>.
:   
:::
:::

::: {#Acknowledgments}
::: {#appendix-A .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

We would like to thank [Ines Robles]{.contact-name}, [Richard
Barnes]{.contact-name}, [Chris Wendt]{.contact-name}, [Dave
Hancock]{.contact-name}, [Russ Housley]{.contact-name}, [Benjamin
Kaduk]{.contact-name}, and [Sean Turner]{.contact-name} for key input on
this document.[¶](#appendix-A-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Jon Peterson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Neustar, Inc.]{.org}
:::

::: email
Email: <jon.peterson@team.neustar>
:::
:::
:::
