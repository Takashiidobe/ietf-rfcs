  RFC 8976          DNS Zone Digest   February 2021
  ----------------- ----------------- ---------------
  Wessels, et al.   Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8976](https://www.rfc-editor.org/rfc/rfc8976){.eref}

Category:
:   Standards Track

Published:
:   February 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    D. Wessels
    :::

    ::: org
    Verisign
    :::
    :::

    ::: author
    ::: author-name
    P. Barber
    :::

    ::: org
    Verisign
    :::
    :::

    ::: author
    ::: author-name
    M. Weinberg
    :::

    ::: org
    Amazon
    :::
    :::

    ::: author
    ::: author-name
    W. Kumari
    :::

    ::: org
    Google
    :::
    :::

    ::: author
    ::: author-name
    W. Hardaker
    :::

    ::: org
    USC/ISI
    :::
    :::
:::

# RFC 8976 {#rfcnum}

# Message Digest for DNS Zones {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes a protocol and new DNS Resource Record that
provides a cryptographic message digest over DNS zone data at rest. The
ZONEMD Resource Record conveys the digest data in the zone itself. When
used in combination with DNSSEC, ZONEMD allows recipients to verify the
zone contents for data integrity and origin authenticity. This provides
assurance that received zone data matches published data, regardless of
how the zone data has been transmitted and received. When used without
DNSSEC, ZONEMD functions as a checksum, guarding only against
unintentional changes.[¶](#section-abstract-1){.pilcrow}

ZONEMD does not replace DNSSEC: DNSSEC protects individual RRsets (DNS
data with fine granularity), whereas ZONEMD protects a zone\'s data as a
whole, whether consumed by authoritative name servers, recursive name
servers, or any other applications.[¶](#section-abstract-2){.pilcrow}

As specified herein, ZONEMD is impractical for large, dynamic zones due
to the time and resources required for digest calculation. However, the
ZONEMD record is extensible so that new digest schemes may be added in
the future to support large, dynamic
zones.[¶](#section-abstract-3){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8976>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Motivation](#name-motivation){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Alternative
        Approaches](#name-alternative-approaches){.xref}[¶](#section-toc.1-1.1.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.3}
        [1.3](#section-1.3){.xref}.  [Design
        Overview](#name-design-overview){.xref}[¶](#section-toc.1-1.1.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.4}
        [1.4](#section-1.4){.xref}.  [Use
        Cases](#name-use-cases){.xref}[¶](#section-toc.1-1.1.2.4.1){.pilcrow}

        -   ::: {#section-toc.1-1.1.2.4.2.1}
            [1.4.1](#section-1.4.1){.xref}.  [Root
            Zone](#name-root-zone){.xref}[¶](#section-toc.1-1.1.2.4.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.1.2.4.2.2}
            [1.4.2](#section-1.4.2){.xref}.  [Providers, Secondaries,
            and
            Anycast](#name-providers-secondaries-and-a){.xref}[¶](#section-toc.1-1.1.2.4.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.1.2.4.2.3}
            [1.4.3](#section-1.4.3){.xref}.  [Response Policy
            Zones](#name-response-policy-zones){.xref}[¶](#section-toc.1-1.1.2.4.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.1.2.4.2.4}
            [1.4.4](#section-1.4.4){.xref}.  [Centralized Zone Data
            Service](#name-centralized-zone-data-servi){.xref}[¶](#section-toc.1-1.1.2.4.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.1.2.4.2.5}
            [1.4.5](#section-1.4.5){.xref}.  [General Purpose Comparison
            Check](#name-general-purpose-comparison-){.xref}[¶](#section-toc.1-1.1.2.4.2.5.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.1.2.5}
        [1.5](#section-1.5){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.1.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [The ZONEMD Resource
    Record](#name-the-zonemd-resource-record){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Non-apex ZONEMD
        Records](#name-non-apex-zonemd-records){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [ZONEMD RDATA Wire
        Format](#name-zonemd-rdata-wire-format){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.2.2.2.2.1}
            [2.2.1](#section-2.2.1){.xref}.  [The Serial
            Field](#name-the-serial-field){.xref}[¶](#section-toc.1-1.2.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.2.2.2.2.2}
            [2.2.2](#section-2.2.2){.xref}.  [The Scheme
            Field](#name-the-scheme-field){.xref}[¶](#section-toc.1-1.2.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.2.2.2.2.3}
            [2.2.3](#section-2.2.3){.xref}.  [The Hash Algorithm
            Field](#name-the-hash-algorithm-field){.xref}[¶](#section-toc.1-1.2.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.2.2.2.2.4}
            [2.2.4](#section-2.2.4){.xref}.  [The Digest
            Field](#name-the-digest-field){.xref}[¶](#section-toc.1-1.2.2.2.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [ZONEMD Presentation
        Format](#name-zonemd-presentation-format){.xref}[¶](#section-toc.1-1.2.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.4}
        [2.4](#section-2.4){.xref}.  [ZONEMD
        Example](#name-zonemd-example){.xref}[¶](#section-toc.1-1.2.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.5}
        [2.5](#section-2.5){.xref}.  [Including ZONEMD RRs in a
        Zone](#name-including-zonemd-rrs-in-a-z){.xref}[¶](#section-toc.1-1.2.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Calculating the
    Digest](#name-calculating-the-digest){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Add ZONEMD
        Placeholder](#name-add-zonemd-placeholder){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Optionally, Sign the
        Zone](#name-optionally-sign-the-zone){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Scheme-Specific
        Processing](#name-scheme-specific-processing){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [The SIMPLE
            Scheme](#name-the-simple-scheme){.xref}[¶](#section-toc.1-1.3.2.3.2.1.1){.pilcrow}

            -   ::: {#section-toc.1-1.3.2.3.2.1.2.1}
                [3.3.1.1](#section-3.3.1.1){.xref}.  [SIMPLE Scheme
                Inclusion/Exclusion
                Rules](#name-simple-scheme-inclusion-exc){.xref}[¶](#section-toc.1-1.3.2.3.2.1.2.1.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.3.2.3.2.1.2.2}
                [3.3.1.2](#section-3.3.1.2){.xref}.  [SIMPLE Scheme
                Digest
                Calculation](#name-simple-scheme-digest-calcul){.xref}[¶](#section-toc.1-1.3.2.3.2.1.2.2.1){.pilcrow}
                :::
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Update ZONEMD
        RR](#name-update-zonemd-rr){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Verifying Zone
    Digest](#name-verifying-zone-digest){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [ZONEMD
        RRtype](#name-zonemd-rrtype){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [ZONEMD
        Scheme](#name-zonemd-scheme){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [ZONEMD Hash
        Algorithms](#name-zonemd-hash-algorithms){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Using Zone Digest without
        DNSSEC](#name-using-zone-digest-without-d){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Attacks against the Zone
        Digest](#name-attacks-against-the-zone-di){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Use of Multiple ZONEMD Hash
        Algorithms](#name-use-of-multiple-zonemd-hash){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [DNSSEC Timing
        Considerations](#name-dnssec-timing-consideration){.xref}[¶](#section-toc.1-1.6.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [Attacks Utilizing ZONEMD
        Queries](#name-attacks-utilizing-zonemd-qu){.xref}[¶](#section-toc.1-1.6.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.6}
        [6.6](#section-6.6){.xref}.  [Resilience and
        Fragility](#name-resilience-and-fragility){.xref}[¶](#section-toc.1-1.6.2.6.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Performance
    Considerations](#name-performance-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [SIMPLE
        SHA384](#name-simple-sha384){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Privacy
    Considerations](#name-privacy-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix A](#section-appendix.a){.xref}.  [Example Zones with
    Digests](#name-example-zones-with-digests){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [A.1](#section-a.1){.xref}.  [Simple EXAMPLE
        Zone](#name-simple-example-zone){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [A.2](#section-a.2){.xref}.  [Complex EXAMPLE
        Zone](#name-complex-example-zone){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.3}
        [A.3](#section-a.3){.xref}.  [EXAMPLE Zone with Multiple
        Digests](#name-example-zone-with-multiple-){.xref}[¶](#section-toc.1-1.10.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.4}
        [A.4](#section-a.4){.xref}.  [The URI.ARPA
        Zone](#name-the-uriarpa-zone){.xref}[¶](#section-toc.1-1.10.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.5}
        [A.5](#section-a.5){.xref}.  [The ROOT-SERVERS.NET
        Zone](#name-the-root-serversnet-zone){.xref}[¶](#section-toc.1-1.10.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix B](#section-appendix.b){.xref}.  [Implementation
    Status](#name-implementation-status){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [B.1](#section-b.1){.xref}.  [Authors\'
        Implementation](#name-authors-implementation){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [B.2](#section-b.2){.xref}.  [Shane Kerr\'s
        Implementation](#name-shane-kerrs-implementation){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.3}
        [B.3](#section-b.3){.xref}.  [NIC Chile Lab\'s
        Implementation](#name-nic-chile-labs-implementati){.xref}[¶](#section-toc.1-1.11.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.c){.xref}[Acknowledgments](#name-acknowledgments){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.d){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

In the DNS, a zone is the collection of authoritative resource records
(RRs) sharing a common origin (\[[RFC8499](#RFC8499){.xref}\]). Zones
are often stored as files in the so-called \"master file format\"
(\[[RFC1034](#RFC1034){.xref}\]). Zones are generally distributed among
name servers using the zone transfer (AXFR)
(\[[RFC5936](#RFC5936){.xref}\]) and incremental zone transfer (IXFR)
(\[[RFC1995](#RFC1995){.xref}\]) protocols. They can also be distributed
outside of the DNS with any file transfer protocol such as FTP, HTTP,
and rsync, or even as email attachments. Currently, there is no standard
way to compute a hash or message digest for a stand-alone
zone.[¶](#section-1-1){.pilcrow}

This document specifies an RR type that provides a cryptographic message
digest of the data in a zone. It allows a receiver of the zone to verify
the zone\'s integrity and authenticity when used in combination with
DNSSEC. The digest RR is a part of the zone itself, allowing
verification of the zone, no matter how it is transmitted. The digest
uses the wire format of zone data in a canonical ordering. Thus, it is
independent of presentation format such as whitespace, capitalization,
and comments.[¶](#section-1-2){.pilcrow}

This specification is [OPTIONAL]{.bcp14} to implement by both publishers
and consumers of zone data.[¶](#section-1-3){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Motivation](#name-motivation){.section-name .selfRef} {#name-motivation}

The primary motivation for this protocol enhancement is the desire to
verify the data integrity and origin authenticity of a stand-alone zone,
regardless of how it is transmitted. A consumer of zone data should be
able to verify that it is as published by the zone
operator.[¶](#section-1.1-1){.pilcrow}

Note, however, that integrity and authenticity can only be assured when
the zone is signed. DNSSEC provides three strong security guarantees
relevant to this protocol:[¶](#section-1.1-2){.pilcrow}

1.  [whether or not to expect DNSSEC records in the
    zone,[¶](#section-1.1-3.1){.pilcrow}]{#section-1.1-3.1}
2.  [whether or not to expect a ZONEMD record in a signed zone,
    and[¶](#section-1.1-3.2){.pilcrow}]{#section-1.1-3.2}
3.  [whether or not the ZONEMD record has been altered since it was
    signed.[¶](#section-1.1-3.3){.pilcrow}]{#section-1.1-3.3}

A secondary motivation is to provide the equivalent of a checksum,
allowing a zone recipient to check for unintended changes and
operational errors such as accidental
truncation.[¶](#section-1.1-4){.pilcrow}
:::

::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Alternative Approaches](#name-alternative-approaches){.section-name .selfRef} {#name-alternative-approaches}

One approach to preventing data tampering and corruption is to secure
the distribution channel. The DNS has a number of features that are
already used for channel security. Perhaps the most widely used is DNS
transaction signatures (TSIGs) (\[[RFC8945](#RFC8945){.xref}\]). A TSIG
uses shared secret keys and a message digest to protect individual query
and response messages. It is generally used to authenticate and validate
UPDATE (\[[RFC2136](#RFC2136){.xref}\]), AXFR
(\[[RFC5936](#RFC5936){.xref}\]), and IXFR
(\[[RFC1995](#RFC1995){.xref}\]) messages.[¶](#section-1.2-1){.pilcrow}

DNS Request and Transaction Signatures (SIG(0))
(\[[RFC2931](#RFC2931){.xref}\]) is another protocol extension that
authenticates individual DNS transactions. Whereas SIG records normally
cover specific RR types, SIG(0) is used to sign an entire DNS message.
Unlike TSIG, SIG(0) uses public key cryptography rather than shared
secrets.[¶](#section-1.2-2){.pilcrow}

The Transport Layer Security protocol suite also provides channel
security. The DPRIVE Working Group is in the process of specifying DNS
Zone Transfer-over-TLS
(\[[DPRIVE-XFR-OVER-TLS](#I-D.ietf-dprive-xfr-over-tls){.xref}\]). One
can also easily imagine the distribution of zones over HTTPS-enabled web
servers as well as DNS-over-HTTPS
(\[[RFC8484](#RFC8484){.xref}\]).[¶](#section-1.2-3){.pilcrow}

Unfortunately, the protections provided by these channel security
techniques are (in practice) ephemeral and are not retained after the
data transfer is complete. They ensure that the client receives the data
from the expected server and that the data sent by the server is not
modified during transmission. However, they do not guarantee that the
server transmits the data as originally published and do not provide any
methods to verify data that is read after transmission is complete. For
example, a name server loading saved zone data upon restart cannot
guarantee that the on-disk data has not been modified. Such modification
could be the result of an accidental corruption of the file or perhaps
an incomplete saving of the file
(\[[DISK-FULL-FAILURE](#DISK-FULL-FAILURE){.xref}\]). For these reasons,
it is preferable to protect the integrity of the data
itself.[¶](#section-1.2-4){.pilcrow}

Why not simply rely on DNSSEC, which provides certain data security
guarantees? For zones that are signed, a recipient could validate all of
the signed RRsets. Additionally, denial-of-existence records prove that
RRsets have not been added or removed. However, delegations (non-apex NS
records) are not signed by DNSSEC and neither are any glue records.
ZONEMD protects the integrity of delegation, glue, and other records
that are not otherwise covered by DNSSEC. Furthermore, zones that employ
NSEC3 with Opt-Out (\[[RFC5155](#RFC5155){.xref}\]) are susceptible to
the removal or addition of names between the signed nodes. Whereas
DNSSEC primarily protects consumers of DNS response messages, this
protocol protects consumers of zones.[¶](#section-1.2-5){.pilcrow}

There are existing tools and protocols that provide data security, such
as OpenPGP (\[[RFC4880](#RFC4880){.xref}\]) and S/MIME
(\[[RFC8551](#RFC8551){.xref}\]). In fact, the internic.net site
publishes Pretty Good Privacy (PGP) signatures alongside the root zone
and other files available there. However, this is a detached signature
with no strong association to the corresponding zone file other than its
timestamp. Attached signatures are of course possible, but these
necessarily change the format of the file being distributed; a zone
signed with OpenPGP or S/MIME no longer looks like a DNS zone and could
not directly be loaded into a name server. Once loaded, the signature
data is lost, so it cannot be further
propagated.[¶](#section-1.2-6){.pilcrow}

It seems the desire for data security in DNS zones was envisioned as far
back as 1997. \[[RFC2065](#RFC2065){.xref}\] is an obsoleted
specification of the first generation DNSSEC Security Extensions. It
describes a zone transfer signature, identified as the AXFR SIG, which
is similar to the technique proposed by this document. That is, it
proposes ordering all (signed) RRsets in a zone, hashing their contents,
and then signing the zone hash. The AXFR SIG is described only for use
during zone transfers. It did not postulate the need to validate zone
data distributed outside of the DNS. Furthermore, its successor,
\[[RFC2535](#RFC2535){.xref}\], omits the AXFR SIG while at the same
time introducing an IXFR SIG. (Note: RFC 2535 was obsoleted by
\[[RFC4033](#RFC4033){.xref}\], \[[RFC4034](#RFC4034){.xref}\], and
\[[RFC4035](#RFC4035){.xref}\].)[¶](#section-1.2-7){.pilcrow}
:::

::: {#section-1.3 .section}
### [1.3.](#section-1.3){.section-number .selfRef} [Design Overview](#name-design-overview){.section-name .selfRef} {#name-design-overview}

This document specifies a new Resource Record type to convey a message
digest of the content of a zone. The digest is calculated at the time of
zone publication. If the zone is signed with DNSSEC, any modifications
of the digest can be detected. The procedures for digest calculation and
DNSSEC signing are similar. Both require data to be processed in a
well-defined order and format. It may be possible to perform DNSSEC
signing and digest calculation in parallel.[¶](#section-1.3-1){.pilcrow}

The zone digest is designed to be used on zones that have infrequent
updates. As specified herein, the digest is recalculated over the entire
zone content each time the zone is updated. This specification does not
provide an efficient mechanism for updating the digest on incremental
updates of zone data. It is, however, extensible so that future schemes
may be defined to support efficient incremental digest
updates.[¶](#section-1.3-2){.pilcrow}

It is expected that verification of a zone digest will be implemented in
name server software. That is, a name server can verify the zone data it
was given and refuse to serve a zone that fails verification. For signed
zones, the name server needs a trust anchor to perform DNSSEC
validation. For signed non-root zones, the name server may need to send
queries to validate a chain of trust. Digest verification could also be
performed externally.[¶](#section-1.3-3){.pilcrow}
:::

::: {#section-1.4 .section}
### [1.4.](#section-1.4){.section-number .selfRef} [Use Cases](#name-use-cases){.section-name .selfRef} {#name-use-cases}

::: {#section-1.4.1 .section}
#### [1.4.1.](#section-1.4.1){.section-number .selfRef} [Root Zone](#name-root-zone){.section-name .selfRef} {#name-root-zone}

The root zone (\[[InterNIC](#InterNIC){.xref}\]) is one of the most
widely distributed DNS zones on the Internet, served by more than 1000
separate instances (\[[ROOT-SERVERS](#ROOT-SERVERS){.xref}\]) at the
time of this writing. Additionally, many organizations configure their
own name servers to serve the root zone locally. Reasons for doing so
include privacy and reduced access time. \[[RFC8806](#RFC8806){.xref}\]
describes one way to do this. As the root zone spreads beyond its
traditional deployment boundaries, the verification of the completeness
of the zone contents becomes more
important.[¶](#section-1.4.1-1){.pilcrow}
:::

::: {#section-1.4.2 .section}
#### [1.4.2.](#section-1.4.2){.section-number .selfRef} [Providers, Secondaries, and Anycast](#name-providers-secondaries-and-a){.section-name .selfRef} {#name-providers-secondaries-and-a}

Since its very early days, the developers of the DNS recognized the
importance of secondary name servers and service diversity. However,
modern DNS service has complex provisioning that includes multiple
third-party providers (\[[RFC8901](#RFC8901){.xref}\]) and hundreds of
anycast instances (\[[RFC3258](#RFC3258){.xref}\]). Instead of a simple
primary-to-secondary zone distribution system, today it is possible to
have multiple levels, multiple parties, and multiple protocols involved
in the distribution of zone data. This complexity introduces new places
for problems to arise. The zone digest protects the integrity of data
that flows through such systems.[¶](#section-1.4.2-1){.pilcrow}
:::

::: {#section-1.4.3 .section}
#### [1.4.3.](#section-1.4.3){.section-number .selfRef} [Response Policy Zones](#name-response-policy-zones){.section-name .selfRef} {#name-response-policy-zones}

A Response Policy Zone (RPZ) is \"a mechanism to introduce a customized
policy in Domain Name System servers, so that recursive resolvers return
possibly modified results\" (\[[RPZ](#RPZ){.xref}\]). The policy
information is carried inside specially constructed DNS zones. A number
of companies provide RPZ feeds, which are consumed by name server and
firewall products. While RPZs can be signed with DNSSEC, the data is not
queried directly and would not be subject to DNSSEC
validation.[¶](#section-1.4.3-1){.pilcrow}
:::

::: {#section-1.4.4 .section}
#### [1.4.4.](#section-1.4.4){.section-number .selfRef} [Centralized Zone Data Service](#name-centralized-zone-data-servi){.section-name .selfRef} {#name-centralized-zone-data-servi}

ICANN operates the Centralized Zone Data Service
(\[[CZDS](#CZDS){.xref}\]), which is a repository of top-level domain
zone files. Users that have been granted access are then able to
download zone data. Adding a zone digest to these would provide CZDS
users with assurances that the data has not been modified between
origination and retrieval. Note that ZONEMD could be added to zone data
supplied to CZDS without requiring it to be present in the zone data
served by production name servers, since the digest is inherently
attached to the specific copy of the
zone.[¶](#section-1.4.4-1){.pilcrow}
:::

::: {#section-1.4.5 .section}
#### [1.4.5.](#section-1.4.5){.section-number .selfRef} [General Purpose Comparison Check](#name-general-purpose-comparison-){.section-name .selfRef} {#name-general-purpose-comparison-}

Since the zone digest calculation does not depend on presentation
format, it could be used to compare multiple copies of a zone received
from different sources, or copies generated by different processes. In
this case, it serves as a checksum and can be useful even for unsigned
zones.[¶](#section-1.4.5-1){.pilcrow}
:::
:::

::: {#section-1.5 .section}
### [1.5.](#section-1.5){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.5-1){.pilcrow}

The terms Private Use, Reserved, Unassigned, and Specification Required
are to be interpreted as defined in
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-1.5-2){.pilcrow}
:::
:::

::: {#rrtype}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [The ZONEMD Resource Record](#name-the-zonemd-resource-record){.section-name .selfRef} {#name-the-zonemd-resource-record}

This section describes the ZONEMD Resource Record, including its fields,
wire format, and presentation format. The Type value for the ZONEMD RR
is 63. The ZONEMD RR is class independent. The RDATA of the resource
record consists of four fields: Serial, Scheme, Hash Algorithm, and
Digest.[¶](#section-2-1){.pilcrow}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Non-apex ZONEMD Records](#name-non-apex-zonemd-records){.section-name .selfRef} {#name-non-apex-zonemd-records}

This document specifies ZONEMD RRs located at the zone apex. Non-apex
ZONEMD RRs are not forbidden, but have no meaning in this specification.
Non-apex ZONEMD RRs [MUST NOT]{.bcp14} be used for
verification.[¶](#section-2.1-1){.pilcrow}

During digest calculation, non-apex ZONEMD RRs are treated as ordinary
RRs. They are digested as is, and the RR is not replaced by a
placeholder RR.[¶](#section-2.1-2){.pilcrow}

Unless explicitly stated otherwise, \"ZONEMD\" always refers to apex
records throughout this document.[¶](#section-2.1-3){.pilcrow}
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [ZONEMD RDATA Wire Format](#name-zonemd-rdata-wire-format){.section-name .selfRef} {#name-zonemd-rdata-wire-format}

The ZONEMD RDATA wire format is encoded as
follows:[¶](#section-2.2-1){.pilcrow}

::: {#section-2.2-2 .artwork .art-text .alignLeft}
                         1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                             Serial                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Scheme     |Hash Algorithm |                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
    |                             Digest                            |
    /                                                               /
    /                                                               /
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-2.2-2){.pilcrow}
:::

::: {#section-2.2.1 .section}
#### [2.2.1.](#section-2.2.1){.section-number .selfRef} [The Serial Field](#name-the-serial-field){.section-name .selfRef} {#name-the-serial-field}

The Serial field is a 32-bit unsigned integer in network byte order. It
is the serial number from the zone\'s SOA record
(\[[RFC1035](#RFC1035){.xref}\], [Section
3.3.13](https://www.rfc-editor.org/rfc/rfc1035#section-3.3.13){.relref})
for which the zone digest was generated.[¶](#section-2.2.1-1){.pilcrow}

It is included here to clearly bind the ZONEMD RR to a particular
version of the zone\'s content. Without the serial number, a stand-alone
ZONEMD digest has no obvious association to any particular instance of a
zone.[¶](#section-2.2.1-2){.pilcrow}
:::

::: {#section-2.2.2 .section}
#### [2.2.2.](#section-2.2.2){.section-number .selfRef} [The Scheme Field](#name-the-scheme-field){.section-name .selfRef} {#name-the-scheme-field}

The Scheme field is an 8-bit unsigned integer that identifies the
methods by which data is collated and presented as input to the hashing
function.[¶](#section-2.2.2-1){.pilcrow}

Herein, SIMPLE, with Scheme value 1, is the only standardized Scheme
defined for ZONEMD records and it [MUST]{.bcp14} be supported by
implementations. The \"ZONEMD Schemes\" registry is further described in
[Section 5](#iana){.xref}.[¶](#section-2.2.2-2){.pilcrow}

Scheme values 240-254 are allocated for Private
Use.[¶](#section-2.2.2-3){.pilcrow}
:::

::: {#section-2.2.3 .section}
#### [2.2.3.](#section-2.2.3){.section-number .selfRef} [The Hash Algorithm Field](#name-the-hash-algorithm-field){.section-name .selfRef} {#name-the-hash-algorithm-field}

The Hash Algorithm field is an 8-bit unsigned integer that identifies
the cryptographic hash algorithm used to construct the
digest.[¶](#section-2.2.3-1){.pilcrow}

Herein, SHA384 (\[[RFC6234](#RFC6234){.xref}\]), with Hash Algorithm
value 1, is the only standardized Hash Algorithm defined for ZONEMD
records that [MUST]{.bcp14} be supported by implementations. When SHA384
is used, the size of the Digest field is 48 octets. The result of the
SHA384 digest algorithm [MUST NOT]{.bcp14} be truncated, and the entire
48-octet digest is published in the ZONEMD
record.[¶](#section-2.2.3-2){.pilcrow}

SHA512 (\[[RFC6234](#RFC6234){.xref}\]), with Hash Algorithm value 2, is
also defined for ZONEMD records and [SHOULD]{.bcp14} be supported by
implementations. When SHA512 is used, the size of the Digest field is 64
octets. The result of the SHA512 digest algorithm [MUST NOT]{.bcp14} be
truncated, and the entire 64-octet digest is published in the ZONEMD
record.[¶](#section-2.2.3-3){.pilcrow}

Hash Algorithm values 240-254 are allocated for Private
Use.[¶](#section-2.2.3-4){.pilcrow}

The \"ZONEMD Hash Algorithms\" registry is further described in [Section
5](#iana){.xref}.[¶](#section-2.2.3-5){.pilcrow}
:::

::: {#section-2.2.4 .section}
#### [2.2.4.](#section-2.2.4){.section-number .selfRef} [The Digest Field](#name-the-digest-field){.section-name .selfRef} {#name-the-digest-field}

The Digest field is a variable-length sequence of octets containing the
output of the hash algorithm. The length of the Digest field is
determined by deducting the fixed size of the Serial, Scheme, and Hash
Algorithm fields from the RDATA size in the ZONEMD RR
header.[¶](#section-2.2.4-1){.pilcrow}

The Digest field [MUST NOT]{.bcp14} be shorter than 12 octets. Digests
for the SHA384 and SHA512 hash algorithms specified herein are never
truncated. Digests for future hash algorithms [MAY]{.bcp14} be truncated
but [MUST NOT]{.bcp14} be truncated to a length that results in less
than 96 bits (12 octets) of equivalent
strength.[¶](#section-2.2.4-2){.pilcrow}

[Section 3](#calculating){.xref} describes how to calculate the digest
for a zone. [Section 4](#verifying){.xref} describes how to use the
digest to verify the contents of a zone.[¶](#section-2.2.4-3){.pilcrow}
:::
:::

::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [ZONEMD Presentation Format](#name-zonemd-presentation-format){.section-name .selfRef} {#name-zonemd-presentation-format}

The presentation format of the RDATA portion is as
follows:[¶](#section-2.3-1){.pilcrow}

-   [The Serial field is represented as an unsigned decimal
    integer.[¶](#section-2.3-2.1){.pilcrow}]{#section-2.3-2.1}
-   [The Scheme field is represented as an unsigned decimal
    integer.[¶](#section-2.3-2.2){.pilcrow}]{#section-2.3-2.2}
-   [The Hash Algorithm field is represented as an unsigned decimal
    integer.[¶](#section-2.3-2.3){.pilcrow}]{#section-2.3-2.3}
-   [The Digest is represented as a sequence of case-insensitive
    hexadecimal digits. Whitespace is allowed within the hexadecimal
    text.[¶](#section-2.3-2.4){.pilcrow}]{#section-2.3-2.4}
:::

::: {#section-2.4 .section}
### [2.4.](#section-2.4){.section-number .selfRef} [ZONEMD Example](#name-zonemd-example){.section-name .selfRef} {#name-zonemd-example}

The following example shows a ZONEMD RR in presentation
format:[¶](#section-2.4-1){.pilcrow}

::: {#section-2.4-2}
``` {.sourcecode .lang-dns-rr}
example.com. 86400 IN ZONEMD 2018031500 1 1 (
    FEBE3D4CE2EC2FFA4BA99D46CD69D6D29711E55217057BEE
    7EB1A7B641A47BA7FED2DD5B97AE499FAFA4F22C6BD647DE )
```

[¶](#section-2.4-2){.pilcrow}
:::
:::

::: {#section-2.5 .section}
### [2.5.](#section-2.5){.section-number .selfRef} [Including ZONEMD RRs in a Zone](#name-including-zonemd-rrs-in-a-z){.section-name .selfRef} {#name-including-zonemd-rrs-in-a-z}

The zone operator chooses an appropriate hash algorithm and scheme and
includes the calculated zone digest in the apex ZONEMD RRset. The zone
operator [MAY]{.bcp14} choose any of the defined hash algorithms and
schemes, including the Private Use code
points.[¶](#section-2.5-1){.pilcrow}

The ZONEMD RRset [MAY]{.bcp14} contain multiple records to support
algorithm agility (\[[BCP201](#BCP201){.xref}\]). When multiple ZONEMD
RRs are present, each [MUST]{.bcp14} specify a unique Scheme and Hash
Algorithm tuple. It is [RECOMMENDED]{.bcp14} that a zone include only
one ZONEMD RR, unless the zone operator is in the process of
transitioning to a new scheme or hash
algorithm.[¶](#section-2.5-2){.pilcrow}
:::
:::
:::

::: {#calculating}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Calculating the Digest](#name-calculating-the-digest){.section-name .selfRef} {#name-calculating-the-digest}

The algorithm described in this section is designed for the common case
of offline DNSSEC signing. Slight deviations may be permitted or
necessary in other situations, such as with unsigned zones or online
DNSSEC signing. Implementations that deviate from the described
algorithm are advised to ensure that it produces ZONEMD RRs, signatures,
and denial-of-existence records that are identical to the ones generated
by this procedure.[¶](#section-3-1){.pilcrow}

::: {#placeholder}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Add ZONEMD Placeholder](#name-add-zonemd-placeholder){.section-name .selfRef} {#name-add-zonemd-placeholder}

In preparation for calculating the zone digest(s), any existing ZONEMD
records (and covering RRSIGs) at the zone apex are first
deleted.[¶](#section-3.1-1){.pilcrow}

Prior to calculation of the digest, and prior to signing with DNSSEC,
one or more placeholder ZONEMD records are added to the zone apex. This
ensures that denial-of-existence (NSEC, NSEC3) records are created
correctly if the zone is signed with DNSSEC. If placeholders were not
added prior to signing, the later addition of ZONEMD records would also
require updating the Type Bit Maps field of any apex NSEC/NSEC3 RRs,
which then invalidates the calculated digest
value.[¶](#section-3.1-2){.pilcrow}

When multiple ZONEMD RRs are published in the zone, e.g., during an
algorithm rollover, each [MUST]{.bcp14} specify a unique Scheme and Hash
Algorithm tuple.[¶](#section-3.1-3){.pilcrow}

It is [RECOMMENDED]{.bcp14} that the TTL of the ZONEMD record match the
TTL of the Start of Authority (SOA). However, the TTL of the ZONEMD
record may be safely ignored during verification in all
cases.[¶](#section-3.1-4){.pilcrow}

In the placeholder record, the Serial field is set to the current SOA
Serial. The Scheme field is set to the value for the chosen collation
scheme. The Hash Algorithm field is set to the value for the chosen hash
algorithm. Since apex ZONEMD records are excluded from digest
calculation, the value of the Digest field does not matter at this point
in the process.[¶](#section-3.1-5){.pilcrow}
:::
:::

::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Optionally, Sign the Zone](#name-optionally-sign-the-zone){.section-name .selfRef} {#name-optionally-sign-the-zone}

Following the addition of placeholder records, the zone may be signed
with DNSSEC. When the digest calculation is complete, and the ZONEMD
record is updated, the signature(s) for the ZONEMD RRset [MUST]{.bcp14}
be recalculated and updated as well. Therefore, the signer is not
required to calculate a signature over the placeholder record at this
step in the process, but it is harmless to do
so.[¶](#section-3.2-1){.pilcrow}
:::

::: {#collate-iterate}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Scheme-Specific Processing](#name-scheme-specific-processing){.section-name .selfRef} {#name-scheme-specific-processing}

Herein, only the SIMPLE collation scheme is defined. Additional schemes
may be defined in future updates to this
document.[¶](#section-3.3-1){.pilcrow}

::: {#scheme-simple}
::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [The SIMPLE Scheme](#name-the-simple-scheme){.section-name .selfRef} {#name-the-simple-scheme}

For the SIMPLE scheme, the digest is calculated over the zone as a
whole. This means that a change to a single RR in the zone requires
iterating over all RRs in the zone to recalculate the digest. SIMPLE is
a good choice for zones that are small and/or stable, but it is probably
not good for zones that are large and/or
dynamic.[¶](#section-3.3.1-1){.pilcrow}

Calculation of a zone digest requires RRs to be processed in a
consistent format and ordering. This specification uses DNSSEC\'s
canonical on-the-wire RR format (without name compression) and ordering
as specified in Sections
[6.1](https://www.rfc-editor.org/rfc/rfc4034#section-6.1){.relref},
[6.2](https://www.rfc-editor.org/rfc/rfc4034#section-6.2){.relref}, and
[6.3](https://www.rfc-editor.org/rfc/rfc4034#section-6.3){.relref} of
\[[RFC4034](#RFC4034){.xref}\] with the additional provision that RRsets
having the same owner name [MUST]{.bcp14} be numerically ordered, in
ascending order, by their numeric RR
TYPE.[¶](#section-3.3.1-2){.pilcrow}

::: {#simple-inclusion-exclusion}
::: {#section-3.3.1.1 .section}
##### [3.3.1.1.](#section-3.3.1.1){.section-number .selfRef} [SIMPLE Scheme Inclusion/Exclusion Rules](#name-simple-scheme-inclusion-exc){.section-name .selfRef} {#name-simple-scheme-inclusion-exc}

When iterating over records in the zone, the following
inclusion/exclusion rules apply:[¶](#section-3.3.1.1-1){.pilcrow}

-   [All records in the zone, including glue records, [MUST]{.bcp14} be
    included unless excluded by a subsequent
    rule.[¶](#section-3.3.1.1-2.1){.pilcrow}]{#section-3.3.1.1-2.1}
-   [Occluded data (\[[RFC5936](#RFC5936){.xref}\], [Section
    3.5](https://www.rfc-editor.org/rfc/rfc5936#section-3.5){.relref})
    [MUST]{.bcp14} be
    included.[¶](#section-3.3.1.1-2.2){.pilcrow}]{#section-3.3.1.1-2.2}
-   [If there are duplicate RRs with equal owner, class, type, and
    RDATA, only one instance is included
    (\[[RFC4034](#RFC4034){.xref}\], [Section
    6.3](https://www.rfc-editor.org/rfc/rfc4034#section-6.3){.relref})
    and the duplicates [MUST]{.bcp14} be
    omitted.[¶](#section-3.3.1.1-2.3){.pilcrow}]{#section-3.3.1.1-2.3}
-   [The placeholder apex ZONEMD RR(s) [MUST NOT]{.bcp14} be
    included.[¶](#section-3.3.1.1-2.4){.pilcrow}]{#section-3.3.1.1-2.4}
-   [If the zone is signed, DNSSEC RRs [MUST]{.bcp14} be included,
    except:[¶](#section-3.3.1.1-2.5){.pilcrow}]{#section-3.3.1.1-2.5}
-   [The RRSIG covering the apex ZONEMD RRset [MUST NOT]{.bcp14} be
    included because the RRSIG will be updated after all digests have
    been
    calculated.[¶](#section-3.3.1.1-2.6){.pilcrow}]{#section-3.3.1.1-2.6}
:::
:::

::: {#section-3.3.1.2 .section}
##### [3.3.1.2.](#section-3.3.1.2){.section-number .selfRef} [SIMPLE Scheme Digest Calculation](#name-simple-scheme-digest-calcul){.section-name .selfRef} {#name-simple-scheme-digest-calcul}

A zone digest using the SIMPLE scheme is calculated by concatenating all
RRs in the zone, in the format and order described in [Section
3.3.1](#scheme-simple){.xref} subject to the inclusion/exclusion rules
described in [Section 3.3.1.1](#simple-inclusion-exclusion){.xref}, and
then applying the chosen hash
algorithm:[¶](#section-3.3.1.2-1){.pilcrow}

::: {#section-3.3.1.2-2}
``` {.sourcecode .lang-pseudocode}
digest = hash( RR(1) | RR(2) | RR(3) | ... )

where "|" denotes concatenation.
```

[¶](#section-3.3.1.2-2){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Update ZONEMD RR](#name-update-zonemd-rr){.section-name .selfRef} {#name-update-zonemd-rr}

The calculated zone digest is inserted into the placeholder ZONEMD RR.
Repeat for each digest if multiple digests are to be
published.[¶](#section-3.4-1){.pilcrow}

If the zone is signed with DNSSEC, the RRSIG record(s) covering the
ZONEMD RRset [MUST]{.bcp14} then be added or updated. Because the ZONEMD
placeholder was added prior to signing, the zone will already have the
appropriate denial-of-existence (NSEC, NSEC3)
records.[¶](#section-3.4-2){.pilcrow}

Some DNSSEC implementations (especially \"online signing\") might update
the SOA serial number whenever a new signature is made. To preserve the
calculated digest, generation of a ZONEMD signature [MUST NOT]{.bcp14}
also result in a change to the SOA serial number. The ZONEMD RR and the
matching SOA [MUST]{.bcp14} be published at the same
time.[¶](#section-3.4-3){.pilcrow}
:::
:::
:::

::: {#verifying}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Verifying Zone Digest](#name-verifying-zone-digest){.section-name .selfRef} {#name-verifying-zone-digest}

The recipient of a zone that has a ZONEMD RR verifies the zone by
calculating the digest as follows:[¶](#section-4-1){.pilcrow}

Note: If multiple ZONEMD RRs are present in the zone, e.g., during an
algorithm rollover, a match using any one of the recipient\'s supported
Schemes and Hash Algorithms is sufficient to verify the zone. The
verifier [MAY]{.bcp14} ignore a ZONEMD RR if its Scheme and Hash
Algorithm violates local policy.[¶](#section-4-2.1){.pilcrow}

1.  ::: {#section-4-3.1}
    ::: {#verify-check-dnssec}
    The verifier [MUST]{.bcp14} first determine whether or not to expect
    DNSSEC records in the zone. By examining locally configured trust
    anchors and, if necessary, querying for and validating Delegation
    Signer (DS) RRs in the parent zone, the verifier knows whether or
    not the zone to be verified should include DNSSEC keys and
    signatures. For zones where signatures are not expected, or if
    DNSSEC validation is not performed, digest verification continues at
    step [4](#verify-check-digest-count){.xref}
    below.[¶](#verify-check-dnssec){.pilcrow}
    :::
    :::

2.  ::: {#section-4-3.2}
    ::: {#verify-check-existence}
    For zones where signatures are expected, the existence of the apex
    ZONEMD record [MUST]{.bcp14} be validated. If the DNSSEC data proves
    the ZONEMD RRset does not exist, digest verification cannot occur.
    If the DNSSEC data proves the ZONEMD does exist, but is not found in
    the zone, digest verification [MUST NOT]{.bcp14} be considered
    successful.[¶](#verify-check-existence){.pilcrow}
    :::
    :::

3.  ::: {#section-4-3.3}
    ::: {#verify-dnssec-validate}
    For zones where signatures are expected, the SOA and ZONEMD RRsets
    [MUST]{.bcp14} have valid signatures, chaining up to a trust anchor.
    If DNSSEC validation of the SOA or ZONEMD RRsets fails, digest
    verification [MUST NOT]{.bcp14} be considered
    successful.[¶](#verify-dnssec-validate){.pilcrow}
    :::
    :::

4.  ::: {#section-4-3.4}
    ::: {#verify-check-digest-count}
    When multiple ZONEMD RRs are present, each [MUST]{.bcp14} specify a
    unique Scheme and Hash Algorithm tuple. If the ZONEMD RRset contains
    more than one RR with the same Scheme and Hash Algorithm, digest
    verification for those ZONEMD RRs [MUST NOT]{.bcp14} be considered
    successful.[¶](#verify-check-digest-count){.pilcrow}
    :::
    :::

5.  ::: {#section-4-3.5}
    Loop over all apex ZONEMD RRs and perform the following
    steps:[¶](#section-4-3.5.1){.pilcrow}

    a.  ::: {#section-4-3.5.2.1}
        ::: {#verify-check-serials}
        The SOA Serial field [MUST]{.bcp14} exactly match the ZONEMD
        Serial field. If the fields do not match, digest verification
        [MUST NOT]{.bcp14} be considered successful with this ZONEMD
        RR.[¶](#verify-check-serials){.pilcrow}
        :::
        :::

    b.  [The Scheme field [MUST]{.bcp14} be checked. If the verifier
        does not support the given scheme, verification [MUST
        NOT]{.bcp14} be considered successful with this ZONEMD
        RR.[¶](#section-4-3.5.2.2){.pilcrow}]{#section-4-3.5.2.2}

    c.  [The Hash Algorithm field [MUST]{.bcp14} be checked. If the
        verifier does not support the given hash algorithm, verification
        [MUST NOT]{.bcp14} be considered successful with this ZONEMD
        RR.[¶](#section-4-3.5.2.3){.pilcrow}]{#section-4-3.5.2.3}

    d.  [The Digest field size [MUST]{.bcp14} be checked. If the size of
        the given Digest field is smaller than 12 octets, or if the size
        is not equal to the size expected for the corresponding Hash
        Algorithm, verification [MUST NOT]{.bcp14} be considered
        successful with this ZONEMD
        RR.[¶](#section-4-3.5.2.4){.pilcrow}]{#section-4-3.5.2.4}

    e.  [The zone digest is computed over the zone data as described in
        [Section 3.3](#collate-iterate){.xref} using the Scheme and Hash
        Algorithm for the current ZONEMD
        RR.[¶](#section-4-3.5.2.5){.pilcrow}]{#section-4-3.5.2.5}

    f.  [The computed digest is compared to the received digest. If the
        two digest values match, verification is considered successful.
        Otherwise, verification [MUST NOT]{.bcp14} be considered
        successful for this ZONEMD
        RR.[¶](#section-4-3.5.2.6){.pilcrow}]{#section-4-3.5.2.6}
    :::

Each time zone verification is performed, the verifier [SHOULD]{.bcp14}
report the status as either successful or unsuccessful. When
unsuccessful, the verifier [SHOULD]{.bcp14} report the reason(s) that
verification did not succeed.[¶](#section-4-4){.pilcrow}
:::
:::

::: {#iana}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [ZONEMD RRtype](#name-zonemd-rrtype){.section-name .selfRef} {#name-zonemd-rrtype}

This document defines a new DNS RR type, ZONEMD, whose value 63 has been
allocated by IANA from the \"Resource Record (RR) TYPEs\" subregistry of
the \"Domain Name System (DNS) Parameters\"
registry:[¶](#section-5.1-1){.pilcrow}

[]{.break}

Type:
:   ZONEMD[¶](#section-5.1-2.2){.pilcrow}
:   

Value:
:   63[¶](#section-5.1-2.4){.pilcrow}
:   

Meaning:
:   Message Digest Over Zone Data[¶](#section-5.1-2.6){.pilcrow}
:   

Reference:
:   \[RFC8976\][¶](#section-5.1-2.8){.pilcrow}
:   
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [ZONEMD Scheme](#name-zonemd-scheme){.section-name .selfRef} {#name-zonemd-scheme}

IANA has created a new subregistry in the \"Domain Name System (DNS)
Parameters\" registry as follows:[¶](#section-5.2-1){.pilcrow}

[]{.break}

Registry Name:
:   ZONEMD Schemes[¶](#section-5.2-2.2){.pilcrow}
:   

Registration Procedure:
:   Specification Required[¶](#section-5.2-2.4){.pilcrow}
:   

Reference:
:   \[RFC8976\][¶](#section-5.2-2.6){.pilcrow}
:   

[]{#name-zonemd-scheme-registry}

::: {#scheme-table}
  Value     Description               Mnemonic   Reference
  --------- ------------------------- ---------- -------------
  0         Reserved                             \[RFC8976\]
  1         Simple ZONEMD collation   SIMPLE     \[RFC8976\]
  2-239     Unassigned                           
  240-254   Private Use               N/A        \[RFC8976\]
  255       Reserved                             \[RFC8976\]

  : [Table 1](#table-1){.selfRef}: [ZONEMD Scheme
  Registry](#name-zonemd-scheme-registry){.selfRef}
:::
:::

::: {#hash-alg-registry}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [ZONEMD Hash Algorithms](#name-zonemd-hash-algorithms){.section-name .selfRef} {#name-zonemd-hash-algorithms}

IANA has created a new subregistry in the \"Domain Name System (DNS)
Parameters\" registry as follows:[¶](#section-5.3-1){.pilcrow}

[]{.break}

Registry Name:
:   ZONEMD Hash Algorithms[¶](#section-5.3-2.2){.pilcrow}
:   

Registration Procedure:
:   Specification Required[¶](#section-5.3-2.4){.pilcrow}
:   

Reference:
:   \[RFC8976\][¶](#section-5.3-2.6){.pilcrow}
:   

[]{#name-zonemd-hash-algorithms-regi}

::: {#digest-type-table}
  Value     Description   Mnemonic   Reference
  --------- ------------- ---------- -------------
  0         Reserved                 \[RFC8976\]
  1         SHA-384       SHA384     \[RFC8976\]
  2         SHA-512       SHA512     \[RFC8976\]
  3-239     Unassigned               
  240-254   Private Use   N/A        \[RFC8976\]
  255       Reserved                 \[RFC8976\]

  : [Table 2](#table-2){.selfRef}: [ZONEMD Hash Algorithms
  Registry](#name-zonemd-hash-algorithms-regi){.selfRef}
:::
:::
:::
:::
:::

::: {#security}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Using Zone Digest without DNSSEC](#name-using-zone-digest-without-d){.section-name .selfRef} {#name-using-zone-digest-without-d}

Users of ZONEMD with unsigned zones are advised that it provides no real
protection against attacks. While zone digests can be used in the
absence of DNSSEC, this only provides protection against accidental zone
corruption such as transmission errors and truncation. When used in this
manner, it effectively serves only as a checksum. For zones not signed
with DNSSEC, an attacker can make any zone modifications appear to be
valid by recomputing the Digest field of a ZONEMD
RR.[¶](#section-6.1-1){.pilcrow}
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Attacks against the Zone Digest](#name-attacks-against-the-zone-di){.section-name .selfRef} {#name-attacks-against-the-zone-di}

An attacker, whose goal is to modify zone content before it is used by
the victim, may consider a number of different
approaches.[¶](#section-6.2-1){.pilcrow}

The attacker might perform a downgrade attack to an unsigned zone. This
is why [Section 4](#verifying){.xref} talks about determining whether or
not to expect DNSSEC signatures for the zone in step
[1](#verify-check-dnssec){.xref}.[¶](#section-6.2-2){.pilcrow}

The attacker might perform a downgrade attack by removing one or more
ZONEMD records. Such a removal is detectable only with DNSSEC validation
and is why [Section 4](#verifying){.xref} talks about checking
denial-of-existence proofs in step [2](#verify-check-existence){.xref}
and signature validation in step
[3](#verify-dnssec-validate){.xref}.[¶](#section-6.2-3){.pilcrow}

The attacker might alter the Scheme, Hash Algorithm, or Digest fields of
the ZONEMD record. Such modifications are detectable only with DNSSEC
validation.[¶](#section-6.2-4){.pilcrow}

As stated in \[[BCP201](#BCP201){.xref}\], cryptographic algorithms age
and become weaker as cryptanalysis techniques and computing resources
improve with time. Implementors and publishers of zone digests should
anticipate the need for algorithm agility on long
timescales.[¶](#section-6.2-5){.pilcrow}
:::

::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Use of Multiple ZONEMD Hash Algorithms](#name-use-of-multiple-zonemd-hash){.section-name .selfRef} {#name-use-of-multiple-zonemd-hash}

When a zone publishes multiple ZONEMD RRs, the overall security is only
as good as the weakest hash algorithm in use. For this reason, [Section
2](#rrtype){.xref} recommends only publishing multiple ZONEMD RRs when
transitioning to a new scheme or hash algorithm. Once the transition is
complete, the old scheme or hash algorithm should be removed from the
ZONEMD RRset.[¶](#section-6.3-1){.pilcrow}
:::

::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [DNSSEC Timing Considerations](#name-dnssec-timing-consideration){.section-name .selfRef} {#name-dnssec-timing-consideration}

As with all DNSSEC signatures, the ability to perform signature
validation of a ZONEMD record is limited in time. If the DS record(s) or
trust anchors for the zone to be verified are no longer available, the
recipient cannot validate the ZONEMD RRset. This could happen even if
the ZONEMD signature is still current (not expired), since the zone\'s
DS record(s) may have been withdrawn following a Key Signing Key (KSK)
rollover.[¶](#section-6.4-1){.pilcrow}

For zones where it may be important to validate a ZONEMD RRset through
its entire signature validity period, the zone operator should ensure
that KSK rollover timing takes this into
consideration.[¶](#section-6.4-2){.pilcrow}
:::

::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [Attacks Utilizing ZONEMD Queries](#name-attacks-utilizing-zonemd-qu){.section-name .selfRef} {#name-attacks-utilizing-zonemd-qu}

Nothing in this specification prevents clients from making, and servers
from responding to, ZONEMD queries. Servers [SHOULD NOT]{.bcp14}
calculate zone digests dynamically (for each query) as this can be used
as a CPU resource exhaustion attack.[¶](#section-6.5-1){.pilcrow}

ZONEMD responses could be used in a distributed denial-of-service
amplification attack. The ZONEMD RR is moderately sized, much like the
DS RR. A single ZONEMD RR contributes approximately 65 to 95 octets to a
DNS response for digest types defined herein. Other RR types, such as
DNS Public Key (DNSKEY), can result in larger amplification
effects.[¶](#section-6.5-2){.pilcrow}
:::

::: {#section-6.6 .section}
### [6.6.](#section-6.6){.section-number .selfRef} [Resilience and Fragility](#name-resilience-and-fragility){.section-name .selfRef} {#name-resilience-and-fragility}

ZONEMD is used to detect incomplete or corrupted zone data prior to its
use, thereby increasing resilience by not using corrupt data, but also
introduces some denial-of-service fragility by making good data in a
zone unavailable if some other data is missing or corrupt. Publishers
and consumers of zones containing ZONEMD records should be aware of
these trade-offs. While the intention is to secure the zone data,
misconfigurations or implementation bugs are generally indistinguishable
from intentional tampering and could lead to service failures when
verification is performed automatically.[¶](#section-6.6-1){.pilcrow}

Zone publishers may want to deploy ZONEMD gradually perhaps by utilizing
one of the Private Use hash algorithm code points listed in [Section
5.3](#hash-alg-registry){.xref}. Similarly, recipients may want to
initially configure verification failures only as a warning, and later
as an error after gaining experience and confidence with the
feature.[¶](#section-6.6-2){.pilcrow}
:::
:::
:::

::: {#performance}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Performance Considerations](#name-performance-considerations){.section-name .selfRef} {#name-performance-considerations}

This section is provided to make zone publishers aware of the
performance requirements and implications of including ZONEMD RRs in a
zone.[¶](#section-7-1){.pilcrow}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [SIMPLE SHA384](#name-simple-sha384){.section-name .selfRef} {#name-simple-sha384}

As mentioned previously, the SIMPLE scheme may be impractical for use in
zones that are either large or highly dynamic. Zone publishers should
carefully consider the use of ZONEMD in such zones since it might cause
consumers of zone data (e.g., secondary name servers) to expend
resources on digest calculation. For such use cases, it is recommended
that ZONEMD only be used when digest calculation time is significantly
less than propagation times and update
intervals.[¶](#section-7.1-1){.pilcrow}

The authors\' implementation ([Appendix
B.1](#authors-implementation){.xref}) includes an option to record and
report CPU usage of its operation. The software was used to generate
digests for more than 800 Top-Level Domain (TLD) zones available from
\[[CZDS](#CZDS){.xref}\]. The table below summarizes the results for the
SIMPLE scheme and SHA384 hash algorithm grouped by zone size. The Rate
column is the mean amount of time per RR to calculate the digest,
running on commodity hardware in early
2020.[¶](#section-7.1-2){.pilcrow}

  Zone Size (RRs)       Rate (msec/RR)
  --------------------- ----------------
  10 - 99               0.00683
  100 - 999             0.00551
  1000 - 9999           0.00505
  10000 - 99999         0.00602
  100000 - 999999       0.00845
  1000000 - 9999999     0.0108
  10000000 - 99999999   0.0148

  : [Table 3](#table-3){.selfRef}

For example, based on the above table, it takes approximately 0.13
seconds to calculate a SIMPLE SHA384 digest for a zone with 22,000 RRs,
and about 2.5 seconds for a zone with 300,000
RRs.[¶](#section-7.1-4){.pilcrow}

These benchmarks attempt to emulate a worst-case scenario and take into
account the time required to canonicalize the zone for processing. Each
of the 800+ zones were measured three times and then averaged, with a
different random sorting of the input data prior to each
measurement.[¶](#section-7.1-5){.pilcrow}
:::
:::
:::

::: {#privacy}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Privacy Considerations](#name-privacy-considerations){.section-name .selfRef} {#name-privacy-considerations}

This specification has no impact on user
privacy.[¶](#section-8-1){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC1034\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - concepts and
    facilities\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1034]{.seriesInfo}, [DOI 10.17487/RFC1034]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1034>\>.
:   

\[RFC1035\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - implementation and
    specification\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1035]{.seriesInfo}, [DOI 10.17487/RFC1035]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1035>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4034\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Resource Records for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4034]{.seriesInfo}, [DOI
    10.17487/RFC4034]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4034>\>.
:   

\[RFC6234\]
:   [Eastlake 3rd, D.]{.refAuthor}[ and T. Hansen]{.refAuthor}, [\"US
    Secure Hash Algorithms (SHA and SHA-based HMAC and
    HKDF)\"]{.refTitle}, [RFC 6234]{.seriesInfo}, [DOI
    10.17487/RFC6234]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6234>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[BCP201\]

:   ::: {#RFC7696 .refInstance}
    [Housley, R.]{.refAuthor}, [\"Guidelines for Cryptographic Algorithm
    Agility and Selecting Mandatory-to-Implement
    Algorithms\"]{.refTitle}, [BCP 201]{.seriesInfo}, [RFC
    7696]{.seriesInfo}, November 2015.
    :::

    \<<https://www.rfc-editor.org/info/bcp201>\>

:   

\[CZDS\]
:   [Internet Corporation for Assigned Names and Numbers
    (ICANN)]{.refAuthor}, [\"Centralized Zone Data
    Service\"]{.refTitle}, October 2018, \<<https://czds.icann.org/>\>.
:   

\[DISK-FULL-FAILURE\]
:   [DENIC]{.refAuthor}, [\"Background of the Partial Failure of the
    Name Service for .de Domains\"]{.refTitle}, May 2010,
    \<<https://web.archive.org/web/20100618032705/https://www.denic.de/en/denic-in-dialogue/news/2733.html>\>.
:   

\[DNS-TOOLS\]
:   [\"DNS tools for zone signature (file, pkcs11-hsm) and validation,
    and zone digest (ZONEMD)\"]{.refTitle}, [commit
    489de21]{.refContent}, December 2020,
    \<<https://github.com/niclabs/dns-tools>\>.
:   

\[DPRIVE-XFR-OVER-TLS\]
:   [Toorop, W.]{.refAuthor}[, Dickinson, S.]{.refAuthor}[,
    Sahib, S.]{.refAuthor}[, Aras, P.]{.refAuthor}[, and A.
    Mankin]{.refAuthor}, [\"DNS Zone Transfer-over-TLS\"]{.refTitle},
    [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-dprive-xfr-over-tls-05]{.seriesInfo}, 20 January 2021,
    \<<https://tools.ietf.org/html/draft-ietf-dprive-xfr-over-tls-05>\>.
:   

\[InterNIC\]
:   [InterNIC]{.refAuthor}, [\"Index of
    ftp://rs.internic.net/\"]{.refTitle}, May 2018,
    \<<ftp://ftp.internic.net/domain/>\>.
:   

\[LDNS-ZONE-DIGEST\]
:   [\"Implementation of Message Digests for DNS Zones using the ldns
    library\"]{.refTitle}, [commit 71c0cd1]{.refContent}, January 2021,
    \<<https://github.com/verisign/ldns-zone-digest>\>.
:   

\[RFC1995\]
:   [Ohta, M.]{.refAuthor}, [\"Incremental Zone Transfer in
    DNS\"]{.refTitle}, [RFC 1995]{.seriesInfo}, [DOI
    10.17487/RFC1995]{.seriesInfo}, August 1996,
    \<<https://www.rfc-editor.org/info/rfc1995>\>.
:   

\[RFC2065\]
:   [Eastlake 3rd, D.]{.refAuthor}[ and C. Kaufman]{.refAuthor},
    [\"Domain Name System Security Extensions\"]{.refTitle}, [RFC
    2065]{.seriesInfo}, [DOI 10.17487/RFC2065]{.seriesInfo}, January
    1997, \<<https://www.rfc-editor.org/info/rfc2065>\>.
:   

\[RFC2136\]
:   [Vixie, P., Ed.]{.refAuthor}[, Thomson, S.]{.refAuthor}[,
    Rekhter, Y.]{.refAuthor}[, and J. Bound]{.refAuthor}, [\"Dynamic
    Updates in the Domain Name System (DNS UPDATE)\"]{.refTitle}, [RFC
    2136]{.seriesInfo}, [DOI 10.17487/RFC2136]{.seriesInfo}, April 1997,
    \<<https://www.rfc-editor.org/info/rfc2136>\>.
:   

\[RFC2535\]
:   [Eastlake 3rd, D.]{.refAuthor}, [\"Domain Name System Security
    Extensions\"]{.refTitle}, [RFC 2535]{.seriesInfo}, [DOI
    10.17487/RFC2535]{.seriesInfo}, March 1999,
    \<<https://www.rfc-editor.org/info/rfc2535>\>.
:   

\[RFC2931\]
:   [Eastlake 3rd, D.]{.refAuthor}, [\"DNS Request and Transaction
    Signatures ( SIG(0)s )\"]{.refTitle}, [RFC 2931]{.seriesInfo}, [DOI
    10.17487/RFC2931]{.seriesInfo}, September 2000,
    \<<https://www.rfc-editor.org/info/rfc2931>\>.
:   

\[RFC3258\]
:   [Hardie, T.]{.refAuthor}, [\"Distributing Authoritative Name Servers
    via Shared Unicast Addresses\"]{.refTitle}, [RFC 3258]{.seriesInfo},
    [DOI 10.17487/RFC3258]{.seriesInfo}, April 2002,
    \<<https://www.rfc-editor.org/info/rfc3258>\>.
:   

\[RFC4033\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"DNS Security Introduction and
    Requirements\"]{.refTitle}, [RFC 4033]{.seriesInfo}, [DOI
    10.17487/RFC4033]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4033>\>.
:   

\[RFC4035\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Protocol Modifications for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4035]{.seriesInfo}, [DOI
    10.17487/RFC4035]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4035>\>.
:   

\[RFC4880\]
:   [Callas, J.]{.refAuthor}[, Donnerhacke, L.]{.refAuthor}[,
    Finney, H.]{.refAuthor}[, Shaw, D.]{.refAuthor}[, and R.
    Thayer]{.refAuthor}, [\"OpenPGP Message Format\"]{.refTitle}, [RFC
    4880]{.seriesInfo}, [DOI 10.17487/RFC4880]{.seriesInfo}, November
    2007, \<<https://www.rfc-editor.org/info/rfc4880>\>.
:   

\[RFC5155\]
:   [Laurie, B.]{.refAuthor}[, Sisson, G.]{.refAuthor}[,
    Arends, R.]{.refAuthor}[, and D. Blacka]{.refAuthor}, [\"DNS
    Security (DNSSEC) Hashed Authenticated Denial of
    Existence\"]{.refTitle}, [RFC 5155]{.seriesInfo}, [DOI
    10.17487/RFC5155]{.seriesInfo}, March 2008,
    \<<https://www.rfc-editor.org/info/rfc5155>\>.
:   

\[RFC5936\]
:   [Lewis, E.]{.refAuthor}[ and A. Hoenes, Ed.]{.refAuthor}, [\"DNS
    Zone Transfer Protocol (AXFR)\"]{.refTitle}, [RFC
    5936]{.seriesInfo}, [DOI 10.17487/RFC5936]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5936>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8484\]
:   [Hoffman, P.]{.refAuthor}[ and P. McManus]{.refAuthor}, [\"DNS
    Queries over HTTPS (DoH)\"]{.refTitle}, [RFC 8484]{.seriesInfo},
    [DOI 10.17487/RFC8484]{.seriesInfo}, October 2018,
    \<<https://www.rfc-editor.org/info/rfc8484>\>.
:   

\[RFC8499\]
:   [Hoffman, P.]{.refAuthor}[, Sullivan, A.]{.refAuthor}[, and K.
    Fujiwara]{.refAuthor}, [\"DNS Terminology\"]{.refTitle}, [BCP
    219]{.seriesInfo}, [RFC 8499]{.seriesInfo}, [DOI
    10.17487/RFC8499]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8499>\>.
:   

\[RFC8551\]
:   [Schaad, J.]{.refAuthor}[, Ramsdell, B.]{.refAuthor}[, and S.
    Turner]{.refAuthor}, [\"Secure/Multipurpose Internet Mail Extensions
    (S/MIME) Version 4.0 Message Specification\"]{.refTitle}, [RFC
    8551]{.seriesInfo}, [DOI 10.17487/RFC8551]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8551>\>.
:   

\[RFC8806\]
:   [Kumari, W.]{.refAuthor}[ and P. Hoffman]{.refAuthor}, [\"Running a
    Root Server Local to a Resolver\"]{.refTitle}, [RFC
    8806]{.seriesInfo}, [DOI 10.17487/RFC8806]{.seriesInfo}, June 2020,
    \<<https://www.rfc-editor.org/info/rfc8806>\>.
:   

\[RFC8901\]
:   [Huque, S.]{.refAuthor}[, Aras, P.]{.refAuthor}[,
    Dickinson, J.]{.refAuthor}[, Vcelak, J.]{.refAuthor}[, and D.
    Blacka]{.refAuthor}, [\"Multi-Signer DNSSEC Models\"]{.refTitle},
    [RFC 8901]{.seriesInfo}, [DOI 10.17487/RFC8901]{.seriesInfo},
    September 2020, \<<https://www.rfc-editor.org/info/rfc8901>\>.
:   

\[RFC8945\]
:   [Dupont, F.]{.refAuthor}[, Morris, S.]{.refAuthor}[,
    Vixie, P.]{.refAuthor}[, Eastlake 3rd, D.]{.refAuthor}[,
    Gudmundsson, O.]{.refAuthor}[, and B. Wellington]{.refAuthor},
    [\"Secret Key Transaction Authentication for DNS
    (TSIG)\"]{.refTitle}, [STD 93]{.seriesInfo}, [RFC
    8945]{.seriesInfo}, [DOI 10.17487/RFC8945]{.seriesInfo}, November
    2020, \<<https://www.rfc-editor.org/info/rfc8945>\>.
:   

\[ROOT-SERVERS\]
:   [Root Server Operators]{.refAuthor},
    [\"root-servers.org\"]{.refTitle}, July 2018,
    \<<https://www.root-servers.org/>\>.
:   

\[RPZ\]
:   [Wikipedia]{.refAuthor}, [\"Response policy zone\"]{.refTitle}, May
    2020,
    \<<https://en.wikipedia.org/w/index.php?title=Response_policy_zone&oldid=960043728>\>.
:   

\[ZONE-DIGEST-HACKATHON\]
:   [\"Prototype implementation of ZONEMD for the IETF 102
    hackathon\"]{.refTitle}, [commit 76ad7a7]{.refContent}, August 2019,
    \<<https://github.com/shane-kerr/ZoneDigestHackathon>\>.
:   

\[ZONE-DIGEST-TESTS\]
:   [IETF]{.refAuthor}, [\"RFC 8976 ZONEMD Test Cases\"]{.refTitle},
    January 2021,
    \<<https://trac.ietf.org/trac/dnsop/wiki/RFC8976ZONEMDTestCases>\>.
:   
:::
:::

::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Example Zones with Digests](#name-example-zones-with-digests){.section-name .selfRef} {#name-example-zones-with-digests}

This appendix contains example zones with accurate ZONEMD records. These
can be used to verify an implementation of the zone digest protocol.
Additional and more extensive test cases can be found via the ZONEMD
Tests Wiki (\[[ZONE-DIGEST-TESTS](#ZONE-DIGEST-TESTS){.xref}\])
maintained by the IETF DNSOP Working
Group.[¶](#section-appendix.a-1){.pilcrow}

::: {#section-a.1 .section}
## [A.1.](#section-a.1){.section-number .selfRef} [Simple EXAMPLE Zone](#name-simple-example-zone){.section-name .selfRef} {#name-simple-example-zone}

Here, the EXAMPLE zone contains an SOA record, NS and glue records, and
a ZONEMD record.[¶](#section-a.1-1){.pilcrow}

::: {#section-a.1-2}
``` {.sourcecode .lang-dns-rr}
example.      86400  IN  SOA     ns1 admin 2018031900 (
                                 1800 900 604800 86400 )
              86400  IN  NS      ns1
              86400  IN  NS      ns2
              86400  IN  ZONEMD  2018031900 1 1 (
                                 c68090d90a7aed71
                                 6bc459f9340e3d7c
                                 1370d4d24b7e2fc3
                                 a1ddc0b9a87153b9
                                 a9713b3c9ae5cc27
                                 777f98b8e730044c )
ns1           3600   IN  A       203.0.113.63
ns2           3600   IN  AAAA    2001:db8::63
```

[¶](#section-a.1-2){.pilcrow}
:::
:::

::: {#section-a.2 .section}
## [A.2.](#section-a.2){.section-number .selfRef} [Complex EXAMPLE Zone](#name-complex-example-zone){.section-name .selfRef} {#name-complex-example-zone}

Here, the EXAMPLE zone contains duplicate RRs, an occluded RR, uppercase
names, a wildcard, a multi-record RRset, a non-apex ZONEMD RR, and one
out-of-zone RR.[¶](#section-a.2-1){.pilcrow}

::: {#section-a.2-2}
``` {.sourcecode .lang-dns-rr}
example.      86400  IN  SOA     ns1 admin 2018031900 (
                                 1800 900 604800 86400 )
              86400  IN  NS      ns1
              86400  IN  NS      ns2
              86400  IN  ZONEMD  2018031900 1 1 (
                                 a3b69bad980a3504
                                 e1cffcb0fd6397f9
                                 3848071c93151f55
                                 2ae2f6b1711d4bd2
                                 d8b39808226d7b9d
                                 b71e34b72077f8fe )
ns1           3600   IN  A       203.0.113.63
NS2           3600   IN  AAAA    2001:db8::63
occluded.sub  7200   IN  TXT     "I'm occluded but must be digested"
sub           7200   IN  NS      ns1
duplicate     300    IN  TXT     "I must be digested just once"
duplicate     300    IN  TXT     "I must be digested just once"
foo.test.     555    IN  TXT     "out-of-zone data must be excluded"
UPPERCASE     3600   IN  TXT     "canonicalize uppercase owner names"
*             777    IN  PTR     dont-forget-about-wildcards
mail          3600   IN  MX      20 MAIL1
mail          3600   IN  MX      10 Mail2.Example.
sortme        3600   IN  AAAA    2001:db8::5:61
sortme        3600   IN  AAAA    2001:db8::3:62
sortme        3600   IN  AAAA    2001:db8::4:63
sortme        3600   IN  AAAA    2001:db8::1:65
sortme        3600   IN  AAAA    2001:db8::2:64
non-apex      900    IN  ZONEMD  2018031900 1 1 (
                                 616c6c6f77656420
                                 6275742069676e6f
                                 7265642e20616c6c
                                 6f77656420627574
                                 2069676e6f726564
                                 2e20616c6c6f7765 )
```

[¶](#section-a.2-2){.pilcrow}
:::
:::

::: {#section-a.3 .section}
## [A.3.](#section-a.3){.section-number .selfRef} [EXAMPLE Zone with Multiple Digests](#name-example-zone-with-multiple-){.section-name .selfRef} {#name-example-zone-with-multiple-}

Here, the EXAMPLE zone contains multiple ZONEMD records. It has both
SHA384 and SHA512 digests using the SIMPLE scheme. It also includes
ZONEMD records with Scheme and Hash Algorithm values in the private
range (240-254). These additional private-range digests are not
verifiable.[¶](#section-a.3-1){.pilcrow}

::: {#section-a.3-2}
``` {.sourcecode .lang-dns-rr}
example.      86400  IN  SOA     ns1 admin 2018031900 (
                                 1800 900 604800 86400 )
example.      86400  IN  NS      ns1.example.
example.      86400  IN  NS      ns2.example.
example.      86400  IN  ZONEMD  2018031900 1 1 (
                                 62e6cf51b02e54b9
                                 b5f967d547ce4313
                                 6792901f9f88e637
                                 493daaf401c92c27
                                 9dd10f0edb1c56f8
                                 080211f8480ee306 )
example.      86400  IN  ZONEMD  2018031900 1 2 (
                                 08cfa1115c7b948c
                                 4163a901270395ea
                                 226a930cd2cbcf2f
                                 a9a5e6eb85f37c8a
                                 4e114d884e66f176
                                 eab121cb02db7d65
                                 2e0cc4827e7a3204
                                 f166b47e5613fd27 )
example.      86400  IN  ZONEMD  2018031900 1 240 (
                                 e2d523f654b9422a
                                 96c5a8f44607bbee )
example.      86400  IN  ZONEMD  2018031900 241 1 (
                                 e1846540e33a9e41
                                 89792d18d5d131f6
                                 05fc283e )
ns1.example.  3600   IN  A       203.0.113.63
ns2.example.  86400  IN  TXT     "This example has multiple digests"
NS2.EXAMPLE.  3600   IN  AAAA    2001:db8::63
```

[¶](#section-a.3-2){.pilcrow}
:::
:::

::: {#section-a.4 .section}
## [A.4.](#section-a.4){.section-number .selfRef} [The URI.ARPA Zone](#name-the-uriarpa-zone){.section-name .selfRef} {#name-the-uriarpa-zone}

The following sample zone is the URI.ARPA zone retrieved 2021-01-21.
Note this sample zone has been re-signed with unpublished keys, so that
the added ZONEMD RR also has a signature.[¶](#section-a.4-1){.pilcrow}

::: {#section-a.4-2}
``` {.sourcecode .lang-dns-rr}
uri.arpa.       3600    IN      SOA     sns.dns.icann.org. (
   noc.dns.icann.org. 2018100702 10800 3600 1209600 3600 )
uri.arpa.       3600    IN      RRSIG   SOA 8 2 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    GzQw+QzwLDJr13REPGVmpEChjD1D2XlX0ie1DnWHpgaEw1E/dhs3lCN3+B
    mHd4Kx3tffTRgiyq65HxR6feQ5v7VmAifjyXUYB1DZur1eP5q0Ms2ygCB3
    byoeMgCNsFS1oKZ2LdzNBRpy3oace8xQn1SpmHGfyrsgg+WbHKCT1dY= )
uri.arpa.       86400   IN      NS      a.iana-servers.net.
uri.arpa.       86400   IN      NS      b.iana-servers.net.
uri.arpa.       86400   IN      NS      c.iana-servers.net.
uri.arpa.       86400   IN      NS      ns2.lacnic.net.
uri.arpa.       86400   IN      NS      sec3.apnic.net.
uri.arpa.       86400   IN      RRSIG   NS 8 2 86400 (
    20210217232440 20210120232440 37444 uri.arpa.
    M+Iei2lcewWGaMtkPlrhM9FpUAHXFkCHTVpeyrjxjEONeNgKtHZor5e4V4
    qJBOzNqo8go/qJpWlFBm+T5Hn3asaBZVstFIYky38/C8UeRLPKq1hTTHAR
    YUlFrexr5fMtSUAVOgOQPSBfH3xBq/BgSccTdRb9clD+HE7djpqrLS4= )
uri.arpa.       600     IN      MX      10 pechora.icann.org.
uri.arpa.       600     IN      RRSIG   MX 8 2 600 (
    20210217232440 20210120232440 37444 uri.arpa.
    kQAJQivmv6A5hqYBK8h6Z13ESY69gmosXwKI6WE09I8RFetfrxr24ecdnY
    d0lpnDtgNNSoHkYRSOoB+C4+zuJsoyAAzGo9uoWMWj97/2xeGhf3PTC9me
    Q9Ohi6hul9By7OR76XYmGhdWX8PBi60RUmZ1guslFBfQ8izwPqzuphs= )
uri.arpa.       3600    IN      DNSKEY  256 3 8 (
    AwEAAbMxuFuLeVDuOwIMzYOTD/bTREjLflo7wOi6ieIJhqltEzgjNzmWJf
    9kGwwDmzxU7kbthMEhBNBZNn84zmcyRSCMzuStWveL7xmqqUlE3swL8kLO
    vdZvc75XnmpHrk3ndTyEb6eZM7slh2C63Oh6K8VR5VkiZAkEGg0uZIT3Nj
    sF )
uri.arpa.       3600    IN      DNSKEY  257 3 8 (
    AwEAAdkTaWkZtZuRh7/OobBUFxM+ytTst+bCu0r9w+rEwXD7GbDs0pIMhM
    enrZzoAvmv1fQxw2MGs6Ri6yPKfNULcFOSt9l8i6BVBLI+SKTY6XXeDUQp
    SEmSaxohHeRPMQFzpysfjxINp/L2rGtZ7yPmxY/XRiFPSO0myqwGJa9r06
    Zw9CHM5UDHKWV/E+zxPFq/I7CfPbrrzbUotBX7Z6Vh3Sarllbe8cGUB2UF
    NaTRgwB0TwDBPRD5ER3w2Dzbry9NhbElTr7vVfhaGWeOGuqAUXwlXEg6Cr
    NkmJXJ2F1Rzr9WHUzhp7uWxhAbmJREGfi2dEyPAbUAyCjBqhFaqglknvc= )
uri.arpa.       3600    IN      DNSKEY  257 3 8 (
    AwEAAenQaBoFmDmvRT+/H5oNbm0Tr5FmNRNDEun0Jpj/ELkzeUrTWhNpQm
    ZeIMC8I0kZ185tEvOnRvn8OvV39B17QIdrvvKGIh2HlgeDRCLolhaojfn2
    QM0DStjF/WWHpxJOmE6CIuvhqYEU37yoJscGAPpPVPzNvnL1HhYTaao1VR
    YWQ/maMrJ+bfHg+YX1N6M/8MnRjIKBif1FWjbCKvsn6dnuGGL9oCWYUFJ3
    DwofXuhgPyZMkzPc88YkJj5EMvbMH4wtelbCwC+ivx732l0w/rXJn0ciQS
    OgoeVvDio8dIJmWQITWQAuP+q/ZHFEFHPlrP3gvQh5mcVS48eLX71Bq7c= )
uri.arpa.       3600    IN      RRSIG   DNSKEY 8 2 3600 (
    20210217232440 20210120232440 12670 uri.arpa.
    DBE2gkKAoxJCfz47KKxzoImN/0AKArhIVHE7TyTwy0DdRPo44V5R+vL6th
    UxlQ1CJi2Rw0jwAXymx5Y3Q873pOEllH+4bJoIT4dmoBmPXfYWW7Clvw9U
    PKHRP0igKHmCVwIeBYDTU3gfLcMTbR4nEWPDN0GxlL1Mf7ITaC2Ioabo79
    Ip3M/MR8I3Vx/xZ4ZKKPHtLn3xUuJluPNanqJrED2gTslL2xWZ1tqjsAjJ
    v7JnJo2HJ8XVRB5zBto0IaJ2oBlqcjdcQ/0VlyoM8uOy1pDwHQ2BJl7322
    gNMHBP9HSiUPIOaIDNUCwW8eUcW6DIUk+s9u3GN1uTqwWzsYB/rA== )
uri.arpa.       3600    IN      RRSIG   DNSKEY 8 2 3600 (
    20210217232440 20210120232440 30577 uri.arpa.
    Kx6HwP4UlkGc1UZ7SERXtQjPajOF4iUvkwDj7MEG1xbQFB1KoJiEb/eiW0
    qmSWdIhMDv8myhgauejRLyJxwxz8HDRV4xOeHWnRGfWBk4XGYwkejVzOHz
    oIArVdUVRbr2JKigcTOoyFN+uu52cNB7hRYu7dH5y1hlc6UbOnzRpMtGxc
    gVyKQ+/ARbIqGG3pegdEOvV49wTPWEiyY65P2urqhvnRg5ok/jzwAdMx4X
    Gshiib7Ojq0sRVl2ZIzj4rFgY/qsSO8SEXEhMo2VuSkoJNiofVzYoqpxEe
    GnANkIT7Tx2xJL1BWyJxyc7E8Wr2QSgCcc+rYL6IkHDtJGHy7TaQ== )
uri.arpa.       3600    IN      ZONEMD  2018100702 1 1 (
    0dbc3c4dbfd75777c12ca19c337854b1577799901307c482e9d91d5d15
    cd934d16319d98e30c4201cf25a1d5a0254960 )
uri.arpa.       3600    IN      RRSIG   ZONEMD 8 2 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    QDo4XZcL3HMyn8aAHyCUsu/Tqj4Gkth8xY1EqByOb8XOTwVtA4ZNQORE1s
    iqNqjtJUbeJPtJSbLNqCL7rCq0CzNNnBscv6IIf4gnqJZjlGtHO30ohXtK
    vEc4z7SU3IASsi6bB3nLmEAyERdYSeU6UBfx8vatQDIRhkgEnnWUTh4= )
uri.arpa.       3600    IN      NSEC    ftp.uri.arpa. (
    NS SOA MX RRSIG NSEC DNSKEY ZONEMD )
uri.arpa.       3600    IN      RRSIG   NSEC 8 2 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    dU/rXLM/naWd1+1PiWiYVaNJyCkiuyZJSccr91pJI673T8r3685B4ODMYF
    afZRboVgwnl3ZrXddY6xOhZL3n9V9nxXZwjLJ2HJUojFoKcXTlpnUyYUYv
    VQ2kj4GHAo6fcGCEp5QFJ2KbCpeJoS+PhKGRRx28icCiNT4/uXQvO2E= )
ftp.uri.arpa.   604800  IN      NAPTR   0 0 "" "" (
    "!^ftp://([^:/?#]*).*$!\\1!i" . )
ftp.uri.arpa.   604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    EygekDgl+Lyyq4NMSEpPyOrOywYf9Y3FAB4v1DT44J3R5QGidaH8l7ZFjH
    oYFI8sY64iYOCV4sBnX/dh6C1L5NgpY+8l5065Xu3vvjyzbtuJ2k6YYwJr
    rCbvl5DDn53zAhhO2hL9uLgyLraZGi9i7TFGd0sm3zNyUF/EVL0CcxU= )
ftp.uri.arpa.   3600    IN      NSEC    http.uri.arpa. (
    NAPTR RRSIG NSEC )
ftp.uri.arpa.   3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    pbP4KxevPXCu/bDqcvXiuBppXyFEmtHyiy0eAN5gS7mi6mp9Z9bWFjx/Ld
    H9+6oFGYa5vGmJ5itu/4EDMe8iQeZbI8yrpM4TquB7RR/MGfBnTd8S+sjy
    QtlRYG7yqEu77Vd78Fme22BKPJ+MVqjS0JHMUE/YUGomPkAjLJJwwGw= )
http.uri.arpa.  604800  IN      NAPTR   0 0 "" "" (
    "!^http://([^:/?#]*).*$!\\1!i" . )
http.uri.arpa.  604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    eTqbWvt1GvTeXozuvm4ebaAfkXFQKrtdu0cEiExto80sHIiCbO0WL8UDa/
    J3cDivtQca7LgUbOb6c17NESsrsVkc6zNPx5RK2tG7ZQYmhYmtqtfg1oU5
    BRdHZ5TyqIXcHlw9Blo2pir1Y9IQgshhD7UOGkbkEmvB1Lrd0aHhAAg= )
http.uri.arpa.  3600    IN      NSEC    mailto.uri.arpa. (
    NAPTR RRSIG NSEC )
http.uri.arpa.  3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    R9rlNzw1CVz2N08q6DhULzcsuUm0UKcPaGAWEU40tr81jEDHsFHNM+khCd
    OI8nDstzA42aee4rwCEgijxJpRCcY9hrO1Ysrrr2fdqNz60JikMdarvU5O
    0p0VXeaaJDfJQT44+o+YXaBwI7Qod3FTMx7aRib8i7istvPm1Rr7ixA= )
mailto.uri.arpa.        604800  IN      NAPTR   0 0 "" "" (
    "!^mailto:(.*)@(.*)$!\\2!i" . )
mailto.uri.arpa.        604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    Ch2zTG2F1plEvQPyIH4Yd80XXLjXOPvMbiqDjpJBcnCJsV8QF7kr0wTLnU
    T3dB+asQudOjPyzaHGwFlMzmrrAsszN4XAMJ6htDtFJdsgTMP/NkHhYRSm
    Vv6rLeAhd+mVfObY12M//b/GGVTjeUI/gJaLW0fLVZxr1Fp5U5CRjyw= )
mailto.uri.arpa.        3600    IN      NSEC    urn.uri.arpa. (
    NAPTR RRSIG NSEC )
mailto.uri.arpa.        3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    fQUbSIE6E7JDi2rosah4SpCOTrKufeszFyj5YEavbQuYlQ5cNFvtm8KuE2
    xXMRgRI4RGvM2leVqcoDw5hS3m2pOJLxH8l2WE72YjYvWhvnwc5Rofe/8y
    B/vaSK9WCnqN8y2q6Vmy73AGP0fuiwmuBra7LlkOiqmyx3amSFizwms= )
urn.uri.arpa.   604800  IN      NAPTR   0 0 "" "" (
    "/urn:([^:]+)/\\1/i" . )
urn.uri.arpa.   604800  IN      RRSIG   NAPTR 8 3 604800 (
    20210217232440 20210120232440 37444 uri.arpa.
    CVt2Tgz0e5ZmaSXqRfNys/8OtVCk9nfP0zhezhN8Bo6MDt6yyKZ2kEEWJP
    jkN7PCYHjO8fGjnUn0AHZI2qBNv7PKHcpR42VY03q927q85a65weOO1YE0
    vPYMzACpua9TOtfNnynM2Ws0uN9URxUyvYkXBdqOC81N3sx1dVELcwc= )
urn.uri.arpa.   3600    IN      NSEC    uri.arpa. NAPTR RRSIG NSEC
urn.uri.arpa.   3600    IN      RRSIG   NSEC 8 3 3600 (
    20210217232440 20210120232440 37444 uri.arpa.
    JuKkMiC3/j9iM3V8/izcouXWAVGnSZjkOgEgFPhutMqoylQNRcSkbEZQzF
    K8B/PIVdzZF0Y5xkO6zaKQjOzz6OkSaNPIo1a7Vyyl3wDY/uLCRRAHRJfp
    knuY7O+AUNXvVVIEYJqZggd4kl/Rjh1GTzPYZTRrVi5eQidI1LqCOeg= )
```

[¶](#section-a.4-2){.pilcrow}
:::
:::

::: {#section-a.5 .section}
## [A.5.](#section-a.5){.section-number .selfRef} [The ROOT-SERVERS.NET Zone](#name-the-root-serversnet-zone){.section-name .selfRef} {#name-the-root-serversnet-zone}

The following sample zone is the ROOT-SERVERS.NET zone retrieved
2018-10-21.[¶](#section-a.5-1){.pilcrow}

::: {#section-a.5-2}
``` {.sourcecode .lang-dns-rr}
root-servers.net.     3600000 IN  SOA     a.root-servers.net. (
    nstld.verisign-grs.com. 2018091100 14400 7200 1209600 3600000 )
root-servers.net.     3600000 IN  NS      a.root-servers.net.
root-servers.net.     3600000 IN  NS      b.root-servers.net.
root-servers.net.     3600000 IN  NS      c.root-servers.net.
root-servers.net.     3600000 IN  NS      d.root-servers.net.
root-servers.net.     3600000 IN  NS      e.root-servers.net.
root-servers.net.     3600000 IN  NS      f.root-servers.net.
root-servers.net.     3600000 IN  NS      g.root-servers.net.
root-servers.net.     3600000 IN  NS      h.root-servers.net.
root-servers.net.     3600000 IN  NS      i.root-servers.net.
root-servers.net.     3600000 IN  NS      j.root-servers.net.
root-servers.net.     3600000 IN  NS      k.root-servers.net.
root-servers.net.     3600000 IN  NS      l.root-servers.net.
root-servers.net.     3600000 IN  NS      m.root-servers.net.
a.root-servers.net.   3600000 IN  AAAA    2001:503:ba3e::2:30
a.root-servers.net.   3600000 IN  A       198.41.0.4
b.root-servers.net.   3600000 IN  MX      20 mail.isi.edu.
b.root-servers.net.   3600000 IN  AAAA    2001:500:200::b
b.root-servers.net.   3600000 IN  A       199.9.14.201
c.root-servers.net.   3600000 IN  AAAA    2001:500:2::c
c.root-servers.net.   3600000 IN  A       192.33.4.12
d.root-servers.net.   3600000 IN  AAAA    2001:500:2d::d
d.root-servers.net.   3600000 IN  A       199.7.91.13
e.root-servers.net.   3600000 IN  AAAA    2001:500:a8::e
e.root-servers.net.   3600000 IN  A       192.203.230.10
f.root-servers.net.   3600000 IN  AAAA    2001:500:2f::f
f.root-servers.net.   3600000 IN  A       192.5.5.241
g.root-servers.net.   3600000 IN  AAAA    2001:500:12::d0d
g.root-servers.net.   3600000 IN  A       192.112.36.4
h.root-servers.net.   3600000 IN  AAAA    2001:500:1::53
h.root-servers.net.   3600000 IN  A       198.97.190.53
i.root-servers.net.   3600000 IN  MX      10 mx.i.root-servers.org.
i.root-servers.net.   3600000 IN  AAAA    2001:7fe::53
i.root-servers.net.   3600000 IN  A       192.36.148.17
j.root-servers.net.   3600000 IN  AAAA    2001:503:c27::2:30
j.root-servers.net.   3600000 IN  A       192.58.128.30
k.root-servers.net.   3600000 IN  AAAA    2001:7fd::1
k.root-servers.net.   3600000 IN  A       193.0.14.129
l.root-servers.net.   3600000 IN  AAAA    2001:500:9f::42
l.root-servers.net.   3600000 IN  A       199.7.83.42
m.root-servers.net.   3600000 IN  AAAA    2001:dc3::35
m.root-servers.net.   3600000 IN  A       202.12.27.33
root-servers.net.     3600000 IN  SOA     a.root-servers.net. (
    nstld.verisign-grs.com. 2018091100 14400 7200 1209600 3600000 )
root-servers.net.     3600000 IN  ZONEMD  2018091100 1 1 (
    f1ca0ccd91bd5573d9f431c00ee0101b2545c97602be0a97
    8a3b11dbfc1c776d5b3e86ae3d973d6b5349ba7f04340f79 )
```

[¶](#section-a.5-2){.pilcrow}
:::
:::
:::

::: {#Implementation}
::: {#section-appendix.b .section}
## [Appendix B.](#section-appendix.b){.section-number .selfRef} [Implementation Status](#name-implementation-status){.section-name .selfRef} {#name-implementation-status}

This section records the status of known implementations of the protocol
defined by this specification at the time of publication, and is
inspired by the concepts described in RFC
7942.[¶](#section-appendix.b-1){.pilcrow}

Please note that the listing of any individual implementation here does
not imply endorsement by the IETF. Furthermore, no effort has been spent
to verify the information presented here that was supplied by IETF
contributors. This is not intended as, and must not be construed to be,
a catalog of available implementations or their features. Readers are
advised to note that other implementations may
exist.[¶](#section-appendix.b-2){.pilcrow}

::: {#authors-implementation}
::: {#section-b.1 .section}
## [B.1.](#section-b.1){.section-number .selfRef} [Authors\' Implementation](#name-authors-implementation){.section-name .selfRef} {#name-authors-implementation}

The authors have an open-source implementation in C, using the ldns
library (\[[LDNS-ZONE-DIGEST](#LDNS-ZONE-DIGEST){.xref}\]). This
implementation is able to perform the following
functions:[¶](#section-b.1-1){.pilcrow}

-   [Read an input zone and output a zone with the ZONEMD
    placeholder.[¶](#section-b.1-2.1){.pilcrow}]{#section-b.1-2.1}
-   [Compute the zone digest over the signed zone and update the ZONEMD
    record.[¶](#section-b.1-2.2){.pilcrow}]{#section-b.1-2.2}
-   [Recompute DNSSEC signatures over the ZONEMD
    record.[¶](#section-b.1-2.3){.pilcrow}]{#section-b.1-2.3}
-   [Verify the zone digest from an input
    zone.[¶](#section-b.1-2.4){.pilcrow}]{#section-b.1-2.4}

This implementation does not:[¶](#section-b.1-3){.pilcrow}

-   [Perform DNSSEC validation of the ZONEMD record during
    verification.[¶](#section-b.1-4.1){.pilcrow}]{#section-b.1-4.1}
:::
:::

::: {#section-b.2 .section}
## [B.2.](#section-b.2){.section-number .selfRef} [Shane Kerr\'s Implementation](#name-shane-kerrs-implementation){.section-name .selfRef} {#name-shane-kerrs-implementation}

[Shane Kerr]{.contact-name} wrote an implementation of this
specification during the IETF 102 hackathon
(\[[ZONE-DIGEST-HACKATHON](#ZONE-DIGEST-HACKATHON){.xref}\]). This
implementation is in Python and is able to perform the following
functions:[¶](#section-b.2-1){.pilcrow}

-   [Read an input zone and output a zone with ZONEMD
    record.[¶](#section-b.2-2.1){.pilcrow}]{#section-b.2-2.1}
-   [Verify the zone digest from an input
    zone.[¶](#section-b.2-2.2){.pilcrow}]{#section-b.2-2.2}
-   [Output the ZONEMD record in its defined presentation
    format.[¶](#section-b.2-2.3){.pilcrow}]{#section-b.2-2.3}

This implementation does not:[¶](#section-b.2-3){.pilcrow}

-   [Recompute DNSSEC signatures over the ZONEMD
    record.[¶](#section-b.2-4.1){.pilcrow}]{#section-b.2-4.1}
-   [Perform DNSSEC validation of the ZONEMD
    record.[¶](#section-b.2-4.2){.pilcrow}]{#section-b.2-4.2}
:::

::: {#section-b.3 .section}
## [B.3.](#section-b.3){.section-number .selfRef} [NIC Chile Lab\'s Implementation](#name-nic-chile-labs-implementati){.section-name .selfRef} {#name-nic-chile-labs-implementati}

NIC Chile Labs wrote an implementation of this specification as part of
\"dns-tools\" suite (\[[DNS-TOOLS](#DNS-TOOLS){.xref}\]), which besides
digesting, can also sign and verify zones. This implementation is in Go
and is able to perform the following
functions:[¶](#section-b.3-1){.pilcrow}

-   [Compute zone digest over signed zone and update the ZONEMD
    record.[¶](#section-b.3-2.1){.pilcrow}]{#section-b.3-2.1}
-   [Verify the zone digest from an input
    zone.[¶](#section-b.3-2.2){.pilcrow}]{#section-b.3-2.2}
-   [Perform DNSSEC validation of the ZONEMD record during
    verification.[¶](#section-b.3-2.3){.pilcrow}]{#section-b.3-2.3}
-   [Recompute DNSSEC signatures over the ZONEMD
    record.[¶](#section-b.3-2.4){.pilcrow}]{#section-b.3-2.4}
:::
:::
:::

::: {#acknowledgments}
::: {#section-appendix.c .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors wish to thank [David Blacka]{.contact-name}, [Scott
Hollenbeck]{.contact-name}, and [Rick Wilhelm]{.contact-name} for
providing feedback on early drafts of this document. Additionally, they
thank [Joe Abley]{.contact-name}, [Mark Andrews]{.contact-name}, [Ralph
Dolmans]{.contact-name}, [Donald Eastlake 3rd]{.contact-name}, [Richard
Gibson]{.contact-name}, [Olafur Gudmundsson]{.contact-name}, [Bob
Harold]{.contact-name}, [Paul Hoffman]{.contact-name}, [Evan
Hunt]{.contact-name}, [Shumon Huque]{.contact-name}, [Tatuya
Jinmei]{.contact-name}, [Mike St. Johns]{.contact-name}, [Burt
Kaliski]{.contact-name}, [Shane Kerr]{.contact-name}, [Matt
Larson]{.contact-name}, [Barry Leiba]{.contact-name}, [John
Levine]{.contact-name}, [Ed Lewis]{.contact-name}, [Matt
Pounsett]{.contact-name}, [Mukund Sivaraman]{.contact-name}, [Petr
Spacek]{.contact-name}, [Ondrej Sury]{.contact-name}, [Willem
Toorop]{.contact-name}, [Florian Weimer]{.contact-name}, [Tim
Wicinski]{.contact-name}, [Wouter Wijngaards]{.contact-name}, [Paul
Wouters]{.contact-name}, and other members of the DNSOP Working Group
for their input.[¶](#section-appendix.c-1){.pilcrow}

The authors would again like to thank [Tim Wicinski]{.contact-name}, who
served as the Document Shepherd for this
document.[¶](#section-appendix.c-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.d .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Duane Wessels]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Verisign]{.org}
:::

::: {.left dir="auto"}
[12061 Bluemont Way]{.street-address}
:::

::: {.left dir="auto"}
[Reston]{.locality}, [VA]{.region} [20190]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 703 948-3200](tel:+1%20703%20948-3200){.tel}
:::

::: email
Email: <dwessels@verisign.com>
:::

::: url
URI: <https://verisign.com>
:::

::: {.left dir="auto"}
[Piet Barber]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Verisign]{.org}
:::

::: {.left dir="auto"}
[12061 Bluemont Way]{.street-address}
:::

::: {.left dir="auto"}
[Reston]{.locality}, [VA]{.region} [20190]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 703 948-3200](tel:+1%20703%20948-3200){.tel}
:::

::: email
Email: <pbarber@verisign.com>
:::

::: url
URI: <https://verisign.com>
:::

::: {.left dir="auto"}
[Matt Weinberg]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Amazon]{.org}
:::

::: email
Email: <matweinb@amazon.com>
:::

::: url
URI: <https://amazon.com>
:::

::: {.left dir="auto"}
[Warren Kumari]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Google]{.org}
:::

::: {.left dir="auto"}
[1600 Amphitheatre Parkway]{.street-address}
:::

::: {.left dir="auto"}
[Mountain View]{.locality}, [CA]{.region} [94043]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <warren@kumari.net>
:::

::: {.left dir="auto"}
[Wes Hardaker]{.fn .nameRole}
:::

::: {.left dir="auto"}
[USC/ISI]{.org}
:::

::: {.left dir="auto"}
[P.O. Box 382]{.street-address}
:::

::: {.left dir="auto"}
[Davis]{.locality}, [CA]{.region} [95617]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <ietf@hardakers.net>
:::
:::
:::
