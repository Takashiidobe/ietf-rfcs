  RFC 9048        EAP-AKA\'       October 2021
  --------------- --------------- --------------
  Arkko, et al.   Informational   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9048](https://www.rfc-editor.org/rfc/rfc9048){.eref}

Updates:
:   [4187](https://www.rfc-editor.org/rfc/rfc4187){.eref},
    [5448](https://www.rfc-editor.org/rfc/rfc5448){.eref}

Category:
:   Informational

Published:
:   October 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    J. Arkko
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    V. Lehtovirta
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    V. Torvinen
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    P. Eronen
    :::

    ::: org
    Independent
    :::
    :::
:::

# RFC 9048 {#rfcnum}

# Improved Extensible Authentication Protocol Method for 3GPP Mobile Network Authentication and Key Agreement (EAP-AKA\') {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The 3GPP mobile network Authentication and Key Agreement (AKA) is an
authentication mechanism for devices wishing to access mobile networks.
RFC 4187 (EAP-AKA) made the use of this mechanism possible within the
Extensible Authentication Protocol (EAP) framework. RFC 5448 (EAP-AKA\')
was an improved version of EAP-AKA.[¶](#section-abstract-1){.pilcrow}

This document is the most recent specification of EAP-AKA\', including,
for instance, details about and references related to operating
EAP-AKA\' in 5G networks.[¶](#section-abstract-2){.pilcrow}

EAP-AKA\' differs from EAP-AKA by providing a key derivation function
that binds the keys derived within the method to the name of the access
network. The key derivation function has been defined in the 3rd
Generation Partnership Project (3GPP). EAP-AKA\' allows its use in EAP
in an interoperable manner. EAP-AKA\' also updates the algorithm used in
hash functions, as it employs SHA-256 / HMAC-SHA-256 instead of SHA-1 /
HMAC-SHA-1, which is used in EAP-AKA.[¶](#section-abstract-3){.pilcrow}

This version of the EAP-AKA\' specification defines the protocol
behavior for both 4G and 5G deployments, whereas the previous version
defined protocol behavior for 4G deployments only. While EAP-AKA\' as
defined in RFC 5448 is not obsolete, this document defines the most
recent and fully backwards-compatible specification of EAP-AKA\'. This
document updates both RFCs 4187 and
5448.[¶](#section-abstract-4){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Not all documents approved
by the IESG are candidates for any level of Internet Standard; see
Section 2 of RFC 7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9048>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Requirements
    Language](#name-requirements-language){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [EAP-AKA\'](#name-eap-aka){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [AT_KDF_INPUT](#name-at_kdf_input){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [AT_KDF](#name-at_kdf){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Key
        Derivation](#name-key-derivation){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Hash
        Functions](#name-hash-functions){.xref}

        -   ::: {#section-toc.1-1.3.2.4.2.1}
            [3.4.1](#section-3.4.1){.xref}.  [PRF\'](#name-prf){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.4.2.2}
            [3.4.2](#section-3.4.2){.xref}.  [AT_MAC](#name-at_mac){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.4.2.3}
            [3.4.3](#section-3.4.3){.xref}.  [AT_CHECKCODE](#name-at_checkcode){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Summary of Attributes for
        EAP-AKA\'](#name-summary-of-attributes-for-e){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Bidding Down Prevention for
    EAP-AKA](#name-bidding-down-prevention-for){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Summary of Attributes for
        EAP-AKA](#name-summary-of-attributes-for-ea){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Peer
    Identities](#name-peer-identities){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Username Types in EAP-AKA\'
        Identities](#name-username-types-in-eap-aka-i){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Generating Pseudonyms and Fast
        Re-Authentication
        Identities](#name-generating-pseudonyms-and-f){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Identifier Usage in
        5G](#name-identifier-usage-in-5g){.xref}

        -   ::: {#section-toc.1-1.5.2.3.2.1}
            [5.3.1](#section-5.3.1){.xref}.  [Key
            Derivation](#name-key-derivation-2){.xref}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.2}
            [5.3.2](#section-5.3.2){.xref}.  [EAP Identity Response and
            EAP-AKA\' AT_IDENTITY
            Attribute](#name-eap-identity-response-and-e){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Exported
    Parameters](#name-exported-parameters){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Privacy](#name-privacy){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Discovered
        Vulnerabilities](#name-discovered-vulnerabilities){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Pervasive
        Monitoring](#name-pervasive-monitoring){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [Security Properties of Binding
        Network Names](#name-security-properties-of-bind){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Type
        Value](#name-type-value){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Attribute Type
        Values](#name-attribute-type-values){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [Key Derivation Function
        Namespace](#name-key-derivation-function-nam){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix A](#appendix-A){.xref}.  [Changes from RFC
    5448](#name-changes-from-rfc-5448){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix B](#appendix-B){.xref}.  [Changes to RFC
    4187](#name-changes-to-rfc-4187){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix C](#appendix-C){.xref}.  [Importance of Explicit
    Negotiation](#name-importance-of-explicit-nego){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [Appendix D](#appendix-D){.xref}.  [Test
    Vectors](#name-test-vectors){.xref}
    :::

-   ::: {#section-toc.1-1.14}
    [](#appendix-E){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [](#appendix-F){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.16}
    [](#appendix-G){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The 3GPP mobile network Authentication and Key Agreement (AKA) is an
authentication mechanism for devices wishing to access mobile networks.
\[[RFC4187](#RFC4187){.xref}\] (EAP-AKA) made the use of this mechanism
possible within the Extensible Authentication Protocol (EAP) framework
\[[RFC3748](#RFC3748){.xref}\].[¶](#section-1-1){.pilcrow}

EAP-AKA\' is an improved version of EAP-AKA. EAP-AKA\' was defined in
RFC 5448 \[[RFC5448](#RFC5448){.xref}\], and it updated EAP-AKA
\[[RFC4187](#RFC4187){.xref}\].[¶](#section-1-2){.pilcrow}

This document is the most recent specification of EAP-AKA\', including,
for instance, details about and references related to operating
EAP-AKA\' in 5G networks. This document does not obsolete RFC 5448;
however, this document is the most recent and fully backwards-compatible
specification.[¶](#section-1-3){.pilcrow}

EAP-AKA\' is commonly implemented in mobile phones and network
equipment. It can be used for authentication to gain network access via
Wireless LAN networks and, with 5G, also directly to mobile
networks.[¶](#section-1-4){.pilcrow}

EAP-AKA\' differs from EAP-AKA by providing a different key derivation
function. This function binds the keys derived within the method to the
name of the access network. This limits the effects of compromised
access network nodes and keys. EAP-AKA\' also updates the algorithm used
for hash functions.[¶](#section-1-5){.pilcrow}

The EAP-AKA\' method employs the derived keys CK\' and IK\' from the
3GPP specification \[[TS-3GPP.33.402](#TS-3GPP.33.402){.xref}\] and
updates the hash function that is used to SHA-256
\[[FIPS.180-4](#FIPS.180-4){.xref}\] and HMAC to HMAC-SHA-256.
Otherwise, EAP-AKA\' is equivalent to EAP-AKA. Given that a different
EAP method Type value is used for EAP-AKA and EAP-AKA\', a mutually
supported method may be negotiated using the standard mechanisms in EAP
\[[RFC3748](#RFC3748){.xref}\].[¶](#section-1-6){.pilcrow}

Note that any change of the key derivation must be unambiguous to both
sides in the protocol. That is, it must not be possible to accidentally
connect old equipment to new equipment and get the key derivation wrong
or to attempt to use incorrect keys without getting a proper error
message. See [Appendix C](#baddesign){.xref} for further
information.[¶](#section-1-7){.pilcrow}

Note also that choices in authentication protocols should be secure
against bidding down attacks that attempt to force the participants to
use the least secure function. See [Section 4](#bidding){.xref} for
further information.[¶](#section-1-8){.pilcrow}

This specification makes the following changes from RFC
5448:[¶](#section-1-9){.pilcrow}

-   [Updates the reference that specifies how the Network Name field is
    constructed in the protocol. This update ensures that EAP-AKA\' is
    compatible with 5G deployments. RFC 5448 referred to the Release 8
    version of \[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\]. This
    document points to the first 5G version, Release
    16.[¶](#section-1-10.1){.pilcrow}]{#section-1-10.1}
-   [Specifies how EAP and EAP-AKA\' use identifiers in 5G. Additional
    identifiers are introduced in 5G, and for interoperability, it is
    necessary that the right identifiers are used as inputs in the key
    derivation. In addition, for identity privacy it is important that
    when privacy-friendly identifiers in 5G are used, no trackable,
    permanent identifiers are passed in EAP-AKA\',
    either.[¶](#section-1-10.2){.pilcrow}]{#section-1-10.2}
-   [Specifies session identifiers and other exported parameters, as
    those were not specified in \[[RFC5448](#RFC5448){.xref}\] despite
    requirements set forward in \[[RFC5247](#RFC5247){.xref}\] to do so.
    Also, while \[[RFC5247](#RFC5247){.xref}\] specified session
    identifiers for EAP-AKA, it only did so for the full authentication
    case, not for the case of fast
    re-authentication.[¶](#section-1-10.3){.pilcrow}]{#section-1-10.3}
-   [Updates the requirements on generating pseudonym usernames and fast
    re-authentication identities to ensure identity
    privacy.[¶](#section-1-10.4){.pilcrow}]{#section-1-10.4}
-   [Describes what has been learned about any vulnerabilities in AKA or
    EAP-AKA\'.[¶](#section-1-10.5){.pilcrow}]{#section-1-10.5}
-   [Describes the privacy and pervasive monitoring considerations
    related to
    EAP-AKA\'.[¶](#section-1-10.6){.pilcrow}]{#section-1-10.6}
-   [Adds summaries of the
    attributes.[¶](#section-1-10.7){.pilcrow}]{#section-1-10.7}

Some of the updates are small. For instance, the reference update to
\[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\] does not change the 3GPP
specification number, only the version. But this reference is crucial
for the correct calculation of the keys that result from running the
EAP-AKA\' method, so an RFC update pointing to the newest version was
warranted.[¶](#section-1-11){.pilcrow}

Note: Any further updates in 3GPP specifications that affect, for
instance, key derivation is something that EAP-AKA\' implementations
need to take into account. Upon such updates, there will be a need to
update both this specification and the
implementations.[¶](#section-1-12){.pilcrow}

It is an explicit non-goal of this specification to include any other
technical modifications, addition of new features, or other changes. The
EAP-AKA\' base protocol is stable and needs to stay that way. If there
are any extensions or variants, those need to be proposed as standalone
extensions or even as different authentication
methods.[¶](#section-1-13){.pilcrow}

The rest of this specification is structured as follows. [Section
3](#prime){.xref} defines the EAP-AKA\' method. [Section
4](#bidding){.xref} adds support to EAP-AKA to prevent bidding down
attacks from EAP-AKA\'. [Section 5](#identities){.xref} specifies
requirements regarding the use of peer identities, including how 5G
identifiers are used in the EAP-AKA\' context. [Section
6](#exported-parameters){.xref} specifies which parameters EAP-AKA\'
exports out of the method. [Section 7](#security){.xref} explains the
security differences between EAP-AKA and EAP-AKA\'. [Section
8](#iana){.xref} describes the IANA considerations, and [Appendix
A](#diff2){.xref} and [Appendix B](#diff){.xref} explain the updates to
RFC 5448 (EAP-AKA\') and RFC 4187 (EAP-AKA) that have been made in this
specification. [Appendix C](#baddesign){.xref} explains some of the
design rationale for creating EAP-AKA\'. Finally, [Appendix
D](#testvectors){.xref} provides test
vectors.[¶](#section-1-14){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::

::: {#prime}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [EAP-AKA\'](#name-eap-aka){.section-name .selfRef} {#name-eap-aka}

EAP-AKA\' is an EAP method that follows the EAP-AKA specification
\[[RFC4187](#RFC4187){.xref}\] in all respects except the
following:[¶](#section-3-1){.pilcrow}

-   [It uses the Type code 0x32, not 0x17 (which is used by
    EAP-AKA).[¶](#section-3-2.1){.pilcrow}]{#section-3-2.1}
-   [It carries the AT_KDF_INPUT attribute, as defined in [Section
    3.1](#netbind){.xref}, to ensure that both the peer and server know
    the name of the access
    network.[¶](#section-3-2.2){.pilcrow}]{#section-3-2.2}
-   [It supports key derivation function negotiation via the AT_KDF
    attribute ([Section 3.2](#keyderiv){.xref}) to allow for future
    extensions.[¶](#section-3-2.3){.pilcrow}]{#section-3-2.3}
-   [It calculates keys as defined in [Section 3.3](#key){.xref}, not as
    defined in EAP-AKA.[¶](#section-3-2.4){.pilcrow}]{#section-3-2.4}
-   [It employs SHA-256 / HMAC-SHA-256
    \[[FIPS.180-4](#FIPS.180-4){.xref}\], not SHA-1 / HMAC-SHA-1
    \[[RFC2104](#RFC2104){.xref}\] (see [Section
    3.4](#hashup){.xref}).[¶](#section-3-2.5){.pilcrow}]{#section-3-2.5}

[Figure 1](#EAP-fig){.xref} shows an example of the authentication
process. Each message AKA\'-Challenge and so on represents the
corresponding message from EAP-AKA, but with the EAP-AKA\' Type code.
The definition of these messages, along with the definition of
attributes AT_RAND, AT_AUTN, AT_MAC, and AT_RES can be found in
\[[RFC4187](#RFC4187){.xref}\].[¶](#section-3-3){.pilcrow}

[]{#name-eap-aka-authentication-proc}

::: {#EAP-fig}
::: {#section-3-4.1 .alignLeft .art-text .artwork}
     Peer                                                    Server
        |                       EAP-Request/Identity             |
        |<-------------------------------------------------------|
        |                                                        |
        |  EAP-Response/Identity                                 |
        |  (Includes user's Network Access Identifier, NAI)      |
        |------------------------------------------------------->|
        |         +--------------------------------------------------+
        |         | Server determines the network name and ensures   |
        |         | that the given access network is authorized to   |
        |         | use the claimed name.  The server then runs the  |
        |         | AKA' algorithms generating RAND and AUTN, and    |
        |         | derives session keys from CK' and IK'.  RAND and |
        |         | AUTN are sent as AT_RAND and AT_AUTN attributes, |
        |         | whereas the network name is transported in the   |
        |         | AT_KDF_INPUT attribute.  AT_KDF signals the used |
        |         | key derivation function.  The session keys are   |
        |         | used in creating the AT_MAC attribute.           |
        |         +--------------------------------------------------+
        |                         EAP-Request/AKA'-Challenge     |
        |        (AT_RAND, AT_AUTN, AT_KDF, AT_KDF_INPUT, AT_MAC)|
        |<-------------------------------------------------------|
    +------------------------------------------------------+     |
    | The peer determines what the network name should be, |     |
    | based on, e.g., what access technology it is using.  |     |
    | The peer also retrieves the network name sent by     |     |
    | the network from the AT_KDF_INPUT attribute.  The    |     |
    | two names are compared for discrepancies, and if     |     |
    | necessary, the authentication is aborted.  Otherwise,|     |
    | the network name from AT_KDF_INPUT attribute is      |     |
    | used in running the AKA' algorithms, verifying AUTN  |     |
    | from AT_AUTN and MAC from AT_MAC attributes.  The    |     |
    | peer then generates RES.  The peer also derives      |     |
    | session keys from CK'/IK'.  The AT_RES and AT_MAC    |     |
    | attributes are constructed.                          |     |
    +------------------------------------------------------+     |
        | EAP-Response/AKA'-Challenge                            |
        | (AT_RES, AT_MAC)                                       |
        |------------------------------------------------------->|
        |         +--------------------------------------------------+
        |         | Server checks the RES and MAC values received    |
        |         | in AT_RES and AT_MAC, respectively.  Success     |
        |         | requires both to be found correct.               |
        |         +--------------------------------------------------+
        |                                           EAP-Success  |
        |<-------------------------------------------------------|
:::

[Figure 1](#figure-1){.selfRef}: [EAP-AKA\' Authentication
Process](#name-eap-aka-authentication-proc){.selfRef}
:::

EAP-AKA\' can operate on the same credentials as EAP-AKA and employ the
same identities. However, EAP-AKA\' employs different leading characters
than EAP-AKA for the conventions given in [Section
4.1.1](https://www.rfc-editor.org/rfc/rfc4187#section-4.1.1){.relref} of
\[[RFC4187](#RFC4187){.xref}\] for usernames based on International
Mobile Subscriber Identifier (IMSI). For 4G networks, EAP-AKA\'
[MUST]{.bcp14} use the leading character \"6\" (ASCII 36 hexadecimal)
instead of \"0\" for IMSI-based permanent usernames. For 5G networks,
the leading character \"6\" is not used for IMSI-based permanent
usernames. Identifier usage in 5G is specified in [Section
5.3](#identifiersin5g){.xref}. All other usage and processing of the
leading characters, usernames, and identities is as defined by EAP-AKA
\[[RFC4187](#RFC4187){.xref}\]. For instance, the pseudonym and fast
re-authentication usernames need to be constructed so that the server
can recognize them. As an example, a pseudonym could begin with a
leading \"7\" character (ASCII 37 hexadecimal) and a fast
re-authentication username could begin with \"8\" (ASCII 38
hexadecimal). Note that a server that implements only EAP-AKA may not
recognize these leading characters. According to [Section
4.1.4](https://www.rfc-editor.org/rfc/rfc4187#section-4.1.4){.relref} of
\[[RFC4187](#RFC4187){.xref}\], such a server will re-request the
identity via the EAP-Request/AKA-Identity message, making obvious to the
peer that EAP-AKA and associated identity are
expected.[¶](#section-3-5){.pilcrow}

::: {#netbind}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [AT_KDF_INPUT](#name-at_kdf_input){.section-name .selfRef} {#name-at_kdf_input}

The format of the AT_KDF_INPUT attribute is shown
below.[¶](#section-3.1-1){.pilcrow}

::: {#section-3.1-2 .alignLeft .art-text .artwork}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | AT_KDF_INPUT  | Length        | Actual Network Name Length    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                        Network Name                           .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-3.1-2){.pilcrow}
:::

The fields are as follows:[¶](#section-3.1-3){.pilcrow}

[]{.break}

AT_KDF_INPUT
:   This is set to 23.[¶](#section-3.1-4.2){.pilcrow}
:   

Length
:   The length of the attribute, calculated as defined in
    \[[RFC4187](#RFC4187){.xref}\], [Section
    8.1](https://www.rfc-editor.org/rfc/rfc4187#section-8.1){.relref}.[¶](#section-3.1-4.4){.pilcrow}
:   

Actual Network Name Length
:   This is a 2-byte actual length field, needed due to the requirement
    that the previous field is expressed in multiples of 4 bytes per the
    usual EAP-AKA rules. The Actual Network Name Length field provides
    the length of the network name in
    bytes.[¶](#section-3.1-4.6){.pilcrow}
:   

Network Name
:   This field contains the network name of the access network for which
    the authentication is being performed. The name does not include any
    terminating null characters. Because the length of the entire
    attribute must be a multiple of 4 bytes, the sender pads the name
    with 1, 2, or 3 bytes of all zero bits when
    necessary.[¶](#section-3.1-4.8){.pilcrow}
:   

Only the server sends the AT_KDF_INPUT attribute. The value is sent as
specified in \[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\] for both
non-3GPP access networks and for 5G access networks. Per
\[[TS-3GPP.33.402](#TS-3GPP.33.402){.xref}\], the server always verifies
the authorization of a given access network to use a particular name
before sending it to the peer over EAP-AKA\'. The value of the
AT_KDF_INPUT attribute from the server [MUST]{.bcp14} be non-empty, with
a greater than zero length in the Actual Network Name Length field. If
the AT_KDF_INPUT attribute is empty, the peer behaves as if AUTN had
been incorrect and authentication fails. See Section
[3](https://www.rfc-editor.org/rfc/rfc4187#section-3){.relref} and
Figure 3 of \[[RFC4187](#RFC4187){.xref}\] for an overview of how
authentication failures are handled.[¶](#section-3.1-5){.pilcrow}

In addition, the peer [MAY]{.bcp14} check the received value against its
own understanding of the network name. Upon detecting a discrepancy, the
peer either warns the user and continues, or fails the authentication
process. More specifically, the peer [SHOULD]{.bcp14} have a
configurable policy that it can follow under these circumstances. If the
policy indicates that it can continue, the peer [SHOULD]{.bcp14} log a
warning message or display it to the user. If the peer chooses to
proceed, it [MUST]{.bcp14} use the network name as received in the
AT_KDF_INPUT attribute. If the policy indicates that the authentication
should fail, the peer behaves as if AUTN had been incorrect and
authentication fails.[¶](#section-3.1-6){.pilcrow}

The Network Name field contains a UTF-8 string. This string
[MUST]{.bcp14} be constructed as specified in
\[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\] for \"Access Network
Identity\". The string is structured as fields separated by colons (:).
The algorithms and mechanisms to construct the identity string depend on
the used access technology.[¶](#section-3.1-7){.pilcrow}

On the network side, the network name construction is a configuration
issue in an access network and an authorization check in the
authentication server. On the peer, the network name is constructed
based on the local observations. For instance, the peer knows which
access technology it is using on the link, it can see information in a
link-layer beacon, and so on. The construction rules specify how this
information maps to an access network name. Typically, the network name
consists of the name of the access technology or the name of the access
technology followed by some operator identifier that was advertised in a
link-layer beacon. In all cases,
\[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\] is the normative
specification for the construction in both the network and peer side. If
the peer policy allows running EAP-AKA\' over an access technology for
which that specification does not provide network name construction
rules, the peer [SHOULD]{.bcp14} rely only on the information from the
AT_KDF_INPUT attribute and not perform a
comparison.[¶](#section-3.1-8){.pilcrow}

If a comparison of the locally determined network name and the one
received over EAP-AKA\' is performed on the peer, it [MUST]{.bcp14} be
done as follows. First, each name is broken down to the fields separated
by colons. If one of the names has more colons and fields than the other
one, the additional fields are ignored. The remaining sequences of
fields are compared, and they match only if they are equal character by
character. This algorithm allows a prefix match where the peer would be
able to match \"\", \"FOO\", and \"FOO:BAR\" against the value
\"FOO:BAR\" received from the server. This capability is important in
order to allow possible updates to the specifications that dictate how
the network names are constructed. For instance, if a peer knows that it
is running on access technology \"FOO\", it can use the string \"FOO\"
even if the server uses an additional, more accurate description, e.g.,
\"FOO:BAR\", that contains more
information.[¶](#section-3.1-9){.pilcrow}

The allocation procedures in
\[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\] ensure that conflicts
potentially arising from using the same name in different types of
networks are avoided. The specification also has detailed rules about
how a client can determine these based on information available to the
client, such as the type of protocol used to attach to the network,
beacons sent out by the network, and so on. Information that the client
cannot directly observe (such as the type or version of the home
network) is not used by this algorithm.[¶](#section-3.1-10){.pilcrow}

The AT_KDF_INPUT attribute [MUST]{.bcp14} be sent and processed as
explained above when AT_KDF attribute has the value 1. Future
definitions of new AT_KDF values [MUST]{.bcp14} define how this
attribute is sent and processed.[¶](#section-3.1-11){.pilcrow}
:::
:::

::: {#keyderiv}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [AT_KDF](#name-at_kdf){.section-name .selfRef} {#name-at_kdf}

AT_KDF is an attribute that the server uses to reference a specific key
derivation function. It offers a negotiation capability that can be
useful for future evolution of the key derivation
functions.[¶](#section-3.2-1){.pilcrow}

The format of the AT_KDF attribute is shown
below.[¶](#section-3.2-2){.pilcrow}

::: {#section-3.2-3 .alignLeft .art-text .artwork}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | AT_KDF        | Length        |    Key Derivation Function    |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-3.2-3){.pilcrow}
:::

The fields are as follows:[¶](#section-3.2-4){.pilcrow}

[]{.break}

AT_KDF
:   This is set to 24.[¶](#section-3.2-5.2){.pilcrow}
:   

Length
:   The length of the attribute, calculated as defined in
    \[[RFC4187](#RFC4187){.xref}\], [Section
    8.1](https://www.rfc-editor.org/rfc/rfc4187#section-8.1){.relref}.
    For AT_KDF, the Length field [MUST]{.bcp14} be set to
    1.[¶](#section-3.2-5.4){.pilcrow}
:   

Key Derivation Function
:   An enumerated value representing the key derivation function that
    the server (or peer) wishes to use. Value 1 represents the default
    key derivation function for EAP-AKA\', i.e., employing CK\' and IK\'
    as defined in [Section
    3.3](#key){.xref}.[¶](#section-3.2-5.6){.pilcrow}
:   

Servers [MUST]{.bcp14} send one or more AT_KDF attributes in the
EAP-Request/AKA\'-Challenge message. These attributes represent the
desired functions ordered by preference, the most preferred function
being the first attribute.[¶](#section-3.2-6){.pilcrow}

Upon receiving a set of these attributes, if the peer supports and is
willing to use the key derivation function indicated by the first
attribute, the function is taken into use without any further
negotiation. However, if the peer does not support this function or is
unwilling to use it, it does not process the received
EAP-Request/AKA\'-Challenge in any way except by responding with the
EAP-Response/AKA\'-Challenge message that contains only one attribute,
AT_KDF with the value set to the selected alternative. If there is no
suitable alternative, the peer behaves as if AUTN had been incorrect and
authentication fails (see Figure 3 of \[[RFC4187](#RFC4187){.xref}\]).
The peer fails the authentication also if there are any duplicate values
within the list of AT_KDF attributes (except where the duplication is
due to a request to change the key derivation function; see below for
further information).[¶](#section-3.2-7){.pilcrow}

Upon receiving an EAP-Response/AKA\'-Challenge with AT_KDF from the
peer, the server checks that the suggested AT_KDF value was one of the
alternatives in its offer. The first AT_KDF value in the message from
the server is not a valid alternative since the peer should have
accepted it without further negotiation. If the peer has replied with
the first AT_KDF value, the server behaves as if AT_MAC of the response
had been incorrect and fails the authentication. For an overview of the
failed authentication process in the server side, see Section
[3](https://www.rfc-editor.org/rfc/rfc4187#section-3){.relref} and
Figure 2 of \[[RFC4187](#RFC4187){.xref}\]. Otherwise, the server
re-sends the EAP-Response/AKA\'-Challenge message, but adds the selected
alternative to the beginning of the list of AT_KDF attributes and
retains the entire list following it. Note that this means that the
selected alternative appears twice in the set of AT_KDF values.
Responding to the peer\'s request to change the key derivation function
is the only legal situation where such duplication may
occur.[¶](#section-3.2-8){.pilcrow}

When the peer receives the new EAP-Request/AKA\'-Challenge message, it
[MUST]{.bcp14} check that the requested change, and only the requested
change, occurred in the list of AT_KDF attributes. If so, it continues
with processing the received EAP-Request/AKA\'-Challenge as specified in
\[[RFC4187](#RFC4187){.xref}\] and [Section 3.1](#netbind){.xref} of
this document. If not, it behaves as if AT_MAC had been incorrect and
fails the authentication. If the peer receives multiple
EAP-Request/AKA\'-Challenge messages with differing AT_KDF attributes
without having requested negotiation, the peer [MUST]{.bcp14} behave as
if AT_MAC had been incorrect and fail the
authentication.[¶](#section-3.2-9){.pilcrow}

Note that the peer may also request sequence number resynchronization
\[[RFC4187](#RFC4187){.xref}\]. This happens after AT_KDF negotiation
has already completed. That is, the EAP-Request/AKA\'-Challenge and,
possibly, the EAP-Response/AKA\'-Challenge messages are exchanged first
to determine a mutually acceptable key derivation function, and only
then is the possible AKA\'-Synchronization-Failure message sent. The
AKA\'-Synchronization-Failure message is sent as a response to the newly
received EAP-Request/AKA\'-Challenge, which is the last message of the
AT_KDF negotiation. Note that if the first proposed KDF is acceptable,
then the first EAP-Request/AKA\'-Challenge message is also the last
message. The AKA\'-Synchronization-Failure message [MUST]{.bcp14}
contain the AUTS parameter as specified in
\[[RFC4187](#RFC4187){.xref}\] and a copy the AT_KDF attributes as they
appeared in the last message of the AT_KDF negotiation. If the AT_KDF
attributes are found to differ from their earlier values, the peer and
server [MUST]{.bcp14} behave as if AT_MAC had been incorrect and fail
the authentication.[¶](#section-3.2-10){.pilcrow}
:::
:::

::: {#key}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Key Derivation](#name-key-derivation){.section-name .selfRef} {#name-key-derivation}

Both the peer and server [MUST]{.bcp14} derive the keys as
follows.[¶](#section-3.3-1){.pilcrow}

[]{.break}

AT_KDF parameter has the value 1

:   In this case, MK is derived and used as
    follows:[¶](#section-3.3-2.2.1){.pilcrow}

    ::: {#section-3.3-2.2.2 .alignLeft .art-text .artwork}
            MK = PRF'(IK'|CK',"EAP-AKA'"|Identity)
            K_encr = MK[0..127]
            K_aut  = MK[128..383]
            K_re   = MK[384..639]
            MSK    = MK[640..1151]
            EMSK   = MK[1152..1663]

    [¶](#section-3.3-2.2.2){.pilcrow}
    :::

    Here \[n..m\] denotes the substring from bit n to m, including bits
    n and m. PRF\' is a new pseudorandom function specified in [Section
    3.4](#hashup){.xref}. The first 1664 bits from its output are used
    for K_encr (encryption key, 128 bits), K_aut (authentication key,
    256 bits), K_re (re-authentication key, 256 bits), MSK (Master
    Session Key, 512 bits), and EMSK (Extended Master Session Key, 512
    bits). These keys are used by the subsequent EAP-AKA\' process.
    K_encr is used by the AT_ENCR_DATA attribute, and K_aut by the
    AT_MAC attribute. K_re is used later in this section. MSK and EMSK
    are outputs from a successful EAP method run
    \[[RFC3748](#RFC3748){.xref}\].[¶](#section-3.3-2.2.3){.pilcrow}

    IK\' and CK\' are derived as specified in
    \[[TS-3GPP.33.402](#TS-3GPP.33.402){.xref}\]. The functions that
    derive IK\' and CK\' take the following parameters: CK and IK
    produced by the AKA algorithm, and value of the Network Name field
    comes from the AT_KDF_INPUT attribute (without length or
    padding).[¶](#section-3.3-2.2.4){.pilcrow}

    The value \"EAP-AKA\'\" is an eight-characters-long ASCII string. It
    is used as is, without any trailing NUL
    characters.[¶](#section-3.3-2.2.5){.pilcrow}

    Identity is the peer identity as specified in [Section
    7](https://www.rfc-editor.org/rfc/rfc4187#section-7){.relref} of
    \[[RFC4187](#RFC4187){.xref}\] and in [Section
    5.3.2](#id5guse){.xref} of in this document for the 5G
    cases.[¶](#section-3.3-2.2.6){.pilcrow}

    When the server creates an AKA challenge and corresponding AUTN, CK,
    CK\', IK, and IK\' values, it [MUST]{.bcp14} set the Authentication
    Management Field (AMF) separation bit to 1 in the AKA algorithm
    \[[TS-3GPP.33.102](#TS-3GPP.33.102){.xref}\]. Similarly, the peer
    [MUST]{.bcp14} check that the AMF separation bit is set to 1. If the
    bit is not set to 1, the peer behaves as if the AUTN had been
    incorrect and fails the
    authentication.[¶](#section-3.3-2.2.7){.pilcrow}

    On fast re-authentication, the following keys are
    calculated:[¶](#section-3.3-2.2.8){.pilcrow}

    ::: {#section-3.3-2.2.9 .alignLeft .art-text .artwork}
            MK = PRF'(K_re,"EAP-AKA' re-auth"|Identity|counter|NONCE_S)
            MSK  = MK[0..511]
            EMSK = MK[512..1023]

    [¶](#section-3.3-2.2.9){.pilcrow}
    :::

    MSK and EMSK are the resulting 512-bit keys, taking the first 1024
    bits from the result of PRF\'. Note that K_encr and K_aut are not
    re-derived on fast re-authentication. K_re is the re-authentication
    key from the preceding full authentication and stays unchanged over
    any fast re-authentication(s) that may happen based on it. The value
    \"EAP-AKA\' re-auth\" is a sixteen-characters-long ASCII string,
    again represented without any trailing NUL characters. Identity is
    the fast re-authentication identity, counter is the value from the
    AT_COUNTER attribute, NONCE_S is the nonce value from the AT_NONCE_S
    attribute, all as specified in [Section
    7](https://www.rfc-editor.org/rfc/rfc4187#section-7){.relref} of
    \[[RFC4187](#RFC4187){.xref}\]. To prevent the use of compromised
    keys in other places, it is forbidden to change the network name
    when going from the full to the fast re-authentication process. The
    peer [SHOULD NOT]{.bcp14} attempt fast re-authentication when it
    knows that the network name in the current access network is
    different from the one in the initial, full authentication. Upon
    seeing a re-authentication request with a changed network name, the
    server [SHOULD]{.bcp14} behave as if the re-authentication
    identifier had been unrecognized, and fall back to full
    authentication. The server observes the change in the name by
    comparing where the fast re-authentication and full authentication
    EAP transactions were received at the Authentication, Authorization,
    and Accounting (AAA) protocol
    level.[¶](#section-3.3-2.2.10){.pilcrow}

:   

AT_KDF has any other value
:   Future variations of key derivation functions may be defined, and
    they will be represented by new values of AT_KDF. If the peer does
    not recognize the value, it cannot calculate the keys and behaves as
    explained in [Section
    3.2](#keyderiv){.xref}.[¶](#section-3.3-2.4){.pilcrow}
:   

AT_KDF is missing
:   The peer behaves as if the AUTN had been incorrect and
    [MUST]{.bcp14} fail the
    authentication.[¶](#section-3.3-2.6){.pilcrow}
:   

If the peer supports a given key derivation function but is unwilling to
perform it for policy reasons, it refuses to calculate the keys and
behaves as explained in [Section
3.2](#keyderiv){.xref}.[¶](#section-3.3-3){.pilcrow}
:::
:::

::: {#hashup}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Hash Functions](#name-hash-functions){.section-name .selfRef} {#name-hash-functions}

EAP-AKA\' uses SHA-256 / HMAC-SHA-256, not SHA-1 / HMAC-SHA-1 (see
\[[FIPS.180-4](#FIPS.180-4){.xref}\] and \[[RFC2104](#RFC2104){.xref}\])
as in EAP-AKA. This requires a change to the pseudorandom function (PRF)
as well as the AT_MAC and AT_CHECKCODE
attributes.[¶](#section-3.4-1){.pilcrow}

::: {#section-3.4.1 .section}
#### [3.4.1.](#section-3.4.1){.section-number .selfRef} [PRF\'](#name-prf){.section-name .selfRef} {#name-prf}

The PRF\' construction is the same one IKEv2 uses (see [Section
2.13](https://www.rfc-editor.org/rfc/rfc7296#section-2.13){.relref} of
\[[RFC7296](#RFC7296){.xref}\]; the definition of this function has not
changed since \[[RFC4306](#RFC4306){.xref}\], which was referenced by
\[[RFC5448](#RFC5448){.xref}\]). The function takes two arguments. K is
a 256-bit value and S is a byte string of arbitrary length. PRF\' is
defined as follows:[¶](#section-3.4.1-1){.pilcrow}

::: {#section-3.4.1-2 .alignLeft .art-text .artwork}
    PRF'(K,S) = T1 | T2 | T3 | T4 | ...

       where:
       T1 = HMAC-SHA-256 (K, S | 0x01)
       T2 = HMAC-SHA-256 (K, T1 | S | 0x02)
       T3 = HMAC-SHA-256 (K, T2 | S | 0x03)
       T4 = HMAC-SHA-256 (K, T3 | S | 0x04)
       ...

[¶](#section-3.4.1-2){.pilcrow}
:::

PRF\' produces as many bits of output as is needed. HMAC-SHA-256 is the
application of HMAC \[[RFC2104](#RFC2104){.xref}\] to
SHA-256.[¶](#section-3.4.1-3){.pilcrow}
:::

::: {#section-3.4.2 .section}
#### [3.4.2.](#section-3.4.2){.section-number .selfRef} [AT_MAC](#name-at_mac){.section-name .selfRef} {#name-at_mac}

When used within EAP-AKA\', the AT_MAC attribute is changed as follows.
The MAC algorithm is HMAC-SHA-256-128, a keyed hash value. The
HMAC-SHA-256-128 value is obtained from the 32-byte HMAC-SHA-256 value
by truncating the output to the first 16 bytes. Hence, the length of the
MAC is 16 bytes.[¶](#section-3.4.2-1){.pilcrow}

Otherwise, the use of AT_MAC in EAP-AKA\' follows [Section
10.15](https://www.rfc-editor.org/rfc/rfc4187#section-10.15){.relref} of
\[[RFC4187](#RFC4187){.xref}\].[¶](#section-3.4.2-2){.pilcrow}
:::

::: {#section-3.4.3 .section}
#### [3.4.3.](#section-3.4.3){.section-number .selfRef} [AT_CHECKCODE](#name-at_checkcode){.section-name .selfRef} {#name-at_checkcode}

When used within EAP-AKA\', the AT_CHECKCODE attribute is changed as
follows. First, a 32-byte value is needed to accommodate a 256-bit hash
output:[¶](#section-3.4.3-1){.pilcrow}

::: {#section-3.4.3-2 .alignLeft .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | AT_CHECKCODE  | Length        |           Reserved            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    |                     Checkcode (0 or 32 bytes)                 |
    |                                                               |
    |                                                               |
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-3.4.3-2){.pilcrow}
:::

Second, the checkcode is a hash value, calculated with SHA-256
\[[FIPS.180-4](#FIPS.180-4){.xref}\], over the data specified in
[Section
10.13](https://www.rfc-editor.org/rfc/rfc4187#section-10.13){.relref} of
\[[RFC4187](#RFC4187){.xref}\].[¶](#section-3.4.3-3){.pilcrow}
:::
:::
:::

::: {#attrtable}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Summary of Attributes for EAP-AKA\'](#name-summary-of-attributes-for-e){.section-name .selfRef} {#name-summary-of-attributes-for-e}

[Table 1](#attribute-table){.xref} identifies which attributes may be
found in which kinds of messages, and in what
quantity.[¶](#section-3.5-1){.pilcrow}

Messages are denoted with numbers as
follows:[¶](#section-3.5-2){.pilcrow}

[]{.break}

1
:   EAP-Request/AKA-Identity[¶](#section-3.5-3.2){.pilcrow}
:   

2
:   EAP-Response/AKA-Identity[¶](#section-3.5-3.4){.pilcrow}
:   

3
:   EAP-Request/AKA-Challenge[¶](#section-3.5-3.6){.pilcrow}
:   

4
:   EAP-Response/AKA-Challenge[¶](#section-3.5-3.8){.pilcrow}
:   

5
:   EAP-Request/AKA-Notification[¶](#section-3.5-3.10){.pilcrow}
:   

6
:   EAP-Response/AKA-Notification[¶](#section-3.5-3.12){.pilcrow}
:   

7
:   EAP-Response/AKA-Client-Error[¶](#section-3.5-3.14){.pilcrow}
:   

8
:   EAP-Request/AKA-Reauthentication[¶](#section-3.5-3.16){.pilcrow}
:   

9
:   EAP-Response/AKA-Reauthentication[¶](#section-3.5-3.18){.pilcrow}
:   

10
:   EAP-Response/AKA-Authentication-Reject[¶](#section-3.5-3.20){.pilcrow}
:   

11
:   EAP-Response/AKA-Synchronization-Failure[¶](#section-3.5-3.22){.pilcrow}
:   

The column denoted with \"E\" indicates whether the attribute is a
nested attribute that [MUST]{.bcp14} be included within
AT_ENCR_DATA.[¶](#section-3.5-4){.pilcrow}

In addition, the numbered columns indicate the quantity of the attribute
within the message as follows:[¶](#section-3.5-5){.pilcrow}

[]{.break}

\"0\"
:   Indicates that the attribute [MUST NOT]{.bcp14} be included in the
    message.[¶](#section-3.5-6.2){.pilcrow}
:   

\"1\"
:   Indicates that the attribute [MUST]{.bcp14} be included in the
    message.[¶](#section-3.5-6.4){.pilcrow}
:   

\"0-1\"
:   Indicates that the attribute is sometimes included in the
    message[¶](#section-3.5-6.6){.pilcrow}
:   

\"0+\"
:   Indicates that zero or more copies of the attribute [MAY]{.bcp14} be
    included in the message.[¶](#section-3.5-6.8){.pilcrow}
:   

\"1+\"
:   Indicates that there [MUST]{.bcp14} be at least one attribute in the
    message but more than one [MAY]{.bcp14} be included in the
    message.[¶](#section-3.5-6.10){.pilcrow}
:   

\"0\*\"
:   Indicates that the attribute is not included in the message in cases
    specified in this document, but [MAY]{.bcp14} be included in the
    future versions of the protocol.[¶](#section-3.5-6.12){.pilcrow}
:   

The attribute table is shown below. The table is largely the same as in
the EAP-AKA attribute table (\[[RFC4187](#RFC4187){.xref}\], [Section
10.1](https://www.rfc-editor.org/rfc/rfc4187#section-10.1){.relref}),
but changes how many times AT_MAC may appear in an
EAP-Response/AKA\'-Challenge message as it does not appear there when
AT_KDF has to be sent from the peer to the server. The table also adds
the AT_KDF and AT_KDF_INPUT attributes.[¶](#section-3.5-7){.pilcrow}

[]{#name-the-attribute-table}

::: {#attribute-table}
  Attribute              1     2     3     4     5     6     7   8     9     10   11   E
  ---------------------- ----- ----- ----- ----- ----- ----- --- ----- ----- ---- ---- ---
  AT_PERMANENT_ID_REQ    0-1   0     0     0     0     0     0   0     0     0    0    N
  AT_ANY_ID_REQ          0-1   0     0     0     0     0     0   0     0     0    0    N
  AT_FULLAUTH_ID_REQ     0-1   0     0     0     0     0     0   0     0     0    0    N
  AT_IDENTITY            0     0-1   0     0     0     0     0   0     0     0    0    N
  AT_RAND                0     0     1     0     0     0     0   0     0     0    0    N
  AT_AUTN                0     0     1     0     0     0     0   0     0     0    0    N
  AT_RES                 0     0     0     1     0     0     0   0     0     0    0    N
  AT_AUTS                0     0     0     0     0     0     0   0     0     0    1    N
  AT_NEXT_PSEUDONYM      0     0     0-1   0     0     0     0   0     0     0    0    Y
  AT_NEXT_REAUTH_ID      0     0     0-1   0     0     0     0   0-1   0     0    0    Y
  AT_IV                  0     0     0-1   0\*   0-1   0-1   0   1     1     0    0    N
  AT_ENCR_DATA           0     0     0-1   0\*   0-1   0-1   0   1     1     0    0    N
  AT_PADDING             0     0     0-1   0\*   0-1   0-1   0   0-1   0-1   0    0    Y
  AT_CHECKCODE           0     0     0-1   0-1   0     0     0   0-1   0-1   0    0    N
  AT_RESULT_IND          0     0     0-1   0-1   0     0     0   0-1   0-1   0    0    N
  AT_MAC                 0     0     1     0-1   0-1   0-1   0   1     1     0    0    N
  AT_COUNTER             0     0     0     0     0-1   0-1   0   1     1     0    0    Y
  AT_COUNTER_TOO_SMALL   0     0     0     0     0     0     0   0     0-1   0    0    Y
  AT_NONCE_S             0     0     0     0     0     0     0   1     0     0    0    Y
  AT_NOTIFICATION        0     0     0     0     1     0     0   0     0     0    0    N
  AT_CLIENT_ERROR_CODE   0     0     0     0     0     0     1   0     0     0    0    N
  AT_KDF                 0     0     1+    0+    0     0     0   0     0     0    1+   N
  AT_KDF_INPUT           0     0     1     0     0     0     0   0     0     0    0    N

  : [Table 1](#table-1){.selfRef}: [The Attribute
  Table](#name-the-attribute-table){.selfRef}
:::
:::
:::
:::
:::

::: {#bidding}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Bidding Down Prevention for EAP-AKA](#name-bidding-down-prevention-for){.section-name .selfRef} {#name-bidding-down-prevention-for}

As discussed in \[[RFC3748](#RFC3748){.xref}\], negotiation of methods
within EAP is insecure. That is, a man-in-the-middle attacker may force
the endpoints to use a method that is not the strongest that they both
support. This is a problem, as we expect EAP-AKA and EAP-AKA\' to be
negotiated via EAP.[¶](#section-4-1){.pilcrow}

In order to prevent such attacks, this RFC specifies a mechanism for
EAP-AKA that allows the endpoints to securely discover the capabilities
of each other. This mechanism comes in the form of the AT_BIDDING
attribute. This allows both endpoints to communicate their desire and
support for EAP-AKA\' when exchanging EAP-AKA messages. This attribute
is not included in EAP-AKA\' messages. It is only included in EAP-AKA
messages, which are protected with the AT_MAC attribute. This approach
is based on the assumption that EAP-AKA\' is always preferable (see
[Section 7](#security){.xref}). If during the EAP-AKA authentication
process it is discovered that both endpoints would have been able to use
EAP-AKA\', the authentication process [SHOULD]{.bcp14} be aborted, as a
bidding down attack may have happened.[¶](#section-4-2){.pilcrow}

The format of the AT_BIDDING attribute is shown
below.[¶](#section-4-3){.pilcrow}

::: {#section-4-4 .alignLeft .art-text .artwork}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | AT_BIDDING    | Length        |D|          Reserved           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-4-4){.pilcrow}
:::

The fields are as follows:[¶](#section-4-5){.pilcrow}

[]{.break}

AT_BIDDING
:   This is set to 136.[¶](#section-4-6.2){.pilcrow}
:   

Length
:   The length of the attribute, calculated as defined in
    \[[RFC4187](#RFC4187){.xref}\], [Section
    8.1](https://www.rfc-editor.org/rfc/rfc4187#section-8.1){.relref}.
    For AT_BIDDING, the Length [MUST]{.bcp14} be set to
    1.[¶](#section-4-6.4){.pilcrow}
:   

D
:   This bit is set to 1 if the sender supports EAP-AKA\', is willing to
    use it, and prefers it over EAP-AKA. Otherwise, it should be set to
    zero.[¶](#section-4-6.6){.pilcrow}
:   

Reserved
:   This field [MUST]{.bcp14} be set to zero when sent and ignored on
    receipt.[¶](#section-4-6.8){.pilcrow}
:   

The server sends this attribute in the EAP-Request/AKA-Challenge
message. If the peer supports EAP-AKA\', it compares the received value
to its own capabilities. If it turns out that both the server and peer
would have been able to use EAP-AKA\' and preferred it over EAP-AKA, the
peer behaves as if AUTN had been incorrect and fails the authentication
(see Figure 3 of \[[RFC4187](#RFC4187){.xref}\]). A peer not supporting
EAP-AKA\' will simply ignore this attribute. In all cases, the attribute
is protected by the integrity mechanisms of EAP-AKA, so it cannot be
removed by a man-in-the-middle attacker.[¶](#section-4-7){.pilcrow}

Note that we assume ([Section 7](#security){.xref}) that EAP-AKA\' is
always stronger than EAP-AKA. As a result, this specification does not
provide protection against bidding \"down\" attacks in the other
direction, i.e., attackers forcing the endpoints to use
EAP-AKA\'.[¶](#section-4-8){.pilcrow}

::: {#attrtable2}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Summary of Attributes for EAP-AKA](#name-summary-of-attributes-for-ea){.section-name .selfRef} {#name-summary-of-attributes-for-ea}

The appearance of the AT_BIDDING attribute in EAP-AKA exchanges is shown
below, using the notation from [Section
3.5](#attrtable){.xref}:[¶](#section-4.1-1){.pilcrow}

[]{#name-at_bidding-attribute-appear}

::: {#att-table}
  Attribute    1   2   3   4   5   6   7   8   9   10   11   E
  ------------ --- --- --- --- --- --- --- --- --- ---- ---- ---
  AT_BIDDING   0   0   1   0   0   0   0   0   0   0    0    N

  : [Table 2](#table-2){.selfRef}: [AT_BIDDING Attribute
  Appearance](#name-at_bidding-attribute-appear){.selfRef}
:::
:::
:::
:::
:::

::: {#identities}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Peer Identities](#name-peer-identities){.section-name .selfRef} {#name-peer-identities}

EAP-AKA\' peer identities are as specified in
\[[RFC4187](#RFC4187){.xref}\], [Section
4.1](https://www.rfc-editor.org/rfc/rfc4187#section-4.1){.relref}, with
the addition of some requirements specified in this
section.[¶](#section-5-1){.pilcrow}

EAP-AKA\' includes optional identity privacy support that can be used to
hide the cleartext permanent identity and thereby make the subscriber\'s
EAP exchanges untraceable to eavesdroppers. EAP-AKA\' can also use the
privacy-friendly identifiers specified for 5G
networks.[¶](#section-5-2){.pilcrow}

The permanent identity is usually based on the IMSI. Exposing the IMSI
is undesirable because, as a permanent identity, it is easily trackable.
In addition, since IMSIs may be used in other contexts as well, there
would be additional opportunities for such
tracking.[¶](#section-5-3){.pilcrow}

In EAP-AKA\', identity privacy is based on temporary usernames or
pseudonym usernames. These are similar to, but separate from, the
Temporary Mobile Subscriber Identities (TMSI) that are used on cellular
networks.[¶](#section-5-4){.pilcrow}

::: {#untypes}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Username Types in EAP-AKA\' Identities](#name-username-types-in-eap-aka-i){.section-name .selfRef} {#name-username-types-in-eap-aka-i}

[Section
4.1.1.3](https://www.rfc-editor.org/rfc/rfc4187#section-4.1.1.3){.relref}
of \[[RFC4187](#RFC4187){.xref}\] specifies that there are three types
of usernames: permanent, pseudonym, and fast re-authentication
usernames. This specification extends this definition as follows. There
are four types of usernames:[¶](#section-5.1-1){.pilcrow}

[]{.break}

\(1\)

:   Regular usernames. These are external names given to EAP-AKA\'
    peers. The regular usernames are further subdivided into to
    categories:[¶](#section-5.1-2.1.1){.pilcrow}

    []{.break}

    \(a\)
    :   Permanent usernames, for instance, IMSI-based
        usernames.[¶](#section-5.1-2.1.2.1){.pilcrow}
    :   

    \(b\)
    :   Privacy-friendly temporary usernames, for instance, 5G GUTI (5G
        Globally Unique Temporary Identifier) or 5G privacy identifiers
        (see [Section 5.3.2](#id5guse){.xref}) such as SUCI
        (Subscription Concealed
        Identifier).[¶](#section-5.1-2.1.2.2){.pilcrow}
    :   

:   

\(2\)
:   EAP-AKA\' pseudonym usernames. For example, 2s7ah6n9q\@example.com
    might be a valid pseudonym identity. In this example, 2s7ah6n9q is
    the pseudonym username.[¶](#section-5.1-2.2){.pilcrow}
:   

\(3\)
:   EAP-AKA\' fast re-authentication usernames. For example,
    43953754\@example.com might be a valid fast re-authentication
    identity and 43953754 the fast re-authentication
    username.[¶](#section-5.1-2.3){.pilcrow}
:   

The permanent, privacy-friendly temporary, and pseudonym usernames are
only used with full authentication, and fast re-authentication usernames
only with fast re-authentication. Unlike permanent usernames and
pseudonym usernames, privacy-friendly temporary usernames and fast
re-authentication usernames are one-time identifiers, which are not
reused across EAP exchanges.[¶](#section-5.1-3){.pilcrow}
:::
:::

::: {#genpfr}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Generating Pseudonyms and Fast Re-Authentication Identities](#name-generating-pseudonyms-and-f){.section-name .selfRef} {#name-generating-pseudonyms-and-f}

This section provides some additional guidance to implementations for
producing secure pseudonyms and fast re-authentication identities. It
does not impact backwards compatibility because each server consumes
only the identities that it generates itself. However, adherence to the
guidance will provide better security.[¶](#section-5.2-1){.pilcrow}

As specified by \[[RFC4187](#RFC4187){.xref}\], [Section
4.1.1.7](https://www.rfc-editor.org/rfc/rfc4187#section-4.1.1.7){.relref},
pseudonym usernames and fast re-authentication identities are generated
by the EAP server in an implementation-dependent manner. RFC 4187
provides some general requirements on how these identities are
transported, how they map to the NAI syntax, how they are distinguished
from each other, and so on.[¶](#section-5.2-2){.pilcrow}

However, to enhance privacy, some additional requirements need to be
applied.[¶](#section-5.2-3){.pilcrow}

The pseudonym usernames and fast re-authentication identities
[MUST]{.bcp14} be generated in a cryptographically secure way so that it
is computationally infeasible for an attacker to differentiate two
identities belonging to the same user from two identities belonging to
different users. This can be achieved, for instance, by using random or
pseudorandom identifiers such as random byte strings or ciphertexts. See
also \[[RFC4086](#RFC4086){.xref}\] for guidance on random number
generation.[¶](#section-5.2-4){.pilcrow}

Note that the pseudonym and fast re-authentication usernames also [MUST
NOT]{.bcp14} include substrings that can be used to relate the username
to a particular entity or a particular permanent identity. For instance,
the usernames cannot include any subscriber-identifying part of an IMSI
or other permanent identifier. Similarly, no part of the username can be
formed by a fixed mapping that stays the same across multiple different
pseudonyms or fast re-authentication identities for the same
subscriber.[¶](#section-5.2-5){.pilcrow}

When the identifier used to identify a subscriber in an EAP-AKA\'
authentication exchange is a privacy-friendly identifier that is used
only once, the EAP-AKA\' peer [MUST NOT]{.bcp14} use a pseudonym
provided in that authentication exchange in subsequent exchanges more
than once. To ensure that this does not happen, the EAP-AKA\' server
[MAY]{.bcp14} decline to provide a pseudonym in such authentication
exchanges. An important case where such privacy-friendly identifiers are
used is in 5G networks (see [Section
5.3](#identifiersin5g){.xref}).[¶](#section-5.2-6){.pilcrow}
:::
:::

::: {#identifiersin5g}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Identifier Usage in 5G](#name-identifier-usage-in-5g){.section-name .selfRef} {#name-identifier-usage-in-5g}

In EAP-AKA\', the peer identity may be communicated to the server in one
of three ways:[¶](#section-5.3-1){.pilcrow}

-   [As a part of link-layer establishment procedures, externally to
    EAP.[¶](#section-5.3-2.1){.pilcrow}]{#section-5.3-2.1}
-   [With the EAP-Response/Identity message in the beginning of the EAP
    exchange, but before the selection of
    EAP-AKA\'.[¶](#section-5.3-2.2){.pilcrow}]{#section-5.3-2.2}
-   [Transmitted from the peer to the server using EAP-AKA\' messages
    instead of EAP-Response/Identity. In this case, the server includes
    an identity-requesting attribute (AT_ANY_ID_REQ, AT_FULLAUTH_ID_REQ,
    or AT_PERMANENT_ID_REQ) in the EAP-Request/AKA-Identity message, and
    the peer includes the AT_IDENTITY attribute, which contains the
    peer\'s identity, in the EAP-Response/AKA-Identity
    message.[¶](#section-5.3-2.3){.pilcrow}]{#section-5.3-2.3}

The identity carried above may be a permanent identity, privacy-friendly
identity, pseudonym identity, or fast re-authentication identity as
defined in [Section 5.1](#untypes){.xref}.[¶](#section-5.3-3){.pilcrow}

5G supports the concept of privacy identifiers, and it is important for
interoperability that the right type of identifier is
used.[¶](#section-5.3-4){.pilcrow}

5G defines the SUbscription Permanent Identifier (SUPI) and SUbscription
Concealed Identifier (SUCI) \[[TS-3GPP.23.501](#TS-3GPP.23.501){.xref}\]
\[[TS-3GPP.33.501](#TS-3GPP.33.501){.xref}\]
\[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\]. SUPI is globally unique
and allocated to each subscriber. However, it is only used internally in
the 5G network and is privacy sensitive. The SUCI is a
privacy-preserving identifier containing the concealed SUPI, using
public key cryptography to encrypt the
SUPI.[¶](#section-5.3-5){.pilcrow}

Given the choice between these two types of identifiers, EAP-AKA\'
ensures interoperability as follows:[¶](#section-5.3-6){.pilcrow}

-   [Where identifiers are used within EAP-AKA\' (such as key
    derivation) determine the exact values of the identity to be used,
    to avoid ambiguity (see [Section
    5.3.1](#kd5g){.xref}).[¶](#section-5.3-7.1){.pilcrow}]{#section-5.3-7.1}
-   [Where identifiers are carried within EAP-AKA\' packets (such as in
    the AT_IDENTITY attribute) determine which identifiers should be
    filled in (see [Section
    5.3.2](#id5guse){.xref}).[¶](#section-5.3-7.2){.pilcrow}]{#section-5.3-7.2}

In 5G, the normal mode of operation is that identifiers are only
transmitted outside EAP. However, in a system involving terminals from
many generations and several connectivity options via 5G and other
mechanisms, implementations and the EAP-AKA\' specification need to
prepare for many different situations, including sometimes having to
communicate identities within EAP.[¶](#section-5.3-8){.pilcrow}

The following sections clarify which identifiers are used and
how.[¶](#section-5.3-9){.pilcrow}

::: {#kd5g}
::: {#section-5.3.1 .section}
#### [5.3.1.](#section-5.3.1){.section-number .selfRef} [Key Derivation](#name-key-derivation-2){.section-name .selfRef} {#name-key-derivation-2}

In EAP-AKA\', the peer identity is used in the key derivation formula
found in [Section 3.3](#key){.xref}.[¶](#section-5.3.1-1){.pilcrow}

The identity needs to be represented in exactly the correct format for
the key derivation formula to produce correct
results.[¶](#section-5.3.1-2){.pilcrow}

If the AT_KDF_INPUT parameter contains the prefix \"5G:\", the AT_KDF
parameter has the value 1, and this authentication is not a fast
re-authentication, then the peer identity used in the key derivation
[MUST]{.bcp14} be as specified in Annex F.3 of
\[[TS-3GPP.33.501](#TS-3GPP.33.501){.xref}\] and Clause 2.2 of
\[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\]. This is in contrast to
\[[RFC5448](#RFC5448){.xref}\], which uses the identity as communicated
in EAP and represented as a NAI. Also, in contrast to
\[[RFC5448](#RFC5448){.xref}\], in 5G EAP-AKA\' does not use the \"0\"
nor the \"6\" prefix in front of the
identifier.[¶](#section-5.3.1-3){.pilcrow}

For an example of the format of the identity, see Clause 2.2 of
\[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\].[¶](#section-5.3.1-4){.pilcrow}

In all other cases, the following
applies:[¶](#section-5.3.1-5){.pilcrow}

The identity used in the key derivation formula [MUST]{.bcp14} be
exactly the one sent in the EAP-AKA\' AT_IDENTITY attribute, if one was
sent, regardless of the kind of identity that it may have been. If no
AT_IDENTITY was sent, the identity [MUST]{.bcp14} be exactly the one
sent in the generic EAP Identity exchange, if one was
made.[¶](#section-5.3.1-6){.pilcrow}

If no identity was communicated inside EAP, then the identity is the one
communicated outside EAP in link-layer
messaging.[¶](#section-5.3.1-7){.pilcrow}

In this case, the used identity [MUST]{.bcp14} be the identity most
recently communicated by the peer to the network, again regardless of
what type of identity it may have been.[¶](#section-5.3.1-8){.pilcrow}
:::
:::

::: {#id5guse}
::: {#section-5.3.2 .section}
#### [5.3.2.](#section-5.3.2){.section-number .selfRef} [EAP Identity Response and EAP-AKA\' AT_IDENTITY Attribute](#name-eap-identity-response-and-e){.section-name .selfRef} {#name-eap-identity-response-and-e}

The EAP authentication option is only available in 5G when the new 5G
core network is also in use. However, in other networks, an EAP-AKA\'
peer may be connecting to other types of networks and existing
equipment.[¶](#section-5.3.2-1){.pilcrow}

When the EAP server is in a 5G network, the 5G procedures for EAP-AKA\'
apply. \[[TS-3GPP.33.501](#TS-3GPP.33.501){.xref}\] specifies when the
EAP server is in a 5G network.[¶](#section-5.3.2-2){.pilcrow}

Note: Currently, the following conditions are specified: when the EAP
peer uses the 5G Non-Access Stratum (NAS) protocol
\[[TS-3GPP.24.501](#TS-3GPP.24.501){.xref}\] or when the EAP peer
attaches to a network that advertises 5G connectivity without NAS
\[[TS-3GPP.23.501](#TS-3GPP.23.501){.xref}\]. Possible future conditions
may also be specified by 3GPP.[¶](#section-5.3.2-3){.pilcrow}

When the 5G procedures for EAP-AKA\' apply, EAP identity exchanges are
generally not used as the identity is already made available on previous
link-layer exchanges.[¶](#section-5.3.2-4){.pilcrow}

In this situation, the EAP Identity Response and EAP-AKA\' AT_IDENTITY
attribute are handled as specified in Annex F.2 of
\[[TS-3GPP.33.501](#TS-3GPP.33.501){.xref}\].[¶](#section-5.3.2-5){.pilcrow}

When used in EAP-AKA\', the format of the SUCI [MUST]{.bcp14} be as
specified in \[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\], Section
28.7.3, with the semantics defined in
\[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\], Section 2.2B. Also, in
contrast to \[[RFC5448](#RFC5448){.xref}\], in 5G EAP-AKA\' does not use
the \"0\" nor the \"6\" prefix in front of the
identifier.[¶](#section-5.3.2-6){.pilcrow}

For an example of an IMSI in NAI format, see
\[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\], Section
28.7.3.[¶](#section-5.3.2-7){.pilcrow}

Otherwise, the peer [SHOULD]{.bcp14} employ an IMSI, SUPI, or NAI
\[[RFC7542](#RFC7542){.xref}\] as it is configured to
use.[¶](#section-5.3.2-8){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#exported-parameters}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Exported Parameters](#name-exported-parameters){.section-name .selfRef} {#name-exported-parameters}

When not using fast re-authentication, the EAP-AKA\' Session-Id is the
concatenation of the EAP-AKA\' Type value (0x32, one byte) with the
contents of the RAND field from the AT_RAND attribute followed by the
contents of the AUTN field in the AT_AUTN
attribute:[¶](#section-6-1){.pilcrow}

::: {#section-6-2 .alignLeft .art-text .artwork}
          Session-Id = 0x32 || RAND || AUTN

[¶](#section-6-2){.pilcrow}
:::

When using fast re-authentication, the EAP-AKA\' Session-Id is the
concatenation of the EAP-AKA\' Type value (0x32) with the contents of
the NONCE_S field from the AT_NONCE_S attribute followed by the contents
of the MAC field from the AT_MAC attribute from the
EAP-Request/AKA-Reauthentication:[¶](#section-6-3){.pilcrow}

::: {#section-6-4 .alignLeft .art-text .artwork}
          Session-Id = 0x32 || NONCE_S || MAC

[¶](#section-6-4){.pilcrow}
:::

The Peer-Id is the contents of the Identity field from the AT_IDENTITY
attribute, using only the Actual Identity Length bytes from the
beginning. Note that the contents are used as they are transmitted,
regardless of whether the transmitted identity was a permanent,
pseudonym, or fast EAP re-authentication identity. If no AT_IDENTITY
attribute was exchanged, the exported Peer-Id is the identity provided
from the EAP Identity Response packet. If no EAP Identity Response was
provided either, the exported Peer-Id is the null string (zero
length).[¶](#section-6-5){.pilcrow}

The Server-Id is the null string (zero
length).[¶](#section-6-6){.pilcrow}
:::
:::

::: {#security}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

A summary of the security properties of EAP-AKA\' follows. These
properties are very similar to those in EAP-AKA. We assume that HMAC
SHA-256 is at least as secure as HMAC SHA-1 (see also
\[[RFC6194](#RFC6194){.xref}\]). This is called the SHA-256 assumption
in the remainder of this section. Under this assumption, EAP-AKA\' is at
least as secure as EAP-AKA.[¶](#section-7-1){.pilcrow}

If the AT_KDF attribute has value 1, then the security properties of
EAP-AKA\' are as follows:[¶](#section-7-2){.pilcrow}

[]{.break}

Protected ciphersuite negotiation

EAP-AKA\' has no ciphersuite negotiation mechanisms. It does have a
negotiation mechanism for selecting the key derivation functions. This
mechanism is secure against bidding down attacks from EAP-AKA\' to
EAP-AKA. The negotiation mechanism allows changing the offered key
derivation function, but the change is visible in the final
EAP-Request/AKA\'-Challenge message that the server sends to the peer.
This message is authenticated via the AT_MAC attribute, and carries both
the chosen alternative and the initially offered list. The peer refuses
to accept a change it did not initiate. As a result, both parties are
aware that a change is being made and what the original offer
was.[¶](#section-7-3.2.1){.pilcrow}

Per assumptions in [Section 4](#bidding){.xref}, there is no protection
against bidding down attacks from EAP-AKA to EAP-AKA\' should EAP-AKA\'
somehow be considered less secure some day than EAP-AKA. Such protection
was not provided in RFC 5448 implementations and consequently neither
does this specification provide it. If such support is needed, it would
have to be added as a separate new
feature.[¶](#section-7-3.2.2){.pilcrow}

In general, it is expected that the current negotiation capabilities in
EAP-AKA\' are sufficient for some types of extensions, including adding
Perfect Forward Secrecy \[[EMU-AKA-PFS](#I-D.ietf-emu-aka-pfs){.xref}\]
and perhaps others. However, some larger changes may require a new EAP
method type, which is how EAP-AKA\' itself happened. One example of such
change would be the introduction of new
algorithms.[¶](#section-7-3.2.3){.pilcrow}

Mutual authentication

Under the SHA-256 assumption, the properties of EAP-AKA\' are at least
as good as those of EAP-AKA in this respect. Refer to
\[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.4){.pilcrow}

Integrity protection

Under the SHA-256 assumption, the properties of EAP-AKA\' are at least
as good (most likely better) as those of EAP-AKA in this respect. Refer
to \[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details. The only difference is that a stronger hash algorithm
and keyed MAC, SHA-256 / HMAC-SHA-256, is used instead of SHA-1 /
HMAC-SHA-1.[¶](#section-7-3.6){.pilcrow}

Replay protection

Under the SHA-256 assumption, the properties of EAP-AKA\' are at least
as good as those of EAP-AKA in this respect. Refer to
\[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.8){.pilcrow}

::: {#confidentiality}
Confidentiality
:::

The properties of EAP-AKA\' are exactly the same as those of EAP-AKA in
this respect. Refer to \[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.10){.pilcrow}

Key derivation

EAP-AKA\' supports key derivation with an effective key strength against
brute-force attacks equal to the minimum of the length of the derived
keys and the length of the AKA base key, i.e., 128 bits or more. The key
hierarchy is specified in [Section
3.3](#key){.xref}.[¶](#section-7-3.12.1){.pilcrow}

The Transient EAP Keys used to protect EAP-AKA packets (K_encr, K_aut,
K_re), the MSK, and the EMSK are cryptographically separate. If we make
the assumption that SHA-256 behaves as a pseudorandom function, an
attacker is incapable of deriving any non-trivial information about any
of these keys based on the other keys. An attacker also cannot calculate
the pre-shared secret from IK, CK, IK\', CK\', K_encr, K_aut, K_re, MSK,
or EMSK by any practically feasible
means.[¶](#section-7-3.12.2){.pilcrow}

EAP-AKA\' adds an additional layer of key derivation functions within
itself to protect against the use of compromised keys. This is discussed
further in [Section
7.4](#bindprop){.xref}.[¶](#section-7-3.12.3){.pilcrow}

EAP-AKA\' uses a pseudorandom function modeled after the one used in
IKEv2 \[[RFC7296](#RFC7296){.xref}\] together with
SHA-256.[¶](#section-7-3.12.4){.pilcrow}

Key strength

See above.[¶](#section-7-3.14){.pilcrow}

Dictionary attack resistance

Under the SHA-256 assumption, the properties of EAP-AKA\' are at least
as good as those of EAP-AKA in this respect. Refer to
\[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.16){.pilcrow}

Fast reconnect

Under the SHA-256 assumption, the properties of EAP-AKA\' are at least
as good as those of EAP-AKA in this respect. Refer to
\[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details. Note that implementations [MUST]{.bcp14} prevent
performing a fast reconnect across method
types.[¶](#section-7-3.18){.pilcrow}

Cryptographic binding

Note that this term refers to a very specific form of binding, something
that is performed between two layers of authentication. It is not the
same as the binding to a particular network name. The properties of
EAP-AKA\' are exactly the same as those of EAP-AKA in this respect,
i.e., as it is not a tunnel method, this property is not applicable to
it. Refer to \[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.20){.pilcrow}

Session independence

The properties of EAP-AKA\' are exactly the same as those of EAP-AKA in
this respect. Refer to \[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.22){.pilcrow}

Fragmentation

The properties of EAP-AKA\' are exactly the same as those of EAP-AKA in
this respect. Refer to \[[RFC4187](#RFC4187){.xref}\], [Section
12](https://www.rfc-editor.org/rfc/rfc4187#section-12){.relref}, for
further details.[¶](#section-7-3.24){.pilcrow}

Channel binding

EAP-AKA\', like EAP-AKA, does not provide channel bindings as they\'re
defined in \[[RFC3748](#RFC3748){.xref}\] and
\[[RFC5247](#RFC5247){.xref}\]. New skippable attributes can be used to
add channel binding support in the future, if
required.[¶](#section-7-3.26.1){.pilcrow}

However, including the Network Name field in the AKA\' algorithms (which
are also used for other purposes than EAP-AKA\') provides a form of
cryptographic separation between different network names, which
resembles channel bindings. However, the network name does not typically
identify the EAP (pass-through) authenticator. See [Section
7.4](#bindprop){.xref} for more
discussion.[¶](#section-7-3.26.2){.pilcrow}

::: {#priv}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Privacy](#name-privacy){.section-name .selfRef} {#name-privacy}

\[[RFC6973](#RFC6973){.xref}\] suggests that the privacy considerations
of IETF protocols be documented.[¶](#section-7.1-1){.pilcrow}

The confidentiality properties of EAP-AKA\' itself have been discussed
above under [\"Confidentiality\"](#confidentiality){.xref} ([Section
7](#confidentiality){.xref}).[¶](#section-7.1-2){.pilcrow}

EAP-AKA\' uses several different types of identifiers to identify the
authenticating peer. It is strongly [RECOMMENDED]{.bcp14} to use the
privacy-friendly temporary or hidden identifiers, i.e., the 5G GUTI or
SUCI, pseudonym usernames, and fast re-authentication usernames. The use
of permanent identifiers such as the IMSI or SUPI may lead to an ability
to track the peer and/or user associated with the peer. The use of
permanent identifiers such as the IMSI or SUPI is strongly [NOT
RECOMMENDED]{.bcp14}.[¶](#section-7.1-3){.pilcrow}

As discussed in [Section 5.3](#identifiersin5g){.xref}, when
authenticating to a 5G network, only the SUCI identifier is normally
used. The use of EAP-AKA\' pseudonyms in this situation is at best
limited because the SUCI already provides a stronger mechanism. In fact,
reusing the same pseudonym multiple times will result in a tracking
opportunity for observers that see the pseudonym pass by. To avoid this,
the peer and server need to follow the guidelines given in [Section
5.2](#genpfr){.xref}.[¶](#section-7.1-4){.pilcrow}

When authenticating to a 5G network, per [Section 5.3.1](#kd5g){.xref},
both the EAP-AKA\' peer and server need to employ the permanent
identifier SUPI as an input to key derivation. However, this use of the
SUPI is only internal. As such, the SUPI need not be communicated in EAP
messages. Therefore, SUPI [MUST NOT]{.bcp14} be communicated in
EAP-AKA\' when authenticating to a 5G
network.[¶](#section-7.1-5){.pilcrow}

While the use of SUCI in 5G networks generally provides identity
privacy, this is not true if the null-scheme encryption is used to
construct the SUCI (see \[[TS-3GPP.33.501](#TS-3GPP.33.501){.xref}\],
Annex C). The use of this scheme makes the use of SUCI equivalent to the
use of SUPI or IMSI. The use of the null scheme is [NOT
RECOMMENDED]{.bcp14} where identity privacy is
important.[¶](#section-7.1-6){.pilcrow}

The use of fast re-authentication identities when authenticating to a 5G
network does not have the same problems as the use of pseudonyms, as
long as the 5G authentication server generates the fast
re-authentication identifiers in a proper manner specified in [Section
5.2](#genpfr){.xref}.[¶](#section-7.1-7){.pilcrow}

Outside 5G, the peer can freely choose between the use of permanent,
pseudonym, or fast re-authentication
identifiers:[¶](#section-7.1-8){.pilcrow}

-   ::: {#section-7.1-9.1}
    A peer that has not yet performed any EAP-AKA\' exchanges does not
    typically have a pseudonym available. If the peer does not have a
    pseudonym available, then the privacy mechanism cannot be used, and
    the permanent identity will have to be sent in the
    clear.[¶](#section-7.1-9.1.1){.pilcrow}

    The terminal [SHOULD]{.bcp14} store the pseudonym in nonvolatile
    memory so that it can be maintained across reboots. An active
    attacker that impersonates the network may use the
    AT_PERMANENT_ID_REQ attribute (\[[RFC4187](#RFC4187){.xref}\],
    [Section
    4.1.2](https://www.rfc-editor.org/rfc/rfc4187#section-4.1.2){.relref})
    to learn the subscriber\'s IMSI. However, as discussed in
    \[[RFC4187](#RFC4187){.xref}\], [Section
    4.1.2](https://www.rfc-editor.org/rfc/rfc4187#section-4.1.2){.relref},
    the terminal can refuse to send the cleartext permanent identity if
    it believes that the network should be able to recognize the
    pseudonym.[¶](#section-7.1-9.1.2){.pilcrow}
    :::

-   ::: {#section-7.1-9.2}
    When pseudonyms and fast re-authentication identities are used, the
    peer relies on the properly created identifiers by the
    server.[¶](#section-7.1-9.2.1){.pilcrow}

    It is essential that an attacker cannot link a privacy-friendly
    identifier to the user in any way or determine that two identifiers
    belong to the same user as outlined in [Section
    5.2](#genpfr){.xref}. The pseudonym usernames and fast
    re-authentication identities [MUST NOT]{.bcp14} be used for other
    purposes (e.g., in other
    protocols).[¶](#section-7.1-9.2.2){.pilcrow}
    :::

If the peer and server cannot guarantee that SUCI can be used or that
pseudonyms will be available, generated properly, and maintained
reliably, and identity privacy is required, then additional protection
from an external security mechanism such as tunneled EAP methods like
Tunneled Transport Layer Security (TTLS) \[[RFC5281](#RFC5281){.xref}\]
or Tunnel Extensible Authentication Protocol (TEAP)
\[[RFC7170](#RFC7170){.xref}\] may be used. The benefits and the
security considerations of using an external security mechanism with
EAP-AKA are beyond the scope of this
document.[¶](#section-7.1-10){.pilcrow}

Finally, as with other EAP methods, even when privacy-friendly
identifiers or EAP tunneling is used, typically the domain part of an
identifier (e.g., the home operator) is visible to external
parties.[¶](#section-7.1-11){.pilcrow}
:::
:::

::: {#vuln}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Discovered Vulnerabilities](#name-discovered-vulnerabilities){.section-name .selfRef} {#name-discovered-vulnerabilities}

There have been no published attacks that violate the primary secrecy or
authentication properties defined for Authentication and Key Agreement
(AKA) under the originally assumed trust model. The same is true of
EAP-AKA\'.[¶](#section-7.2-1){.pilcrow}

However, there have been attacks when a different trust model is in use,
with characteristics not originally provided by the design, or when
participants in the protocol leak information to outsiders on purpose,
and there have been some privacy-related
attacks.[¶](#section-7.2-2){.pilcrow}

For instance, the original AKA protocol does not prevent an insider
supplying keys to a third party, e.g., as described by
[Mjølsnes]{.contact-name} and Tsay in \[[MT2012](#MT2012){.xref}\] where
a serving network lets an authentication run succeed, but then it
misuses the session keys to send traffic on the authenticated user\'s
behalf. This particular attack is not different from any on-path entity
(such as a router) pretending to send traffic, but the general issue of
insider attacks can be a problem, particularly in a large group of
collaborating operators.[¶](#section-7.2-3){.pilcrow}

Another class of attacks is the use of tunneling of traffic from one
place to another, e.g., as done by Zhang and Fang in
\[[ZF2005](#ZF2005){.xref}\] to leverage security policy differences
between different operator networks, for instance. To gain something in
such an attack, the attacker needs to trick the user into believing it
is in another location. If policies between locations differ, for
instance, if payload traffic is not required to be encrypted in some
location, the attacker may trick the user into opening a vulnerability.
As an authentication mechanism, EAP-AKA\' is not directly affected by
most of these attacks. EAP-AKA\' network name binding can also help
alleviate some of the attacks. In any case, it is recommended that
EAP-AKA\' configuration not be dependent on the location of request
origin, unless the location information can be cryptographically
confirmed, e.g., with the network name
binding.[¶](#section-7.2-4){.pilcrow}

Zhang and Fang also looked at denial-of-service attacks
\[[ZF2005](#ZF2005){.xref}\]. A serving network may request large
numbers of authentication runs for a particular subscriber from a home
network. While the resynchronization process can help recover from this,
eventually it is possible to exhaust the sequence number space and
render the subscriber\'s card unusable. This attack is possible for both
original AKA and EAP-AKA\'. However, it requires the collaboration of a
serving network in an attack. It is recommended that EAP-AKA\'
implementations provide the means to track, detect, and limit excessive
authentication attempts to combat this
problem.[¶](#section-7.2-5){.pilcrow}

There have also been attacks related to the use of AKA without the
generated session keys (e.g., \[[BT2013](#BT2013){.xref}\]). Some of
those attacks relate to the use of HTTP Digest AKAv1
\[[RFC3310](#RFC3310){.xref}\], which was originally vulnerable to
man-in-the-middle attacks. This has since been corrected in
\[[RFC4169](#RFC4169){.xref}\]. The EAP-AKA\' protocol uses session keys
and provides channel binding, and as such, it is resistant to the above
attacks except where the protocol participants leak information to
outsiders.[¶](#section-7.2-6){.pilcrow}

Basin, et al. \[[Basin2018](#Basin2018){.xref}\] have performed formal
analysis and concluded that the AKA protocol would have benefited from
additional security requirements such as key
confirmation.[¶](#section-7.2-7){.pilcrow}

In the context of pervasive monitoring revelations, there were also
reports of compromised long-term pre-shared keys used in SIM and AKA
\[[Heist2015](#Heist2015){.xref}\]. While no protocol can survive the
theft of key material associated with its credentials, there are some
things that alleviate the impacts in such situations. These are
discussed further in [Section
7.3](#pm){.xref}.[¶](#section-7.2-8){.pilcrow}

Arapinis, et al. \[[Arapinis2012](#Arapinis2012){.xref}\] describe an
attack that uses the AKA resynchronization protocol to attempt to detect
whether a particular subscriber is in a given area. This attack depends
on the attacker setting up a false base station in the given area and on
the subscriber performing at least one authentication between the time
the attack is set up and run.[¶](#section-7.2-9){.pilcrow}

Borgaonkar, et al. discovered that the AKA resynchronization protocol
may also be used to predict the authentication frequency of a subscriber
if a non-time-based sequence number (SQN) generation scheme is used
\[[Borgaonkar2018](#Borgaonkar2018){.xref}\]. The attacker can force the
reuse of the keystream that is used to protect the SQN in the AKA
resynchronization protocol. The attacker then guesses the authentication
frequency based on the lowest bits of two XORed SQNs. The researchers\'
concern was that the authentication frequency would reveal some
information about the phone usage behavior, e.g., number of phone calls
made or number of SMS messages sent. There are a number of possible
triggers for authentication, so such an information leak is not direct,
but it can be a concern. The impact of the attack differs depending on
whether the SQN generation scheme that is used is time-based or
not.[¶](#section-7.2-10){.pilcrow}

Similar attacks are possible outside AKA in the cellular paging
protocols where the attacker can simply send application-layer data,
send short messages, or make phone calls to the intended victim and
observe the air interface (e.g., \[[Kune2012](#Kune2012){.xref}\] and
\[[Shaik2016](#Shaik2016){.xref}\]). Hussain, et al. demonstrated a
slightly more sophisticated version of the attack that exploits the fact
that the 4G paging protocol uses the IMSI to calculate the paging
timeslot \[[Hussain2019](#Hussain2019){.xref}\]. As this attack is
outside AKA, it does not impact EAP-AKA\'.[¶](#section-7.2-11){.pilcrow}

Finally, bad implementations of EAP-AKA\' may not produce pseudonym
usernames or fast re-authentication identities in a manner that is
sufficiently secure. While it is not a problem with the protocol itself,
following the recommendations in [Section 5.2](#genpfr){.xref} can
mitigate this concern.[¶](#section-7.2-12){.pilcrow}
:::
:::

::: {#pm}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Pervasive Monitoring](#name-pervasive-monitoring){.section-name .selfRef} {#name-pervasive-monitoring}

As required by \[[RFC7258](#RFC7258){.xref}\], work on IETF protocols
needs to consider the effects of pervasive monitoring and mitigate them
when possible.[¶](#section-7.3-1){.pilcrow}

As described in [Section 7.2](#vuln){.xref}, after the publication of
RFC 5448, new information has come to light regarding the use of
pervasive monitoring techniques against many security technologies,
including AKA-based authentication.[¶](#section-7.3-2){.pilcrow}

For AKA, these attacks relate to theft of the long-term, shared-secret
key material stored on the cards. Such attacks are conceivable, for
instance, during the manufacturing process of cards, through coercion of
the card manufacturers, or during the transfer of cards and associated
information to an operator. Since the publication of reports about such
attacks, manufacturing and provisioning processes have gained much
scrutiny and have improved.[¶](#section-7.3-3){.pilcrow}

In particular, it is crucial that manufacturers limit access to the
secret information and the cards only to necessary systems and
personnel. It is also crucial that secure mechanisms be used to store
and communicate the secrets between the manufacturer and the operator
that adopts those cards for their
customers.[¶](#section-7.3-4){.pilcrow}

Beyond these operational considerations, there are also technical means
to improve resistance to these attacks. One approach is to provide
Perfect Forward Secrecy (PFS). This would prevent any passive attacks
merely based on the long-term secrets and observation of traffic. Such a
mechanism can be defined as a backwards-compatible extension of
EAP-AKA\' and is pursued separately from this specification
\[[EMU-AKA-PFS](#I-D.ietf-emu-aka-pfs){.xref}\]. Alternatively,
EAP-AKA\' authentication can be run inside a PFS-capable, tunneled
authentication method. In any case, the use of some PFS-capable
mechanism is recommended.[¶](#section-7.3-5){.pilcrow}
:::
:::

::: {#bindprop}
::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [Security Properties of Binding Network Names](#name-security-properties-of-bind){.section-name .selfRef} {#name-security-properties-of-bind}

The ability of EAP-AKA\' to bind the network name into the used keys
provides some additional protection against key leakage to inappropriate
parties. The keys used in the protocol are specific to a particular
network name. If key leakage occurs due to an accident, access node
compromise, or another attack, the leaked keys are only useful when
providing access with that name. For instance, a malicious access point
cannot claim to be network Y if it has stolen keys from network X.
Obviously, if an access point is compromised, the malicious node can
still represent the compromised node. As a result, neither EAP-AKA\' nor
any other extension can prevent such attacks; however, the binding to a
particular name limits the attacker\'s choices, allows better tracking
of attacks, makes it possible to identify compromised networks, and
applies good cryptographic hygiene.[¶](#section-7.4-1){.pilcrow}

The server receives the EAP transaction from a given access network, and
verifies that the claim from the access network corresponds to the name
that this access network should be using. It becomes impossible for an
access network to claim over AAA that it is another access network. In
addition, if the peer checks that the information it has received
locally over the network-access link-layer matches with the information
the server has given it via EAP-AKA\', it becomes impossible for the
access network to tell one story to the AAA network and another one to
the peer. These checks prevent some \"lying NAS\" (Network Access
Server) attacks. For instance, a roaming partner, R, might claim that it
is the home network H in an effort to lure peers to connect to itself.
Such an attack would be beneficial for the roaming partner if it can
attract more users, and damaging for the users if their access costs in
R are higher than those in other alternative networks, such as
H.[¶](#section-7.4-2){.pilcrow}

Any attacker who gets hold of the keys CK and IK, produced by the AKA
algorithm, can compute the keys CK\' and IK\' and, hence, the Master Key
(MK) according to the rules in [Section 3.3](#key){.xref}. The attacker
could then act as a lying NAS. In 3GPP systems in general, the keys CK
and IK have been distributed to, for instance, nodes in a visited access
network where they may be vulnerable. In order to reduce this risk, the
AKA algorithm [MUST]{.bcp14} be computed with the AMF separation bit set
to 1, and the peer [MUST]{.bcp14} check that this is indeed the case
whenever it runs EAP-AKA\'. Furthermore,
\[[TS-3GPP.33.402](#TS-3GPP.33.402){.xref}\] requires that no CK or IK
keys computed in this way ever leave the home subscriber
system.[¶](#section-7.4-3){.pilcrow}

The additional security benefits obtained from the binding depend
obviously on the way names are assigned to different access networks.
This is specified in \[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\]. See
also \[[TS-3GPP.23.003](#TS-3GPP.23.003){.xref}\]. Ideally, the names
allow separating each different access technology, each different access
network, and each different NAS within a domain. If this is not
possible, the full benefits may not be achieved. For instance, if the
names identify just an access technology, use of compromised keys in a
different technology can be prevented, but it is not possible to prevent
their use by other domains or devices using the same
technology.[¶](#section-7.4-4){.pilcrow}
:::
:::
:::
:::

::: {#iana}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

IANA has updated the \"Extensible Authentication Protocol (EAP)
Registry\" and the \"EAP-AKA and EAP-SIM Parameters\" registry so that
entries that pointed to RFC 5448 now point to this RFC
instead.[¶](#section-8-1){.pilcrow}

::: {#typev}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Type Value](#name-type-value){.section-name .selfRef} {#name-type-value}

IANA has updated the reference for EAP-AKA\' (0x32) in the \"Method
Types\" subregistry under the \"Extensible Authentication Protocol (EAP)
Registry\" to point to this document. Per [Section
6.2](https://www.rfc-editor.org/rfc/rfc3748#section-6.2){.relref} of
\[[RFC3748](#RFC3748){.xref}\], this allocation can be made with
Specification Required
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-8.1-1){.pilcrow}
:::
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Attribute Type Values](#name-attribute-type-values){.section-name .selfRef} {#name-attribute-type-values}

EAP-AKA\' shares its attribute space and subtypes with EAP-SIM
\[[RFC4186](#RFC4186){.xref}\] and EAP-AKA
\[[RFC4187](#RFC4187){.xref}\]. No new registries are
needed.[¶](#section-8.2-1){.pilcrow}

IANA has updated the reference for AT_KDF_INPUT (23) and AT_KDF (24) in
the \"Attribute Types (Non-Skippable Attributes 0-127)\" subregistry
under the \"EAP-AKA and EAP-SIM Parameters\" registry to point to this
document. AT_KDF_INPUT and AT_KDF are defined in Sections
[3.1](#netbind){.xref} and [3.2](#keyderiv){.xref}, respectively, of
this document.[¶](#section-8.2-2){.pilcrow}

IANA has also updated the reference for AT_BIDDING (136) in the
\"Attribute Types (Skippable Attributes 128-255)\" subregistry of the
\"EAP-AKA and EAP-SIM Parameters\" registry to point to this document.
AT_BIDDING is defined in [Section
4](#bidding){.xref}.[¶](#section-8.2-3){.pilcrow}
:::

::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [Key Derivation Function Namespace](#name-key-derivation-function-nam){.section-name .selfRef} {#name-key-derivation-function-nam}

IANA has updated the reference for the \"EAP-AKA\' AT_KDF Key Derivation
Function Values\" subregistry to point to this document. This
subregistry appears under the \"EAP-AKA and EAP-SIM Parameters\"
registry. The references for following entries have also been updated to
point to this document. New values can be created through the
Specification Required policy
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-8.3-1){.pilcrow}

[]{#name-eap-aka-at_kdf-key-derivati}

  Value   Description                Reference
  ------- -------------------------- -----------
  0       Reserved                   RFC 9048
  1       EAP-AKA\' with CK\'/IK\'   RFC 9048

  : [Table 3](#table-3){.selfRef}: [EAP-AKA\' AT_KDF Key Derivation
  Function Values](#name-eap-aka-at_kdf-key-derivati){.selfRef}
:::
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[FIPS.180-4\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Secure Hash Standard\"]{.refTitle}, [FIPS PUB
    180-4]{.seriesInfo}, [DOI 10.6028/NIST.FIPS.180-4]{.seriesInfo},
    August 2015,
    \<<https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf>\>.
:   

\[RFC2104\]
:   [Krawczyk, H.]{.refAuthor}, [Bellare, M.]{.refAuthor}, and [R.
    Canetti]{.refAuthor}, [\"HMAC: Keyed-Hashing for Message
    Authentication\"]{.refTitle}, [RFC 2104]{.seriesInfo}, [DOI
    10.17487/RFC2104]{.seriesInfo}, February 1997,
    \<<https://www.rfc-editor.org/info/rfc2104>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3748\]
:   [Aboba, B.]{.refAuthor}, [Blunk, L.]{.refAuthor},
    [Vollbrecht, J.]{.refAuthor}, [Carlson, J.]{.refAuthor}, and [H.
    Levkowetz, Ed.]{.refAuthor}, [\"Extensible Authentication Protocol
    (EAP)\"]{.refTitle}, [RFC 3748]{.seriesInfo}, [DOI
    10.17487/RFC3748]{.seriesInfo}, June 2004,
    \<<https://www.rfc-editor.org/info/rfc3748>\>.
:   

\[RFC4187\]
:   [Arkko, J.]{.refAuthor} and [H. Haverinen]{.refAuthor},
    [\"Extensible Authentication Protocol Method for 3rd Generation
    Authentication and Key Agreement (EAP-AKA)\"]{.refTitle}, [RFC
    4187]{.seriesInfo}, [DOI 10.17487/RFC4187]{.seriesInfo}, January
    2006, \<<https://www.rfc-editor.org/info/rfc4187>\>.
:   

\[RFC7542\]
:   [DeKok, A.]{.refAuthor}, [\"The Network Access
    Identifier\"]{.refTitle}, [RFC 7542]{.seriesInfo}, [DOI
    10.17487/RFC7542]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7542>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[TS-3GPP.23.003\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Core Network and Terminals; Numbering,
    addressing and identification (Release 16)\"]{.refTitle}, [Version
    16.7.0]{.refContent}, [3GPP Technical Specification
    23.003]{.seriesInfo}, June 2021.
:   

\[TS-3GPP.23.501\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Services and System Aspects; System architecture
    for the 5G System (5GS); (Release 16)\"]{.refTitle}, [Version
    16.9.0]{.refContent}, [3GPP Technical Specification
    23.501]{.seriesInfo}, June 2021.
:   

\[TS-3GPP.24.302\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Core Network and Terminals; Access to the 3GPP
    Evolved Packet Core (EPC) via non-3GPP access networks; Stage 3;
    (Release 16)\"]{.refTitle}, [Version 16.4.0]{.refContent}, [3GPP
    Technical Specification 24.302]{.seriesInfo}, July 2020.
:   

\[TS-3GPP.24.501\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Core Network and Terminals; Non-Access-Stratum
    (NAS) protocol for 5G System (5GS); Stage 3; (Release
    16)\"]{.refTitle}, [Version 16.9.0]{.refContent}, [3GPP Draft
    Technical Specification 24.501]{.seriesInfo}, June 2021.
:   

\[TS-3GPP.33.102\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Services and System Aspects; 3G Security;
    Security architecture (Release 16)\"]{.refTitle}, [Version
    16.0.0]{.refContent}, [3GPP Technical Specification
    33.102]{.seriesInfo}, July 2020.
:   

\[TS-3GPP.33.402\]
:   [3GPP]{.refAuthor}, [\"3GPP System Architecture Evolution (SAE);
    Security aspects of non-3GPP accesses (Release 16)\"]{.refTitle},
    [Version 16.0.0]{.refContent}, [3GPP Technical Specification
    33.402]{.seriesInfo}, July 2020.
:   

\[TS-3GPP.33.501\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Services and System Aspects; 3G Security;
    Security architecture and procedures for 5G System (Release
    16)\"]{.refTitle}, [Version 16.7.1]{.refContent}, [3GPP Technical
    Specification 33.501]{.seriesInfo}, July 2021.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[Arapinis2012\]
:   [Arapinis, M.]{.refAuthor}, [Mancini, L.]{.refAuthor},
    [Ritter, E.]{.refAuthor}, [Ryan, M.]{.refAuthor},
    [Golde, N.]{.refAuthor}, [Redon, R.]{.refAuthor}, and [R.
    Borgaonkar]{.refAuthor}, [\"New Privacy Issues in Mobile Telephony:
    Fix and Verification\"]{.refTitle}, [in CCS \'12: Proceedings of the
    2012 ACM Conference on Computer and Communications Security,
    Raleigh, North Carolina, USA]{.refContent}, [DOI
    10.1145/2382196.2382221]{.seriesInfo}, October 2012,
    \<<https://doi.org/10.1145/2382196.2382221>\>.
:   

\[Basin2018\]
:   [Basin, D.]{.refAuthor}, [Dreier, J.]{.refAuthor},
    [Hirschi, L.]{.refAuthor}, [Radomirović, S.]{.refAuthor},
    [Sasse, R.]{.refAuthor}, and [V. Stettler]{.refAuthor}, [\"A Formal
    Analysis of 5G Authentication\"]{.refTitle},
    [arXiv:1806.10360]{.refContent}, [DOI
    10.1145/3243734.3243846]{.seriesInfo}, August 2018,
    \<<https://doi.org/10.1145/3243734.3243846>\>.
:   

\[Borgaonkar2018\]
:   [Borgaonkar, R.]{.refAuthor}, [Hirschi, L.]{.refAuthor},
    [Park, S.]{.refAuthor}, and [A. Shaik]{.refAuthor}, [\"New Privacy
    Threat on 3G, 4G, and Upcoming 5G AKA Protocols\"]{.refTitle}, [in
    IACR Cryptology ePrint Archive]{.refContent}, 2018.
:   

\[BT2013\]
:   [Beekman, J. G.]{.refAuthor} and [C. Thompson]{.refAuthor},
    [\"Breaking Cell Phone Authentication: Vulnerabilities in AKA, IMS
    and Android\"]{.refTitle}, [in 7th USENIX Workshop on Offensive
    Technologies, WOOT \'13]{.refContent}, August 2013.
:   

\[EMU-AKA-PFS\]
:   [Arkko, J.]{.refAuthor}, [Norrman, K.]{.refAuthor}, and [V.
    Torvinen]{.refAuthor}, [\"Perfect-Forward Secrecy for the Extensible
    Authentication Protocol Method for Authentication and Key Agreement
    (EAP-AKA\' PFS)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-emu-aka-pfs-05]{.seriesInfo}, 30 October
    2020,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-emu-aka-pfs-05>\>.
:   

\[FIPS.180-1\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Secure Hash Standard\"]{.refTitle}, [FIPS PUB
    180-1]{.seriesInfo}, [DOI 10.6028/NIST.FIPS.180-1]{.seriesInfo},
    April 1995,
    \<<https://csrc.nist.gov/publications/detail/fips/180/1/archive/1995-04-17>\>.
:   

\[FIPS.180-2\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Secure Hash Standard\"]{.refTitle}, [FIPS PUB
    180-2]{.seriesInfo}, August 2002,
    \<<https://csrc.nist.gov/publications/detail/fips/180/2/archive/2002-08-01>\>.
:   

\[Heist2015\]
:   [Scahill, J.]{.refAuthor} and [J. Begley]{.refAuthor}, [\"How Spies
    Stole the Keys to the Encryption Castle\"]{.refTitle}, February
    2015,
    \<<https://firstlook.org/theintercept/2015/02/19/great-sim-heist/>\>.
:   

\[Hussain2019\]
:   [Hussain, S.]{.refAuthor}, [Echeverria, M.]{.refAuthor},
    [Chowdhury, O.]{.refAuthor}, [Li, N.]{.refAuthor}, and [E.
    Bertino]{.refAuthor}, [\"Privacy Attacks to the 4G and 5G Cellular
    Paging Protocols Using Side Channel Information\"]{.refTitle}, [in
    the proceedings of NDSS \'19, held 24-27 February, 2019, San Diego,
    California]{.refContent}, 2019.
:   

\[Kune2012\]
:   [Kune, D.]{.refAuthor}, [Koelndorfer, J.]{.refAuthor},
    [Hopper, N.]{.refAuthor}, and [Y. Kim]{.refAuthor}, [\"Location
    Leaks on the GSM Air Interface\"]{.refTitle}, [in the proceedings of
    NDSS \'12, held 5-8 February, 2012, San Diego,
    California]{.refContent}, 2012.
:   

\[MT2012\]
:   [Mjølsnes, S. F.]{.refAuthor} and [J-K. Tsay]{.refAuthor}, [\"A
    Vulnerability in the UMTS and LTE Authentication and Key Agreement
    Protocols\"]{.refTitle}, [in Computer Network Security, Proceedings
    of the 6th International Conference on Mathematical Methods, Models
    and Architectures for Computer Network Security, Lecture Notes in
    Computer Science, Vol. 7531, pp. 65-76]{.refContent}, [DOI
    10.1007/978-3-642-33704-8_6]{.seriesInfo}, October 2012,
    \<<https://doi.org/10.1007/978-3-642-33704-8_6>\>.
:   

\[RFC3310\]
:   [Niemi, A.]{.refAuthor}, [Arkko, J.]{.refAuthor}, and [V.
    Torvinen]{.refAuthor}, [\"Hypertext Transfer Protocol (HTTP) Digest
    Authentication Using Authentication and Key Agreement
    (AKA)\"]{.refTitle}, [RFC 3310]{.seriesInfo}, [DOI
    10.17487/RFC3310]{.seriesInfo}, September 2002,
    \<<https://www.rfc-editor.org/info/rfc3310>\>.
:   

\[RFC4086\]
:   [Eastlake 3rd, D.]{.refAuthor}, [Schiller, J.]{.refAuthor}, and [S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.
:   

\[RFC4169\]
:   [Torvinen, V.]{.refAuthor}, [Arkko, J.]{.refAuthor}, and [M.
    Naslund]{.refAuthor}, [\"Hypertext Transfer Protocol (HTTP) Digest
    Authentication Using Authentication and Key Agreement (AKA)
    Version-2\"]{.refTitle}, [RFC 4169]{.seriesInfo}, [DOI
    10.17487/RFC4169]{.seriesInfo}, November 2005,
    \<<https://www.rfc-editor.org/info/rfc4169>\>.
:   

\[RFC4186\]
:   [Haverinen, H., Ed.]{.refAuthor} and [J. Salowey, Ed.]{.refAuthor},
    [\"Extensible Authentication Protocol Method for Global System for
    Mobile Communications (GSM) Subscriber Identity Modules
    (EAP-SIM)\"]{.refTitle}, [RFC 4186]{.seriesInfo}, [DOI
    10.17487/RFC4186]{.seriesInfo}, January 2006,
    \<<https://www.rfc-editor.org/info/rfc4186>\>.
:   

\[RFC4284\]
:   [Adrangi, F.]{.refAuthor}, [Lortz, V.]{.refAuthor},
    [Bari, F.]{.refAuthor}, and [P. Eronen]{.refAuthor}, [\"Identity
    Selection Hints for the Extensible Authentication Protocol
    (EAP)\"]{.refTitle}, [RFC 4284]{.seriesInfo}, [DOI
    10.17487/RFC4284]{.seriesInfo}, January 2006,
    \<<https://www.rfc-editor.org/info/rfc4284>\>.
:   

\[RFC4306\]
:   [Kaufman, C., Ed.]{.refAuthor}, [\"Internet Key Exchange (IKEv2)
    Protocol\"]{.refTitle}, [RFC 4306]{.seriesInfo}, [DOI
    10.17487/RFC4306]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4306>\>.
:   

\[RFC5113\]
:   [Arkko, J.]{.refAuthor}, [Aboba, B.]{.refAuthor}, [Korhonen, J.,
    Ed.]{.refAuthor}, and [F. Bari]{.refAuthor}, [\"Network Discovery
    and Selection Problem\"]{.refTitle}, [RFC 5113]{.seriesInfo}, [DOI
    10.17487/RFC5113]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5113>\>.
:   

\[RFC5247\]
:   [Aboba, B.]{.refAuthor}, [Simon, D.]{.refAuthor}, and [P.
    Eronen]{.refAuthor}, [\"Extensible Authentication Protocol (EAP) Key
    Management Framework\"]{.refTitle}, [RFC 5247]{.seriesInfo}, [DOI
    10.17487/RFC5247]{.seriesInfo}, August 2008,
    \<<https://www.rfc-editor.org/info/rfc5247>\>.
:   

\[RFC5281\]
:   [Funk, P.]{.refAuthor} and [S. Blake-Wilson]{.refAuthor},
    [\"Extensible Authentication Protocol Tunneled Transport Layer
    Security Authenticated Protocol Version 0
    (EAP-TTLSv0)\"]{.refTitle}, [RFC 5281]{.seriesInfo}, [DOI
    10.17487/RFC5281]{.seriesInfo}, August 2008,
    \<<https://www.rfc-editor.org/info/rfc5281>\>.
:   

\[RFC5448\]
:   [Arkko, J.]{.refAuthor}, [Lehtovirta, V.]{.refAuthor}, and [P.
    Eronen]{.refAuthor}, [\"Improved Extensible Authentication Protocol
    Method for 3rd Generation Authentication and Key Agreement
    (EAP-AKA\')\"]{.refTitle}, [RFC 5448]{.seriesInfo}, [DOI
    10.17487/RFC5448]{.seriesInfo}, May 2009,
    \<<https://www.rfc-editor.org/info/rfc5448>\>.
:   

\[RFC6194\]
:   [Polk, T.]{.refAuthor}, [Chen, L.]{.refAuthor},
    [Turner, S.]{.refAuthor}, and [P. Hoffman]{.refAuthor}, [\"Security
    Considerations for the SHA-0 and SHA-1 Message-Digest
    Algorithms\"]{.refTitle}, [RFC 6194]{.seriesInfo}, [DOI
    10.17487/RFC6194]{.seriesInfo}, March 2011,
    \<<https://www.rfc-editor.org/info/rfc6194>\>.
:   

\[RFC6973\]
:   [Cooper, A.]{.refAuthor}, [Tschofenig, H.]{.refAuthor},
    [Aboba, B.]{.refAuthor}, [Peterson, J.]{.refAuthor},
    [Morris, J.]{.refAuthor}, [Hansen, M.]{.refAuthor}, and [R.
    Smith]{.refAuthor}, [\"Privacy Considerations for Internet
    Protocols\"]{.refTitle}, [RFC 6973]{.seriesInfo}, [DOI
    10.17487/RFC6973]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6973>\>.
:   

\[RFC7170\]
:   [Zhou, H.]{.refAuthor}, [Cam-Winget, N.]{.refAuthor},
    [Salowey, J.]{.refAuthor}, and [S. Hanna]{.refAuthor}, [\"Tunnel
    Extensible Authentication Protocol (TEAP) Version 1\"]{.refTitle},
    [RFC 7170]{.seriesInfo}, [DOI 10.17487/RFC7170]{.seriesInfo}, May
    2014, \<<https://www.rfc-editor.org/info/rfc7170>\>.
:   

\[RFC7258\]
:   [Farrell, S.]{.refAuthor} and [H. Tschofenig]{.refAuthor},
    [\"Pervasive Monitoring Is an Attack\"]{.refTitle}, [BCP
    188]{.seriesInfo}, [RFC 7258]{.seriesInfo}, [DOI
    10.17487/RFC7258]{.seriesInfo}, May 2014,
    \<<https://www.rfc-editor.org/info/rfc7258>\>.
:   

\[RFC7296\]
:   [Kaufman, C.]{.refAuthor}, [Hoffman, P.]{.refAuthor},
    [Nir, Y.]{.refAuthor}, [Eronen, P.]{.refAuthor}, and [T.
    Kivinen]{.refAuthor}, [\"Internet Key Exchange Protocol Version 2
    (IKEv2)\"]{.refTitle}, [STD 79]{.seriesInfo}, [RFC
    7296]{.seriesInfo}, [DOI 10.17487/RFC7296]{.seriesInfo}, October
    2014, \<<https://www.rfc-editor.org/info/rfc7296>\>.
:   

\[Shaik2016\]
:   [Shaik, A.]{.refAuthor}, [Seifert, J.]{.refAuthor},
    [Borgaonkar, R.]{.refAuthor}, [Asokan, N.]{.refAuthor}, and [V.
    Niemi]{.refAuthor}, [\"Practical attacks against Privacy and
    Availability in 4G/LTE Mobile Communication Systems\"]{.refTitle},
    [in the proceedings of NDSS \'16 held 21-24 February, 2016, San
    Diego, California]{.refContent}, 2012.
:   

\[TS-3GPP.35.208\]
:   [3GPP]{.refAuthor}, [\"3rd Generation Partnership Project; Technical
    Specification Group Services and System Aspects; 3G Security;
    Specification of the MILENAGE Algorithm Set: An example algorithm
    set for the 3GPP authentication and key generation functions f1,
    f1\*, f2, f3, f4, f5 and f5\*; Document 4: Design Conformance Test
    Data (Release 14)\"]{.refTitle}, [Version 16.0.0]{.refContent},
    [3GPP Technical Specification 35.208]{.seriesInfo}, July 2020.
:   

\[ZF2005\]
:   [Zhang, M.]{.refAuthor} and [Y. Fang]{.refAuthor}, [\"Security
    analysis and enhancements of 3GPP authentication and key agreement
    protocol\"]{.refTitle}, [IEEE Transactions on Wireless
    Communications, Vol. 4, No. 2]{.refContent}, [DOI
    10.1109/TWC.2004.842941]{.seriesInfo}, March 2005,
    \<<https://doi.org/10.1109/TWC.2004.842941>\>.
:   
:::
:::

::: {#diff2}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Changes from RFC 5448](#name-changes-from-rfc-5448){.section-name .selfRef} {#name-changes-from-rfc-5448}

The change from RFC 5448 was to refer to a newer version of
\[[TS-3GPP.24.302](#TS-3GPP.24.302){.xref}\]. This RFC includes an
updated definition of the Network Name field to include
5G.[¶](#appendix-A-1){.pilcrow}

Identifier usage for 5G has been specified in [Section
5.3](#identifiersin5g){.xref}. Also, the requirements for generating
pseudonym usernames and fast re-authentication identities have been
updated from the original definition in RFC 5448, which referenced RFC
4187. See [Section 5](#identities){.xref}.[¶](#appendix-A-2){.pilcrow}

Exported parameters for EAP-AKA\' have been defined in [Section
6](#exported-parameters){.xref}, as required by
\[[RFC5247](#RFC5247){.xref}\], including the definition of those
parameters for both full authentication and fast
re-authentication.[¶](#appendix-A-3){.pilcrow}

The security, privacy, and pervasive monitoring considerations have been
updated or added. See [Section
7](#security){.xref}.[¶](#appendix-A-4){.pilcrow}

The references to \[[RFC2119](#RFC2119){.xref}\],
\[[RFC4306](#RFC4306){.xref}\], \[[RFC7296](#RFC7296){.xref}\],
\[[FIPS.180-1](#FIPS.180-1){.xref}\] and
\[[FIPS.180-2](#FIPS.180-2){.xref}\] have been updated to their most
recent versions, and language in this document has been changed
accordingly. However, these are merely reference updates to newer
specifications; the actual protocol functions are the same as defined in
the earlier RFCs.[¶](#appendix-A-5){.pilcrow}

Similarly, references to all 3GPP technical specifications have been
updated to their 5G versions (Release 16) or otherwise most recent
version when there has not been a 5G-related
update.[¶](#appendix-A-6){.pilcrow}

Finally, a number of clarifications have been made, including a summary
of where attributes may appear.[¶](#appendix-A-7){.pilcrow}
:::
:::

::: {#diff}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [Changes to RFC 4187](#name-changes-to-rfc-4187){.section-name .selfRef} {#name-changes-to-rfc-4187}

In addition to specifying EAP-AKA\', this document also mandates a
change to another EAP method \-- EAP-AKA that was defined in RFC 4187.
This change was already mandated in RFC 5448 but repeated here to ensure
that the latest EAP-AKA\' specification contains the instructions about
the necessary bidding down prevention feature in EAP-AKA as
well.[¶](#appendix-B-1){.pilcrow}

The changes to RFC 4187 relate only to the bidding down prevention
support defined in [Section 4](#bidding){.xref}. In particular, this
document does not change how the Master Key (MK) is calculated or any
other aspect of EAP-AKA. The provisions in this specification for
EAP-AKA\' do not apply to EAP-AKA, outside of [Section
4](#bidding){.xref}.[¶](#appendix-B-2){.pilcrow}
:::
:::

::: {#baddesign}
::: {#appendix-C .section}
## [Appendix C.](#appendix-C){.section-number .selfRef} [Importance of Explicit Negotiation](#name-importance-of-explicit-nego){.section-name .selfRef} {#name-importance-of-explicit-nego}

Choosing between the traditional and revised AKA key derivation
functions is easy when their use is unambiguously tied to a particular
radio access network, e.g., Long Term Evolution (LTE) as defined by 3GPP
or evolved High Rate Packet Data (eHRPD) as defined by 3GPP2. There is
no possibility for interoperability problems if this radio access
network is always used in conjunction with new protocols that cannot be
mixed with the old ones; clients will always know whether they are
connecting to the old or new system.[¶](#appendix-C-1){.pilcrow}

However, using the new key derivation functions over EAP introduces
several degrees of separation, making the choice of the correct key
derivation functions much harder. Many different types of networks
employ EAP. Most of these networks have no means to carry any
information about what is expected from the authentication process. EAP
itself is severely limited in carrying any additional information, as
noted in \[[RFC4284](#RFC4284){.xref}\] and
\[[RFC5113](#RFC5113){.xref}\]. Even if these networks or EAP were
extended to carry additional information, it would not affect millions
of deployed access networks and clients attaching to
them.[¶](#appendix-C-2){.pilcrow}

Simply changing the key derivation functions that EAP-AKA
\[[RFC4187](#RFC4187){.xref}\] uses would cause interoperability
problems with all of the existing implementations. Perhaps it would be
possible to employ strict separation into domain names that should be
used by the new clients and networks. Only these new devices would then
employ the new key derivation function. While this can be made to work
for specific cases, it would be an extremely brittle mechanism, ripe to
result in problems whenever client configuration, routing of
authentication requests, or server configuration does not match
expectations. It also does not help to assume that the EAP client and
server are running a particular release of 3GPP network specifications.
Network vendors often provide features from future releases early or do
not provide all features of the current release. And obviously, there
are many EAP and even some EAP-AKA implementations that are not bundled
with the 3GPP network offerings. In general, these approaches are
expected to lead to hard-to-diagnose problems and increased support
calls.[¶](#appendix-C-3){.pilcrow}
:::
:::

::: {#testvectors}
::: {#appendix-D .section}
## [Appendix D.](#appendix-D){.section-number .selfRef} [Test Vectors](#name-test-vectors){.section-name .selfRef} {#name-test-vectors}

Test vectors are provided below for four different cases. The test
vectors may be useful for testing implementations. In the first two
cases, we employ the MILENAGE algorithm and the algorithm configuration
parameters (the subscriber key K and operator algorithm variant
configuration value OP) from test set 19 in
\[[TS-3GPP.35.208](#TS-3GPP.35.208){.xref}\].[¶](#appendix-D-1){.pilcrow}

The last two cases use artificial values as the output of AKA, which are
useful only for testing the computation of values within EAP-AKA\', not
AKA itself.[¶](#appendix-D-2){.pilcrow}

Case 1[¶](#appendix-D-3){.pilcrow}

::: {#appendix-D-4}
``` {.lang-test-vectors .sourcecode}
   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "WLAN"

      RAND:         81e9 2b6c 0ee0 e12e bceb a8d9 2a99 dfa5

      AUTN:         bb52 e91c 747a c3ab 2a5c 23d1 5ee3 51d5

      IK:           9744 871a d32b f9bb d1dd 5ce5 4e3e 2e5a

      CK:           5349 fbe0 9864 9f94 8f5d 2e97 3a81 c00f

      RES:          28d7 b0f2 a2ec 3de5

   Then the derived keys are generated as follows:

      CK':          0093 962d 0dd8 4aa5 684b 045c 9edf fa04

      IK':          ccfc 230c a74f cc96 c0a5 d611 64f5 a76c

      K_encr:       766f a0a6 c317 174b 812d 52fb cd11 a179

      K_aut:        0842 ea72 2ff6 835b fa20 3249 9fc3 ec23
                    c2f0 e388 b4f0 7543 ffc6 77f1 696d 71ea

      K_re:         cf83 aa8b c7e0 aced 892a cc98 e76a 9b20
                    95b5 58c7 795c 7094 715c b339 3aa7 d17a

      MSK:          67c4 2d9a a56c 1b79 e295 e345 9fc3 d187
                    d42b e0bf 818d 3070 e362 c5e9 67a4 d544
                    e8ec fe19 358a b303 9aff 03b7 c930 588c
                    055b abee 58a0 2650 b067 ec4e 9347 c75a

      EMSK:         f861 703c d775 590e 16c7 679e a387 4ada
                    8663 11de 2907 64d7 60cf 76df 647e a01c
                    313f 6992 4bdd 7650 ca9b ac14 1ea0 75c4
                    ef9e 8029 c0e2 90cd bad5 638b 63bc 23fb
```

[¶](#appendix-D-4){.pilcrow}
:::

Case 2[¶](#appendix-D-5){.pilcrow}

::: {#appendix-D-6}
``` {.lang-test-vectors .sourcecode}
   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "HRPD"

      RAND:         81e9 2b6c 0ee0 e12e bceb a8d9 2a99 dfa5

      AUTN:         bb52 e91c 747a c3ab 2a5c 23d1 5ee3 51d5

      IK:           9744 871a d32b f9bb d1dd 5ce5 4e3e 2e5a

      CK:           5349 fbe0 9864 9f94 8f5d 2e97 3a81 c00f

      RES:          28d7 b0f2 a2ec 3de5

   Then the derived keys are generated as follows:

      CK':          3820 f027 7fa5 f777 32b1 fb1d 90c1 a0da

      IK':          db94 a0ab 557e f6c9 ab48 619c a05b 9a9f

      K_encr:       05ad 73ac 915f ce89 ac77 e152 0d82 187b

      K_aut:        5b4a caef 62c6 ebb8 882b 2f3d 534c 4b35
                    2773 37a0 0184 f20f f25d 224c 04be 2afd

      K_re:         3f90 bf5c 6e5e f325 ff04 eb5e f653 9fa8
                    cca8 3981 94fb d00b e425 b3f4 0dba 10ac

      MSK:          87b3 2157 0117 cd6c 95ab 6c43 6fb5 073f
                    f15c f855 05d2 bc5b b735 5fc2 1ea8 a757
                    57e8 f86a 2b13 8002 e057 5291 3bb4 3b82
                    f868 a961 17e9 1a2d 95f5 2667 7d57 2900

      EMSK:         c891 d5f2 0f14 8a10 0755 3e2d ea55 5c9c
                    b672 e967 5f4a 66b4 bafa 0273 79f9 3aee
                    539a 5979 d0a0 042b 9d2a e28b ed3b 17a3
                    1dc8 ab75 072b 80bd 0c1d a612 466e 402c
```

[¶](#appendix-D-6){.pilcrow}
:::

Case 3[¶](#appendix-D-7){.pilcrow}

::: {#appendix-D-8}
``` {.lang-test-vectors .sourcecode}
   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "WLAN"

      RAND:         e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0

      AUTN:         a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0

      IK:           b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0

      CK:           c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0

      RES:          d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0

   Then the derived keys are generated as follows:

      CK':          cd4c 8e5c 68f5 7dd1 d7d7 dfd0 c538 e577

      IK':          3ece 6b70 5dbb f7df c459 a112 80c6 5524

      K_encr:       897d 302f a284 7416 488c 28e2 0dcb 7be4

      K_aut:        c407 00e7 7224 83ae 3dc7 139e b0b8 8bb5
                    58cb 3081 eccd 057f 9207 d128 6ee7 dd53

      K_re:         0a59 1a22 dd8b 5b1c f29e 3d50 8c91 dbbd
                    b4ae e230 5189 2c42 b6a2 de66 ea50 4473

      MSK:          9f7d ca9e 37bb 2202 9ed9 86e7 cd09 d4a7
                    0d1a c76d 9553 5c5c ac40 a750 4699 bb89
                    61a2 9ef6 f3e9 0f18 3de5 861a d1be dc81
                    ce99 1639 1b40 1aa0 06c9 8785 a575 6df7

      EMSK:         724d e00b db9e 5681 87be 3fe7 4611 4557
                    d501 8779 537e e37f 4d3c 6c73 8cb9 7b9d
                    c651 bc19 bfad c344 ffe2 b52c a78b d831
                    6b51 dacc 5f2b 1440 cb95 1552 1cc7 ba23
```

[¶](#appendix-D-8){.pilcrow}
:::

Case 4[¶](#appendix-D-9){.pilcrow}

::: {#appendix-D-10}
``` {.lang-test-vectors .sourcecode}
   The parameters for the AKA run are as follows:

      Identity:     "0555444333222111"

      Network name: "HRPD"

      RAND:         e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0 e0e0

      AUTN:         a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0 a0a0

      IK:           b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0 b0b0

      CK:           c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0 c0c0

      RES:          d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0 d0d0

   Then the derived keys are generated as follows:

      CK':          8310 a71c e6f7 5488 9613 da8f 64d5 fb46

      IK':          5adf 1436 0ae8 3819 2db2 3f6f cb7f 8c76

      K_encr:       745e 7439 ba23 8f50 fcac 4d15 d47c d1d9

      K_aut:        3e1d 2aa4 e677 025c fd86 2a4b e183 61a1
                    3a64 5765 5714 63df 833a 9759 e809 9879

      K_re:         99da 835e 2ae8 2462 576f e651 6fad 1f80
                    2f0f a119 1655 dd0a 273d a96d 04e0 fcd3

      MSK:          c6d3 a6e0 ceea 951e b20d 74f3 2c30 61d0
                    680a 04b0 b086 ee87 00ac e3e0 b95f a026
                    83c2 87be ee44 4322 94ff 98af 26d2 cc78
                    3bac e75c 4b0a f7fd feb5 511b a8e4 cbd0

      EMSK:         7fb5 6813 838a dafa 99d1 40c2 f198 f6da
                    cebf b6af ee44 4961 1054 02b5 08c7 f363
                    352c b291 9644 b504 63e6 a693 5415 0147
                    ae09 cbc5 4b8a 651d 8787 a689 3ed8 536d
```

[¶](#appendix-D-10){.pilcrow}
:::
:::
:::

::: {#appendix-E .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors would like to thank [Guenther Horn]{.contact-name}, [Joe
Salowey]{.contact-name}, [Mats Naslund]{.contact-name}, [Adrian
Escott]{.contact-name}, [Brian Rosenberg]{.contact-name}, [Laksminath
Dondeti]{.contact-name}, [Ahmad Muhanna]{.contact-name}, [Stefan
Rommer]{.contact-name}, [Miguel Garcia]{.contact-name}, [Jan
Kall]{.contact-name}, [Ankur Agarwal]{.contact-name}, [Jouni
Malinen]{.contact-name}, [John Mattsson]{.contact-name}, [Jesus De
Gregorio]{.contact-name}, [Brian Weis]{.contact-name}, [Russ
Housley]{.contact-name}, [Alfred Hoenes]{.contact-name}, [Anand
Palanigounder]{.contact-name}, [Michael Richardson]{.contact-name},
[Roman Danyliw]{.contact-name}, [Dan Romascanu]{.contact-name}, [Kyle
Rose]{.contact-name}, [Benjamin Kaduk]{.contact-name}, [Alissa
Cooper]{.contact-name}, [Erik Kline]{.contact-name}, [Murray
Kucherawy]{.contact-name}, [Robert Wilton]{.contact-name}, [Warren
Kumari]{.contact-name}, [Andreas Kunz]{.contact-name}, [Marcus
Wong]{.contact-name}, [Kalle Jarvinen]{.contact-name}, [Daniel
Migault]{.contact-name}, and [Mohit Sethi]{.contact-name} for their
in-depth reviews and interesting discussions in this problem
space.[¶](#appendix-E-1){.pilcrow}
:::

::: {#appendix-F .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The test vectors in [Appendix D](#testvectors){.xref} were provided by
[Yogendra Pal]{.contact-name} and [Jouni Malinen]{.contact-name}, based
on two independent implementations of this
specification.[¶](#appendix-F-1){.pilcrow}

[Jouni Malinen]{.contact-name} provided suggested text for [Section
6](#exported-parameters){.xref}. [John Mattsson]{.contact-name} provided
much of the text for [Section 7.1](#priv){.xref}. Karl Norrman was the
source of much of the information in [Section
7.2](#vuln){.xref}.[¶](#appendix-F-2){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-G .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Jari Arkko]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
FI-[02420]{.postal-code} [Jorvas]{.locality}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <jari.arkko@piuha.net>
:::

::: {.left dir="auto"}
[Vesa Lehtovirta]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
FI-[02420]{.postal-code} [Jorvas]{.locality}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <vesa.lehtovirta@ericsson.com>
:::

::: {.left dir="auto"}
[Vesa Torvinen]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
FI-[02420]{.postal-code} [Jorvas]{.locality}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <vesa.torvinen@ericsson.com>
:::

::: {.left dir="auto"}
[Pasi Eronen]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Independent]{.org}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <pe@iki.fi>
:::
:::
:::
