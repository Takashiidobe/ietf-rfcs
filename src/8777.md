  RFC 8777   DRIAD             April 2020
  ---------- ----------------- ------------
  Holland    Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8777](https://www.rfc-editor.org/rfc/rfc8777){.eref}

Updates:
:   [7450](https://www.rfc-editor.org/rfc/rfc7450){.eref}

Category:
:   Standards Track

Published:
:   April 2020

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    J. Holland
    :::

    ::: org
    Akamai Technologies, Inc.
    :::
    :::
:::

# RFC 8777 {#rfcnum}

# DNS Reverse IP Automatic Multicast Tunneling (AMT) Discovery {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document updates RFC 7450, \"Automatic Multicast Tunneling\" (or
AMT), by modifying the relay discovery process. A new DNS resource
record named AMTRELAY is defined for publishing AMT relays for
source-specific multicast channels. The reverse IP DNS zone for a
multicast sender\'s IP address is configured to use AMTRELAY resource
records to advertise a set of AMT relays that can receive and forward
multicast traffic from that sender over an AMT tunnel. Other extensions
and clarifications to the relay discovery process are also
defined.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8777>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Background](#name-background){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.1.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.1.2.2.2.1}
            [1.2.1](#section-1.2.1){.xref}.  [Relays and
            Gateways](#name-relays-and-gateways){.xref}[¶](#section-toc.1-1.1.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.1.2.2.2.2}
            [1.2.2](#section-1.2.2){.xref}.  [Definitions](#name-definitions){.xref}[¶](#section-toc.1-1.1.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.1.2.2.2.3}
            [1.2.3](#section-1.2.3){.xref}.  [Requirements
            Language](#name-requirements-language){.xref}[¶](#section-toc.1-1.1.2.2.2.3.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Relay Discovery
    Overview](#name-relay-discovery-overview){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Basic
        Mechanics](#name-basic-mechanics){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Signaling and
        Discovery](#name-signaling-and-discovery){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Example
        Deployments](#name-example-deployments){.xref}[¶](#section-toc.1-1.2.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.2.2.3.2.1}
            [2.3.1](#section-2.3.1){.xref}.  [Example Receiving
            Networks](#name-example-receiving-networks){.xref}[¶](#section-toc.1-1.2.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.2.2.3.2.2}
            [2.3.2](#section-2.3.2){.xref}.  [Example Sending
            Networks](#name-example-sending-networks){.xref}[¶](#section-toc.1-1.2.2.3.2.2.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Relay Discovery
    Operation](#name-relay-discovery-operation){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Optimal Relay
        Selection](#name-optimal-relay-selection){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.1.2.1}
            [3.1.1](#section-3.1.1){.xref}.  [Overview](#name-overview){.xref}[¶](#section-toc.1-1.3.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.1.2.2}
            [3.1.2](#section-3.1.2){.xref}.  [Preference
            Ordering](#name-preference-ordering){.xref}[¶](#section-toc.1-1.3.2.1.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.1.2.3}
            [3.1.3](#section-3.1.3){.xref}.  [Connecting to Multiple
            Relays](#name-connecting-to-multiple-rela){.xref}[¶](#section-toc.1-1.3.2.1.2.3.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Happy
        Eyeballs](#name-happy-eyeballs){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [Overview](#name-overview-2){.xref}[¶](#section-toc.1-1.3.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.xref}.  [Algorithm
            Guidelines](#name-algorithm-guidelines){.xref}[¶](#section-toc.1-1.3.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.3}
            [3.2.3](#section-3.2.3){.xref}.  [Connection
            Definition](#name-connection-definition){.xref}[¶](#section-toc.1-1.3.2.2.2.3.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Guidelines for Restarting
        Discovery](#name-guidelines-for-restarting-d){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [Overview](#name-overview-3){.xref}[¶](#section-toc.1-1.3.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.2}
            [3.3.2](#section-3.3.2){.xref}.  [Updates to Restarting
            Events](#name-updates-to-restarting-event){.xref}[¶](#section-toc.1-1.3.2.3.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.3}
            [3.3.3](#section-3.3.3){.xref}.  [Tunnel
            Stability](#name-tunnel-stability){.xref}[¶](#section-toc.1-1.3.2.3.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.4}
            [3.3.4](#section-3.3.4){.xref}.  [Traffic
            Health](#name-traffic-health){.xref}[¶](#section-toc.1-1.3.2.3.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.5}
            [3.3.5](#section-3.3.5){.xref}.  [Relay Loaded or Shutting
            Down](#name-relay-loaded-or-shutting-do){.xref}[¶](#section-toc.1-1.3.2.3.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.6}
            [3.3.6](#section-3.3.6){.xref}.  [Relay Discovery Messages
            vs. Restarting
            Discovery](#name-relay-discovery-messages-vs){.xref}[¶](#section-toc.1-1.3.2.3.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.7}
            [3.3.7](#section-3.3.7){.xref}.  [Independent Discovery per
            Traffic
            Source](#name-independent-discovery-per-t){.xref}[¶](#section-toc.1-1.3.2.3.2.7.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [DNS
        Configuration](#name-dns-configuration){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Waiting for DNS
        Resolution](#name-waiting-for-dns-resolution){.xref}[¶](#section-toc.1-1.3.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [AMTRELAY Resource Record
    Definition](#name-amtrelay-resource-record-de){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [AMTRELAY
        RRType](#name-amtrelay-rrtype){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [AMTRELAY RData
        Format](#name-amtrelay-rdata-format){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [RData Format -
            Precedence](#name-rdata-format-precedence){.xref}[¶](#section-toc.1-1.4.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [RData Format - Discovery
            Optional
            (D-bit)](#name-rdata-format-discovery-opti){.xref}[¶](#section-toc.1-1.4.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.3}
            [4.2.3](#section-4.2.3){.xref}.  [RData Format -
            Type](#name-rdata-format-type){.xref}[¶](#section-toc.1-1.4.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.4}
            [4.2.4](#section-4.2.4){.xref}.  [RData Format -
            Relay](#name-rdata-format-relay){.xref}[¶](#section-toc.1-1.4.2.2.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [AMTRELAY Record Presentation
        Format](#name-amtrelay-record-presentatio){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.3.2.1}
            [4.3.1](#section-4.3.1){.xref}.  [Representation of AMTRELAY
            RRs](#name-representation-of-amtrelay-){.xref}[¶](#section-toc.1-1.4.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.2}
            [4.3.2](#section-4.3.2){.xref}.  [Examples](#name-examples){.xref}[¶](#section-toc.1-1.4.2.3.2.2.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Use of
        AMT](#name-use-of-amt){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Record-Spoofing](#name-record-spoofing){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Congestion](#name-congestion){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [Appendix A](#section-appendix.a){.xref}.  [Unknown RRType
    Construction](#name-unknown-rrtype-construction){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [](#section-appendix.b){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [](#section-appendix.c){.xref}[Author\'s
    Address](#name-authors-address){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document defines DNS Reverse IP AMT Discovery (DRIAD), a mechanism
for AMT gateways to discover AMT relays that are capable of forwarding
multicast traffic from a known source IP
address.[¶](#section-1-1){.pilcrow}

AMT (Automatic Multicast Tunneling) is defined in
\[[RFC7450](#RFC7450){.xref}\] and provides a method to transport
multicast traffic over a unicast tunnel in order to traverse network
segments that are not multicast capable.[¶](#section-1-2){.pilcrow}

[Section
4.1.5](https://www.rfc-editor.org/rfc/rfc7450#section-4.1.5){.relref} of
\[[RFC7450](#RFC7450){.xref}\] explains that the relay selection process
for AMT is intended to be more flexible than the particular discovery
method described in that document. That section further explains that
the selection process might need to depend on the source of the
multicast traffic in some deployments, since a relay must be able to
receive multicast traffic from the desired source in order to forward
it.[¶](#section-1-3){.pilcrow}

[Section
4.1.5](https://www.rfc-editor.org/rfc/rfc7450#section-4.1.5){.relref} of
\[[RFC7450](#RFC7450){.xref}\] goes on to suggest DNS-based queries as a
possible solution: DRIAD is DNS based. This solution also addresses the
relay discovery issues in the \"Disadvantages of this configuration\"
lists in Sections
[3.3](https://www.rfc-editor.org/rfc/rfc8313#section-3.3){.relref} and
[3.4](https://www.rfc-editor.org/rfc/rfc8313#section-3.4){.relref} of
\[[RFC8313](#RFC8313){.xref}\].[¶](#section-1-4){.pilcrow}

The goal for DRIAD is to enable multicast connectivity between separate
multicast-enabled networks without preconfiguring any peering
arrangements between the networks when neither the sending nor the
receiving network is connected to a multicast-enabled
backbone.[¶](#section-1-5){.pilcrow}

This document extends the relay discovery procedure described in
[Section
5.2.3.4](https://www.rfc-editor.org/rfc/rfc7450#section-5.2.3.4){.relref}
of \[[RFC7450](#RFC7450){.xref}\].[¶](#section-1-6){.pilcrow}

::: {#background}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Background](#name-background){.section-name .selfRef} {#name-background}

The reader is assumed to be familiar with the basic DNS concepts
described in \[[RFC1034](#RFC1034){.xref}\],
\[[RFC1035](#RFC1035){.xref}\], and the subsequent documents that update
them, particularly
\[[RFC2181](#RFC2181){.xref}\].[¶](#section-1.1-1){.pilcrow}

The reader is also assumed to be familiar with the concepts and
terminology regarding source-specific multicast as described in
\[[RFC4607](#RFC4607){.xref}\] and the use of Internet Group Management
Protocol Version 3 (IGMPv3) \[[RFC3376](#RFC3376){.xref}\] and Multicast
Listener Discovery Version 2 (MLDv2) \[[RFC3810](#RFC3810){.xref}\] for
group management of source-specific multicast channels, as described in
\[[RFC4604](#RFC4604){.xref}\].[¶](#section-1.1-2){.pilcrow}

The reader should also be familiar with AMT, particularly the
terminology listed in Sections
[3.2](https://www.rfc-editor.org/rfc/rfc7450#section-3.2){.relref} and
[3.3](https://www.rfc-editor.org/rfc/rfc7450#section-3.3){.relref} of
\[[RFC7450](#RFC7450){.xref}\].[¶](#section-1.1-3){.pilcrow}
:::
:::

::: {#terminology}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

::: {#relays-and-gateways}
::: {#section-1.2.1 .section}
#### [1.2.1.](#section-1.2.1){.section-number .selfRef} [Relays and Gateways](#name-relays-and-gateways){.section-name .selfRef} {#name-relays-and-gateways}

When reading this document, it\'s especially helpful to recall that once
an AMT tunnel is established, the relay receives native multicast
traffic and sends unicast tunnel-encapsulated traffic to the gateway.
The gateway receives the tunnel-encapsulated packets, decapsulates them,
and forwards them as native multicast packets, as illustrated in [Figure
1](#figtunnel){.xref}.[¶](#section-1.2.1-1){.pilcrow}

[]{#name-amt-tunnel-illustration}

::: {#figtunnel}
::: {#section-1.2.1-2.1 .artwork .art-text .alignLeft}

      Multicast  +-----------+  Unicast  +-------------+  Multicast
     >---------> | AMT relay | >=======> | AMT gateway | >--------->
                 +-----------+           +-------------+
:::

[Figure 1](#figure-1){.selfRef}: [AMT Tunnel
Illustration](#name-amt-tunnel-illustration){.selfRef}
:::
:::
:::

::: {#definitions}
::: {#section-1.2.2 .section}
#### [1.2.2.](#section-1.2.2){.section-number .selfRef} [Definitions](#name-definitions){.section-name .selfRef} {#name-definitions}

[]{#name-definitions-2}

  Term               Definition
  ------------------ ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  (S,G)              A source-specific multicast channel, as described in \[[RFC4607](#RFC4607){.xref}\]. A pair of IP addresses with a source host IP and destination group IP.
  CMTS               Cable Modem Termination System
  discovery broker   A broker or load balancer for AMT relay discovery, as mentioned in [Section 4.2.1.1](https://www.rfc-editor.org/rfc/rfc7450#section-4.2.1.1){.relref} of \[[RFC7450](#RFC7450){.xref}\].
  downstream         Further from the source of traffic, as described in \[[RFC7450](#RFC7450){.xref}\].
  FQDN               Fully Qualified Domain Name, as described in \[[RFC8499](#RFC8499){.xref}\].
  gateway            An AMT gateway, as described in \[[RFC7450](#RFC7450){.xref}\].
  L flag             The \"Limit\" flag described in [Section 5.1.4.4](https://www.rfc-editor.org/rfc/rfc7450#section-5.1.4.4){.relref} of \[[RFC7450](#RFC7450){.xref}\].
  OLT                Optical Line Terminal
  relay              An AMT relay, as described in \[[RFC7450](#RFC7450){.xref}\].
  RPF                Reverse Path Forwarding, as described in \[[RFC5110](#RFC5110){.xref}\].
  RR                 A DNS Resource Record, as described in \[[RFC1034](#RFC1034){.xref}\].
  RRType             A DNS Resource Record Type, as described in \[[RFC1034](#RFC1034){.xref}\].
  SSM                Source-specific multicast, as described in \[[RFC4607](#RFC4607){.xref}\].
  upstream           Closer to the source of traffic, as described in \[[RFC7450](#RFC7450){.xref}\].

  : [Table 1](#table-1){.selfRef}:
  [Definitions](#name-definitions-2){.selfRef}
:::
:::

::: {#reqs}
::: {#section-1.2.3 .section}
#### [1.2.3.](#section-1.2.3){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.2.3-1){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#relay-discovery-overview}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Relay Discovery Overview](#name-relay-discovery-overview){.section-name .selfRef} {#name-relay-discovery-overview}

::: {#basic-mechanics}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Basic Mechanics](#name-basic-mechanics){.section-name .selfRef} {#name-basic-mechanics}

The AMTRELAY resource record (RR) defined in this document is used to
publish the IP address or domain name of a set of AMT relays or
discovery brokers that can receive, encapsulate, and forward multicast
traffic from a particular sender.[¶](#section-2.1-1){.pilcrow}

The sender is the owner of the RR and configures the zone so that it
contains a set of RRs that provide the addresses or domain names of AMT
relays (or discovery brokers that advertise relays) that can receive
multicast IP traffic from that sender.[¶](#section-2.1-2){.pilcrow}

This enables AMT gateways in remote networks to discover an AMT relay
that is capable of forwarding traffic from the sender. This, in turn,
enables those AMT gateways to receive the multicast traffic tunneled
over a unicast AMT tunnel from those relays and then pass the multicast
packets into networks or applications that are using the gateway to
subscribe to traffic from that sender.[¶](#section-2.1-3){.pilcrow}

This mechanism only works for source-specific multicast (SSM) channels.
The source address of the (S,G) is reversed and used as an index into
one of the reverse mapping trees (in-addr.arpa for IPv4, as described in
[Section
3.5](https://www.rfc-editor.org/rfc/rfc1035#section-3.5){.relref} of
\[[RFC1035](#RFC1035){.xref}\], or ip6.arpa for IPv6, as described in
[Section
2.5](https://www.rfc-editor.org/rfc/rfc3596#section-2.5){.relref} of
\[[RFC3596](#RFC3596){.xref}\]).[¶](#section-2.1-4){.pilcrow}

This mechanism should be treated as an extension of the AMT relay
discovery procedure described in [Section
5.2.3.4](https://www.rfc-editor.org/rfc/rfc7450#section-5.2.3.4){.relref}
of \[[RFC7450](#RFC7450){.xref}\]. A gateway that supports this method
of AMT relay discovery [SHOULD]{.bcp14} use this method whenever it\'s
performing the relay discovery procedure, the source IP addresses for
desired (S,G)s are known to the gateway, and conditions match the
requirements outlined in [Section
3.1](#priority){.xref}.[¶](#section-2.1-5){.pilcrow}

Some detailed example use cases are provided in [Section
2.3](#exampledeployments){.xref}, and other applicable example
topologies appear in Sections
[3.3](https://www.rfc-editor.org/rfc/rfc8313#section-3.3){.relref},
[3.4](https://www.rfc-editor.org/rfc/rfc8313#section-3.4){.relref}, and
[3.5](https://www.rfc-editor.org/rfc/rfc8313#section-3.5){.relref} of
\[[RFC8313](#RFC8313){.xref}\].[¶](#section-2.1-6){.pilcrow}
:::
:::

::: {#signaling-and-discovery}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Signaling and Discovery](#name-signaling-and-discovery){.section-name .selfRef} {#name-signaling-and-discovery}

This section describes a typical example of the end-to-end process for
signaling a receiver\'s join of an SSM channel that relies on an
AMTRELAY RR.[¶](#section-2.2-1){.pilcrow}

The example in [Figure 2](#figmessaging){.xref} contains two
multicast-enabled networks that are both connected to the internet with
non-multicast-capable links and which have no direct association with
each other.[¶](#section-2.2-2){.pilcrow}

A content provider operates a sender, which is a source of multicast
traffic inside a multicast-capable network.[¶](#section-2.2-3){.pilcrow}

An end user who is a customer of the content provider has a
multicast-capable Internet Service Provider (ISP), which operates a
receiving network that uses an AMT gateway. The AMT gateway is DRIAD
capable.[¶](#section-2.2-4){.pilcrow}

The content provider provides the user with a receiving application that
tries to subscribe to at least one (S,G). This receiving application
could, for example, be a file transfer system using File Delivery over
Unidirectional Transport (FLUTE) \[[RFC6726](#RFC6726){.xref}\], a live
video stream using RTP \[[RFC3550](#RFC3550){.xref}\], or any other
application that might subscribe to an SSM
channel.[¶](#section-2.2-5){.pilcrow}

[]{#name-driad-messaging}

::: {#figmessaging}
::: {#section-2.2-6.1 .artwork .art-text .alignLeft}
                      +---------------+
                      |    Sender     |
       |    |         |  2001:db8::a  |
       |    |         +---------------+
       |Data|                 |
       |Flow|      Multicast  |
      \|    |/      Network   |
       \    /                 |        5: Propagate RPF for Join(S,G)
        \  /          +---------------+
         \/           |   AMT relay   |
                      | 2001:db8:c::f |
                      +---------------+
                              |        4: Gateway connects to Relay,
                                          sends Join(S,G) over tunnel
                              |
                     Unicast
                      Tunnel  |        3: --> DNS Query: type=AMTRELAY,
                                      /        a.0.0.0.0.0.0.0.0.0.0.0.
          ^                   |      /         0.0.0.0.0.0.0.0.0.0.0.0.
          |                         /          8.b.d.0.1.0.0.2.ip6.arpa
          |                   |    /      <-- Response:
      Join/Leave       +-------------+         AMTRELAY=2001:db8:c::f
       Signals         | AMT gateway |
          |            +-------------+
          |                   |        2: Propagate RPF for Join(S,G)
          |        Multicast  |
                    Network   |
                              |     1: Join(S=2001:db8::a,G=ff3e::8000:d)
                       +-------------+
                       |   Receiver  |
                       |  (end user) |
                       +-------------+
:::

[Figure 2](#figure-2){.selfRef}: [DRIAD
Messaging](#name-driad-messaging){.selfRef}
:::

In this simple example, the sender IP is 2001:db8::a, which is sending
traffic to the group address ff3e::8000:d, and the relay IP is
2001:db8::c:f.[¶](#section-2.2-7){.pilcrow}

The content provider has previously configured the DNS zone that
contains the reverse IP domain name for the sender\'s IP address so that
it provides an AMTRELAY RR with the relay\'s IP address (see [Section
4.3](#rpformat){.xref} for details about the AMTRELAY RR format and
semantics). As described in [Section
2.5](https://www.rfc-editor.org/rfc/rfc3596#section-2.5){.relref} of
\[[RFC3596](#RFC3596){.xref}\], the reverse IP FQDN of the sender\'s
address \"2001:db8::a\" is:[¶](#section-2.2-8){.pilcrow}

::: {#section-2.2-9}
``` sourcecode
 a.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.8.b.d.0.1.0.0.2.ip6.
                                                                arpa.
```

[¶](#section-2.2-9){.pilcrow}
:::

The sequence of events depicted in [Figure 2](#figmessaging){.xref} is
as follows:[¶](#section-2.2-10){.pilcrow}

1.  [The end user starts the app, which issues a join to the (S,G):
    (2001:db8::a,
    ff3e::8000:d).[¶](#section-2.2-11.1){.pilcrow}]{#section-2.2-11.1}

2.  [The join propagates with RPF through the receiver\'s
    multicast-enabled network with PIM \[[RFC7761](#RFC7761){.xref}\] or
    another multicast routing mechanism until the AMT gateway receives a
    signal to join the
    (S,G).[¶](#section-2.2-11.2){.pilcrow}]{#section-2.2-11.2}

3.  ::: {#section-2.2-11.3}
    The AMT gateway performs a reverse DNS lookup for the AMTRELAY
    RRType by sending an AMTRELAY RRType query for the reverse IP domain
    name for the sender\'s source IP address (the S from the
    (S,G)).[¶](#section-2.2-11.3.1){.pilcrow}

    The DNS resolver for the AMT gateway uses ordinary DNS recursive
    resolution until it has the authoritative result that the content
    provider configured, which informs the AMT gateway that the relay
    address is 2001:db8::c:f.[¶](#section-2.2-11.3.2){.pilcrow}
    :::

4.  [The AMT gateway performs AMT handshakes with the AMT relay as
    described in [Section
    4](https://www.rfc-editor.org/rfc/rfc7450#section-4){.relref} of
    \[[RFC7450](#RFC7450){.xref}\], then forwards a membership report to
    the relay, indicating subscription to the
    (S,G).[¶](#section-2.2-11.4){.pilcrow}]{#section-2.2-11.4}

5.  [The relay propagates the join through its network toward the sender
    and then forwards the appropriate AMT-encapsulated traffic to the
    gateway, which decapsulates and forwards it as a native multicast
    through its downstream network to the end
    user.[¶](#section-2.2-11.5){.pilcrow}]{#section-2.2-11.5}

In the case of an IPv4 (S,G), the only difference in the AMT relay
discovery process is the use of the in-addr.arpa reverse IP domain name,
as described in [Section
3.5](https://www.rfc-editor.org/rfc/rfc1035#section-3.5){.relref} of
\[[RFC1035](#RFC1035){.xref}\], instead of the in6.arpa domain name. For
example, if the (S,G) is (198.51.100.12, 232.252.0.2), the reverse IP
FQDN for the AMTRELAY query would be
\"12.100.51.198.in-addr.arpa.\".[¶](#section-2.2-12){.pilcrow}

Note that the address family of the AMT tunnel is independent of the
address family for the multicast traffic.[¶](#section-2.2-13){.pilcrow}
:::
:::

::: {#exampledeployments}
::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Example Deployments](#name-example-deployments){.section-name .selfRef} {#name-example-deployments}

::: {#exrx}
::: {#section-2.3.1 .section}
#### [2.3.1.](#section-2.3.1){.section-number .selfRef} [Example Receiving Networks](#name-example-receiving-networks){.section-name .selfRef} {#name-example-receiving-networks}

::: {#exrxisp}
::: {#section-2.3.1.1 .section}
##### [2.3.1.1.](#section-2.3.1.1){.section-number .selfRef} [Internet Service Provider](#name-internet-service-provider){.section-name .selfRef} {#name-internet-service-provider}

One example of a receiving network is an Internet Service Provider (ISP)
that offers multicast ingest services to its subscribers, illustrated in
[Figure 3](#figrxisp){.xref}.[¶](#section-2.3.1.1-1){.pilcrow}

In the example network below, subscribers can join (S,G)s with MLDv2 or
IGMPv3 as described in \[[RFC4604](#RFC4604){.xref}\], and the AMT
gateway in this ISP can receive and forward multicast traffic from one
of the example sending networks in [Section 2.3.2](#extx){.xref} by
discovering the appropriate AMT relays with a DNS lookup for the
AMTRELAY RR with the reverse IP of the source in the
(S,G).[¶](#section-2.3.1.1-2){.pilcrow}

[]{#name-receiving-isp-example}

::: {#figrxisp}
::: {#section-2.3.1.1-3.1 .artwork .art-text .alignLeft}
                         Internet
                      ^            ^      Multicast-enabled
                      |            |      Receiving Network
               +------|------------|-------------------------+
               |      |            |                         |
               |  +--------+   +--------+    +=========+     |
               |  | Border |---| Border |    |   AMT   |     |
               |  | Router |   | Router |    | gateway |     |
               |  +--------+   +--------+    +=========+     |
               |      |            |              |          |
               |      +-----+------+-----------+--+          |
               |            |                  |             |
               |      +-------------+    +-------------+     |
               |      | Agg Routers | .. | Agg Routers |     |
               |      +-------------+    +-------------+     |
               |            /     \ \     /         \        |
               | +---------------+         +---------------+ |
               | |Access Systems | ....... |Access Systems | |
               | |(CMTS/OLT/etc.)|         |(CMTS/OLT/etc.)| |
               | +---------------+         +---------------+ |
               |        |                        |           |
               +--------|------------------------|-----------+
                        |                        |
                  +---+-+-+---+---+        +---+-+-+---+---+
                  |   |   |   |   |        |   |   |   |   |
                 /-\ /-\ /-\ /-\ /-\      /-\ /-\ /-\ /-\ /-\
                 |_| |_| |_| |_| |_|      |_| |_| |_| |_| |_|

                                Subscribers
:::

[Figure 3](#figure-3){.selfRef}: [Receiving ISP
Example](#name-receiving-isp-example){.selfRef}
:::
:::
:::

::: {#exoffice}
::: {#section-2.3.1.2 .section}
##### [2.3.1.2.](#section-2.3.1.2){.section-number .selfRef} [Small Office](#name-small-office){.section-name .selfRef} {#name-small-office}

Another example receiving network is a small branch office that
regularly accesses some multicast content, illustrated in [Figure
4](#figrxofficenm){.xref}.[¶](#section-2.3.1.2-1){.pilcrow}

This office has desktop devices that need to receive some multicast
traffic, so an AMT gateway runs on a LAN with these devices to pull
traffic in through a non-multicast next
hop.[¶](#section-2.3.1.2-2){.pilcrow}

The office also hosts some mobile devices that have AMT gateway
instances embedded inside apps in order to receive multicast traffic
over their non-multicast wireless LAN. (Note that the \"Legacy Router\"
is a simplification that\'s meant to describe a variety of possible
conditions; for example, it could be a device providing a split-tunnel
VPN as described in \[[RFC7359](#RFC7359){.xref}\], deliberately
excluding multicast traffic for a VPN tunnel, rather than a device that
is incapable of multicast forwarding.)[¶](#section-2.3.1.2-3){.pilcrow}

[]{#name-small-office-no-multicast-u}

::: {#figrxofficenm}
::: {#section-2.3.1.2-4.1 .artwork .art-text .alignLeft}
                      Internet
                   (non-multicast)
                          ^
                          |                  Office Network
               +----------|----------------------------------+
               |          |                                  |
               |    +---------------+ (Wifi)   Mobile apps   |
               |    | Modem+ | Wifi | - - - -  w/ embedded   |
               |    | Router |  AP  |          AMT gateways  |
               |    +---------------+                        |
               |          |                                  |
               |          |                                  |
               |     +----------------+                      |
               |     | Legacy Router  |                      |
               |     |   (unicast)    |                      |
               |     +----------------+                      |
               |      /        |      \                      |
               |     /         |       \                     |
               | +--------+ +--------+ +--------+=========+  |
               | | Phones | | ConfRm | | Desks  |   AMT   |  |
               | | subnet | | subnet | | subnet | gateway |  |
               | +--------+ +--------+ +--------+=========+  |
               |                                             |
               +---------------------------------------------+
:::

[Figure 4](#figure-4){.selfRef}: [Small Office (No Multicast
Up)](#name-small-office-no-multicast-u){.selfRef}
:::

By adding an AMT relay to this office network as in [Figure
5](#figrxoffice){.xref}, it\'s possible to make use of multicast
services from the example multicast-capable ISP in [Section
2.3.1.1](#exrxisp){.xref}.[¶](#section-2.3.1.2-5){.pilcrow}

[]{#name-small-office-example}

::: {#figrxoffice}
::: {#section-2.3.1.2-6.1 .artwork .art-text .alignLeft}
                Multicast-capable ISP
                          ^
                          |                  Office Network
               +----------|----------------------------------+
               |          |                                  |
               |    +---------------+ (Wifi)   Mobile apps   |
               |    | Modem+ | Wifi | - - - -  w/ embedded   |
               |    | Router |  AP  |          AMT gateways  |
               |    +---------------+                        |
               |          |               +=======+          |
               |          +---Wired LAN---|  AMT  |          |
               |          |               | relay |          |
               |     +----------------+   +=======+          |
               |     | Legacy Router  |                      |
               |     |   (unicast)    |                      |
               |     +----------------+                      |
               |      /        |      \                      |
               |     /         |       \                     |
               | +--------+ +--------+ +--------+=========+  |
               | | Phones | | ConfRm | | Desks  |   AMT   |  |
               | | subnet | | subnet | | subnet | gateway |  |
               | +--------+ +--------+ +--------+=========+  |
               |                                             |
               +---------------------------------------------+
:::

[Figure 5](#figure-5){.selfRef}: [Small Office
Example](#name-small-office-example){.selfRef}
:::

When multicast-capable networks are chained like this, with a network
like the one in [Figure 5](#figrxoffice){.xref} receiving Internet
services from a multicast-capable network like the one in [Figure
3](#figrxisp){.xref}, it\'s important for AMT gateways to reach the more
local AMT relay in order to avoid accidentally tunneling multicast
traffic from a more distant AMT relay with unicast and failing to
utilize the multicast transport capabilities of the network in [Figure
3](#figrxisp){.xref}.[¶](#section-2.3.1.2-7){.pilcrow}
:::
:::
:::
:::

::: {#extx}
::: {#section-2.3.2 .section}
#### [2.3.2.](#section-2.3.2){.section-number .selfRef} [Example Sending Networks](#name-example-sending-networks){.section-name .selfRef} {#name-example-sending-networks}

::: {#extxsnd}
::: {#section-2.3.2.1 .section}
##### [2.3.2.1.](#section-2.3.2.1){.section-number .selfRef} [Sender-Controlled Relays](#name-sender-controlled-relays){.section-name .selfRef} {#name-sender-controlled-relays}

When a sender network is also operating AMT relays to distribute
multicast traffic, as in [Figure 6](#figtxrelay){.xref}, each address
could appear as an AMTRELAY RR for the reverse IP of the sender.
Alternately, one or more domain names could appear in AMTRELAY RRs, and
the AMT relay addresses can be discovered by finding A or AAAA records
from those domain names.[¶](#section-2.3.2.1-1){.pilcrow}

[]{#name-small-office-example-2}

::: {#figtxrelay}
::: {#section-2.3.2.1-2.1 .artwork .art-text .alignLeft}
                                           Sender Network
                     +-----------------------------------+
                     |                                   |
                     | +--------+   +=======+  +=======+ |
                     | | Sender |   |  AMT  |  |  AMT  | |
                     | +--------+   | relay |  | relay | |
                     |     |        +=======+  +=======+ |
                     |     |            |          |     |
                     |     +-----+------+----------+     |
                     |           |                       |
                     +-----------|-----------------------+
                                 v
                              Internet
                           (non-multicast)
:::

[Figure 6](#figure-6){.selfRef}: [Small Office
Example](#name-small-office-example-2){.selfRef}
:::
:::
:::

::: {#extxprv}
::: {#section-2.3.2.2 .section}
##### [2.3.2.2.](#section-2.3.2.2){.section-number .selfRef} [Provider-Controlled Relays](#name-provider-controlled-relays){.section-name .selfRef} {#name-provider-controlled-relays}

When an ISP offers a service to transmit outbound multicast traffic
through a forwarding network, it might also offer AMT relays in order to
reach receivers without multicast connectivity to the forwarding
network, as in [Figure 7](#figtxisp){.xref}. In this case, it\'s
recommended that the ISP also provide at least one domain name for the
AMT relays for use with the AMTRELAY
RR.[¶](#section-2.3.2.2-1){.pilcrow}

When the sender wishes to use the relays provided by the ISP for
forwarding multicast traffic, an AMTRELAY RR should be configured to use
the domain name provided by the ISP to allow for address reassignment of
the relays without forcing the sender to reconfigure the corresponding
AMTRELAY RRs.[¶](#section-2.3.2.2-2){.pilcrow}

[]{#name-sending-isp-example}

::: {#figtxisp}
::: {#section-2.3.2.2-3.1 .artwork .art-text .alignLeft}
                       +--------+
                       | Sender |
                       +---+----+        Multicast-enabled
                           |              Sending Network
               +-----------|-------------------------------+
               |           v                               |
               |    +------------+     +=======+ +=======+ |
               |    | Agg Router |     |  AMT  | |  AMT  | |
               |    +------------+     | relay | | relay | |
               |           |           +=======+ +=======+ |
               |           |               |         |     |
               |     +-----+------+--------+---------+     |
               |     |            |                        |
               | +--------+   +--------+                   |
               | | Border |---| Border |                   |
               | | Router |   | Router |                   |
               | +--------+   +--------+                   |
               +-----|------------|------------------------+
                     |            |
                     v            v
                        Internet
                     (non-multicast)
:::

[Figure 7](#figure-7){.selfRef}: [Sending ISP
Example](#name-sending-isp-example){.selfRef}
:::
:::
:::
:::
:::
:::
:::
:::
:::

::: {#relay-discovery-operation}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Relay Discovery Operation](#name-relay-discovery-operation){.section-name .selfRef} {#name-relay-discovery-operation}

::: {#priority}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Optimal Relay Selection](#name-optimal-relay-selection){.section-name .selfRef} {#name-optimal-relay-selection}

::: {#overview}
::: {#section-3.1.1 .section}
#### [3.1.1.](#section-3.1.1){.section-number .selfRef} [Overview](#name-overview){.section-name .selfRef} {#name-overview}

The reverse source IP DNS query of an AMTRELAY RR is a good way for a
gateway to discover a relay that is known to the
sender.[¶](#section-3.1.1-1){.pilcrow}

However, it is \*not\* necessarily a good way to discover the best relay
for that gateway to use, because the RR will only provide information
about relays known to the source.[¶](#section-3.1.1-2){.pilcrow}

If there is an upstream relay in a network that is topologically closer
to the gateway and is able to receive and forward multicast traffic from
the sender, that relay is better for the gateway to use since more of
the network path uses native multicast, allowing more chances for packet
replication. But since that relay is not known to the sender, it won\'t
be advertised in the sender\'s reverse IP DNS record. An example network
that illustrates this scenario is outlined in [Figure
5](#figrxoffice){.xref} from [Section
2.3.1.2](#exoffice){.xref}.[¶](#section-3.1.1-3){.pilcrow}

It\'s only appropriate for an AMT gateway to discover an AMT relay by
querying an AMTRELAY RR owned by a sender when all of these conditions
are met:[¶](#section-3.1.1-4){.pilcrow}

1.  [The gateway needs to propagate a join of an (S,G) over AMT because
    in the gateway\'s network, no RPF next hop toward the source can
    propagate a native multicast join of the
    (S,G);[¶](#section-3.1.1-5.1){.pilcrow}]{#section-3.1.1-5.1}
2.  [The gateway is not already connected to a relay that forwards
    multicast traffic from the source of the
    (S,G);[¶](#section-3.1.1-5.2){.pilcrow}]{#section-3.1.1-5.2}
3.  [The gateway is not configured to use a particular IP address for
    AMT discovery, or a relay discovered with that IP is not able to
    forward traffic from the source of the
    (S,G);[¶](#section-3.1.1-5.3){.pilcrow}]{#section-3.1.1-5.3}
4.  [The gateway is not able to find an upstream AMT relay with
    DNS-based Service Discovery (DNS-SD) \[[RFC6763](#RFC6763){.xref}\]
    using \"\_amt.\_udp\" as the Service section of the queries, or a
    relay discovered this way is not able to forward traffic from the
    source of the (S,G) (as described in [Section
    3.3.4.1](#trafficabsent){.xref} and [3.3.5](#loaded){.xref});
    and[¶](#section-3.1.1-5.4){.pilcrow}]{#section-3.1.1-5.4}
5.  [The gateway is not able to find an upstream AMT relay with the
    well-known anycast addresses from [Section
    7](https://www.rfc-editor.org/rfc/rfc7450#section-7){.relref} of
    \[[RFC7450](#RFC7450){.xref}\].[¶](#section-3.1.1-5.5){.pilcrow}]{#section-3.1.1-5.5}

When all of the above conditions are met, the gateway has no path within
its local network that can receive multicast traffic from the source IP
of the (S,G).[¶](#section-3.1.1-6){.pilcrow}

In this situation, the best way to find a relay that can forward the
required traffic is to use information that comes from the operator of
the sender. When the sender has configured an AMTRELAY RR, gateways can
use the DRIAD mechanism defined in this document to discover the relay
information provided by the sender.[¶](#section-3.1.1-7){.pilcrow}

Note that the above conditions are designed to prefer the use of a local
AMT relay if one can be discovered. However, note also that the network
upstream of the locally discovered relay would still need to receive
traffic from the sender of the (S,G) in order to forward it. Therefore,
unless the upstream network contains the sender or has a
multicast-capable peering with a network that can forward traffic from
the sender, the upstream network might still use AMT to ingest the
traffic from a network that can receive traffic from the sender. If this
is the case, the upstream AMT gateway could still rely on the AMTRELAY
RR provided by the sender, even though the AMTRELAY RR is not directly
used by gateways topologically closer to the receivers. For a concrete
example of such a situation, consider the network in [Figure
5](#figrxoffice){.xref} connected as one of the customers to the network
in [Figure 3](#figrxisp){.xref}.[¶](#section-3.1.1-8){.pilcrow}
:::
:::

::: {#ordering}
::: {#section-3.1.2 .section}
#### [3.1.2.](#section-3.1.2){.section-number .selfRef} [Preference Ordering](#name-preference-ordering){.section-name .selfRef} {#name-preference-ordering}

This section defines a preference ordering for relay addresses during
the relay discovery process. Gateways are encouraged to implement a
Happy Eyeballs \[[RFC8305](#RFC8305){.xref}\] algorithm to try candidate
relays concurrently (see [Section 3.2](#happy){.xref}), but even
gateways that do not implement a Happy Eyeballs algorithm
[SHOULD]{.bcp14} use this ordering, except as
noted.[¶](#section-3.1.2-1){.pilcrow}

When establishing an AMT tunnel to forward multicast data, it\'s very
important for the discovery process to prioritize network topology
considerations ahead of address selection considerations in order to
gain the packet replication benefits from using multicast instead of
unicast tunneling in the multicast-capable portions of the network
path.[¶](#section-3.1.2-2){.pilcrow}

The intent of the advice and requirements in this section is to describe
how a gateway should make use of the concurrency provided by a Happy
Eyeballs algorithm to reduce the join latency while still prioritizing
network efficiency considerations over address selection
considerations.[¶](#section-3.1.2-3){.pilcrow}

[Section 4](https://www.rfc-editor.org/rfc/rfc8305#section-4){.relref}
of \[[RFC8305](#RFC8305){.xref}\] requires a Happy Eyeballs algorithm to
sort the addresses with the Destination Address Selection defined in
[Section 6](https://www.rfc-editor.org/rfc/rfc6724#section-6){.relref}
of \[[RFC6724](#RFC6724){.xref}\], but for the above reasons, that
requirement is superseded in the AMT discovery use case by the following
considerations:[¶](#section-3.1.2-4){.pilcrow}

-   ::: {#section-3.1.2-5.1}
    Prefer Local Relays[¶](#section-3.1.2-5.1.1){.pilcrow}

    [Figure 5](#figrxoffice){.xref} and [Section
    2.3.1.2](#exoffice){.xref} provide a motivating example to prefer
    DNS-SD \[[RFC6763](#RFC6763){.xref}\] for discovery strictly ahead
    of using the AMTRELAY RR controlled by the sender for AMT
    discovery.[¶](#section-3.1.2-5.1.2){.pilcrow}

    For this reason, it\'s [RECOMMENDED]{.bcp14} that AMT gateways by
    default perform service discovery using DNS Service Discovery
    (DNS-SD) \[[RFC6763](#RFC6763){.xref}\] for \_amt.\_udp.\<domain>
    (with \<domain> chosen as described in [Section
    11](https://www.rfc-editor.org/rfc/rfc6763#section-11){.relref} of
    \[[RFC6763](#RFC6763){.xref}\]) and use the AMT relays discovered
    that way in preference to AMT relays discoverable via the mechanism
    defined in this document (DRIAD).[¶](#section-3.1.2-5.1.3){.pilcrow}
    :::

-   ::: {#section-3.1.2-5.2}
    Prefer Relays Managed by the Containing
    Network[¶](#section-3.1.2-5.2.1){.pilcrow}

    When no local relay is discoverable with DNS-SD, it still may be the
    case that a relay local to the receiver is operated by the network
    providing transit services to the
    receiver.[¶](#section-3.1.2-5.2.2){.pilcrow}

    In this case, when the network cannot make the relay discoverable
    via DNS-SD, the network [SHOULD]{.bcp14} use the well-known anycast
    addresses from [Section
    7](https://www.rfc-editor.org/rfc/rfc7450#section-7){.relref} of
    \[[RFC7450](#RFC7450){.xref}\] to route discovery traffic to the
    relay most appropriate to the receiver\'s
    gateway.[¶](#section-3.1.2-5.2.3){.pilcrow}

    Accordingly, the gateway [SHOULD]{.bcp14} by default discover a
    relay with the well-known AMT anycast addresses as the next-best
    option after DNS-SD when searching for a local
    relay.[¶](#section-3.1.2-5.2.4){.pilcrow}
    :::

-   ::: {#section-3.1.2-5.3}
    Let Sender Manage Relay
    Provisioning[¶](#section-3.1.2-5.3.1){.pilcrow}

    A related motivating example is provided by considering a sender
    whose traffic can be forwarded by relays in a sender-controlled
    network like [Figure 6](#figtxrelay){.xref} in [Section
    2.3.2.1](#extxsnd){.xref} and by relays in a provider-controlled
    network like [Figure 7](#figtxisp){.xref} in [Section
    2.3.2.2](#extxprv){.xref}, with different cost and scalability
    profiles for the different
    options.[¶](#section-3.1.2-5.3.2){.pilcrow}

    In this example about the sending-side network, the precedence field
    described in [Section 4.2.1](#rrdef-precedence){.xref} is a critical
    method of control so that senders can provide the appropriate
    guidance to gateways during the discovery process in order to manage
    load and failover scenarios in a manner that operates well with the
    sender\'s provisioning strategy for horizontal scaling of AMT
    relays.[¶](#section-3.1.2-5.3.3){.pilcrow}

    Therefore, after DNS-SD, the precedence from the RR [MUST]{.bcp14}
    be used for sorting preference ahead of the Destination Address
    Selection ordering from [Section
    6](https://www.rfc-editor.org/rfc/rfc6724#section-6){.relref} of
    \[[RFC6724](#RFC6724){.xref}\] so that only relay IPs with the same
    precedence are directly compared according to the Destination
    Address Selection ordering.[¶](#section-3.1.2-5.3.4){.pilcrow}
    :::

Accordingly, AMT gateways [SHOULD]{.bcp14} by default prefer relays in
this order:[¶](#section-3.1.2-6){.pilcrow}

1.  [DNS-SD[¶](#section-3.1.2-7.1){.pilcrow}]{#section-3.1.2-7.1}
2.  [Anycast addresses from [Section
    7](https://www.rfc-editor.org/rfc/rfc7450#section-7){.relref} of
    \[[RFC7450](#RFC7450){.xref}\][¶](#section-3.1.2-7.2){.pilcrow}]{#section-3.1.2-7.2}
3.  [DRIAD[¶](#section-3.1.2-7.3){.pilcrow}]{#section-3.1.2-7.3}

This default behavior [MAY]{.bcp14} be overridden by administrative
configuration where other behavior is more appropriate for the gateway
within its network.[¶](#section-3.1.2-8){.pilcrow}

Among relay addresses that have an equivalent preference as described
above, a Happy Eyeballs algorithm for AMT [SHOULD]{.bcp14} use the
Destination Address Selection defined in [Section
6](https://www.rfc-editor.org/rfc/rfc6724#section-6){.relref} of
\[[RFC6724](#RFC6724){.xref}\].[¶](#section-3.1.2-9){.pilcrow}

Among relay addresses that still have an equivalent preference after the
above orderings, a gateway [SHOULD]{.bcp14} make a non-deterministic
choice (such as a pseudorandom selection) for relay preference ordering
in order to support load balancing by DNS configurations that provide
many relay options.[¶](#section-3.1.2-10){.pilcrow}

The gateway [MAY]{.bcp14} introduce a bias in the non-deterministic
choice according to information that indicates expected benefits from
selecting some relays in preference to others. Details about the
structure and collection of this information are out of scope for this
document but could, for example, be obtained by out-of-band methods or
from a historical record about network topology, timing information, or
the response to a probing mechanism. A gateway in possession of such
information [MAY]{.bcp14} use it to prefer topologically closer
relays.[¶](#section-3.1.2-11){.pilcrow}

Within the above constraints, gateways [MAY]{.bcp14} make use of other
considerations from [Section
4](https://www.rfc-editor.org/rfc/rfc8305#section-4){.relref} of
\[[RFC8305](#RFC8305){.xref}\], such as the address family interleaving
strategies, to produce a final ordering of candidate relay
addresses.[¶](#section-3.1.2-12){.pilcrow}

Note also that certain relay addresses might be excluded from
consideration by the hold-down timers described in [Section
3.3.4.1](#trafficabsent){.xref} or [3.3.5](#loaded){.xref}. These relays
constitute \"unusable destinations\" under Rule 1 of the Destination
Address Selection and are also not part of the superseding
considerations described above.[¶](#section-3.1.2-13){.pilcrow}

The discovery and connection process for the relay addresses in the
above described ordering [MAY]{.bcp14} operate in parallel, subject to
delays prescribed by the Happy Eyeballs requirements described in
[Section 5](https://www.rfc-editor.org/rfc/rfc8305#section-5){.relref}
of \[[RFC8305](#RFC8305){.xref}\] for successively launched concurrent
connection attempts.[¶](#section-3.1.2-14){.pilcrow}
:::
:::

::: {#connecting-to-multiple-relays}
::: {#section-3.1.3 .section}
#### [3.1.3.](#section-3.1.3){.section-number .selfRef} [Connecting to Multiple Relays](#name-connecting-to-multiple-rela){.section-name .selfRef} {#name-connecting-to-multiple-rela}

In some deployments, it may be useful for a gateway to connect to
multiple upstream relays and subscribe to the same traffic in order to
support an active/active failover model. A gateway [SHOULD NOT]{.bcp14}
be configured to do so without guaranteeing that adequate bandwidth is
available.[¶](#section-3.1.3-1){.pilcrow}

A gateway configured to do this [SHOULD]{.bcp14} still use the same
preference-ordering logic from [Section 3.1.2](#ordering){.xref} for
each connection. (Note that this ordering allows for overriding by
explicit administrative configuration where
required.)[¶](#section-3.1.3-2){.pilcrow}
:::
:::
:::
:::

::: {#happy}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Happy Eyeballs](#name-happy-eyeballs){.section-name .selfRef} {#name-happy-eyeballs}

::: {#overview-1}
::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Overview](#name-overview-2){.section-name .selfRef} {#name-overview-2}

Often, multiple choices of relay will exist for a gateway using DRIAD
for relay discovery. Happy Eyeballs \[[RFC8305](#RFC8305){.xref}\]
provides a widely deployed and generalizable strategy for probing
multiple possible connections in parallel. Therefore, it is
[RECOMMENDED]{.bcp14} that DRIAD-capable gateways implement a Happy
Eyeballs algorithm to support fast discovery of the most preferred
available relay by probing multiple relays
concurrently.[¶](#section-3.2.1-1){.pilcrow}

The parallel discovery logic of a Happy Eyeballs algorithm serves to
reduce join latency for the initial join of an SSM channel. This section
and the preference ordering of relays defined in [Section
3.1.2](#ordering){.xref} together provide guidance on use of a Happy
Eyeballs algorithm for the case of establishing AMT
connections.[¶](#section-3.2.1-2){.pilcrow}

Note that according to the definition in [Section
3.2.3](#connection-def){.xref} of this document, establishing the
connection occurs before sending a membership report. As described in
[Section 5](https://www.rfc-editor.org/rfc/rfc8305#section-5){.relref}
of \[[RFC8305](#RFC8305){.xref}\], only one of the successful
connections will be used, and the others are all canceled or ignored. In
the context of an AMT connection, this means the gateway will send the
membership reports that subscribe to traffic only for the chosen
connection after the Happy Eyeballs algorithm
resolves.[¶](#section-3.2.1-3){.pilcrow}
:::
:::

::: {#algorithm-guidelines}
::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [Algorithm Guidelines](#name-algorithm-guidelines){.section-name .selfRef} {#name-algorithm-guidelines}

During the \"Initiation of asynchronous DNS queries\" phase described in
[Section 3](https://www.rfc-editor.org/rfc/rfc8305#section-3){.relref}
of \[[RFC8305](#RFC8305){.xref}\], a gateway attempts to resolve the
domain names listed in [Section 3.1](#priority){.xref}. This consists of
resolving the SRV queries for DNS-SD domains for the AMT service, as
well as the AMTRELAY query for the reverse IP domain defined in this
document.[¶](#section-3.2.2-1){.pilcrow}

Each of the SRV and AMTRELAY responses might
contain:[¶](#section-3.2.2-2){.pilcrow}

-   [one or more IP addresses (as with type 1 or type 2 AMTRELAY
    responses or when the SRV Additional Data section of the SRV
    response contains the address records for the target, as urged by
    \[[RFC2782](#RFC2782){.xref}\]),
    or[¶](#section-3.2.2-3.1){.pilcrow}]{#section-3.2.2-3.1}
-   [only domain names (as with type 3 responses from [Section
    4.2.3](#rtype){.xref} or an SRV response without an additional data
    section).[¶](#section-3.2.2-3.2){.pilcrow}]{#section-3.2.2-3.2}

When present, IP addresses in the initial response provide resolved
destination address candidates for the \"Sorting of resolved destination
addresses\" phase described in [Section
4](https://www.rfc-editor.org/rfc/rfc8305#section-4){.relref} of
\[[RFC8305](#RFC8305){.xref}\]), whereas domain names without IP
addresses in the initial response result in another set of queries for
AAAA and A records, whose responses provide the candidate resolved
destination addresses.[¶](#section-3.2.2-4){.pilcrow}

Since the SRV or AMTRELAY responses don\'t have a bound on the count of
queries that might be generated aside from the bounds imposed by the DNS
resolver, it\'s important for the gateway to provide a rate limit on the
DNS queries. The DNS query functionality is expected to follow ordinary
standards and best practices for DNS clients. A gateway [MAY]{.bcp14}
use an existing DNS client implementation that does so and [MAY]{.bcp14}
rely on that client\'s rate-limiting logic to avoid issuing excessive
queries. Otherwise, a gateway [MUST]{.bcp14} provide a rate limit for
the DNS queries, and its default settings [SHOULD NOT]{.bcp14} permit
more than 10 queries for any 100-millisecond period (though this
[MAY]{.bcp14} be overridable by the administrative
configuration).[¶](#section-3.2.2-5){.pilcrow}

As the resolved IP addresses arrive, the Happy Eyeballs algorithm sorts
them according to the requirements and recommendations given in [Section
3.1.2](#ordering){.xref} and attempts connections with the corresponding
relays under the algorithm restrictions and guidelines given in
\[[RFC8305](#RFC8305){.xref}\] for the \"Establishment of one
connection, which cancels all other attempts\" phase. As described in
[Section 3](https://www.rfc-editor.org/rfc/rfc8305#section-3){.relref}
of \[[RFC8305](#RFC8305){.xref}\], DNS resolution is treated as
asynchronous, and connection initiation does not wait for lagging DNS
responses.[¶](#section-3.2.2-6){.pilcrow}
:::
:::

::: {#connection-def}
::: {#section-3.2.3 .section}
#### [3.2.3.](#section-3.2.3){.section-number .selfRef} [Connection Definition](#name-connection-definition){.section-name .selfRef} {#name-connection-definition}

[Section 5](https://www.rfc-editor.org/rfc/rfc8305#section-5){.relref}
of \[[RFC8305](#RFC8305){.xref}\] non-normatively describes a successful
connection attempt as \"generally when the TCP handshake
completes\".[¶](#section-3.2.3-1){.pilcrow}

There is no normative definition of a connection in the AMT
specification \[[RFC7450](#RFC7450){.xref}\], and there is no TCP
connection involved in an AMT tunnel.[¶](#section-3.2.3-2){.pilcrow}

However, the concept of an AMT connection in the context of a Happy
Eyeballs algorithm is a useful one, and so this section provides the
following normative definition:[¶](#section-3.2.3-3){.pilcrow}

-   [An AMT connection is established successfully when the gateway
    receives from a newly discovered relay a valid Membership Query
    message ([Section
    5.1.4](https://www.rfc-editor.org/rfc/rfc7450#section-5.1.4){.relref}
    of \[[RFC7450](#RFC7450){.xref}\]) that does not have the L flag
    set.[¶](#section-3.2.3-4.1){.pilcrow}]{#section-3.2.3-4.1}

See [Section 3.3.5](#loaded){.xref} of this document for further
information about the relevance of the L flag to the establishment of a
Happy Eyeballs connection. See [Section 3.3.4](#flowhealth){.xref} for
an overview of how to respond if the connection does not provide
multicast connectivity to the source.[¶](#section-3.2.3-5){.pilcrow}

To \"cancel\" this kind of AMT connection for the Happy Eyeballs
algorithm, a gateway that has not sent a membership report with a
subscription would simply stop sending AMT packets for that connection.
A gateway only sends a membership report to a connection it has chosen
as the most preferred available
connection.[¶](#section-3.2.3-6){.pilcrow}
:::
:::
:::
:::

::: {#guidelines-for-restarting-discovery}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Guidelines for Restarting Discovery](#name-guidelines-for-restarting-d){.section-name .selfRef} {#name-guidelines-for-restarting-d}

::: {#overview-2}
::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [Overview](#name-overview-3){.section-name .selfRef} {#name-overview-3}

It\'s expected that gateways deployed in different environments will use
a variety of heuristics to decide when it\'s appropriate to restart the
relay discovery process in order to meet different performance goals
(for example, to fulfill different kinds of service level
agreements).[¶](#section-3.3.1-1){.pilcrow}

In general, restarting the discovery process is always safe for the
gateway and relay during any of the events listed in this section but
may cause a disruption in the forwarded traffic if the discovery process
results in choosing a different relay because this changes the RPF
forwarding tree for the multicast traffic upstream of the gateway. This
is likely to result in some dropped or duplicated packets from channels
actively being tunneled from the old relay to the
gateway.[¶](#section-3.3.1-2){.pilcrow}

The degree of impact on the traffic from choosing a different relay may
depend on network conditions between the gateway and the new relay, as
well as the network conditions and topology between the sender and the
new relay, as this may cause the relay to propagate a new RPF join
toward the sender.[¶](#section-3.3.1-3){.pilcrow}

Balancing the expected impact on the tunneled traffic against likely or
observed problems with an existing connection to the relay is the goal
of the heuristics that gateways use to determine when to restart the
discovery process.[¶](#section-3.3.1-4){.pilcrow}

The non-normative advice in this section should be treated as guidelines
to operators and implementors working with AMT systems that can use
DRIAD as part of the relay discovery
process.[¶](#section-3.3.1-5){.pilcrow}
:::
:::

::: {#updates-to-restarting-events}
::: {#section-3.3.2 .section}
#### [3.3.2.](#section-3.3.2){.section-number .selfRef} [Updates to Restarting Events](#name-updates-to-restarting-event){.section-name .selfRef} {#name-updates-to-restarting-event}

[Section
5.2.3.4.1](https://www.rfc-editor.org/rfc/rfc7450#section-5.2.3.4.1){.relref}
of \[[RFC7450](#RFC7450){.xref}\] lists several events that may cause a
gateway to start or restart the discovery
procedure.[¶](#section-3.3.2-1){.pilcrow}

This document provides some updates and recommendations regarding the
handling of these and similar events. The first five events are copied
here and numbered for easier reference, and the remaining four events
are newly added for consideration in this
document:[¶](#section-3.3.2-2){.pilcrow}

1.  [When a gateway pseudo-interface is started
    (enabled).[¶](#section-3.3.2-3.1){.pilcrow}]{#section-3.3.2-3.1}
2.  [When the gateway wishes to report a group subscription when none
    currently
    exists.[¶](#section-3.3.2-3.2){.pilcrow}]{#section-3.3.2-3.2}
3.  [Before sending the next Request message in a membership update
    cycle.[¶](#section-3.3.2-3.3){.pilcrow}]{#section-3.3.2-3.3}
4.  [After the gateway fails to receive a response to a Request
    message.[¶](#section-3.3.2-3.4){.pilcrow}]{#section-3.3.2-3.4}
5.  [After the gateway receives a Membership Query message with the L
    flag set to 1.[¶](#section-3.3.2-3.5){.pilcrow}]{#section-3.3.2-3.5}
6.  [When the gateway wishes to report an (S,G) subscription with a
    source address that does not currently have other group
    subscriptions.[¶](#section-3.3.2-3.6){.pilcrow}]{#section-3.3.2-3.6}
7.  [When there is a network change detected; for example, when a
    gateway is operating inside an end user device or application and
    the device joins a different network or when the domain portion of a
    DNS-SD domain name changes in response to a DHCP message or
    administrative
    configuration.[¶](#section-3.3.2-3.7){.pilcrow}]{#section-3.3.2-3.7}
8.  [When substantial loss, persistent congestion, or network overload
    is detected in the stream of AMT packets from a
    relay.[¶](#section-3.3.2-3.8){.pilcrow}]{#section-3.3.2-3.8}
9.  [When the gateway has reported one or more (S,G) subscriptions but
    no traffic is received from the source for some timeout (see
    [Section
    3.3.4.1](#trafficabsent){.xref}).[¶](#section-3.3.2-3.9){.pilcrow}]{#section-3.3.2-3.9}

This list is not exhaustive, nor are any of the listed events strictly
required to always force a restart of the discovery
process.[¶](#section-3.3.2-4){.pilcrow}

Note that during event #1, a gateway may use DNS-SD but does not have
sufficient information to use DRIAD, since no source is
known.[¶](#section-3.3.2-5){.pilcrow}
:::
:::

::: {#stability}
::: {#section-3.3.3 .section}
#### [3.3.3.](#section-3.3.3){.section-number .selfRef} [Tunnel Stability](#name-tunnel-stability){.section-name .selfRef} {#name-tunnel-stability}

In general, subscribers to active traffic flows that are being forwarded
by an AMT gateway are less likely to experience a degradation in service
(for example, from missing or duplicated packets) when the gateway
continues using the same relay as long as the relay is not overloaded
and the network conditions remain stable.[¶](#section-3.3.3-1){.pilcrow}

Therefore, gateways [SHOULD]{.bcp14} avoid performing a full restart of
the discovery process during routine cases of event #3 (sending a new
Request message), since it occurs frequently in normal
operation.[¶](#section-3.3.3-2){.pilcrow}

However, see Sections [3.3.4](#flowhealth){.xref},
[3.3.6](#discoverymessage){.xref}, and [3.3.4.3](#ancient){.xref} for
more information about exceptional cases when it may be appropriate to
use event #3.[¶](#section-3.3.3-3){.pilcrow}
:::
:::

::: {#flowhealth}
::: {#section-3.3.4 .section}
#### [3.3.4.](#section-3.3.4){.section-number .selfRef} [Traffic Health](#name-traffic-health){.section-name .selfRef} {#name-traffic-health}

::: {#trafficabsent}
::: {#section-3.3.4.1 .section}
##### [3.3.4.1.](#section-3.3.4.1){.section-number .selfRef} [Absence of Traffic](#name-absence-of-traffic){.section-name .selfRef} {#name-absence-of-traffic}

If a gateway indicates one or more (S,G) subscriptions in a Membership
Update message but no traffic for any of the (S,G)s is received in a
reasonable time, it\'s appropriate for the gateway to restart the
discovery process.[¶](#section-3.3.4.1-1){.pilcrow}

If the gateway restarts the discovery process multiple times
consecutively for this reason, the timeout period [SHOULD]{.bcp14} be
adjusted to provide a random exponential
back-off.[¶](#section-3.3.4.1-2){.pilcrow}

The [RECOMMENDED]{.bcp14} timeout is a random value in the range
\[initial_timeout, MIN(initial_timeout \* 2\^retry_count,
maximum_timeout)\], with a [RECOMMENDED]{.bcp14} initial_timeout of 4
seconds and a [RECOMMENDED]{.bcp14} maximum_timeout of 120 seconds
(which is the recommended minimum NAT mapping timeout described in
\[[RFC4787](#RFC4787){.xref}\]).[¶](#section-3.3.4.1-3){.pilcrow}

Note that the recommended initial_timeout is larger than the initial
timeout recommended in the similar algorithm from [Section
5.2.3.4.3](https://www.rfc-editor.org/rfc/rfc7450#section-5.2.3.4.3){.relref}
of \[[RFC7450](#RFC7450){.xref}\]. This is to provide time for RPF Join
propagation in the sending network. Although the timeout values may be
administratively adjusted to support performance requirements, operators
are advised to consider the possibility of join propagation delays
between the sender and the relay when choosing an appropriate timeout
value.[¶](#section-3.3.4.1-4){.pilcrow}

Gateways restarting the discovery process because of an absence of
traffic [MUST]{.bcp14} use a hold-down timer that removes this relay
from consideration during subsequent rounds of discovery while active.
The hold-down [SHOULD]{.bcp14} last for no less than 3 minutes and no
more than 10 minutes.[¶](#section-3.3.4.1-5){.pilcrow}
:::
:::

::: {#loss-and-congestion}
::: {#section-3.3.4.2 .section}
##### [3.3.4.2.](#section-3.3.4.2){.section-number .selfRef} [Loss and Congestion](#name-loss-and-congestion){.section-name .selfRef} {#name-loss-and-congestion}

In some gateway deployments, it is also feasible to monitor the health
of traffic flows through the gateway \-- for example, by detecting the
rate of packet loss by communicating out of band with receivers or
monitoring the packets of known protocols with sequence numbers. Where
feasible, it\'s encouraged for gateways to use such traffic health
information to trigger a restart of the discovery process during event
#3 (before sending a new Request
message).[¶](#section-3.3.4.2-1){.pilcrow}

However, if a transient network event that affects the tunneled
multicast stream \-- as opposed to an event that affects the tunnel
connection between the relay and gateway \-- occurs, poor health
detection could be triggered for many gateways simultaneously. In this
situation, adding a random delay to avoid synchronized rediscovery by
many gateways is recommended.[¶](#section-3.3.4.2-2){.pilcrow}

The span of the random portion of the delay should be no less than 10
seconds by default but may be administratively configured to support
different performance requirements.[¶](#section-3.3.4.2-3){.pilcrow}
:::
:::

::: {#ancient}
::: {#section-3.3.4.3 .section}
##### [3.3.4.3.](#section-3.3.4.3){.section-number .selfRef} [Ancient Discovery Information](#name-ancient-discovery-informati){.section-name .selfRef} {#name-ancient-discovery-informati}

In most cases, a gateway actively receiving healthy traffic from a relay
that has not indicated load with the L flag should prefer to remain
connected to the same relay, as described in [Section
3.3.3](#stability){.xref}.[¶](#section-3.3.4.3-1){.pilcrow}

However, a relay that appears healthy but has been forwarding traffic
for days or weeks may have an increased chance of becoming unstable.
Gateways may benefit from restarting the discovery process during event
#3 (before sending a Request message) after the expiration of a
long-term timeout on the order of multiple hours or even days in some
deployments.[¶](#section-3.3.4.3-2){.pilcrow}

It may be beneficial for such timers to consider the amount of traffic
currently being forwarded and to give a higher probability of restarting
discovery during periods with an unusually low data rate to reduce the
impact on active traffic while still avoiding relying on the results of
a very old discovery.[¶](#section-3.3.4.3-3){.pilcrow}

Other issues may also be worth considering as part of this heuristic;
for example, if the DNS expiry time of the record that was used to
discover the current relay has not passed, the long-term timer might be
restarted without restarting the discovery
process.[¶](#section-3.3.4.3-4){.pilcrow}
:::
:::
:::
:::

::: {#loaded}
::: {#section-3.3.5 .section}
#### [3.3.5.](#section-3.3.5){.section-number .selfRef} [Relay Loaded or Shutting Down](#name-relay-loaded-or-shutting-do){.section-name .selfRef} {#name-relay-loaded-or-shutting-do}

The L flag (see [Section
5.1.4.4](https://www.rfc-editor.org/rfc/rfc7450#section-5.1.4.4){.relref}
of \[[RFC7450](#RFC7450){.xref}\]) is the preferred mechanism for a
relay to signal overloading or a graceful shutdown to
gateways.[¶](#section-3.3.5-1){.pilcrow}

A gateway that supports handling of the L flag should generally restart
the discovery process when it processes a Membership Query packet with
the L flag set. If an L flag is received while a concurrent Happy
Eyeballs discovery process is underway for multiple candidate relays
([Section 3.2](#happy){.xref}), the relay sending the L flag [SHOULD
NOT]{.bcp14} be considered for the relay
selection.[¶](#section-3.3.5-2){.pilcrow}

It is also [RECOMMENDED]{.bcp14} that gateways avoid choosing a relay
that has recently sent an L flag, with approximately a 10-minute
hold-down. Gateways [SHOULD]{.bcp14} treat this hold-down timer in the
same way as the hold-down in [Section 3.3.4.1](#trafficabsent){.xref} so
that the relay is removed from consideration for subsequent short-term
rounds of discovery.[¶](#section-3.3.5-3){.pilcrow}
:::
:::

::: {#discoverymessage}
::: {#section-3.3.6 .section}
#### [3.3.6.](#section-3.3.6){.section-number .selfRef} [Relay Discovery Messages vs. Restarting Discovery](#name-relay-discovery-messages-vs){.section-name .selfRef} {#name-relay-discovery-messages-vs}

All AMT relays are required by \[[RFC7450](#RFC7450){.xref}\] to support
handling of Relay Discovery messages (e.g., in [Section
5.3.3.2](https://www.rfc-editor.org/rfc/rfc7450#section-5.3.3.2){.relref}
of \[[RFC7450](#RFC7450){.xref}\]).[¶](#section-3.3.6-1){.pilcrow}

So a gateway with an existing connection to a relay can send a Relay
Discovery message to the unicast address of that AMT relay. Under stable
conditions with an unloaded relay, it\'s expected that the relay will
return its own unicast address in the Relay Advertisement in response to
such a Relay Discovery message. Since this will not result in the
gateway changing to another relay unless the relay directs the gateway
away, this is a reasonable exception to the advice against handling
event #3 described in [Section
3.3.3](#stability){.xref}.[¶](#section-3.3.6-2){.pilcrow}

This behavior is discouraged for gateways that do support the L flag to
avoid sending unnecessary packets over the
network.[¶](#section-3.3.6-3){.pilcrow}

However, gateways that do not support the L flag may be able to avoid a
disruption in the forwarded traffic by sending such Relay Discovery
messages regularly. When a relay is under load or has started a graceful
shutdown, it may respond with a different relay address, which the
gateway can use to connect to a different relay. This kind of
coordinated handoff will likely result in a smaller disruption to the
traffic than if the relay simply stops responding to Request messages
and stops forwarding traffic.[¶](#section-3.3.6-4){.pilcrow}

This style of Relay Discovery message (one sent to the unicast address
of a relay that\'s already forwarding traffic to this gateway) [SHOULD
NOT]{.bcp14} be considered a full restart of the relay discovery
process. It is [RECOMMENDED]{.bcp14} that gateways support the L flag,
but for gateways that do not support the L flag, sending this message
during event #3 may help mitigate service degradation when relays become
unstable.[¶](#section-3.3.6-5){.pilcrow}
:::
:::

::: {#independent-discovery-per-traffic-source}
::: {#section-3.3.7 .section}
#### [3.3.7.](#section-3.3.7){.section-number .selfRef} [Independent Discovery per Traffic Source](#name-independent-discovery-per-t){.section-name .selfRef} {#name-independent-discovery-per-t}

Relays discovered via the AMTRELAY RR are source-specific relay
addresses and may use different pseudo-interfaces from each other and
from relays discovered via DNS-SD or via a non-source-specific address,
as described in [Section
4.1.2.1](https://www.rfc-editor.org/rfc/rfc7450#section-4.1.2.1){.relref}
of \[[RFC7450](#RFC7450){.xref}\].[¶](#section-3.3.7-1){.pilcrow}

Restarting the discovery process for one pseudo-interface does not
require restarting the discovery process for other pseudo-interfaces.
Gateway heuristics about restarting the discovery process should operate
independently for different tunnels to relays when responding to events
that are specific to the different
tunnels.[¶](#section-3.3.7-2){.pilcrow}
:::
:::
:::
:::

::: {#dns-configuration}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [DNS Configuration](#name-dns-configuration){.section-name .selfRef} {#name-dns-configuration}

Often, an AMT gateway will only have access to the source and group IP
addresses of the desired traffic and will not know any other name for
the source of the traffic. Because of this, typically, the best way of
looking up AMTRELAY RRs will be by using the source IP address as an
index into one of the reverse mapping trees (in-addr.arpa for IPv4, as
described in [Section
3.5](https://www.rfc-editor.org/rfc/rfc1035#section-3.5){.relref} of
\[[RFC1035](#RFC1035){.xref}\], or ip6.arpa for IPv6, as described in
[Section
2.5](https://www.rfc-editor.org/rfc/rfc3596#section-2.5){.relref} of
\[[RFC3596](#RFC3596){.xref}\]).[¶](#section-3.4-1){.pilcrow}

Therefore, it is [RECOMMENDED]{.bcp14} that AMTRELAY RRs be added to
reverse IP zones as appropriate. AMTRELAY records [MAY]{.bcp14} also
appear in other zones, since this may be necessary to perform delegation
from the reverse zones (see, for example, [Section
5.2](https://www.rfc-editor.org/rfc/rfc2317#section-5.2){.relref} of
\[[RFC2317](#RFC2317){.xref}\]), but the use case enabled by this
document requires a reverse IP mapping for the source from an (S,G) in
order to be useful to most AMT gateways. This document does not define
semantics for the use of AMTRELAY records obtained in a way other than
by a reverse IP lookup.[¶](#section-3.4-2){.pilcrow}

When performing the AMTRELAY RR lookup, any CNAMEs or DNAMEs found
[MUST]{.bcp14} be followed. This is necessary to support zone
delegation. Some examples outlining this need are described in
\[[RFC2317](#RFC2317){.xref}\].[¶](#section-3.4-3){.pilcrow}

See Sections [4](#rrdef){.xref} and [4.3](#rpformat){.xref} for a
detailed explanation of the contents of a DNS zone
file.[¶](#section-3.4-4){.pilcrow}
:::
:::

::: {#waiting-for-dns-resolution}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Waiting for DNS Resolution](#name-waiting-for-dns-resolution){.section-name .selfRef} {#name-waiting-for-dns-resolution}

DNS query functionality is expected to follow ordinary standards and
best practices for DNS clients. A gateway [MAY]{.bcp14} use an existing
DNS client implementation that does so and [MAY]{.bcp14} rely on that
client\'s retry logic to determine the timeouts between
retries.[¶](#section-3.5-1){.pilcrow}

Otherwise, a gateway [MAY]{.bcp14} resend a DNS query if it does not
receive an appropriate DNS response within some timeout period. If the
gateway retries multiple times, the timeout period [SHOULD]{.bcp14} be
adjusted to provide a random exponential
back-off.[¶](#section-3.5-2){.pilcrow}

As with the waiting process for the Relay Advertisement message from
[Section
5.2.3.4.3](https://www.rfc-editor.org/rfc/rfc7450#section-5.2.3.4.3){.relref}
of \[[RFC7450](#RFC7450){.xref}\], the [RECOMMENDED]{.bcp14} timeout is
a random value in the range \[initial_timeout, MIN(initial_timeout \*
2\^retry_count, maximum_timeout)\], with a [RECOMMENDED]{.bcp14}
initial_timeout of 1 second and a [RECOMMENDED]{.bcp14} maximum_timeout
of 120 seconds.[¶](#section-3.5-3){.pilcrow}
:::
:::
:::
:::

::: {#rrdef}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [AMTRELAY Resource Record Definition](#name-amtrelay-resource-record-de){.section-name .selfRef} {#name-amtrelay-resource-record-de}

::: {#amtrelay-rrtype}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [AMTRELAY RRType](#name-amtrelay-rrtype){.section-name .selfRef} {#name-amtrelay-rrtype}

The AMTRELAY RRType has the mnemonic AMTRELAY and type code 260
(decimal).[¶](#section-4.1-1){.pilcrow}

The AMTRELAY RR is class independent.[¶](#section-4.1-2){.pilcrow}
:::
:::

::: {#amtrelay-rdata-format}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [AMTRELAY RData Format](#name-amtrelay-rdata-format){.section-name .selfRef} {#name-amtrelay-rdata-format}

The AMTRELAY RData consists of an 8-bit precedence field, a 1-bit
\"Discovery Optional\" field, a 7-bit type field, and a variable length
relay field.[¶](#section-4.2-1){.pilcrow}

::: {#section-4.2-2 .artwork .art-text .alignLeft}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   precedence  |D|    type     |                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
    ~                            relay                              ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-4.2-2){.pilcrow}
:::

::: {#rrdef-precedence}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [RData Format - Precedence](#name-rdata-format-precedence){.section-name .selfRef} {#name-rdata-format-precedence}

This is an 8-bit precedence for this record. It is interpreted in the
same way as the PREFERENCE field described in [Section
3.3.9](https://www.rfc-editor.org/rfc/rfc1035#section-3.3.9){.relref} of
\[[RFC1035](#RFC1035){.xref}\].[¶](#section-4.2.1-1){.pilcrow}

Relays listed in AMTRELAY records with a lower value for precedence are
to be attempted first.[¶](#section-4.2.1-2){.pilcrow}
:::
:::

::: {#rrdef-dbit}
::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [RData Format - Discovery Optional (D-bit)](#name-rdata-format-discovery-opti){.section-name .selfRef} {#name-rdata-format-discovery-opti}

The D-bit is a \"Discovery Optional\"
flag.[¶](#section-4.2.2-1){.pilcrow}

If the D-bit is set to 0, a gateway using this RR [MUST]{.bcp14} perform
AMT relay discovery as described in [Section
4.2.1.1](https://www.rfc-editor.org/rfc/rfc7450#section-4.2.1.1){.relref}
of \[[RFC7450](#RFC7450){.xref}\] rather than directly sending an AMT
Request message to the relay.[¶](#section-4.2.2-2){.pilcrow}

That is, the gateway [MUST]{.bcp14} receive an AMT Relay Advertisement
message ([Section
5.1.2](https://www.rfc-editor.org/rfc/rfc7450#section-5.1.2){.relref} of
\[[RFC7450](#RFC7450){.xref}\]) for an address before sending an AMT
Request message ([Section
5.1.3](https://www.rfc-editor.org/rfc/rfc7450#section-5.1.3){.relref} of
\[[RFC7450](#RFC7450){.xref}\]) to that address. Before receiving the
Relay Advertisement message, this record has only indicated that the
address can be used for AMT relay discovery, not for a Request message.
This is necessary for devices that are not fully functional AMT relays
but rather load balancers or brokers, as mentioned in [Section
4.2.1.1](https://www.rfc-editor.org/rfc/rfc7450#section-4.2.1.1){.relref}
of \[[RFC7450](#RFC7450){.xref}\].[¶](#section-4.2.2-3){.pilcrow}

If the D-bit is set to 1, the gateway [MAY]{.bcp14} send an AMT Request
message directly to the discovered relay address without first sending
an AMT Discovery message.[¶](#section-4.2.2-4){.pilcrow}

This bit should be set according to advice from the AMT relay operator.
The D-bit [MUST]{.bcp14} be set to zero when no information is available
from the AMT relay operator about its
suitability.[¶](#section-4.2.2-5){.pilcrow}
:::
:::

::: {#rtype}
::: {#section-4.2.3 .section}
#### [4.2.3.](#section-4.2.3){.section-number .selfRef} [RData Format - Type](#name-rdata-format-type){.section-name .selfRef} {#name-rdata-format-type}

The type field indicates the format of the information that is stored in
the relay field.[¶](#section-4.2.3-1){.pilcrow}

The following values are defined:[¶](#section-4.2.3-2){.pilcrow}

-   [type = 0: The relay field is empty (0
    bytes).[¶](#section-4.2.3-3.1){.pilcrow}]{#section-4.2.3-3.1}
-   [type = 1: The relay field contains a 4-octet IPv4
    address.[¶](#section-4.2.3-3.2){.pilcrow}]{#section-4.2.3-3.2}
-   [type = 2: The relay field contains a 16-octet IPv6
    address.[¶](#section-4.2.3-3.3){.pilcrow}]{#section-4.2.3-3.3}
-   [type = 3: The relay field contains a wire-encoded domain name. The
    wire-encoded format is self-describing, so the length is implicit.
    The domain name [MUST NOT]{.bcp14} be compressed (see [Section
    3.3](https://www.rfc-editor.org/rfc/rfc1035#section-3.3){.relref} of
    \[[RFC1035](#RFC1035){.xref}\] and [Section
    4](https://www.rfc-editor.org/rfc/rfc3597#section-4){.relref} of
    \[[RFC3597](#RFC3597){.xref}\]).[¶](#section-4.2.3-3.4){.pilcrow}]{#section-4.2.3-3.4}

RRs with an undefined value in the Type field [SHOULD NOT]{.bcp14} be
considered by receiving gateways for AMT relay
discovery.[¶](#section-4.2.3-4){.pilcrow}
:::
:::

::: {#rdformat}
::: {#section-4.2.4 .section}
#### [4.2.4.](#section-4.2.4){.section-number .selfRef} [RData Format - Relay](#name-rdata-format-relay){.section-name .selfRef} {#name-rdata-format-relay}

The relay field is the address or domain name of the AMT relay. It is
formatted according to the type field.[¶](#section-4.2.4-1){.pilcrow}

When the type field is 0, the length of the relay field is 0, and it
indicates that no AMT relay should be used for multicast traffic from
this source.[¶](#section-4.2.4-2){.pilcrow}

When the type field is 1, the length of the relay field is 4 octets, and
a 32-bit IPv4 address is present. This is an IPv4 address as described
in [Section
3.4.1](https://www.rfc-editor.org/rfc/rfc1035#section-3.4.1){.relref} of
\[[RFC1035](#RFC1035){.xref}\]. This is a 32-bit number in network byte
order.[¶](#section-4.2.4-3){.pilcrow}

When the type field is 2, the length of the relay field is 16 octets,
and a 128-bit IPv6 address is present. This is an IPv6 address as
described in [Section
2.2](https://www.rfc-editor.org/rfc/rfc3596#section-2.2){.relref} of
\[[RFC3596](#RFC3596){.xref}\]. This is a 128-bit number in network byte
order.[¶](#section-4.2.4-4){.pilcrow}

When the type field is 3, the relay field is a normal wire-encoded
domain name, as described in [Section
3.3](https://www.rfc-editor.org/rfc/rfc1035#section-3.3){.relref} of
\[[RFC1035](#RFC1035){.xref}\]. For the reasons given in [Section
4](https://www.rfc-editor.org/rfc/rfc3597#section-4){.relref} of
\[[RFC3597](#RFC3597){.xref}\], compression [MUST NOT]{.bcp14} be
used.[¶](#section-4.2.4-5){.pilcrow}

For a type 3 record, the D-bit and preference fields carry over to all A
or AAAA records for the domain name. There is no difference in the
result of the discovery process when it\'s obtained by type 1 or type 2
AMTRELAY records with identical D-bit and preference fields vs. when the
result is obtained by a type 3 AMTRELAY record that resolves to the same
set of IPv4 and IPv6 addresses via A and AAAA
lookups.[¶](#section-4.2.4-6){.pilcrow}
:::
:::
:::
:::

::: {#rpformat}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [AMTRELAY Record Presentation Format](#name-amtrelay-record-presentatio){.section-name .selfRef} {#name-amtrelay-record-presentatio}

::: {#representation-of-amtrelay-rrs}
::: {#section-4.3.1 .section}
#### [4.3.1.](#section-4.3.1){.section-number .selfRef} [Representation of AMTRELAY RRs](#name-representation-of-amtrelay-){.section-name .selfRef} {#name-representation-of-amtrelay-}

AMTRELAY RRs may appear in a zone data master file. The precedence,
D-bit, relay type, and relay fields are
[REQUIRED]{.bcp14}.[¶](#section-4.3.1-1){.pilcrow}

If the relay type field is 0, the relay field [MUST]{.bcp14} be
\".\".[¶](#section-4.3.1-2){.pilcrow}

The presentation for the record is as
follows:[¶](#section-4.3.1-3){.pilcrow}

::: {#section-4.3.1-4}
``` sourcecode
  IN AMTRELAY precedence D-bit type relay
```

[¶](#section-4.3.1-4){.pilcrow}
:::
:::
:::

::: {#examples}
::: {#section-4.3.2 .section}
#### [4.3.2.](#section-4.3.2){.section-number .selfRef} [Examples](#name-examples){.section-name .selfRef} {#name-examples}

In a DNS authoritative nameserver that understands the AMTRELAY type,
the zone might contain a set of entries like
this:[¶](#section-4.3.2-1){.pilcrow}

::: {#section-4.3.2-2}
``` sourcecode
    $ORIGIN 100.51.198.in-addr.arpa.
    12     IN AMTRELAY  10 0 1 203.0.113.15
    12     IN AMTRELAY  10 0 2 2001:db8::15
    12     IN AMTRELAY 128 1 3 amtrelays.example.com.
```

[¶](#section-4.3.2-2){.pilcrow}
:::

This configuration advertises an IPv4 discovery address, an IPv6
discovery address, and a domain name for AMT relays that can receive
traffic from the source 198.51.100.12. The IPv4 and IPv6 addresses are
configured with a D-bit of 0 (meaning discovery is mandatory, as
described in [Section 4.2.2](#rrdef-dbit){.xref}) and a precedence 10
(meaning they\'re preferred ahead of the last entry, which has
precedence 128).[¶](#section-4.3.2-3){.pilcrow}

For zone files in name servers that don\'t support the AMTRELAY RRType
natively, it\'s possible to use the format for unknown RR types, as
described in \[[RFC3597](#RFC3597){.xref}\]. This approach would replace
the AMTRELAY entries in the example above with the entries
below:[¶](#section-4.3.2-4){.pilcrow}

::: {#section-4.3.2-5}
``` sourcecode
    10   IN TYPE260  \# (
           6  ; length
           0a ; precedence=10
           01 ; D=0, relay type=1, an IPv4 address
           cb00710f ) ; 203.0.113.15
    10   IN TYPE260  \# (
           18 ; length
           0a ; precedence=10
           02 ; D=0, relay type=2, an IPv6 address
           20010db800000000000000000000000f ) ; 2001:db8::15
    10   IN TYPE260  \# (
           24 ; length
           80 ; precedence=128
           83 ; D=1, relay type=3, a wire-encoded domain name
         09616d7472656c617973076578616d706c6503636f6d ) ; domain name
```

[¶](#section-4.3.2-5){.pilcrow}
:::

See [Appendix A](#extranslate){.xref} for more
details.[¶](#section-4.3.2-6){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#iana}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document updates the DNS \"Resource Record (RR) TYPEs\" registry by
assigning type 260 to the AMTRELAY record.[¶](#section-5-1){.pilcrow}

This document creates a new registry named \"AMTRELAY Resource Record
Parameters\" with a subregistry for the \"Relay Type Field\". The
initial values in the subregistry are:[¶](#section-5-2){.pilcrow}

[]{#name-initial-contents-of-the-rel}

  Value   Description
  ------- ---------------------------------------
  0       No relay is present
  1       A 4-byte IPv4 address is present
  2       A 16-byte IPv6 address is present
  3       A wire-encoded domain name is present
  4-255   Unassigned

  : [Table 2](#table-2){.selfRef}: [Initial Contents of the \"Relay Type
  Field\" Registry](#name-initial-contents-of-the-rel){.selfRef}

Values 0, 1, 2, and 3 are further explained in Sections
[4.2.3](#rtype){.xref} and [4.2.4](#rdformat){.xref}. Relay type numbers
4 through 255 can be assigned with a policy of Specification Required
(as described in
\[[RFC8126](#RFC8126){.xref}\]).[¶](#section-5-4){.pilcrow}
:::
:::

::: {#security-considerations}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

::: {#use-of-amt}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Use of AMT](#name-use-of-amt){.section-name .selfRef} {#name-use-of-amt}

This document defines a mechanism that enables a more widespread and
automated use of AMT, even without access to a multicast backbone.
Operators of networks and applications that include a DRIAD-capable AMT
gateway are advised to carefully consider the security considerations in
[Section 6](https://www.rfc-editor.org/rfc/rfc7450#section-6){.relref}
of \[[RFC7450](#RFC7450){.xref}\].[¶](#section-6.1-1){.pilcrow}

AMT gateway operators also are encouraged to take appropriate steps to
ensure the integrity of the data received via AMT, for example, by the
opportunistic use of IPsec \[[RFC4301](#RFC4301){.xref}\] to secure
traffic received from AMT relays when IPSECKEY records
\[[RFC4025](#RFC4025){.xref}\] are available or when a trust
relationship with the AMT relays can be otherwise established and
secured.[¶](#section-6.1-2){.pilcrow}

Note that AMT does not itself provide any integrity protection for
Multicast Data packets ([Section
5.1.6](https://www.rfc-editor.org/rfc/rfc7450#section-5.1.6){.relref} of
\[[RFC7450](#RFC7450){.xref}\]), so absent protections like those
mentioned above, even an off-path attacker who discovers the gateway IP,
the relay IP, and the relay source port for an active AMT connection can
inject multicast data packets for a joined (S,G) into the data stream if
he can get data packets delivered to the gateway IP that spoof the relay
as the source.[¶](#section-6.1-3){.pilcrow}
:::
:::

::: {#record-spoofing}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Record-Spoofing](#name-record-spoofing){.section-name .selfRef} {#name-record-spoofing}

The AMTRELAY resource record contains information that [SHOULD]{.bcp14}
be communicated to the DNS client without being modified. The method
used to ensure the result was unmodified is up to the
client.[¶](#section-6.2-1){.pilcrow}

There must be a trust relationship between the end consumer of this
resource record and the DNS server. This relationship may be end-to-end
DNSSEC validation or a secure connection to a trusted DNS server that
provides end-to-end safety to prevent record-spoofing of the response
from the trusted server. The connection to the trusted server can use
any secure channel, such as with a TSIG \[[RFC2845](#RFC2845){.xref}\]
or SIG(0) \[[RFC2931](#RFC2931){.xref}\] channel, a secure local channel
on the host, DNS over TLS \[[RFC7858](#RFC7858){.xref}\], DNS over HTTPS
\[[RFC8484](#RFC8484){.xref}\], or some other mechanism that provides
authentication of the RR.[¶](#section-6.2-2){.pilcrow}

If an AMT gateway accepts a maliciously crafted AMTRELAY record, the
result could be a Denial of Service or receivers processing multicast
traffic from a source under the attacker\'s
control.[¶](#section-6.2-3){.pilcrow}
:::
:::

::: {#congestion}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Congestion](#name-congestion){.section-name .selfRef} {#name-congestion}

Multicast traffic, particularly interdomain multicast traffic, carries
some congestion risks, as described in [Section
4](https://www.rfc-editor.org/rfc/rfc8085#section-4){.relref} of
\[[RFC8085](#RFC8085){.xref}\].[¶](#section-6.3-1){.pilcrow}

Application implementors and network operators that use AMT gateways are
advised to take precautions, including monitoring of application traffic
behavior, traffic authentication at ingest, rate-limiting of multicast
traffic, and the use of circuit-breaker techniques such as those
described in [Section
3.1.10](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.10){.relref}
of \[[RFC8085](#RFC8085){.xref}\] and similar protections at the network
level in order to ensure network health in the event of
misconfiguration, poorly written applications that don\'t follow UDP
congestion control principles, or a deliberate
attack.[¶](#section-6.3-2){.pilcrow}

[Section
4.1.4.2](https://www.rfc-editor.org/rfc/rfc7450#section-4.1.4.2){.relref}
of \[[RFC7450](#RFC7450){.xref}\] and [Section
6.1](https://www.rfc-editor.org/rfc/rfc7450#section-6.1){.relref} of
\[[RFC7450](#RFC7450){.xref}\] provide some further considerations and
advice about mitigating congestion risk.[¶](#section-6.3-3){.pilcrow}
:::
:::
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC1034\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - concepts and
    facilities\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1034]{.seriesInfo}, [DOI 10.17487/RFC1034]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1034>\>.
:   

\[RFC1035\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - implementation and
    specification\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1035]{.seriesInfo}, [DOI 10.17487/RFC1035]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1035>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2181\]
:   [Elz, R.]{.refAuthor}[ and R. Bush]{.refAuthor}, [\"Clarifications
    to the DNS Specification\"]{.refTitle}, [RFC 2181]{.seriesInfo},
    [DOI 10.17487/RFC2181]{.seriesInfo}, July 1997,
    \<<https://www.rfc-editor.org/info/rfc2181>\>.
:   

\[RFC2782\]
:   [Gulbrandsen, A.]{.refAuthor}[, Vixie, P.]{.refAuthor}[, and L.
    Esibov]{.refAuthor}, [\"A DNS RR for specifying the location of
    services (DNS SRV)\"]{.refTitle}, [RFC 2782]{.seriesInfo}, [DOI
    10.17487/RFC2782]{.seriesInfo}, February 2000,
    \<<https://www.rfc-editor.org/info/rfc2782>\>.
:   

\[RFC3376\]
:   [Cain, B.]{.refAuthor}[, Deering, S.]{.refAuthor}[,
    Kouvelas, I.]{.refAuthor}[, Fenner, B.]{.refAuthor}[, and A.
    Thyagarajan]{.refAuthor}, [\"Internet Group Management Protocol,
    Version 3\"]{.refTitle}, [RFC 3376]{.seriesInfo}, [DOI
    10.17487/RFC3376]{.seriesInfo}, October 2002,
    \<<https://www.rfc-editor.org/info/rfc3376>\>.
:   

\[RFC3596\]
:   [Thomson, S.]{.refAuthor}[, Huitema, C.]{.refAuthor}[,
    Ksinant, V.]{.refAuthor}[, and M. Souissi]{.refAuthor}, [\"DNS
    Extensions to Support IP Version 6\"]{.refTitle}, [STD
    88]{.seriesInfo}, [RFC 3596]{.seriesInfo}, [DOI
    10.17487/RFC3596]{.seriesInfo}, October 2003,
    \<<https://www.rfc-editor.org/info/rfc3596>\>.
:   

\[RFC3597\]
:   [Gustafsson, A.]{.refAuthor}, [\"Handling of Unknown DNS Resource
    Record (RR) Types\"]{.refTitle}, [RFC 3597]{.seriesInfo}, [DOI
    10.17487/RFC3597]{.seriesInfo}, September 2003,
    \<<https://www.rfc-editor.org/info/rfc3597>\>.
:   

\[RFC3810\]
:   [Vida, R., Ed.]{.refAuthor}[ and L. Costa, Ed.]{.refAuthor},
    [\"Multicast Listener Discovery Version 2 (MLDv2) for
    IPv6\"]{.refTitle}, [RFC 3810]{.seriesInfo}, [DOI
    10.17487/RFC3810]{.seriesInfo}, June 2004,
    \<<https://www.rfc-editor.org/info/rfc3810>\>.
:   

\[RFC4604\]
:   [Holbrook, H.]{.refAuthor}[, Cain, B.]{.refAuthor}[, and B.
    Haberman]{.refAuthor}, [\"Using Internet Group Management Protocol
    Version 3 (IGMPv3) and Multicast Listener Discovery Protocol Version
    2 (MLDv2) for Source-Specific Multicast\"]{.refTitle}, [RFC
    4604]{.seriesInfo}, [DOI 10.17487/RFC4604]{.seriesInfo}, August
    2006, \<<https://www.rfc-editor.org/info/rfc4604>\>.
:   

\[RFC4607\]
:   [Holbrook, H.]{.refAuthor}[ and B. Cain]{.refAuthor},
    [\"Source-Specific Multicast for IP\"]{.refTitle}, [RFC
    4607]{.seriesInfo}, [DOI 10.17487/RFC4607]{.seriesInfo}, August
    2006, \<<https://www.rfc-editor.org/info/rfc4607>\>.
:   

\[RFC6724\]
:   [Thaler, D., Ed.]{.refAuthor}[, Draves, R.]{.refAuthor}[,
    Matsumoto, A.]{.refAuthor}[, and T. Chown]{.refAuthor}, [\"Default
    Address Selection for Internet Protocol Version 6
    (IPv6)\"]{.refTitle}, [RFC 6724]{.seriesInfo}, [DOI
    10.17487/RFC6724]{.seriesInfo}, September 2012,
    \<<https://www.rfc-editor.org/info/rfc6724>\>.
:   

\[RFC6763\]
:   [Cheshire, S.]{.refAuthor}[ and M. Krochmal]{.refAuthor},
    [\"DNS-Based Service Discovery\"]{.refTitle}, [RFC
    6763]{.seriesInfo}, [DOI 10.17487/RFC6763]{.seriesInfo}, February
    2013, \<<https://www.rfc-editor.org/info/rfc6763>\>.
:   

\[RFC7450\]
:   [Bumgardner, G.]{.refAuthor}, [\"Automatic Multicast
    Tunneling\"]{.refTitle}, [RFC 7450]{.seriesInfo}, [DOI
    10.17487/RFC7450]{.seriesInfo}, February 2015,
    \<<https://www.rfc-editor.org/info/rfc7450>\>.
:   

\[RFC8085\]
:   [Eggert, L.]{.refAuthor}[, Fairhurst, G.]{.refAuthor}[, and G.
    Shepherd]{.refAuthor}, [\"UDP Usage Guidelines\"]{.refTitle}, [BCP
    145]{.seriesInfo}, [RFC 8085]{.seriesInfo}, [DOI
    10.17487/RFC8085]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8085>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8305\]
:   [Schinazi, D.]{.refAuthor}[ and T. Pauly]{.refAuthor}, [\"Happy
    Eyeballs Version 2: Better Connectivity Using
    Concurrency\"]{.refTitle}, [RFC 8305]{.seriesInfo}, [DOI
    10.17487/RFC8305]{.seriesInfo}, December 2017,
    \<<https://www.rfc-editor.org/info/rfc8305>\>.
:   

\[RFC8499\]
:   [Hoffman, P.]{.refAuthor}[, Sullivan, A.]{.refAuthor}[, and K.
    Fujiwara]{.refAuthor}, [\"DNS Terminology\"]{.refTitle}, [BCP
    219]{.seriesInfo}, [RFC 8499]{.seriesInfo}, [DOI
    10.17487/RFC8499]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8499>\>.
:   
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC2317\]
:   [Eidnes, H.]{.refAuthor}[, de Groot, G.]{.refAuthor}[, and P.
    Vixie]{.refAuthor}, [\"Classless IN-ADDR.ARPA
    delegation\"]{.refTitle}, [BCP 20]{.seriesInfo}, [RFC
    2317]{.seriesInfo}, [DOI 10.17487/RFC2317]{.seriesInfo}, March 1998,
    \<<https://www.rfc-editor.org/info/rfc2317>\>.
:   

\[RFC2845\]
:   [Vixie, P.]{.refAuthor}[, Gudmundsson, O.]{.refAuthor}[, Eastlake
    3rd, D.]{.refAuthor}[, and B. Wellington]{.refAuthor}, [\"Secret Key
    Transaction Authentication for DNS (TSIG)\"]{.refTitle}, [RFC
    2845]{.seriesInfo}, [DOI 10.17487/RFC2845]{.seriesInfo}, May 2000,
    \<<https://www.rfc-editor.org/info/rfc2845>\>.
:   

\[RFC2931\]
:   [Eastlake 3rd, D.]{.refAuthor}, [\"DNS Request and Transaction
    Signatures ( SIG(0)s )\"]{.refTitle}, [RFC 2931]{.seriesInfo}, [DOI
    10.17487/RFC2931]{.seriesInfo}, September 2000,
    \<<https://www.rfc-editor.org/info/rfc2931>\>.
:   

\[RFC3550\]
:   [Schulzrinne, H.]{.refAuthor}[, Casner, S.]{.refAuthor}[,
    Frederick, R.]{.refAuthor}[, and V. Jacobson]{.refAuthor}, [\"RTP: A
    Transport Protocol for Real-Time Applications\"]{.refTitle}, [STD
    64]{.seriesInfo}, [RFC 3550]{.seriesInfo}, [DOI
    10.17487/RFC3550]{.seriesInfo}, July 2003,
    \<<https://www.rfc-editor.org/info/rfc3550>\>.
:   

\[RFC4025\]
:   [Richardson, M.]{.refAuthor}, [\"A Method for Storing IPsec Keying
    Material in DNS\"]{.refTitle}, [RFC 4025]{.seriesInfo}, [DOI
    10.17487/RFC4025]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4025>\>.
:   

\[RFC4301\]
:   [Kent, S.]{.refAuthor}[ and K. Seo]{.refAuthor}, [\"Security
    Architecture for the Internet Protocol\"]{.refTitle}, [RFC
    4301]{.seriesInfo}, [DOI 10.17487/RFC4301]{.seriesInfo}, December
    2005, \<<https://www.rfc-editor.org/info/rfc4301>\>.
:   

\[RFC4787\]
:   [Audet, F., Ed.]{.refAuthor}[ and C. Jennings]{.refAuthor},
    [\"Network Address Translation (NAT) Behavioral Requirements for
    Unicast UDP\"]{.refTitle}, [BCP 127]{.seriesInfo}, [RFC
    4787]{.seriesInfo}, [DOI 10.17487/RFC4787]{.seriesInfo}, January
    2007, \<<https://www.rfc-editor.org/info/rfc4787>\>.
:   

\[RFC5110\]
:   [Savola, P.]{.refAuthor}, [\"Overview of the Internet Multicast
    Routing Architecture\"]{.refTitle}, [RFC 5110]{.seriesInfo}, [DOI
    10.17487/RFC5110]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5110>\>.
:   

\[RFC6726\]
:   [Paila, T.]{.refAuthor}[, Walsh, R.]{.refAuthor}[,
    Luby, M.]{.refAuthor}[, Roca, V.]{.refAuthor}[, and R.
    Lehtonen]{.refAuthor}, [\"FLUTE - File Delivery over Unidirectional
    Transport\"]{.refTitle}, [RFC 6726]{.seriesInfo}, [DOI
    10.17487/RFC6726]{.seriesInfo}, November 2012,
    \<<https://www.rfc-editor.org/info/rfc6726>\>.
:   

\[RFC7359\]
:   [Gont, F.]{.refAuthor}, [\"Layer 3 Virtual Private Network (VPN)
    Tunnel Traffic Leakages in Dual-Stack Hosts/Networks\"]{.refTitle},
    [RFC 7359]{.seriesInfo}, [DOI 10.17487/RFC7359]{.seriesInfo}, August
    2014, \<<https://www.rfc-editor.org/info/rfc7359>\>.
:   

\[RFC7761\]
:   [Fenner, B.]{.refAuthor}[, Handley, M.]{.refAuthor}[,
    Holbrook, H.]{.refAuthor}[, Kouvelas, I.]{.refAuthor}[,
    Parekh, R.]{.refAuthor}[, Zhang, Z.]{.refAuthor}[, and L.
    Zheng]{.refAuthor}, [\"Protocol Independent Multicast - Sparse Mode
    (PIM-SM): Protocol Specification (Revised)\"]{.refTitle}, [STD
    83]{.seriesInfo}, [RFC 7761]{.seriesInfo}, [DOI
    10.17487/RFC7761]{.seriesInfo}, March 2016,
    \<<https://www.rfc-editor.org/info/rfc7761>\>.
:   

\[RFC7858\]
:   [Hu, Z.]{.refAuthor}[, Zhu, L.]{.refAuthor}[,
    Heidemann, J.]{.refAuthor}[, Mankin, A.]{.refAuthor}[,
    Wessels, D.]{.refAuthor}[, and P. Hoffman]{.refAuthor},
    [\"Specification for DNS over Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 7858]{.seriesInfo}, [DOI
    10.17487/RFC7858]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7858>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8313\]
:   [Tarapore, P., Ed.]{.refAuthor}[, Sayko, R.]{.refAuthor}[,
    Shepherd, G.]{.refAuthor}[, Eckert, T., Ed.]{.refAuthor}[, and R.
    Krishnan]{.refAuthor}, [\"Use of Multicast across Inter-domain
    Peering Points\"]{.refTitle}, [BCP 213]{.seriesInfo}, [RFC
    8313]{.seriesInfo}, [DOI 10.17487/RFC8313]{.seriesInfo}, January
    2018, \<<https://www.rfc-editor.org/info/rfc8313>\>.
:   

\[RFC8484\]
:   [Hoffman, P.]{.refAuthor}[ and P. McManus]{.refAuthor}, [\"DNS
    Queries over HTTPS (DoH)\"]{.refTitle}, [RFC 8484]{.seriesInfo},
    [DOI 10.17487/RFC8484]{.seriesInfo}, October 2018,
    \<<https://www.rfc-editor.org/info/rfc8484>\>.
:   
:::
:::

::: {#extranslate}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Unknown RRType Construction](#name-unknown-rrtype-construction){.section-name .selfRef} {#name-unknown-rrtype-construction}

In a DNS resolver that understands the AMTRELAY type, the zone file
might contain this line:[¶](#section-appendix.a-1){.pilcrow}

::: {#section-appendix.a-2}
``` sourcecode
  IN AMTRELAY 128 0 3 amtrelays.example.com.
```

[¶](#section-appendix.a-2){.pilcrow}
:::

In order to translate this example to appear as an unknown RRType as
defined in \[[RFC3597](#RFC3597){.xref}\], one could run the following
program:[¶](#section-appendix.a-3){.pilcrow}

::: {#section-appendix.a-4}
``` {.sourcecode .lang-python}
<CODE BEGINS>
  $ cat translate.py
  #!/usr/bin/env python3
  import sys
  name=sys.argv[1]
  wire=''
  for dn in name.split('.'):
    if len(dn) > 0:
      wire += ('%02x' % len(dn))
      wire += (''.join('%02x'%ord(x) for x in dn))
  print(len(wire)//2) + 2
  print(wire)

  $ ./translate.py amtrelays.example.com
  24
  09616d7472656c617973076578616d706c6503636f6d

<CODE ENDS>
```

[¶](#section-appendix.a-4){.pilcrow}
:::

The length of the RData and the hex string for the domain name
\"amtrelays.example.com\" are the outputs of this
program.[¶](#section-appendix.a-5){.pilcrow}

The length of the wire-encoded domain name is 22, so 2 was added to that
value (1 for the precedence field and 1 for the combined D-bit and relay
type fields) to get the full length 24 of the RData. For the 2 octets
ahead of the domain name, we encode the precedence, D-bit, and relay
type fields, as described in [Section
4](#rrdef){.xref}.[¶](#section-appendix.a-6){.pilcrow}

This results in a zone file entry like
this:[¶](#section-appendix.a-7){.pilcrow}

::: {#section-appendix.a-8 .artwork .art-text .alignLeft}
      IN TYPE260  \# ( 24 ; length
              80 ; precedence = 128
              03 ; D-bit=0, relay type=3 (wire-encoded domain name)
            09616d7472656c617973076578616d706c6503636f6d ) ; domain name

[¶](#section-appendix.a-8){.pilcrow}
:::
:::
:::

::: {#acknowledgements}
::: {#section-appendix.b .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

This specification was inspired by the previous work of [Doug
Nortz]{.contact-name}, [Robert Sayko]{.contact-name}, [David
Segelstein]{.contact-name}, and [Percy Tarapore]{.contact-name},
presented in the MBONED Working Group at IETF
93.[¶](#section-appendix.b-1){.pilcrow}

Thanks to [Jeff Goldsmith]{.contact-name}, [Toerless
Eckert]{.contact-name}, [Mikael Abrahamsson]{.contact-name}, [Lenny
Giuliano]{.contact-name}, [Mark Andrews]{.contact-name}, [Sandy
Zheng]{.contact-name}, [Kyle Rose]{.contact-name}, [Ben
Kaduk]{.contact-name}, [Bill Atwood]{.contact-name}, [Tim
Chown]{.contact-name}, [Christian Worm Mortensen]{.contact-name},
[Warren Kumari]{.contact-name}, [Dan Romanescu]{.contact-name}, [Bernard
Aboba]{.contact-name}, [Carlos Pignataro]{.contact-name}, [Niclas
Comstedt]{.contact-name}, [Mirja Kühlewind]{.contact-name}, [Henning
Rogge]{.contact-name}, [Eric Vyncke]{.contact-name}, [Barry
Lieba]{.contact-name}, [Roman Danyliw]{.contact-name}, [Alissa
Cooper]{.contact-name}, [Suresh Krishnan]{.contact-name}, [Adam
Roach]{.contact-name}, and [Daniel Franke]{.contact-name} for their very
helpful reviews and comments.[¶](#section-appendix.b-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Jake Holland]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Akamai Technologies, Inc.]{.org}
:::

::: {.left dir="auto"}
[150 Broadway]{.street-address}
:::

::: {.left dir="auto"}
[Cambridge]{.locality}, [MA]{.region} [02144]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <jakeholland.net@gmail.com>
:::
:::
:::
