  RFC 9173               BPSec Default Security Contexts   January 2022
  ---------------------- --------------------------------- --------------
  Birrane, III, et al.   Standards Track                   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9173](https://www.rfc-editor.org/rfc/rfc9173){.eref}

Category:
:   Standards Track

Published:
:   January 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    E. Birrane, III
    :::

    ::: org
    JHU/APL
    :::
    :::

    ::: author
    ::: author-name
    A. White
    :::

    ::: org
    JHU/APL
    :::
    :::

    ::: author
    ::: author-name
    S. Heiner
    :::

    ::: org
    JHU/APL
    :::
    :::
:::

# RFC 9173 {#rfcnum}

# Default Security Contexts for Bundle Protocol Security (BPSec) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document defines default integrity and confidentiality security
contexts that can be used with Bundle Protocol Security (BPSec)
implementations. These security contexts are intended to be used both
for testing the interoperability of BPSec implementations and for
providing basic security operations when no other security contexts are
defined or otherwise required for a
network.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9173>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Requirements
    Language](#name-requirements-language){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Integrity Security Context
    BIB-HMAC-SHA2](#name-integrity-security-context-){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Overview](#name-overview){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Scope](#name-scope){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Parameters](#name-parameters){.xref}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [SHA
            Variant](#name-sha-variant){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.2}
            [3.3.2](#section-3.3.2){.xref}.  [Wrapped
            Key](#name-wrapped-key){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.3}
            [3.3.3](#section-3.3.3){.xref}.  [Integrity Scope
            Flags](#name-integrity-scope-flags){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.4}
            [3.3.4](#section-3.3.4){.xref}.  [Enumerations](#name-enumerations){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Results](#name-results){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Key
        Considerations](#name-key-considerations){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [Security Processing
        Considerations](#name-security-processing-conside){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Canonicalization
        Algorithms](#name-canonicalization-algorithms){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.8}
        [3.8](#section-3.8){.xref}.  [Processing](#name-processing){.xref}

        -   ::: {#section-toc.1-1.3.2.8.2.1}
            [3.8.1](#section-3.8.1){.xref}.  [Keyed Hash
            Generation](#name-keyed-hash-generation){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.2}
            [3.8.2](#section-3.8.2){.xref}.  [Keyed Hash
            Verification](#name-keyed-hash-verification){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Security Context
    BCB-AES-GCM](#name-security-context-bcb-aes-gc){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Overview](#name-overview-2){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Scope](#name-scope-2){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Parameters](#name-parameters-2){.xref}

        -   ::: {#section-toc.1-1.4.2.3.2.1}
            [4.3.1](#section-4.3.1){.xref}.  [Initialization
            Vector (IV)](#name-initialization-vector-iv){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.2}
            [4.3.2](#section-4.3.2){.xref}.  [AES
            Variant](#name-aes-variant){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.3}
            [4.3.3](#section-4.3.3){.xref}.  [Wrapped
            Key](#name-wrapped-key-2){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.4}
            [4.3.4](#section-4.3.4){.xref}.  [AAD Scope
            Flags](#name-aad-scope-flags){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.5}
            [4.3.5](#section-4.3.5){.xref}.  [Enumerations](#name-enumerations-2){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Results](#name-results-2){.xref}

        -   ::: {#section-toc.1-1.4.2.4.2.1}
            [4.4.1](#section-4.4.1){.xref}.  [Authentication
            Tag](#name-authentication-tag){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.2}
            [4.4.2](#section-4.4.2){.xref}.  [Enumerations](#name-enumerations-3){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [Key
        Considerations](#name-key-considerations-2){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.6}
        [4.6](#section-4.6){.xref}.  [GCM
        Considerations](#name-gcm-considerations){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.7}
        [4.7](#section-4.7){.xref}.  [Canonicalization
        Algorithms](#name-canonicalization-algorithms-2){.xref}

        -   ::: {#section-toc.1-1.4.2.7.2.1}
            [4.7.1](#section-4.7.1){.xref}.  [Calculations Related to
            Ciphertext](#name-calculations-related-to-cip){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.7.2.2}
            [4.7.2](#section-4.7.2){.xref}.  [Additional Authenticated
            Data](#name-additional-authenticated-da){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.8}
        [4.8](#section-4.8){.xref}.  [Processing](#name-processing-2){.xref}

        -   ::: {#section-toc.1-1.4.2.8.2.1}
            [4.8.1](#section-4.8.1){.xref}.  [Encryption](#name-encryption){.xref}
            :::

        -   ::: {#section-toc.1-1.4.2.8.2.2}
            [4.8.2](#section-4.8.2){.xref}.  [Decryption](#name-decryption){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Security Context
        Identifiers](#name-security-context-identifier){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Integrity Scope
        Flags](#name-integrity-scope-flags-2){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [AAD Scope
        Flags](#name-aad-scope-flags-2){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Guidance for Designated
        Experts](#name-guidance-for-designated-exp){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Key
        Management](#name-key-management){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Key
        Handling](#name-key-handling){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [AES GCM](#name-aes-gcm){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [AES Key
        Wrap](#name-aes-key-wrap){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [Bundle
        Fragmentation](#name-bundle-fragmentation){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Normative
    References](#name-normative-references){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [Appendix A](#appendix-A){.xref}.  [Examples](#name-examples){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [A.1](#appendix-A.1){.xref}.  [Example 1 - Simple
        Integrity](#name-example-1-simple-integrity){.xref}

        -   ::: {#section-toc.1-1.8.2.1.2.1}
            [A.1.1](#appendix-A.1.1){.xref}.  [Original
            Bundle](#name-original-bundle){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.1.2.2}
            [A.1.2](#appendix-A.1.2){.xref}.  [Security Operation
            Overview](#name-security-operation-overview){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.1.2.3}
            [A.1.3](#appendix-A.1.3){.xref}.  [Block Integrity
            Block](#name-block-integrity-block){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.1.2.4}
            [A.1.4](#appendix-A.1.4){.xref}.  [Final
            Bundle](#name-final-bundle){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [A.2](#appendix-A.2){.xref}.  [Example 2 - Simple
        Confidentiality with Key
        Wrap](#name-example-2-simple-confidenti){.xref}

        -   ::: {#section-toc.1-1.8.2.2.2.1}
            [A.2.1](#appendix-A.2.1){.xref}.  [Original
            Bundle](#name-original-bundle-2){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.2.2.2}
            [A.2.2](#appendix-A.2.2){.xref}.  [Security Operation
            Overview](#name-security-operation-overview-2){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.2.2.3}
            [A.2.3](#appendix-A.2.3){.xref}.  [Block Confidentiality
            Block](#name-block-confidentiality-block){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.2.2.4}
            [A.2.4](#appendix-A.2.4){.xref}.  [Final
            Bundle](#name-final-bundle-2){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [A.3](#appendix-A.3){.xref}.  [Example 3 - Security Blocks from
        Multiple Sources](#name-example-3-security-blocks-f){.xref}

        -   ::: {#section-toc.1-1.8.2.3.2.1}
            [A.3.1](#appendix-A.3.1){.xref}.  [Original
            Bundle](#name-original-bundle-3){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.2}
            [A.3.2](#appendix-A.3.2){.xref}.  [Security Operation
            Overview](#name-security-operation-overview-3){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.3}
            [A.3.3](#appendix-A.3.3){.xref}.  [Block Integrity
            Block](#name-block-integrity-block-2){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.4}
            [A.3.4](#appendix-A.3.4){.xref}.  [Block Confidentiality
            Block](#name-block-confidentiality-block-2){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.3.2.5}
            [A.3.5](#appendix-A.3.5){.xref}.  [Final
            Bundle](#name-final-bundle-3){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [A.4](#appendix-A.4){.xref}.  [Example 4 - Security Blocks with
        Full Scope](#name-example-4-security-blocks-w){.xref}

        -   ::: {#section-toc.1-1.8.2.4.2.1}
            [A.4.1](#appendix-A.4.1){.xref}.  [Original
            Bundle](#name-original-bundle-4){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.4.2.2}
            [A.4.2](#appendix-A.4.2){.xref}.  [Security Operation
            Overview](#name-security-operation-overview-4){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.4.2.3}
            [A.4.3](#appendix-A.4.3){.xref}.  [Block Integrity
            Block](#name-block-integrity-block-3){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.4.2.4}
            [A.4.4](#appendix-A.4.4){.xref}.  [Block Confidentiality
            Block](#name-block-confidentiality-block-3){.xref}
            :::

        -   ::: {#section-toc.1-1.8.2.4.2.5}
            [A.4.5](#appendix-A.4.5){.xref}.  [Final
            Bundle](#name-final-bundle-4){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [Appendix B](#appendix-B){.xref}.  [CDDL
    Expression](#name-cddl-expression){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [](#appendix-C){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-D){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Bundle Protocol Security (BPSec) specification
\[[RFC9172](#RFC9172){.xref}\] provides inter-bundle integrity and
confidentiality operations for networks deploying the Bundle Protocol
(BP) \[[RFC9171](#RFC9171){.xref}\]. BPSec defines BP extension blocks
to carry security information produced under the auspices of some
security context.[¶](#section-1-1){.pilcrow}

This document defines two security contexts (one for an integrity
service and one for a confidentiality service) for populating BPSec
Block Integrity Blocks (BIBs) and Block Confidentiality Blocks (BCBs).
This document assumes familiarity with the concepts and terminology
associated with BP and BPSec, as these security contexts are used with
BPSec security blocks and other BP blocks carried within BP
bundles.[¶](#section-1-2){.pilcrow}

These contexts generate information that [MUST]{.bcp14} be encoded using
the Concise Binary Object Representation (CBOR) specification documented
in \[[RFC8949](#RFC8949){.xref}\].[¶](#section-1-3){.pilcrow}
:::
:::

::: {#term}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::
:::

::: {#first-context}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Integrity Security Context BIB-HMAC-SHA2](#name-integrity-security-context-){.section-name .selfRef} {#name-integrity-security-context-}

::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Overview](#name-overview){.section-name .selfRef} {#name-overview}

The BIB-HMAC-SHA2 security context provides a keyed-hash Message
Authentication Code (MAC) over a set of plaintext information. This
context uses the Secure Hash Algorithm 2 (SHA-2) discussed in
\[[SHS](#SHS){.xref}\] combined with the Hashed Message Authentication
Code (HMAC) keyed hash discussed in \[[RFC2104](#RFC2104){.xref}\]. The
combination of HMAC and SHA-2 as the integrity mechanism for this
security context was selected for two
reasons:[¶](#section-3.1-1){.pilcrow}

1.  [The use of symmetric keys allows this security context to be used
    in places where an asymmetric-key infrastructure (such as a public
    key infrastructure) might be
    impractical.[¶](#section-3.1-2.1){.pilcrow}]{#section-3.1-2.1}
2.  [The combination HMAC-SHA2 represents a well-supported and
    well-understood integrity mechanism with multiple implementations
    available.[¶](#section-3.1-2.2){.pilcrow}]{#section-3.1-2.2}

BIB-HMAC-SHA2 supports three variants of HMAC-SHA, based on the
supported length of the SHA-2 hash value. These variants correspond to
HMAC 256/256, HMAC 384/384, and HMAC 512/512 as defined in Table 7
(\"HMAC Algorithm Values\") of \[[RFC8152](#RFC8152){.xref}\]. The
selection of which variant is used by this context is provided as a
security context parameter.[¶](#section-3.1-3){.pilcrow}

The output of the HMAC [MUST]{.bcp14} be equal to the size of the SHA2
hashing function: 256 bits for SHA-256, 384 bits for SHA-384, and 512
bits for SHA-512.[¶](#section-3.1-4){.pilcrow}

The BIB-HMAC-SHA2 security context [MUST]{.bcp14} have the security
context identifier specified in [Section
5.1](#sc_ids){.xref}.[¶](#section-3.1-5){.pilcrow}
:::

::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Scope](#name-scope){.section-name .selfRef} {#name-scope}

The scope of BIB-HMAC-SHA2 is the set of information used to produce the
plaintext over which a keyed hash is calculated. This plaintext is
termed the \"Integrity-Protected Plaintext (IPPT)\". The content of the
IPPT is constructed as the concatenation of information whose integrity
is being preserved from the BIB-HMAC-SHA2 security source to its
security acceptor. There are five types of information that can be used
in the generation of the IPPT, based on how broadly the concept of
integrity is being applied. These five types of information, whether
they are required, and why they are important for integrity are
discussed as follows.[¶](#section-3.2-1){.pilcrow}

[]{.break}

Security target contents
:   The contents of the block-type-specific data field of the security
    target [MUST]{.bcp14} be included in the IPPT. Including this
    information protects the security target data and is considered the
    minimal, required set of information for an integrity service on the
    security target.[¶](#section-3.2-2.2){.pilcrow}
:   

IPPT scope
:   The determination of which optional types of information were used
    when constructing the IPPT [MUST]{.bcp14} always be included in the
    IPPT. Including this information ensures that the scope of the IPPT
    construction at a security source matches the scope of the IPPT
    construction at security verifiers and security
    acceptors.[¶](#section-3.2-2.4){.pilcrow}
:   

Primary block

:   The primary block identifies a bundle, and once created, the
    contents of this block are immutable. Changes to the primary block
    associated with the security target indicate that the security
    target (and BIB) might no longer be in the correct
    bundle.[¶](#section-3.2-2.6.1){.pilcrow}

    For example, if a security target and associated BIB are copied from
    one bundle to another bundle, the BIB might still contain a
    verifiable signature for the security target unless information
    associated with the bundle primary block is included in the keyed
    hash carried by the BIB.[¶](#section-3.2-2.6.2){.pilcrow}

    Including this information in the IPPT protects the integrity of the
    association of the security target with a specific
    bundle.[¶](#section-3.2-2.6.3){.pilcrow}

:   

Other fields of the security target

:   The other fields of the security target include block identification
    and processing information. Changing this information changes how
    the security target is treated by nodes in the network even when the
    \"user data\" of the security target are otherwise
    unchanged.[¶](#section-3.2-2.8.1){.pilcrow}

    For example, if the block processing control flags of a security
    target are different at a security verifier than they were
    originally set at the security source, then the policy for handling
    the security target has been
    modified.[¶](#section-3.2-2.8.2){.pilcrow}

    Including this information in the IPPT protects the integrity of the
    policy and identification of the security target
    data.[¶](#section-3.2-2.8.3){.pilcrow}

:   

Other fields of the BIB

:   The other fields of the BIB include block identification and
    processing information. Changing this information changes how the
    BIB is treated by nodes in the network, even when other aspects of
    the BIB are unchanged.[¶](#section-3.2-2.10.1){.pilcrow}

    For example, if the block processing control flags of the BIB are
    different at a security verifier than they were originally set at
    the security source, then the policy for handling the BIB has been
    modified.[¶](#section-3.2-2.10.2){.pilcrow}

    Including this information in the IPPT protects the integrity of the
    policy and identification of the security service in the
    bundle.[¶](#section-3.2-2.10.3){.pilcrow}

    NOTE: The security context identifier and security context
    parameters of the security block are not included in the IPPT
    because these parameters, by definition, are required to verify or
    accept the security service. Successful verification at security
    verifiers and security acceptors implies that these parameters were
    unchanged since being specified at the security source. This is the
    case because keys cannot be reused across security contexts and
    because the integrity scope flags used to define the IPPT are
    included in the IPPT itself.[¶](#section-3.2-2.10.4.1){.pilcrow}

:   

The scope of the BIB-HMAC-SHA2 security context is configured using an
optional security context parameter.[¶](#section-3.2-3){.pilcrow}
:::

::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Parameters](#name-parameters){.section-name .selfRef} {#name-parameters}

BIB-HMAC-SHA2 can be parameterized to select SHA-2 variants, communicate
key information, and define the scope of the
IPPT.[¶](#section-3.3-1){.pilcrow}

::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [SHA Variant](#name-sha-variant){.section-name .selfRef} {#name-sha-variant}

This optional parameter identifies which variant of the SHA-2 algorithm
is to be used in the generation of the authentication
code.[¶](#section-3.3.1-1){.pilcrow}

This value [MUST]{.bcp14} be encoded as a CBOR unsigned
integer.[¶](#section-3.3.1-2){.pilcrow}

Valid values for this parameter are as
follows.[¶](#section-3.3.1-3){.pilcrow}

[]{#name-sha-variant-parameter-value}

::: {#sha_var}
  Value   Description
  ------- --------------------------------------------------------------------------------------------------
  5       HMAC 256/256 as defined in Table 7 (\"HMAC Algorithm Values\") of \[[RFC8152](#RFC8152){.xref}\]
  6       HMAC 384/384 as defined in Table 7 (\"HMAC Algorithm Values\") of \[[RFC8152](#RFC8152){.xref}\]
  7       HMAC 512/512 as defined in Table 7 (\"HMAC Algorithm Values\") of \[[RFC8152](#RFC8152){.xref}\]

  : [Table 1](#table-1){.selfRef}: [SHA Variant Parameter
  Values](#name-sha-variant-parameter-value){.selfRef}
:::

When not provided, implementations [SHOULD]{.bcp14} assume a value of 6
(indicating use of HMAC 384/384), unless an alternate default is
established by local security policy at the security source, verifiers,
or acceptor of this integrity service.[¶](#section-3.3.1-5){.pilcrow}
:::

::: {#section-3.3.2 .section}
#### [3.3.2.](#section-3.3.2){.section-number .selfRef} [Wrapped Key](#name-wrapped-key){.section-name .selfRef} {#name-wrapped-key}

This optional parameter contains the output of the AES key wrap function
as defined in \[[RFC3394](#RFC3394){.xref}\]. Specifically, this
parameter holds the ciphertext produced when running this key wrap
algorithm with the input string being the symmetric HMAC key used to
generate the security results present in the security block. The value
of this parameter is used as input to the AES key wrap authenticated
decryption function at security verifiers and security acceptors to
determine the symmetric HMAC key needed for the proper validation of the
security results in the security block.[¶](#section-3.3.2-1){.pilcrow}

This value [MUST]{.bcp14} be encoded as a CBOR byte
string.[¶](#section-3.3.2-2){.pilcrow}

If this parameter is not present, then security verifiers and acceptors
[MUST]{.bcp14} determine the proper key as a function of their local
BPSec policy and configuration.[¶](#section-3.3.2-3){.pilcrow}
:::

::: {#section-3.3.3 .section}
#### [3.3.3.](#section-3.3.3){.section-number .selfRef} [Integrity Scope Flags](#name-integrity-scope-flags){.section-name .selfRef} {#name-integrity-scope-flags}

This optional parameter contains a series of flags that describe what
information is to be included with the block-type-specific data when
constructing the IPPT value.[¶](#section-3.3.3-1){.pilcrow}

This value [MUST]{.bcp14} be represented as a CBOR unsigned integer, the
value of which [MUST]{.bcp14} be processed as a 16-bit field. The
maximum value of this field, as a CBOR unsigned integer, [MUST]{.bcp14}
be 65535.[¶](#section-3.3.3-2){.pilcrow}

When not provided, implementations [SHOULD]{.bcp14} assume a value of 7
(indicating all assigned fields), unless an alternate default is
established by local security policy at the security source, verifier,
or acceptor of this integrity service.[¶](#section-3.3.3-3){.pilcrow}

Implementations [MUST]{.bcp14} set reserved and unassigned bits in this
field to 0 when constructing these flags at a security source. Once set,
the value of this field [MUST NOT]{.bcp14} be altered until the security
service is completed at the security acceptor in the network and removed
from the bundle.[¶](#section-3.3.3-4){.pilcrow}

Bits in this field represent additional information to be included when
generating an integrity signature over the security target. These bits
are defined as follows.[¶](#section-3.3.3-5){.pilcrow}

[]{.break}

Bit 0 (the low-order bit, 0x0001):
:   Include primary block flag[¶](#section-3.3.3-6.2){.pilcrow}
:   

Bit 1 (0x0002):
:   Include target header flag[¶](#section-3.3.3-6.4){.pilcrow}
:   

Bit 2 (0x0004):
:   Include security header flag[¶](#section-3.3.3-6.6){.pilcrow}
:   

Bits 3-7:
:   Reserved[¶](#section-3.3.3-6.8){.pilcrow}
:   

Bits 8-15:
:   Unassigned[¶](#section-3.3.3-6.10){.pilcrow}
:   
:::

::: {#section-3.3.4 .section}
#### [3.3.4.](#section-3.3.4){.section-number .selfRef} [Enumerations](#name-enumerations){.section-name .selfRef} {#name-enumerations}

The BIB-HMAC-SHA2 security context parameters are listed in [Table
2](#bib_parm_table){.xref}. In this table, the \"Parm Id\" column refers
to the expected parameter identifier described in Section
[3.10](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref}
([\"Parameter and Result
Identification\"](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref})
of \[[RFC9172](#RFC9172){.xref}\].[¶](#section-3.3.4-1){.pilcrow}

An empty \"Default Value\" column indicates that the security context
parameter does not have a default value.[¶](#section-3.3.4-2){.pilcrow}

[]{#name-bib-hmac-sha2-security-cont}

::: {#bib_parm_table}
  Parm Id   Parm Name               CBOR Encoding Type   Default Value
  --------- ----------------------- -------------------- ---------------
  1         SHA Variant             unsigned integer     6
  2         Wrapped Key             byte string          
  3         Integrity Scope Flags   unsigned integer     7

  : [Table 2](#table-2){.selfRef}: [BIB-HMAC-SHA2 Security Context
  Parameters](#name-bib-hmac-sha2-security-cont){.selfRef}
:::
:::
:::

::: {#bib_results}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Results](#name-results){.section-name .selfRef} {#name-results}

The BIB-HMAC-SHA2 security context results are listed in [Table
3](#bib_res_table){.xref}. In this table, the \"Result Id\" column
refers to the expected result identifier described in Section
[3.10](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref}
([\"Parameter and Result
Identification\"](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref})
of \[[RFC9172](#RFC9172){.xref}\].[¶](#section-3.4-1){.pilcrow}

[]{#name-bib-hmac-sha2-security-resu}

::: {#bib_res_table}
  Result Id   Result Name     CBOR Encoding Type   Description
  ----------- --------------- -------------------- ------------------------------------------------------------
  1           Expected HMAC   byte string          The output of the HMAC calculation at the security source.

  : [Table 3](#table-3){.selfRef}: [BIB-HMAC-SHA2 Security
  Results](#name-bib-hmac-sha2-security-resu){.selfRef}
:::
:::
:::

::: {#bib_key_mgmt}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Key Considerations](#name-key-considerations){.section-name .selfRef} {#name-key-considerations}

HMAC keys used with this context [MUST]{.bcp14} be symmetric and
[MUST]{.bcp14} have a key length equal to the output of the HMAC. For
this reason, HMAC key lengths will be integers divisible by 8 bytes, and
special padding-aware AES key wrap algorithms are not
needed.[¶](#section-3.5-1){.pilcrow}

It is assumed that any security verifier or security acceptor performing
an integrity verification can determine the proper HMAC key to be used.
Potential sources of the HMAC key include (but are not limited to) the
following:[¶](#section-3.5-2){.pilcrow}

-   [Pre-placed keys selected based on local
    policy.[¶](#section-3.5-3.1){.pilcrow}]{#section-3.5-3.1}
-   [Keys extracted from material carried in the
    BIB.[¶](#section-3.5-3.2){.pilcrow}]{#section-3.5-3.2}
-   [Session keys negotiated via a mechanism external to the
    BIB.[¶](#section-3.5-3.3){.pilcrow}]{#section-3.5-3.3}

When an AES Key Wrap (AES-KW) \[[RFC3394](#RFC3394){.xref}\] wrapped key
is present in a security block, it is assumed that security verifiers
and security acceptors can independently determine the key encryption
key (KEK) used in the wrapping of the symmetric HMAC
key.[¶](#section-3.5-4){.pilcrow}

As discussed in [Section 6](#SecCons){.xref} and emphasized here, it is
strongly recommended that keys be protected once generated, both when
they are stored and when they are
transmitted.[¶](#section-3.5-5){.pilcrow}
:::
:::

::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [Security Processing Considerations](#name-security-processing-conside){.section-name .selfRef} {#name-security-processing-conside}

An HMAC calculated over the same IPPT with the same key will always have
the same value. This regularity can lead to practical side-channel
attacks whereby an attacker could produce known plaintext, guess at an
HMAC tag, and observe the behavior of a verifier. With a modest number
of trials, a side-channel attack could produce an HMAC tag for
attacker-provided plaintext without the attacker ever knowing the HMAC
key.[¶](#section-3.6-1){.pilcrow}

A common method of observing the behavior of a verifier is precise
analysis of the timing associated with comparisons. Therefore, one way
to prevent behavior analysis of this type is to ensure that any
comparisons of the supplied and expected authentication tag occur in
constant time.[¶](#section-3.6-2){.pilcrow}

A constant-time comparison function [SHOULD]{.bcp14} be used for the
comparison of authentication tags by any implementation of this security
context. In cases where such a function is difficult or impossible to
use, the impact of side-channel attacks (in general) and timing attacks
(specifically) need to be considered as part of the
implementation.[¶](#section-3.6-3){.pilcrow}
:::

::: {#bib_canon}
::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Canonicalization Algorithms](#name-canonicalization-algorithms){.section-name .selfRef} {#name-canonicalization-algorithms}

This section defines the canonicalization algorithm used to prepare the
IPPT input to the BIB-HMAC-SHA2 integrity mechanism. The construction of
the IPPT depends on the settings of the integrity scope flags that can
be provided as part of customizing the behavior of this security
context.[¶](#section-3.7-1){.pilcrow}

In all cases, the canonical form of any portion of an extension block
[MUST]{.bcp14} be created as described in
\[[RFC9172](#RFC9172){.xref}\]. The canonicalization algorithms defined
in \[[RFC9172](#RFC9172){.xref}\] adhere to the canonical forms for
extension blocks defined in \[[RFC9171](#RFC9171){.xref}\] but resolve
ambiguities related to how values are represented in
CBOR.[¶](#section-3.7-2){.pilcrow}

The IPPT is constructed using the following process. While integrity
scope flags might not be included in the BIB representing the security
operation, they [MUST]{.bcp14} be included in the IPPT value
itself.[¶](#section-3.7-3){.pilcrow}

1.  [The canonical form of the IPPT starts as the CBOR encoding of the
    integrity scope flags in which all unset flags, reserved bits, and
    unassigned bits have been set to 0. For example, if the primary
    block flag, target header flag, and security header flag are each
    set, then the initial value of the canonical form of the IPPT will
    be 0x07.[¶](#section-3.7-4.1){.pilcrow}]{#section-3.7-4.1}
2.  [If the primary block flag of the integrity scope flags is set to 1
    and the security target is not the bundle\'s primary block, then a
    canonical form of the bundle\'s primary block [MUST]{.bcp14} be
    calculated and the result appended to the
    IPPT.[¶](#section-3.7-4.2){.pilcrow}]{#section-3.7-4.2}
3.  [If the target header flag of the integrity scope flags is set to 1
    and the security target is not the bundle\'s primary block, then the
    canonical form of the block type code, block number, and block
    processing control flags associated with the security target
    [MUST]{.bcp14} be calculated and, in that order, appended to the
    IPPT.[¶](#section-3.7-4.3){.pilcrow}]{#section-3.7-4.3}
4.  [If the security header flag of the integrity scope flags is set to
    1, then the canonical form of the block type code, block number, and
    block processing control flags associated with the BIB
    [MUST]{.bcp14} be calculated and, in that order, appended to the
    IPPT.[¶](#section-3.7-4.4){.pilcrow}]{#section-3.7-4.4}
5.  [The canonical form of the security target [MUST]{.bcp14} be
    calculated and appended to the IPPT. If the security target is the
    primary block, this is the canonical form of the primary block.
    Otherwise, this is the canonical form of the block-type-specific
    data of the security
    target.[¶](#section-3.7-4.5){.pilcrow}]{#section-3.7-4.5}

NOTE: When the security target is the bundle\'s primary block, the
canonicalization steps associated with the primary block flag and the
target header flag are skipped. Skipping primary block flag processing,
in this case, avoids adding the bundle\'s primary block twice in the
IPPT calculation. Skipping target header flag processing, in this case,
is necessary because the primary block of a bundle does not have the
expected elements of a block header such as block number and block
processing control flags.[¶](#section-3.7-5.1){.pilcrow}
:::
:::

::: {#section-3.8 .section}
### [3.8.](#section-3.8){.section-number .selfRef} [Processing](#name-processing){.section-name .selfRef} {#name-processing}

::: {#section-3.8.1 .section}
#### [3.8.1.](#section-3.8.1){.section-number .selfRef} [Keyed Hash Generation](#name-keyed-hash-generation){.section-name .selfRef} {#name-keyed-hash-generation}

During keyed hash generation, two inputs are prepared for the
appropriate HMAC/SHA2 algorithm: the HMAC key and the IPPT. These data
items [MUST]{.bcp14} be generated as
follows.[¶](#section-3.8.1-1){.pilcrow}

-   [The HMAC key [MUST]{.bcp14} have the appropriate length as required
    by local security policy. The key can be generated specifically for
    this integrity service, given as part of local security policy, or
    obtained through some other key management mechanism as discussed in
    [Section
    3.5](#bib_key_mgmt){.xref}.[¶](#section-3.8.1-2.1){.pilcrow}]{#section-3.8.1-2.1}
-   [Prior to the generation of the IPPT, if a Cyclic Redundancy Check
    (CRC) value is present for the target block of the BIB, then that
    CRC value [MUST]{.bcp14} be removed from the target block. This
    involves both removing the CRC value from the target block and
    setting the CRC type field of the target block to \"no CRC is
    present.\"[¶](#section-3.8.1-2.2){.pilcrow}]{#section-3.8.1-2.2}
-   [Once CRC information is removed, the IPPT [MUST]{.bcp14} be
    generated as discussed in [Section
    3.7](#bib_canon){.xref}.[¶](#section-3.8.1-2.3){.pilcrow}]{#section-3.8.1-2.3}

Upon successful hash generation, the following action [MUST]{.bcp14}
occur.[¶](#section-3.8.1-3){.pilcrow}

-   [The keyed hash produced by the HMAC/SHA2 variant [MUST]{.bcp14} be
    added as a security result for the BIB representing the security
    operation on this security target, as discussed in [Section
    3.4](#bib_results){.xref}.[¶](#section-3.8.1-4.1){.pilcrow}]{#section-3.8.1-4.1}

Finally, the BIB containing information about this security operation
[MUST]{.bcp14} be updated as follows. These operations can occur in any
order.[¶](#section-3.8.1-5){.pilcrow}

-   [The security context identifier for the BIB [MUST]{.bcp14} be set
    to the context identifier for
    BIB-HMAC-SHA2.[¶](#section-3.8.1-6.1){.pilcrow}]{#section-3.8.1-6.1}
-   [Any local flags used to generate the IPPT [MUST]{.bcp14} be placed
    in the integrity scope flags security context parameter for the BIB
    unless these flags are expected to be correctly configured at
    security verifiers and acceptors in the
    network.[¶](#section-3.8.1-6.2){.pilcrow}]{#section-3.8.1-6.2}
-   [The HMAC key [MAY]{.bcp14} be included as a security context
    parameter, in which case it [MUST]{.bcp14} be wrapped using the AES
    key wrap function as defined in \[[RFC3394](#RFC3394){.xref}\] and
    the results of the wrapping added as the wrapped key security
    context parameter for the
    BIB.[¶](#section-3.8.1-6.3){.pilcrow}]{#section-3.8.1-6.3}
-   [The SHA variant used by this security context [SHOULD]{.bcp14} be
    added as the SHA variant security context parameter for the BIB if
    it differs from the default key length. Otherwise, this parameter
    [MAY]{.bcp14} be omitted if doing so provides a useful reduction in
    message sizes.[¶](#section-3.8.1-6.4){.pilcrow}]{#section-3.8.1-6.4}

Problems encountered in the keyed hash generation [MUST]{.bcp14} be
processed in accordance with local BPSec security
policy.[¶](#section-3.8.1-7){.pilcrow}
:::

::: {#section-3.8.2 .section}
#### [3.8.2.](#section-3.8.2){.section-number .selfRef} [Keyed Hash Verification](#name-keyed-hash-verification){.section-name .selfRef} {#name-keyed-hash-verification}

During keyed hash verification, the input of the security target and an
HMAC key are provided to the appropriate HMAC/SHA2
algorithm.[¶](#section-3.8.2-1){.pilcrow}

During keyed hash verification, two inputs are prepared for the
appropriate HMAC/SHA2 algorithm: the HMAC key and the IPPT. These data
items [MUST]{.bcp14} be generated as
follows.[¶](#section-3.8.2-2){.pilcrow}

-   [The HMAC key [MUST]{.bcp14} be derived using the wrapped key
    security context parameter if such a parameter is included in the
    security context parameters of the BIB. Otherwise, this key
    [MUST]{.bcp14} be derived in accordance with security policy at the
    verifying node as discussed in [Section
    3.5](#bib_key_mgmt){.xref}.[¶](#section-3.8.2-3.1){.pilcrow}]{#section-3.8.2-3.1}
-   [The IPPT [MUST]{.bcp14} be generated as discussed in [Section
    3.7](#bib_canon){.xref} with the value of integrity scope flags
    being taken from the integrity scope flags security context
    parameter. If the integrity scope flags parameter is not included in
    the security context parameters, then these flags [MAY]{.bcp14} be
    derived from local security
    policy.[¶](#section-3.8.2-3.2){.pilcrow}]{#section-3.8.2-3.2}

The calculated HMAC output [MUST]{.bcp14} be compared to the expected
HMAC output encoded in the security results of the BIB for the security
target. If the calculated HMAC and expected HMAC are identical, the
verification [MUST]{.bcp14} be considered a success. Otherwise, the
verification [MUST]{.bcp14} be considered a
failure.[¶](#section-3.8.2-4){.pilcrow}

If the verification fails or otherwise experiences an error or if any
needed parameters are missing, then the verification [MUST]{.bcp14} be
treated as failed and processed in accordance with local security
policy.[¶](#section-3.8.2-5){.pilcrow}

This security service is removed from the bundle at the security
acceptor as required by the BPSec specification
\[[RFC9172](#RFC9172){.xref}\]. If the security acceptor is not the
bundle destination and if no other integrity service is being applied to
the target block, then a CRC [MUST]{.bcp14} be included for the target
block. The CRC type, as determined by policy, is set in the target
block\'s CRC type field, and the corresponding CRC value is added as the
CRC field for that block.[¶](#section-3.8.2-6){.pilcrow}
:::
:::
:::
:::

::: {#second-context}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Security Context BCB-AES-GCM](#name-security-context-bcb-aes-gc){.section-name .selfRef} {#name-security-context-bcb-aes-gc}

::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Overview](#name-overview-2){.section-name .selfRef} {#name-overview-2}

The BCB-AES-GCM security context replaces the block-type-specific data
field of its security target with ciphertext generated using the
Advanced Encryption Standard (AES) cipher operating in Galois/Counter
Mode (GCM) \[[AES-GCM](#AES-GCM){.xref}\]. The use of AES-GCM was
selected as the cipher suite for this confidentiality mechanism for
several reasons:[¶](#section-4.1-1){.pilcrow}

1.  [The selection of a symmetric-key cipher suite allows for relatively
    smaller keys than asymmetric-key cipher
    suites.[¶](#section-4.1-2.1){.pilcrow}]{#section-4.1-2.1}
2.  [The selection of a symmetric-key cipher suite allows this security
    context to be used in places where an asymmetric-key infrastructure
    (such as a public key infrastructure) might be
    impractical.[¶](#section-4.1-2.2){.pilcrow}]{#section-4.1-2.2}
3.  [The use of the Galois/Counter Mode produces ciphertext with the
    same size as the plaintext making the replacement of target block
    information easier as length fields do not need to be
    changed.[¶](#section-4.1-2.3){.pilcrow}]{#section-4.1-2.3}
4.  [The AES-GCM cipher suite provides authenticated encryption, as
    required by the BPSec
    protocol.[¶](#section-4.1-2.4){.pilcrow}]{#section-4.1-2.4}

Additionally, the BCB-AES-GCM security context generates an
authentication tag based on the plaintext value of the
block-type-specific data and other additional authenticated data (AAD)
that might be specified via parameters to this security
context.[¶](#section-4.1-3){.pilcrow}

This security context supports two variants of AES-GCM, based on the
supported length of the symmetric key. These variants correspond to
A128GCM and A256GCM as defined in Table 9 (\"Algorithm Value for
AES-GCM\") of
\[[RFC8152](#RFC8152){.xref}\].[¶](#section-4.1-4){.pilcrow}

The BCB-AES-GCM security context [MUST]{.bcp14} have the security
context identifier specified in [Section
5.1](#sc_ids){.xref}.[¶](#section-4.1-5){.pilcrow}
:::

::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Scope](#name-scope-2){.section-name .selfRef} {#name-scope-2}

There are two scopes associated with BCB-AES-GCM: the scope of the
confidentiality service and the scope of the authentication service. The
first defines the set of information provided to the AES-GCM cipher for
the purpose of producing ciphertext. The second defines the set of
information used to generate an authentication
tag.[¶](#section-4.2-1){.pilcrow}

The scope of the confidentiality service defines the set of information
provided to the AES-GCM cipher for the purpose of producing ciphertext.
This [MUST]{.bcp14} be the full set of plaintext contained in the
block-type-specific data field of the security
target.[¶](#section-4.2-2){.pilcrow}

The scope of the authentication service defines the set of information
used to generate an authentication tag carried with the security block.
This information contains all data protected by the confidentiality
service and the scope flags used to identify other optional information;
it [MAY]{.bcp14} include other information (additional authenticated
data), as follows.[¶](#section-4.2-3){.pilcrow}

[]{.break}

Primary block

:   The primary block identifies a bundle, and once created, the
    contents of this block are immutable. Changes to the primary block
    associated with the security target indicate that the security
    target (and BCB) might no longer be in the correct
    bundle.[¶](#section-4.2-4.2.1){.pilcrow}

    For example, if a security target and associated BCB are copied from
    one bundle to another bundle, the BCB might still be able to decrypt
    the security target even though these blocks were never intended to
    exist in the copied-to bundle.[¶](#section-4.2-4.2.2){.pilcrow}

    Including this information as part of additional authenticated data
    ensures that the security target (and security block) appear in the
    same bundle at the time of decryption as at the time of
    encryption.[¶](#section-4.2-4.2.3){.pilcrow}

:   

Other fields of the security target

:   The other fields of the security target include block identification
    and processing information. Changing this information changes how
    the security target is treated by nodes in the network even when the
    \"user data\" of the security target are otherwise
    unchanged.[¶](#section-4.2-4.4.1){.pilcrow}

    For example, if the block processing control flags of a security
    target are different at a security verifier than they were
    originally set at the security source, then the policy for handling
    the security target has been
    modified.[¶](#section-4.2-4.4.2){.pilcrow}

    Including this information as part of additional authenticated data
    ensures that the ciphertext in the security target will not be used
    with a different set of block policy than originally set at the time
    of encryption.[¶](#section-4.2-4.4.3){.pilcrow}

:   

Other fields of the BCB

:   The other fields of the BCB include block identification and
    processing information. Changing this information changes how the
    BCB is treated by nodes in the network, even when other aspects of
    the BCB are unchanged.[¶](#section-4.2-4.6.1){.pilcrow}

    For example, if the block processing control flags of the BCB are
    different at a security acceptor than they were originally set at
    the security source, then the policy for handling the BCB has been
    modified.[¶](#section-4.2-4.6.2){.pilcrow}

    Including this information as part of additional authenticated data
    ensures that the policy and identification of the security service
    in the bundle has not changed.[¶](#section-4.2-4.6.3){.pilcrow}

    NOTE: The security context identifier and security context
    parameters of the security block are not included as additional
    authenticated data because these parameters, by definition, are
    those needed to verify or accept the security service. Therefore, it
    is expected that changes to these values would result in failures at
    security verifiers and security acceptors. This is the case because
    keys cannot be reused across security contexts and because the AAD
    scope flags used to identify the AAD are included in the
    AAD.[¶](#section-4.2-4.6.4.1){.pilcrow}

:   

The scope of the BCB-AES-GCM security context is configured using an
optional security context parameter.[¶](#section-4.2-5){.pilcrow}
:::

::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Parameters](#name-parameters-2){.section-name .selfRef} {#name-parameters-2}

BCB-AES-GCM can be parameterized to specify the AES variant,
initialization vector, key information, and identify additional
authenticated data.[¶](#section-4.3-1){.pilcrow}

::: {#section-4.3.1 .section}
#### [4.3.1.](#section-4.3.1){.section-number .selfRef} [Initialization Vector (IV)](#name-initialization-vector-iv){.section-name .selfRef} {#name-initialization-vector-iv}

This optional parameter identifies the initialization vector (IV) used
to initialize the AES-GCM cipher.[¶](#section-4.3.1-1){.pilcrow}

The length of the initialization vector, prior to any CBOR encoding,
[MUST]{.bcp14} be between 8-16 bytes. A value of 12 bytes
[SHOULD]{.bcp14} be used unless local security policy requires a
different length.[¶](#section-4.3.1-2){.pilcrow}

This value [MUST]{.bcp14} be encoded as a CBOR byte
string.[¶](#section-4.3.1-3){.pilcrow}

The initialization vector can have any value, with the caveat that a
value [MUST NOT]{.bcp14} be reused for multiple encryptions using the
same encryption key. This value [MAY]{.bcp14} be reused when encrypting
with different keys. For example, if each encryption operation using
BCB-AES-GCM uses a newly generated key, then the same IV can be
reused.[¶](#section-4.3.1-4){.pilcrow}
:::

::: {#section-4.3.2 .section}
#### [4.3.2.](#section-4.3.2){.section-number .selfRef} [AES Variant](#name-aes-variant){.section-name .selfRef} {#name-aes-variant}

This optional parameter identifies the AES variant being used for the
AES-GCM encryption, where the variant is identified by the length of key
used.[¶](#section-4.3.2-1){.pilcrow}

This value [MUST]{.bcp14} be encoded as a CBOR unsigned
integer.[¶](#section-4.3.2-2){.pilcrow}

Valid values for this parameter are as
follows.[¶](#section-4.3.2-3){.pilcrow}

[]{#name-aes-variant-parameter-value}

  Value   Description
  ------- ---------------------------------------------------------------------------------------------------
  1       A128GCM as defined in Table 9 (\"Algorithm Value for AES-GCM\") of \[[RFC8152](#RFC8152){.xref}\]
  3       A256GCM as defined in Table 9 (\"Algorithm Value for AES-GCM\") of \[[RFC8152](#RFC8152){.xref}\]

  : [Table 4](#table-4){.selfRef}: [AES Variant Parameter
  Values](#name-aes-variant-parameter-value){.selfRef}

When not provided, implementations [SHOULD]{.bcp14} assume a value of 3
(indicating use of A256GCM), unless an alternate default is established
by local security policy at the security source, verifier, or acceptor
of this integrity service.[¶](#section-4.3.2-5){.pilcrow}

Regardless of the variant, the generated authentication tag
[MUST]{.bcp14} always be 128 bits.[¶](#section-4.3.2-6){.pilcrow}
:::

::: {#section-4.3.3 .section}
#### [4.3.3.](#section-4.3.3){.section-number .selfRef} [Wrapped Key](#name-wrapped-key-2){.section-name .selfRef} {#name-wrapped-key-2}

This optional parameter contains the output of the AES key wrap function
as defined in \[[RFC3394](#RFC3394){.xref}\]. Specifically, this
parameter holds the ciphertext produced when running this key wrap
algorithm with the input string being the symmetric AES key used to
generate the security results present in the security block. The value
of this parameter is used as input to the AES key wrap authenticated
decryption function at security verifiers and security acceptors to
determine the symmetric AES key needed for the proper decryption of the
security results in the security block.[¶](#section-4.3.3-1){.pilcrow}

This value [MUST]{.bcp14} be encoded as a CBOR byte
string.[¶](#section-4.3.3-2){.pilcrow}

If this parameter is not present, then security verifiers and acceptors
[MUST]{.bcp14} determine the proper key as a function of their local
BPSec policy and configuration.[¶](#section-4.3.3-3){.pilcrow}
:::

::: {#section-4.3.4 .section}
#### [4.3.4.](#section-4.3.4){.section-number .selfRef} [AAD Scope Flags](#name-aad-scope-flags){.section-name .selfRef} {#name-aad-scope-flags}

This optional parameter contains a series of flags that describe what
information is to be included with the block-type-specific data of the
security target as part of additional authenticated data
(AAD).[¶](#section-4.3.4-1){.pilcrow}

This value [MUST]{.bcp14} be represented as a CBOR unsigned integer, the
value of which [MUST]{.bcp14} be processed as a 16-bit field. The
maximum value of this field, as a CBOR unsigned integer, [MUST]{.bcp14}
be 65535.[¶](#section-4.3.4-2){.pilcrow}

When not provided, implementations [SHOULD]{.bcp14} assume a value of 7
(indicating all assigned fields), unless an alternate default is
established by local security policy at the security source, verifier,
or acceptor of this integrity service.[¶](#section-4.3.4-3){.pilcrow}

Implementations [MUST]{.bcp14} set reserved and unassigned bits in this
field to 0 when constructing these flags at a security source. Once set,
the value of this field [MUST NOT]{.bcp14} be altered until the security
service is completed at the security acceptor in the network and removed
from the bundle.[¶](#section-4.3.4-4){.pilcrow}

Bits in this field represent additional information to be included when
generating an integrity signature over the security target. These bits
are defined as follows.[¶](#section-4.3.4-5){.pilcrow}

[]{.break}

Bit 0 (the low-order bit, 0x0001):
:   Include primary block flag[¶](#section-4.3.4-6.2){.pilcrow}
:   

Bit 1 (0x0002):
:   Include target header flag[¶](#section-4.3.4-6.4){.pilcrow}
:   

Bit 2 (0x0004):
:   Include security header flag[¶](#section-4.3.4-6.6){.pilcrow}
:   

Bits 3-7:
:   Reserved[¶](#section-4.3.4-6.8){.pilcrow}
:   

Bits 8-15:
:   Unassigned[¶](#section-4.3.4-6.10){.pilcrow}
:   
:::

::: {#section-4.3.5 .section}
#### [4.3.5.](#section-4.3.5){.section-number .selfRef} [Enumerations](#name-enumerations-2){.section-name .selfRef} {#name-enumerations-2}

The BCB-AES-GCM security context parameters are listed in [Table
5](#bcb_parm_table){.xref}. In this table, the \"Parm Id\" column refers
to the expected parameter identifier described in Section
[3.10](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref}
([\"Parameter and Result
Identification\"](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref})
of \[[RFC9172](#RFC9172){.xref}\].[¶](#section-4.3.5-1){.pilcrow}

An empty \"Default Value\" column indicates that the security context
parameter does not have a default value.[¶](#section-4.3.5-2){.pilcrow}

[]{#name-bcb-aes-gcm-security-contex}

::: {#bcb_parm_table}
  Parm Id   Parm Name               CBOR Encoding Type   Default Value
  --------- ----------------------- -------------------- ---------------
  1         Initialization Vector   byte string          
  2         AES Variant             unsigned integer     3
  3         Wrapped Key             byte string          
  4         AAD Scope Flags         unsigned integer     7

  : [Table 5](#table-5){.selfRef}: [BCB-AES-GCM Security Context
  Parameters](#name-bcb-aes-gcm-security-contex){.selfRef}
:::
:::
:::

::: {#bcb_results}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Results](#name-results-2){.section-name .selfRef} {#name-results-2}

The BCB-AES-GCM security context produces a single security result
carried in the security block: the authentication
tag.[¶](#section-4.4-1){.pilcrow}

NOTES:[¶](#section-4.4-2){.pilcrow}

-   [The ciphertext generated by the cipher suite is not considered a
    security result as it is stored in the block-type-specific data
    field of the security target block. When operating in GCM mode, AES
    produces ciphertext of the same size as its plaintext; therefore, no
    additional logic is required to handle padding or overflow caused by
    the encryption in most
    cases.[¶](#section-4.4-3.1){.pilcrow}]{#section-4.4-3.1}
-   [If the authentication tag can be separated from the ciphertext,
    then the tag [MAY]{.bcp14} be separated and stored in the
    authentication tag security result field. Otherwise, the security
    target block [MUST]{.bcp14} be resized to accommodate the additional
    128 bits of authentication tag included with the generated
    ciphertext replacing the block-type-specific data field of the
    security target
    block.[¶](#section-4.4-3.2){.pilcrow}]{#section-4.4-3.2}

::: {#section-4.4.1 .section}
#### [4.4.1.](#section-4.4.1){.section-number .selfRef} [Authentication Tag](#name-authentication-tag){.section-name .selfRef} {#name-authentication-tag}

The authentication tag is generated by the cipher suite over the
security target plaintext input to the cipher suite as combined with any
optional additional authenticated data. This tag is used to ensure that
the plaintext (and important information associated with the plaintext)
is authenticated prior to decryption.[¶](#section-4.4.1-1){.pilcrow}

If the authentication tag is included in the ciphertext placed in the
security target block-type-specific data field, then this security
result [MUST NOT]{.bcp14} be included in the BCB for that security
target.[¶](#section-4.4.1-2){.pilcrow}

The length of the authentication tag, prior to any CBOR encoding,
[MUST]{.bcp14} be 128 bits.[¶](#section-4.4.1-3){.pilcrow}

This value [MUST]{.bcp14} be encoded as a CBOR byte
string.[¶](#section-4.4.1-4){.pilcrow}
:::

::: {#section-4.4.2 .section}
#### [4.4.2.](#section-4.4.2){.section-number .selfRef} [Enumerations](#name-enumerations-3){.section-name .selfRef} {#name-enumerations-3}

The BCB-AES-GCM security context results are listed in [Table
6](#bcb_res_table){.xref}. In this table, the \"Result Id\" column
refers to the expected result identifier described in Section
[3.10](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref}
([\"Parameter and Result
Identification\"](https://www.rfc-editor.org/rfc/rfc9172#section-3.10){.relref})
of \[[RFC9172](#RFC9172){.xref}\].[¶](#section-4.4.2-1){.pilcrow}

[]{#name-bcb-aes-gcm-security-result}

::: {#bcb_res_table}
  Result Id   Result Name          CBOR Encoding Type
  ----------- -------------------- --------------------
  1           Authentication Tag   byte string

  : [Table 6](#table-6){.selfRef}: [BCB-AES-GCM Security
  Results](#name-bcb-aes-gcm-security-result){.selfRef}
:::
:::
:::
:::

::: {#bcb_key_mgmt}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [Key Considerations](#name-key-considerations-2){.section-name .selfRef} {#name-key-considerations-2}

Keys used with this context [MUST]{.bcp14} be symmetric and
[MUST]{.bcp14} have a key length equal to the key length defined in the
security context parameters or as defined by local security policy at
security verifiers and acceptors. For this reason, content-encrypting
key lengths will be integers divisible by 8 bytes, and special
padding-aware AES key wrap algorithms are not
needed.[¶](#section-4.5-1){.pilcrow}

It is assumed that any security verifier or security acceptor can
determine the proper key to be used. Potential sources of the key
include (but are not limited to) the
following.[¶](#section-4.5-2){.pilcrow}

-   [Pre-placed keys selected based on local
    policy.[¶](#section-4.5-3.1){.pilcrow}]{#section-4.5-3.1}
-   [Keys extracted from material carried in the
    BCB.[¶](#section-4.5-3.2){.pilcrow}]{#section-4.5-3.2}
-   [Session keys negotiated via a mechanism external to the
    BCB.[¶](#section-4.5-3.3){.pilcrow}]{#section-4.5-3.3}

When an AES-KW wrapped key is present in a security block, it is assumed
that security verifiers and security acceptors can independently
determine the KEK used in the wrapping of the symmetric AES
content-encrypting key.[¶](#section-4.5-4){.pilcrow}

The security provided by block ciphers is reduced as more data is
processed with the same key. The total number of AES blocks processed
with a single key for AES-GCM is recommended to be less than 2^64^, as
described in Appendix B of
\[[AES-GCM](#AES-GCM){.xref}\].[¶](#section-4.5-5){.pilcrow}

Additionally, there exist limits on the number of encryptions that can
be performed with the same key. The total number of invocations of the
authenticated encryption function with a single key for AES-GCM is
required to not exceed 2^32^, as described in Section 8.3 of
\[[AES-GCM](#AES-GCM){.xref}\].[¶](#section-4.5-6){.pilcrow}

As discussed in [Section 6](#SecCons){.xref} and emphasized here, it is
strongly recommended that keys be protected once generated, both when
they are stored and when they are
transmitted.[¶](#section-4.5-7){.pilcrow}
:::
:::

::: {#GcmCons}
::: {#section-4.6 .section}
### [4.6.](#section-4.6){.section-number .selfRef} [GCM Considerations](#name-gcm-considerations){.section-name .selfRef} {#name-gcm-considerations}

The GCM cryptographic mode of AES has specific requirements that
[MUST]{.bcp14} be followed by implementers for the secure function of
the BCB-AES-GCM security context. While these requirements are well
documented in \[[AES-GCM](#AES-GCM){.xref}\], some of them are repeated
here for emphasis.[¶](#section-4.6-1){.pilcrow}

-   ::: {#section-4.6-2.1}
    With the exception of the AES-KW function, the IVs used by the
    BCB-AES-GCM security context are considered to be per-invocation
    IVs. The pairing of a per-invocation IV and a security key
    [MUST]{.bcp14} be unique. A per-invocation IV [MUST NOT]{.bcp14} be
    used with a security key more than one time. If a per-invocation IV
    and key pair are repeated, then the GCM implementation is vulnerable
    to forgery attacks. Because the loss of integrity protection occurs
    with even a single reuse, this situation is often considered to have
    catastrophic security consequences. More information regarding the
    importance of the uniqueness of the IV value can be found in
    Appendix A of
    \[[AES-GCM](#AES-GCM){.xref}\].[¶](#section-4.6-2.1.1){.pilcrow}

    Methods of generating unique IV values are provided in Section 8 of
    \[[AES-GCM](#AES-GCM){.xref}\]. For example, one method decomposes
    the IV value into a fixed field and an invocation field. The fixed
    field is a constant value associated with a device, and the
    invocation field changes on each invocation (such as by incrementing
    an integer counter). Implementers [SHOULD]{.bcp14} carefully read
    all relevant sections of \[[AES-GCM](#AES-GCM){.xref}\] when
    generating any mechanism to create unique
    IVs.[¶](#section-4.6-2.1.2){.pilcrow}
    :::

-   [The AES-KW function used to wrap keys for the security contexts in
    this document uses a single, globally constant IV input to the AES
    cipher operation and thus is distinct from the aforementioned
    requirement related to per-invocation
    IVs.[¶](#section-4.6-2.2){.pilcrow}]{#section-4.6-2.2}

-   [While any tag-based authentication mechanism has some likelihood of
    being forged, this probability is increased when using AES-GCM. In
    particular, short tag lengths combined with very long messages
    [SHOULD]{.bcp14} be avoided when using this mode. The BCB-AES-GCM
    security context requires the use of 128-bit authentication tags at
    all times. Concerns relating to the size of authentication tags is
    discussed in Appendices B and C of
    \[[AES-GCM](#AES-GCM){.xref}\].[¶](#section-4.6-2.3){.pilcrow}]{#section-4.6-2.3}

-   [As discussed in Appendix B of \[[AES-GCM](#AES-GCM){.xref}\],
    implementations [SHOULD]{.bcp14} limit the number of unsuccessful
    verification attempts for each key to reduce the likelihood of
    guessing tag values. This type of check has potential state-keeping
    issues when AES-KW is used, since an attacker could cause a large
    number of keys to be used at least
    once.[¶](#section-4.6-2.4){.pilcrow}]{#section-4.6-2.4}

-   [As discussed in Section
    [8](https://www.rfc-editor.org/rfc/rfc9172#section-8){.relref}
    ([\"Security
    Considerations\"](https://www.rfc-editor.org/rfc/rfc9172#section-8){.relref})
    of \[[RFC9172](#RFC9172){.xref}\], delay-tolerant networks have a
    higher occurrence of replay attacks due to the store-and-forward
    nature of the network. Because GCM has no inherent replay attack
    protection, implementors [SHOULD]{.bcp14} attempt to detect replay
    attacks by using mechanisms such as those described in Appendix D of
    \[[AES-GCM](#AES-GCM){.xref}\].[¶](#section-4.6-2.5){.pilcrow}]{#section-4.6-2.5}
:::
:::

::: {#section-4.7 .section}
### [4.7.](#section-4.7){.section-number .selfRef} [Canonicalization Algorithms](#name-canonicalization-algorithms-2){.section-name .selfRef} {#name-canonicalization-algorithms-2}

This section defines the canonicalization algorithms used to prepare the
inputs used to generate both the ciphertext and the authentication
tag.[¶](#section-4.7-1){.pilcrow}

In all cases, the canonical form of any portion of an extension block
[MUST]{.bcp14} be created as described in
\[[RFC9172](#RFC9172){.xref}\]. The canonicalization algorithms defined
in \[[RFC9172](#RFC9172){.xref}\] adhere to the canonical forms for
extension blocks defined in \[[RFC9171](#RFC9171){.xref}\] but resolve
ambiguities related to how values are represented in
CBOR.[¶](#section-4.7-2){.pilcrow}

::: {#bcb_canon_cipher}
::: {#section-4.7.1 .section}
#### [4.7.1.](#section-4.7.1){.section-number .selfRef} [Calculations Related to Ciphertext](#name-calculations-related-to-cip){.section-name .selfRef} {#name-calculations-related-to-cip}

The BCB operates over the block-type-specific data of a block, but the
BP always encodes these data within a single, definite-length CBOR byte
string. Therefore, the plaintext used during encryption [MUST]{.bcp14}
be calculated as the value of the block-type-specific data field of the
security target excluding the BP CBOR
encoding.[¶](#section-4.7.1-1){.pilcrow}

[Table 7](#enc_ex){.xref} shows two CBOR-encoded examples and the
plaintext that would be extracted from them. The first example is an
unsigned integer, while the second is a byte
string.[¶](#section-4.7.1-2){.pilcrow}

[]{#name-cbor-plaintext-extraction-e}

::: {#enc_ex}
  CBOR Encoding (Hex)            CBOR Part (Hex)   Plaintext Part (Hex)
  ------------------------------ ----------------- --------------------------
  18ED                           18                ED
  C24CDEADBEEFDEADBEEFDEADBEEF   C24C              DEADBEEFDEADBEEFDEADBEEF

  : [Table 7](#table-7){.selfRef}: [CBOR Plaintext Extraction
  Examples](#name-cbor-plaintext-extraction-e){.selfRef}
:::

The ciphertext used during decryption [MUST]{.bcp14} be calculated as
the single, definite-length CBOR byte string representing the
block-type-specific data field excluding the CBOR byte string
identifying byte and optional CBOR byte string length
field.[¶](#section-4.7.1-4){.pilcrow}

All other fields of the security target (such as the block type code,
block number, block processing control flags, or any CRC information)
[MUST NOT]{.bcp14} be considered as part of encryption or
decryption.[¶](#section-4.7.1-5){.pilcrow}
:::
:::

::: {#bcb_canon_aad}
::: {#section-4.7.2 .section}
#### [4.7.2.](#section-4.7.2){.section-number .selfRef} [Additional Authenticated Data](#name-additional-authenticated-da){.section-name .selfRef} {#name-additional-authenticated-da}

The construction of additional authenticated data depends on the AAD
scope flags that can be provided as part of customizing the behavior of
this security context.[¶](#section-4.7.2-1){.pilcrow}

The canonical form of the AAD input to the BCB-AES-GCM mechanism is
constructed using the following process. While the AAD scope flags might
not be included in the BCB representing the security operation, they
[MUST]{.bcp14} be included in the AAD value itself. This process
[MUST]{.bcp14} be followed when generating AAD for either encryption or
decryption.[¶](#section-4.7.2-2){.pilcrow}

1.  [The canonical form of the AAD starts as the CBOR encoding of the
    AAD scope flags in which all unset flags, reserved bits, and
    unassigned bits have been set to 0. For example, if the primary
    block flag, target header flag, and security header flag are each
    set, then the initial value of the canonical form of the AAD will be
    0x07.[¶](#section-4.7.2-3.1){.pilcrow}]{#section-4.7.2-3.1}
2.  [If the primary block flag of the AAD scope flags is set to 1, then
    a canonical form of the bundle\'s primary block [MUST]{.bcp14} be
    calculated and the result appended to the
    AAD.[¶](#section-4.7.2-3.2){.pilcrow}]{#section-4.7.2-3.2}
3.  [If the target header flag of the AAD scope flags is set to 1, then
    the canonical form of the block type code, block number, and block
    processing control flags associated with the security target
    [MUST]{.bcp14} be calculated and, in that order, appended to the
    AAD.[¶](#section-4.7.2-3.3){.pilcrow}]{#section-4.7.2-3.3}
4.  [If the security header flag of the AAD scope flags is set to 1,
    then the canonical form of the block type code, block number, and
    block processing control flags associated with the BIB
    [MUST]{.bcp14} be calculated and, in that order, appended to the
    AAD.[¶](#section-4.7.2-3.4){.pilcrow}]{#section-4.7.2-3.4}
:::
:::
:::

::: {#section-4.8 .section}
### [4.8.](#section-4.8){.section-number .selfRef} [Processing](#name-processing-2){.section-name .selfRef} {#name-processing-2}

::: {#section-4.8.1 .section}
#### [4.8.1.](#section-4.8.1){.section-number .selfRef} [Encryption](#name-encryption){.section-name .selfRef} {#name-encryption}

During encryption, four data elements are prepared for input to the
AES-GCM cipher: the encryption key, the IV, the security target
plaintext to be encrypted, and any additional authenticated data. These
data items [MUST]{.bcp14} be generated as
follows.[¶](#section-4.8.1-1){.pilcrow}

Prior to encryption, if a CRC value is present for the target block,
then that CRC value [MUST]{.bcp14} be removed. This requires removing
the CRC field from the target block and setting the CRC type field of
the target block to \"no CRC is
present.\"[¶](#section-4.8.1-2){.pilcrow}

-   [The encryption key [MUST]{.bcp14} have the appropriate length as
    required by local security policy. The key might be generated
    specifically for this encryption, given as part of local security
    policy, or obtained through some other key management mechanism as
    discussed in [Section
    4.5](#bcb_key_mgmt){.xref}.[¶](#section-4.8.1-3.1){.pilcrow}]{#section-4.8.1-3.1}
-   [The IV selected [MUST]{.bcp14} be of the appropriate length.
    Because replaying an IV in counter mode voids the confidentiality of
    all messages encrypted with said IV, this context also requires a
    unique IV for every encryption performed with the same key. This
    means the same key and IV combination [MUST NOT]{.bcp14} be used
    more than
    once.[¶](#section-4.8.1-3.2){.pilcrow}]{#section-4.8.1-3.2}
-   [The security target plaintext for encryption [MUST]{.bcp14} be
    generated as discussed in [Section
    4.7.1](#bcb_canon_cipher){.xref}.[¶](#section-4.8.1-3.3){.pilcrow}]{#section-4.8.1-3.3}
-   [Additional authenticated data [MUST]{.bcp14} be generated as
    discussed in [Section 4.7.2](#bcb_canon_aad){.xref}, with the value
    of AAD scope flags being taken from local security
    policy.[¶](#section-4.8.1-3.4){.pilcrow}]{#section-4.8.1-3.4}

Upon successful encryption, the following actions [MUST]{.bcp14}
occur.[¶](#section-4.8.1-4){.pilcrow}

-   [The ciphertext produced by AES-GCM [MUST]{.bcp14} replace the bytes
    used to define the plaintext in the security target block\'s
    block-type-specific data field. The block length of the security
    target [MUST]{.bcp14} be updated if the generated ciphertext is
    larger than the plaintext (which can occur when the authentication
    tag is included in the ciphertext calculation, as discussed in
    [Section
    4.4](#bcb_results){.xref}).[¶](#section-4.8.1-5.1){.pilcrow}]{#section-4.8.1-5.1}
-   [The authentication tag calculated by the AES-GCM cipher
    [MAY]{.bcp14} be added as a security result for the security target
    in the BCB holding results for this security operation, in which
    case it [MUST]{.bcp14} be processed as described in [Section
    4.4](#bcb_results){.xref}.[¶](#section-4.8.1-5.2){.pilcrow}]{#section-4.8.1-5.2}
-   [The authentication tag [MUST]{.bcp14} be included either as a
    security result in the BCB representing the security operation or
    (with the ciphertext) in the security target block-type-specific
    data field.[¶](#section-4.8.1-5.3){.pilcrow}]{#section-4.8.1-5.3}

Finally, the BCB containing information about this security operation
[MUST]{.bcp14} be updated as follows. These operations can occur in any
order.[¶](#section-4.8.1-6){.pilcrow}

-   [The security context identifier for the BCB [MUST]{.bcp14} be set
    to the context identifier for
    BCB-AES-GCM.[¶](#section-4.8.1-7.1){.pilcrow}]{#section-4.8.1-7.1}
-   [The IV input to the cipher [MUST]{.bcp14} be added as the IV
    security context parameter for the
    BCB.[¶](#section-4.8.1-7.2){.pilcrow}]{#section-4.8.1-7.2}
-   [Any local flags used to generate AAD for this cipher [MUST]{.bcp14}
    be placed in the AAD scope flags security context parameter for the
    BCB unless these flags are expected to be correctly configured at
    security verifiers and security acceptors in the
    network.[¶](#section-4.8.1-7.3){.pilcrow}]{#section-4.8.1-7.3}
-   [The encryption key [MAY]{.bcp14} be included as a security context
    parameter, in which case it [MUST]{.bcp14} be wrapped using the AES
    key wrap function as defined in \[[RFC3394](#RFC3394){.xref}\] and
    the results of the wrapping added as the wrapped key security
    context parameter for the
    BCB.[¶](#section-4.8.1-7.4){.pilcrow}]{#section-4.8.1-7.4}
-   [The AES variant used by this security context [SHOULD]{.bcp14} be
    added as the AES variant security context parameter for the BCB if
    it differs from the default key length. Otherwise, this parameter
    [MAY]{.bcp14} be omitted if doing so provides a useful reduction in
    message sizes.[¶](#section-4.8.1-7.5){.pilcrow}]{#section-4.8.1-7.5}

Problems encountered in the encryption [MUST]{.bcp14} be processed in
accordance with local security policy. This [MAY]{.bcp14} include
restoring a CRC value removed from the target block prior to encryption,
if the target block is allowed to be transmitted after an encryption
error.[¶](#section-4.8.1-8){.pilcrow}
:::

::: {#section-4.8.2 .section}
#### [4.8.2.](#section-4.8.2){.section-number .selfRef} [Decryption](#name-decryption){.section-name .selfRef} {#name-decryption}

During decryption, five data elements are prepared for input to the
AES-GCM cipher: the decryption key, the IV, the security target
ciphertext to be decrypted, any additional authenticated data, and the
authentication tag generated from the original encryption. These data
items [MUST]{.bcp14} be generated as
follows.[¶](#section-4.8.2-1){.pilcrow}

-   [The decryption key [MUST]{.bcp14} be derived using the wrapped key
    security context parameter if such a parameter is included in the
    security context parameters of the BCB. Otherwise, this key
    [MUST]{.bcp14} be derived in accordance with local security policy
    at the decrypting node as discussed in [Section
    4.5](#bcb_key_mgmt){.xref}.[¶](#section-4.8.2-2.1){.pilcrow}]{#section-4.8.2-2.1}
-   [The IV [MUST]{.bcp14} be set to the value of the IV security
    context parameter included in the BCB. If the IV parameter is not
    included as a security context parameter, an IV [MAY]{.bcp14} be
    derived as a function of local security policy and other BCB
    contents, or a lack of an IV security context parameter in the BCB
    [MAY]{.bcp14} be treated as an error by the decrypting
    node.[¶](#section-4.8.2-2.2){.pilcrow}]{#section-4.8.2-2.2}
-   [The security target ciphertext for decryption [MUST]{.bcp14} be
    generated as discussed in [Section
    4.7.1](#bcb_canon_cipher){.xref}.[¶](#section-4.8.2-2.3){.pilcrow}]{#section-4.8.2-2.3}
-   [Additional authenticated data [MUST]{.bcp14} be generated as
    discussed in [Section 4.7.2](#bcb_canon_aad){.xref} with the value
    of AAD scope flags being taken from the AAD scope flags security
    context parameter. If the AAD scope flags parameter is not included
    in the security context parameters, then these flags [MAY]{.bcp14}
    be derived from local security policy in cases where the set of such
    flags is determinable in the
    network.[¶](#section-4.8.2-2.4){.pilcrow}]{#section-4.8.2-2.4}
-   [The authentication tag [MUST]{.bcp14} be present either as a
    security result in the BCB representing the security operation or
    (with the ciphertext) in the security target block-type-specific
    data field.[¶](#section-4.8.2-2.5){.pilcrow}]{#section-4.8.2-2.5}

Upon successful decryption, the following action [MUST]{.bcp14}
occur.[¶](#section-4.8.2-3){.pilcrow}

-   [The plaintext produced by AES-GCM [MUST]{.bcp14} replace the bytes
    used to define the ciphertext in the security target block\'s
    block-type-specific data field. Any changes to the security target
    block length field [MUST]{.bcp14} be corrected in cases where the
    plaintext has a different length than the replaced
    ciphertext.[¶](#section-4.8.2-4.1){.pilcrow}]{#section-4.8.2-4.1}

If the security acceptor is not the bundle destination and if no other
integrity or confidentiality service is being applied to the target
block, then a CRC [MUST]{.bcp14} be included for the target block. The
CRC type, as determined by policy, is set in the target block\'s CRC
type field and the corresponding CRC value is added as the CRC field for
that block.[¶](#section-4.8.2-5){.pilcrow}

If the ciphertext fails to authenticate, if any needed parameters are
missing, or if there are other problems in the decryption, then the
decryption [MUST]{.bcp14} be treated as failed and processed in
accordance with local security policy.[¶](#section-4.8.2-6){.pilcrow}
:::
:::
:::
:::

::: {#IANA}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#sc_ids}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Security Context Identifiers](#name-security-context-identifier){.section-name .selfRef} {#name-security-context-identifier}

This specification allocates two security context identifiers from the
\"BPSec Security Context Identifiers\" registry defined in
\[[RFC9172](#RFC9172){.xref}\].[¶](#section-5.1-1){.pilcrow}

[]{#name-additional-entries-for-the-}

::: {#iana_table}
  Value   Description     Reference
  ------- --------------- -----------
  1       BIB-HMAC-SHA2   RFC 9173
  2       BCB-AES-GCM     RFC 9173

  : [Table 8](#table-8){.selfRef}: [Additional Entries for the BPSec
  Security Context Identifiers
  Registry](#name-additional-entries-for-the-){.selfRef}
:::
:::
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Integrity Scope Flags](#name-integrity-scope-flags-2){.section-name .selfRef} {#name-integrity-scope-flags-2}

The BIB-HMAC-SHA2 security context has an Integrity Scope Flags field
for which IANA has created and now maintains a new registry named
\"BPSec BIB-HMAC-SHA2 Integrity Scope Flags\" on the \"Bundle Protocol\"
registry page. [Table 9](#bib_flags){.xref} shows the initial values for
this registry.[¶](#section-5.2-1){.pilcrow}

The registration policy for this registry is Specification Required
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-5.2-2){.pilcrow}

The value range is unsigned 16-bit integer.[¶](#section-5.2-3){.pilcrow}

[]{#name-bpsec-bib-hmac-sha2-integri}

::: {#bib_flags}
  Bit Position (right to left)   Description                    Reference
  ------------------------------ ------------------------------ -----------
  0                              Include primary block flag     RFC 9173
  1                              Include target header flag     RFC 9173
  2                              Include security header flag   RFC 9173
  3-7                            Reserved                       RFC 9173
  8-15                           Unassigned                     

  : [Table 9](#table-9){.selfRef}: [BPSec BIB-HMAC-SHA2 Integrity Scope
  Flags Registry](#name-bpsec-bib-hmac-sha2-integri){.selfRef}
:::
:::

::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [AAD Scope Flags](#name-aad-scope-flags-2){.section-name .selfRef} {#name-aad-scope-flags-2}

The BCB-AES-GCM security context has an AAD Scope Flags field for which
IANA has created and now maintains a new registry named \"BPSec
BCB-AES-GCM AAD Scope Flags\" on the \"Bundle Protocol\" registry page.
[Table 10](#bcb_flags){.xref} shows the initial values for this
registry.[¶](#section-5.3-1){.pilcrow}

The registration policy for this registry is Specification
Required.[¶](#section-5.3-2){.pilcrow}

The value range is unsigned 16-bit integer.[¶](#section-5.3-3){.pilcrow}

[]{#name-bpsec-bcb-aes-gcm-aad-scope}

::: {#bcb_flags}
  Bit Position (right to left)   Description                    Reference
  ------------------------------ ------------------------------ -----------
  0                              Include primary block flag     RFC 9173
  1                              Include target header flag     RFC 9173
  2                              Include security header flag   RFC 9173
  3-7                            Reserved                       RFC 9173
  8-15                           Unassigned                     

  : [Table 10](#table-10){.selfRef}: [BPSec BCB-AES-GCM AAD Scope Flags
  Registry](#name-bpsec-bcb-aes-gcm-aad-scope){.selfRef}
:::
:::

::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Guidance for Designated Experts](#name-guidance-for-designated-exp){.section-name .selfRef} {#name-guidance-for-designated-exp}

New assignments within the \"BPSec BIB-HMAC-SHA2 Integrity Scope Flags\"
and \"BPSec BCB-AES-GCM AAD Scope Flags\" registries require review by a
Designated Expert (DE). This section provides guidance to the DE when
performing their reviews. Specifically, a DE is expected to perform the
following activities.[¶](#section-5.4-1){.pilcrow}

-   [Ascertain the existence of suitable documentation (a specification)
    as described in \[[RFC8126](#RFC8126){.xref}\] and verify that the
    document is permanently and publicly
    available.[¶](#section-5.4-2.1){.pilcrow}]{#section-5.4-2.1}
-   [Ensure that any changes to the \"BPSec BIB-HMAC-SHA2 Integrity
    Scope Flags\" registry clearly state how new assignments interact
    with existing flags and how the inclusion of new assignments affects
    the construction of the IPPT
    value.[¶](#section-5.4-2.2){.pilcrow}]{#section-5.4-2.2}
-   [Ensure that any changes to the \"BPSec BCB-AES-GCM AAD Scope
    Flags\" registry clearly state how new assignments interact with
    existing flags and how the inclusion of new assignments affects the
    construction of the AAD input to the BCB-AES-GCM
    mechanism.[¶](#section-5.4-2.3){.pilcrow}]{#section-5.4-2.3}
-   [Ensure that any processing changes proposed with new assignments do
    not alter any required behavior in this
    specification.[¶](#section-5.4-2.4){.pilcrow}]{#section-5.4-2.4}
:::
:::
:::

::: {#SecCons}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

Security considerations specific to a single security context are
provided in the description of that context (see Sections
[3](#first-context){.xref} and [4](#second-context){.xref}). This
section discusses security considerations that should be evaluated by
implementers of any security context described in this document.
Considerations can also be found in documents listed as normative
references and should also be reviewed by security context
implementors.[¶](#section-6-1){.pilcrow}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Key Management](#name-key-management){.section-name .selfRef} {#name-key-management}

The delayed and disrupted nature of Delay-Tolerant Networking (DTN)
complicates the process of key management because there might not be
reliable, timely, round-trip exchange between security sources, security
verifiers, and security acceptors in the network. This is true when
there is a substantial signal propagation delay between nodes, when
nodes are in a highly challenged communications environment, and when
nodes do not support bidirectional
communication.[¶](#section-6.1-1){.pilcrow}

In these environments, key establishment protocols that rely on
round-trip information exchange might not converge on a shared secret in
a timely manner (or at all). Also, key revocation or key verification
mechanisms that rely on access to a centralized authority (such as a
certificate authority) might similarly fail in the stressing conditions
of DTN.[¶](#section-6.1-2){.pilcrow}

For these reasons, the default security contexts described in this
document rely on symmetric-key cryptographic mechanisms because
asymmetric-key infrastructure (such as a public key infrastructure)
might be impractical in this environment.[¶](#section-6.1-3){.pilcrow}

BPSec assumes that \"key management is handled as a separate part of
network management\" \[[RFC9172](#RFC9172){.xref}\]. This assumption is
also made by the security contexts defined in this document, which do
not define new protocols for key derivation, exchange of KEKs,
revocation of existing keys, or the security configuration or policy
used to select certain keys for certain security
operations.[¶](#section-6.1-4){.pilcrow}

Nodes using these security contexts need to perform the following kinds
of activities, independent of the construction, transmission, and
processing of BPSec security blocks.[¶](#section-6.1-5){.pilcrow}

-   [Establish shared KEKs with other nodes in the network using an
    out-of-band mechanism. This might include pre-sharing of KEKs or the
    use of older key establishment mechanisms prior to the exchange of
    BPSec security
    blocks.[¶](#section-6.1-6.1){.pilcrow}]{#section-6.1-6.1}
-   [Determine when a key is considered exhausted and no longer to be
    used in the generation, verification, or acceptance of a security
    block.[¶](#section-6.1-6.2){.pilcrow}]{#section-6.1-6.2}
-   [Determine when a key is considered invalid and no longer to be used
    in the generation, verification, or acceptance of a security block.
    Such revocations can be based on a variety of mechanisms, including
    local security policy, time relative to the generation or use of the
    key, or other mechanisms specified through network
    management.[¶](#section-6.1-6.3){.pilcrow}]{#section-6.1-6.3}
-   [Determine, through an out-of-band mechanism such as local security
    policy, what keys are to be used for what security blocks. This
    includes the selection of which key should be used in the evaluation
    of a security block received by a security verifier or a security
    acceptor.[¶](#section-6.1-6.4){.pilcrow}]{#section-6.1-6.4}

The failure to provide effective key management techniques appropriate
for the operational networking environment can result in the compromise
of those unmanaged keys and the loss of security services in the
network.[¶](#section-6.1-7){.pilcrow}
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Key Handling](#name-key-handling){.section-name .selfRef} {#name-key-handling}

Once generated, keys should be handled as
follows.[¶](#section-6.2-1){.pilcrow}

-   [It is strongly [RECOMMENDED]{.bcp14} that implementations protect
    keys both when they are stored and when they are
    transmitted.[¶](#section-6.2-2.1){.pilcrow}]{#section-6.2-2.1}
-   [In the event that a key is compromised, any security operations
    using a security context associated with that key [SHOULD]{.bcp14}
    also be considered compromised. This means that the BIB-HMAC-SHA2
    security context [SHOULD NOT]{.bcp14} be treated as providing
    integrity when used with a compromised key, and BCB-AES-GCM [SHOULD
    NOT]{.bcp14} be treated as providing confidentiality when used with
    a compromised key.[¶](#section-6.2-2.2){.pilcrow}]{#section-6.2-2.2}
-   [The same key, whether a KEK or a wrapped key, [MUST NOT]{.bcp14} be
    used for different algorithms as doing so might leak information
    about the key.[¶](#section-6.2-2.3){.pilcrow}]{#section-6.2-2.3}
-   [A KEK [MUST NOT]{.bcp14} be used to encrypt keys for different
    security contexts. Any KEK used by a security context defined in
    this document [MUST]{.bcp14} only be used to wrap keys associated
    with security operations using that security context. This means
    that a compliant security source would not use the same KEK to wrap
    keys for both the BIB-HMAC-SHA2 and BCB-AES-GCM security contexts.
    Similarly, any compliant security verifier or security acceptor
    would not use the same KEK to unwrap keys for different security
    contexts.[¶](#section-6.2-2.4){.pilcrow}]{#section-6.2-2.4}
:::

::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [AES GCM](#name-aes-gcm){.section-name .selfRef} {#name-aes-gcm}

There are a significant number of considerations related to the use of
the GCM mode of AES to provide a confidentiality service. These
considerations are provided in [Section 4.6](#GcmCons){.xref} as part of
the documentation of the BCB-AES-GCM security
context.[¶](#section-6.3-1){.pilcrow}

The length of the ciphertext produced by the GCM mode of AES will be
equal to the length of the plaintext input to the cipher suite. The
authentication tag also produced by this cipher suite is separate from
the ciphertext. However, it should be noted that implementations of the
AES-GCM cipher suite might not separate the concept of ciphertext and
authentication tag in their Application Programming Interface
(API).[¶](#section-6.3-2){.pilcrow}

Implementations of the BCB-AES-GCM security context can either keep the
length of the target block unchanged by holding the authentication tag
in a BCB security result or alter the length of the target block by
including the authentication tag with the ciphertext replacing the
block-type-specific data field of the target block. Implementations
[MAY]{.bcp14} use the authentication tag security result in cases where
keeping target block length unchanged is an important processing
concern. In all cases, the ciphertext and authentication tag
[MUST]{.bcp14} be processed in accordance with the API of the AES-GCM
cipher suites at the security source and security
acceptor.[¶](#section-6.3-3){.pilcrow}
:::

::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [AES Key Wrap](#name-aes-key-wrap){.section-name .selfRef} {#name-aes-key-wrap}

The AES-KW algorithm used by the security contexts in this document does
not use a per-invocation initialization vector and does not require any
key padding. Key padding is not needed because wrapped keys used by
these security contexts will always be multiples of 8 bytes. The length
of the wrapped key can be determined by inspecting the security context
parameters. Therefore, a key can be unwrapped using only the information
present in the security block and the KEK provided by local security
policy at the security verifier or security
acceptor.[¶](#section-6.4-1){.pilcrow}
:::

::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [Bundle Fragmentation](#name-bundle-fragmentation){.section-name .selfRef} {#name-bundle-fragmentation}

Bundle fragmentation might prevent security services in a bundle from
being verified after a bundle is fragmented and before the bundle is
re-assembled. Examples of potential issues include the
following.[¶](#section-6.5-1){.pilcrow}

-   [If a security block and its security target do not exist in the
    same fragment, then the security block cannot be processed until the
    bundle is re-assembled. If a fragment includes an encrypted target
    block, but not its BCB, then a receiving Bundle Protocol Agent (BPA)
    will not know that the target block has been
    encrypted.[¶](#section-6.5-2.1){.pilcrow}]{#section-6.5-2.1}
-   [A security block can be cryptographically bound to a bundle by
    setting the integrity scope flags (for BIB-HMAC-SHA2) or the AAD
    scope flags (for BCB-AES-GCM) to include the bundle primary block.
    When a security block is cryptographically bound to a bundle, it
    cannot be processed even if the security block and target both
    coexist in the fragment. This is because fragments have different
    primary blocks than the original
    bundle.[¶](#section-6.5-2.2){.pilcrow}]{#section-6.5-2.2}
-   [If security blocks and their target blocks are repeated in multiple
    fragments, policy needs to determine how to deal with issues where a
    security operation verifies in one fragment but fails in another
    fragment. This might happen, for example, if a BIB block becomes
    corrupted in one fragment but not in another
    fragment.[¶](#section-6.5-2.3){.pilcrow}]{#section-6.5-2.3}

Implementors should consider how security blocks are processed when a
BPA fragments a received bundle. For example, security blocks and their
targets could be placed in the same fragment if the security block is
not otherwise cryptographically bound to the bundle being fragmented.
Alternatively, if security blocks are cryptographically bound to a
bundle, then a fragmenting BPA should consider encapsulating the bundle
first and then fragmenting the encapsulating
bundle.[¶](#section-6.5-3){.pilcrow}
:::
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[AES-GCM\]
:   [Dworkin, M.]{.refAuthor}, [\"Recommendation for Block Cipher Modes
    of Operation: Galois/Counter Mode (GCM) and GMAC\"]{.refTitle},
    [NIST Special Publication 800-38D]{.seriesInfo}, [DOI
    10.6028/NIST.SP.800-38D]{.seriesInfo}, November 2007,
    \<<https://doi.org/10.6028/NIST.SP.800-38D>\>.
:   

\[RFC2104\]
:   [Krawczyk, H.]{.refAuthor}, [Bellare, M.]{.refAuthor}, and [R.
    Canetti]{.refAuthor}, [\"HMAC: Keyed-Hashing for Message
    Authentication\"]{.refTitle}, [RFC 2104]{.seriesInfo}, [DOI
    10.17487/RFC2104]{.seriesInfo}, February 1997,
    \<<https://www.rfc-editor.org/info/rfc2104>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3394\]
:   [Schaad, J.]{.refAuthor} and [R. Housley]{.refAuthor}, [\"Advanced
    Encryption Standard (AES) Key Wrap Algorithm\"]{.refTitle}, [RFC
    3394]{.seriesInfo}, [DOI 10.17487/RFC3394]{.seriesInfo}, September
    2002, \<<https://www.rfc-editor.org/info/rfc3394>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}, [Leiba, B.]{.refAuthor}, and [T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8152\]
:   [Schaad, J.]{.refAuthor}, [\"CBOR Object Signing and Encryption
    (COSE)\"]{.refTitle}, [RFC 8152]{.seriesInfo}, [DOI
    10.17487/RFC8152]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8152>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8742\]
:   [Bormann, C.]{.refAuthor}, [\"Concise Binary Object Representation
    (CBOR) Sequences\"]{.refTitle}, [RFC 8742]{.seriesInfo}, [DOI
    10.17487/RFC8742]{.seriesInfo}, February 2020,
    \<<https://www.rfc-editor.org/info/rfc8742>\>.
:   

\[RFC8949\]
:   [Bormann, C.]{.refAuthor} and [P. Hoffman]{.refAuthor}, [\"Concise
    Binary Object Representation (CBOR)\"]{.refTitle}, [STD
    94]{.seriesInfo}, [RFC 8949]{.seriesInfo}, [DOI
    10.17487/RFC8949]{.seriesInfo}, December 2020,
    \<<https://www.rfc-editor.org/info/rfc8949>\>.
:   

\[RFC9171\]
:   [Burleigh, S.]{.refAuthor}, [Fall, K.]{.refAuthor}, and [E. Birrane,
    III]{.refAuthor}, [\"Bundle Protocol Version 7\"]{.refTitle}, [RFC
    9171]{.seriesInfo}, [DOI 10.17487/RFC9171]{.seriesInfo}, January
    2022, \<<https://www.rfc-editor.org/rfc/rfc9171>\>.
:   

\[RFC9172\]
:   [Birrane, III, E.]{.refAuthor} and [K. McKeever]{.refAuthor},
    [\"Bundle Protocol Security (BPSec)\"]{.refTitle}, [RFC
    9172]{.seriesInfo}, [DOI 10.17487/RFC9172]{.seriesInfo}, January
    2022, \<<https://www.rfc-editor.org/rfc/rfc9172>\>.
:   

\[SHS\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Secure Hash Standard (SHS)\"]{.refTitle}, [FIPS PUB
    180-4]{.seriesInfo}, [DOI 10.6028/NIST.FIPS.180-4]{.seriesInfo},
    August 2015,
    \<<https://csrc.nist.gov/publications/detail/fips/180/4/final>\>.
:   
:::

::: {#vectors}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Examples](#name-examples){.section-name .selfRef} {#name-examples}

This appendix is informative.[¶](#appendix-A-1){.pilcrow}

This appendix presents a series of examples of constructing BPSec
security blocks (using the security contexts defined in this document)
and adding those blocks to a sample bundle.[¶](#appendix-A-2){.pilcrow}

The examples presented in this appendix represent valid constructions of
bundles, security blocks, and the encoding of security context
parameters and results. For this reason, they can inform unit test
suites for individual implementations as well as interoperability test
suites amongst implementations. However, these examples do not cover
every permutation of security context parameters, security results, or
use of security blocks in a bundle.[¶](#appendix-A-3){.pilcrow}

NOTES:[¶](#appendix-A-4){.pilcrow}

-   [The bundle diagrams in this appendix are patterned after the bundle
    diagrams used in Section
    [3.11](https://www.rfc-editor.org/rfc/rfc9172#section-3.11){.relref}
    ([\"BPSec Block
    Examples\"](https://www.rfc-editor.org/rfc/rfc9172#section-3.11){.relref})
    of
    \[[RFC9172](#RFC9172){.xref}\].[¶](#appendix-A-5.1){.pilcrow}]{#appendix-A-5.1}
-   [Figures in this appendix identified as \"(CBOR Diagnostic
    Notation)\" are represented using the CBOR diagnostic notation
    defined in \[[RFC8949](#RFC8949){.xref}\]. This notation is used to
    express CBOR data structures in a manner that enables visual
    inspection. The bundles, security blocks, and security context
    contents in these figures are represented using CBOR structures. In
    cases where BP blocks (to include BPSec security blocks) are
    comprised of a sequence of CBOR objects, these objects are
    represented as a CBOR sequence as defined in
    \[[RFC8742](#RFC8742){.xref}\].[¶](#appendix-A-5.2){.pilcrow}]{#appendix-A-5.2}
-   [Examples in this appendix use the \"ipn\" URI scheme for endpoint
    ID naming, as defined in
    \[[RFC9171](#RFC9171){.xref}\].[¶](#appendix-A-5.3){.pilcrow}]{#appendix-A-5.3}
-   [The bundle source is presumed to be the security source for all
    security blocks in this appendix, unless otherwise
    noted.[¶](#appendix-A-5.4){.pilcrow}]{#appendix-A-5.4}

::: {#appendix-A.1 .section}
### [A.1.](#appendix-A.1){.section-number .selfRef} [Example 1 - Simple Integrity](#name-example-1-simple-integrity){.section-name .selfRef} {#name-example-1-simple-integrity}

This example shows the addition of a BIB to a sample bundle to provide
integrity for the payload block.[¶](#appendix-A.1-1){.pilcrow}

::: {#appendix-A.1.1 .section}
#### [A.1.1.](#appendix-A.1.1){.section-number .selfRef} [Original Bundle](#name-original-bundle){.section-name .selfRef} {#name-original-bundle}

The following diagram shows the original bundle before the BIB has been
added.[¶](#appendix-A.1.1-1){.pilcrow}

[]{#name-example-1-original-bundle}

::: {#appendix-A.1.1-2.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Payload Block                         |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 1](#figure-1){.selfRef}: [Example 1 - Original
Bundle](#name-example-1-original-bundle){.selfRef}

::: {#ex_primary_block}
::: {#appendix-A.1.1.1 .section}
##### [A.1.1.1.](#appendix-A.1.1.1){.section-number .selfRef} [Primary Block](#name-primary-block){.section-name .selfRef} {#name-primary-block}

The Bundle Protocol version 7 (BPv7) bundle has no special block and
bundle processing control flags, and no CRC is provided because the
primary block is expected to be protected by an integrity service BIB
using the BIB-HMAC-SHA2 security
context.[¶](#appendix-A.1.1.1-1){.pilcrow}

The bundle is sourced at the source node ipn:2.1 and destined for the
destination node ipn:1.2. The bundle creation time is set to 0,
indicating lack of an accurate clock, with a sequence number of 40. The
lifetime of the bundle is given as 1,000,000 milliseconds since the
bundle creation time.[¶](#appendix-A.1.1.1-2){.pilcrow}

The primary block is provided as
follows.[¶](#appendix-A.1.1.1-3){.pilcrow}

[]{#name-primary-block-cbor-diagnost}

::: {#ex_bdl_prim}
::: {#appendix-A.1.1.1-4.1}
``` {.lang-cbor-diag .sourcecode}
[
  7,           / BP version            /
  0,           / flags                 /
  0,           / CRC type              /
  [2, [1,2]],  / destination (ipn:1.2) /
  [2, [2,1]],  / source      (ipn:2.1) /
  [2, [2,1]],  / report-to   (ipn:2.1) /
  [0, 40],     / timestamp             /
  1000000      / lifetime              /
]
```
:::

[Figure 2](#figure-2){.selfRef}: [Primary Block (CBOR Diagnostic
Notation)](#name-primary-block-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the primary block
is:[¶](#appendix-A.1.1.1-5){.pilcrow}

::: {#appendix-A.1.1.1-6}
``` sourcecode
0x88070000820282010282028202018202820201820018281a000f4240
```

[¶](#appendix-A.1.1.1-6){.pilcrow}
:::
:::
:::

::: {#ex_payload_block}
::: {#appendix-A.1.1.2 .section}
##### [A.1.1.2.](#appendix-A.1.1.2){.section-number .selfRef} [Payload Block](#name-payload-block){.section-name .selfRef} {#name-payload-block}

Other than its use as a source of plaintext for security blocks, the
payload has no required distinguishing characteristic for the purpose of
this example. The sample payload is a 35-byte
string.[¶](#appendix-A.1.1.2-1){.pilcrow}

The payload is represented in the payload block as a byte string of the
raw payload string. It is NOT represented as a CBOR text string wrapped
within a CBOR binary string. The hex value of the payload
is:[¶](#appendix-A.1.1.2-2){.pilcrow}

::: {#appendix-A.1.1.2-3}
``` sourcecode
0x526561647920746f2067656e657261746520612033322d62797465207061796c6f
6164
```

[¶](#appendix-A.1.1.2-3){.pilcrow}
:::

The payload block is provided as
follows.[¶](#appendix-A.1.1.2-4){.pilcrow}

[]{#name-payload-block-cbor-diagnost}

::: {#appendix-A.1.1.2-5.1}
``` {.lang-cbor-diag .sourcecode}
[
  1,                       / type code: Payload block       /
  1,                       / block number                   /
  0,                       / block processing control flags /
  0,                       / CRC type                       /
  h'526561647920746f206765 / type-specific-data: payload    /
  6e657261746520612033322d
  62797465207061796c6f6164'
]
```
:::

[Figure 3](#figure-3){.selfRef}: [Payload Block (CBOR Diagnostic
Notation)](#name-payload-block-cbor-diagnost){.selfRef}

The CBOR encoding of the payload block
is:[¶](#appendix-A.1.1.2-6){.pilcrow}

::: {#appendix-A.1.1.2-7}
``` sourcecode
0x85010100005823526561647920746f2067656e657261746520612033322d627974
65207061796c6f6164
```

[¶](#appendix-A.1.1.2-7){.pilcrow}
:::
:::
:::

::: {#appendix-A.1.1.3 .section}
##### [A.1.1.3.](#appendix-A.1.1.3){.section-number .selfRef} [Bundle CBOR Representation](#name-bundle-cbor-representation){.section-name .selfRef} {#name-bundle-cbor-representation}

A BPv7 bundle is represented as an indefinite-length array consisting of
the blocks comprising the bundle, with a terminator character at the
end.[¶](#appendix-A.1.1.3-1){.pilcrow}

The CBOR encoding of the original bundle
is:[¶](#appendix-A.1.1.3-2){.pilcrow}

::: {#appendix-A.1.1.3-3}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f424085010100
005823526561647920746f2067656e657261746520612033322d6279746520706179
6c6f6164ff
```

[¶](#appendix-A.1.1.3-3){.pilcrow}
:::
:::
:::

::: {#appendix-A.1.2 .section}
#### [A.1.2.](#appendix-A.1.2){.section-number .selfRef} [Security Operation Overview](#name-security-operation-overview){.section-name .selfRef} {#name-security-operation-overview}

This example adds a BIB to the bundle using the BIB-HMAC-SHA2 security
context to provide an integrity mechanism over the payload
block.[¶](#appendix-A.1.2-1){.pilcrow}

The following diagram shows the resulting bundle after the BIB is
added.[¶](#appendix-A.1.2-2){.pilcrow}

[]{#name-example-1-resulting-bundle}

::: {#appendix-A.1.2-3.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Block Integrity Block                 |   11  |    2   |
    |  OP(bib-integrity, target=1)           |       |        |
    +----------------------------------------+-------+--------+
    |  Payload Block                         |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 4](#figure-4){.selfRef}: [Example 1 - Resulting
Bundle](#name-example-1-resulting-bundle){.selfRef}
:::

::: {#appendix-A.1.3 .section}
#### [A.1.3.](#appendix-A.1.3){.section-number .selfRef} [Block Integrity Block](#name-block-integrity-block){.section-name .selfRef} {#name-block-integrity-block}

In this example, a BIB is used to carry an integrity signature over the
payload block.[¶](#appendix-A.1.3-1){.pilcrow}

::: {#appendix-A.1.3.1 .section}
##### [A.1.3.1.](#appendix-A.1.3.1){.section-number .selfRef} [Configuration, Parameters, and Results](#name-configuration-parameters-an){.section-name .selfRef} {#name-configuration-parameters-an}

For this example, the following configuration and security context
parameters are used to generate the security results
indicated.[¶](#appendix-A.1.3.1-1){.pilcrow}

This BIB has a single target and includes a single security result: the
calculated signature over the payload
block.[¶](#appendix-A.1.3.1-2){.pilcrow}

[]{#name-example-1-configuration-par}

::: {#ex1_cpr}
::: {#appendix-A.1.3.1-3.1 .alignCenter .art-text .artwork}
     Key         : h'1a2b1a2b1a2b1a2b1a2b1a2b1a2b1a2b'
     SHA Variant : HMAC 512/512
     Scope Flags : 0x00
     Payload Data: h'526561647920746f2067656e65726174
                     6520612033322d62797465207061796c
                     6f6164'
     IPPT        : h'005823526561647920746f2067656e65
                     7261746520612033322d627974652070
                     61796c6f6164'
     Signature   : h'3bdc69b3a34a2b5d3a8554368bd1e808
                     f606219d2a10a846eae3886ae4ecc83c
                     4ee550fdfb1cc636b904e2f1a73e303d
                     cd4b6ccece003e95e8164dcc89a156e1'
:::

[Figure 5](#figure-5){.selfRef}: [Example 1 - Configuration, Parameters,
and Results](#name-example-1-configuration-par){.selfRef}
:::
:::

::: {#appendix-A.1.3.2 .section}
##### [A.1.3.2.](#appendix-A.1.3.2){.section-number .selfRef} [Abstract Security Block](#name-abstract-security-block){.section-name .selfRef} {#name-abstract-security-block}

The abstract security block structure of the BIB\'s block-type-specific
data field for this application is as
follows.[¶](#appendix-A.1.3.2-1){.pilcrow}

[]{#name-example-1-bib-abstract-secu}

::: {#ex1_bib_asb}
::: {#appendix-A.1.3.2-2.1}
``` {.lang-cbor-diag .sourcecode}
[1],           / Security Target        - Payload block       /
1,             / Security Context ID    - BIB-HMAC-SHA2       /
1,             / Security Context Flags - Parameters Present  /
[2,[2, 1]],    / Security Source        - ipn:2.1             /
[              / Security Parameters    - 2 Parameters        /
   [1, 7],     / SHA Variant            - HMAC 512/512        /
   [3, 0x00]   / Scope Flags            - No Additional Scope /
],
[              / Security Results: 1 Result                   /
  [            / Target 1 Results                             /
    [1, h'3bdc69b3a34a2b5d3a8554368bd1e808         / MAC      /
          f606219d2a10a846eae3886ae4ecc83c
          4ee550fdfb1cc636b904e2f1a73e303d
          cd4b6ccece003e95e8164dcc89a156e1']
  ]
]
```
:::

[Figure 6](#figure-6){.selfRef}: [Example 1 - BIB Abstract Security
Block (CBOR Diagnostic
Notation)](#name-example-1-bib-abstract-secu){.selfRef}
:::

The CBOR encoding of the BIB block-type-specific data field (the
abstract security block) is:[¶](#appendix-A.1.3.2-3){.pilcrow}

::: {#appendix-A.1.3.2-4}
``` sourcecode
0x810101018202820201828201078203008181820158403bdc69b3a34a2b5d3a8554
368bd1e808f606219d2a10a846eae3886ae4ecc83c4ee550fdfb1cc636b904e2f1a7
3e303dcd4b6ccece003e95e8164dcc89a156e1
```

[¶](#appendix-A.1.3.2-4){.pilcrow}
:::
:::

::: {#appendix-A.1.3.3 .section}
##### [A.1.3.3.](#appendix-A.1.3.3){.section-number .selfRef} [Representations](#name-representations){.section-name .selfRef} {#name-representations}

The complete BIB is as follows.[¶](#appendix-A.1.3.3-1){.pilcrow}

[]{#name-example-1-bib-cbor-diagnost}

::: {#ex1_bib}
::: {#appendix-A.1.3.3-2.1}
``` {.lang-cbor-diag .sourcecode}
[
  11, / type code    /
  2,  / block number /
  0,  / flags        /
  0,  / CRC type     /
  h'810101018202820201828201078203008181820158403bdc69b3a34a
  2b5d3a8554368bd1e808f606219d2a10a846eae3886ae4ecc83c4ee550
  fdfb1cc636b904e2f1a73e303dcd4b6ccece003e95e8164dcc89a156e1'
]
```
:::

[Figure 7](#figure-7){.selfRef}: [Example 1 - BIB (CBOR Diagnostic
Notation)](#name-example-1-bib-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the BIB block is:[¶](#appendix-A.1.3.3-3){.pilcrow}

::: {#appendix-A.1.3.3-4}
``` sourcecode
0x850b0200005856810101018202820201828201078203008181820158403bdc69b3
a34a2b5d3a8554368bd1e808f606219d2a10a846eae3886ae4ecc83c4ee550fdfb1c
c636b904e2f1a73e303dcd4b6ccece003e95e8164dcc89a156e1
```

[¶](#appendix-A.1.3.3-4){.pilcrow}
:::
:::
:::

::: {#appendix-A.1.4 .section}
#### [A.1.4.](#appendix-A.1.4){.section-number .selfRef} [Final Bundle](#name-final-bundle){.section-name .selfRef} {#name-final-bundle}

The CBOR encoding of the full output bundle, with the
BIB:[¶](#appendix-A.1.4-1){.pilcrow}

::: {#appendix-A.1.4-2}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f4240850b0200
005856810101018202820201828201078203008181820158403bdc69b3a34a2b5d3a
8554368bd1e808f606219d2a10a846eae3886ae4ecc83c4ee550fdfb1cc636b904e2
f1a73e303dcd4b6ccece003e95e8164dcc89a156e185010100005823526561647920
746f2067656e657261746520612033322d62797465207061796c6f6164ff
```

[¶](#appendix-A.1.4-2){.pilcrow}
:::
:::
:::

::: {#appendix-A.2 .section}
### [A.2.](#appendix-A.2){.section-number .selfRef} [Example 2 - Simple Confidentiality with Key Wrap](#name-example-2-simple-confidenti){.section-name .selfRef} {#name-example-2-simple-confidenti}

This example shows the addition of a BCB to a sample bundle to provide
confidentiality for the payload block. AES key wrap is used to transmit
the symmetric key used to generate the security results for this
service.[¶](#appendix-A.2-1){.pilcrow}

::: {#appendix-A.2.1 .section}
#### [A.2.1.](#appendix-A.2.1){.section-number .selfRef} [Original Bundle](#name-original-bundle-2){.section-name .selfRef} {#name-original-bundle-2}

The following diagram shows the original bundle before the BCB has been
added.[¶](#appendix-A.2.1-1){.pilcrow}

[]{#name-example-2-original-bundle}

::: {#appendix-A.2.1-2.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Payload Block                         |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 8](#figure-8){.selfRef}: [Example 2 - Original
Bundle](#name-example-2-original-bundle){.selfRef}

::: {#appendix-A.2.1.1 .section}
##### [A.2.1.1.](#appendix-A.2.1.1){.section-number .selfRef} [Primary Block](#name-primary-block-2){.section-name .selfRef} {#name-primary-block-2}

The primary block used in this example is identical to the primary block
presented for Example 1 in [Appendix
A.1.1.1](#ex_primary_block){.xref}.[¶](#appendix-A.2.1.1-1){.pilcrow}

In summary, the CBOR encoding of the primary block
is:[¶](#appendix-A.2.1.1-2){.pilcrow}

::: {#appendix-A.2.1.1-3}
``` sourcecode
0x88070000820282010282028202018202820201820018281a000f4240
```

[¶](#appendix-A.2.1.1-3){.pilcrow}
:::
:::

::: {#appendix-A.2.1.2 .section}
##### [A.2.1.2.](#appendix-A.2.1.2){.section-number .selfRef} [Payload Block](#name-payload-block-2){.section-name .selfRef} {#name-payload-block-2}

The payload block used in this example is identical to the payload block
presented for Example 1 in [Appendix
A.1.1.2](#ex_payload_block){.xref}.[¶](#appendix-A.2.1.2-1){.pilcrow}

In summary, the CBOR encoding of the payload block
is:[¶](#appendix-A.2.1.2-2){.pilcrow}

::: {#appendix-A.2.1.2-3}
``` sourcecode
0x85010100005823526561647920746f2067656e657261746520612033322d627974
65207061796c6f6164
```

[¶](#appendix-A.2.1.2-3){.pilcrow}
:::
:::

::: {#appendix-A.2.1.3 .section}
##### [A.2.1.3.](#appendix-A.2.1.3){.section-number .selfRef} [Bundle CBOR Representation](#name-bundle-cbor-representation-2){.section-name .selfRef} {#name-bundle-cbor-representation-2}

A BPv7 bundle is represented as an indefinite-length array consisting of
the blocks comprising the bundle, with a terminator character at the
end.[¶](#appendix-A.2.1.3-1){.pilcrow}

The CBOR encoding of the original bundle
is:[¶](#appendix-A.2.1.3-2){.pilcrow}

::: {#appendix-A.2.1.3-3}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f424085010100
005823526561647920746f2067656e657261746520612033322d6279746520706179
6c6f6164ff
```

[¶](#appendix-A.2.1.3-3){.pilcrow}
:::
:::
:::

::: {#appendix-A.2.2 .section}
#### [A.2.2.](#appendix-A.2.2){.section-number .selfRef} [Security Operation Overview](#name-security-operation-overview-2){.section-name .selfRef} {#name-security-operation-overview-2}

This example adds a BCB using the BCB-AES-GCM security context using AES
key wrap to provide a confidentiality mechanism over the payload block
and transmit the symmetric key.[¶](#appendix-A.2.2-1){.pilcrow}

The following diagram shows the resulting bundle after the BCB is
added.[¶](#appendix-A.2.2-2){.pilcrow}

[]{#name-example-2-resulting-bundle}

::: {#appendix-A.2.2-3.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Block Confidentiality Block           |   12  |    2   |
    |  OP(bcb-confidentiality, target=1)     |       |        |
    +----------------------------------------+-------+--------+
    |  Payload Block (Encrypted)             |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 9](#figure-9){.selfRef}: [Example 2 - Resulting
Bundle](#name-example-2-resulting-bundle){.selfRef}
:::

::: {#appendix-A.2.3 .section}
#### [A.2.3.](#appendix-A.2.3){.section-number .selfRef} [Block Confidentiality Block](#name-block-confidentiality-block){.section-name .selfRef} {#name-block-confidentiality-block}

In this example, a BCB is used to encrypt the payload block, and AES key
wrap is used to encode the symmetric key prior to its inclusion in the
BCB.[¶](#appendix-A.2.3-1){.pilcrow}

::: {#appendix-A.2.3.1 .section}
##### [A.2.3.1.](#appendix-A.2.3.1){.section-number .selfRef} [Configuration, Parameters, and Results](#name-configuration-parameters-and){.section-name .selfRef} {#name-configuration-parameters-and}

For this example, the following configuration and security context
parameters are used to generate the security results
indicated.[¶](#appendix-A.2.3.1-1){.pilcrow}

This BCB has a single target \-- the payload block. Three security
results are generated: ciphertext that replaces the plaintext
block-type-specific data to encrypt the payload block, an authentication
tag, and the AES wrapped key.[¶](#appendix-A.2.3.1-2){.pilcrow}

[]{#name-example-2-configuration-par}

::: {#ex2_cpr}
::: {#appendix-A.2.3.1-3.1 .alignCenter .art-text .artwork}
     Content Encryption
                    Key: h'71776572747975696f70617364666768'
     Key Encryption Key: h'6162636465666768696a6b6c6d6e6f70'
                     IV: h'5477656c7665313231323132'
            AES Variant: A128GCM
        AES Wrapped Key: h'69c411276fecddc4780df42c8a2af892
                           96fabf34d7fae700'
            Scope Flags: 0x00
           Payload Data: h'526561647920746f2067656e65726174
                           6520612033322d62797465207061796c
                           6f6164'
                    AAD: h'00'
     Authentication Tag: h'efa4b5ac0108e3816c5606479801bc04'
     Payload Ciphertext: h'3a09c1e63fe23a7f66a59c7303837241
                           e070b02619fc59c5214a22f08cd70795
                           e73e9a'
:::

[Figure 10](#figure-10){.selfRef}: [Example 2 - Configuration,
Parameters, and Results](#name-example-2-configuration-par){.selfRef}
:::
:::

::: {#appendix-A.2.3.2 .section}
##### [A.2.3.2.](#appendix-A.2.3.2){.section-number .selfRef} [Abstract Security Block](#name-abstract-security-block-2){.section-name .selfRef} {#name-abstract-security-block-2}

The abstract security block structure of the BCB\'s block-type-specific
data field for this application is as
follows.[¶](#appendix-A.2.3.2-1){.pilcrow}

[]{#name-example-2-bcb-abstract-secu}

::: {#ex2_bcb_asb}
::: {#appendix-A.2.3.2-2.1}
``` {.lang-cbor-diag .sourcecode}
[1],               / Security Target        - Payload block       /
2,                 / Security Context ID    - BCB-AES-GCM         /
1,                 / Security Context Flags - Parameters Present  /
[2,[2, 1]],        / Security Source        - ipn:2.1             /
[                  / Security Parameters    - 4 Parameters        /
  [1, h'5477656c7665313231323132'], / Initialization Vector       /
  [2, 1],                           / AES Variant - A128GCM       /
  [3, h'69c411276fecddc4780df42c8a  / AES wrapped key             /
        2af89296fabf34d7fae700'],
  [4, 0x00]                         / Scope Flags - No extra scope/
],
[                                   /  Security Results: 1 Result /
  [                                 /  Target 1 Results           /
    [1, h'efa4b5ac0108e3816c5606479801bc04']  / Payload Auth. Tag /
  ]
]
```
:::

[Figure 11](#figure-11){.selfRef}: [Example 2 - BCB Abstract Security
Block (CBOR Diagnostic
Notation)](#name-example-2-bcb-abstract-secu){.selfRef}
:::

The CBOR encoding of the BCB block-type-specific data field (the
abstract security block) is:[¶](#appendix-A.2.3.2-3){.pilcrow}

::: {#appendix-A.2.3.2-4}
``` sourcecode
0x8101020182028202018482014c5477656c76653132313231328202018203581869
c411276fecddc4780df42c8a2af89296fabf34d7fae7008204008181820150efa4b5
ac0108e3816c5606479801bc04
```

[¶](#appendix-A.2.3.2-4){.pilcrow}
:::
:::

::: {#appendix-A.2.3.3 .section}
##### [A.2.3.3.](#appendix-A.2.3.3){.section-number .selfRef} [Representations](#name-representations-2){.section-name .selfRef} {#name-representations-2}

The complete BCB is as follows.[¶](#appendix-A.2.3.3-1){.pilcrow}

[]{#name-example-2-bcb-cbor-diagnost}

::: {#ex2_bcb}
::: {#appendix-A.2.3.3-2.1}
``` {.lang-cbor-diag .sourcecode}
[
  12, / type code                                          /
  2,  / block number                                       /
  1,  / flags - block must be replicated in every fragment /
  0,  / CRC type                                           /
  h'8101020182028202018482014c5477656c766531323132313282020182035818
    69c411276fecddc4780df42c8a2af89296fabf34d7fae7008204008181820150
    efa4b5ac0108e3816c5606479801bc04'
]
```
:::

[Figure 12](#figure-12){.selfRef}: [Example 2 - BCB (CBOR Diagnostic
Notation)](#name-example-2-bcb-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the BCB block is:[¶](#appendix-A.2.3.3-3){.pilcrow}

::: {#appendix-A.2.3.3-4}
``` sourcecode
0x850c02010058508101020182028202018482014c5477656c766531323132313282
02018203581869c411276fecddc4780df42c8a2af89296fabf34d7fae70082040081
81820150efa4b5ac0108e3816c5606479801bc04
```

[¶](#appendix-A.2.3.3-4){.pilcrow}
:::
:::
:::

::: {#appendix-A.2.4 .section}
#### [A.2.4.](#appendix-A.2.4){.section-number .selfRef} [Final Bundle](#name-final-bundle-2){.section-name .selfRef} {#name-final-bundle-2}

The CBOR encoding of the full output bundle, with the
BCB:[¶](#appendix-A.2.4-1){.pilcrow}

::: {#appendix-A.2.4-2}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f4240850c0201
0058508101020182028202018482014c5477656c7665313231323132820201820358
1869c411276fecddc4780df42c8a2af89296fabf34d7fae7008204008181820150ef
a4b5ac0108e3816c5606479801bc04850101000058233a09c1e63fe23a7f66a59c73
03837241e070b02619fc59c5214a22f08cd70795e73e9aff
```

[¶](#appendix-A.2.4-2){.pilcrow}
:::
:::
:::

::: {#appendix-A.3 .section}
### [A.3.](#appendix-A.3){.section-number .selfRef} [Example 3 - Security Blocks from Multiple Sources](#name-example-3-security-blocks-f){.section-name .selfRef} {#name-example-3-security-blocks-f}

This example shows the addition of a BIB and BCB to a sample bundle.
These two security blocks are added by two different nodes. The BCB is
added by the source endpoint, and the BIB is added by a forwarding
node.[¶](#appendix-A.3-1){.pilcrow}

The resulting bundle contains a BCB to encrypt the Payload Block and a
BIB to provide integrity to the primary block and Bundle Age
Block.[¶](#appendix-A.3-2){.pilcrow}

::: {#appendix-A.3.1 .section}
#### [A.3.1.](#appendix-A.3.1){.section-number .selfRef} [Original Bundle](#name-original-bundle-3){.section-name .selfRef} {#name-original-bundle-3}

The following diagram shows the original bundle before the security
blocks have been added.[¶](#appendix-A.3.1-1){.pilcrow}

[]{#name-example-3-original-bundle}

::: {#appendix-A.3.1-2.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Extension Block: Bundle Age Block     |   7   |    2   |
    +----------------------------------------+-------+--------+
    |  Payload Block                         |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 13](#figure-13){.selfRef}: [Example 3 - Original
Bundle](#name-example-3-original-bundle){.selfRef}

::: {#appendix-A.3.1.1 .section}
##### [A.3.1.1.](#appendix-A.3.1.1){.section-number .selfRef} [Primary Block](#name-primary-block-3){.section-name .selfRef} {#name-primary-block-3}

The primary block used in this example is identical to the primary block
presented for Example 1 in [Appendix
A.1.1.1](#ex_primary_block){.xref}.[¶](#appendix-A.3.1.1-1){.pilcrow}

In summary, the CBOR encoding of the primary block
is:[¶](#appendix-A.3.1.1-2){.pilcrow}

::: {#appendix-A.3.1.1-3}
``` sourcecode
0x88070000820282010282028202018202820201820018281a000f4240
```

[¶](#appendix-A.3.1.1-3){.pilcrow}
:::
:::

::: {#appendix-A.3.1.2 .section}
##### [A.3.1.2.](#appendix-A.3.1.2){.section-number .selfRef} [Bundle Age Block](#name-bundle-age-block){.section-name .selfRef} {#name-bundle-age-block}

A Bundle Age Block is added to the bundle to help other nodes in the
network determine the age of the bundle. The use of this block is
recommended because the bundle source does not have an accurate clock
(as indicated by the DTN time of 0).[¶](#appendix-A.3.1.2-1){.pilcrow}

Because this block is specified at the time the bundle is being
forwarded, the bundle age represents the time that has elapsed from the
time the bundle was created to the time it is being prepared for
forwarding. In this case, the value is given as 300
milliseconds.[¶](#appendix-A.3.1.2-2){.pilcrow}

The Bundle Age extension block is provided as
follows.[¶](#appendix-A.3.1.2-3){.pilcrow}

[]{#name-bundle-age-block-cbor-diagn}

::: {#ex_bdl_age}
::: {#appendix-A.3.1.2-4.1}
``` {.lang-cbor-diag .sourcecode}
[
  7,      / type code: Bundle Age Block    /
  2,      / block number                   /
  0,      / block processing control flags /
  0,      / CRC type                       /
  <<300>> / type-specific-data: age        /
]
```
:::

[Figure 14](#figure-14){.selfRef}: [Bundle Age Block (CBOR Diagnostic
Notation)](#name-bundle-age-block-cbor-diagn){.selfRef}
:::

The CBOR encoding of the Bundle Age Block
is:[¶](#appendix-A.3.1.2-5){.pilcrow}

::: {#appendix-A.3.1.2-6}
``` sourcecode
0x85070200004319012c
```

[¶](#appendix-A.3.1.2-6){.pilcrow}
:::
:::

::: {#appendix-A.3.1.3 .section}
##### [A.3.1.3.](#appendix-A.3.1.3){.section-number .selfRef} [Payload Block](#name-payload-block-3){.section-name .selfRef} {#name-payload-block-3}

The payload block used in this example is identical to the payload block
presented for Example 1 in [Appendix
A.1.1.2](#ex_payload_block){.xref}.[¶](#appendix-A.3.1.3-1){.pilcrow}

In summary, the CBOR encoding of the payload block
is:[¶](#appendix-A.3.1.3-2){.pilcrow}

::: {#appendix-A.3.1.3-3}
``` sourcecode
0x85010100005823526561647920746f2067656e657261746520612033322d627974
65207061796c6f6164
```

[¶](#appendix-A.3.1.3-3){.pilcrow}
:::
:::

::: {#appendix-A.3.1.4 .section}
##### [A.3.1.4.](#appendix-A.3.1.4){.section-number .selfRef} [Bundle CBOR Representation](#name-bundle-cbor-representation-3){.section-name .selfRef} {#name-bundle-cbor-representation-3}

A BPv7 bundle is represented as an indefinite-length array consisting of
the blocks comprising the bundle, with a terminator character at the
end.[¶](#appendix-A.3.1.4-1){.pilcrow}

The CBOR encoding of the original bundle
is:[¶](#appendix-A.3.1.4-2){.pilcrow}

::: {#appendix-A.3.1.4-3}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f424085070200
004319012c85010100005823526561647920746f2067656e65726174652061203332
2d62797465207061796c6f6164ff
```

[¶](#appendix-A.3.1.4-3){.pilcrow}
:::
:::
:::

::: {#appendix-A.3.2 .section}
#### [A.3.2.](#appendix-A.3.2){.section-number .selfRef} [Security Operation Overview](#name-security-operation-overview-3){.section-name .selfRef} {#name-security-operation-overview-3}

This example provides:[¶](#appendix-A.3.2-1){.pilcrow}

-   [a BIB with the BIB-HMAC-SHA2 security context to provide an
    integrity mechanism over the primary block and Bundle Age
    Block.[¶](#appendix-A.3.2-2.1){.pilcrow}]{#appendix-A.3.2-2.1}
-   [a BCB with the BCB-AES-GCM security context to provide a
    confidentiality mechanism over the payload
    block.[¶](#appendix-A.3.2-2.2){.pilcrow}]{#appendix-A.3.2-2.2}

The following diagram shows the resulting bundle after the security
blocks are added.[¶](#appendix-A.3.2-3){.pilcrow}

[]{#name-example-3-resulting-bundle}

::: {#appendix-A.3.2-4.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Block Integrity Block                 |   11  |    3   |
    |  OP(bib-integrity, targets=0, 2)       |       |        |
    +----------------------------------------+-------+--------+
    |  Block Confidentiality Block           |   12  |    4   |
    |  OP(bcb-confidentiality, target=1)     |       |        |
    +----------------------------------------+-------+--------+
    |  Extension Block: Bundle Age Block     |   7   |    2   |
    +----------------------------------------+-------+--------+
    |  Payload Block (Encrypted)             |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 15](#figure-15){.selfRef}: [Example 3 - Resulting
Bundle](#name-example-3-resulting-bundle){.selfRef}
:::

::: {#appendix-A.3.3 .section}
#### [A.3.3.](#appendix-A.3.3){.section-number .selfRef} [Block Integrity Block](#name-block-integrity-block-2){.section-name .selfRef} {#name-block-integrity-block-2}

In this example, a BIB is used to carry an integrity signature over the
Bundle Age Block and an additional signature over the payload block. The
BIB is added by a waypoint node \--
ipn:3.0.[¶](#appendix-A.3.3-1){.pilcrow}

::: {#appendix-A.3.3.1 .section}
##### [A.3.3.1.](#appendix-A.3.3.1){.section-number .selfRef} [Configuration, Parameters, and Results](#name-configuration-parameters-and-){.section-name .selfRef} {#name-configuration-parameters-and-}

For this example, the following configuration and security context
parameters are used to generate the security results
indicated.[¶](#appendix-A.3.3.1-1){.pilcrow}

This BIB has two security targets and includes two security results,
holding the calculated signatures over the Bundle Age Block and primary
block.[¶](#appendix-A.3.3.1-2){.pilcrow}

[]{#name-example-3-configuration-par}

::: {#ex3_bib_cpr}
::: {#appendix-A.3.3.1-3.1 .alignCenter .art-text .artwork}
                    Key: h'1a2b1a2b1a2b1a2b1a2b1a2b1a2b1a2b'
            SHA Variant: HMAC 256/256
            Scope Flags: 0x00
     Primary Block Data: h'88070000820282010282028202018202
                           820201820018281a000f4240'
     Bundle Age Block
                   Data: h'4319012c'
     Primary Block IPPT: h'00581c88070000820282010282028202
                           018202820201820018281a000f4240'
    Bundle Age Block
                   IPPT: h'004319012c'
     Primary Block
              Signature: h'cac6ce8e4c5dae57988b757e49a6dd14
                           31dc04763541b2845098265bc817241b'
     Bundle Age Block
              Signature: h'3ed614c0d97f49b3633627779aa18a33
                           8d212bf3c92b97759d9739cd50725596'
:::

[Figure 16](#figure-16){.selfRef}: [Example 3 - Configuration,
Parameters, and Results for the
BIB](#name-example-3-configuration-par){.selfRef}
:::
:::

::: {#appendix-A.3.3.2 .section}
##### [A.3.3.2.](#appendix-A.3.3.2){.section-number .selfRef} [Abstract Security Block](#name-abstract-security-block-3){.section-name .selfRef} {#name-abstract-security-block-3}

The abstract security block structure of the BIB\'s block-type-specific
data field for this application is as
follows.[¶](#appendix-A.3.3.2-1){.pilcrow}

[]{#name-example-3-bib-abstract-secu}

::: {#ex3_bib_asb}
::: {#appendix-A.3.3.2-2.1}
``` {.lang-cbor-diag .sourcecode}
[0, 2],         / Security Targets                             /
1,              / Security Context ID    - BIB-HMAC-SHA2       /
1,              / Security Context Flags - Parameters Present  /
[2,[3, 0]],     / Security Source        - ipn:3.0             /
[               / Security Parameters    - 2 Parameters        /
   [1, 5],      / SHA Variant            - HMAC 256            /
   [3, 0]       / Scope Flags            - No Additional Scope /
],
[               / Security Results: 2 Results                  /
   [            / Primary Block Results                        /
       [1, h'cac6ce8e4c5dae57988b757e49a6dd14
             31dc04763541b2845098265bc817241b']       / MAC    /
    ],
    [           / Bundle Age Block Results                     /
       [1, h'3ed614c0d97f49b3633627779aa18a33
             8d212bf3c92b97759d9739cd50725596']       / MAC    /
    ]
]
```
:::

[Figure 17](#figure-17){.selfRef}: [Example 3 - BIB Abstract Security
Block (CBOR Diagnostic
Notation)](#name-example-3-bib-abstract-secu){.selfRef}
:::

The CBOR encoding of the BIB block-type-specific data field (the
abstract security block) is:[¶](#appendix-A.3.3.2-3){.pilcrow}

::: {#appendix-A.3.3.2-4}
``` sourcecode
0x8200020101820282030082820105820300828182015820cac6ce8e4c5dae57988b
757e49a6dd1431dc04763541b2845098265bc817241b81820158203ed614c0d97f49
b3633627779aa18a338d212bf3c92b97759d9739cd50725596
```

[¶](#appendix-A.3.3.2-4){.pilcrow}
:::
:::

::: {#appendix-A.3.3.3 .section}
##### [A.3.3.3.](#appendix-A.3.3.3){.section-number .selfRef} [Representations](#name-representations-3){.section-name .selfRef} {#name-representations-3}

The complete BIB is as follows.[¶](#appendix-A.3.3.3-1){.pilcrow}

[]{#name-example-3-bib-cbor-diagnost}

::: {#ex3_bib}
::: {#appendix-A.3.3.3-2.1}
``` {.lang-cbor-diag .sourcecode}
[
  11, / type code    /
  3,  / block number /
  0,  / flags        /
  0,  / CRC type     /
  h'8200020101820282030082820105820300828182015820cac6ce8e4c5dae5798
  8b757e49a6dd1431dc04763541b2845098265bc817241b81820158203ed614c0d9
  7f49b3633627779aa18a338d212bf3c92b97759d9739cd50725596'
]
```
:::

[Figure 18](#figure-18){.selfRef}: [Example 3 - BIB (CBOR Diagnostic
Notation)](#name-example-3-bib-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the BIB block is:[¶](#appendix-A.3.3.3-3){.pilcrow}

::: {#appendix-A.3.3.3-4}
``` sourcecode
0x850b030000585c8200020101820282030082820105820300828182015820cac6ce
8e4c5dae57988b757e49a6dd1431dc04763541b2845098265bc817241b8182015820
3ed614c0d97f49b3633627779aa18a338d212bf3c92b97759d9739cd50725596
```

[¶](#appendix-A.3.3.3-4){.pilcrow}
:::
:::
:::

::: {#appendix-A.3.4 .section}
#### [A.3.4.](#appendix-A.3.4){.section-number .selfRef} [Block Confidentiality Block](#name-block-confidentiality-block-2){.section-name .selfRef} {#name-block-confidentiality-block-2}

In this example, a BCB is used encrypt the payload block. The BCB is
added by the bundle source node,
ipn:2.1.[¶](#appendix-A.3.4-1){.pilcrow}

::: {#appendix-A.3.4.1 .section}
##### [A.3.4.1.](#appendix-A.3.4.1){.section-number .selfRef} [Configuration, Parameters, and Results](#name-configuration-parameters-and-r){.section-name .selfRef} {#name-configuration-parameters-and-r}

For this example, the following configuration and security context
parameters are used to generate the security results
indicated.[¶](#appendix-A.3.4.1-1){.pilcrow}

This BCB has a single target, the payload block. Two security results
are generated: ciphertext that replaces the plaintext
block-type-specific data to encrypt the payload block and an
authentication tag.[¶](#appendix-A.3.4.1-2){.pilcrow}

[]{#name-example-3-configuration-para}

::: {#ex3_bcb_cpr}
::: {#appendix-A.3.4.1-3.1 .alignCenter .art-text .artwork}
     Content Encryption
                    Key: h'71776572747975696f70617364666768'
                     IV: h'5477656c7665313231323132'
            AES Variant: A128GCM
            Scope Flags: 0x00
           Payload Data: h'526561647920746f2067656e65726174
                           6520612033322d62797465207061796c
                           6f6164'
                    AAD: h'00'
     Authentication Tag: h'efa4b5ac0108e3816c5606479801bc04'
     Payload Ciphertext: h'3a09c1e63fe23a7f66a59c7303837241
                           e070b02619fc59c5214a22f08cd70795
                           e73e9a'
:::

[Figure 19](#figure-19){.selfRef}: [Example 3 - Configuration,
Parameters, and Results for the
BCB](#name-example-3-configuration-para){.selfRef}
:::
:::

::: {#appendix-A.3.4.2 .section}
##### [A.3.4.2.](#appendix-A.3.4.2){.section-number .selfRef} [Abstract Security Block](#name-abstract-security-block-4){.section-name .selfRef} {#name-abstract-security-block-4}

The abstract security block structure of the BCB\'s block-type-specific
data field for this application is as
follows.[¶](#appendix-A.3.4.2-1){.pilcrow}

[]{#name-example-3-bcb-abstract-secu}

::: {#ex3_bcb_asb}
::: {#appendix-A.3.4.2-2.1}
``` {.lang-cbor-diag .sourcecode}
[1],             / Security Target        - Payload block      /
2,               / Security Context ID    - BCB-AES-GCM        /
1,               / Security Context Flags - Parameters Present /
[2,[2, 1]],      / Security Source        - ipn:2.1            /
[                / Security Parameters    - 3 Parameters       /
  [1, h'5477656c7665313231323132'],    / Initialization Vector /
  [2, 1],                              / AES Variant - AES 128 /
  [4, 0]                   / Scope Flags - No Additional Scope /
],
[                                 / Security Results: 1 Result /
  [
     [1, h'efa4b5ac0108e3816c5606479801bc04'] / Payload Auth. Tag /
  ]
]
```
:::

[Figure 20](#figure-20){.selfRef}: [Example 3 - BCB Abstract Security
Block (CBOR Diagnostic
Notation)](#name-example-3-bcb-abstract-secu){.selfRef}
:::

The CBOR encoding of the BCB block-type-specific data field (the
abstract security block) is:[¶](#appendix-A.3.4.2-3){.pilcrow}

::: {#appendix-A.3.4.2-4}
``` sourcecode
0x8101020182028202018382014c5477656c76653132313231328202018204008181
820150efa4b5ac0108e3816c5606479801bc04
```

[¶](#appendix-A.3.4.2-4){.pilcrow}
:::
:::

::: {#appendix-A.3.4.3 .section}
##### [A.3.4.3.](#appendix-A.3.4.3){.section-number .selfRef} [Representations](#name-representations-4){.section-name .selfRef} {#name-representations-4}

The complete BCB is as follows.[¶](#appendix-A.3.4.3-1){.pilcrow}

[]{#name-example-3-bcb-cbor-diagnost}

::: {#ex3_bcb}
::: {#appendix-A.3.4.3-2.1}
``` {.lang-cbor-diag .sourcecode}
[
  12, / type code                                          /
  4,  / block number                                       /
  1,  / flags - block must be replicated in every fragment /
  0,  / CRC type                                           /
  h'8101020182028202018382014c5477656c766531323132313282020182040081
    81820150efa4b5ac0108e3816c5606479801bc04'
]
```
:::

[Figure 21](#figure-21){.selfRef}: [Example 3 - BCB (CBOR Diagnostic
Notation)](#name-example-3-bcb-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the BCB block is:[¶](#appendix-A.3.4.3-3){.pilcrow}

::: {#appendix-A.3.4.3-4}
``` sourcecode
0x850c04010058348101020182028202018382014c5477656c766531323132313282
02018204008181820150efa4b5ac0108e3816c5606479801bc04
```

[¶](#appendix-A.3.4.3-4){.pilcrow}
:::
:::
:::

::: {#appendix-A.3.5 .section}
#### [A.3.5.](#appendix-A.3.5){.section-number .selfRef} [Final Bundle](#name-final-bundle-3){.section-name .selfRef} {#name-final-bundle-3}

The CBOR encoding of the full output bundle, with the BIB and BCB added
is:[¶](#appendix-A.3.5-1){.pilcrow}

::: {#appendix-A.3.5-2}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f4240850b0300
00585c8200020101820282030082820105820300828182015820cac6ce8e4c5dae57
988b757e49a6dd1431dc04763541b2845098265bc817241b81820158203ed614c0d9
7f49b3633627779aa18a338d212bf3c92b97759d9739cd50725596850c0401005834
8101020182028202018382014c5477656c7665313231323132820201820400818182
0150efa4b5ac0108e3816c5606479801bc0485070200004319012c85010100005823
3a09c1e63fe23a7f66a59c7303837241e070b02619fc59c5214a22f08cd70795e73e
9aff
```

[¶](#appendix-A.3.5-2){.pilcrow}
:::
:::
:::

::: {#appendix-A.4 .section}
### [A.4.](#appendix-A.4){.section-number .selfRef} [Example 4 - Security Blocks with Full Scope](#name-example-4-security-blocks-w){.section-name .selfRef} {#name-example-4-security-blocks-w}

This example shows the addition of a BIB and BCB to a sample bundle. A
BIB is added to provide integrity over the payload block, and a BCB is
added for confidentiality over the payload and
BIB.[¶](#appendix-A.4-1){.pilcrow}

The integrity scope and additional authentication data will bind the
primary block, target header, and the security
header.[¶](#appendix-A.4-2){.pilcrow}

::: {#appendix-A.4.1 .section}
#### [A.4.1.](#appendix-A.4.1){.section-number .selfRef} [Original Bundle](#name-original-bundle-4){.section-name .selfRef} {#name-original-bundle-4}

The following diagram shows the original bundle before the security
blocks have been added.[¶](#appendix-A.4.1-1){.pilcrow}

[]{#name-example-4-original-bundle}

::: {#appendix-A.4.1-2.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Payload Block                         |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 22](#figure-22){.selfRef}: [Example 4 - Original
Bundle](#name-example-4-original-bundle){.selfRef}

::: {#appendix-A.4.1.1 .section}
##### [A.4.1.1.](#appendix-A.4.1.1){.section-number .selfRef} [Primary Block](#name-primary-block-4){.section-name .selfRef} {#name-primary-block-4}

The primary block used in this example is identical to the primary block
presented for Example 1 in [Appendix
A.1.1.1](#ex_primary_block){.xref}.[¶](#appendix-A.4.1.1-1){.pilcrow}

In summary, the CBOR encoding of the primary block
is:[¶](#appendix-A.4.1.1-2){.pilcrow}

::: {#appendix-A.4.1.1-3}
``` sourcecode
0x88070000820282010282028202018202820201820018281a000f4240
```

[¶](#appendix-A.4.1.1-3){.pilcrow}
:::
:::

::: {#appendix-A.4.1.2 .section}
##### [A.4.1.2.](#appendix-A.4.1.2){.section-number .selfRef} [Payload Block](#name-payload-block-4){.section-name .selfRef} {#name-payload-block-4}

The payload block used in this example is identical to the payload block
presented for Example 1 in [Appendix
A.1.1.2](#ex_payload_block){.xref}.[¶](#appendix-A.4.1.2-1){.pilcrow}

In summary, the CBOR encoding of the payload block
is:[¶](#appendix-A.4.1.2-2){.pilcrow}

::: {#appendix-A.4.1.2-3}
``` sourcecode
0x85010100005823526561647920746f2067656e657261746520612033322d627974
65207061796c6f6164
```

[¶](#appendix-A.4.1.2-3){.pilcrow}
:::
:::

::: {#appendix-A.4.1.3 .section}
##### [A.4.1.3.](#appendix-A.4.1.3){.section-number .selfRef} [Bundle CBOR Representation](#name-bundle-cbor-representation-4){.section-name .selfRef} {#name-bundle-cbor-representation-4}

A BPv7 bundle is represented as an indefinite-length array consisting of
the blocks comprising the bundle, with a terminator character at the
end.[¶](#appendix-A.4.1.3-1){.pilcrow}

The CBOR encoding of the original bundle
is:[¶](#appendix-A.4.1.3-2){.pilcrow}

::: {#appendix-A.4.1.3-3}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f424085010100
005823526561647920746f2067656e657261746520612033322d6279746520706179
6c6f6164ff
```

[¶](#appendix-A.4.1.3-3){.pilcrow}
:::
:::
:::

::: {#appendix-A.4.2 .section}
#### [A.4.2.](#appendix-A.4.2){.section-number .selfRef} [Security Operation Overview](#name-security-operation-overview-4){.section-name .selfRef} {#name-security-operation-overview-4}

This example provides:[¶](#appendix-A.4.2-1){.pilcrow}

-   [a BIB with the BIB-HMAC-SHA2 security context to provide an
    integrity mechanism over the payload
    block.[¶](#appendix-A.4.2-2.1){.pilcrow}]{#appendix-A.4.2-2.1}
-   [a BCB with the BCB-AES-GCM security context to provide a
    confidentiality mechanism over the payload block and
    BIB.[¶](#appendix-A.4.2-2.2){.pilcrow}]{#appendix-A.4.2-2.2}

The following diagram shows the resulting bundle after the security
blocks are added.[¶](#appendix-A.4.2-3){.pilcrow}

[]{#name-example-4-resulting-bundle}

::: {#appendix-A.4.2-4.1 .alignCenter .art-text .artwork}
                      Block                    Block   Block
                    in Bundle                  Type    Number
    +========================================+=======+========+
    |  Primary Block                         |  N/A  |    0   |
    +----------------------------------------+-------+--------+
    |  Block Integrity Block (Encrypted)     |   11  |    3   |
    |  OP(bib-integrity, target=1)           |       |        |
    +----------------------------------------+-------+--------+
    |  Block Confidentiality Block           |   12  |    2   |
    |  OP(bcb-confidentiality, targets=1, 3) |       |        |
    +----------------------------------------+-------+--------+
    |  Payload Block (Encrypted)             |   1   |    1   |
    +----------------------------------------+-------+--------+
:::

[Figure 23](#figure-23){.selfRef}: [Example 4 - Resulting
Bundle](#name-example-4-resulting-bundle){.selfRef}
:::

::: {#appendix-A.4.3 .section}
#### [A.4.3.](#appendix-A.4.3){.section-number .selfRef} [Block Integrity Block](#name-block-integrity-block-3){.section-name .selfRef} {#name-block-integrity-block-3}

In this example, a BIB is used to carry an integrity signature over the
payload block. The IPPT contains the block-type-specific data of the
payload block, the primary block data, the payload block header, and the
BIB header. That is, all additional headers are included in the
IPPT.[¶](#appendix-A.4.3-1){.pilcrow}

::: {#appendix-A.4.3.1 .section}
##### [A.4.3.1.](#appendix-A.4.3.1){.section-number .selfRef} [Configuration, Parameters, and Results](#name-configuration-parameters-and-re){.section-name .selfRef} {#name-configuration-parameters-and-re}

For this example, the following configuration and security context
parameters are used to generate the security results
indicated.[¶](#appendix-A.4.3.1-1){.pilcrow}

This BIB has a single target and includes a single security result: the
calculated signature over the Payload
block.[¶](#appendix-A.4.3.1-2){.pilcrow}

[]{#name-example-4-configuration-par}

::: {#ex4_bib_cpr}
::: {#appendix-A.4.3.1-3.1 .alignCenter .art-text .artwork}
                   Key: h'1a2b1a2b1a2b1a2b1a2b1a2b1a2b1a2b'
           SHA Variant: HMAC 384/384
           Scope Flags: 0x07  (all additional headers)
    Primary Block Data: h'88070000820282010282028202018202
                          820201820018281a000f4240'
          Payload Data: h'526561647920746f2067656e65726174
                          6520612033322d62797465207061796c
                          6f6164'
        Payload Header: h'010100'
            BIB Header: h'0b0300'
                  IPPT: h'07880700008202820102820282020182
                          02820201820018281a000f4240010100
                          0b03005823526561647920746f206765
                          6e657261746520612033322d62797465
                          207061796c6f6164'
     Payload Signature: h'f75fe4c37f76f046165855bd5ff72fbf
                          d4e3a64b4695c40e2b787da005ae819f
                          0a2e30a2e8b325527de8aefb52e73d71,
:::

[Figure 24](#figure-24){.selfRef}: [Example 4 - Configuration,
Parameters, and Results for the
BIB](#name-example-4-configuration-par){.selfRef}
:::
:::

::: {#appendix-A.4.3.2 .section}
##### [A.4.3.2.](#appendix-A.4.3.2){.section-number .selfRef} [Abstract Security Block](#name-abstract-security-block-5){.section-name .selfRef} {#name-abstract-security-block-5}

The abstract security block structure of the BIB\'s block-type-specific
data field for this application is as
follows.[¶](#appendix-A.4.3.2-1){.pilcrow}

[]{#name-example-4-bib-abstract-secu}

::: {#ex4_bib_asb}
::: {#appendix-A.4.3.2-2.1}
``` {.lang-cbor-diag .sourcecode}
[1],           / Security Target          - Payload block          /
1,             / Security Context ID      - BIB-HMAC-SHA2          /
1,             / Security Context Flags   - Parameters Present     /
[2,[2, 1]],    / Security Source          - ipn:2.1                /
[              / Security Parameters      - 2 Parameters           /
   [1, 6],     / SHA Variant              - HMAC 384/384           /
   [3, 0x07]   / Scope Flags              - All additional headers /
],
[              / Security Results: 1 Result                        /
  [            / Target 1 Results                                  /
    [1, h'f75fe4c37f76f046165855bd5ff72fbf         / MAC           /
          d4e3a64b4695c40e2b787da005ae819f
          0a2e30a2e8b325527de8aefb52e73d71']
  ]
]
```
:::

[Figure 25](#figure-25){.selfRef}: [Example 4 - BIB Abstract Security
Block (CBOR Diagnostic
Notation)](#name-example-4-bib-abstract-secu){.selfRef}
:::

The CBOR encoding of the BIB block-type-specific data field (the
abstract security block) is:[¶](#appendix-A.4.3.2-3){.pilcrow}

::: {#appendix-A.4.3.2-4}
``` sourcecode
0x81010101820282020182820106820307818182015830f75fe4c37f76f046165855
bd5ff72fbfd4e3a64b4695c40e2b787da005ae819f0a2e30a2e8b325527de8aefb52
e73d71
```

[¶](#appendix-A.4.3.2-4){.pilcrow}
:::
:::

::: {#appendix-A.4.3.3 .section}
##### [A.4.3.3.](#appendix-A.4.3.3){.section-number .selfRef} [Representations](#name-representations-5){.section-name .selfRef} {#name-representations-5}

The complete BIB is as follows.[¶](#appendix-A.4.3.3-1){.pilcrow}

[]{#name-example-4-bib-cbor-diagnost}

::: {#ex4_bib}
::: {#appendix-A.4.3.3-2.1}
``` {.lang-cbor-diag .sourcecode}
[
  11, / type code    /
  3,  / block number /
  0,  / flags        /
  0,  / CRC type     /
  h'81010101820282020182820106820307818182015830f75fe4c37f76f0461658
    55bd5ff72fbfd4e3a64b4695c40e2b787da005ae819f0a2e30a2e8b325527de8
    aefb52e73d71'
]
```
:::

[Figure 26](#figure-26){.selfRef}: [Example 4 - BIB (CBOR Diagnostic
Notation)](#name-example-4-bib-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the BIB block is:[¶](#appendix-A.4.3.3-3){.pilcrow}

::: {#appendix-A.4.3.3-4}
``` sourcecode
0x850b030000584681010101820282020182820106820307818182015830f75fe4c3
7f76f046165855bd5ff72fbfd4e3a64b4695c40e2b787da005ae819f0a2e30a2e8b3
25527de8aefb52e73d71
```

[¶](#appendix-A.4.3.3-4){.pilcrow}
:::
:::
:::

::: {#appendix-A.4.4 .section}
#### [A.4.4.](#appendix-A.4.4){.section-number .selfRef} [Block Confidentiality Block](#name-block-confidentiality-block-3){.section-name .selfRef} {#name-block-confidentiality-block-3}

In this example, a BCB is used encrypt the payload block and the BIB
that provides integrity over the
payload.[¶](#appendix-A.4.4-1){.pilcrow}

::: {#appendix-A.4.4.1 .section}
##### [A.4.4.1.](#appendix-A.4.4.1){.section-number .selfRef} [Configuration, Parameters, and Results](#name-configuration-parameters-and-res){.section-name .selfRef} {#name-configuration-parameters-and-res}

For this example, the following configuration and security context
parameters are used to generate the security results
indicated.[¶](#appendix-A.4.4.1-1){.pilcrow}

This BCB has two targets: the payload block and BIB. Four security
results are generated: ciphertext that replaces the plaintext
block-type-specific data of the payload block, ciphertext to encrypt the
BIB, and authentication tags for both the payload block and
BIB.[¶](#appendix-A.4.4.1-2){.pilcrow}

[]{#name-example-4-configuration-para}

::: {#ex4_bcb_cpr}
::: {#appendix-A.4.4.1-3.1 .alignCenter .art-ascii-art .art-text .artwork}
                   Key: h'71776572747975696f70617364666768
                          71776572747975696f70617364666768'
                    IV: h'5477656c7665313231323132'
           AES Variant: A256GCM
           Scope Flags: 0x07  (All additional headers)
          Payload Data: h'526561647920746f2067656e65726174
                          6520612033322d62797465207061796c
                          6f6164'
              BIB Data: h'81010101820282020182820106820307
                          818182015830f75fe4c37f76f0461658
                          55bd5ff72fbfd4e3a64b4695c40e2b78
                          7da005ae819f0a2e30a2e8b325527de8
                          aefb52e73d71'
     Primary Block Data: h'88070000820282010282028202018202
                           820201820018281a000f4240'
         Payload Header: h'010100'
             BIB Header: h'0b0300'
             BCB Header: h'0c0201'
            Payload AAD: h'07880700008202820102820282020182
                           02820201820018281a000f4240010100
                           0c0201'
                BIB AAD: h'07880700008202820102820282020182
                           02820201820018281a000f42400b0300
                           0c0201'
         Payload Block
    Authentication Tag: h'd2c51cb2481792dae8b21d848cede99b'
                   BIB
    Authentication Tag: h'220ffc45c8a901999ecc60991dd78b29'
    Payload Ciphertext: h'90eab6457593379298a8724e16e61f83
                          7488e127212b59ac91f8a86287b7d076
                          30a122'
        BIB Ciphertext: h'438ed6208eb1c1ffb94d952175167df0
                          902902064a2983910c4fb2340790bf42
                          0a7d1921d5bf7c4721e02ab87a93ab1e
                          0b75cf62e4948727c8b5dae46ed2af05
                          439b88029191'
:::

[Figure 27](#figure-27){.selfRef}: [Example 4 - Configuration,
Parameters, and Results for the
BCB](#name-example-4-configuration-para){.selfRef}
:::
:::

::: {#appendix-A.4.4.2 .section}
##### [A.4.4.2.](#appendix-A.4.4.2){.section-number .selfRef} [Abstract Security Block](#name-abstract-security-block-6){.section-name .selfRef} {#name-abstract-security-block-6}

The abstract security block structure of the BCB\'s block-type-specific
data field for this application is as
follows.[¶](#appendix-A.4.4.2-1){.pilcrow}

[]{#name-example-4-bcb-abstract-secu}

::: {#ex4_bcb_asb}
::: {#appendix-A.4.4.2-2.1}
``` {.lang-cbor-diag .sourcecode}
[3, 1],          / Security Targets                            /
2,               / Security Context ID    - BCB-AES-GCM        /
1,               / Security Context Flags - Parameters Present /
[2,[2, 1]],      / Security Source        - ipn:2.1            /
[                / Security Parameters    - 3 Parameters       /
  [1, h'5477656c7665313231323132'],    / Initialization Vector /
  [2, 3],                              / AES Variant - AES 256 /
  [4, 0x07]            / Scope Flags - All headers in SHA hash /
],
[                                / Security Results: 2 Results /
  [
     [1, h'220ffc45c8a901999ecc60991dd78b29']  / BIB Auth. Tag /
  ],
  [
     [1, h'd2c51cb2481792dae8b21d848cede99b'] / Payload Auth. Tag /
  ]
]
```
:::

[Figure 28](#figure-28){.selfRef}: [Example 4 - BCB Abstract Security
Block (CBOR Diagnostic
Notation)](#name-example-4-bcb-abstract-secu){.selfRef}
:::

The CBOR encoding of the BCB block-type-specific data field (the
abstract security block) is:[¶](#appendix-A.4.4.2-3){.pilcrow}

::: {#appendix-A.4.4.2-4}
``` sourcecode
0x820301020182028202018382014c5477656c766531323132313282020382040782
81820150220ffc45c8a901999ecc60991dd78b2981820150d2c51cb2481792dae8b2
1d848cede99b
```

[¶](#appendix-A.4.4.2-4){.pilcrow}
:::
:::

::: {#appendix-A.4.4.3 .section}
##### [A.4.4.3.](#appendix-A.4.4.3){.section-number .selfRef} [Representations](#name-representations-6){.section-name .selfRef} {#name-representations-6}

The complete BCB is as follows.[¶](#appendix-A.4.4.3-1){.pilcrow}

[]{#name-example-4-bcb-cbor-diagnost}

::: {#ex4_bcb}
::: {#appendix-A.4.4.3-2.1}
``` {.lang-cbor-diag .sourcecode}
[
  12, / type code                                          /
  2,  / block number                                       /
  1,  / flags - block must be replicated in every fragment /
  0,  / CRC type                                           /
  h'820301020182028202018382014c5477656c7665313231323132820203820407
    8281820150220ffc45c8a901999ecc60991dd78b2981820150d2c51cb2481792
    dae8b21d848cede99b'
]
```
:::

[Figure 29](#figure-29){.selfRef}: [Example 4 - BCB (CBOR Diagnostic
Notation)](#name-example-4-bcb-cbor-diagnost){.selfRef}
:::

The CBOR encoding of the BCB block is:[¶](#appendix-A.4.4.3-3){.pilcrow}

::: {#appendix-A.4.4.3-4}
``` sourcecode
0x850c0201005849820301020182028202018382014c5477656c7665313231323132
8202038204078281820150220ffc45c8a901999ecc60991dd78b2981820150d2c51c
b2481792dae8b21d848cede99b
```

[¶](#appendix-A.4.4.3-4){.pilcrow}
:::
:::
:::

::: {#appendix-A.4.5 .section}
#### [A.4.5.](#appendix-A.4.5){.section-number .selfRef} [Final Bundle](#name-final-bundle-4){.section-name .selfRef} {#name-final-bundle-4}

The CBOR encoding of the full output bundle, with the security blocks
added and payload block and BIB encrypted
is:[¶](#appendix-A.4.5-1){.pilcrow}

::: {#appendix-A.4.5-2}
``` sourcecode
0x9f88070000820282010282028202018202820201820018281a000f4240850b0300
005846438ed6208eb1c1ffb94d952175167df0902902064a2983910c4fb2340790bf
420a7d1921d5bf7c4721e02ab87a93ab1e0b75cf62e4948727c8b5dae46ed2af0543
9b88029191850c0201005849820301020182028202018382014c5477656c76653132
313231328202038204078281820150220ffc45c8a901999ecc60991dd78b29818201
50d2c51cb2481792dae8b21d848cede99b8501010000582390eab6457593379298a8
724e16e61f837488e127212b59ac91f8a86287b7d07630a122ff
```

[¶](#appendix-A.4.5-2){.pilcrow}
:::
:::
:::
:::
:::

::: {#cddl}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [CDDL Expression](#name-cddl-expression){.section-name .selfRef} {#name-cddl-expression}

For informational purposes, this section contains an expression of the
IPPT and AAD structures using the Concise Data Definition Language
(CDDL).[¶](#appendix-B-1){.pilcrow}

NOTES:[¶](#appendix-B-2){.pilcrow}

-   [Wherever the CDDL expression is in disagreement with the textual
    representation of the security block specification presented in
    earlier sections of this document, the textual representation
    rules.[¶](#appendix-B-3.1){.pilcrow}]{#appendix-B-3.1}
-   [The structure of BP bundles and BPSec security blocks are provided
    by other specifications; this appendix only provides the CDDL
    expression for structures uniquely defined in this specification.
    Items related to elements of a bundle, such as \"primary-block\",
    are defined in [Appendix
    B](https://www.rfc-editor.org/rfc/rfc9171#appendix-B){.relref} of
    the Bundle Protocol version 7
    \[[RFC9171](#RFC9171){.xref}\].[¶](#appendix-B-3.2){.pilcrow}]{#appendix-B-3.2}
-   [The CDDL itself does not have the concept of unadorned CBOR
    sequences as a top-level subject of a specification. The current
    best practice, as documented in [Section
    4.1](https://www.rfc-editor.org/rfc/rfc8742#section-4.1){.relref} of
    \[[RFC8742](#RFC8742){.xref}\], requires representing the sequence
    as an array with a comment in the CDDL noting that the array
    represents a CBOR
    sequence.[¶](#appendix-B-3.3){.pilcrow}]{#appendix-B-3.3}

[]{#name-ippt-and-aad-expressions}

::: {#appendix_b}
::: {#appendix-B-4.1}
``` {.lang-cddl .sourcecode}
start = scope / AAD-list / IPPT-list ; satisfy CDDL decoders

scope = uint .bits scope-flags
scope-flags = &(
    has-primary-ctx: 0,
    has-target-ctx: 1,
    has-security-ctx: 2,
)

; Encoded as a CBOR sequence
AAD-list = [
    AAD-structure
]

; Encoded as a CBOR sequence
IPPT-list = [
    AAD-structure,
    target-btsd: bstr ; block-type-specific data of the target block.
]

AAD-structure = (
    scope,
    ? primary-block,  ; present if has-primary-ctx flag set
    ? block-metadata, ; present if has-target-ctx flag set
    ? block-metadata, ; present if has-security-ctx flag set
)

; Selected fields of a canonical block
block-metadata = (
    block-type-code: uint,
    block-number: uint,
    block-control-flags,
)
```
:::

[Figure 30](#figure-30){.selfRef}: [IPPT and AAD
Expressions](#name-ippt-and-aad-expressions){.selfRef}
:::
:::
:::

::: {#contr}
::: {#appendix-C .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

[Amy Alford]{.contact-name} of the Johns Hopkins University Applied
Physics Laboratory contributed useful review and analysis of these
security contexts.[¶](#appendix-C-1){.pilcrow}

[Brian Sipos]{.contact-name} kindly provided the CDDL expression in
[Appendix B](#cddl){.xref}.[¶](#appendix-C-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Edward J. Birrane, III]{.fn .nameRole}
:::

::: {.left dir="auto"}
[The Johns Hopkins University Applied Physics Laboratory]{.org}
:::

::: {.left dir="auto"}
[11100 Johns Hopkins Rd.]{.street-address}
:::

::: {.left dir="auto"}
[Laurel]{.locality}, [MD]{.region} [20723]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 443 778 7423](tel:+1%20443%20778%207423){.tel}
:::

::: email
Email: <Edward.Birrane@jhuapl.edu>
:::

::: {.left dir="auto"}
[Alex White]{.fn .nameRole}
:::

::: {.left dir="auto"}
[The Johns Hopkins University Applied Physics Laboratory]{.org}
:::

::: {.left dir="auto"}
[11100 Johns Hopkins Rd.]{.street-address}
:::

::: {.left dir="auto"}
[Laurel]{.locality}, [MD]{.region} [20723]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 443 778 0845](tel:+1%20443%20778%200845){.tel}
:::

::: email
Email: <Alex.White@jhuapl.edu>
:::

::: {.left dir="auto"}
[Sarah Heiner]{.fn .nameRole}
:::

::: {.left dir="auto"}
[The Johns Hopkins University Applied Physics Laboratory]{.org}
:::

::: {.left dir="auto"}
[11100 Johns Hopkins Rd.]{.street-address}
:::

::: {.left dir="auto"}
[Laurel]{.locality}, [MD]{.region} [20723]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 240 592 3704](tel:+1%20240%20592%203704){.tel}
:::

::: email
Email: <Sarah.Heiner@jhuapl.edu>
:::
:::
:::
