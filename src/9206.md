  RFC 9206             CNSA Suite IPsec Profile   February 2022
  -------------------- -------------------------- ---------------
  Corcoran & Jenkins   Informational              \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [9206](https://www.rfc-editor.org/rfc/rfc9206){.eref}

Category:
:   Informational

Published:
:   February 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    L. Corcoran
    :::

    ::: org
    NSA
    :::
    :::

    ::: author
    ::: author-name
    M. Jenkins
    :::

    ::: org
    NSA
    :::
    :::
:::

# RFC 9206 {#rfcnum}

# Commercial National Security Algorithm (CNSA) Suite Cryptography for Internet Protocol Security (IPsec) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The United States Government has published the National Security
Agency\'s Commercial National Security Algorithm (CNSA) Suite, which
defines cryptographic algorithm policy for national security
applications. This document specifies the conventions for using the
United States National Security Agency\'s CNSA Suite algorithms in
Internet Protocol Security (IPsec). It applies to the capabilities,
configuration, and operation of all components of US National Security
Systems (described in NIST Special Publication 800-59) that employ
IPsec. This document is also appropriate for all other US Government
systems that process high-value information. It is made publicly
available for use by developers and operators of these and any other
system deployments.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9206>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [The Commercial National Security Algorithm
    Suite](#name-the-commercial-national-sec){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [CNSA-Compliant IPsec
    Overview](#name-cnsa-compliant-ipsec-overvi){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IPsec User Interface
    Suites](#name-ipsec-user-interface-suites){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Suite
        CNSA-GCM-256-ECDH-384](#name-suite-cnsa-gcm-256-ecdh-384){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Suite
        CNSA-GCM-256-DH-3072](#name-suite-cnsa-gcm-256-dh-3072){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Suite
        CNSA-GCM-256-DH-4096](#name-suite-cnsa-gcm-256-dh-4096){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [IKEv2
    Authentication](#name-ikev2-authentication){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Certificates](#name-certificates){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [IKEv2 Security Associations
    (SAs)](#name-ikev2-security-associations){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [The Key Exchange Payload in the
    IKE_SA_INIT Exchange](#name-the-key-exchange-payload-in){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Generating Key Material for the IKE
    SA](#name-generating-key-material-for){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [Additional
    Requirements](#name-additional-requirements){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [Guidance for Applications with Long
    Data-Protection
    Requirements](#name-guidance-for-applications-w){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [13](#section-13){.xref}. [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.14}
    [14](#section-14){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [15](#section-15){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.15.2.1}
        [15.1](#section-15.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.15.2.2}
        [15.2](#section-15.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.16}
    [](#appendix-A){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document specifies the conventions for using the United States
National Security Agency\'s (NSA\'s) Commercial National Security
Algorithm (CNSA) Suite algorithms \[[CNSA](#CNSA){.xref}\] in Internet
Protocol Security (IPsec). It defines CNSA-based User Interface suites
(\"UI suites\") describing sets of security configurations for Internet
Key Exchange Protocol Version 2 (IKEv2) and IP Encapsulating Security
Payload (ESP) protocol use, and specifies certain other constraints with
respect to algorithm selection and configuration. It applies to the
capabilities, configuration, and operation of all components of US
National Security Systems (described in NIST Special Publication 800-59
\[[SP80059](#SP80059){.xref}\]) that employ IPsec. This document is also
appropriate for all other US Government systems that process high-value
information. It is made publicly available for use by developers and
operators of these and any other system
deployments.[¶](#section-1-1){.pilcrow}

The reader is assumed to have familiarity with the
following:[¶](#section-1-2){.pilcrow}

-   [\"[IP Encapsulating Security Payload (ESP)](#RFC4303){.xref}\"
    \[[RFC4303](#RFC4303){.xref}\][¶](#section-1-3.1){.pilcrow}]{#section-1-3.1}
-   [\"[Internet X.509 Public Key Infrastructure Certificate and
    Certificate Revocation List (CRL) Profile](#RFC5280){.xref}\"
    \[[RFC5280](#RFC5280){.xref}\][¶](#section-1-3.2){.pilcrow}]{#section-1-3.2}
-   [\"[Internet Key Exchange Protocol Version 2
    (IKEv2)](#RFC7296){.xref}\"
    \[[RFC7296](#RFC7296){.xref}\][¶](#section-1-3.3){.pilcrow}]{#section-1-3.3}
-   [\"[Cryptographic Algorithm Implementation Requirements and Usage
    Guidance for Encapsulating Security Payload (ESP) and Authentication
    Header (AH)](#RFC8221){.xref}\"
    \[[RFC8221](#RFC8221){.xref}\][¶](#section-1-3.4){.pilcrow}]{#section-1-3.4}
-   [\"[Commercial National Security Algorithm (CNSA) Suite Certificate
    and Certificate Revocation List (CRL) Profile](#RFC8603){.xref}\"
    \[[RFC8603](#RFC8603){.xref}\][¶](#section-1-3.5){.pilcrow}]{#section-1-3.5}
:::
:::

::: {#terminology}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

AES refers to the Advanced Encryption Standard. ECDSA and ECDH refer to
the use of the Elliptic Curve Digital Signature Algorithm (ECDSA) and
Elliptic Curve Diffie-Hellman (ECDH), respectively. DH refers to
Diffie-Hellman key establishment. RSA refers to an RSA
signature.[¶](#section-2-2){.pilcrow}
:::
:::

::: {#cnsa}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [The Commercial National Security Algorithm Suite](#name-the-commercial-national-sec){.section-name .selfRef} {#name-the-commercial-national-sec}

The NSA profiles commercial cryptographic algorithms and protocols as
part of its mission to support secure, interoperable communications for
US Government National Security Systems. To this end, it publishes
guidance to both (1) assist with the US Government transition to new
algorithms and (2) provide vendors \-- and the Internet community in
general \-- with information concerning their proper use and
configuration.[¶](#section-3-1){.pilcrow}

Recently, cryptographic transition plans have become overshadowed by the
prospect of the development of a cryptographically relevant quantum
computer. The NSA has established the Commercial National Security
Algorithm (CNSA) Suite to provide vendors and IT users near-term
flexibility in meeting their information assurance interoperability
requirements. The purpose behind this flexibility is to avoid vendors
and customers making two major transitions in a relatively short
timeframe, as we anticipate a need to shift to quantum-resistant
cryptography in the near future.[¶](#section-3-2){.pilcrow}

The NSA is authoring a set of RFCs, including this one, to provide
updated guidance concerning the use of certain commonly available
commercial algorithms in IETF protocols. These RFCs can be used in
conjunction with other RFCs and cryptographic guidance (e.g., NIST
Special Publications) to properly protect Internet traffic and
data-at-rest for US Government National Security
Systems.[¶](#section-3-3){.pilcrow}
:::
:::

::: {#overview}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [CNSA-Compliant IPsec Overview](#name-cnsa-compliant-ipsec-overvi){.section-name .selfRef} {#name-cnsa-compliant-ipsec-overvi}

CNSA-compliant implementations for IPsec [MUST]{.bcp14} use IKEv2
\[[RFC7296](#RFC7296){.xref}\].[¶](#section-4-1){.pilcrow}

Implementing a CNSA-compliant IPsec system requires cryptographic
algorithm selection for both the IKEv2 and ESP protocols. The following
CNSA requirements apply to IPsec:[¶](#section-4-2){.pilcrow}

Encryption:[¶](#section-4-3){.pilcrow}

-   [AES \[[FIPS197](#FIPS197){.xref}\] (with key size 256
    bits)[¶](#section-4-4.1){.pilcrow}]{#section-4-4.1}

Digital Signature:[¶](#section-4-5){.pilcrow}

-   [ECDSA \[[FIPS186](#FIPS186){.xref}\] (using the NIST P-384 elliptic
    curve)[¶](#section-4-6.1){.pilcrow}]{#section-4-6.1}
-   [RSA \[[FIPS186](#FIPS186){.xref}\] (with a modulus of 3072 bits or
    larger)[¶](#section-4-6.2){.pilcrow}]{#section-4-6.2}

Key Establishment:[¶](#section-4-7){.pilcrow}

-   [ECDH \[[SP80056A](#SP80056A){.xref}\] (using the NIST P-384
    elliptic curve)[¶](#section-4-8.1){.pilcrow}]{#section-4-8.1}
-   [DH \[[RFC3526](#RFC3526){.xref}\] (with a prime modulus of 3072 or
    larger)[¶](#section-4-8.2){.pilcrow}]{#section-4-8.2}

To facilitate selection of appropriate combinations of compliant
algorithms, this document provides CNSA-compliant User Interface suites
(UI suites) \[[RFC4308](#RFC4308){.xref}\] to implement IPsec on
National Security Systems.[¶](#section-4-9){.pilcrow}

The approved CNSA hash function for all purposes is SHA-384, as defined
in \[[FIPS180](#FIPS180){.xref}\]. However, PRF_HMAC_SHA_512 is
specified for the IKEv2 Pseudorandom Function (PRF) instead of
PRF_HMAC_SHA_384, due to availability. See [Section 8](#sa){.xref}
below.[¶](#section-4-10){.pilcrow}

For CNSA Suite applications, public key certificates [MUST]{.bcp14} be
compliant with the CNSA Suite Certificate and CRL Profile specified in
\[[RFC8603](#RFC8603){.xref}\].[¶](#section-4-11){.pilcrow}

Under certain conditions, such as applications having long-lived
data-protection requirements, systems that do not comply with the
requirements of this document are acceptable; see [Section
12](#long-life){.xref}.[¶](#section-4-12){.pilcrow}
:::
:::

::: {#ui-suites}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IPsec User Interface Suites](#name-ipsec-user-interface-suites){.section-name .selfRef} {#name-ipsec-user-interface-suites}

User Interface (UI) suites \[[RFC4308](#RFC4308){.xref}\] are named
suites that cover some typical security policy options for IPsec. Use of
UI suites does not change the IPsec protocol in any way. The following
UI suites provide cryptographic algorithm choices for ESP
\[[RFC4303](#RFC4303){.xref}\] and for IKEv2
\[[RFC7296](#RFC7296){.xref}\]. The selection of a UI suite will depend
on the key exchange algorithm. The suite names indicate the Advanced
Encryption Standard \[[FIPS197](#FIPS197){.xref}\] mode, AES key length
specified for encryption, and the key exchange
algorithm.[¶](#section-5-1){.pilcrow}

Although RSA is also a CNSA-approved key establishment algorithm, only
DH and ECDH are specified for key exchange in IKEv2
\[[RFC7296](#RFC7296){.xref}\]. RSA in IPsec is used only for digital
signatures. See [Section
6](#ikev2-authn){.xref}.[¶](#section-5-2){.pilcrow}

ESP requires negotiation of both a confidentiality algorithm and an
integrity algorithm. However, algorithms for Authenticated Encryption
with Associated Data (AEAD) \[[RFC5116](#RFC5116){.xref}\] do not
require a separate integrity algorithm to be negotiated. In particular,
since AES-GCM is an AEAD algorithm, ESP implementing AES-GCM
[MUST]{.bcp14} either offer no integrity algorithm or indicate the
single integrity algorithm NONE (see [Section
3.3](https://www.rfc-editor.org/rfc/rfc7296#section-3.3){.relref} of
\[[RFC7296](#RFC7296){.xref}\]).[¶](#section-5-3){.pilcrow}

To be CNSA compliant, IPsec implementations that use the following UI
suites [MUST]{.bcp14} use the suite names listed below. IPsec
implementations [SHOULD NOT]{.bcp14} use names different than those
listed here for the suites that are described and [MUST NOT]{.bcp14} use
the names listed here for suites that do not match these values. These
requirements are necessary for
interoperability.[¶](#section-5-4){.pilcrow}

Transform names are as listed in the IANA \"Internet Key Exchange
Version 2 (IKEv2) Parameters\" registry. Definitions of the transforms
are contained in the references specified in that
registry.[¶](#section-5-5){.pilcrow}

Other UI suites may be acceptable for CNSA compliance. See [Section
8](#sa){.xref} for details.[¶](#section-5-6){.pilcrow}

::: {#suite-ecdh}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Suite CNSA-GCM-256-ECDH-384](#name-suite-cnsa-gcm-256-ecdh-384){.section-name .selfRef} {#name-suite-cnsa-gcm-256-ecdh-384}

[]{.break}

ESP SA:
:   []{.break}

    Encryption:
    :   ENCR_AES_GCM_16 (with key size 256
        bits)[¶](#section-5.1-1.2.1.2){.pilcrow}
    :   

    Integrity:
    :   NONE[¶](#section-5.1-1.2.1.4){.pilcrow}
    :   
:   

IKEv2 SA:
:   []{.break}

    Encryption:
    :   ENCR_AES_GCM_16 (with key size 256
        bits)[¶](#section-5.1-1.4.1.2){.pilcrow}
    :   

    PRF:
    :   PRF_HMAC_SHA2_512[¶](#section-5.1-1.4.1.4){.pilcrow}
    :   

    Integrity:
    :   NONE[¶](#section-5.1-1.4.1.6){.pilcrow}
    :   

    Diffie-Hellman group:
    :   384-bit random ECP group[¶](#section-5.1-1.4.1.8){.pilcrow}
    :   
:   
:::
:::

::: {#suite-dh3k}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Suite CNSA-GCM-256-DH-3072](#name-suite-cnsa-gcm-256-dh-3072){.section-name .selfRef} {#name-suite-cnsa-gcm-256-dh-3072}

[]{.break}

ESP SA:
:   []{.break}

    Encryption:
    :   ENCR_AES_GCM_16 (with key size 256
        bits)[¶](#section-5.2-1.2.1.2){.pilcrow}
    :   

    Integrity:
    :   NONE[¶](#section-5.2-1.2.1.4){.pilcrow}
    :   
:   

IKEv2 SA:
:   []{.break}

    Encryption:
    :   ENCR_AES_GCM_16 (with key size 256
        bits)[¶](#section-5.2-1.4.1.2){.pilcrow}
    :   

    PRF:
    :   PRF_HMAC_SHA2_512[¶](#section-5.2-1.4.1.4){.pilcrow}
    :   

    Integrity:
    :   NONE[¶](#section-5.2-1.4.1.6){.pilcrow}
    :   

    Diffie-Hellman group:
    :   3072-bit MODP group[¶](#section-5.2-1.4.1.8){.pilcrow}
    :   
:   
:::
:::

::: {#suite-dh4k}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Suite CNSA-GCM-256-DH-4096](#name-suite-cnsa-gcm-256-dh-4096){.section-name .selfRef} {#name-suite-cnsa-gcm-256-dh-4096}

[]{.break}

ESP SA:
:   []{.break}

    Encryption:
    :   ENCR_AES_GCM_16 (with key size 256
        bits)[¶](#section-5.3-1.2.1.2){.pilcrow}
    :   

    Integrity:
    :   NONE[¶](#section-5.3-1.2.1.4){.pilcrow}
    :   
:   

IKEv2 SA:
:   []{.break}

    Encryption:
    :   ENCR_AES_GCM_16 (with key size 256
        bits)[¶](#section-5.3-1.4.1.2){.pilcrow}
    :   

    PRF:
    :   PRF_HMAC_SHA2_512[¶](#section-5.3-1.4.1.4){.pilcrow}
    :   

    Integrity:
    :   NONE[¶](#section-5.3-1.4.1.6){.pilcrow}
    :   

    Diffie-Hellman group:
    :   4096-bit MODP group[¶](#section-5.3-1.4.1.8){.pilcrow}
    :   
:   
:::
:::
:::
:::

::: {#ikev2-authn}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IKEv2 Authentication](#name-ikev2-authentication){.section-name .selfRef} {#name-ikev2-authentication}

Authentication of the IKEv2 Security Association (SA) requires
computation of a digital signature. To be CNSA compliant, digital
signatures [MUST]{.bcp14} be generated with SHA-384 as defined in
\[[RFC8017](#RFC8017){.xref}\] together with either ECDSA-384 as defined
in \[[RFC4754](#RFC4754){.xref}\] or RSA with 3072-bit or greater
modulus. (For applications with long data-protection requirements,
somewhat different rules apply; see [Section
12](#long-life){.xref}.)[¶](#section-6-1){.pilcrow}

Initiators and responders [MUST]{.bcp14} be able to verify ECDSA-384
signatures and [MUST]{.bcp14} be able to verify RSA with 3072-bit or
4096-bit modulus and SHA-384 signatures.[¶](#section-6-2){.pilcrow}

For CNSA-compliant systems, authentication methods other than ECDSA-384
or RSA [MUST NOT]{.bcp14} be accepted for IKEv2 authentication. A
3072-bit modulus or larger [MUST]{.bcp14} be used for RSA. If the
relying party receives a message signed with any authentication method
other than an ECDSA-384 or RSA signature, it [MUST]{.bcp14} return an
AUTHENTICATION_FAILED notification and stop processing the message. If
the relying party receives a message signed with RSA using less than a
3072-bit modulus, it [MUST]{.bcp14} return an AUTHENTICATION_FAILED
notification and stop processing the message.[¶](#section-6-3){.pilcrow}
:::
:::

::: {#certs}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Certificates](#name-certificates){.section-name .selfRef} {#name-certificates}

To be CNSA compliant, the initiator and responder [MUST]{.bcp14} use
X.509 certificates that comply with \[[RFC8603](#RFC8603){.xref}\]. Peer
authentication decisions must be based on the Subject or Subject
Alternative Name from the certificate that contains the key used to
validate the signature in the Authentication Payload as defined in
[Section
3.8](https://www.rfc-editor.org/rfc/rfc7296#section-3.8){.relref} of
\[[RFC7296](#RFC7296){.xref}\], rather than the Identification Data from
the Identification Payload that is used to look up
policy.[¶](#section-7-1){.pilcrow}
:::
:::

::: {#sa}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [IKEv2 Security Associations (SAs)](#name-ikev2-security-associations){.section-name .selfRef} {#name-ikev2-security-associations}

[Section 5](#ui-suites){.xref} specifies three UI suites for ESP and
IKEv2 Security Associations. All three use AES-GCM for encryption but
differ in the key exchange algorithm. Galois/Counter Mode (GCM)
\[[RFC4106](#RFC4106){.xref}\] combines counter (CTR) mode with a
secure, parallelizable, and efficient authentication mechanism. Since
AES-GCM is an AEAD algorithm, ESP implements AES-GCM with no additional
integrity algorithm (see [Section
3.3](https://www.rfc-editor.org/rfc/rfc7296#section-3.3){.relref} of
\[[RFC7296](#RFC7296){.xref}\]).[¶](#section-8-1){.pilcrow}

An initiator proposal [SHOULD]{.bcp14} be constructed from one or more
of the following suites:[¶](#section-8-2){.pilcrow}

-   [CNSA-GCM-256-ECDH-384[¶](#section-8-3.1){.pilcrow}]{#section-8-3.1}
-   [CNSA-GCM-256-DH-3072[¶](#section-8-3.2){.pilcrow}]{#section-8-3.2}
-   [CNSA-GCM-256-DH-4096[¶](#section-8-3.3){.pilcrow}]{#section-8-3.3}

A responder [SHOULD]{.bcp14} accept proposals constructed from at least
one of the three named suites. Other UI suites may result in acceptable
proposals (such as those based on PRF_HMAC_SHA2_384); however, these are
provided to promote interoperability.[¶](#section-8-4){.pilcrow}

Nonce construction for AES-GCM using a misuse-resistant technique
\[[RFC8452](#RFC8452){.xref}\] conforms with the requirements of this
document and [MAY]{.bcp14} be used if a Federal Information Processing
Standard (FIPS) validated implementation is
available.[¶](#section-8-5){.pilcrow}

The named UI suites specify PRF_HMAC_SHA2_512 for the IKEv2 SA PRF
transform, as PRF_HMAC_SHA2_384 is not listed among required PRF
transforms in \[[RFC8247](#RFC8247){.xref}\]; therefore, implementation
of the latter is likely to be scarce. The security level of
PRF_HMAC_SHA2_512 is comparable, and the difference in performance is
negligible. However, SHA-384 is the official CNSA algorithm for
computing a condensed representation of information. Therefore, the
PRF_HMAC_SHA2_384 transform is CNSA compliant if it is available to the
initiator and responder. Any PRF transform other than PRF_HMAC_SHA2_384
or PRF_HMAC_SHA2_512 [MUST NOT]{.bcp14} be
used.[¶](#section-8-6){.pilcrow}

If none of the proposals offered by the initiator consist solely of
transforms based on CNSA algorithms (such as those in the UI suites
defined in [Section 5](#ui-suites){.xref}), the responder [MUST]{.bcp14}
return a Notify payload with the error NO_PROPOSAL_CHOSEN when operating
in CNSA-compliant mode.[¶](#section-8-7){.pilcrow}
:::
:::

::: {#ike-sa-init}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [The Key Exchange Payload in the IKE_SA_INIT Exchange](#name-the-key-exchange-payload-in){.section-name .selfRef} {#name-the-key-exchange-payload-in}

The key exchange payload is used to exchange Diffie-Hellman public
numbers as part of a Diffie-Hellman key exchange. The CNSA-compliant
initiator and responder [MUST]{.bcp14} each generate an ephemeral key
pair to be used in the key exchange.[¶](#section-9-1){.pilcrow}

If the Elliptic Curve Diffie-Hellman (ECDH) key exchange is selected for
the SA, the initiator and responder both [MUST]{.bcp14} generate an
elliptic curve (EC) key pair using the P-384 elliptic curve. The
ephemeral public keys [MUST]{.bcp14} be stored in the key exchange
payload as described in
\[[RFC5903](#RFC5903){.xref}\].[¶](#section-9-2){.pilcrow}

If the Diffie-Hellman (DH) key exchange is selected for the SA, the
initiator and responder both [MUST]{.bcp14} generate a key pair using
the appropriately sized MODP group as described in
\[[RFC3526](#RFC3526){.xref}\]. The size of the MODP group will be
determined by the selection of either a 3072-bit or greater modulus for
the SA.[¶](#section-9-3){.pilcrow}
:::
:::

::: {#ikesa-keygen}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Generating Key Material for the IKE SA](#name-generating-key-material-for){.section-name .selfRef} {#name-generating-key-material-for}

As noted in [Section
7](https://www.rfc-editor.org/rfc/rfc5903#section-7){.relref} of
\[[RFC5903](#RFC5903){.xref}\], the shared secret result of an ECDH key
exchange is the 384-bit x value of the ECDH common value. The shared
secret result of a DH key exchange is the number of octets needed to
accommodate the prime (e.g., 384 octets for 3072-bit MODP group) with
leading zeros as necessary, as described in [Section
2.1.2](https://www.rfc-editor.org/rfc/rfc2631#section-2.1.2){.relref} of
\[[RFC2631](#RFC2631){.xref}\].[¶](#section-10-1){.pilcrow}

IKEv2 allows for the reuse of Diffie-Hellman private keys; see [Section
2.12](https://www.rfc-editor.org/rfc/rfc7296#section-2.12){.relref} of
\[[RFC7296](#RFC7296){.xref}\]. However, there are security concerns
related to this practice. Section 5.6.3.3 of
\[[SP80056A](#SP80056A){.xref}\] states that an ephemeral private key
[MUST]{.bcp14} be used in exactly one key establishment transaction and
[MUST]{.bcp14} be destroyed (zeroized) as soon as possible. Section 5.8
of \[[SP80056A](#SP80056A){.xref}\] states that any shared secret
derived from key establishment [MUST]{.bcp14} be destroyed (zeroized)
immediately after its use. CNSA-compliant IPsec systems [MUST]{.bcp14}
follow the mandates in
\[[SP80056A](#SP80056A){.xref}\].[¶](#section-10-2){.pilcrow}
:::
:::

::: {#addl-reqt}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [Additional Requirements](#name-additional-requirements){.section-name .selfRef} {#name-additional-requirements}

The IPsec protocol AH [MUST NOT]{.bcp14} be used in CNSA-compliant
implementations.[¶](#section-11-1){.pilcrow}

A Diffie-Hellman group [MAY]{.bcp14} be negotiated for a Child SA as
described in [Section
1.3](https://www.rfc-editor.org/rfc/rfc7296#section-1.3){.relref} of
\[[RFC7296](#RFC7296){.xref}\], allowing peers to employ Diffie-Hellman
in the CREATE_CHILD_SA exchange. If a transform of type 4 is specified
for an SA for ESP, the value of that transform [MUST]{.bcp14} match the
value of the transform used by the IKEv2 SA.[¶](#section-11-2){.pilcrow}

Per \[[RFC7296](#RFC7296){.xref}\], if a CREATE_CHILD_SA exchange
includes a KEi payload, at least one of the SA offers [MUST]{.bcp14}
include the Diffie-Hellman group of the KEi. For CNSA-compliant IPsec
implementations, the Diffie-Hellman group of the KEi [MUST]{.bcp14} use
the same group used in the IKE_INIT_SA.[¶](#section-11-3){.pilcrow}

For IKEv2, rekeying of the CREATE_CHILD_SA [MUST]{.bcp14} be supported
by both parties. The initiator of this exchange [MAY]{.bcp14} include a
new Diffie-Hellman key; if it is included, it [MUST]{.bcp14} use the
same group used in the IKE_INIT_SA. If the initiator of the exchange
includes a Diffie-Hellman key, the responder [MUST]{.bcp14} include a
Diffie-Hellman key, and it [MUST]{.bcp14} use the same
group.[¶](#section-11-4){.pilcrow}

For CNSA-compliant systems, the IKEv2 authentication method
[MUST]{.bcp14} use an end-entity certificate provided by the
authenticating party. Identification Payloads (IDi and IDr) in the
IKE_AUTH exchanges [MUST NOT]{.bcp14} be used for the IKEv2
authentication method but may be used for policy
lookup.[¶](#section-11-5){.pilcrow}

The administrative User Interface (UI) for a system that conforms to
this profile [MUST]{.bcp14} allow the operator to specify a single
suite. If only one suite is specified in the administrative UI, the
IKEv2 implementation [MUST]{.bcp14} only offer algorithms for that one
suite.[¶](#section-11-6){.pilcrow}

The administrative UI [MAY]{.bcp14} allow the operator to specify more
than one suite; if it allows this, it [MUST]{.bcp14} allow the operator
to specify a preferred order for the suites that are to be offered or
accepted. If more than one suite is specified in the administrative UI,
the IKEv2 implementation [MUST]{.bcp14} only offer algorithms of those
suites. (Note that although this document does not define a UI suite
specifying PRF_HMAC_SHA2_384, a proposal containing such a transform is
CNSA compliant.)[¶](#section-11-7){.pilcrow}
:::
:::

::: {#long-life}
::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [Guidance for Applications with Long Data-Protection Requirements](#name-guidance-for-applications-w){.section-name .selfRef} {#name-guidance-for-applications-w}

The CNSA mandate is to continue to use current algorithms with increased
security parameters, then transition to approved post-quantum resilient
algorithms when they are identified. However, some applications have
data-in-transit-protection requirements that are long enough that
post-quantum resilient protection must be provided now. Lacking approved
asymmetric post-quantum resilient confidentiality algorithms, that means
approved symmetric techniques must be used as described in this section
until approved post-quantum resilient asymmetric algorithms are
identified.[¶](#section-12-1){.pilcrow}

For new applications, confidentiality and integrity requirements from
the sections above [MUST]{.bcp14} be followed, with the addition of a
Pre-Shared Key (PSK) mixed in as defined in
\[[RFC8784](#RFC8784){.xref}\].[¶](#section-12-2){.pilcrow}

Installations currently using IKEv1 with PSKs [MUST]{.bcp14} (1) use AES
in cipher block chaining mode (AES-CBC) in conjunction with a
CNSA-compliant integrity algorithm (e.g., AUTH_HMAC_SHA2_384_192) and
(2) transition to IKEv2 with PSKs \[[RFC8784](#RFC8784){.xref}\] as soon
as implementations become available.[¶](#section-12-3){.pilcrow}

Specific guidance for systems not compliant with the requirements of
this document, including non-GCM modes and PSK length, and PSK
randomness, will be defined in solution-specific requirements
appropriate to the application. Details of those requirements will
depend on the program under which the commercial National Security
Systems solution is developed (e.g., an NSA Commercial Solutions for
Classified Capability Package).[¶](#section-12-4){.pilcrow}
:::
:::

::: {#sec-considerations}
::: {#section-13 .section}
## [13.](#section-13){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document inherits all of the security considerations of the IPsec
and IKEv2 documents, including \[[RFC7296](#RFC7296){.xref}\],
\[[RFC4303](#RFC4303){.xref}\], \[[RFC4754](#RFC4754){.xref}\], and
\[[RFC8221](#RFC8221){.xref}\].[¶](#section-13-1){.pilcrow}

The security of a system that uses cryptography depends on both the
strength of the cryptographic algorithms chosen and the strength of the
keys used with those algorithms. The security also depends on the
engineering and administration of the protocol used by the system to
ensure that there are no non-cryptographic ways to bypass the security
of the overall system.[¶](#section-13-2){.pilcrow}

When selecting a mode for the AES encryption
\[[RFC5116](#RFC5116){.xref}\], be aware that nonce reuse can result in
a loss of confidentiality. Nonce reuse is catastrophic for GCM, since it
also results in a loss of integrity.[¶](#section-13-3){.pilcrow}
:::
:::

::: {#iana}
::: {#section-14 .section}
## [14.](#section-14){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

IANA has added the UI suites defined in this document to the
\"Cryptographic Suites for IKEv1, IKEv2, and IPsec\" registry located at
\<<https://www.iana.org/assignments/crypto-suites>\>:[¶](#section-14-1){.pilcrow}

  Identifier              Reference
  ----------------------- -----------
  CNSA-GCM-256-ECDH-384   RFC 9206
  CNSA-GCM-256-DH-3072    RFC 9206
  CNSA-GCM-256-DH-4096    RFC 9206

  : [Table 1](#table-1){.selfRef}
:::
:::

::: {#section-15 .section}
## [15.](#section-15){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-15.1 .section}
### [15.1.](#section-15.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[CNSA\]
:   [Committee for National Security Systems]{.refAuthor}, [\"Use of
    Public Standards for Secure Information Sharing\"]{.refTitle},
    [CNSSP 15]{.refContent}, October 2016,
    \<<https://www.cnss.gov/CNSS/Issuances/Policies.htm>\>.
:   

\[FIPS180\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Secure Hash Standard (SHS)\"]{.refTitle}, [Federal Information
    Processing Standard 180-4]{.refContent}, [DOI
    10.6028/NIST.FIPS.180-4]{.seriesInfo}, August 2015,
    \<<https://csrc.nist.gov/publications/detail/fips/180/4/final>\>.
:   

\[FIPS186\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Digital Signature Standard (DSS)\"]{.refTitle}, [NIST Federal
    Information Processing Standard 186-4]{.refContent}, [DOI
    10.6028/NIST.FIPS.186-4]{.seriesInfo}, July 2013,
    \<<https://csrc.nist.gov/publications/detail/fips/186/4/final>\>.
:   

\[FIPS197\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Advanced Encryption Standard (AES)\"]{.refTitle}, [Federal
    Information Processing Standard 197]{.refContent}, [DOI
    10.6028/NIST.FIPS.197]{.seriesInfo}, November 2001,
    \<<https://csrc.nist.gov/publications/detail/fips/197/final>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2631\]
:   [Rescorla, E.]{.refAuthor}, [\"Diffie-Hellman Key Agreement
    Method\"]{.refTitle}, [RFC 2631]{.seriesInfo}, [DOI
    10.17487/RFC2631]{.seriesInfo}, June 1999,
    \<<https://www.rfc-editor.org/info/rfc2631>\>.
:   

\[RFC3526\]
:   [Kivinen, T.]{.refAuthor} and [M. Kojo]{.refAuthor}, [\"More Modular
    Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange
    (IKE)\"]{.refTitle}, [RFC 3526]{.seriesInfo}, [DOI
    10.17487/RFC3526]{.seriesInfo}, May 2003,
    \<<https://www.rfc-editor.org/info/rfc3526>\>.
:   

\[RFC4106\]
:   [Viega, J.]{.refAuthor} and [D. McGrew]{.refAuthor}, [\"The Use of
    Galois/Counter Mode (GCM) in IPsec Encapsulating Security Payload
    (ESP)\"]{.refTitle}, [RFC 4106]{.seriesInfo}, [DOI
    10.17487/RFC4106]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4106>\>.
:   

\[RFC4303\]
:   [Kent, S.]{.refAuthor}, [\"IP Encapsulating Security Payload
    (ESP)\"]{.refTitle}, [RFC 4303]{.seriesInfo}, [DOI
    10.17487/RFC4303]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4303>\>.
:   

\[RFC4308\]
:   [Hoffman, P.]{.refAuthor}, [\"Cryptographic Suites for
    IPsec\"]{.refTitle}, [RFC 4308]{.seriesInfo}, [DOI
    10.17487/RFC4308]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4308>\>.
:   

\[RFC4754\]
:   [Fu, D.]{.refAuthor} and [J. Solinas]{.refAuthor}, [\"IKE and IKEv2
    Authentication Using the Elliptic Curve Digital Signature Algorithm
    (ECDSA)\"]{.refTitle}, [RFC 4754]{.seriesInfo}, [DOI
    10.17487/RFC4754]{.seriesInfo}, January 2007,
    \<<https://www.rfc-editor.org/info/rfc4754>\>.
:   

\[RFC5116\]
:   [McGrew, D.]{.refAuthor}, [\"An Interface and Algorithms for
    Authenticated Encryption\"]{.refTitle}, [RFC 5116]{.seriesInfo},
    [DOI 10.17487/RFC5116]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5116>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}, [Santesson, S.]{.refAuthor},
    [Farrell, S.]{.refAuthor}, [Boeyen, S.]{.refAuthor},
    [Housley, R.]{.refAuthor}, and [W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC5903\]
:   [Fu, D.]{.refAuthor} and [J. Solinas]{.refAuthor}, [\"Elliptic Curve
    Groups modulo a Prime (ECP Groups) for IKE and IKEv2\"]{.refTitle},
    [RFC 5903]{.seriesInfo}, [DOI 10.17487/RFC5903]{.seriesInfo}, June
    2010, \<<https://www.rfc-editor.org/info/rfc5903>\>.
:   

\[RFC7296\]
:   [Kaufman, C.]{.refAuthor}, [Hoffman, P.]{.refAuthor},
    [Nir, Y.]{.refAuthor}, [Eronen, P.]{.refAuthor}, and [T.
    Kivinen]{.refAuthor}, [\"Internet Key Exchange Protocol Version 2
    (IKEv2)\"]{.refTitle}, [STD 79]{.seriesInfo}, [RFC
    7296]{.seriesInfo}, [DOI 10.17487/RFC7296]{.seriesInfo}, October
    2014, \<<https://www.rfc-editor.org/info/rfc7296>\>.
:   

\[RFC8017\]
:   [Moriarty, K., Ed.]{.refAuthor}, [Kaliski, B.]{.refAuthor},
    [Jonsson, J.]{.refAuthor}, and [A. Rusch]{.refAuthor}, [\"PKCS #1:
    RSA Cryptography Specifications Version 2.2\"]{.refTitle}, [RFC
    8017]{.seriesInfo}, [DOI 10.17487/RFC8017]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8017>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8221\]
:   [Wouters, P.]{.refAuthor}, [Migault, D.]{.refAuthor},
    [Mattsson, J.]{.refAuthor}, [Nir, Y.]{.refAuthor}, and [T.
    Kivinen]{.refAuthor}, [\"Cryptographic Algorithm Implementation
    Requirements and Usage Guidance for Encapsulating Security Payload
    (ESP) and Authentication Header (AH)\"]{.refTitle}, [RFC
    8221]{.seriesInfo}, [DOI 10.17487/RFC8221]{.seriesInfo}, October
    2017, \<<https://www.rfc-editor.org/info/rfc8221>\>.
:   

\[RFC8247\]
:   [Nir, Y.]{.refAuthor}, [Kivinen, T.]{.refAuthor},
    [Wouters, P.]{.refAuthor}, and [D. Migault]{.refAuthor},
    [\"Algorithm Implementation Requirements and Usage Guidance for the
    Internet Key Exchange Protocol Version 2 (IKEv2)\"]{.refTitle}, [RFC
    8247]{.seriesInfo}, [DOI 10.17487/RFC8247]{.seriesInfo}, September
    2017, \<<https://www.rfc-editor.org/info/rfc8247>\>.
:   

\[RFC8603\]
:   [Jenkins, M.]{.refAuthor} and [L. Zieglar]{.refAuthor},
    [\"Commercial National Security Algorithm (CNSA) Suite Certificate
    and Certificate Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    8603]{.seriesInfo}, [DOI 10.17487/RFC8603]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8603>\>.
:   

\[RFC8784\]
:   [Fluhrer, S.]{.refAuthor}, [Kampanakis, P.]{.refAuthor},
    [McGrew, D.]{.refAuthor}, and [V. Smyslov]{.refAuthor}, [\"Mixing
    Preshared Keys in the Internet Key Exchange Protocol Version 2
    (IKEv2) for Post-quantum Security\"]{.refTitle}, [RFC
    8784]{.seriesInfo}, [DOI 10.17487/RFC8784]{.seriesInfo}, June 2020,
    \<<https://www.rfc-editor.org/info/rfc8784>\>.
:   

\[SP80056A\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Recommendation for Pair-Wise Key Establishment Schemes Using
    Discrete Logarithm Cryptography\"]{.refTitle}, [NIST Special
    Publication 800-56A, Revision 3]{.refContent}, [DOI
    10.6028/NIST.SP.800-56Ar3]{.seriesInfo}, April 2018,
    \<<https://csrc.nist.gov/publications/detail/sp/800-56a/rev-3/final>\>.
:   
:::

::: {#section-15.2 .section}
### [15.2.](#section-15.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC8452\]
:   [Gueron, S.]{.refAuthor}, [Langley, A.]{.refAuthor}, and [Y.
    Lindell]{.refAuthor}, [\"AES-GCM-SIV: Nonce Misuse-Resistant
    Authenticated Encryption\"]{.refTitle}, [RFC 8452]{.seriesInfo},
    [DOI 10.17487/RFC8452]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8452>\>.
:   

\[SP80059\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Guideline for Identifying an Information System as a National
    Security System\"]{.refTitle}, [Special Publication
    800-59]{.refContent}, [DOI 10.6028/NIST.SP.800-59]{.seriesInfo},
    August 2003,
    \<<https://csrc.nist.gov/publications/detail/sp/800-59/final>\>.
:   
:::
:::

::: {#authors-addresses}
::: {#appendix-A .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Laura Corcoran]{.fn .nameRole}
:::

::: {.left dir="auto"}
[National Security Agency]{.org}
:::

::: email
Email: <lscorco@nsa.gov>
:::

::: {.left dir="auto"}
[Michael Jenkins]{.fn .nameRole}
:::

::: {.left dir="auto"}
[National Security Agency - Center for Cybersecurity Standards]{.org}
:::

::: email
Email: <mjjenki@cyber.nsa.gov>
:::
:::
:::
