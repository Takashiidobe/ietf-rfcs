  RFC 9152           SODP Server Interfaces   April 2022
  ------------------ ------------------------ ------------
  Jenkins & Turner   Informational            \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Independent Submission

RFC:
:   [9152](https://www.rfc-editor.org/rfc/rfc9152){.eref}

Category:
:   Informational

Published:
:   April 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    M. Jenkins
    :::

    ::: org
    NSA
    :::
    :::

    ::: author
    ::: author-name
    S. Turner
    :::

    ::: org
    sn3rd
    :::
    :::
:::

# RFC 9152 {#rfcnum}

# Secure Object Delivery Protocol (SODP) Server Interfaces: NSA\'s Profile for Delivery of Certificates, Certificate Revocation Lists (CRLs), and Symmetric Keys to Clients {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies protocol interfaces profiled by the United
States National Security Agency (NSA) for National Security System (NSS)
servers that provide public key certificates, Certificate Revocation
Lists (CRLs), and symmetric keys to NSS clients. Servers that support
these interfaces are referred to as Secure Object Delivery Protocol
(SODP) servers. The intended audience for this profile comprises
developers of client devices that will obtain key management services
from NSA-operated SODP servers. Interfaces supported by SODP servers
include Enrollment over Secure Transport (EST) and its extensions as
well as Certificate Management over CMS
(CMC).[¶](#section-abstract-1){.pilcrow}

This profile applies to the capabilities, configuration, and operation
of all components of US National Security Systems (SP 800-59). It is
also appropriate for other US Government systems that process high-value
information. It is made publicly available for use by developers and
operators of these and any other system
deployments.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This is a contribution to the RFC Series, independently of any other RFC
stream. The RFC Editor has chosen to publish this document at its
discretion and makes no statement about its value for implementation or
deployment. Documents approved for publication by the RFC Editor are not
candidates for any level of Internet Standard; see Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9152>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Documents to be Familiar
        With](#name-documents-to-be-familiar-wi){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Document
        Organization](#name-document-organization){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.3}
        [1.3](#section-1.3){.xref}.  [Environment](#name-environment){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Abstract Syntax Notation
    One](#name-abstract-syntax-notation-on){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [EST Interface](#name-est-interface){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Hypertext Transfer Protocol
        Layer](#name-hypertext-transfer-protocol){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Transport Layer
        Security](#name-transport-layer-security){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Eligibility](#name-eligibility){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Authentication](#name-authentication){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Authorization](#name-authorization){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [EST and EST
        Extensions](#name-est-and-est-extensions){.xref}

        -   ::: {#section-toc.1-1.3.2.6.2.1}
            [3.6.1](#section-3.6.1){.xref}.  [/pal](#name-pal){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.2}
            [3.6.2](#section-3.6.2){.xref}.  [/cacerts](#name-cacerts){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.3}
            [3.6.3](#section-3.6.3){.xref}.  [/simpleenroll](#name-simpleenroll){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.4}
            [3.6.4](#section-3.6.4){.xref}.  [/simplereenroll](#name-simplereenroll){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.5}
            [3.6.5](#section-3.6.5){.xref}.  [/fullcmc](#name-fullcmc){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.6}
            [3.6.6](#section-3.6.6){.xref}.  [/serverkeygen](#name-serverkeygen){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.7}
            [3.6.7](#section-3.6.7){.xref}.  [/csrattrs](#name-csrattrs){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.8}
            [3.6.8](#section-3.6.8){.xref}.  [/crls](#name-crls){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.9}
            [3.6.9](#section-3.6.9){.xref}.  [/symmetrickeys](#name-symmetrickeys){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.6.2.10}
            [3.6.10](#section-3.6.10){.xref}. [/eecerts, /firmware,
            /tamp](#name-eecerts-firmware-tamp){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [CMC Interface](#name-cmc-interface){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [RFC 5273 Transport
        Protocols](#name-rfc-5273-transport-protocol){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Eligibility](#name-eligibility-2){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Authentication](#name-authentication-2){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Authorization](#name-authorization-2){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [Full PKI
        Requests/Responses](#name-full-pki-requests-responses){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Trust Anchor
    Profile](#name-trust-anchor-profile){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Non-Self-Signed Certification Authority
    Certificate Profile](#name-non-self-signed-certificati){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [End-Entity Certificate
    Profile](#name-end-entity-certificate-prof){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Source of Authority Certificate
        Profile](#name-source-of-authority-certifi){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Client Certificate
        Profile](#name-client-certificate-profile){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Relying Party
    Applications](#name-relying-party-applications){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [CRL Profile](#name-crl-profile){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.12.2.1}
        [12.1](#section-12.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [12.2](#section-12.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [](#appendix-A){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#sect-1}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document specifies protocol interfaces profiled by the United
States National Security Agency (NSA) for National Security System (NSS)
servers that provide public key certificates, Certificate Revocation
Lists (CRLs), and symmetric keys to NSS clients. Servers that support
these interfaces are referred to as Secure Object Delivery Protocol
(SODP) servers. The purpose of this document is to indicate options
from, and requirements in addition to, the base specifications listed in
[Section 1.1](#sect-1.1){.xref} that are necessary for client
interoperability with NSA-operated SODP servers. Clients are always
devices and need not implement all of the interfaces specified herein;
clients are free to choose which interfaces to implement based on their
operational requirements. Interfaces supported by SODP servers
include:[¶](#section-1-1){.pilcrow}

-   [Enrollment over Secure Transport (EST)
    \[[RFC7030](#RFC7030){.xref}\] and its extensions
    \[[RFC8295](#RFC8295){.xref}\],
    and[¶](#section-1-2.1){.pilcrow}]{#section-1-2.1}
-   [Certificate Management over CMS (CMC)
    \[[RFC5274](#RFC5274){.xref}\] \[[RFC6402](#RFC6402){.xref}\] for
    both Simple Public Key Infrastructure (PKI) requests and responses
    (i.e., PKCS#10 requests and PKCS#7 responses) and Full PKI requests
    and responses.[¶](#section-1-2.2){.pilcrow}]{#section-1-2.2}

This profile applies to the capabilities, configuration, and operation
of all components of US National Security Systems
\[[SP-800-59](#SP-800-59){.xref}\]. It is also appropriate for other US
Government systems that process high-value information. It is made
publicly available for use by developers and operators of these and any
other system deployments.[¶](#section-1-3){.pilcrow}

This profile conforms to the existing requirements of the NSA\'s
Commercial National Security Algorithms (CNSAs). As operational needs
evolve over time, this profile will be updated to incorporate new
commercial algorithms and protocols as they are developed and approved
for use.[¶](#section-1-4){.pilcrow}

::: {#sect-1.1}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Documents to be Familiar With](#name-documents-to-be-familiar-wi){.section-name .selfRef} {#name-documents-to-be-familiar-wi}

Familiarity with the follow specifications is
assumed:[¶](#section-1.1-1){.pilcrow}

-   [EST and EST extensions: \[[RFC7030](#RFC7030){.xref}\] and
    \[[RFC8295](#RFC8295){.xref}\][¶](#section-1.1-2.1){.pilcrow}]{#section-1.1-2.1}
-   [PKI-related specifications: \[[RFC2986](#RFC2986){.xref}\],
    \[[RFC3739](#RFC3739){.xref}\], \[[RFC5274](#RFC5274){.xref}\],
    \[[RFC5280](#RFC5280){.xref}\], \[[RFC5912](#RFC5912){.xref}\],
    \[[RFC5913](#RFC5913){.xref}\], \[[RFC5916](#RFC5916){.xref}\],
    \[[RFC5917](#RFC5917){.xref}\], \[[RFC6010](#RFC6010){.xref}\], and
    \[[RFC6402](#RFC6402){.xref}\][¶](#section-1.1-2.2){.pilcrow}]{#section-1.1-2.2}
-   [Key-format-related specifications: \[[RFC5915](#RFC5915){.xref}\],
    \[[RFC5958](#RFC5958){.xref}\], \[[RFC5959](#RFC5959){.xref}\],
    \[[RFC6031](#RFC6031){.xref}\], \[[RFC6032](#RFC6032){.xref}\],
    \[[RFC6160](#RFC6160){.xref}\], \[[RFC6161](#RFC6161){.xref}\],
    \[[RFC6162](#RFC6162){.xref}\], \[[RFC7191](#RFC7191){.xref}\],
    \[[RFC7192](#RFC7192){.xref}\], \[[RFC7292](#RFC7292){.xref}\], and
    \[[RFC7906](#RFC7906){.xref}\][¶](#section-1.1-2.3){.pilcrow}]{#section-1.1-2.3}
-   [CMS-related (Cryptographic Message Syntax) documents:
    \[[RFC5652](#RFC5652){.xref}\] and
    \[[RFC6268](#RFC6268){.xref}\][¶](#section-1.1-2.4){.pilcrow}]{#section-1.1-2.4}
-   [CNSA-related documents: \[[RFC8603](#RFC8603){.xref}\],
    \[[RFC8755](#RFC8755){.xref}\], \[[RFC8756](#RFC8756){.xref}\], and
    \[[RFC9151](#RFC9151){.xref}\][¶](#section-1.1-2.5){.pilcrow}]{#section-1.1-2.5}

The requirements from RFCs apply throughout this profile and are
generally not repeated here. This document is purposely written without
using the requirements language described in
\[[RFC2119](#RFC2119){.xref}\] and
\[[RFC8174](#RFC8174){.xref}\].[¶](#section-1.1-3){.pilcrow}
:::
:::

::: {#sect-1.2}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Document Organization](#name-document-organization){.section-name .selfRef} {#name-document-organization}

The document is organized as follows:[¶](#section-1.2-1){.pilcrow}

-   [The remainder of this section describes the operational environment
    used by clients to retrieve secure
    objects.[¶](#section-1.2-2.1){.pilcrow}]{#section-1.2-2.1}
-   [[Section 2](#sect-2){.xref} specifies the Abstract Syntax Notation
    One (ASN.1) version
    used.[¶](#section-1.2-2.2){.pilcrow}]{#section-1.2-2.2}
-   [[Section 3](#sect-3){.xref} specifies SODP\'s EST
    interface.[¶](#section-1.2-2.3){.pilcrow}]{#section-1.2-2.3}
-   [[Section 4](#sect-4){.xref} specifies SODP\'s CMC
    interfaces.[¶](#section-1.2-2.4){.pilcrow}]{#section-1.2-2.4}
-   [Sections [5](#sect-5){.xref}-[7](#sect-7){.xref} specify Trust
    Anchor (TA), Certification Authority (CA), and End-Entity (EE)
    certificates,
    respectively.[¶](#section-1.2-2.5){.pilcrow}]{#section-1.2-2.5}
-   [Sections [8](#sect-8){.xref} and [9](#sect-9){.xref} specify
    Relying Party Applications and CRL Profile,
    respectively.[¶](#section-1.2-2.6){.pilcrow}]{#section-1.2-2.6}
:::
:::

::: {#sect-1.3}
::: {#section-1.3 .section}
### [1.3.](#section-1.3){.section-number .selfRef} [Environment](#name-environment){.section-name .selfRef} {#name-environment}

Clients obtain secure \"objects\" or \"packages\" from the
client-server-based environment. Objects/packages vary based on the
Source of Authority (SOA), but all objects are \"secured\" minimally
through the use of one or more digital signatures and zero or more
layers of encryption, as profiled in this document. An SOA is the
authority for the creation of objects that the client will recognize as
valid. An SOA can delegate its authority to other actors; delegation
occurs through the issuance of certificates. An object or package is the
generic term for certificates, certificate status information, and keys
(both asymmetric and symmetric). All of the objects except for the
certificates and certificate status information are directly
encapsulated in and protected by CMS content types. CMS content types
that provide security are referred to as \"CMS-protecting content
types\". All others are simply referred to as \"CMS content types\". All
secured objects are distributed either as CMS packages or as part of a
CMS package.[¶](#section-1.3-1){.pilcrow}

In the example depicted in [Figure
1](#ure-operating-environment-key-and-pki-sources-of-authority){.xref},
there are two SOAs: one for symmetric keys, as depicted by the Key Trust
Anchor (KTA), and one for public key certificates, as depicted by the
PKI Trust Anchor (TA). The KTA is responsible for the creation and
distribution of symmetric keys. The KTA delegates the creation and
distribution responsibilities to separate entities through the issuance
of certificates to a Key Source Authority (KSA) and a Key Distribution
Authority (KDA). The KSA generates the keys, digitally signs the keys,
and encrypts the key for the end client using CMS content types for each
step. The KDA distributes the KSA-generated and KSA-protected key to the
client; the key may also be signed by the KDA. The resulting CMS package
is provided to the client through the EST extension\'s /symmetrickey
service. The PKI TA is responsible for the creation, distribution, and
management of public key certificates. The PKI TA delegates these
responsibilities to Certification Authorities (CAs), and CAs, in turn,
are responsible for creating, distributing, and managing End-Entity (EE)
certificates. CAs distribute PKI-related information through the
/cacerts, /crls, /eecerts, /fullcmc, /simpleenroll, /simplereenroll, and
/csrattrs EST and EST extension services.[¶](#section-1.3-2){.pilcrow}

[]{#name-operating-environment-key-a}

::: {#ure-operating-environment-key-and-pki-sources-of-authority}
::: {#section-1.3-3.1 .alignLeft .art-text .artwork}
       +-----+                            +--------+
       | KTA |                            | PKI TA |
       +-----+                            +--------+
          |                                   |
          | Signs                             | Signs
          |                                   |
          +-------------+                     V
          |             |                   +----+
          V             V                   | CA |
       +-----+       +-----+                +----+
       | KSA |       | KDA |                   |
       +-----+       +-----+                   | Signs
          |           |                        |
          | Signs &   | Optionally             +---------------+
          | Encrypts  | Signs                  |               |
          |           |                        V               V
          |           |                +-------------+ +-------------+
          |           V                | Certificate | | Certificate |
      +---|-------------+              +-------------+ | Revocation  |
      |   V             | CMS Content                  | List        |
      | +-------------+ | Types                        +-------------+
      | | Key Package | |
      | +-------------+ |
      +-----------------+
:::

[Figure 1](#figure-1){.selfRef}: [Operating Environment (Key and PKI
Sources of Authority)](#name-operating-environment-key-a){.selfRef}
:::

For clients that support the CMC interface and not the EST interface,
the environment includes only the PKI TAs.[¶](#section-1.3-4){.pilcrow}
:::
:::
:::
:::

::: {#sect-2}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Abstract Syntax Notation One](#name-abstract-syntax-notation-on){.section-name .selfRef} {#name-abstract-syntax-notation-on}

Implementations of this specification use the 2002/2008 ASN.1 version;
2002/2008 ASN.1 modules can be found in \[[RFC5911](#RFC5911){.xref}\],
\[[RFC5912](#RFC5912){.xref}\], and \[[RFC6268](#RFC6268){.xref}\] (use
\[[RFC6268](#RFC6268){.xref}\] for the CMS syntax), while other
specifications already include the 2002/2008 ASN.1 along with the 1988
ASN.1. See [Section
1.1](https://www.rfc-editor.org/rfc/rfc6268#section-1.1){.relref} of
\[[RFC6268](#RFC6268){.xref}\] for a discussion about the differences
between the 2002 and 2008 ASN.1 versions.[¶](#section-2-1){.pilcrow}
:::
:::

::: {#sect-3}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [EST Interface](#name-est-interface){.section-name .selfRef} {#name-est-interface}

Client options for EST \[[RFC7030](#RFC7030){.xref}\] and EST extensions
\[[RFC8295](#RFC8295){.xref}\] are specified in this
section.[¶](#section-3-1){.pilcrow}

::: {#sect-3.1}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Hypertext Transfer Protocol Layer](#name-hypertext-transfer-protocol){.section-name .selfRef} {#name-hypertext-transfer-protocol}

Clients that receive redirection responses (3xx status codes) will
terminate the connection (\[[RFC7030](#RFC7030){.xref}\], [Section
3.2.1](https://www.rfc-editor.org/rfc/rfc7030#section-3.2.1){.relref}).[¶](#section-3.1-1){.pilcrow}

Per [Section
2.2](https://www.rfc-editor.org/rfc/rfc8295#section-2.2){.relref} of
\[[RFC8295](#RFC8295){.xref}\], clients indicate the format
(\"application/xml\" or \"application/json\") of the PAL information
(\[[RFC8295](#RFC8295){.xref}\], [Section
2.1.1](https://www.rfc-editor.org/rfc/rfc8295#section-2.1.1){.relref})
via the HTTP Accept header.[¶](#section-3.1-2){.pilcrow}
:::
:::

::: {#sect-3.2}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Transport Layer Security](#name-transport-layer-security){.section-name .selfRef} {#name-transport-layer-security}

TLS implementations are configured as specified in
\[[RFC9151](#RFC9151){.xref}\]; the notable exception is that only
EC-based algorithms are used.[¶](#section-3.2-1){.pilcrow}
:::
:::

::: {#sect-3.3}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Eligibility](#name-eligibility){.section-name .selfRef} {#name-eligibility}

At the EST interface, servers only enroll clients that they have
established a prior relationship with independently of the EST service.
To accomplish this, client owners/operators interact in person with the
human acting as the Registration Authority (RA) to ensure the
information included in the transmitted certificate request, which is
sometimes called a Certificate Signing Request (CSR), is associated with
a client. The mechanism by which the owner/operator interacts with the
RA as well as the information provided is beyond the scope of this
document. The information exchanged by the owner/operator might be
something as simple as the subject name included in the CSR to be sent
or a copy of the certificate that will be used to verify the certificate
request, which is provided out of band.[¶](#section-3.3-1){.pilcrow}
:::
:::

::: {#sect-3.4}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Authentication](#name-authentication){.section-name .selfRef} {#name-authentication}

Mutual authentication occurs via \"Certificate TLS Authentication\"
(\[[RFC7030](#RFC7030){.xref}\], [Section
2.2.1](https://www.rfc-editor.org/rfc/rfc7030#section-2.2.1){.relref}).
Clients provide their certificate to servers in the TLS Certificate
message, which is sent in response to the server\'s TLS Certificate
Request message. Both servers and clients reject all attempts to
authenticate based on certificates that cannot be validated back to an
installed TA.[¶](#section-3.4-1){.pilcrow}
:::
:::

::: {#sect-3.5}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Authorization](#name-authorization){.section-name .selfRef} {#name-authorization}

Clients always use an explicit TA database
(\[[RFC7030](#RFC7030){.xref}\], [Section
3.6.1](https://www.rfc-editor.org/rfc/rfc7030#section-3.6.1){.relref}).
At a minimum, clients support two TAs: one for the PKI and one for
symmetric keys.[¶](#section-3.5-1){.pilcrow}

Clients check that the server\'s certificate includes the id-kp-cmcRA
Extended Key Usage (EKU) value (\[[RFC6402](#RFC6402){.xref}\], [Section
2.10](https://www.rfc-editor.org/rfc/rfc6402#section-2.10){.relref}).[¶](#section-3.5-2){.pilcrow}

Clients that support processing of the CMS Content Constraints extension
\[[RFC6010](#RFC6010){.xref}\] ensure returned CMS content is from an
SOA or an entity authorized by an SOA for that CMS content; see [Section
7.1](#sect-7.1){.xref} for SOA
certificates.[¶](#section-3.5-3){.pilcrow}
:::
:::

::: {#sect-3.6}
::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [EST and EST Extensions](#name-est-and-est-extensions){.section-name .selfRef} {#name-est-and-est-extensions}

This section profiles SODP\'s interfaces for EST
\[[RFC7030](#RFC7030){.xref}\] and EST extensions
\[[RFC8295](#RFC8295){.xref}\].[¶](#section-3.6-1){.pilcrow}

::: {#sect-3.6.1}
::: {#section-3.6.1 .section}
#### [3.6.1.](#section-3.6.1){.section-number .selfRef} [/pal](#name-pal){.section-name .selfRef} {#name-pal}

The Package Availability List (PAL) is limited to 32 entries, where the
32nd PAL entry links to an additional PAL (i.e., PAL Package Type
0001).[¶](#section-3.6.1-1){.pilcrow}

The PAL is XML \[[XML](#XML){.xref}\].[¶](#section-3.6.1-2){.pilcrow}
:::
:::

::: {#sect-3.6.2}
::: {#section-3.6.2 .section}
#### [3.6.2.](#section-3.6.2){.section-number .selfRef} [/cacerts](#name-cacerts){.section-name .selfRef} {#name-cacerts}

The CA certificates located in the explicit TA database are distributed
to the client when it is registered. This TA distribution mechanism is
out of scope.[¶](#section-3.6.2-1){.pilcrow}

CA certificates provided through this service are as specified in
Sections [5](#sect-5){.xref} and [6](#sect-6){.xref} of this
document.[¶](#section-3.6.2-2){.pilcrow}
:::
:::

::: {#sect-3.6.3}
::: {#section-3.6.3 .section}
#### [3.6.3.](#section-3.6.3){.section-number .selfRef} [/simpleenroll](#name-simpleenroll){.section-name .selfRef} {#name-simpleenroll}

CSRs follow the specifications in [Section
4.2](https://www.rfc-editor.org/rfc/rfc8756#section-4.2){.relref} of
\[[RFC8756](#RFC8756){.xref}\], except that the CMC-specific
ChangeSubjectName and the POP Link Witness V2 attributes do not apply.
Only EC-based algorithms are used.[¶](#section-3.6.3-1){.pilcrow}

Client certificates provided through this service are as specified in
[Section 7](#sect-7){.xref} of this
document.[¶](#section-3.6.3-2){.pilcrow}

The HTTP content type of \"text/plain\" (\[[RFC2046](#RFC2046){.xref}\],
[Section
4.1](https://www.rfc-editor.org/rfc/rfc2046#section-4.1){.relref}) is
used to return human-readable errors.[¶](#section-3.6.3-3){.pilcrow}
:::
:::

::: {#sect-3.6.4}
::: {#section-3.6.4 .section}
#### [3.6.4.](#section-3.6.4){.section-number .selfRef} [/simplereenroll](#name-simplereenroll){.section-name .selfRef} {#name-simplereenroll}

There are no additional requirements for requests beyond those specified
in Sections [3.4](#sect-3.4){.xref} and [3.6.3](#sect-3.6.3){.xref} of
this document.[¶](#section-3.6.4-1){.pilcrow}

The HTTP content type of \"text/plain\" (\[[RFC2046](#RFC2046){.xref}\],
[Section
4.1](https://www.rfc-editor.org/rfc/rfc2046#section-4.1){.relref}) is
used to return human-readable errors.[¶](#section-3.6.4-2){.pilcrow}
:::
:::

::: {#sect-3.6.5}
::: {#section-3.6.5 .section}
#### [3.6.5.](#section-3.6.5){.section-number .selfRef} [/fullcmc](#name-fullcmc){.section-name .selfRef} {#name-fullcmc}

Requests are as specified in \[[RFC8756](#RFC8756){.xref}\] with the
notable exception that only EC-based algorithms are
used.[¶](#section-3.6.5-1){.pilcrow}

Additional attributes for returned CMS packages can be found in
\[[RFC7906](#RFC7906){.xref}\].[¶](#section-3.6.5-2){.pilcrow}

Certificates provided through this service are as specified in [Section
7](#sect-7){.xref} of this document.[¶](#section-3.6.5-3){.pilcrow}
:::
:::

::: {#sect-3.6.6}
::: {#section-3.6.6 .section}
#### [3.6.6.](#section-3.6.6){.section-number .selfRef} [/serverkeygen](#name-serverkeygen){.section-name .selfRef} {#name-serverkeygen}

PKCS#12 \[[RFC7292](#RFC7292){.xref}\] \-- sometimes referred to as
\"PFX\" (Personal Information Exchange) or \"P12\" \-- is used to
provide server-generated asymmetric private keys and the associated
certificate to clients. This interface is a one-way interface as the RA
requests these from the server.[¶](#section-3.6.6-1){.pilcrow}

PFXs \[[RFC7292](#RFC7292){.xref}\] are exchanged using both password
privacy mode and integrity password mode. The PRF algorithm for PBKDF2
(the KDF for PBES2 and PBMAC1) is HMAC-SHA-384, and the PBES2 encryption
scheme is AES-256.[¶](#section-3.6.6-2){.pilcrow}

The HTTP content type of \"text/plain\" (\[[RFC2046](#RFC2046){.xref}\],
[Section
4.1](https://www.rfc-editor.org/rfc/rfc2046#section-4.1){.relref}) is
used to return human-readable errors.[¶](#section-3.6.6-3){.pilcrow}

/serverkeygen/return is not supported at this
time.[¶](#section-3.6.6-4){.pilcrow}
:::
:::

::: {#sect-3.6.7}
::: {#section-3.6.7 .section}
#### [3.6.7.](#section-3.6.7){.section-number .selfRef} [/csrattrs](#name-csrattrs){.section-name .selfRef} {#name-csrattrs}

Clients use this service to retrieve partially filled PKIRequests with
no public key or proof-of-possession signature, i.e., their values are
set to zero length, either a zero length BIT STRING or OCTET STRING. The
pKCS7PDU attribute, defined in \[[RFC2985](#RFC2985){.xref}\], includes
the partially filled PKIRequest as the only element in the CsrAttrs
sequence. Even though the CsrAttrs syntax is defined as a set, there is
only ever exactly one instance of values
present.[¶](#section-3.6.7-1){.pilcrow}
:::
:::

::: {#sect-3.6.8}
::: {#section-3.6.8 .section}
#### [3.6.8.](#section-3.6.8){.section-number .selfRef} [/crls](#name-crls){.section-name .selfRef} {#name-crls}

CRLs provided through this service are as specified in [Section
9](#sect-9){.xref} of this document.[¶](#section-3.6.8-1){.pilcrow}
:::
:::

::: {#sect-3.6.9}
::: {#section-3.6.9 .section}
#### [3.6.9.](#section-3.6.9){.section-number .selfRef} [/symmetrickeys](#name-symmetrickeys){.section-name .selfRef} {#name-symmetrickeys}

Clients that claim to support SODP interoperation will be able to
process the following messages from an SODP
server:[¶](#section-3.6.9-1){.pilcrow}

-   [additional encryption and origin authentication
    (\[[RFC8295](#RFC8295){.xref}\], [Section
    5](https://www.rfc-editor.org/rfc/rfc8295#section-5){.relref});
    and[¶](#section-3.6.9-2.1){.pilcrow}]{#section-3.6.9-2.1}
-   [server-provided Symmetric Key Content Type
    \[[RFC6032](#RFC6032){.xref}\] encapsulated in an Encrypted Key
    Content Type using the EnvelopedData choice
    \[[RFC6033](#RFC6033){.xref}\] with an SOA certificate that includes
    the CMS Content Constraints extension (see [Section
    7.1](#sect-7.1){.xref}).[¶](#section-3.6.9-2.2){.pilcrow}]{#section-3.6.9-2.2}

Client-supported algorithms to decrypt the server-returned symmetric key
are as follows:[¶](#section-3.6.9-3){.pilcrow}

-   [Message Digest: See [Section
    4](https://www.rfc-editor.org/rfc/rfc8755#section-4){.relref} of
    \[[RFC8755](#RFC8755){.xref}\].[¶](#section-3.6.9-4.1){.pilcrow}]{#section-3.6.9-4.1}
-   [Digital Signature Algorithm: See [Section
    5](https://www.rfc-editor.org/rfc/rfc8755#section-5){.relref} of
    \[[RFC8755](#RFC8755){.xref}\].[¶](#section-3.6.9-4.2){.pilcrow}]{#section-3.6.9-4.2}
-   [Key Agreement: See [Section
    6.1](https://www.rfc-editor.org/rfc/rfc8755#section-6.1){.relref} of
    \[[RFC8755](#RFC8755){.xref}\].[¶](#section-3.6.9-4.3){.pilcrow}]{#section-3.6.9-4.3}
-   [Key Wrap: AES-256 Key Wrap with Padding
    \[[RFC6033](#RFC6033){.xref}\] is used. AES-128 Key Wrap with
    Padding is not
    used.[¶](#section-3.6.9-4.4){.pilcrow}]{#section-3.6.9-4.4}
-   [Content Encryption: AES-256 Key Wrap with Padding
    \[[RFC6033](#RFC6033){.xref}\] is used. AES-128 Key Wrap with
    Padding is not
    used.[¶](#section-3.6.9-4.5){.pilcrow}]{#section-3.6.9-4.5}

/symmetrickeys/return is not used at this
time.[¶](#section-3.6.9-5){.pilcrow}
:::
:::

::: {#sect-3.6.10}
::: {#section-3.6.10 .section}
#### [3.6.10.](#section-3.6.10){.section-number .selfRef} [/eecerts, /firmware, /tamp](#name-eecerts-firmware-tamp){.section-name .selfRef} {#name-eecerts-firmware-tamp}

/eecerts, /firmware, and /tamp are not used at this
time.[¶](#section-3.6.10-1){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#sect-4}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [CMC Interface](#name-cmc-interface){.section-name .selfRef} {#name-cmc-interface}

Client options for CMC \[[RFC5274](#RFC5274){.xref}\]
\[[RFC6402](#RFC6402){.xref}\] are specified in this
section.[¶](#section-4-1){.pilcrow}

::: {#sect-4.1}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [RFC 5273 Transport Protocols](#name-rfc-5273-transport-protocol){.section-name .selfRef} {#name-rfc-5273-transport-protocol}

Clients only use the HTTPS-based transport. The TLS implementation and
configuration are as specified in \[[RFC9151](#RFC9151){.xref}\], with
the notable exception that only EC-based algorithms are
used.[¶](#section-4.1-1){.pilcrow}

Clients that receive HTTP redirection responses (3xx status codes) will
terminate the connection (\[[RFC7030](#RFC7030){.xref}\], [Section
3.2.1](https://www.rfc-editor.org/rfc/rfc7030#section-3.2.1){.relref}).[¶](#section-4.1-2){.pilcrow}
:::
:::

::: {#sect-4.2}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Eligibility](#name-eligibility-2){.section-name .selfRef} {#name-eligibility-2}

At the CMC interface, servers only enroll clients that they have
established a prior relationship with independently of the EST service.
To accomplish this, client owners/operators interact in person with the
human acting as the Registration Authority (RA) to ensure the
information included in the transmitted certificate request, which is
sometimes called a Certificate Signing Request (CSR), is associated with
a client. The mechanism by which the owner/operator interacts with the
RA as well as the information provided is beyond the scope of this
document. The information exchanged by the owner/operator might be
something as simple as the subject name included in the CSR to be sent
or a copy of the certificate that will be used to verify the certificate
request, which is provided out of band.[¶](#section-4.2-1){.pilcrow}
:::
:::

::: {#sect-4.3}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Authentication](#name-authentication-2){.section-name .selfRef} {#name-authentication-2}

Mutual authentication occurs via client and server signing of CMC
protocol elements, as required by \[[RFC8756](#RFC8756){.xref}\]. All
such signatures are validated against an installed TA; any that fail
validation are rejected.[¶](#section-4.3-1){.pilcrow}
:::
:::

::: {#sect-4.4}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Authorization](#name-authorization-2){.section-name .selfRef} {#name-authorization-2}

Clients support the simultaneous presence of as many TAs as are required
for all of the functions of the client, and only these
TAs.[¶](#section-4.4-1){.pilcrow}

Clients check that the server\'s certificate includes the id-kp-cmcRA
Extended Key Usage (EKU) value (\[[RFC6402](#RFC6402){.xref}\], [Section
2.10](https://www.rfc-editor.org/rfc/rfc6402#section-2.10){.relref}).[¶](#section-4.4-2){.pilcrow}

Clients that support processing of the CMS Content Constraints extension
\[[RFC6010](#RFC6010){.xref}\] ensure returned CMS content is from an
SOA or an entity authorized by an SOA for that CMS content; see [Section
7.1](#sect-7.1){.xref} for SOA
certificates.[¶](#section-4.4-3){.pilcrow}
:::
:::

::: {#sect-4.5}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [Full PKI Requests/Responses](#name-full-pki-requests-responses){.section-name .selfRef} {#name-full-pki-requests-responses}

Requests are as specified in \[[RFC8756](#RFC8756){.xref}\] with the
notable exception that only EC-based algorithms are
used.[¶](#section-4.5-1){.pilcrow}

Additional attributes for returned CMS packages can be found in
\[[RFC7906](#RFC7906){.xref}\].[¶](#section-4.5-2){.pilcrow}

Certificates provided through this service are as specified in [Section
7](#sect-7){.xref} of this document.[¶](#section-4.5-3){.pilcrow}
:::
:::
:::
:::

::: {#sect-5}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Trust Anchor Profile](#name-trust-anchor-profile){.section-name .selfRef} {#name-trust-anchor-profile}

Clients are free to store the TA in the format of their choosing;
however, servers provide TA information in the form of self-signed CA
certificates. This section documents requirements for self-signed
certificates in addition to those specified in
\[[RFC8603](#RFC8603){.xref}\], which in turn specifies requirements in
addition to those in
\[[RFC5280](#RFC5280){.xref}\].[¶](#section-5-1){.pilcrow}

Only EC-based algorithms are used.[¶](#section-5-2){.pilcrow}

Issuer and subject names are composed of only the following naming
attributes: country name, domain component, organization name,
organizational unit name, common name, state or province name,
distinguished name qualifier, and serial
number.[¶](#section-5-3){.pilcrow}

In the Subject Key Identifier extension, the keyIdentifier is the 64
low-order bits of the subject\'s subjectPublicKey
field.[¶](#section-5-4){.pilcrow}

In the Key Usage extension, the nonRepudiation bit is never
set.[¶](#section-5-5){.pilcrow}
:::
:::

::: {#sect-6}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Non-Self-Signed Certification Authority Certificate Profile](#name-non-self-signed-certificati){.section-name .selfRef} {#name-non-self-signed-certificati}

This section documents requirements for non-self-signed CA certificates
in addition to those specified in \[[RFC8603](#RFC8603){.xref}\], which
in turn specifies requirements in addition to those in
\[[RFC5280](#RFC5280){.xref}\].[¶](#section-6-1){.pilcrow}

Only EC-based algorithms are used.[¶](#section-6-2){.pilcrow}

Subject names are composed of only the following naming attributes:
country name, domain component, organization name, organizational unit
name, common name, state or province name, distinguished name qualifier,
and serial number.[¶](#section-6-3){.pilcrow}

In the Authority Key Identifier extension, the keyIdentifier choice is
always used. The keyIdentifier is the 64 low-order bits of the issuer\'s
subjectPublicKey field.[¶](#section-6-4){.pilcrow}

In the Subject Key Identifier extension, the keyIdentifier is the 64
low-order bits of the subject\'s subjectPublicKey
field.[¶](#section-6-5){.pilcrow}

In the Key Usage extension, the nonRepudiation bit is never
set.[¶](#section-6-6){.pilcrow}

The Certificate Policies extension is always included, and
policyQualifiers are never used.[¶](#section-6-7){.pilcrow}

Non-self-signed CA certificates can also include the
following:[¶](#section-6-8){.pilcrow}

[]{.break}

Name Constraints:
:   permittedSubtrees constraints are included, and excludedSubstree
    constraints are not. Of the GeneralName choices, issuers support the
    following: rfc822Name, dNSName, uniformResourceIdentifier, and
    iPAddress (both IPv4 and IPv6) as well as hardwareModuleName, which
    is defined in \[[RFC4108](#RFC4108){.xref}\]. Note that rfc822Name,
    dNSName, and uniformResourceIdentifier are defined as IA5 strings,
    and the character sets allowed are not uniform amongst these three
    name forms.[¶](#section-6-9.2){.pilcrow}
:   

CRL Distribution Points:
:   A distributionPoint is always the fullName choice. The
    uniformResourceIdentifier GeneralName choice is always included, but
    others can also be used as long as the first element in the sequence
    of CRLDistributionPoints is the uniformResourceIdentifier choice.
    The reasons and cRLIssuer fields are never populated. This extension
    is never marked as critical.[¶](#section-6-9.4){.pilcrow}
:   

Authority Information Access:
:   Only one instance of AccessDescription is included. accessMethod is
    id-caIssuers, and accessLocation\'s GeneralName is always the
    uniformResourceIdentifier choice.[¶](#section-6-9.6){.pilcrow}
:   

Extended Key Usage:
:   EST servers and RAs include the id-kp-cmcRA EKU, and the CAs include
    the id-kp-cmcCA, which are both specified in
    \[[RFC6402](#RFC6402){.xref}\].[¶](#section-6-9.8){.pilcrow}
:   

Issuers include the Authority Clearance Constraints extension
\[[RFC5913](#RFC5913){.xref}\] in non-self-signed CA certificates that
are issued to non-SOAs; values for the Certificate Policy (CP) Object
Identifier (OID) and the supported classList values are found in the
issuer\'s CP. Criticality is determined by the issuer, and a
securityCategories is never included. Only one instance of Clearance is
generated in the AuthorityClearanceConstraints
sequence.[¶](#section-6-10){.pilcrow}

Issuers include a critical CMS Content Constraints extension
\[[RFC6010](#RFC6010){.xref}\] in CA certificates used to issue SOA
certificates; this is necessary to enable enforcement of scope of the
SOA authority. The content types included depend on the packages the SOA
sources but include key packages (i.e., Encrypted Key Packages,
Symmetric Key Packages, and Asymmetric Key
Packages).[¶](#section-6-11){.pilcrow}
:::
:::

::: {#sect-7}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [End-Entity Certificate Profile](#name-end-entity-certificate-prof){.section-name .selfRef} {#name-end-entity-certificate-prof}

This section documents requirements for EE signature and key
establishment certificates in addition to those listed in
\[[RFC8603](#RFC8603){.xref}\], which in turn specifies requirements in
addition to those in
\[[RFC5280](#RFC5280){.xref}\].[¶](#section-7-1){.pilcrow}

Only EC-based algorithms are used.[¶](#section-7-2){.pilcrow}

Subject names are composed of the following naming attributes: country
name, domain component, organization name, organizational unit name,
common name, state or province name, distinguished name qualifier, and
serial number.[¶](#section-7-3){.pilcrow}

In the Authority Key Identifier extension, the keyIdentifier choice is
always used. The keyIdentifier is the 64 low-order bits of the issuer\'s
subjectPublicKey field.[¶](#section-7-4){.pilcrow}

In the Subject Key Identifier extension, the keyIdentifier is the 64
low-order bits of the subject\'s subjectPublicKey
field.[¶](#section-7-5){.pilcrow}

In the Key Usage extension, signature certificates only assert
digitalSignature, and key establishment certificates only assert
keyAgreement.[¶](#section-7-6){.pilcrow}

The Certificate Policies extension is always included, and
policyQualifiers are never used.[¶](#section-7-7){.pilcrow}

When included, the non-critical CRL Distribution Point extension\'s
distributionPoint is always identified by the fullName choice. The
uniformResourceIdentifier GeneralName choice is always included, but
others can also be used as long as the first element in the sequence of
distribution points is the URI choice and it is an HTTP/HTTPS scheme.
The reasons and cRLIssuer fields are never
populated.[¶](#section-7-8){.pilcrow}

The following subsections provide additional requirements for the
different types of EE certificates.[¶](#section-7-9){.pilcrow}

::: {#sect-7.1}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Source of Authority Certificate Profile](#name-source-of-authority-certifi){.section-name .selfRef} {#name-source-of-authority-certifi}

This section specifies the format for SOA certificates, i.e.,
certificates issued to those entities that are authorized to create,
digitally sign, encrypt, and distribute packages; these certificates are
issued by non-PKI TAs.[¶](#section-7.1-1){.pilcrow}

The Subject Alternative Name extension is always included. The following
choices are supported: rfc822Name, dNSName, ediPartyName,
uniformResourceIdentifier, or iPAddress (both IPv4 and IPv6). This
extension is never critical.[¶](#section-7.1-2){.pilcrow}

A critical CMS Content Constraints extension
\[[RFC6010](#RFC6010){.xref}\] is included in SOA signature
certificates. The content types included depend on the packages the SOA
sources (e.g., Encrypted Key Packages, Symmetric Key Packages, and
Asymmetric Key Packages).[¶](#section-7.1-3){.pilcrow}
:::
:::

::: {#sect-7.2}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Client Certificate Profile](#name-client-certificate-profile){.section-name .selfRef} {#name-client-certificate-profile}

This section specifies the format for certificates issued to
clients.[¶](#section-7.2-1){.pilcrow}

A non-critical Subject Directory Attributes extension is always included
with the following attributes:[¶](#section-7.2-2){.pilcrow}

-   [Device Owner
    \[[RFC5916](#RFC5916){.xref}\][¶](#section-7.2-3.1){.pilcrow}]{#section-7.2-3.1}
-   [Clearance Sponsor
    \[[RFC5917](#RFC5917){.xref}\][¶](#section-7.2-3.2){.pilcrow}]{#section-7.2-3.2}
-   [Clearance
    \[[RFC5913](#RFC5913){.xref}\][¶](#section-7.2-3.3){.pilcrow}]{#section-7.2-3.3}

The following extensions are also included at the discretion of the
CA:[¶](#section-7.2-4){.pilcrow}

-   [The Authority Information Access extension with only one instance
    of AccessDescription included. accessMethod is id-caIssuers, and
    accessLocation\'s GeneralName is always the
    uniformResourceIdentifier
    choice.[¶](#section-7.2-5.1){.pilcrow}]{#section-7.2-5.1}
-   [A non-critical Subject Alternative Name extension that includes the
    hardwareModuleName form \[[RFC4108](#RFC4108){.xref}\], rfc822Name,
    or
    uniformResourceIdentifier.[¶](#section-7.2-5.2){.pilcrow}]{#section-7.2-5.2}
-   [A critical Subject Alternative Name extension that includes
    dNSName, rfc822Name, ediPartyName, uniformResourceIdentifier, or
    iPAddress (both IPv4 and
    IPv6).[¶](#section-7.2-5.3){.pilcrow}]{#section-7.2-5.3}
:::
:::
:::
:::

::: {#sect-8}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Relying Party Applications](#name-relying-party-applications){.section-name .selfRef} {#name-relying-party-applications}

This section documents requirements for Relying Parties (RPs) in
addition to those listed in \[[RFC8603](#RFC8603){.xref}\], which in
turn specifies requirements in addition to those in
\[[RFC5280](#RFC5280){.xref}\].[¶](#section-8-1){.pilcrow}

Only EC-based algorithms are used.[¶](#section-8-2){.pilcrow}

RPs support the Authority Key Identifier and the Subject Key Identifier
extensions.[¶](#section-8-3){.pilcrow}

RPs should support the following extensions: CRL Distribution Points,
Authority Information Access, Subject Directory Attribute, Authority
Clearance Constraints, and CMS Content
Constraints.[¶](#section-8-4){.pilcrow}

Within the Subject Directory Attribute extension, RPs should support the
Clearance Sponsor, Clearance, and Device Owner
attributes.[¶](#section-8-5){.pilcrow}

RPs support the id-kp-cmcRA and id-kp-cmcCA
EKUs.[¶](#section-8-6){.pilcrow}

Failure to support extensions in this section might limit the
suitability of a device for certain
applications.[¶](#section-8-7){.pilcrow}
:::
:::

::: {#sect-9}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [CRL Profile](#name-crl-profile){.section-name .selfRef} {#name-crl-profile}

This section documents requirements for CRLs in addition to those listed
in \[[RFC8603](#RFC8603){.xref}\], which in turn specifies requirements
in addition to those in
\[[RFC5280](#RFC5280){.xref}\].[¶](#section-9-1){.pilcrow}

Only EC-based algorithms are used.[¶](#section-9-2){.pilcrow}

Two types of CRLs are produced: complete base CRLs and partitioned base
CRLs.[¶](#section-9-3){.pilcrow}

crlEntryExtensions are never included, and the reasons and cRLIssuer
fields are never populated.[¶](#section-9-4){.pilcrow}

All CRLs include the following CRL
extensions:[¶](#section-9-5){.pilcrow}

-   [The Authority Key Identifier extension: The keyIdentifier is the 64
    low-order bits of the issuer\'s subjectPublicKey
    field.[¶](#section-9-6.1){.pilcrow}]{#section-9-6.1}
-   [As per \[[RFC5280](#RFC5280){.xref}\], the CRL Number
    extension.[¶](#section-9-6.2){.pilcrow}]{#section-9-6.2}

The only other extension included in partitioned base CRLs is the
Issuing Distribution Point extension. The distributionPoint is always
identified by the fullName choice. The uniformResourceIdentifier
GeneralName choice is always included, but others can also be used as
long as the first element in the sequence of distribution points is the
uniformResourceIdentifier choice and the scheme is an HTTP/HTTPS scheme.
All other fields are omitted.[¶](#section-9-7){.pilcrow}
:::
:::

::: {#sect-10}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-10-1){.pilcrow}
:::
:::

::: {#sect-11}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This entire document is about security. This document profiles the use
of many protocols and services: EST, CMC, and PKCS#10/#7/#12 as well as
certificates, CRLs, and their extensions \[[RFC5280](#RFC5280){.xref}\].
These have been cited throughout this document, and the specifications
identified by those citations should be consulted for security
considerations related to implemented protocols and
services.[¶](#section-11-1){.pilcrow}
:::
:::

::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-12.1 .section}
### [12.1.](#section-12.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2046\]
:   [Freed, N.]{.refAuthor} and [N. Borenstein]{.refAuthor},
    [\"Multipurpose Internet Mail Extensions (MIME) Part Two: Media
    Types\"]{.refTitle}, [RFC 2046]{.seriesInfo}, [DOI
    10.17487/RFC2046]{.seriesInfo}, November 1996,
    \<<https://www.rfc-editor.org/info/rfc2046>\>.
:   

\[RFC2985\]
:   [Nystrom, M.]{.refAuthor} and [B. Kaliski]{.refAuthor}, [\"PKCS #9:
    Selected Object Classes and Attribute Types Version
    2.0\"]{.refTitle}, [RFC 2985]{.seriesInfo}, [DOI
    10.17487/RFC2985]{.seriesInfo}, November 2000,
    \<<https://www.rfc-editor.org/info/rfc2985>\>.
:   

\[RFC2986\]
:   [Nystrom, M.]{.refAuthor} and [B. Kaliski]{.refAuthor}, [\"PKCS #10:
    Certification Request Syntax Specification Version
    1.7\"]{.refTitle}, [RFC 2986]{.seriesInfo}, [DOI
    10.17487/RFC2986]{.seriesInfo}, November 2000,
    \<<https://www.rfc-editor.org/info/rfc2986>\>.
:   

\[RFC3739\]
:   [Santesson, S.]{.refAuthor}, [Nystrom, M.]{.refAuthor}, and [T.
    Polk]{.refAuthor}, [\"Internet X.509 Public Key Infrastructure:
    Qualified Certificates Profile\"]{.refTitle}, [RFC
    3739]{.seriesInfo}, [DOI 10.17487/RFC3739]{.seriesInfo}, March 2004,
    \<<https://www.rfc-editor.org/info/rfc3739>\>.
:   

\[RFC4108\]
:   [Housley, R.]{.refAuthor}, [\"Using Cryptographic Message Syntax
    (CMS) to Protect Firmware Packages\"]{.refTitle}, [RFC
    4108]{.seriesInfo}, [DOI 10.17487/RFC4108]{.seriesInfo}, August
    2005, \<<https://www.rfc-editor.org/info/rfc4108>\>.
:   

\[RFC5274\]
:   [Schaad, J.]{.refAuthor} and [M. Myers]{.refAuthor}, [\"Certificate
    Management Messages over CMS (CMC): Compliance
    Requirements\"]{.refTitle}, [RFC 5274]{.seriesInfo}, [DOI
    10.17487/RFC5274]{.seriesInfo}, June 2008,
    \<<https://www.rfc-editor.org/info/rfc5274>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}, [Santesson, S.]{.refAuthor},
    [Farrell, S.]{.refAuthor}, [Boeyen, S.]{.refAuthor},
    [Housley, R.]{.refAuthor}, and [W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC5652\]
:   [Housley, R.]{.refAuthor}, [\"Cryptographic Message Syntax
    (CMS)\"]{.refTitle}, [STD 70]{.seriesInfo}, [RFC 5652]{.seriesInfo},
    [DOI 10.17487/RFC5652]{.seriesInfo}, September 2009,
    \<<https://www.rfc-editor.org/info/rfc5652>\>.
:   

\[RFC5911\]
:   [Hoffman, P.]{.refAuthor} and [J. Schaad]{.refAuthor}, [\"New ASN.1
    Modules for Cryptographic Message Syntax (CMS) and
    S/MIME\"]{.refTitle}, [RFC 5911]{.seriesInfo}, [DOI
    10.17487/RFC5911]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5911>\>.
:   

\[RFC5912\]
:   [Hoffman, P.]{.refAuthor} and [J. Schaad]{.refAuthor}, [\"New ASN.1
    Modules for the Public Key Infrastructure Using X.509
    (PKIX)\"]{.refTitle}, [RFC 5912]{.seriesInfo}, [DOI
    10.17487/RFC5912]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5912>\>.
:   

\[RFC5913\]
:   [Turner, S.]{.refAuthor} and [S. Chokhani]{.refAuthor}, [\"Clearance
    Attribute and Authority Clearance Constraints Certificate
    Extension\"]{.refTitle}, [RFC 5913]{.seriesInfo}, [DOI
    10.17487/RFC5913]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5913>\>.
:   

\[RFC5915\]
:   [Turner, S.]{.refAuthor} and [D. Brown]{.refAuthor}, [\"Elliptic
    Curve Private Key Structure\"]{.refTitle}, [RFC 5915]{.seriesInfo},
    [DOI 10.17487/RFC5915]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5915>\>.
:   

\[RFC5916\]
:   [Turner, S.]{.refAuthor}, [\"Device Owner Attribute\"]{.refTitle},
    [RFC 5916]{.seriesInfo}, [DOI 10.17487/RFC5916]{.seriesInfo}, June
    2010, \<<https://www.rfc-editor.org/info/rfc5916>\>.
:   

\[RFC5917\]
:   [Turner, S.]{.refAuthor}, [\"Clearance Sponsor
    Attribute\"]{.refTitle}, [RFC 5917]{.seriesInfo}, [DOI
    10.17487/RFC5917]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5917>\>.
:   

\[RFC5958\]
:   [Turner, S.]{.refAuthor}, [\"Asymmetric Key Packages\"]{.refTitle},
    [RFC 5958]{.seriesInfo}, [DOI 10.17487/RFC5958]{.seriesInfo}, August
    2010, \<<https://www.rfc-editor.org/info/rfc5958>\>.
:   

\[RFC5959\]
:   [Turner, S.]{.refAuthor}, [\"Algorithms for Asymmetric Key Package
    Content Type\"]{.refTitle}, [RFC 5959]{.seriesInfo}, [DOI
    10.17487/RFC5959]{.seriesInfo}, August 2010,
    \<<https://www.rfc-editor.org/info/rfc5959>\>.
:   

\[RFC6010\]
:   [Housley, R.]{.refAuthor}, [Ashmore, S.]{.refAuthor}, and [C.
    Wallace]{.refAuthor}, [\"Cryptographic Message Syntax (CMS) Content
    Constraints Extension\"]{.refTitle}, [RFC 6010]{.seriesInfo}, [DOI
    10.17487/RFC6010]{.seriesInfo}, September 2010,
    \<<https://www.rfc-editor.org/info/rfc6010>\>.
:   

\[RFC6031\]
:   [Turner, S.]{.refAuthor} and [R. Housley]{.refAuthor},
    [\"Cryptographic Message Syntax (CMS) Symmetric Key Package Content
    Type\"]{.refTitle}, [RFC 6031]{.seriesInfo}, [DOI
    10.17487/RFC6031]{.seriesInfo}, December 2010,
    \<<https://www.rfc-editor.org/info/rfc6031>\>.
:   

\[RFC6032\]
:   [Turner, S.]{.refAuthor} and [R. Housley]{.refAuthor},
    [\"Cryptographic Message Syntax (CMS) Encrypted Key Package Content
    Type\"]{.refTitle}, [RFC 6032]{.seriesInfo}, [DOI
    10.17487/RFC6032]{.seriesInfo}, December 2010,
    \<<https://www.rfc-editor.org/info/rfc6032>\>.
:   

\[RFC6033\]
:   [Turner, S.]{.refAuthor}, [\"Algorithms for Cryptographic Message
    Syntax (CMS) Encrypted Key Package Content Type\"]{.refTitle}, [RFC
    6033]{.seriesInfo}, [DOI 10.17487/RFC6033]{.seriesInfo}, December
    2010, \<<https://www.rfc-editor.org/info/rfc6033>\>.
:   

\[RFC6160\]
:   [Turner, S.]{.refAuthor}, [\"Algorithms for Cryptographic Message
    Syntax (CMS) Protection of Symmetric Key Package Content
    Types\"]{.refTitle}, [RFC 6160]{.seriesInfo}, [DOI
    10.17487/RFC6160]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6160>\>.
:   

\[RFC6161\]
:   [Turner, S.]{.refAuthor}, [\"Elliptic Curve Algorithms for
    Cryptographic Message Syntax (CMS) Encrypted Key Package Content
    Type\"]{.refTitle}, [RFC 6161]{.seriesInfo}, [DOI
    10.17487/RFC6161]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6161>\>.
:   

\[RFC6162\]
:   [Turner, S.]{.refAuthor}, [\"Elliptic Curve Algorithms for
    Cryptographic Message Syntax (CMS) Asymmetric Key Package Content
    Type\"]{.refTitle}, [RFC 6162]{.seriesInfo}, [DOI
    10.17487/RFC6162]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6162>\>.
:   

\[RFC6268\]
:   [Schaad, J.]{.refAuthor} and [S. Turner]{.refAuthor}, [\"Additional
    New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the
    Public Key Infrastructure Using X.509 (PKIX)\"]{.refTitle}, [RFC
    6268]{.seriesInfo}, [DOI 10.17487/RFC6268]{.seriesInfo}, July 2011,
    \<<https://www.rfc-editor.org/info/rfc6268>\>.
:   

\[RFC6402\]
:   [Schaad, J.]{.refAuthor}, [\"Certificate Management over CMS (CMC)
    Updates\"]{.refTitle}, [RFC 6402]{.seriesInfo}, [DOI
    10.17487/RFC6402]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6402>\>.
:   

\[RFC7030\]
:   [Pritikin, M., Ed.]{.refAuthor}, [Yee, P., Ed.]{.refAuthor}, and [D.
    Harkins, Ed.]{.refAuthor}, [\"Enrollment over Secure
    Transport\"]{.refTitle}, [RFC 7030]{.seriesInfo}, [DOI
    10.17487/RFC7030]{.seriesInfo}, October 2013,
    \<<https://www.rfc-editor.org/info/rfc7030>\>.
:   

\[RFC7191\]
:   [Housley, R.]{.refAuthor}, [\"Cryptographic Message Syntax (CMS) Key
    Package Receipt and Error Content Types\"]{.refTitle}, [RFC
    7191]{.seriesInfo}, [DOI 10.17487/RFC7191]{.seriesInfo}, April 2014,
    \<<https://www.rfc-editor.org/info/rfc7191>\>.
:   

\[RFC7192\]
:   [Turner, S.]{.refAuthor}, [\"Algorithms for Cryptographic Message
    Syntax (CMS) Key Package Receipt and Error Content
    Types\"]{.refTitle}, [RFC 7192]{.seriesInfo}, [DOI
    10.17487/RFC7192]{.seriesInfo}, April 2014,
    \<<https://www.rfc-editor.org/info/rfc7192>\>.
:   

\[RFC7292\]
:   [Moriarty, K., Ed.]{.refAuthor}, [Nystrom, M.]{.refAuthor},
    [Parkinson, S.]{.refAuthor}, [Rusch, A.]{.refAuthor}, and [M.
    Scott]{.refAuthor}, [\"PKCS #12: Personal Information Exchange
    Syntax v1.1\"]{.refTitle}, [RFC 7292]{.seriesInfo}, [DOI
    10.17487/RFC7292]{.seriesInfo}, July 2014,
    \<<https://www.rfc-editor.org/info/rfc7292>\>.
:   

\[RFC7906\]
:   [Timmel, P.]{.refAuthor}, [Housley, R.]{.refAuthor}, and [S.
    Turner]{.refAuthor}, [\"NSA\'s Cryptographic Message Syntax (CMS)
    Key Management Attributes\"]{.refTitle}, [RFC 7906]{.seriesInfo},
    [DOI 10.17487/RFC7906]{.seriesInfo}, June 2016,
    \<<https://www.rfc-editor.org/info/rfc7906>\>.
:   

\[RFC8295\]
:   [Turner, S.]{.refAuthor}, [\"EST (Enrollment over Secure Transport)
    Extensions\"]{.refTitle}, [RFC 8295]{.seriesInfo}, [DOI
    10.17487/RFC8295]{.seriesInfo}, January 2018,
    \<<https://www.rfc-editor.org/info/rfc8295>\>.
:   

\[RFC8603\]
:   [Jenkins, M.]{.refAuthor} and [L. Zieglar]{.refAuthor},
    [\"Commercial National Security Algorithm (CNSA) Suite Certificate
    and Certificate Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    8603]{.seriesInfo}, [DOI 10.17487/RFC8603]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8603>\>.
:   

\[RFC8755\]
:   [Jenkins, M.]{.refAuthor}, [\"Using Commercial National Security
    Algorithm Suite Algorithms in Secure/Multipurpose Internet Mail
    Extensions\"]{.refTitle}, [RFC 8755]{.seriesInfo}, [DOI
    10.17487/RFC8755]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8755>\>.
:   

\[RFC8756\]
:   [Jenkins, M.]{.refAuthor} and [L. Zieglar]{.refAuthor},
    [\"Commercial National Security Algorithm (CNSA) Suite Profile of
    Certificate Management over CMS\"]{.refTitle}, [RFC
    8756]{.seriesInfo}, [DOI 10.17487/RFC8756]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8756>\>.
:   

\[RFC9151\]
:   [Cooley, D.]{.refAuthor}, [\"Commercial National Security Algorithm
    (CNSA) Suite Profile for TLS and DTLS 1.2 and 1.3\"]{.refTitle},
    [RFC 9151]{.seriesInfo}, [DOI 10.17487/RFC9151]{.seriesInfo}, April
    2022, \<<https://www.rfc-editor.org/info/rfc9151>\>.
:   

\[SP-800-59\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Guideline for Identifying an Information System as a National
    Security System\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-59]{.seriesInfo}, [NIST Special Publication
    800-59]{.seriesInfo}, August 2003,
    \<<https://csrc.nist.gov/publications/detail/sp/800-59/final>\>.
:   

\[XML\]
:   [Bray, T.]{.refAuthor}, [Paoli, J.]{.refAuthor}, [Sperberg-McQueen,
    C.M.]{.refAuthor}, [Maler, E.]{.refAuthor}, and [F.
    Yergeau]{.refAuthor}, [\"Extensible Markup Language (XML) 1.0 (Fifth
    Edition)\"]{.refTitle}, [World Wide Web Consortium Recommendation
    REC-xml-20081126]{.seriesInfo}, November 2008,
    \<<https://www.w3.org/TR/2008/REC-xml-20081126/>\>.
:   
:::

::: {#section-12.2 .section}
### [12.2.](#section-12.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::
:::

::: {#authors-addresses}
::: {#appendix-A .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Michael Jenkins]{.fn .nameRole}
:::

::: {.left dir="auto"}
[National Security Agency]{.org}
:::

::: email
Email: <mjjenki@cyber.nsa.gov>
:::

::: {.left dir="auto"}
[Sean Turner]{.fn .nameRole}
:::

::: {.left dir="auto"}
[sn3rd]{.org}
:::

::: email
Email: <sean@sn3rd.com>
:::
:::
:::
