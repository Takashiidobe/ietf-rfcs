  RFC 9161          EVPN Proxy ARP/ND   January 2022
  ----------------- ------------------- --------------
  Rabadan, et al.   Standards Track     \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9161](https://www.rfc-editor.org/rfc/rfc9161){.eref}

Updates:
:   [7432](https://www.rfc-editor.org/rfc/rfc7432){.eref}

Category:
:   Standards Track

Published:
:   January 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    J. Rabadan, [Ed.]{.editor}
    :::

    ::: org
    Nokia
    :::
    :::

    ::: author
    ::: author-name
    S. Sathappan
    :::

    ::: org
    Nokia
    :::
    :::

    ::: author
    ::: author-name
    K. Nagaraj
    :::

    ::: org
    Nokia
    :::
    :::

    ::: author
    ::: author-name
    G. Hankins
    :::

    ::: org
    Nokia
    :::
    :::

    ::: author
    ::: author-name
    T. King
    :::

    ::: org
    DE-CIX
    :::
    :::
:::

# RFC 9161 {#rfcnum}

# Operational Aspects of Proxy ARP/ND in Ethernet Virtual Private Networks {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes the Ethernet Virtual Private Network (EVPN)
Proxy ARP/ND function augmented by the capability of the ARP/ND Extended
Community. From that perspective, this document updates the EVPN
specification to provide more comprehensive documentation of the
operation of the Proxy ARP/ND function. The EVPN Proxy ARP/ND function
and the ARP/ND Extended Community help operators of Internet Exchange
Points, Data Centers, and other networks deal with IPv4 and IPv6 address
resolution issues associated with large Broadcast Domains by reducing
and even suppressing the flooding produced by address resolution in the
EVPN network.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9161>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [The Data Center Use
        Case](#name-the-data-center-use-case){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [The Internet Exchange Point Use
        Case](#name-the-internet-exchange-point){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Solution
    Description](#name-solution-description){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Proxy ARP/ND
        Sub-functions](#name-proxy-arp-nd-sub-functions){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Learning
        Sub-function](#name-learning-sub-function){.xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [Proxy ND and the NA
            Flags](#name-proxy-nd-and-the-na-flags){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Reply
        Sub-function](#name-reply-sub-function){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Unicast-Forward
        Sub-function](#name-unicast-forward-sub-functio){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Maintenance
        Sub-function](#name-maintenance-sub-function){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [Flood (to Remote PEs)
        Handling](#name-flood-to-remote-pes-handlin){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Duplicate IP
        Detection](#name-duplicate-ip-detection){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Solution
    Benefits](#name-solution-benefits){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Deployment
    Scenarios](#name-deployment-scenarios){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [All Dynamic
        Learning](#name-all-dynamic-learning){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Dynamic Learning with Proxy
        ARP/ND](#name-dynamic-learning-with-proxy){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Hybrid Dynamic Learning and Static
        Provisioning with Proxy
        ARP/ND](#name-hybrid-dynamic-learning-and){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [All Static Provisioning with Proxy
        ARP/ND](#name-all-static-provisioning-wit){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Example of Deployment in Internet
        Exchange Points](#name-example-of-deployment-in-in){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [Example of Deployment in Data
        Centers](#name-example-of-deployment-in-da){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [](#appendix-A){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [](#appendix-B){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-C){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#sect-2}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

As specified in \[[RFC7432](#RFC7432){.xref}\], the IP Address field in
the Ethernet Virtual Private Network (EVPN) Media Access Control (MAC) /
IP Advertisement route may optionally carry one of the IP addresses
associated with the MAC address. A Provider Edge (PE) may learn local
IP-\>MAC pairs and advertise them in EVPN MAC/IP Advertisement routes.
Remote PEs importing those routes in the same Broadcast Domain (BD) may
add those IP-\>MAC pairs to their Proxy ARP/ND tables and reply to local
ARP Requests or Neighbor Solicitations (or \"unicast-forward\" those
packets to the owner MAC), reducing and even suppressing, in some cases,
the flooding in the EVPN network.[¶](#section-1-1){.pilcrow}

EVPN and its associated Proxy ARP/ND function are extremely useful in
Data Centers (DCs) or Internet Exchange Points (IXPs) with large
Broadcast Domains, where the amount of ARP/ND flooded traffic causes
issues on connected routers and Customer Edges (CEs).
\[[RFC6820](#RFC6820){.xref}\] describes the address resolution problems
in large DC networks.[¶](#section-1-2){.pilcrow}

This document describes the Proxy ARP/ND function in
\[[RFC7432](#RFC7432){.xref}\] networks, augmented by the capability of
the ARP/ND Extended Community \[[RFC9047](#RFC9047){.xref}\]. From that
perspective, this document updates
\[[RFC7432](#RFC7432){.xref}\].[¶](#section-1-3){.pilcrow}

Proxy ARP/ND may be implemented to help IXPs, DCs, and other operators
deal with the issues derived from address resolution in large Broadcast
Domains.[¶](#section-1-4){.pilcrow}

::: {#sect-2.1}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [The Data Center Use Case](#name-the-data-center-use-case){.section-name .selfRef} {#name-the-data-center-use-case}

As described in \[[RFC6820](#RFC6820){.xref}\], the IPv4 and IPv6
address resolution can create a lot of issues in large DCs. In
particular, the issues created by IPv4 Address Resolution Protocol
procedures may be significant.[¶](#section-1.1-1){.pilcrow}

On one hand, ARP Requests use broadcast MAC addresses; therefore, any
Tenant System in a large Broadcast Domain will see a large amount of ARP
traffic, which is not addressed to most of the
receivers.[¶](#section-1.1-2){.pilcrow}

On the other hand, the flooding issue becomes even worse if some Tenant
Systems disappear from the Broadcast Domain, since some implementations
will persistently retry sending ARP Requests. As
\[[RFC6820](#RFC6820){.xref}\] states, there are no clear requirements
for retransmitting ARP Requests in the absence of replies; hence, an
implementation may choose to keep retrying endlessly even if there are
no replies.[¶](#section-1.1-3){.pilcrow}

The amount of flooding that address resolution creates can be mitigated
by the use of EVPN and its Proxy ARP/ND
function.[¶](#section-1.1-4){.pilcrow}
:::
:::

::: {#sect-2.2}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [The Internet Exchange Point Use Case](#name-the-internet-exchange-point){.section-name .selfRef} {#name-the-internet-exchange-point}

The implementation described in this document is especially useful in
IXP networks.[¶](#section-1.2-1){.pilcrow}

A typical IXP provides access to a large Layer 2 Broadcast Domain for
peering purposes (referred to as \"the peering network\"), where
(hundreds of) Internet routers are connected. We refer to these Internet
routers as CE devices in this section. Because of the requirement to
connect all routers to a single Layer 2 network, the peering networks
use IPv4 addresses in length ranges from /21 to /24 (and even bigger for
IPv6), which can create very large Broadcast Domains. This peering
network is transparent to the CEs and therefore floods any ARP Requests
or NS messages to all the CEs in the network. Gratuitous ARP and NA
messages are flooded to all the CEs too.[¶](#section-1.2-2){.pilcrow}

In these IXP networks, most of the CEs are typically peering routers and
roughly all the Broadcast, Unknown Unicast, and Multicast (BUM) traffic
is originated by the ARP and ND address resolution procedures. This
ARP/ND BUM traffic causes significant data volumes that reach every
single router in the peering network. Since the ARP/ND messages are
processed in \"slow path\" software processors and they take high
priority in the routers, heavy loads of ARP/ND traffic can cause some
routers to run out of resources. CEs disappearing from the network may
cause address resolution explosions that can make a router with limited
processing power fail to keep BGP sessions
running.[¶](#section-1.2-3){.pilcrow}

The issue might be better in IPv6 routers if Multicast Listener
Discovery (MLD) snooping was enabled, since ND uses an SN-multicast
address in NS messages; however, ARP uses broadcast and has to be
processed by all the routers in the network. Some routers may also be
configured to broadcast periodic Gratuitous ARPs (GARPs)
\[[RFC5227](#RFC5227){.xref}\]. For IPv6, the fact that IPv6 CEs have
more than one IPv6 address contributes to the growth of ND flooding in
the network. The amount of ARP/ND flooded traffic grows linearly with
the number of IXP participants; therefore, the issue can only grow worse
as new CEs are added.[¶](#section-1.2-4){.pilcrow}

In order to deal with this issue, IXPs have developed certain solutions
over the past years. While these solutions may mitigate the issues of
address resolution in large Broadcast Domains, EVPN provides new more
efficient possibilities to IXPs. EVPN and its Proxy ARP/ND function may
help solve the issue in a distributed and scalable way, fully integrated
with the PE network.[¶](#section-1.2-5){.pilcrow}
:::
:::
:::
:::

::: {#sect-1}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

[]{.break}

ARP:
:   Address Resolution Protocol[¶](#section-2-2.2){.pilcrow}
:   

AS-MAC:
:   Anti-spoofing MAC. It is a special MAC configured on all the PEs
    attached to the same BD and used for the duplicate IP detection
    procedures.[¶](#section-2-2.4){.pilcrow}
:   

BD:
:   Broadcast Domain[¶](#section-2-2.6){.pilcrow}
:   

BUM:
:   Broadcast, Unknown Unicast, and Multicast Layer 2
    traffic[¶](#section-2-2.8){.pilcrow}
:   

CE:
:   Customer Edge router[¶](#section-2-2.10){.pilcrow}
:   

DAD:
:   Duplicate Address Detection, as per
    \[[RFC4861](#RFC4861){.xref}\][¶](#section-2-2.12){.pilcrow}
:   

DC:
:   Data Center[¶](#section-2-2.14){.pilcrow}
:   

EVI:
:   EVPN Instance[¶](#section-2-2.16){.pilcrow}
:   

EVPN:
:   Ethernet Virtual Private Network, as per
    \[[RFC7432](#RFC7432){.xref}\][¶](#section-2-2.18){.pilcrow}
:   

GARP:
:   Gratuitous ARP[¶](#section-2-2.20){.pilcrow}
:   

IP-\>MAC:
:   An IP address associated to a MAC address. IP-\>MAC entries are
    programmed in Proxy ARP/ND tables and may be of three different
    types: dynamic, static, or
    EVPN-learned.[¶](#section-2-2.22){.pilcrow}
:   

IXP:
:   Internet Exchange Point[¶](#section-2-2.24){.pilcrow}
:   

IXP-LAN:
:   The IXP\'s large Broadcast Domain to where Internet routers are
    connected.[¶](#section-2-2.26){.pilcrow}
:   

LAG:
:   Link Aggregation Group[¶](#section-2-2.28){.pilcrow}
:   

MAC or IP DA:
:   MAC or IP Destination Address[¶](#section-2-2.30){.pilcrow}
:   

MAC or IP SA:
:   MAC or IP Source Address[¶](#section-2-2.32){.pilcrow}
:   

ND:
:   Neighbor Discovery[¶](#section-2-2.34){.pilcrow}
:   

NS:
:   Neighbor Solicitation[¶](#section-2-2.36){.pilcrow}
:   

NA:
:   Neighbor Advertisement[¶](#section-2-2.38){.pilcrow}
:   

NUD:
:   Neighbor Unreachability Detection, as per
    \[[RFC4861](#RFC4861){.xref}\][¶](#section-2-2.40){.pilcrow}
:   

O Flag:
:   Override Flag in NA messages, as per
    \[[RFC4861](#RFC4861){.xref}\][¶](#section-2-2.42){.pilcrow}
:   

PE:
:   Provider Edge router[¶](#section-2-2.44){.pilcrow}
:   

R Flag:
:   Router Flag in NA messages, as per
    \[[RFC4861](#RFC4861){.xref}\][¶](#section-2-2.46){.pilcrow}
:   

RT2:
:   EVPN Route type 2 or EVPN MAC/IP Advertisement route, as per
    \[[RFC7432](#RFC7432){.xref}\][¶](#section-2-2.48){.pilcrow}
:   

S Flag:
:   Solicited Flag in NA messages, as per
    \[[RFC4861](#RFC4861){.xref}\][¶](#section-2-2.50){.pilcrow}
:   

SN-multicast address:
:   Solicited-Node IPv6 multicast address used by NS
    messages[¶](#section-2-2.52){.pilcrow}
:   

TLLA:
:   Target Link Layer Address, as per
    \[[RFC4861](#RFC4861){.xref}\][¶](#section-2-2.54){.pilcrow}
:   

VPLS:
:   Virtual Private LAN Service[¶](#section-2-2.56){.pilcrow}
:   

This document assumes familiarity with the terminology used in
\[[RFC7432](#RFC7432){.xref}\].[¶](#section-2-3){.pilcrow}
:::
:::

::: {#sect-4}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Solution Description](#name-solution-description){.section-name .selfRef} {#name-solution-description}

[Figure 1](#ure-proxy-arp-nd-network-example){.xref} illustrates an
example EVPN network where the Proxy ARP/ND function is
enabled.[¶](#section-3-1){.pilcrow}

[]{#name-proxy-arp-nd-network-exampl}

::: {#ure-proxy-arp-nd-network-example}
::: {#section-3-2.1 .alignLeft .art-text .artwork}
                                                          BD1
                                                      Proxy ARP/ND
                                                     +------------+
    IP1/M1          +----------------------------+   |IP1->M1 EVPN|
     GARP --->Proxy ARP/ND                       |   |IP2->M2 EVPN|
    +---+      +--------+   RT2(IP1/M1)          |   |IP3->M3 sta |
    |CE1+------|   BD1  |    ------>      +------+---|IP4->M4 dyn |
    +---+      +--------+                 |          +------------+
                   PE1                    | +--------+ Who has IP1?
                    |           EVPN      | |   BD1  | <-----  +---+
                    |           EVI1      | |        | ----->  |CE3|
    IP2/M2          |                     | |        | IP1->M1 +---+
     GARP  --->Proxy ARP/ND               | +--------+   |    IP3/M3
      +---+    +--------+   RT2(IP2/M2)   |              |
      |CE2+----|   BD1  |    ------>      +--------------+
      +---+    +--------+                       PE3|    +---+
                   PE2                           | +----+CE4|
                    +----------------------------+      +---+
                                                  <---IP4/M4 GARP
:::

[Figure 1](#figure-1){.selfRef}: [Proxy ARP/ND Network
Example](#name-proxy-arp-nd-network-exampl){.selfRef}
:::

When the Proxy ARP/ND function is enabled in a BD (Broadcast Domain) of
the EVPN PEs, each PE creates a Proxy table specific to that BD that can
contain three types of Proxy ARP/ND entries:[¶](#section-3-3){.pilcrow}

[]{.break}

Dynamic entries:
:   Learned by snooping a CE\'s ARP and ND messages; for instance, see
    IP4-\>M4 in [Figure
    1](#ure-proxy-arp-nd-network-example){.xref}.[¶](#section-3-4.2){.pilcrow}
:   

Static entries:
:   Provisioned on the PE by the management system; for instance, see
    IP3-\>M3 in [Figure
    1](#ure-proxy-arp-nd-network-example){.xref}.[¶](#section-3-4.4){.pilcrow}
:   

EVPN-learned entries:
:   Learned from the IP/MAC information encoded in the received RT2\'s
    coming from remote PEs; for instance, see IP1-\>M1 and IP2-\>M2 in
    [Figure
    1](#ure-proxy-arp-nd-network-example){.xref}.[¶](#section-3-4.6){.pilcrow}
:   

As a high-level example, the operation of the EVPN Proxy ARP/ND function
in the network of [Figure 1](#ure-proxy-arp-nd-network-example){.xref}
is described below. In this example, we assume IP1, IP2, and IP3 are
IPv4 addresses:[¶](#section-3-5){.pilcrow}

1.  [Proxy ARP/ND is enabled in BD1 of PE1, PE2, and
    PE3.[¶](#section-3-6.1){.pilcrow}]{#section-3-6.1}

2.  ::: {#section-3-6.2}
    The PEs start adding dynamic, static, and EVPN-learned entries to
    their Proxy tables:[¶](#section-3-6.2.1){.pilcrow}

    a.  [PE3 adds IP1-\>M1 and IP2-\>M2 based on the EVPN routes
        received from PE1 and PE2. Those entries were previously learned
        as dynamic entries in PE1 and PE2, respectively, and advertised
        in BGP
        EVPN.[¶](#section-3-6.2.2.1){.pilcrow}]{#section-3-6.2.2.1}
    b.  [PE3 adds IP4-\>M4 as dynamic. This entry is learned by snooping
        the corresponding ARP messages sent by
        CE4.[¶](#section-3-6.2.2.2){.pilcrow}]{#section-3-6.2.2.2}
    c.  [An operator also provisions the static entry
        IP3-\>M3.[¶](#section-3-6.2.2.3){.pilcrow}]{#section-3-6.2.2.3}
    :::

3.  ::: {#section-3-6.3}
    When CE3 sends an ARP Request asking for the MAC address of IP1, PE3
    will:[¶](#section-3-6.3.1){.pilcrow}

    a.  [Intercept the ARP Request and perform a Proxy ARP lookup for
        IP1.[¶](#section-3-6.3.2.1){.pilcrow}]{#section-3-6.3.2.1}
    b.  [If the lookup is successful (as in [Figure
        1](#ure-proxy-arp-nd-network-example){.xref}), PE3 will send an
        ARP Reply with IP1-\>M1. The ARP Request will not be flooded to
        the EVPN network or any other local
        CEs.[¶](#section-3-6.3.2.2){.pilcrow}]{#section-3-6.3.2.2}
    c.  [If the lookup is not successful, PE3 will flood the ARP Request
        in the EVPN network and the other local
        CEs.[¶](#section-3-6.3.2.3){.pilcrow}]{#section-3-6.3.2.3}
    :::

In the same example, if we assume IP1, IP2, IP3, and IP4 are now IPv6
addresses and Proxy ARP/ND is enabled in BD1:[¶](#section-3-7){.pilcrow}

1.  ::: {#section-3-8.1}
    PEs will start adding entries in a similar way as they would for
    IPv4; however, there are some
    differences:[¶](#section-3-8.1.1){.pilcrow}

    a.  [IP1-\>M1 and IP2-\>M2 are learned as dynamic entries in PE1 and
        PE2, respectively, by snooping NA messages and not by snooping
        NS messages. In the IPv4 case, any ARP frame can be snooped to
        learn the dynamic Proxy ARP entry. When learning the dynamic
        entries, the R and O Flags contained in the snooped NA messages
        will be added to the Proxy ND entries
        too.[¶](#section-3-8.1.2.1){.pilcrow}]{#section-3-8.1.2.1}
    b.  [PE1 and PE2 will advertise those entries in EVPN MAC/IP
        Advertisement routes, including the corresponding learned R and
        O Flags in the ARP/ND Extended
        Community.[¶](#section-3-8.1.2.2){.pilcrow}]{#section-3-8.1.2.2}
    c.  [PE3 also adds IP4-\>M4 as dynamic after snooping an NA message
        sent by
        CE4.[¶](#section-3-8.1.2.3){.pilcrow}]{#section-3-8.1.2.3}
    :::

2.  [When CE3 sends an NS message asking for the MAC address of IP1, PE3
    behaves as in the IPv4 example, by intercepting the NS, performing a
    lookup on the IP, and replying with an NA if the lookup is
    successful. If it is successful, the NS is not flooded to the EVPN
    PEs or any other local
    CEs.[¶](#section-3-8.2){.pilcrow}]{#section-3-8.2}

3.  [If the lookup is not successful, PE3 will flood the NS to remote
    EVPN PEs attached to the same BD and the other local CEs as in the
    IPv4 case.[¶](#section-3-8.3){.pilcrow}]{#section-3-8.3}

As PE3 learns more and more host entries in the Proxy ARP/ND table, the
flooding of ARP Request messages among PEs is reduced and in some cases,
it can even be suppressed. In a network where most of the participant
CEs are not moving between PEs and are advertising their presence with
GARPs or unsolicited-NA messages, the ARP/ND flooding among PEs, as well
as the unknown unicast flooding, can practically be suppressed. In an
EVPN-based IXP network, where all the entries are static, the ARP/ND
flooding among PEs is in fact totally
suppressed.[¶](#section-3-9){.pilcrow}

In a network where CEs move between PEs, the Proxy ARP/ND function
relies on the CE signaling its new location via GARP or unsolicited-NA
messages so that tables are immediately updated. If a CE moves
\"silently\", that is, without issuing any GARP or NA message upon
getting attached to the destination PE, the mechanisms described in
[Section 3.5](#sect-4.4){.xref} make sure that the Proxy ARP/ND tables
are eventually updated.[¶](#section-3-10){.pilcrow}

::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Proxy ARP/ND Sub-functions](#name-proxy-arp-nd-sub-functions){.section-name .selfRef} {#name-proxy-arp-nd-sub-functions}

The Proxy ARP/ND function can be structured in six sub-functions or
procedures:[¶](#section-3.1-1){.pilcrow}

1.  [Learning
    sub-function[¶](#section-3.1-2.1){.pilcrow}]{#section-3.1-2.1}
2.  [Reply
    sub-function[¶](#section-3.1-2.2){.pilcrow}]{#section-3.1-2.2}
3.  [Unicast-forward
    sub-function[¶](#section-3.1-2.3){.pilcrow}]{#section-3.1-2.3}
4.  [Maintenance
    sub-function[¶](#section-3.1-2.4){.pilcrow}]{#section-3.1-2.4}
5.  [Flood handling
    sub-function[¶](#section-3.1-2.5){.pilcrow}]{#section-3.1-2.5}
6.  [Duplicate IP detection
    sub-function[¶](#section-3.1-2.6){.pilcrow}]{#section-3.1-2.6}

A Proxy ARP/ND implementation [MUST]{.bcp14} at least support the
Learning, Reply, Maintenance, and duplicate IP detection sub-functions.
The following sections describe each individual
sub-function.[¶](#section-3.1-3){.pilcrow}
:::

::: {#sect-4.1}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Learning Sub-function](#name-learning-sub-function){.section-name .selfRef} {#name-learning-sub-function}

A Proxy ARP/ND implementation in an EVPN BD [MUST]{.bcp14} support
dynamic and EVPN-learned entries and [SHOULD]{.bcp14} support static
entries.[¶](#section-3.2-1){.pilcrow}

Static entries are provisioned from the management plane. A static entry
is configured on the PE attached to the host using the IP address in
that entry. The provisioned static IP-\>MAC entry [MUST]{.bcp14} be
advertised in EVPN with an ARP/ND Extended Community where the Immutable
ARP/ND Binding Flag (I) is set to 1, as per
\[[RFC9047](#RFC9047){.xref}\]. When the I Flag in the ARP/ND Extended
Community is 1, the advertising PE indicates that the IP address must
not be associated to a MAC other than the one included in the EVPN
MAC/IP Advertisement route. The advertisement of I = 1 in the ARP/ND
Extended Community is compatible with any value of the Sticky bit (S) or
sequence number in the \[[RFC7432](#RFC7432){.xref}\] MAC Mobility
Extended Community. Note that the I bit in the ARP/ND Extended Community
refers to the immutable configured association between the IP and the
MAC address in the IP-\>MAC binding, whereas the S bit in the MAC
Mobility Extended Community refers to the fact that the advertised MAC
address is not subject to the \[[RFC7432](#RFC7432){.xref}\] mobility
procedures.[¶](#section-3.2-2){.pilcrow}

An entry may associate a configured static IP to a list of potential
MACs, i.e., IP1-\>(MAC1,MAC2..MACN). Until a frame (including a local
ARP/NA message) is received from the CE, the PE will not advertise any
IP1-\>MAC in EVPN. Upon receiving traffic from the CE, the PE will check
that the source MAC, e.g., MAC1, is included in the list of allowed
MACs. Only in that case, the PE will activate the IP1-\>MAC1 and
advertise only that IP1 and MAC1 in an EVPN MAC/IP Advertisement
route.[¶](#section-3.2-3){.pilcrow}

The PE [MUST]{.bcp14} create EVPN-learned entries from the received
valid EVPN MAC/IP Advertisement routes containing a MAC and IP
address.[¶](#section-3.2-4){.pilcrow}

Dynamic entries are learned in different ways depending on whether the
entry contains an IPv4 or IPv6 address:[¶](#section-3.2-5){.pilcrow}

[]{.break}

Proxy ARP dynamic entries:
:   The PE [MUST]{.bcp14} snoop all ARP packets (that is, all frames
    with Ethertype 0x0806) received from the CEs attached to the BD in
    order to learn dynamic entries. ARP packets received from remote
    EVPN PEs attached to the same BD are not snooped. The Learning
    function will add the sender MAC and sender IP of the snooped ARP
    packet to the Proxy ARP table. Note that a MAC or an IP address with
    value 0 [SHOULD NOT]{.bcp14} be
    learned.[¶](#section-3.2-6.2){.pilcrow}
:   

Proxy ND dynamic entries:

:   The PE [MUST]{.bcp14} snoop the NA messages (Ethertype 0x86dd,
    ICMPv6 type 136) received from the CEs attached to the BD and learn
    dynamic entries from the Target Address and TLLA information. NA
    messages received from remote EVPN PEs are not snooped. A PE
    implementing Proxy ND as in this document [MUST NOT]{.bcp14} create
    dynamic IP-\>MAC entries from NS messages because they don\'t
    contain the R Flag required by the Proxy ND reply function. See
    [Section 3.2.1](#sect-4.1.1){.xref} for more information about the R
    Flag.[¶](#section-3.2-6.4.1){.pilcrow}

    This document specifies an \"anycast\" capability that can be
    configured for the Proxy ND function of the PE and affects how
    dynamic Proxy ND entries are learned based on the O Flag of the
    snooped NA messages. If the O Flag is zero in the received NA
    message, the IP-\>MAC [SHOULD]{.bcp14} only be learned in case the
    IPv6 \"anycast\" capability is enabled in the BD. Irrespective, an
    NA message with O Flag = 0 will be normally forwarded by the PE
    based on a MAC DA lookup.[¶](#section-3.2-6.4.2){.pilcrow}

:   

The following procedure associated to the Learning sub-function is
[RECOMMENDED]{.bcp14}:[¶](#section-3.2-7){.pilcrow}

-   [When a new Proxy ARP/ND EVPN or static active entry is learned (or
    provisioned), the PE [SHOULD]{.bcp14} send a GARP or unsolicited-NA
    message to all the connected access CEs. The PE [SHOULD]{.bcp14}
    send a GARP or unsolicited-NA message for dynamic entries only if
    the ARP/NA message that previously created the entry on the PE was
    NOT flooded to all the local connected CEs before. This
    GARP/unsolicited-NA message makes sure the CE ARP/ND caches are
    updated even if the ARP/NS/NA messages from CEs connected to remote
    PEs are not flooded in the EVPN
    network.[¶](#section-3.2-8.1){.pilcrow}]{#section-3.2-8.1}

Note that if a static entry is provisioned with the same IP as an
existing EVPN-learned or dynamic entry, the static entry takes
precedence.[¶](#section-3.2-9){.pilcrow}

In case of a PE reboot, the static and EVPN entries will be re-added as
soon as the PE is back online and receives all the EVPN routes for the
BD. However, the dynamic entries will be gone. Due to that reason, new
NS and ARP Requests will be flooded by the PE to remote PEs and dynamic
entries gradually relearned again.[¶](#section-3.2-10){.pilcrow}

::: {#sect-4.1.1}
::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Proxy ND and the NA Flags](#name-proxy-nd-and-the-na-flags){.section-name .selfRef} {#name-proxy-nd-and-the-na-flags}

\[[RFC4861](#RFC4861){.xref}\] describes the use of the R Flag in IPv6
address resolution:[¶](#section-3.2.1-1){.pilcrow}

-   [Nodes capable of routing IPv6 packets must reply to NS messages
    with NA messages where the R Flag is set (R Flag =
    1).[¶](#section-3.2.1-2.1){.pilcrow}]{#section-3.2.1-2.1}
-   [Hosts that are not able to route IPv6 packets must indicate that
    inability by replying with NA messages that contain R Flag =
    0.[¶](#section-3.2.1-2.2){.pilcrow}]{#section-3.2.1-2.2}

The use of the R Flag in NA messages has an impact on how hosts select
their default gateways when sending packets off-link, as per
\[[RFC4861](#RFC4861){.xref}\]:[¶](#section-3.2.1-3){.pilcrow}

-   [Hosts build a Default Router List based on the received RAs and NAs
    with R Flag = 1. Each cache entry has an IsRouter flag, which must
    be set for received RAs and is set based on the R Flag in the
    received NAs. A host can choose one or more Default Routers when
    sending packets
    off-link.[¶](#section-3.2.1-4.1){.pilcrow}]{#section-3.2.1-4.1}
-   [In those cases where the IsRouter flag changes from TRUE to FALSE
    as a result of an NA update, the node must remove that router from
    the Default Router List and update the Destination Cache entries for
    all destinations using that neighbor as a router, as specified in
    [Section
    7.3.3](https://www.rfc-editor.org/rfc/rfc4861#section-7.3.3){.relref}
    of \[[RFC4861](#RFC4861){.xref}\]. This is needed to detect when a
    node that is used as a router stops forwarding packets due to being
    configured as a
    host.[¶](#section-3.2.1-4.2){.pilcrow}]{#section-3.2.1-4.2}

The R and O Flags for a Proxy ARP/ND entry will be learned in the
following ways:[¶](#section-3.2.1-5){.pilcrow}

-   [The R Flag information [SHOULD]{.bcp14} be added to the static
    entries by the management interface. The O Flag information
    [MAY]{.bcp14} also be added by the management interface. If the R
    and O Flags are not configured, the default value is
    1.[¶](#section-3.2.1-6.1){.pilcrow}]{#section-3.2.1-6.1}
-   [Dynamic entries [SHOULD]{.bcp14} learn the R Flag and [MAY]{.bcp14}
    learn the O Flag from the snooped NA messages used to learn the
    IP-\>MAC
    itself.[¶](#section-3.2.1-6.2){.pilcrow}]{#section-3.2.1-6.2}
-   [EVPN-learned entries [SHOULD]{.bcp14} learn the R Flag and
    [MAY]{.bcp14} learn the O Flag from the ARP/ND Extended Community
    \[[RFC9047](#RFC9047){.xref}\] received from EVPN along with the RT2
    used to learn the IP-\>MAC itself. If no ARP/ND Extended Community
    is received, the PE will add a configured R Flag / O Flag to the
    entry. These configured R and O Flags [MAY]{.bcp14} be an
    administrative choice with a default value of 1. The configuration
    of this administrative choice provides a backwards-compatible option
    with EVPN PEs that follow \[[RFC7432](#RFC7432){.xref}\] but do not
    support this
    specification.[¶](#section-3.2.1-6.3){.pilcrow}]{#section-3.2.1-6.3}

Note that, typically, IP-\>MAC entries with O = 0 will not be learned;
therefore, the Proxy ND function will reply to NS messages with NA
messages that contain O = 1. However, this document allows the
configuration of the \"anycast\" capability in the BD where the Proxy ND
function is enabled. If \"anycast\" is enabled in the BD and an NA
message with O = 0 is received, the associated IP-\>MAC entry will be
learned with O = 0. If this \"anycast\" capability is enabled in the BD,
duplicate IP detection must be disabled so that the PE is able to learn
the same IP mapped to different MACs in the same Proxy ND table. If the
\"anycast\" capability is disabled, NA messages with O Flag = 0 will not
create a Proxy ND entry (although they will be forwarded normally);
hence, no EVPN advertisement with ARP/ND Extended Community will be
generated.[¶](#section-3.2.1-7){.pilcrow}
:::
:::
:::
:::

::: {#sect-4.2}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Reply Sub-function](#name-reply-sub-function){.section-name .selfRef} {#name-reply-sub-function}

This sub-function will reply to address resolution
requests/solicitations upon successful lookup in the Proxy ARP/ND table
for a given IP address. The following considerations should be taken
into account, assuming that the ARP Request / NS lookup hits a Proxy
ARP/ND entry IP1-\>MAC1:[¶](#section-3.3-1){.pilcrow}

a.  ::: {#section-3.3-2.1}
    When replying to ARP Requests or NS
    messages:[¶](#section-3.3-2.1.1){.pilcrow}

    -   [The PE [SHOULD]{.bcp14} use the Proxy ARP/ND entry MAC address
        MAC1 as MAC SA. This is [RECOMMENDED]{.bcp14} so that the
        resolved MAC can be learned in the MAC forwarding database of
        potential Layer 2 switches sitting between the PE and the CE
        requesting the address
        resolution.[¶](#section-3.3-2.1.2.1){.pilcrow}]{#section-3.3-2.1.2.1}
    -   [For an ARP reply, the PE [MUST]{.bcp14} use the Proxy ARP entry
        IP1 and MAC1 addresses in the sender Protocol Address and
        Hardware Address fields,
        respectively.[¶](#section-3.3-2.1.2.2){.pilcrow}]{#section-3.3-2.1.2.2}
    -   [For an NA message in response to an address resolution NS or
        DAD NS, the PE [MUST]{.bcp14} use IP1 as the IP SA and Target
        Address. M1 [MUST]{.bcp14} be used as the Target Link Local
        Address
        (TLLA).[¶](#section-3.3-2.1.2.3){.pilcrow}]{#section-3.3-2.1.2.3}
    :::

b.  [A PE [SHOULD NOT]{.bcp14} reply to a request/solicitation received
    on the same attachment circuit over which the IP-\>MAC is learned.
    In this case, the requester and the requested IP are assumed to be
    connected to the same Layer 2 CE/access network linked to the PE\'s
    attachment circuit; therefore, the requested IP owner will receive
    the request
    directly.[¶](#section-3.3-2.2){.pilcrow}]{#section-3.3-2.2}

c.  [A PE [SHOULD]{.bcp14} reply to broadcast/multicast address
    resolution messages, i.e., ARP Requests, ARP probes, NS messages, as
    well as DAD NS messages. An ARP probe is an ARP Request constructed
    with an all-zero sender IP address that may be used by hosts for
    IPv4 Address Conflict Detection as specified in
    \[[RFC5227](#RFC5227){.xref}\]. A PE [SHOULD NOT]{.bcp14} reply to
    unicast address resolution requests (for instance, NUD NS
    messages).[¶](#section-3.3-2.3){.pilcrow}]{#section-3.3-2.3}

d.  ::: {#section-3.3-2.4}
    When replying to an NS, a PE [SHOULD]{.bcp14} set the Flags in the
    NA messages as follows:[¶](#section-3.3-2.4.1){.pilcrow}

    -   [The R bit is set as it was learned for the IP-\>MAC entry in
        the NA messages that created the entry (see [Section
        3.2.1](#sect-4.1.1){.xref}).[¶](#section-3.3-2.4.2.1){.pilcrow}]{#section-3.3-2.4.2.1}
    -   [The S Flag will be set/unset as per
        \[[RFC4861](#RFC4861){.xref}\].[¶](#section-3.3-2.4.2.2){.pilcrow}]{#section-3.3-2.4.2.2}
    -   [The O Flag will be set in all the NA messages issued by the PE
        except in the case in which the BD is configured with the
        \"anycast\" capability and the entry was previously learned with
        O = 0. If \"anycast\" is enabled and there is more than one MAC
        for a given IP in the Proxy ND table, the PE will reply to NS
        messages with as many NA responses as \"anycast\" entries there
        are in the Proxy ND
        table.[¶](#section-3.3-2.4.2.3){.pilcrow}]{#section-3.3-2.4.2.3}
    :::

e.  [For Proxy ARP, a PE [MUST]{.bcp14} only reply to ARP Requests with
    the format specified in
    \[[RFC0826](#RFC0826){.xref}\].[¶](#section-3.3-2.5){.pilcrow}]{#section-3.3-2.5}

f.  ::: {#section-3.3-2.6}
    For Proxy ND, a PE [MUST]{.bcp14} reply to NS messages with known
    options with the format and options specified in
    \[[RFC4861](#RFC4861){.xref}\] and [MAY]{.bcp14} reply, discard,
    forward, or unicast-forward NS messages containing other options. An
    administrative choice to control the behavior for received NS
    messages with unknown options (\"reply\", \"discard\",
    \"unicast-forward\", or \"forward\") [MAY]{.bcp14} be
    supported.[¶](#section-3.3-2.6.1){.pilcrow}

    -   [The \"reply\" option implies that the PE ignores the unknown
        options and replies with NA messages, assuming a successful
        lookup on the Proxy ND table. An unsuccessful lookup will result
        in a \"forward\" behavior (i.e., flood the NS message based on
        the MAC
        DA).[¶](#section-3.3-2.6.2.1){.pilcrow}]{#section-3.3-2.6.2.1}
    -   [If \"discard\" is available, the operator should assess if
        flooding NS unknown options may be a security risk for the EVPN
        BD (and if so, enable \"discard\") or, on the contrary, if not
        forwarding/flooding NS unknown options may disrupt connectivity.
        This option discards NS messages with unknown options
        irrespective of the result of the lookup on the Proxy ND
        table.[¶](#section-3.3-2.6.2.2){.pilcrow}]{#section-3.3-2.6.2.2}
    -   [The \"unicast-forward\" option is described in [Section
        3.4](#sect-4.3){.xref}.[¶](#section-3.3-2.6.2.3){.pilcrow}]{#section-3.3-2.6.2.3}
    -   [The \"forward\" option implies flooding the NS message based on
        the MAC DA. This option forwards NS messages with unknown
        options irrespective of the result of the lookup on the Proxy ND
        table. The \"forward\" option is [RECOMMENDED]{.bcp14} by this
        document.[¶](#section-3.3-2.6.2.4){.pilcrow}]{#section-3.3-2.6.2.4}
    :::
:::
:::

::: {#sect-4.3}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Unicast-Forward Sub-function](#name-unicast-forward-sub-functio){.section-name .selfRef} {#name-unicast-forward-sub-functio}

As discussed in [Section 3.3](#sect-4.2){.xref}, in some cases, the
operator may want to \"unicast-forward\" certain ARP Requests and NS
messages as opposed to reply to them. The implementation of a
\"unicast-forward\" function is [RECOMMENDED]{.bcp14}. This option can
be enabled with one of the following
parameters:[¶](#section-3.4-1){.pilcrow}

a.  [unicast-forward
    always[¶](#section-3.4-2.1){.pilcrow}]{#section-3.4-2.1}
b.  [unicast-forward
    unknown-options[¶](#section-3.4-2.2){.pilcrow}]{#section-3.4-2.2}

If \"unicast-forward always\" is enabled, the PE will perform a Proxy
ARP/ND table lookup and, in case of a hit, the PE will forward the
packet to the owner of the MAC found in the Proxy ARP/ND table. This is
irrespective of the options carried in the ARP/ND packet. This option
provides total transparency in the BD and yet reduces the amount of
flooding significantly.[¶](#section-3.4-3){.pilcrow}

If \"unicast-forward unknown-options\" is enabled, upon a successful
Proxy ARP/ND lookup, the PE will perform a \"unicast-forward\" action
only if the ARP Requests or NS messages carry unknown options, as
explained in [Section 3.3](#sect-4.2){.xref}. The \"unicast-forward
unknown-options\" configuration allows the support of new applications
using ARP/ND in the BD while still reducing the
flooding.[¶](#section-3.4-4){.pilcrow}

Irrespective of the enabled option, if there is no successful Proxy
ARP/ND lookup, the unknown ARP Request / NS message will be flooded in
the context of the BD, as per [Section
3.6](#sect-4.5){.xref}.[¶](#section-3.4-5){.pilcrow}
:::
:::

::: {#sect-4.4}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Maintenance Sub-function](#name-maintenance-sub-function){.section-name .selfRef} {#name-maintenance-sub-function}

The Proxy ARP/ND tables [SHOULD]{.bcp14} follow a number of maintenance
procedures so that the dynamic IP-\>MAC entries are kept if the owner is
active and flushed (and the associated RT2 withdrawn) or if the owner is
no longer in the network. The following procedures are
[RECOMMENDED]{.bcp14}:[¶](#section-3.5-1){.pilcrow}

[]{.break}

Age-time:
:   A dynamic Proxy ARP/ND entry [MUST]{.bcp14} be flushed out of the
    table if the IP-\>MAC has not been refreshed within a given
    age-time. The entry is refreshed if an ARP or NA message is received
    for the same IP-\>MAC entry. The age-time is an administrative
    option, and its value should be carefully chosen depending on the
    specific use case; in IXP networks (where the CE routers are fairly
    static), the age-time may normally be longer than in DC networks
    (where mobility is required).[¶](#section-3.5-2.2){.pilcrow}
:   

Send-refresh option:

:   The PE [MAY]{.bcp14} send periodic refresh messages (ARP/ND
    \"probes\") to the owners of the dynamic Proxy ARP/ND entries, so
    that the entries can be refreshed before they age out. The owner of
    the IP-\>MAC entry would reply to the ARP/ND probe and the
    corresponding entry age-time reset. The periodic send-refresh timer
    is an administrative option and is [RECOMMENDED]{.bcp14} to be a
    third of the age-time or a half of the age-time in scaled
    networks.[¶](#section-3.5-2.4.1){.pilcrow}

    An ARP refresh issued by the PE will be an ARP Request message with
    the sender\'s IP = 0 sent from the PE\'s MAC SA. If the PE has an IP
    address in the subnet, for instance, on an Integrated Routing and
    Bridging (IRB) interface, then it [MAY]{.bcp14} use it as a source
    for the ARP Request (instead of sender\'s IP = 0). An ND refresh
    will be an NS message issued from the PE\'s MAC SA and a Link Local
    Address associated to the PE\'s
    MAC.[¶](#section-3.5-2.4.2){.pilcrow}

    The refresh request messages [SHOULD]{.bcp14} be sent only for
    dynamic entries and not for static or EVPN-learned entries. Even
    though the refresh request messages are broadcast or multicast, the
    PE [SHOULD]{.bcp14} only send the message to the attachment circuit
    associated to the MAC in the IP-\>MAC
    entry.[¶](#section-3.5-2.4.3){.pilcrow}

:   

The age-time and send-refresh options are used in EVPN networks to avoid
unnecessary EVPN RT2 withdrawals; if refresh messages are sent before
the corresponding BD Bridge-Table and Proxy ARP/ND age-time for a given
entry expires, inactive but existing hosts will reply, refreshing the
entry and therefore avoiding unnecessary EVPN MAC/IP Advertisement
withdrawals in EVPN. Both entries (MAC in the BD and IP-\>MAC in the
Proxy ARP/ND) are reset when the owner replies to the ARP/ND probe. If
there is no response to the ARP/ND probe, the MAC and IP-\>MAC entries
will be legitimately flushed and the RT2s
withdrawn.[¶](#section-3.5-3){.pilcrow}
:::
:::

::: {#sect-4.5}
::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [Flood (to Remote PEs) Handling](#name-flood-to-remote-pes-handlin){.section-name .selfRef} {#name-flood-to-remote-pes-handlin}

The Proxy ARP/ND function implicitly helps reduce the flooding of ARP
Requests and NS messages to remote PEs in an EVPN network. However, in
certain use cases, the flooding of ARP/NS/NA messages (and even the
unknown unicast flooding) to remote PEs can be suppressed completely in
an EVPN network.[¶](#section-3.6-1){.pilcrow}

For instance, in an IXP network, since all the participant CEs are well
known and will not move to a different PE, the IP-\>MAC entries for the
local CEs may be all provisioned on the PEs by a management system.
Assuming the entries for the CEs are all provisioned on the local PE, a
given Proxy ARP/ND table will only contain static and EVPN-learned
entries. In this case, the operator may choose to suppress the flooding
of ARP/NS/NA from the local PE to the remote PEs
completely.[¶](#section-3.6-2){.pilcrow}

The flooding may also be suppressed completely in IXP networks with
dynamic Proxy ARP/ND entries assuming that all the CEs are directly
connected to the PEs and that they all advertise their presence with a
GARP/unsolicited-NA when they connect to the network. If any of those
two assumptions are not true and any of the PEs may not learn all the
local Proxy ARP/ND entries, flooding of the ARP/NS/NA messages from the
local PE to the remote PEs [SHOULD NOT]{.bcp14} be suppressed, or the
address resolution process for some CEs will not be
completed.[¶](#section-3.6-3){.pilcrow}

In networks where fast mobility is expected (DC use case), it is [NOT
RECOMMENDED]{.bcp14} to suppress the flooding of unknown ARP Requests /
NS messages or GARPs/unsolicited-NAs. Unknown ARP Requests / NS messages
refer to those ARP Requests / NS messages for which the Proxy ARP/ND
lookups for the requested IPs do not
succeed.[¶](#section-3.6-4){.pilcrow}

In order to give the operator the choice to suppress/allow the flooding
to remote PEs, a PE [MAY]{.bcp14} support administrative options to
individually suppress/allow the flooding
of:[¶](#section-3.6-5){.pilcrow}

-   [Unknown ARP Requests and NS
    messages.[¶](#section-3.6-6.1){.pilcrow}]{#section-3.6-6.1}
-   [GARP and unsolicited-NA
    messages.[¶](#section-3.6-6.2){.pilcrow}]{#section-3.6-6.2}

The operator will use these options based on the expected behavior on
the CEs.[¶](#section-3.6-7){.pilcrow}
:::
:::

::: {#sect-4.6}
::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Duplicate IP Detection](#name-duplicate-ip-detection){.section-name .selfRef} {#name-duplicate-ip-detection}

The Proxy ARP/ND function [MUST]{.bcp14} support duplicate IP detection
as per this section so that ARP/ND-spoofing attacks or duplicate IPs due
to human errors can be detected. For IPv6 addresses, CEs will continue
to carry out the DAD procedures as per \[[RFC4862](#RFC4862){.xref}\].
The solution described in this section is an additional security
mechanism carried out by the PEs that guarantees IPv6 address moves
between PEs are legitimate and not the result of an attack.
\[[RFC6957](#RFC6957){.xref}\] describes a solution for the IPv6
Duplicate Address Detection Proxy; however, it is defined for
point-to-multipoint topologies with a split-horizon forwarding, where
the \"CEs\" have no direct communication within the same L2 link;
therefore, it is not suitable for EVPN Broadcast Domains. In addition,
the solution described in this section includes the use of the AS-MAC
for additional security.[¶](#section-3.7-1){.pilcrow}

ARP/ND spoofing is a technique whereby an attacker sends \"fake\" ARP/ND
messages onto a Broadcast Domain. Generally, the aim is to associate the
attacker\'s MAC address with the IP address of another host causing any
traffic meant for that IP address to be sent to the attacker
instead.[¶](#section-3.7-2){.pilcrow}

The distributed nature of EVPN and Proxy ARP/ND allows the easy
detection of duplicated IPs in the network in a similar way to the MAC
duplication detection function supported by
\[[RFC7432](#RFC7432){.xref}\] for MAC
addresses.[¶](#section-3.7-3){.pilcrow}

Duplicate IP detection monitors \"IP-moves\" in the Proxy ARP/ND table
in the following way:[¶](#section-3.7-4){.pilcrow}

a.  [When an existing active IP1-\>MAC1 entry is modified, a PE starts
    an M-second timer (default value of M = 180), and if it detects N IP
    moves before the timer expires (default value of N = g5), it
    concludes that a duplicate IP situation has occurred. An IP move is
    considered when, for instance, IP1-\>MAC1 is replaced by IP1-\>MAC2
    in the Proxy ARP/ND table. Static IP-\>MAC entries, i.e., locally
    provisioned or EVPN-learned entries with I = 1 in the ARP/ND
    Extended Community, are not subject to this procedure. Static
    entries [MUST NOT]{.bcp14} be overridden by dynamic Proxy ARP/ND
    entries.[¶](#section-3.7-5.1){.pilcrow}]{#section-3.7-5.1}

b.  ::: {#section-3.7-5.2}
    In order to detect the duplicate IP faster, the PE [SHOULD]{.bcp14}
    send a Confirm message to the former owner of the IP. A Confirm
    message is a unicast ARP Request / NS message sent by the PE to the
    MAC addresses that previously owned the IP, when the MAC changes in
    the Proxy ARP/ND table. The Confirm message uses a sender\'s IP
    0.0.0.0 in case of ARP (if the PE has an IP address in the subnet,
    then it [MAY]{.bcp14} use it) and an IPv6 Link Local Address in case
    of NS. If the PE does not receive an answer within a given time, the
    new entry will be confirmed and activated. The default
    [RECOMMENDED]{.bcp14} time to receive the confirmation is 30
    seconds. In case of spoofing, for instance, if IP1-\>MAC1 moves to
    IP1-\>MAC2, the PE may send a unicast ARP Request / NS message for
    IP1 with MAC DA = MAC1 and MAC SA = PE\'s MAC. This will force the
    legitimate owner to respond if the move to MAC2 was spoofed and make
    the PE issue another Confirm message, this time to MAC DA = MAC2. If
    both, the legitimate owner and spoofer keep replying to the Confirm
    message. The PE would then detect the duplicate IP within the
    M-second timer, and a response would be triggered as
    follows:[¶](#section-3.7-5.2.1){.pilcrow}

    -   [If the IP1-\>MAC1 pair was previously owned by the spoofer and
        the new IP1-\>MAC2 was from a valid CE, then the issued Confirm
        message would trigger a response from the
        spoofer.[¶](#section-3.7-5.2.2.1){.pilcrow}]{#section-3.7-5.2.2.1}
    -   [If it were the other way around, that is, IP1-\>MAC1 was
        previously owned by a valid CE, the Confirm message would
        trigger a response from the
        CE.[¶](#section-3.7-5.2.2.2){.pilcrow}]{#section-3.7-5.2.2.2}

    ```{=html}
    <!-- -->
    ```
    -   [Either way, if this process continues, then duplicate detection
        will kick
        in.[¶](#section-3.7-5.2.3.1){.pilcrow}]{#section-3.7-5.2.3.1}
    :::

c.  ::: {#section-3.7-5.3}
    Upon detecting a duplicate IP
    situation:[¶](#section-3.7-5.3.1){.pilcrow}

    1.  [The entry in duplicate detected state cannot be updated with
        new dynamic or EVPN-learned entries for the same IP. The
        operator [MAY]{.bcp14} override the entry, though, with a static
        IP-\>MAC.[¶](#section-3.7-5.3.2.1){.pilcrow}]{#section-3.7-5.3.2.1}
    2.  [The PE [SHOULD]{.bcp14} alert the operator and stop responding
        to ARP/NS for the duplicate IP until a corrective action is
        taken.[¶](#section-3.7-5.3.2.2){.pilcrow}]{#section-3.7-5.3.2.2}
    3.  [Optionally, the PE [MAY]{.bcp14} associate an
        \"anti-spoofing-mac\" (AS-MAC) to the duplicate IP in the Proxy
        ARP/ND table. The PE will send a GARP/unsolicited-NA message
        with IP1-\>AS-MAC to the local CEs as well as an RT2 (with
        IP1-\>AS-MAC) to the remote PEs. This will update the ARP/ND
        caches on all the CEs in the BD; hence, all the CEs in the BD
        will use the AS-MAC as MAC DA when sending traffic to IP1. This
        procedure prevents the spoofer from attracting any traffic for
        IP1. Since the AS-MAC is a managed MAC address known by all the
        PEs in the BD, all the PEs [MAY]{.bcp14} apply filters to drop
        and/or log any frame with MAC DA = AS-MAC. The advertisement of
        the AS-MAC as a \"drop-MAC\" (by using an indication in the RT2)
        that can be used directly in the BD to drop frames is for
        further
        study.[¶](#section-3.7-5.3.2.3){.pilcrow}]{#section-3.7-5.3.2.3}
    :::

d.  [The duplicate IP situation will be cleared when a corrective action
    is taken by the operator or, alternatively, after a HOLD-DOWN timer
    (default value of 540
    seconds).[¶](#section-3.7-5.4){.pilcrow}]{#section-3.7-5.4}

The values of M, N, and HOLD-DOWN timer [SHOULD]{.bcp14} be a
configurable administrative option to allow for the required flexibility
in different scenarios.[¶](#section-3.7-6){.pilcrow}

For Proxy ND, the duplicate IP detection described in this section
[SHOULD]{.bcp14} only monitor IP moves for IP-\>MACs learned from NA
messages with O Flag = 1. NA messages with O Flag = 0 would not override
the ND cache entries for an existing IP; therefore, the procedure in
this section would not detect duplicate IPs. This duplicate IP detection
for IPv6 [SHOULD]{.bcp14} be disabled when the IPv6 \"anycast\"
capability is activated in a given BD.[¶](#section-3.7-7){.pilcrow}
:::
:::
:::
:::

::: {#sect-5}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Solution Benefits](#name-solution-benefits){.section-name .selfRef} {#name-solution-benefits}

The solution described in this document provides the following
benefits:[¶](#section-4-1){.pilcrow}

a.  [May completely suppress the flooding of the ARP/ND messages in the
    EVPN network, assuming that all the CE IP-\>MAC addresses local to
    the PEs are known or provisioned on the PEs from a management
    system. Note that in this case, the unknown unicast flooded traffic
    can also be suppressed, since all the expected unicast traffic will
    be destined to known MAC addresses in the PE
    BDs.[¶](#section-4-2.1){.pilcrow}]{#section-4-2.1}
b.  [Significantly reduces the flooding of the ARP/ND messages in the
    EVPN network, assuming that some or all the CE IP-\>MAC addresses
    are learned on the data plane by snooping ARP/ND messages issued by
    the CEs.[¶](#section-4-2.2){.pilcrow}]{#section-4-2.2}
c.  [Provides a way to refresh periodically the CE IP-\>MAC entries
    learned through the data plane so that the IP-\>MAC entries are not
    withdrawn by EVPN when they age out unless the CE is not active
    anymore. This option helps reducing the EVPN control plane overhead
    in a network with active CEs that do not send packets
    frequently.[¶](#section-4-2.3){.pilcrow}]{#section-4-2.3}
d.  [Provides a mechanism to detect duplicate IP addresses and avoid
    ARP/ND-spoof attacks or the effects of duplicate addresses due to
    human errors.[¶](#section-4-2.4){.pilcrow}]{#section-4-2.4}
:::
:::

::: {#sect-6}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Deployment Scenarios](#name-deployment-scenarios){.section-name .selfRef} {#name-deployment-scenarios}

Four deployment scenarios with different levels of ARP/ND control are
available to operators using this solution depending on their
requirements to manage ARP/ND: all dynamic learning, all dynamic
learning with Proxy ARP/ND, hybrid dynamic learning and static
provisioning with Proxy ARP/ND, and all static provisioning with Proxy
ARP/ND.[¶](#section-5-1){.pilcrow}

::: {#sect-6.1}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [All Dynamic Learning](#name-all-dynamic-learning){.section-name .selfRef} {#name-all-dynamic-learning}

In this scenario for minimum security and mitigation, EVPN is deployed
in the BD with the Proxy ARP/ND function shutdown. PEs do not intercept
ARP/ND requests and flood all requests issued by the CEs as a
conventional Layer 2 network among those CEs would suffice. While no
ARP/ND mitigation is used in this scenario, the operator can still take
advantage of EVPN features such as control plane learning and all-active
multihoming in the peering network.[¶](#section-5.1-1){.pilcrow}

Although this option does not require any of the procedures described in
this document, it is added as a baseline/default option for
completeness. This option is equivalent to VPLS as far as ARP/ND is
concerned. The options described in Sections [5.2](#sect-6.2){.xref},
[5.3](#sect-6.3){.xref}, and [5.4](#sect-6.4){.xref} are only possible
in EVPN networks in combination with their Proxy ARP/ND
capabilities.[¶](#section-5.1-2){.pilcrow}
:::
:::

::: {#sect-6.2}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Dynamic Learning with Proxy ARP/ND](#name-dynamic-learning-with-proxy){.section-name .selfRef} {#name-dynamic-learning-with-proxy}

This scenario minimizes flooding while enabling dynamic learning of
IP-\>MAC entries. The Proxy ARP/ND function is enabled in the BDs of the
EVPN PEs so that the PEs snoop ARP/ND messages issued by the CEs and
respond to CE ARP Requests / NS messages.[¶](#section-5.2-1){.pilcrow}

PEs will flood requests if the entry is not in their Proxy table. Any
unknown source IP-\>MAC entries will be learned and advertised in EVPN,
and traffic to unknown entries is discarded at the ingress
PE.[¶](#section-5.2-2){.pilcrow}

This scenario makes use of the Learning, Reply, and Maintenance
sub-functions, with an optional use of the Unicast-forward and duplicate
IP detection sub-functions. The Flood handling sub-function uses default
flooding for unknown ARP Requests / NS
messages.[¶](#section-5.2-3){.pilcrow}
:::
:::

::: {#sect-6.3}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Hybrid Dynamic Learning and Static Provisioning with Proxy ARP/ND](#name-hybrid-dynamic-learning-and){.section-name .selfRef} {#name-hybrid-dynamic-learning-and}

Some IXPs and other operators want to protect particular hosts on the BD
while allowing dynamic learning of CE addresses. For example, an
operator may want to configure static IP-\>MAC entries for management
and infrastructure hosts that provide critical services. In this
scenario, static entries are provisioned from the management plane for
protected IP-\>MAC addresses, and dynamic learning with Proxy ARP/ND is
enabled as described in [Section 5.2](#sect-6.2){.xref} on the
BD.[¶](#section-5.3-1){.pilcrow}

This scenario makes use of the same sub-functions as in [Section
5.2](#sect-6.2){.xref} but with static entries added by the Learning
sub-function.[¶](#section-5.3-2){.pilcrow}
:::
:::

::: {#sect-6.4}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [All Static Provisioning with Proxy ARP/ND](#name-all-static-provisioning-wit){.section-name .selfRef} {#name-all-static-provisioning-wit}

For a solution that maximizes security and eliminates flooding and
unknown unicast in the peering network, all IP-\>MAC entries are
provisioned from the management plane. The Proxy ARP/ND function is
enabled in the BDs of the EVPN PEs so that the PEs intercept and respond
to CE requests. Dynamic learning and ARP/ND snooping is disabled so that
ARP Requests and NS messages to unknown IPs are discarded at the ingress
PE. This scenario provides an operator the most control over IP-\>MAC
entries and allows an operator to manage all entries from a management
system.[¶](#section-5.4-1){.pilcrow}

In this scenario, the Learning sub-function is limited to static
entries, the Maintenance sub-function will not require any procedures
due to the static entries, and the Flood handling sub-function will
completely suppress unknown ARP Requests / NS messages as well as GARP
and unsolicited-NA messages.[¶](#section-5.4-2){.pilcrow}
:::
:::

::: {#sect-6.5}
::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Example of Deployment in Internet Exchange Points](#name-example-of-deployment-in-in){.section-name .selfRef} {#name-example-of-deployment-in-in}

Nowadays, almost all IXPs install some security rules in order to
protect the peering network (BD). These rules are often called port
security. Port security summarizes different operational steps that
limit the access to the IXP-LAN and the customer router and controls the
kind of traffic that the routers are allowed to exchange (e.g.,
Ethernet, IPv4, and IPv6). Due to this, the deployment scenario as
described in [Section 5.4](#sect-6.4){.xref}, \"All Static Provisioning
with Proxy ARP/ND\", is the predominant scenario for
IXPs.[¶](#section-5.5-1){.pilcrow}

In addition to the \"All Static Provisioning\" behavior, in IXP networks
it is recommended to configure the Reply sub-function to \"discard\" ARP
Requests / NS messages with unrecognized
options.[¶](#section-5.5-2){.pilcrow}

At IXPs, customers usually follow a certain operational life cycle. For
each step of the operational life cycle, specific operational procedures
are executed.[¶](#section-5.5-3){.pilcrow}

The following describes the operational procedures that are needed to
guarantee port security throughout the life cycle of a customer with
focus on EVPN features:[¶](#section-5.5-4){.pilcrow}

1.  ::: {#section-5.5-5.1}
    A new customer is connected the first time to the
    IXP:[¶](#section-5.5-5.1.1){.pilcrow}

    Before the connection between the customer router and the IXP-LAN is
    activated, the MAC of the router is allowlisted on the IXP\'s switch
    port. All other MAC addresses are blocked. Pre-defined IPv4 and IPv6
    addresses of the IXP peering network space are configured at the
    customer router. The IP-\>MAC static entries (IPv4 and IPv6) are
    configured in the management system of the IXP for the customer\'s
    port in order to support Proxy
    ARP/ND.[¶](#section-5.5-5.1.2){.pilcrow}

    In case a customer uses multiple ports aggregated to a single
    logical port (LAG), some vendors randomly select the MAC address of
    the LAG from the different MAC addresses assigned to the ports. In
    this case, the static entry will be used and associated to a list of
    allowed MACs.[¶](#section-5.5-5.1.3){.pilcrow}
    :::

2.  ::: {#section-5.5-5.2}
    Replacement of customer router:[¶](#section-5.5-5.2.1){.pilcrow}

    If a customer router is about to be replaced, the new MAC
    address(es) must be installed in the management system in addition
    to the MAC address(es) of the currently connected router. This
    allows the customer to replace the router without any active
    involvement of the IXP operator. For this, static entries are also
    used. After the replacement takes place, the MAC address(es) of the
    replaced router can be removed.[¶](#section-5.5-5.2.2){.pilcrow}
    :::

3.  ::: {#section-5.5-5.3}
    Decommissioning a customer router:[¶](#section-5.5-5.3.1){.pilcrow}

    If a customer router is decommissioned, the router is disconnected
    from the IXP PE. Right after that, the MAC address(es) of the router
    and IP-\>MAC bindings can be removed from the management
    system.[¶](#section-5.5-5.3.2){.pilcrow}
    :::
:::
:::

::: {#sect-6.6}
::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [Example of Deployment in Data Centers](#name-example-of-deployment-in-da){.section-name .selfRef} {#name-example-of-deployment-in-da}

DCs normally have different requirements than IXPs in terms of Proxy
ARP/ND. Some differences are listed below:[¶](#section-5.6-1){.pilcrow}

a.  [The required mobility in virtualized DCs makes the \"Dynamic
    Learning\" or \"Hybrid Dynamic and Static Provisioning\" models more
    appropriate than the \"All Static Provisioning\"
    model.[¶](#section-5.6-2.1){.pilcrow}]{#section-5.6-2.1}
b.  [IPv6 \"anycast\" may be required in DCs, while it is typically not
    a requirement in IXP networks. Therefore, if the DC needs IPv6
    anycast addresses, the \"anycast\" capability will be explicitly
    enabled in the Proxy ND function and hence the Proxy ND
    sub-functions modified accordingly. For instance, if IPv6
    \"anycast\" is enabled in the Proxy ND function, the duplicate IP
    detection procedure in [Section 3.7](#sect-4.6){.xref} must be
    disabled.[¶](#section-5.6-2.2){.pilcrow}]{#section-5.6-2.2}
c.  [DCs may require special options on ARP/ND as opposed to the address
    resolution function, which is the only one typically required in
    IXPs. Based on that, the Reply sub-function may be modified to
    forward or discard unknown
    options.[¶](#section-5.6-2.3){.pilcrow}]{#section-5.6-2.3}
:::
:::
:::
:::

::: {#sect-7}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations of \[[RFC7432](#RFC7432){.xref}\] and
\[[RFC9047](#RFC9047){.xref}\] apply to this document too. Note that
EVPN does not inherently provide cryptographic protection (including
confidentiality protection).[¶](#section-6-1){.pilcrow}

The procedures in this document reduce the amount of ARP/ND message
flooding, which in itself provides a protection to \"slow path\"
software processors of routers and Tenant Systems in large BDs. The
ARP/ND requests that are replied to by the Proxy ARP/ND function (hence
not flooded) are normally targeted to existing hosts in the BD. ARP/ND
requests targeted to absent hosts are still normally flooded; however,
the suppression of unknown ARP Requests and NS messages described in
[Section 3.6](#sect-4.5){.xref} can provide an additional level of
security against ARP Requests / NS messages issued to non-existing
hosts.[¶](#section-6-2){.pilcrow}

While the unicast-forward and/or flood suppression sub-functions provide
an added security mechanism for the BD, they can also increase the risk
of blocking the service for a CE if the EVPN PEs cannot provide the
ARP/ND resolution that the CE needs.[¶](#section-6-3){.pilcrow}

The solution also provides protection against Denial-of-Service (DoS)
attacks that use ARP/ND spoofing as a first step. The duplicate IP
detection and the use of an AS-MAC as explained in [Section
3.7](#sect-4.6){.xref} protects the BD against ARP/ND
spoofing.[¶](#section-6-4){.pilcrow}

The Proxy ARP/ND function specified in this document does not allow for
the learning of an IP address mapped to multiple MAC addresses in the
same table unless the \"anycast\" capability is enabled (and only in
case of Proxy ND). When \"anycast\" is enabled in the Proxy ND function,
the number of allowed entries for the same IP address [MUST]{.bcp14} be
limited by the operator to prevent DoS attacks that attempt to fill the
Proxy ND table with a significant number of entries for the same
IP.[¶](#section-6-5){.pilcrow}

This document provides some examples and guidelines that can be used by
IXPs in their EVPN BDs. When EVPN and its associated Proxy ARP/ND
function are used in IXP networks, they provide ARP/ND security and
mitigation. IXPs must still employ additional security mechanisms that
protect the peering network as per the established BCPs such as the ones
described in \[[EURO-IX-BCP](#EURO-IX-BCP){.xref}\]. For example, IXPs
should disable all unneeded control protocols and block unwanted
protocols from CEs so that only IPv4, ARP, and IPv6 Ethertypes are
permitted on the peering network. In addition, port security features
and ACLs can provide an additional level of
security.[¶](#section-6-6){.pilcrow}

Finally, it is worth noting that the Proxy ARP/ND solution in this
document will not work if there is a mechanism securing ARP/ND exchanges
among CEs because the PE is not able to secure the \"proxied\" ND
messages.[¶](#section-6-7){.pilcrow}
:::
:::

::: {#sect-8}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-7-1){.pilcrow}
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0826\]
:   [Plummer, D.]{.refAuthor}, [\"An Ethernet Address Resolution
    Protocol: Or Converting Network Protocol Addresses to 48.bit
    Ethernet Address for Transmission on Ethernet
    Hardware\"]{.refTitle}, [STD 37]{.seriesInfo}, [RFC
    826]{.seriesInfo}, [DOI 10.17487/RFC0826]{.seriesInfo}, November
    1982, \<<https://www.rfc-editor.org/info/rfc826>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4861\]
:   [Narten, T.]{.refAuthor}, [Nordmark, E.]{.refAuthor},
    [Simpson, W.]{.refAuthor}, and [H. Soliman]{.refAuthor}, [\"Neighbor
    Discovery for IP version 6 (IPv6)\"]{.refTitle}, [RFC
    4861]{.seriesInfo}, [DOI 10.17487/RFC4861]{.seriesInfo}, September
    2007, \<<https://www.rfc-editor.org/info/rfc4861>\>.
:   

\[RFC5227\]
:   [Cheshire, S.]{.refAuthor}, [\"IPv4 Address Conflict
    Detection\"]{.refTitle}, [RFC 5227]{.seriesInfo}, [DOI
    10.17487/RFC5227]{.seriesInfo}, July 2008,
    \<<https://www.rfc-editor.org/info/rfc5227>\>.
:   

\[RFC7432\]
:   [Sajassi, A., Ed.]{.refAuthor}, [Aggarwal, R.]{.refAuthor},
    [Bitar, N.]{.refAuthor}, [Isaac, A.]{.refAuthor},
    [Uttaro, J.]{.refAuthor}, [Drake, J.]{.refAuthor}, and [W.
    Henderickx]{.refAuthor}, [\"BGP MPLS-Based Ethernet
    VPN\"]{.refTitle}, [RFC 7432]{.seriesInfo}, [DOI
    10.17487/RFC7432]{.seriesInfo}, February 2015,
    \<<https://www.rfc-editor.org/info/rfc7432>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC9047\]
:   [Rabadan, J., Ed.]{.refAuthor}, [Sathappan, S.]{.refAuthor},
    [Nagaraj, K.]{.refAuthor}, and [W. Lin]{.refAuthor}, [\"Propagation
    of ARP/ND Flags in an Ethernet Virtual Private Network
    (EVPN)\"]{.refTitle}, [RFC 9047]{.seriesInfo}, [DOI
    10.17487/RFC9047]{.seriesInfo}, June 2021,
    \<<https://www.rfc-editor.org/info/rfc9047>\>.
:   
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[EURO-IX-BCP\]
:   [Euro-IX]{.refAuthor}, [\"European Internet Exchange
    Association\"]{.refTitle},
    \<<https://www.euro-ix.net/en/forixps/set-ixp/ixp-bcops>\>.
:   

\[RFC4862\]
:   [Thomson, S.]{.refAuthor}, [Narten, T.]{.refAuthor}, and [T.
    Jinmei]{.refAuthor}, [\"IPv6 Stateless Address
    Autoconfiguration\"]{.refTitle}, [RFC 4862]{.seriesInfo}, [DOI
    10.17487/RFC4862]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4862>\>.
:   

\[RFC6820\]
:   [Narten, T.]{.refAuthor}, [Karir, M.]{.refAuthor}, and [I.
    Foo]{.refAuthor}, [\"Address Resolution Problems in Large Data
    Center Networks\"]{.refTitle}, [RFC 6820]{.seriesInfo}, [DOI
    10.17487/RFC6820]{.seriesInfo}, January 2013,
    \<<https://www.rfc-editor.org/info/rfc6820>\>.
:   

\[RFC6957\]
:   [Costa, F.]{.refAuthor}, [Combes, J-M., Ed.]{.refAuthor},
    [Pougnard, X.]{.refAuthor}, and [H. Li]{.refAuthor}, [\"Duplicate
    Address Detection Proxy\"]{.refTitle}, [RFC 6957]{.seriesInfo}, [DOI
    10.17487/RFC6957]{.seriesInfo}, June 2013,
    \<<https://www.rfc-editor.org/info/rfc6957>\>.
:   
:::
:::

::: {#sect-10}
::: {#appendix-A .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors want to thank [Ranganathan Boovaraghavan]{.contact-name},
[Sriram Venkateswaran]{.contact-name}, [Manish Krishnan]{.contact-name},
[Seshagiri Venugopal]{.contact-name}, [Tony Przygienda]{.contact-name},
[Robert Raszuk]{.contact-name}, and [Iftekhar Hussain]{.contact-name}
for their review and contributions. Thank you to [Oliver
Knapp]{.contact-name} as well for his detailed
review.[¶](#appendix-A-1){.pilcrow}
:::
:::

::: {#sect-11}
::: {#appendix-B .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

In addition to the authors listed on the front page, the following
coauthors have also contributed to this
document:[¶](#appendix-B-1){.pilcrow}

::: {.left dir="auto"}
[Wim Henderickx]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: {.left dir="auto"}
[Daniel Melzer]{.fn .nameRole}
:::

::: {.left dir="auto"}
[DE-CIX Management GmbH]{.org}
:::

::: {.left dir="auto"}
[Erik Nordmark]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Zededa]{.org}
:::
:::
:::

::: {#authors-addresses}
::: {#appendix-C .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Jorge Rabadan ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: {.left dir="auto"}
[777 Middlefield Road]{.street-address}
:::

::: {.left dir="auto"}
[Mountain View]{.locality}, [CA]{.region} [94043]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <jorge.rabadan@nokia.com>
:::

::: {.left dir="auto"}
[Senthil Sathappan]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: {.left dir="auto"}
[701 E. Middlefield Road]{.street-address}
:::

::: {.left dir="auto"}
[Mountain View]{.locality}, [CA]{.region} [94043]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <senthil.sathappan@nokia.com>
:::

::: {.left dir="auto"}
[Kiran Nagaraj]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: {.left dir="auto"}
[701 E. Middlefield Road]{.street-address}
:::

::: {.left dir="auto"}
[Mountain View]{.locality}, [CA]{.region} [94043]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <kiran.nagaraj@nokia.com>
:::

::: {.left dir="auto"}
[Greg Hankins]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: email
Email: <greg.hankins@nokia.com>
:::

::: {.left dir="auto"}
[Thomas King]{.fn .nameRole}
:::

::: {.left dir="auto"}
[DE-CIX Management GmbH]{.org}
:::

::: email
Email: <thomas.king@de-cix.net>
:::
:::
:::
