  RFC 8664            PCEP Extensions for Segment Routing   December 2019
  ------------------- ------------------------------------- ---------------
  Sivabalan, et al.   Standards Track                       \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8664](https://www.rfc-editor.org/rfc/rfc8664){.eref}

Updates:
:   [8408](https://www.rfc-editor.org/rfc/rfc8408){.eref}

Category:
:   Standards Track

Published:
:   December 2019

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    S. Sivabalan
    :::

    ::: org
    Cisco Systems, Inc.
    :::
    :::

    ::: author
    ::: author-name
    C. Filsfils
    :::

    ::: org
    Cisco Systems, Inc.
    :::
    :::

    ::: author
    ::: author-name
    J. Tantsura
    :::

    ::: org
    Apstra, Inc.
    :::
    :::

    ::: author
    ::: author-name
    W. Henderickx
    :::

    ::: org
    Nokia
    :::
    :::

    ::: author
    ::: author-name
    J. Hardwick
    :::

    ::: org
    Metaswitch Networks
    :::
    :::
:::

# RFC 8664 {#rfcnum}

# Path Computation Element Communication Protocol (PCEP) Extensions for Segment Routing {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

Segment Routing (SR) enables any head-end node to select any path
without relying on a hop-by-hop signaling technique (e.g., LDP or
RSVP-TE). It depends only on \"segments\" that are advertised by
link-state Interior Gateway Protocols (IGPs). An SR path can be derived
from a variety of mechanisms, including an IGP Shortest Path Tree (SPT),
an explicit configuration, or a Path Computation Element (PCE). This
document specifies extensions to the Path Computation Element
Communication Protocol (PCEP) that allow a stateful PCE to compute and
initiate Traffic-Engineering (TE) paths, as well as a Path Computation
Client (PCC) to request a path subject to certain constraints and
optimization criteria in SR networks.[¶](#section-abstract-1){.pilcrow}

This document updates RFC 8408.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8664>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2019 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Overview of PCEP Operation in SR
    Networks](#name-overview-of-pcep-operation-){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Object
    Formats](#name-object-formats){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [The OPEN
        Object](#name-the-open-object){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.1.2.1}
            [4.1.1](#section-4.1.1){.xref}.  [The Path Setup Type
            Capability
            TLV](#name-the-path-setup-type-capabil){.xref}[¶](#section-toc.1-1.4.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.1.2.2}
            [4.1.2](#section-4.1.2){.xref}.  [The SR PCE Capability
            Sub-TLV](#name-the-sr-pce-capability-sub-t){.xref}[¶](#section-toc.1-1.4.2.1.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [The RP/SRP
        Object](#name-the-rp-srp-object){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [ERO](#name-ero){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.3.2.1}
            [4.3.1](#section-4.3.1){.xref}.  [SR-ERO
            Subobject](#name-sr-ero-subobject){.xref}[¶](#section-toc.1-1.4.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.3.2.2}
            [4.3.2](#section-4.3.2){.xref}.  [NAI Associated with
            SID](#name-nai-associated-with-sid){.xref}[¶](#section-toc.1-1.4.2.3.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [RRO](#name-rro){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [METRIC
        Object](#name-metric-object){.xref}[¶](#section-toc.1-1.4.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Procedures](#name-procedures){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Exchanging the SR PCE
        Capability](#name-exchanging-the-sr-pce-capab){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [ERO
        Processing](#name-ero-processing){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.2.2.1}
            [5.2.1](#section-5.2.1){.xref}.  [SR-ERO
            Validation](#name-sr-ero-validation){.xref}[¶](#section-toc.1-1.5.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.2}
            [5.2.2](#section-5.2.2){.xref}.  [Interpreting the
            SR-ERO](#name-interpreting-the-sr-ero){.xref}[¶](#section-toc.1-1.5.2.2.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [RRO
        Processing](#name-rro-processing){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Management
    Considerations](#name-management-considerations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Controlling the Path Setup
        Type](#name-controlling-the-path-setup-){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Migrating a Network to Use PCEP
        Segment-Routed
        Paths](#name-migrating-a-network-to-use-){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Verification of Network
        Operation](#name-verification-of-network-ope){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [Relationship to Existing
        Management
        Models](#name-relationship-to-existing-ma){.xref}[¶](#section-toc.1-1.6.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [PCEP ERO and RRO
        Subobjects](#name-pcep-ero-and-rro-subobjects){.xref}[¶](#section-toc.1-1.8.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [New NAI Type
        Registry](#name-new-nai-type-registry){.xref}[¶](#section-toc.1-1.8.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [New SR-ERO Flag
        Registry](#name-new-sr-ero-flag-registry){.xref}[¶](#section-toc.1-1.8.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [8.4](#section-8.4){.xref}.  [PCEP-Error
        Object](#name-pcep-error-object){.xref}[¶](#section-toc.1-1.8.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.5}
        [8.5](#section-8.5){.xref}.  [PCEP TLV Type
        Indicators](#name-pcep-tlv-type-indicators){.xref}[¶](#section-toc.1-1.8.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.6}
        [8.6](#section-8.6){.xref}.  [PATH-SETUP-TYPE-CAPABILITY Sub-TLV
        Type
        Indicators](#name-path-setup-type-capability-){.xref}[¶](#section-toc.1-1.8.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.7}
        [8.7](#section-8.7){.xref}.  [New Path Setup
        Type](#name-new-path-setup-type){.xref}[¶](#section-toc.1-1.8.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.8}
        [8.8](#section-8.8){.xref}.  [New Metric
        Type](#name-new-metric-type){.xref}[¶](#section-toc.1-1.8.2.8.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.9}
        [8.9](#section-8.9){.xref}.  [SR PCE Capability
        Flags](#name-sr-pce-capability-flags){.xref}[¶](#section-toc.1-1.8.2.9.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix A](#section-appendix.a){.xref}.  [Compatibility with Early
    Implementations](#name-compatibility-with-early-im){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [](#section-appendix.b){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.c){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.d){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

Segment Routing (SR) leverages the source-routing paradigm. Using SR, a
source node steers a packet through a path without relying on hop-by-hop
signaling protocols such as LDP or RSVP-TE. Each path is specified as an
ordered list of instructions called \"segments\". Each segment is an
instruction to route the packet to a specific place in the network or to
perform a function on the packet. A database of segments can be
distributed through the network using a routing protocol (such as IS-IS
or OSPF) or by any other means. Several types of segments are defined. A
node segment uniquely identifies a specific node in the SR domain. Each
router in the SR domain associates a node segment with an ECMP-aware
shortest path to the node that it identifies. An adjacency segment
represents a unidirectional adjacency. An adjacency segment is local to
the node that advertises it. Both node segments and adjacency segments
can be used for SR.[¶](#section-1-1){.pilcrow}

\[[RFC8402](#RFC8402){.xref}\] describes the SR architecture. The
corresponding IS-IS and OSPF extensions are specified in
\[[RFC8667](#RFC8667){.xref}\] and \[[RFC8665](#RFC8665){.xref}\],
respectively.[¶](#section-1-2){.pilcrow}

The SR architecture can be implemented using either an MPLS forwarding
plane \[[RFC8660](#RFC8660){.xref}\] or an IPv6 forwarding plane
\[[IPv6-SRH](#I-D.ietf-6man-segment-routing-header){.xref}\]. The MPLS
forwarding plane can be applied to SR without any change; in which case,
an SR path corresponds to an MPLS Label Switching Path (LSP). This
document is relevant to the MPLS forwarding plane only. In this
document, \"Node-SID\" and \"Adj-SID\" denote the Node Segment
Identifier and Adjacency Segment Identifier,
respectively.[¶](#section-1-3){.pilcrow}

An SR path can be derived from an IGP Shortest Path Tree (SPT). Segment
Routing Traffic-Engineering (SR-TE) paths may not follow an IGP SPT.
Such paths may be chosen by a suitable network planning tool and
provisioned on the ingress node of the SR-TE
path.[¶](#section-1-4){.pilcrow}

\[[RFC5440](#RFC5440){.xref}\] describes the Path Computation Element
Communication Protocol (PCEP) for communication between a Path
Computation Client (PCC) and a Path Computation Element (PCE) or between
a pair of PCEs. A PCE computes paths for MPLS Traffic-Engineering
(MPLS-TE) LSPs based on various constraints and optimization criteria.
\[[RFC8231](#RFC8231){.xref}\] specifies extensions to PCEP that allow a
stateful PCE to compute and recommend network paths in compliance with
\[[RFC4657](#RFC4657){.xref}\]. It also defines objects and TLVs for
MPLS-TE LSPs. Stateful PCEP extensions provide synchronization of LSP
state between a PCC and a PCE or between a pair of PCEs, delegation of
LSP control, reporting of LSP state from a PCC to a PCE, and control of
the setup and path routing of an LSP from a PCE to a PCC. Stateful PCEP
extensions are intended for an operational model in which LSPs are
configured on the PCC, and control over them is delegated to the
PCE.[¶](#section-1-5){.pilcrow}

A mechanism to dynamically initiate LSPs on a PCC based on the requests
from a stateful PCE or a controller using stateful PCE is specified in
\[[RFC8281](#RFC8281){.xref}\]. This mechanism is useful in
Software-Defined Networking (SDN) applications, such as on-demand
engineering or bandwidth calendaring
\[[RFC8413](#RFC8413){.xref}\].[¶](#section-1-6){.pilcrow}

It is possible to use a stateful PCE for computing one or more SR-TE
paths, taking into account various constraints and objective functions.
Once a path is chosen, the stateful PCE can initiate an SR-TE path on a
PCC using the PCEP extensions specified in
\[[RFC8281](#RFC8281){.xref}\] and the SR-specific PCEP extensions
specified in this document. Additionally, using procedures described in
this document, a PCC can request an SR path from either a stateful or a
stateless PCE.[¶](#section-1-7){.pilcrow}

This specification relies on the procedures specified in
\[[RFC8408](#RFC8408){.xref}\] to exchange the Segment Routing
capability and to specify that the path setup type of an LSP is Segment
Routing. This specification also updates \[[RFC8408](#RFC8408){.xref}\]
to clarify the use of sub-TLVs in the PATH-SETUP-TYPE-CAPABILITY TLV.
See [Section 4.1.1](#pst-cap-tlv){.xref} for
details.[¶](#section-1-8){.pilcrow}

This specification provides a mechanism for a network controller (acting
as a PCE) to instantiate candidate paths for an SR Policy onto a
head-end node (acting as a PCC) using PCEP. For more information on the
SR Policy Architecture, see
\[[SR-POLICY](#I-D.ietf-spring-segment-routing-policy){.xref}\].[¶](#section-1-9){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The following terminology is used in this
document:[¶](#section-2-1){.pilcrow}

ERO:
:   Explicit Route Object[¶](#section-2-2.2){.pilcrow}

IGP:
:   Interior Gateway Protocol[¶](#section-2-2.4){.pilcrow}

IS-IS:
:   Intermediate System to Intermediate
    System[¶](#section-2-2.6){.pilcrow}

LSR:
:   Label Switching Router[¶](#section-2-2.8){.pilcrow}

MSD:
:   Base MPLS Imposition Maximum SID Depth, as defined in
    \[[RFC8491](#RFC8491){.xref}\][¶](#section-2-2.10){.pilcrow}

NAI:
:   Node or Adjacency Identifier[¶](#section-2-2.12){.pilcrow}

OSPF:
:   Open Shortest Path First[¶](#section-2-2.14){.pilcrow}

PCC:
:   Path Computation Client[¶](#section-2-2.16){.pilcrow}

PCE:
:   Path Computation Element[¶](#section-2-2.18){.pilcrow}

PCEP:
:   Path Computation Element Communication
    Protocol[¶](#section-2-2.20){.pilcrow}

RRO:
:   Record Route Object[¶](#section-2-2.22){.pilcrow}

SID:
:   Segment Identifier[¶](#section-2-2.24){.pilcrow}

SR:
:   Segment Routing[¶](#section-2-2.26){.pilcrow}

SR-DB:
:   Segment Routing Database: the collection of SRGBs, SRLBs, and SIDs
    and the objects they map to, advertised by a link-state
    IGP[¶](#section-2-2.28){.pilcrow}

SR-TE:
:   Segment Routing Traffic Engineering[¶](#section-2-2.30){.pilcrow}

SRGB:
:   Segment Routing Global Block[¶](#section-2-2.32){.pilcrow}

SRLB:
:   Segment Routing Local Block[¶](#section-2-2.34){.pilcrow}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.1-1){.pilcrow}
:::
:::

::: {#Operation-Overview}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Overview of PCEP Operation in SR Networks](#name-overview-of-pcep-operation-){.section-name .selfRef} {#name-overview-of-pcep-operation-}

In an SR network, the ingress node of an SR path prepends an SR header
to all outgoing packets. The SR header consists of a list of SIDs (or
MPLS labels in the context of this document). The header has all
necessary information so that, in combination with the information
distributed by the IGP, the packets can be guided from the ingress node
to the egress node of the path; hence, there is no need for any
signaling protocol.[¶](#section-3-1){.pilcrow}

In PCEP messages, LSP route information is carried in the Explicit Route
Object (ERO), which consists of a sequence of subobjects. SR-TE paths
computed by a PCE can be represented in an ERO in one of the following
forms:[¶](#section-3-2){.pilcrow}

-   [An ordered set of IP addresses representing network
    nodes/links.[¶](#section-3-3.1){.pilcrow}]{#section-3-3.1}
-   [An ordered set of SIDs, with or without the corresponding IP
    addresses.[¶](#section-3-3.2){.pilcrow}]{#section-3-3.2}
-   [An ordered set of MPLS labels, with or without corresponding IP
    addresses.[¶](#section-3-3.3){.pilcrow}]{#section-3-3.3}

The PCC converts these into an MPLS label stack and next hop, as
described in [Section
5.2.2](#SR-ERO-INTERPRET){.xref}.[¶](#section-3-4){.pilcrow}

This document defines a new ERO subobject denoted by \"SR-ERO
subobject\" that is capable of carrying a SID as well as the identity of
the node/adjacency represented by the SID. SR-capable PCEP speakers
should be able to generate and/or process such an ERO subobject. An ERO
containing SR-ERO subobjects can be included in the PCEP Path
Computation Reply (PCRep) message defined in
\[[RFC5440](#RFC5440){.xref}\], the Path Computation LSP Initiate
Request (PCInitiate) message defined in \[[RFC8281](#RFC8281){.xref}\],
and the Path Computation Update Request (PCUpd) and Path Computation
State Report (PCRpt) messages for LSPs defined in
\[[RFC8231](#RFC8231){.xref}\].[¶](#section-3-5){.pilcrow}

When a PCEP session between a PCC and a PCE is established, both PCEP
speakers exchange their capabilities to indicate their ability to
support SR-specific functionality.[¶](#section-3-6){.pilcrow}

A PCE can update an LSP that is initially established via RSVP-TE
signaling to use an SR-TE path by sending a PCUpd to the PCC that
delegated the LSP to it \[[RFC8231](#RFC8231){.xref}\]. A PCC can update
an undelegated LSP that is initially established via RSVP-TE signaling
to use an SR-TE path as follows. First, it requests an SR-TE path from a
PCE by sending a Path Computation Request (PCReq) message. If it
receives a suitable path, it establishes the path in the data plane and
then tears down the original RSVP-TE path. If the PCE is stateful, then
the PCC sends PCRpt messages indicating that the new path is set up and
the old path is torn down, per
\[[RFC8231](#RFC8231){.xref}\].[¶](#section-3-7){.pilcrow}

Similarly, a PCE or PCC can update an LSP initially created with an
SR-TE path to use RSVP-TE signaling, if necessary. This capability is
useful for rolling back a change when a network is migrated from RSVP-TE
to SR-TE technology.[¶](#section-3-8){.pilcrow}

A PCC [MAY]{.bcp14} include a Record Route Object (RRO) containing the
recorded LSP in PCReq and PCRpt messages as specified in
\[[RFC5440](#RFC5440){.xref}\] and \[[RFC8231](#RFC8231){.xref}\],
respectively. This document defines a new RRO subobject for SR networks.
The methods used by a PCC to record the SR-TE LSP are outside the scope
of this document.[¶](#section-3-9){.pilcrow}

In summary, this document:[¶](#section-3-10){.pilcrow}

-   [Defines a new ERO subobject, a new RRO subobject, and new PCEP
    error codes.[¶](#section-3-11.1){.pilcrow}]{#section-3-11.1}
-   [Specifies how two PCEP speakers can establish a PCEP session that
    can carry information about SR-TE
    paths.[¶](#section-3-11.2){.pilcrow}]{#section-3-11.2}
-   [Specifies processing rules for the ERO
    subobject.[¶](#section-3-11.3){.pilcrow}]{#section-3-11.3}
-   [Defines a new path setup type to be used in the PATH-SETUP-TYPE and
    PATH-SETUP-TYPE-CAPABILITY TLVs
    \[[RFC8408](#RFC8408){.xref}\].[¶](#section-3-11.4){.pilcrow}]{#section-3-11.4}
-   [Defines a new sub-TLV for the PATH-SETUP-TYPE-CAPABILITY
    TLV.[¶](#section-3-11.5){.pilcrow}]{#section-3-11.5}

The extensions specified in this document complement the existing PCEP
specifications to support SR-TE paths. As such, the PCEP messages (e.g.,
PCReq, PCRep, PCRpt, PCUpd, PCInitiate, etc.) are formatted according to
\[[RFC5440](#RFC5440){.xref}\], \[[RFC8231](#RFC8231){.xref}\],
\[[RFC8281](#RFC8281){.xref}\], and any other applicable PCEP
specifications.[¶](#section-3-12){.pilcrow}
:::
:::

::: {#object-formats}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Object Formats](#name-object-formats){.section-name .selfRef} {#name-object-formats}

::: {#open-object-fmt}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [The OPEN Object](#name-the-open-object){.section-name .selfRef} {#name-the-open-object}

::: {#pst-cap-tlv}
::: {#section-4.1.1 .section}
#### [4.1.1.](#section-4.1.1){.section-number .selfRef} [The Path Setup Type Capability TLV](#name-the-path-setup-type-capabil){.section-name .selfRef} {#name-the-path-setup-type-capabil}

\[[RFC8408](#RFC8408){.xref}\] defines the PATH-SETUP-TYPE-CAPABILITY
TLV for use in the OPEN object. The PATH-SETUP-TYPE-CAPABILITY TLV
contains an optional list of sub-TLVs, which are intended to convey
parameters that are associated with the path setup types supported by a
PCEP speaker.[¶](#section-4.1.1-1){.pilcrow}

This specification updates \[[RFC8408](#RFC8408){.xref}\] as follows. It
creates a new registry that defines the valid type indicators of the
sub-TLVs of the PATH-SETUP-TYPE-CAPABILITY TLV (see [Section
8.6](#IANA-subTLV-Type-Indicators){.xref}). A PCEP speaker [MUST
NOT]{.bcp14} include a sub-TLV in the PATH-SETUP-TYPE-CAPABILITY TLV
unless it appears in this registry. If a PCEP speaker receives a sub-TLV
whose type indicator does not match one of those from the registry or is
not recognized by the speaker, then the speaker [MUST]{.bcp14} ignore
the sub-TLV.[¶](#section-4.1.1-2){.pilcrow}
:::
:::

::: {#cap-negotiation}
::: {#section-4.1.2 .section}
#### [4.1.2.](#section-4.1.2){.section-number .selfRef} [The SR PCE Capability Sub-TLV](#name-the-sr-pce-capability-sub-t){.section-name .selfRef} {#name-the-sr-pce-capability-sub-t}

This document defines a new Path Setup Type (PST) for SR, as
follows:[¶](#section-4.1.2-1){.pilcrow}

-   ::: {#section-4.1.2-2.1}

    PST = 1:
    :   Traffic-engineering path is set up using Segment
        Routing.[¶](#section-4.1.2-2.1.1.2){.pilcrow}
    :::

A PCEP speaker [SHOULD]{.bcp14} indicate its support of the function
described in this document by sending a PATH-SETUP-TYPE-CAPABILITY TLV
in the OPEN object with this new PST included in the PST
list.[¶](#section-4.1.2-3){.pilcrow}

This document also defines the SR-PCE-CAPABILITY sub-TLV. PCEP speakers
use this sub-TLV to exchange information about their SR capability. If a
PCEP speaker includes PST=1 in the PST list of the
PATH-SETUP-TYPE-CAPABILITY TLV, then it [MUST]{.bcp14} also include the
SR-PCE-CAPABILITY sub-TLV inside the PATH-SETUP-TYPE-CAPABILITY
TLV.[¶](#section-4.1.2-4){.pilcrow}

The format of the SR-PCE-CAPABILITY sub-TLV is shown in the following
figure:[¶](#section-4.1.2-5){.pilcrow}

[]{#name-sr-pce-capability-sub-tlv-f}

::: {#Capability-TLV-Fmt}
::: {#section-4.1.2-6.1 .artwork .art-text .alignCenter}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Type=26               |            Length=4           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Reserved              |   Flags   |N|X|      MSD      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 1](#figure-1){.selfRef}: [SR-PCE-CAPABILITY Sub-TLV
Format](#name-sr-pce-capability-sub-tlv-f){.selfRef}
:::

The codepoint for the TLV type is 26. The TLV length is 4
octets.[¶](#section-4.1.2-7){.pilcrow}

The 32-bit value is formatted as follows.[¶](#section-4.1.2-8){.pilcrow}

Reserved:
:   [MUST]{.bcp14} be set to zero by the sender and [MUST]{.bcp14} be
    ignored by the receiver.[¶](#section-4.1.2-9.2){.pilcrow}

Flags:

:   This document defines the following flag bits. The other bits
    [MUST]{.bcp14} be set to zero by the sender and [MUST]{.bcp14} be
    ignored by the receiver.[¶](#section-4.1.2-9.4.1){.pilcrow}

    -   ::: {#section-4.1.2-9.4.2.1}

        N:
        :   A PCC sets this flag bit to 1 to indicate that it is capable
            of resolving a Node or Adjacency Identifier (NAI) to a
            SID.[¶](#section-4.1.2-9.4.2.1.1.2){.pilcrow}

        X:
        :   A PCC sets this flag bit to 1 to indicate that it does not
            impose any limit on the
            MSD.[¶](#section-4.1.2-9.4.2.1.1.4){.pilcrow}
        :::

Maximum SID Depth (MSD):
:   specifies the maximum number of SIDs (MPLS label stack depth in the
    context of this document) that a PCC is capable of imposing on a
    packet. [Section 5.1](#SR-CAP-PROCESS){.xref} explains the
    relationship between this field and the
    X-Flag.[¶](#section-4.1.2-9.6){.pilcrow}
:::
:::
:::
:::

::: {#rp-object-fmt}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [The RP/SRP Object](#name-the-rp-srp-object){.section-name .selfRef} {#name-the-rp-srp-object}

To set up an SR-TE LSP using SR, the Request Parameter (RP) or Stateful
PCE Request Parameter (SRP) object [MUST]{.bcp14} include the
PATH-SETUP-TYPE TLV, specified in \[[RFC8408](#RFC8408){.xref}\], with
the PST set to 1 (and path setup using
SR-TE).[¶](#section-4.2-1){.pilcrow}

The LSP-IDENTIFIERS TLV [MAY]{.bcp14} be present for the above PST
type.[¶](#section-4.2-2){.pilcrow}
:::
:::

::: {#SR-ERO}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [ERO](#name-ero){.section-name .selfRef} {#name-ero}

An SR-TE path consists of one or more SIDs where each SID [MAY]{.bcp14}
be associated with the identifier that represents the node or adjacency
corresponding to the SID. This identifier is referred to as the NAI. As
described later, an NAI can be represented in various formats (e.g.,
IPv4 address, IPv6 address, etc). Furthermore, an NAI is used for
troubleshooting purposes and, if necessary, to derive a SID value as
described below.[¶](#section-4.3-1){.pilcrow}

The ERO specified in \[[RFC5440](#RFC5440){.xref}\] is used to carry
SR-TE path information. In order to carry a SID and/or NAI, this
document defines a new ERO subobject referred to as the \"SR-ERO
subobject\", whose format is specified in the following section. An ERO
carrying an SR-TE path consists of one or more ERO subobjects, and it
[MUST]{.bcp14} carry only SR-ERO subobjects. Note that an SR-ERO
subobject does not need to have both the SID and NAI. However, at least
one of them [MUST]{.bcp14} be present.[¶](#section-4.3-2){.pilcrow}

When building the MPLS label stack from ERO, a PCC [MUST]{.bcp14} assume
that SR-ERO subobjects are organized as a last-in-first-out stack. The
first subobject relative to the beginning of ERO contains the
information about the topmost label. The last subobject contains
information about the bottommost label.[¶](#section-4.3-3){.pilcrow}

::: {#SR-ERO-SUB}
::: {#section-4.3.1 .section}
#### [4.3.1.](#section-4.3.1){.section-number .selfRef} [SR-ERO Subobject](#name-sr-ero-subobject){.section-name .selfRef} {#name-sr-ero-subobject}

An SR-ERO subobject is formatted as shown in the following
diagram.[¶](#section-4.3.1-1){.pilcrow}

[]{#name-sr-ero-subobject-format}

::: {#SR-ERO-SUBOBJECT}
::: {#section-4.3.1-2.1 .artwork .art-text .alignLeft}
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |L|   Type=36   |     Length    |  NT   |     Flags     |F|S|C|M|
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         SID (optional)                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      //                   NAI (variable, optional)                  //
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 2](#figure-2){.selfRef}: [SR-ERO Subobject
Format](#name-sr-ero-subobject-format){.selfRef}
:::

The fields in the SR-ERO subobject are as
follows:[¶](#section-4.3.1-3){.pilcrow}

The L-Flag:
:   Indicates whether the subobject represents a loose hop in the LSP
    \[[RFC3209](#RFC3209){.xref}\]. If this flag is set to zero, a PCC
    [MUST NOT]{.bcp14} overwrite the SID value present in the SR-ERO
    subobject. Otherwise, a PCC [MAY]{.bcp14} expand or replace one or
    more SID values in the received SR-ERO based on its local
    policy.[¶](#section-4.3.1-4.2){.pilcrow}

Type:
:   Set to 36.[¶](#section-4.3.1-4.4){.pilcrow}

Length:
:   Contains the total length of the subobject in octets. The Length
    [MUST]{.bcp14} be at least 8 and [MUST]{.bcp14} be a multiple of 4.
    An SR-ERO subobject [MUST]{.bcp14} contain at least one SID or NAI.
    The flags described below indicate whether the SID or NAI fields are
    absent.[¶](#section-4.3.1-4.6){.pilcrow}

NAI Type (NT):

:   Indicates the type and format of the NAI contained in the object
    body, if any is present. If the F bit is set to zero (see below),
    then the NT field has no meaning and [MUST]{.bcp14} be ignored by
    the receiver. This document describes the following NT
    values:[¶](#section-4.3.1-4.8.1){.pilcrow}

    NT=0
    :   The NAI is absent.[¶](#section-4.3.1-4.8.2.2){.pilcrow}

    NT=1
    :   The NAI is an IPv4 node ID.[¶](#section-4.3.1-4.8.2.4){.pilcrow}

    NT=2
    :   The NAI is an IPv6 node ID.[¶](#section-4.3.1-4.8.2.6){.pilcrow}

    NT=3
    :   The NAI is an IPv4
        adjacency.[¶](#section-4.3.1-4.8.2.8){.pilcrow}

    NT=4
    :   The NAI is an IPv6 adjacency with global IPv6
        addresses.[¶](#section-4.3.1-4.8.2.10){.pilcrow}

    NT=5
    :   The NAI is an unnumbered adjacency with IPv4 node
        IDs.[¶](#section-4.3.1-4.8.2.12){.pilcrow}

    NT=6
    :   The NAI is an IPv6 adjacency with link-local IPv6
        addresses.[¶](#section-4.3.1-4.8.2.14){.pilcrow}

Flags:

:   Used to carry additional information pertaining to the SID. This
    document defines the following flag bits. The other bits
    [MUST]{.bcp14} be set to zero by the sender and [MUST]{.bcp14} be
    ignored by the receiver.[¶](#section-4.3.1-4.10.1){.pilcrow}

    M:
    :   If this bit is set to 1, the SID value represents an MPLS label
        stack entry as specified in \[[RFC3032](#RFC3032){.xref}\].
        Otherwise, the SID value is an administratively configured value
        that represents an index into an MPLS label space (either SRGB
        or SRLB) per
        \[[RFC8402](#RFC8402){.xref}\].[¶](#section-4.3.1-4.10.2.2){.pilcrow}

    C:
    :   If the M bit and the C bit are both set to 1, then the TC, S,
        and TTL fields in the MPLS label stack entry are specified by
        the PCE. However, a PCC [MAY]{.bcp14} choose to override these
        values according to its local policy and MPLS forwarding rules.
        If the M bit is set to 1 but the C bit is set to zero, then the
        TC, S, and TTL fields [MUST]{.bcp14} be ignored by the PCC. The
        PCC [MUST]{.bcp14} set these fields according to its local
        policy and MPLS forwarding rules. If the M bit is set to zero,
        then the C bit [MUST]{.bcp14} be set to
        zero.[¶](#section-4.3.1-4.10.2.4){.pilcrow}

    S:
    :   When this bit is set to 1, the SID value in the subobject body
        is absent. In this case, the PCC is responsible for choosing the
        SID value, e.g., by looking it up in the SR-DB using the NAI
        that, in this case, [MUST]{.bcp14} be present in the subobject.
        If the S bit is set to 1, then the M and C bits [MUST]{.bcp14}
        be set to zero.[¶](#section-4.3.1-4.10.2.6){.pilcrow}

    F:
    :   When this bit is set to 1, the NAI value in the subobject body
        is absent. The F bit [MUST]{.bcp14} be set to 1 if NT=0;
        otherwise, it [MUST]{.bcp14} be set to zero. The S and F bits
        [MUST NOT]{.bcp14} both be set to
        1.[¶](#section-4.3.1-4.10.2.8){.pilcrow}

SID:

:   The Segment Identifier. Depending on the M bit, it contains
    either:[¶](#section-4.3.1-4.12.1){.pilcrow}

    -   [A 4-octet index defining the offset into an MPLS label space
        per \[[RFC8402](#RFC8402){.xref}\]
        or[¶](#section-4.3.1-4.12.2.1){.pilcrow}]{#section-4.3.1-4.12.2.1}
    -   [A 4-octet MPLS label stack entry, where the 20 most significant
        bits encode the label value per
        \[[RFC3032](#RFC3032){.xref}\].[¶](#section-4.3.1-4.12.2.2){.pilcrow}]{#section-4.3.1-4.12.2.2}

NAI:
:   The NAI associated with the SID. The NAI\'s format depends on the
    value in the NT field and is described in the following
    section.[¶](#section-4.3.1-4.14){.pilcrow}

At least one SID and NAI [MUST]{.bcp14} be included in the SR-ERO
subobject, and both [MAY]{.bcp14} be
included.[¶](#section-4.3.1-5){.pilcrow}
:::
:::

::: {#SR-ERO-NODAL-32}
::: {#section-4.3.2 .section}
#### [4.3.2.](#section-4.3.2){.section-number .selfRef} [NAI Associated with SID](#name-nai-associated-with-sid){.section-name .selfRef} {#name-nai-associated-with-sid}

This document defines the following NAIs:[¶](#section-4.3.2-1){.pilcrow}

IPv4 Node ID:
:   Specified as an IPv4 address. In this case, the NT value is 1, and
    the NAI field length is 4 octets.[¶](#section-4.3.2-2.2){.pilcrow}

IPv6 Node ID:
:   Specified as an IPv6 address. In this case, the NT value is 2, and
    the NAI field length is 16 octets.[¶](#section-4.3.2-2.4){.pilcrow}

IPv4 Adjacency:

:   Specified as a pair of IPv4 addresses. In this case, the NT value is
    3, and the NAI field length is 8 octets. The format of the NAI is
    shown in the following figure:[¶](#section-4.3.2-2.6.1){.pilcrow}

    []{#name-nai-for-ipv4-adjacency}

    ::: {#ADJ-SID-ERO-SUBOBJECT-32}
    ::: {#section-4.3.2-2.6.2.1 .artwork .art-text .alignLeft}
          0                   1                   2                   3
          0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                      Local IPv4 address                       |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                     Remote IPv4 address                       |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :::

    [Figure 3](#figure-3){.selfRef}: [NAI for IPv4
    Adjacency](#name-nai-for-ipv4-adjacency){.selfRef}
    :::

IPv6 Global Adjacency:

:   Specified as a pair of global IPv6 addresses. It is used to describe
    an IPv6 adjacency for a link that uses global IPv6 addresses. Each
    global IPv6 address is configured on a specific router interface, so
    together they identify an adjacency between a pair of routers. In
    this case, the NT value is 4, and the NAI field length is 32 octets.
    The format of the NAI is shown in the following
    figure:[¶](#section-4.3.2-2.8.1){.pilcrow}

    []{#name-nai-for-ipv6-global-adjacen}

    ::: {#ADJ-SID-ERO-SUBOBJECT-128}
    ::: {#section-4.3.2-2.8.2.1 .artwork .art-text .alignLeft}
          0                   1                   2                   3
          0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         //               Local IPv6 address (16 octets)                //
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         //               Remote IPv6 address (16 octets)               //
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :::

    [Figure 4](#figure-4){.selfRef}: [NAI for IPv6 Global
    Adjacency](#name-nai-for-ipv6-global-adjacen){.selfRef}
    :::

Unnumbered Adjacency with IPv4 NodeIDs:

:   Specified as a pair of (node ID, interface ID) tuples. In this case,
    the NT value is 5, and the NAI field length is 16 octets. The format
    of the NAI is shown in the following
    figure:[¶](#section-4.3.2-2.10.1){.pilcrow}

    []{#name-nai-for-unnumbered-adjacenc}

    ::: {#ADJ-SID-ERO-UNNUM-32}
    ::: {#section-4.3.2-2.10.2.1 .artwork .art-text .alignLeft}
          0                   1                   2                   3
          0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                      Local Node ID                            |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                    Local Interface ID                         |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                      Remote Node ID                           |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                   Remote Interface ID                         |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :::

    [Figure 5](#figure-5){.selfRef}: [NAI for Unnumbered Adjacency with
    IPv4 Node IDs](#name-nai-for-unnumbered-adjacenc){.selfRef}
    :::

IPv6 Link-Local Adjacency:

:   Specified as a pair of (global IPv6 address, interface ID) tuples.
    It is used to describe an IPv6 adjacency for a link that uses only
    link-local IPv6 addresses. Each global IPv6 address is configured on
    a specific router, so together they identify a pair of adjacent
    routers. The interface IDs identify the link that the adjacency is
    formed over. In this case, the NT value is 6, and the NAI field
    length is 40 octets. The format of the NAI is shown in the following
    figure:[¶](#section-4.3.2-2.12.1){.pilcrow}

    []{#name-nai-for-ipv6-link-local-adj}

    ::: {#ADJ-SID-ERO-LINKLOCAL-40}
    ::: {#section-4.3.2-2.12.2.1 .artwork .art-text .alignLeft}
          0                   1                   2                   3
          0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         //               Local IPv6 address (16 octets)                //
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                    Local Interface ID                         |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         //               Remote IPv6 address (16 octets)               //
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
         |                   Remote Interface ID                         |
         +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :::

    [Figure 6](#figure-6){.selfRef}: [NAI for IPv6 Link-Local
    Adjacency](#name-nai-for-ipv6-link-local-adj){.selfRef}
    :::
:::
:::
:::
:::

::: {#SR-RRO}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [RRO](#name-rro){.section-name .selfRef} {#name-rro}

A PCC reports an SR-TE LSP to a PCE by sending a PCRpt message, per
\[[RFC8231](#RFC8231){.xref}\]. The RRO on this message represents the
SID list that was applied by the PCC, that is, the actual path taken by
the LSP. The procedures of \[[RFC8231](#RFC8231){.xref}\] with respect
to the RRO apply equally to this specification without
change.[¶](#section-4.4-1){.pilcrow}

An RRO contains one or more subobjects called \"SR-RRO subobjects\",
whose format is shown below:[¶](#section-4.4-2){.pilcrow}

[]{#name-sr-rro-subobject-format}

::: {#SR-RRO-SUBOBJECT}
::: {#section-4.4-3.1 .artwork .art-text .alignLeft}
      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Type=36    |     Length    |  NT   |     Flags     |F|S|C|M|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                              SID                              |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     //                        NAI (variable)                       //
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 7](#figure-7){.selfRef}: [SR-RRO Subobject
Format](#name-sr-rro-subobject-format){.selfRef}
:::

The format of the SR-RRO subobject is the same as that of the SR-ERO
subobject, but without the L-Flag.[¶](#section-4.4-4){.pilcrow}

A PCC [MUST]{.bcp14} order the SR-RRO subobjects such that the first
subobject relative to the beginning of the RRO identifies the first
segment visited by the SR-TE LSP, and the last subobject identifies the
final segment of the SR-TE LSP, that is, its
endpoint.[¶](#section-4.4-5){.pilcrow}
:::
:::

::: {#SR-METRIC}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [METRIC Object](#name-metric-object){.section-name .selfRef} {#name-metric-object}

A PCC [MAY]{.bcp14} request that PCE optimizes an individual path
computation request to minimize the SID depth of the computed path by
using the METRIC object defined in \[[RFC5440](#RFC5440){.xref}\]. This
document defines a new type for the METRIC object to be used for this
purpose, as follows:[¶](#section-4.5-1){.pilcrow}

-   ::: {#section-4.5-2.1}

    T = 11:
    :   Maximum SID Depth of the requested
        path.[¶](#section-4.5-2.1.1.2){.pilcrow}
    :::

If the PCC includes a METRIC object of this type on a path computation
request, then the PCE minimizes the SID depth of the computed path. If
the B (bound) bit is set to 1 in the METRIC object, then the PCE [MUST
NOT]{.bcp14} return a path whose SID depth exceeds the given metric
value. If the PCC did not set the X-Flag in its SR-PCE-CAPABILITY TLV,
then it [MUST]{.bcp14} set the B bit to 1. If the PCC set the X-Flag in
its SR-PCE-CAPABILITY TLV, then it [MAY]{.bcp14} set the B bit to 1 or
zero.[¶](#section-4.5-3){.pilcrow}

If a PCEP session is established with a non-zero default MSD value, then
the PCC [MUST NOT]{.bcp14} send an MSD METRIC object with an MSD greater
than the session\'s default MSD. If the PCE receives a path computation
request with an MSD METRIC object on such a session that is greater than
the session\'s default MSD, then it [MUST]{.bcp14} consider the request
invalid and send a PCEP Error (PCErr) with Error-Type = 10 (\"Reception
of an invalid object\") and Error-value = 9 (\"MSD exceeds the default
for the PCEP session\").[¶](#section-4.5-4){.pilcrow}
:::
:::
:::
:::

::: {#procedures}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Procedures](#name-procedures){.section-name .selfRef} {#name-procedures}

::: {#SR-CAP-PROCESS}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Exchanging the SR PCE Capability](#name-exchanging-the-sr-pce-capab){.section-name .selfRef} {#name-exchanging-the-sr-pce-capab}

A PCC indicates that it is capable of supporting the head-end functions
for SR-TE LSP by including the SR-PCE-CAPABILITY sub-TLV in the Open
message that it sends to a PCE. A PCE indicates that it is capable of
computing SR-TE paths by including the SR-PCE-CAPABILITY sub-TLV in the
Open message that it sends to a PCC.[¶](#section-5.1-1){.pilcrow}

If a PCEP speaker receives a PATH-SETUP-TYPE-CAPABILITY TLV with a PST
list containing PST=1, and supports that path setup type, then it checks
for the presence of the SR-PCE-CAPABILITY sub-TLV. If that sub-TLV is
absent, then the PCEP speaker [MUST]{.bcp14} send a PCErr message with
Error-Type = 10 (\"Reception of an invalid object\") and Error-value =
12 (\"Missing PCE-SR-CAPABILITY sub-TLV\") and [MUST]{.bcp14} then close
the PCEP session. If a PCEP speaker receives a
PATH-SETUP-TYPE-CAPABILITY TLV with a SR-PCE-CAPABILITY sub-TLV, but the
PST list does not contain PST=1, then the PCEP speaker [MUST]{.bcp14}
ignore the SR-PCE-CAPABILITY sub-TLV.[¶](#section-5.1-2){.pilcrow}

If a PCC sets the N-Flag to 1, then the PCE [MAY]{.bcp14} send an SR-ERO
subobject containing an NAI and no SID (see [Section
5.2](#SR-ERO-PROCESS){.xref}). Otherwise, the PCE [MUST NOT]{.bcp14}
send an SR-ERO subobject containing an NAI and no
SID.[¶](#section-5.1-3){.pilcrow}

The number of SIDs that can be imposed on a packet depends on the PCC\'s
data-plane capability. If a PCC sets the X-Flag to 1, then the MSD is
not used and [MUST]{.bcp14} be set to zero. If a PCE receives an
SR-PCE-CAPABILITY sub-TLV with the X-Flag set to 1, then it
[MUST]{.bcp14} ignore the MSD field and assume that the sender can
impose a SID stack of any depth. If a PCC sets the X-Flag to zero, then
it sets the MSD field to the maximum number of SIDs that it can impose
on a packet. In this case, the PCC [MUST]{.bcp14} set the MSD to a
number greater than zero. If a PCE receives an SR-PCE-CAPABILITY sub-TLV
with the X-Flag and MSD both set to zero, then it [MUST]{.bcp14} send a
PCErr message with Error-Type = 10 (\"Reception of an invalid object\")
and Error-value = 21 (\"Maximum SID depth must be non-zero\") and
[MUST]{.bcp14} then close the PCEP session.[¶](#section-5.1-4){.pilcrow}

Note that the MSD value exchanged via the SR-PCE-CAPABILITY sub-TLV
indicates the SID/label imposition limit for the PCC node. It is
anticipated that, in many deployments, the PCCs will have network
interfaces that are homogeneous with respect to MSD (that is, each
interface has the same MSD). In such cases, having a per-node MSD on the
PCEP session is sufficient; the PCE [SHOULD]{.bcp14} interpret this to
mean that all network interfaces on the PCC have the given MSD. However,
the PCE [MAY]{.bcp14} also learn a per-node MSD and a per-interface MSD
from the routing protocols, as specified in
\[[RFC8491](#RFC8491){.xref}\], \[[RFC8476](#RFC8476){.xref}\], and
\[[MSD-BGP](#I-D.ietf-idr-bgp-ls-segment-routing-msd){.xref}\]. If the
PCE learns the per-node MSD of a PCC from a routing protocol, then it
[MUST]{.bcp14} ignore the per-node MSD value in the SR-PCE-CAPABILITY
sub-TLV and use the per-node MSD learned from the routing protocol
instead. If the PCE learns the MSD of a network interface on a PCC from
a routing protocol, then it [MUST]{.bcp14} use the per-interface MSD
instead of the MSD value in the SR-PCE-CAPABILITY sub-TLV when it
computes a path that uses that interface.[¶](#section-5.1-5){.pilcrow}

Once an SR-capable PCEP session is established with a non-zero MSD
value, the corresponding PCE [MUST NOT]{.bcp14} send SR-TE paths with a
number of SIDs exceeding that MSD value. If a PCC needs to modify the
MSD value, it [MUST]{.bcp14} close the PCEP session and re-establish it
with the new MSD value. If a PCEP session is established with a non-zero
MSD value, and the PCC receives an SR-TE path containing more SIDs than
specified in the MSD value, the PCC [MUST]{.bcp14} send a PCErr message
with Error-Type = 10 (\"Reception of an invalid object\") and
Error-value = 3 (\"Unsupported number of SR-ERO subobjects\"). If a PCEP
session is established with an MSD value of zero, then the PCC
[MAY]{.bcp14} specify an MSD for each path computation request that it
sends to the PCE, by including a \"maximum SID depth\" METRIC object on
the request, as defined in [Section
4.5](#SR-METRIC){.xref}.[¶](#section-5.1-6){.pilcrow}

The N-Flag, X-Flag, and MSD value inside the SR-PCE-CAPABILITY sub-TLV
are meaningful only in the Open message sent from a PCC to a PCE. As
such, a PCE [MUST]{.bcp14} set the N-Flag to zero, X-Flag to 1, and MSD
value to zero in an outbound message to a PCC. Similarly, a PCC
[MUST]{.bcp14} ignore any MSD value received from a PCE. If a PCE
receives multiple SR-PCE-CAPABILITY sub-TLVs in an Open message, it
processes only the first sub-TLV received.[¶](#section-5.1-7){.pilcrow}
:::
:::

::: {#SR-ERO-PROCESS}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [ERO Processing](#name-ero-processing){.section-name .selfRef} {#name-ero-processing}

::: {#SR-ERO-VALIDATION}
::: {#section-5.2.1 .section}
#### [5.2.1.](#section-5.2.1){.section-number .selfRef} [SR-ERO Validation](#name-sr-ero-validation){.section-name .selfRef} {#name-sr-ero-validation}

If a PCC does not support the SR PCE Capability and thus cannot
recognize the SR-ERO or SR-RRO subobjects, it will respond according to
the rules for a malformed object per
\[[RFC5440](#RFC5440){.xref}\].[¶](#section-5.2.1-1){.pilcrow}

On receiving an SR-ERO, a PCC [MUST]{.bcp14} validate that the Length
field, S bit, F bit, and NT field are consistent, as
follows.[¶](#section-5.2.1-2){.pilcrow}

-   [If NT=0, the F bit [MUST]{.bcp14} be 1, the S bit [MUST]{.bcp14} be
    zero, and the Length [MUST]{.bcp14} be
    8.[¶](#section-5.2.1-3.1){.pilcrow}]{#section-5.2.1-3.1}
-   [If NT=1, the F bit [MUST]{.bcp14} be zero. If the S bit is 1, the
    Length [MUST]{.bcp14} be 8; otherwise, the Length [MUST]{.bcp14} be
    12.[¶](#section-5.2.1-3.2){.pilcrow}]{#section-5.2.1-3.2}
-   [If NT=2, the F bit [MUST]{.bcp14} be zero. If the S bit is 1, the
    Length [MUST]{.bcp14} be 20; otherwise, the Length [MUST]{.bcp14} be
    24.[¶](#section-5.2.1-3.3){.pilcrow}]{#section-5.2.1-3.3}
-   [If NT=3, the F bit [MUST]{.bcp14} be zero. If the S bit is 1, the
    Length [MUST]{.bcp14} be 12; otherwise, the Length [MUST]{.bcp14} be
    16.[¶](#section-5.2.1-3.4){.pilcrow}]{#section-5.2.1-3.4}
-   [If NT=4, the F bit [MUST]{.bcp14} be zero. If the S bit is 1, the
    Length [MUST]{.bcp14} be 36; otherwise, the Length [MUST]{.bcp14} be
    40.[¶](#section-5.2.1-3.5){.pilcrow}]{#section-5.2.1-3.5}
-   [If NT=5, the F bit [MUST]{.bcp14} be zero. If the S bit is 1, the
    Length [MUST]{.bcp14} be 20; otherwise, the Length [MUST]{.bcp14} be
    24.[¶](#section-5.2.1-3.6){.pilcrow}]{#section-5.2.1-3.6}
-   [If NT=6, the F bit [MUST]{.bcp14} be zero. If the S bit is 1, the
    Length [MUST]{.bcp14} be 44; otherwise, the Length [MUST]{.bcp14} be
    48.[¶](#section-5.2.1-3.7){.pilcrow}]{#section-5.2.1-3.7}

If a PCC finds that the NT field, Length field, S bit, and F bit are not
consistent, it [MUST]{.bcp14} consider the entire ERO invalid and
[MUST]{.bcp14} send a PCErr message with Error-Type = 10 (\"Reception of
an invalid object\") and Error-value = 11 (\"Malformed
object\").[¶](#section-5.2.1-4){.pilcrow}

If a PCC does not recognize or support the value in the NT field, it
[MUST]{.bcp14} consider the entire ERO invalid and [MUST]{.bcp14} send a
PCErr message with Error-Type = 10 (\"Reception of an invalid object\")
and Error-value = 13 (\"Unsupported NAI Type in the SR-ERO/SR-RRO
subobject\").[¶](#section-5.2.1-5){.pilcrow}

If a PCC receives an SR-ERO subobject in which the S and F bits are both
set to 1 (that is, both the SID and NAI are absent), it [MUST]{.bcp14}
consider the entire ERO invalid and send a PCErr message with Error-Type
= 10 (\"Reception of an invalid object\") and Error-value = 6 (\"Both
SID and NAI are absent in the SR-ERO
subobject\").[¶](#section-5.2.1-6){.pilcrow}

If a PCC receives an SR-ERO subobject in which the S bit is set to 1 and
the F bit is set to zero (that is, the SID is absent and the NAI is
present), but the PCC does not support NAI resolution, it [MUST]{.bcp14}
consider the entire ERO invalid and send a PCErr message with Error-Type
= 4 (\"Not supported object\") and Error-value = 4 (\"Unsupported
parameter\").[¶](#section-5.2.1-7){.pilcrow}

If a PCC receives an SR-ERO subobject in which the S bit is set to 1 and
either (or both) the M bit or the C bit is set to 1, it [MUST]{.bcp14}
consider the entire ERO invalid and send a PCErr message with Error-Type
= 10 (\"Reception of an invalid object\") and Error-value = 11
(\"Malformed object\").[¶](#section-5.2.1-8){.pilcrow}

If a PCC receives an SR-ERO subobject in which the S bit is set to zero
and the M bit is set to 1, then the subobject contains an MPLS label.
The PCC [MAY]{.bcp14} choose not to accept a label provided by the PCE,
based on its local policy. The PCC [MUST NOT]{.bcp14} accept MPLS label
value 3 (Implicit NULL), but it [MAY]{.bcp14} accept other
special-purpose MPLS label values. If the PCC decides not to accept an
MPLS label value, it [MUST]{.bcp14} send a PCErr message with Error-Type
= 10 (\"Reception of an invalid object\") and Error-value = 2 (\"Bad
label value\").[¶](#section-5.2.1-9){.pilcrow}

If both the M and C bits of an SR-ERO subobject are set to 1, and if a
PCC finds an erroneous setting in one or more of the TC, S, and TTL
fields, it [MAY]{.bcp14} overwrite those fields with values chosen
according to its own policy. If the PCC does not overwrite them, it
[MUST]{.bcp14} send a PCErr message with Error-Type = 10 (\"Reception of
an invalid object\") and Error-value = 4 (\"Bad label
format\").[¶](#section-5.2.1-10){.pilcrow}

If the M bit of an SR-ERO subobject is set to zero but the C bit is set
to 1, then the PCC [MUST]{.bcp14} consider the entire ERO invalid and
[MUST]{.bcp14} send a PCErr message with Error-Type = 10 (\"Reception of
an invalid object\") and Error-value = 11 (\"Malformed
object\").[¶](#section-5.2.1-11){.pilcrow}

If a PCC receives an SR-ERO subobject in which the S bit is set to zero
and the M bit is set to zero, then the subobject contains a SID index
value. If the SID is an Adj-SID, then the L-Flag [MUST NOT]{.bcp14} be
set. If the L-Flag is set for an Adj-SID, then the PCC [MUST]{.bcp14}
send a PCErr message with Error-Type = 10 (\"Reception of an invalid
object\") and Error-value = 11 (\"Malformed
object\").[¶](#section-5.2.1-12){.pilcrow}

If a PCC detects that the subobjects of an ERO are a mixture of SR-ERO
subobjects and subobjects of other types, then it [MUST]{.bcp14} send a
PCErr message with Error-Type = 10 (\"Reception of an invalid object\")
and Error-value = 5 (\"ERO mixes SR-ERO subobjects with other subobject
types\").[¶](#section-5.2.1-13){.pilcrow}

The SR-ERO subobjects can be classified according to whether they
contain a SID representing an MPLS label value or an index value, or no
SID. If a PCC detects that the SR-ERO subobjects are a mixture of more
than one of these types, then it [MUST]{.bcp14} send a PCErr message
with Error-Type = 10 (\"Reception of an invalid object\") and
Error-value = 20 (\"Inconsistent SIDs in SR-ERO/SR-RRO
subobjects\").[¶](#section-5.2.1-14){.pilcrow}

If an ERO specifies a new SR-TE path for an existing LSP and the PCC
determines that the ERO contains SR-ERO subobjects that are not valid,
then the PCC [MUST NOT]{.bcp14} update the
LSP.[¶](#section-5.2.1-15){.pilcrow}
:::
:::

::: {#SR-ERO-INTERPRET}
::: {#section-5.2.2 .section}
#### [5.2.2.](#section-5.2.2){.section-number .selfRef} [Interpreting the SR-ERO](#name-interpreting-the-sr-ero){.section-name .selfRef} {#name-interpreting-the-sr-ero}

The SR-ERO contains a sequence of subobjects. Each SR-ERO subobject in
the sequence identifies a segment that the traffic will be directed to,
in the order given. That is, the first subobject identifies the first
segment the traffic will be directed to, the second subobject represents
the second segment, and so on.[¶](#section-5.2.2-1){.pilcrow}

The PCC interprets the SR-ERO by converting it to an MPLS label stack
plus a next hop. The PCC sends packets along the segment-routed path by
prepending the MPLS label stack onto the packets and sending the
resulting, modified packet to the next
hop.[¶](#section-5.2.2-2){.pilcrow}

The PCC uses a different procedure to do this conversion, depending on
the information that the PCE has provided in the
subobjects.[¶](#section-5.2.2-3){.pilcrow}

-   [If the subobjects contain SID index values, then the PCC converts
    them into the corresponding MPLS labels by following the procedure
    defined in
    \[[RFC8660](#RFC8660){.xref}\].[¶](#section-5.2.2-4.1){.pilcrow}]{#section-5.2.2-4.1}
-   [If the subobjects contain NAIs only, the PCC first converts each
    NAI into a SID index value and then proceeds as above. To convert an
    NAI to a SID index, the PCC looks for a fully specified prefix or
    adjacency matching the fields in the NAI. If the PCC finds a
    matching prefix/adjacency, and the matching prefix/adjacency has a
    SID associated with it, then the PCC uses that SID. If the PCC
    cannot find a matching prefix/adjacency, or if the matching
    prefix/adjacency has no SID associated with it, the PCC behaves as
    specified in [Section
    5.2.2.1](#SR-ERO-INTERPRET-ERROR){.xref}.[¶](#section-5.2.2-4.2){.pilcrow}]{#section-5.2.2-4.2}
-   [If the subobjects contain MPLS labels, then the PCC looks up the
    offset of the first subobject\'s label in its SRGB or SRLB. This
    gives the first SID. The PCC pushes the labels in any remaining
    subobjects onto the packet (with the final subobject specifying the
    bottom-of-stack
    label).[¶](#section-5.2.2-4.3){.pilcrow}]{#section-5.2.2-4.3}

For all cases above, after the PCC has imposed the label stack on the
packet, it sends the packet to the segment identified by the first
SID.[¶](#section-5.2.2-5){.pilcrow}

::: {#SR-ERO-INTERPRET-ERROR}
::: {#section-5.2.2.1 .section}
##### [5.2.2.1.](#section-5.2.2.1){.section-number .selfRef} [Handling Errors During SR-ERO Conversion](#name-handling-errors-during-sr-e){.section-name .selfRef} {#name-handling-errors-during-sr-e}

There are several errors that can occur during the process of converting
an SR-ERO sequence to an MPLS label stack and a next hop. The PCC deals
with them as follows.[¶](#section-5.2.2.1-1){.pilcrow}

-   [If the PCC cannot find a SID index in the SR-DB, it [MUST]{.bcp14}
    send a PCErr message with Error-Type = 10 (\"Reception of an invalid
    object\") and Error-value = 14 (\"Unknown
    SID\").[¶](#section-5.2.2.1-2.1){.pilcrow}]{#section-5.2.2.1-2.1}
-   [If the PCC cannot find an NAI in the SR-DB, it [MUST]{.bcp14} send
    a PCErr message with Error-Type = 10 (\"Reception of an invalid
    object\") and Error-value = 15 (\"NAI cannot be resolved to a
    SID\").[¶](#section-5.2.2.1-2.2){.pilcrow}]{#section-5.2.2.1-2.2}
-   [If the PCC needs to convert a SID into an MPLS label value but
    cannot find the corresponding router\'s SRGB in the SR-DB, it
    [MUST]{.bcp14} send a PCErr message with Error-Type = 10
    (\"Reception of an invalid object\") and Error-value = 16 (\"Could
    not find
    SRGB\").[¶](#section-5.2.2.1-2.3){.pilcrow}]{#section-5.2.2.1-2.3}
-   [If the PCC finds that a router\'s SRGB is not large enough for a
    SID index value, it [MUST]{.bcp14} send a PCErr message with
    Error-Type = 10 (\"Reception of an invalid object\") and Error-value
    = 17 (\"SID index exceeds SRGB
    size\").[¶](#section-5.2.2.1-2.4){.pilcrow}]{#section-5.2.2.1-2.4}
-   [If the PCC needs to convert a SID into an MPLS label value but
    cannot find the corresponding router\'s SRLB in the SR-DB, it
    [MUST]{.bcp14} send a PCErr message with Error-Type = 10
    (\"Reception of an invalid object\") and Error-value = 18 (\"Could
    not find
    SRLB\").[¶](#section-5.2.2.1-2.5){.pilcrow}]{#section-5.2.2.1-2.5}
-   [If the PCC finds that a router\'s SRLB is not large enough for a
    SID index value, it [MUST]{.bcp14} send a PCErr message with
    Error-Type = 10 (\"Reception of an invalid object\") and Error-value
    = 19 (\"SID index exceeds SRLB
    size\").[¶](#section-5.2.2.1-2.6){.pilcrow}]{#section-5.2.2.1-2.6}
-   [If the number of labels in the computed label stack exceeds the
    maximum number of SIDs that the PCC can impose on the packet, it
    [MUST]{.bcp14} send a PCErr message with Error-Type = 10
    (\"Reception of an invalid object\") and Error-value = 3
    (\"Unsupported number of SR-ERO
    subobjects\").[¶](#section-5.2.2.1-2.7){.pilcrow}]{#section-5.2.2.1-2.7}

If an ERO specifies a new SR-TE path for an existing LSP and the PCC
encounters an error while processing the ERO, then the PCC [MUST
NOT]{.bcp14} update the LSP.[¶](#section-5.2.2.1-3){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#SR-RRO-PROCESS}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [RRO Processing](#name-rro-processing){.section-name .selfRef} {#name-rro-processing}

The syntax-checking rules that apply to the SR-RRO subobject are
identical to those of the SR-ERO subobject, except as noted
below.[¶](#section-5.3-1){.pilcrow}

If a PCEP speaker receives an SR-RRO subobject in which both SID and NAI
are absent, it [MUST]{.bcp14} consider the entire RRO invalid and send a
PCErr message with Error-Type = 10 (\"Reception of an invalid object\")
and Error-value = 7 (\"Both SID and NAI are absent in the SR-RRO
subobject\").[¶](#section-5.3-2){.pilcrow}

If a PCE detects that the subobjects of an RRO are a mixture of SR-RRO
subobjects and subobjects of other types, then it [MUST]{.bcp14} send a
PCErr message with Error-Type = 10 (\"Reception of an invalid object\")
and Error-value = 10 (\"RRO mixes SR-RRO subobjects with other subobject
types\").[¶](#section-5.3-3){.pilcrow}

The SR-RRO subobjects can be classified according to whether they
contain a SID representing an MPLS label value or an index value, or no
SID. If a PCE detects that the SR-RRO subobjects are a mixture of more
than one of these types, then it [MUST]{.bcp14} send a PCErr message
with Error-Type = 10 (\"Reception of an invalid object\") and
Error-value = 20 (\"Inconsistent SIDs in SR-ERO / SR-RRO
subobjects\").[¶](#section-5.3-4){.pilcrow}
:::
:::
:::
:::

::: {#Management}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Management Considerations](#name-management-considerations){.section-name .selfRef} {#name-management-considerations}

This document adds a new path setup type to PCEP to allow LSPs to be set
up using Segment Routing techniques. This path setup type may be used
with PCEP alongside other path setup types, such as RSVP-TE, or it may
be used exclusively.[¶](#section-6-1){.pilcrow}

::: {#control}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Controlling the Path Setup Type](#name-controlling-the-path-setup-){.section-name .selfRef} {#name-controlling-the-path-setup-}

The following factors control which path setup type is used for a given
LSP.[¶](#section-6.1-1){.pilcrow}

-   [The available path setup types are constrained to those that are
    supported by, or enabled on, the PCEP speakers. The
    PATH-SETUP-TYPE-CAPABILITY TLV indicates which path setup types a
    PCEP speaker supports. To use Segment Routing as a path setup type,
    it is a prerequisite that the PCC and PCE both include PST=1 in the
    list of supported path setup types in this TLV and also include the
    SR-PCE-CAPABILITY
    sub-TLV.[¶](#section-6.1-2.1){.pilcrow}]{#section-6.1-2.1}
-   [When a PCE initiates an LSP, it proposes which path setup type to
    use by including it in the PATH-SETUP-TYPE TLV in the SRP object of
    the PCInitiate message. The PCE chooses the path setup type based on
    the capabilities of the network nodes on the path and on its local
    policy. The PCC [MAY]{.bcp14} choose to accept the proposed path
    setup type or to reject the PCInitiate request, based on its local
    policy.[¶](#section-6.1-2.2){.pilcrow}]{#section-6.1-2.2}
-   [When a PCC requests a path for an LSP, it can nominate a preferred
    path setup type by including it in the PATH-SETUP-TYPE TLV in the RP
    object of the PCReq message. The PCE [MAY]{.bcp14} choose to reply
    with a path of the requested type, reply with a path of a different
    type, or reject the request, based on the capabilities of the
    network nodes on the path and on its local
    policy.[¶](#section-6.1-2.3){.pilcrow}]{#section-6.1-2.3}

The operator can influence the path setup type as
follows.[¶](#section-6.1-3){.pilcrow}

-   [Implementations [MUST]{.bcp14} allow the operator to enable and
    disable the Segment Routing path setup type on a PCEP-speaking
    device. Implementations [MAY]{.bcp14} also allow the operator to
    enable and disable the RSVP-TE path setup
    type.[¶](#section-6.1-4.1){.pilcrow}]{#section-6.1-4.1}
-   [PCE implementations [MUST]{.bcp14} allow the operator to specify
    that an LSP should be instantiated using Segment Routing or RSVP-TE
    as the proposed path setup
    type.[¶](#section-6.1-4.2){.pilcrow}]{#section-6.1-4.2}
-   [PCE implementations [MAY]{.bcp14} allow the operator to configure a
    preference for the PCE to propose paths using Segment Routing or
    RSVP-TE in the absence of a specified path setup
    type.[¶](#section-6.1-4.3){.pilcrow}]{#section-6.1-4.3}
-   [PCC implementations [MUST]{.bcp14} allow the operator to specify
    that a path requested for an LSP nominates Segment Routing or
    RSVP-TE as the path setup
    type.[¶](#section-6.1-4.4){.pilcrow}]{#section-6.1-4.4}
-   [PCC implementations [MAY]{.bcp14} allow the operator to configure a
    preference for the PCC to nominate Segment Routing or RSVP-TE as the
    path setup type if none is specified for an
    LSP.[¶](#section-6.1-4.5){.pilcrow}]{#section-6.1-4.5}
-   [PCC implementations [SHOULD]{.bcp14} allow the operator to
    configure a PCC to refuse to set up an LSP using an undesired path
    setup type.[¶](#section-6.1-4.6){.pilcrow}]{#section-6.1-4.6}
:::
:::

::: {#migrating}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Migrating a Network to Use PCEP Segment-Routed Paths](#name-migrating-a-network-to-use-){.section-name .selfRef} {#name-migrating-a-network-to-use-}

This section discusses the steps that the operator takes when migrating
a network to enable PCEP to set up paths using Segment Routing as the
path setup type.[¶](#section-6.2-1){.pilcrow}

-   [The operator enables the Segment Routing PST on the PCE
    servers.[¶](#section-6.2-2.1){.pilcrow}]{#section-6.2-2.1}
-   [The operator enables the Segment Routing PST on the
    PCCs.[¶](#section-6.2-2.2){.pilcrow}]{#section-6.2-2.2}
-   [The operator resets each PCEP session. The PCEP sessions come back
    up with Segment Routing
    enabled.[¶](#section-6.2-2.3){.pilcrow}]{#section-6.2-2.3}
-   [If the operator detects a problem, they can roll the network back
    to its initial state by disabling the Segment Routing PST on the
    PCEP speakers and resetting the PCEP
    sessions.[¶](#section-6.2-2.4){.pilcrow}]{#section-6.2-2.4}

Note that the data plane is unaffected if a PCEP session is reset. Any
LSPs that were set up before the session reset will remain in place and
will still be present after the session comes back
up.[¶](#section-6.2-3){.pilcrow}

An implementation [SHOULD]{.bcp14} allow the operator to manually
trigger a PCEP session to be reset.[¶](#section-6.2-4){.pilcrow}

An implementation [MAY]{.bcp14} automatically reset a PCEP session when
an operator reconfigures the PCEP speaker\'s capabilities. However, note
that if the capabilities at both ends of the PCEP session are not
reconfigured simultaneously, then the session could be reset twice,
which could lead to unnecessary network traffic. Therefore, such
implementations [SHOULD]{.bcp14} allow the operator to override this
behavior and wait instead for a manual
reset.[¶](#section-6.2-5){.pilcrow}

Once Segment Routing is enabled on a PCEP session, it can be used as the
path setup type for future LSPs.[¶](#section-6.2-6){.pilcrow}

User traffic is not automatically migrated from existing LSPs onto
segment-routed LSPs just by enabling the Segment Routing PST in PCEP.
The migration of user traffic from existing LSPs onto Segment Routing
LSPs is beyond the scope of this document.[¶](#section-6.2-7){.pilcrow}
:::
:::

::: {#verification}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Verification of Network Operation](#name-verification-of-network-ope){.section-name .selfRef} {#name-verification-of-network-ope}

The operator needs the following information to verify that PCEP is
operating correctly with respect to the Segment Routing path setup
type.[¶](#section-6.3-1){.pilcrow}

-   [An implementation [SHOULD]{.bcp14} allow the operator to view
    whether the PCEP speaker sent the Segment Routing PST capability to
    its peer. If the PCEP speaker is a PCC, then the implementation
    [SHOULD]{.bcp14} also allow the operator to view the values of the
    L-Flag and N-Flag that were sent and the value of the MSD field that
    was sent.[¶](#section-6.3-2.1){.pilcrow}]{#section-6.3-2.1}
-   [An implementation [SHOULD]{.bcp14} allow the operator to view
    whether the peer sent the Segment Routing PST capability. If the
    peer is a PCC, then the implementation [SHOULD]{.bcp14} also allow
    the operator to view the values of the L-Flag and N-Flag and MSD
    fields that the peer
    sent.[¶](#section-6.3-2.2){.pilcrow}]{#section-6.3-2.2}
-   [An implementation [SHOULD]{.bcp14} allow the operator to view
    whether the Segment Routing PST is enabled on the PCEP
    session.[¶](#section-6.3-2.3){.pilcrow}]{#section-6.3-2.3}
-   [If one PCEP speaker advertises the Segment Routing PST capability,
    but the other does not, then the implementation [SHOULD]{.bcp14}
    create a log to inform the operator of the capability
    mismatch.[¶](#section-6.3-2.4){.pilcrow}]{#section-6.3-2.4}
-   [An implementation [SHOULD]{.bcp14} allow the operator to view the
    PST that was proposed, or requested, for an LSP and the PST that was
    actually used.[¶](#section-6.3-2.5){.pilcrow}]{#section-6.3-2.5}
-   [If a PCEP speaker decides to use a different PST to the one that
    was proposed, or requested, for an LSP, then the implementation
    [SHOULD]{.bcp14} create a log to inform the operator that the
    expected PST has not been used. The log [SHOULD]{.bcp14} give the
    reason for this choice (local policy, equipment capability,
    etc.).[¶](#section-6.3-2.6){.pilcrow}]{#section-6.3-2.6}
-   [If a PCEP speaker rejects a Segment Routing path, then it
    [SHOULD]{.bcp14} create a log to inform the operator, giving the
    reason for the decision (local policy, MSD exceeded,
    etc.).[¶](#section-6.3-2.7){.pilcrow}]{#section-6.3-2.7}
:::
:::

::: {#models}
::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [Relationship to Existing Management Models](#name-relationship-to-existing-ma){.section-name .selfRef} {#name-relationship-to-existing-ma}

The PCEP YANG module is defined in
\[[PCE-PCEP-YANG](#I-D.ietf-pce-pcep-yang){.xref}\]. In the future, this
YANG module should be extended or augmented to provide the following
additional information relating to Segment
Routing:[¶](#section-6.4-1){.pilcrow}

-   [The advertised PST capabilities and MSD per PCEP
    session.[¶](#section-6.4-2.1){.pilcrow}]{#section-6.4-2.1}
-   [The PST configured for, and used by, each
    LSP.[¶](#section-6.4-2.2){.pilcrow}]{#section-6.4-2.2}

The PCEP MIB \[[RFC7420](#RFC7420){.xref}\] could also be updated to
include this information.[¶](#section-6.4-3){.pilcrow}
:::
:::
:::
:::

::: {#Security}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations described in \[[RFC5440](#RFC5440){.xref}\],
\[[RFC8231](#RFC8231){.xref}\], \[[RFC8281](#RFC8281){.xref}\], and
\[[RFC8408](#RFC8408){.xref}\] are applicable to this specification. No
additional security measures are required.[¶](#section-7-1){.pilcrow}

Note that this specification enables a network controller to instantiate
a path in the network without the use of a hop-by-hop signaling protocol
(such as RSVP-TE). This creates an additional vulnerability if the
security mechanisms of \[[RFC5440](#RFC5440){.xref}\],
\[[RFC8231](#RFC8231){.xref}\], and \[[RFC8281](#RFC8281){.xref}\] are
not used. If there is no integrity protection on the session, then an
attacker could create a path that is not subjected to the further
verification checks that would be performed by the signaling
protocol.[¶](#section-7-2){.pilcrow}

Note that this specification adds the MSD field to the Open message (see
[Section 4.1.2](#cap-negotiation){.xref}), which discloses how many MPLS
labels the sender can push onto packets that it forwards into the
network. If the security mechanisms of \[[RFC8231](#RFC8231){.xref}\]
and \[[RFC8281](#RFC8281){.xref}\] are not used with strong encryption,
then an attacker could use this new field to gain intelligence about the
capabilities of the edge devices in the
network.[¶](#section-7-3){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#PCEP-Object-Codepoints}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [PCEP ERO and RRO Subobjects](#name-pcep-ero-and-rro-subobjects){.section-name .selfRef} {#name-pcep-ero-and-rro-subobjects}

This document defines a new subobject type for the PCEP ERO and a new
subobject type for the PCEP RRO. The codepoints for subobject types of
these objects are maintained in the \"Resource Reservation Protocol
(RSVP) Parameters\" registry, under the EXPLICIT_ROUTE and ROUTE_RECORD
objects, respectively.[¶](#section-8.1-1){.pilcrow}

::: {#IANA-Subobject-Type}
  Object           Subobject                Subobject Type
  ---------------- ------------------------ ----------------
  EXPLICIT_ROUTE   SR-ERO (PCEP specific)   36
  ROUTE_RECORD     SR-RRO (PCEP specific)   36

  : [Table 1](#table-1){.selfRef}
:::
:::
:::

::: {#NAI-Type-Registry}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [New NAI Type Registry](#name-new-nai-type-registry){.section-name .selfRef} {#name-new-nai-type-registry}

IANA has created a new sub-registry within the \"Path Computation
Element Protocol (PCEP) Numbers\" registry called \"PCEP SR-ERO NAI
Types\". The allocation policy for this new registry is by IETF Review
\[[RFC8126](#RFC8126){.xref}\]. The new registry contains the following
values:[¶](#section-8.2-1){.pilcrow}

::: {#New-PCEP-SR-ERO-NAI-value}
  Value   Description                                                Reference
  ------- ---------------------------------------------------------- ---------------
  0       NAI is absent.                                             This document
  1       NAI is an IPv4 node ID.                                    This document
  2       NAI is an IPv6 node ID.                                    This document
  3       NAI is an IPv4 adjacency.                                  This document
  4       NAI is an IPv6 adjacency with global IPv6 addresses.       This document
  5       NAI is an unnumbered adjacency with IPv4 node IDs.         This document
  6       NAI is an IPv6 adjacency with link-local IPv6 addresses.   This document
  7-15    Unassigned                                                 

  : [Table 2](#table-2){.selfRef}
:::
:::
:::

::: {#IANA-SR-ERO-FLAG}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [New SR-ERO Flag Registry](#name-new-sr-ero-flag-registry){.section-name .selfRef} {#name-new-sr-ero-flag-registry}

IANA has created a new sub-registry, named \"SR-ERO Flag Field\", within
the \"Path Computation Element Protocol (PCEP) Numbers\" registry to
manage the Flag field of the SR-ERO subobject. New values are to be
assigned by Standards Action \[[RFC8126](#RFC8126){.xref}\]. Each bit
should be tracked with the following
qualities:[¶](#section-8.3-1){.pilcrow}

-   [Bit number (counting from bit 0 as the most significant
    bit)[¶](#section-8.3-2.1){.pilcrow}]{#section-8.3-2.1}
-   [Capability
    description[¶](#section-8.3-2.2){.pilcrow}]{#section-8.3-2.2}
-   [Defining RFC[¶](#section-8.3-2.3){.pilcrow}]{#section-8.3-2.3}

The following values are defined in this
document:[¶](#section-8.3-3){.pilcrow}

::: {#SR-ERO-Flags}
  Bit   Description                                                     Reference
  ----- --------------------------------------------------------------- ---------------
  0-7   Unassigned                                                      
  8     NAI is absent (F)                                               This document
  9     SID is absent (S)                                               This document
  10    SID specifies TC, S, and TTL in addition to an MPLS label (C)   This document
  11    SID specifies an MPLS label (M)                                 This document

  : [Table 3](#table-3){.selfRef}
:::
:::
:::

::: {#IANA-Error-Object}
::: {#section-8.4 .section}
### [8.4.](#section-8.4){.section-number .selfRef} [PCEP-Error Object](#name-pcep-error-object){.section-name .selfRef} {#name-pcep-error-object}

IANA has allocated the following codepoints in the \"PCEP-ERROR Object
Error Types and Values\" registry for the following new
Error-values:[¶](#section-8.4-1){.pilcrow}

::: {#PCEP-Error-table}
  Error-Type   Meaning                          Error-value
  ------------ -------------------------------- ------------------------------------------------------------
  10           Reception of an invalid object   
                                                2: Bad label value
                                                3: Unsupported number of SR-ERO subobjects
                                                4: Bad label format
                                                5: ERO mixes SR-ERO subobjects with other subobject types
                                                6: Both SID and NAI are absent in the SR-ERO subobject
                                                7: Both SID and NAI are absent in the SR-RRO subobject
                                                9: MSD exceeds the default for the PCEP session
                                                10: RRO mixes SR-RRO subobjects with other subobject types
                                                12: Missing PCE-SR-CAPABILITY sub-TLV
                                                13: Unsupported NAI Type in the SR-ERO/SR-RRO subobject
                                                14: Unknown SID
                                                15: NAI cannot be resolved to a SID
                                                16: Could not find SRGB
                                                17: SID index exceeds SRGB size
                                                18: Could not find SRLB
                                                19: SID index exceeds SRLB size
                                                20: Inconsistent SIDs in SR-ERO / SR-RRO subobjects
                                                21: MSD must be non-zero

  : [Table 4](#table-4){.selfRef}
:::
:::
:::

::: {#IANA-TLV-Type-Indicators}
::: {#section-8.5 .section}
### [8.5.](#section-8.5){.section-number .selfRef} [PCEP TLV Type Indicators](#name-pcep-tlv-type-indicators){.section-name .selfRef} {#name-pcep-tlv-type-indicators}

IANA has allocated the following codepoint in the \"PCEP TLV Type
Indicators\" registry. Note that this TLV type indicator is deprecated
but retained in the registry to ensure compatibility with early
implementations of this specification. See [Appendix A](#Early){.xref}
for details.[¶](#section-8.5-1){.pilcrow}

::: {#PCEP-New-TLV-CP}
  Value   Meaning                          Reference
  ------- -------------------------------- ---------------
  26      SR-PCE-CAPABILITY (deprecated)   This document

  : [Table 5](#table-5){.selfRef}
:::
:::
:::

::: {#IANA-subTLV-Type-Indicators}
::: {#section-8.6 .section}
### [8.6.](#section-8.6){.section-number .selfRef} [PATH-SETUP-TYPE-CAPABILITY Sub-TLV Type Indicators](#name-path-setup-type-capability-){.section-name .selfRef} {#name-path-setup-type-capability-}

IANA has created a new sub-registry, named \"PATH-SETUP-TYPE-CAPABILITY
Sub-TLV Type Indicators\", within the \"Path Computation Element
Protocol (PCEP) Numbers\" registry to manage the type indicator space
for sub-TLVs of the PATH-SETUP-TYPE-CAPABILITY TLV. New values are to be
assigned by Standards Action \[[RFC8126](#RFC8126){.xref}\]. The valid
range of values in the registry is 0-65535. IANA has initialized the
registry with the following values. All other values in the registry
should be marked as \"Unassigned\".[¶](#section-8.6-1){.pilcrow}

::: {#PCEP-New-subTLV-CP}
  Value   Meaning             Reference
  ------- ------------------- ---------------
  0       Reserved            This document
  26      SR-PCE-CAPABILITY   This document

  : [Table 6](#table-6){.selfRef}
:::
:::
:::

::: {#IANA-PATH-SETUP-TYPE}
::: {#section-8.7 .section}
### [8.7.](#section-8.7){.section-number .selfRef} [New Path Setup Type](#name-new-path-setup-type){.section-name .selfRef} {#name-new-path-setup-type}

A sub-registry within the \"Path Computation Element Protocol (PCEP)
Numbers\" registry called \"PCEP Path Setup Types\" was created in
\[[RFC8408](#RFC8408){.xref}\]. IANA has allocated a new codepoint
within this registry, as follows:[¶](#section-8.7-1){.pilcrow}

::: {#PATH-SETUP-TLV-value}
  Value   Description                                                 Reference
  ------- ----------------------------------------------------------- ---------------
  1       Traffic-engineering path is set up using Segment Routing.   This document

  : [Table 7](#table-7){.selfRef}
:::
:::
:::

::: {#IANA-METRIC-TYPE}
::: {#section-8.8 .section}
### [8.8.](#section-8.8){.section-number .selfRef} [New Metric Type](#name-new-metric-type){.section-name .selfRef} {#name-new-metric-type}

IANA has allocated the following codepoint in the PCEP \"METRIC Object T
Field\" registry:[¶](#section-8.8-1){.pilcrow}

::: {#METRIC-type}
  Value   Description               Reference
  ------- ------------------------- ---------------
  11      Segment-ID (SID) Depth.   This document

  : [Table 8](#table-8){.selfRef}
:::
:::
:::

::: {#IANA-SR-PCE-CAP-FLAG}
::: {#section-8.9 .section}
### [8.9.](#section-8.9){.section-number .selfRef} [SR PCE Capability Flags](#name-sr-pce-capability-flags){.section-name .selfRef} {#name-sr-pce-capability-flags}

IANA has created a new sub-registry, named \"SR Capability Flag Field\",
within the \"Path Computation Element Protocol (PCEP) Numbers\" registry
to manage the Flag field of the SR-PCE-CAPABILITY TLV. New values are to
be assigned by Standards Action \[[RFC8126](#RFC8126){.xref}\]. Each bit
should be tracked with the following
qualities:[¶](#section-8.9-1){.pilcrow}

-   [Bit number (counting from bit 0 as the most significant
    bit)[¶](#section-8.9-2.1){.pilcrow}]{#section-8.9-2.1}
-   [Capability
    description[¶](#section-8.9-2.2){.pilcrow}]{#section-8.9-2.2}
-   [Defining RFC[¶](#section-8.9-2.3){.pilcrow}]{#section-8.9-2.3}

The following values are defined in this
document:[¶](#section-8.9-3){.pilcrow}

::: {#SR-PCE-CAP-Flags}
  Bit   Description                                           Reference
  ----- ----------------------------------------------------- ---------------
  0-5   Unassigned                                            
  6     Node or Adjacency Identifier (NAI) is supported (N)   This document
  7     Unlimited Maximum SID Depth (X)                       This document

  : [Table 9](#table-9){.selfRef}
:::
:::
:::
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.

\[RFC3032\]
:   [Rosen, E.]{.refAuthor}[, Tappan, D.]{.refAuthor}[,
    Fedorkow, G.]{.refAuthor}[, Rekhter, Y.]{.refAuthor}[,
    Farinacci, D.]{.refAuthor}[, Li, T.]{.refAuthor}[, and A.
    Conta]{.refAuthor}, [\"MPLS Label Stack Encoding\"]{.refTitle}, [RFC
    3032]{.seriesInfo}, [DOI 10.17487/RFC3032]{.seriesInfo}, January
    2001, \<<https://www.rfc-editor.org/info/rfc3032>\>.

\[RFC5440\]
:   [Vasseur, JP., Ed.]{.refAuthor}[ and JL. Le Roux, Ed.]{.refAuthor},
    [\"Path Computation Element (PCE) Communication Protocol
    (PCEP)\"]{.refTitle}, [RFC 5440]{.seriesInfo}, [DOI
    10.17487/RFC5440]{.seriesInfo}, March 2009,
    \<<https://www.rfc-editor.org/info/rfc5440>\>.

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.

\[RFC8231\]
:   [Crabbe, E.]{.refAuthor}[, Minei, I.]{.refAuthor}[,
    Medved, J.]{.refAuthor}[, and R. Varga]{.refAuthor}, [\"Path
    Computation Element Communication Protocol (PCEP) Extensions for
    Stateful PCE\"]{.refTitle}, [RFC 8231]{.seriesInfo}, [DOI
    10.17487/RFC8231]{.seriesInfo}, September 2017,
    \<<https://www.rfc-editor.org/info/rfc8231>\>.

\[RFC8281\]
:   [Crabbe, E.]{.refAuthor}[, Minei, I.]{.refAuthor}[,
    Sivabalan, S.]{.refAuthor}[, and R. Varga]{.refAuthor}, [\"Path
    Computation Element Communication Protocol (PCEP) Extensions for
    PCE-Initiated LSP Setup in a Stateful PCE Model\"]{.refTitle}, [RFC
    8281]{.seriesInfo}, [DOI 10.17487/RFC8281]{.seriesInfo}, December
    2017, \<<https://www.rfc-editor.org/info/rfc8281>\>.

\[RFC8402\]
:   [Filsfils, C., Ed.]{.refAuthor}[, Previdi, S., Ed.]{.refAuthor}[,
    Ginsberg, L.]{.refAuthor}[, Decraene, B.]{.refAuthor}[,
    Litkowski, S.]{.refAuthor}[, and R. Shakir]{.refAuthor}, [\"Segment
    Routing Architecture\"]{.refTitle}, [RFC 8402]{.seriesInfo}, [DOI
    10.17487/RFC8402]{.seriesInfo}, July 2018,
    \<<https://www.rfc-editor.org/info/rfc8402>\>.

\[RFC8408\]
:   [Sivabalan, S.]{.refAuthor}[, Tantsura, J.]{.refAuthor}[,
    Minei, I.]{.refAuthor}[, Varga, R.]{.refAuthor}[, and J.
    Hardwick]{.refAuthor}, [\"Conveying Path Setup Type in PCE
    Communication Protocol (PCEP) Messages\"]{.refTitle}, [RFC
    8408]{.seriesInfo}, [DOI 10.17487/RFC8408]{.seriesInfo}, July 2018,
    \<<https://www.rfc-editor.org/info/rfc8408>\>.

\[RFC8491\]
:   [Tantsura, J.]{.refAuthor}[, Chunduri, U.]{.refAuthor}[,
    Aldrin, S.]{.refAuthor}[, and L. Ginsberg]{.refAuthor}, [\"Signaling
    Maximum SID Depth (MSD) Using IS-IS\"]{.refTitle}, [RFC
    8491]{.seriesInfo}, [DOI 10.17487/RFC8491]{.seriesInfo}, November
    2018, \<<https://www.rfc-editor.org/info/rfc8491>\>.

\[RFC8660\]
:   [Bashandy, A., Ed.]{.refAuthor}[, Filsfils, C., Ed.]{.refAuthor}[,
    Previdi, S.]{.refAuthor}[, Decraene, B.]{.refAuthor}[,
    Litkowski, S.]{.refAuthor}[, and R. Shakir]{.refAuthor}, [\"Segment
    Routing with the MPLS Data Plane\"]{.refTitle}, [RFC
    8660]{.seriesInfo}, [DOI 10.17487/RFC8660]{.seriesInfo}, December
    2019, \<<https://www.rfc-editor.org/info/rfc8660>\>.
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[IPv6-SRH\]
:   [Filsfils, C.]{.refAuthor}[, Dukes, D.]{.refAuthor}[,
    Previdi, S.]{.refAuthor}[, Leddy, J.]{.refAuthor}[,
    Matsushima, S.]{.refAuthor}[, and D. Voyer]{.refAuthor}, [\"IPv6
    Segment Routing Header (SRH)\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-6man-segment-routing-header-26]{.seriesInfo}, 22 October
    2019,
    \<<https://tools.ietf.org/html/draft-ietf-6man-segment-routing-header-26>\>.

\[MSD-BGP\]
:   [Tantsura, J.]{.refAuthor}[, Chunduri, U.]{.refAuthor}[,
    Talaulikar, K.]{.refAuthor}[, Mirsky, G.]{.refAuthor}[, and N.
    Triantafillis]{.refAuthor}, [\"Signaling MSD (Maximum SID Depth)
    using Border Gateway Protocol Link-State\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-idr-bgp-ls-segment-routing-msd-09]{.seriesInfo}, 15
    October 2019,
    \<<https://tools.ietf.org/html/draft-ietf-idr-bgp-ls-segment-routing-msd-09>\>.

\[PCE-PCEP-YANG\]
:   [Dhody, D.]{.refAuthor}[, Hardwick, J.]{.refAuthor}[,
    Beeram, V.]{.refAuthor}[, and J. Tantsura]{.refAuthor}, [\"A YANG
    Data Model for Path Computation Element Communications Protocol
    (PCEP)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-pce-pcep-yang-13]{.seriesInfo}, 31
    October 2019,
    \<<https://tools.ietf.org/html/draft-ietf-pce-pcep-yang-13>\>.

\[RFC3209\]
:   [Awduche, D.]{.refAuthor}[, Berger, L.]{.refAuthor}[,
    Gan, D.]{.refAuthor}[, Li, T.]{.refAuthor}[,
    Srinivasan, V.]{.refAuthor}[, and G. Swallow]{.refAuthor},
    [\"RSVP-TE: Extensions to RSVP for LSP Tunnels\"]{.refTitle}, [RFC
    3209]{.seriesInfo}, [DOI 10.17487/RFC3209]{.seriesInfo}, December
    2001, \<<https://www.rfc-editor.org/info/rfc3209>\>.

\[RFC4657\]
:   [Ash, J., Ed.]{.refAuthor}[ and J.L. Le Roux, Ed.]{.refAuthor},
    [\"Path Computation Element (PCE) Communication Protocol Generic
    Requirements\"]{.refTitle}, [RFC 4657]{.seriesInfo}, [DOI
    10.17487/RFC4657]{.seriesInfo}, September 2006,
    \<<https://www.rfc-editor.org/info/rfc4657>\>.

\[RFC7420\]
:   [Koushik, A.]{.refAuthor}[, Stephan, E.]{.refAuthor}[,
    Zhao, Q.]{.refAuthor}[, King, D.]{.refAuthor}[, and J.
    Hardwick]{.refAuthor}, [\"Path Computation Element Communication
    Protocol (PCEP) Management Information Base (MIB)
    Module\"]{.refTitle}, [RFC 7420]{.seriesInfo}, [DOI
    10.17487/RFC7420]{.seriesInfo}, December 2014,
    \<<https://www.rfc-editor.org/info/rfc7420>\>.

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.

\[RFC8413\]
:   [Zhuang, Y.]{.refAuthor}[, Wu, Q.]{.refAuthor}[,
    Chen, H.]{.refAuthor}[, and A. Farrel]{.refAuthor}, [\"Framework for
    Scheduled Use of Resources\"]{.refTitle}, [RFC 8413]{.seriesInfo},
    [DOI 10.17487/RFC8413]{.seriesInfo}, July 2018,
    \<<https://www.rfc-editor.org/info/rfc8413>\>.

\[RFC8476\]
:   [Tantsura, J.]{.refAuthor}[, Chunduri, U.]{.refAuthor}[,
    Aldrin, S.]{.refAuthor}[, and P. Psenak]{.refAuthor}, [\"Signaling
    Maximum SID Depth (MSD) Using OSPF\"]{.refTitle}, [RFC
    8476]{.seriesInfo}, [DOI 10.17487/RFC8476]{.seriesInfo}, December
    2018, \<<https://www.rfc-editor.org/info/rfc8476>\>.

\[RFC8665\]
:   [Psenak, P., Ed.]{.refAuthor}[, Previdi, S., Ed.]{.refAuthor}[,
    Filsfils, C.]{.refAuthor}[, Gredler, H.]{.refAuthor}[,
    Shakir, R.]{.refAuthor}[, Henderickx, W.]{.refAuthor}[, and J.
    Tantsura]{.refAuthor}, [\"OSPF Extensions for Segment
    Routing\"]{.refTitle}, [RFC 8665]{.seriesInfo}, [DOI
    10.17487/RFC8665]{.seriesInfo}, December 2019,
    \<<https://www.rfc-editor.org/info/rfc8665>\>.

\[RFC8667\]
:   [Previdi, S., Ed.]{.refAuthor}[, Ginsberg, L., Ed.]{.refAuthor}[,
    Filsfils, C.]{.refAuthor}[, Bashandy, A.]{.refAuthor}[,
    Gredler, H.]{.refAuthor}[, and B. Decraene]{.refAuthor}, [\"IS-IS
    Extensions for Segment Routing\"]{.refTitle}, [RFC
    8667]{.seriesInfo}, [DOI 10.17487/RFC8667]{.seriesInfo}, December
    2019, \<<https://www.rfc-editor.org/info/rfc8667>\>.

\[SR-POLICY\]
:   [Filsfils, C.]{.refAuthor}[, Sivabalan, S.]{.refAuthor}[,
    Voyer, D.]{.refAuthor}[, Bogdanov, A.]{.refAuthor}[, and P.
    Mattes]{.refAuthor}, [\"Segment Routing Policy
    Architecture\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-ietf-spring-segment-routing-policy-05]{.seriesInfo}, 17
    November 2019,
    \<<https://tools.ietf.org/html/draft-ietf-spring-segment-routing-policy-05>\>.
:::
:::

::: {#Early}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Compatibility with Early Implementations](#name-compatibility-with-early-im){.section-name .selfRef} {#name-compatibility-with-early-im}

An early implementation of this specification will send the
SR-CAPABILITY-TLV as a top-level TLV in the OPEN object instead of
sending the PATH-SETUP-TYPE-CAPABILITY TLV in the OPEN object.
Implementations that wish to interoperate with such early
implementations should also send the SR-CAPABILITY-TLV as a top-level
TLV in their OPEN object and should interpret receiving this top-level
TLV as though the sender had sent a PATH-SETUP-TYPE-CAPABILITY TLV with
a PST list of (0, 1) (that is, both RSVP-TE and SR-TE PSTs are
supported) with the SR-CAPABILITY-TLV as a sub-TLV. If a PCEP speaker
receives an OPEN object in which both the SR-CAPABILITY-TLV and
PATH-SETUP-TYPE-CAPABILITY TLV appear as top-level TLVs, then it should
ignore the top-level SR-CAPABILITY-TLV and process only the
PATH-SETUP-TYPE-CAPABILITY TLV.[¶](#section-appendix.a-1){.pilcrow}
:::
:::

::: {#Acknowledgement}
::: {#section-appendix.b .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

We thank Ina Minei, George Swallow, Marek Zavodsky, Dhruv Dhody,
Ing-Wher Chen, and Tomas Janciga for the valuable
comments.[¶](#section-appendix.b-1){.pilcrow}
:::
:::

::: {#Contributors}
::: {#section-appendix.c .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The following people contributed to this
document:[¶](#section-appendix.c-1){.pilcrow}

-   [Lakshmi
    Sharma[¶](#section-appendix.c-2.1){.pilcrow}]{#section-appendix.c-2.1}
-   [Jan
    Medved[¶](#section-appendix.c-2.2){.pilcrow}]{#section-appendix.c-2.2}
-   [Edward
    Crabbe[¶](#section-appendix.c-2.3){.pilcrow}]{#section-appendix.c-2.3}
-   [Robert
    Raszuk[¶](#section-appendix.c-2.4){.pilcrow}]{#section-appendix.c-2.4}
-   [Victor
    Lopez[¶](#section-appendix.c-2.5){.pilcrow}]{#section-appendix.c-2.5}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.d .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Siva Sivabalan]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc.]{.org}
:::

::: {.left dir="auto"}
[2000 Innovation Drive]{.street-address}
:::

::: {.left dir="auto"}
[Kanata]{.locality} [Ontario]{.region} [K2K 3E8]{.postal-code}
:::

::: {.left dir="auto"}
[Canada]{.country-name}
:::

::: email
Email: <msiva@cisco.com>
:::

::: {.left dir="auto"}
[Clarence Filsfils]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc.]{.org}
:::

::: {.left dir="auto"}
[Pegasus Parc]{.street-address}
:::

::: {.left dir="auto"}
[Brabant 1831]{.postal-code} [De kleetlaan 6a]{.locality}
:::

::: {.left dir="auto"}
[Belgium]{.country-name}
:::

::: email
Email: <cfilsfil@cisco.com>
:::

::: {.left dir="auto"}
[Jeff Tantsura]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Apstra, Inc.]{.org}
:::

::: {.left dir="auto"}
[333 Middlefield Rd #200]{.street-address}
:::

::: {.left dir="auto"}
[Menlo Park]{.locality}, [CA]{.region} [94025]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <jefftant.ietf@gmail.com>
:::

::: {.left dir="auto"}
[Wim Henderickx]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Nokia]{.org}
:::

::: {.left dir="auto"}
[Copernicuslaan 50]{.street-address}
:::

::: {.left dir="auto"}
[95134]{.postal-code} [Antwerp 2018]{.locality}
:::

::: {.left dir="auto"}
[Belgium]{.country-name}
:::

::: email
Email: <wim.henderickx@nokia.com>
:::

::: {.left dir="auto"}
[Jon Hardwick]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Metaswitch Networks]{.org}
:::

::: {.left dir="auto"}
[100 Church Street]{.street-address}
:::

::: {.left dir="auto"}
[Enfield]{.locality}
:::

::: {.left dir="auto"}
[United Kingdom]{.country-name}
:::

::: email
Email: <jonathan.hardwick@metaswitch.com>
:::
:::
:::
