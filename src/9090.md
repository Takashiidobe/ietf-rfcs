  RFC 9090   CBOR Tags for OIDs   July 2021
  ---------- -------------------- -----------
  Bormann    Standards Track      \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9090](https://www.rfc-editor.org/rfc/rfc9090){.eref}

Category:
:   Standards Track

Published:
:   July 2021

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    C. Bormann
    :::

    ::: org
    Universität Bremen TZI
    :::
    :::
:::

# RFC 9090 {#rfcnum}

# Concise Binary Object Representation (CBOR) Tags for Object Identifiers {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

The Concise Binary Object Representation (CBOR), defined in RFC 8949, is
a data format whose design goals include the possibility of extremely
small code size, fairly small message size, and extensibility without
the need for version negotiation.[¶](#section-abstract-1){.pilcrow}

This document defines CBOR tags for object identifiers (OIDs) and is the
reference document for the IANA registration of the CBOR tags so
defined.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9090>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Terminology](#name-terminology){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Object
    Identifiers](#name-object-identifiers){.xref}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Requirements on the Byte String
        Being Tagged](#name-requirements-on-the-byte-st){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Preferred Serialization
        Considerations](#name-preferred-serialization-con){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Discussion](#name-discussion){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Basic
    Examples](#name-basic-examples){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Encoding of the SHA-256
        OID](#name-encoding-of-the-sha-256-oid){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Encoding of a MIB Relative
        OID](#name-encoding-of-a-mib-relative-){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Tag Factoring with Arrays and
    Maps](#name-tag-factoring-with-arrays-a){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Preferred Serialization
        Considerations](#name-preferred-serialization-cons){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Tag Factoring Example: X.500
        Distinguished Name](#name-tag-factoring-example-x500-){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [CDDL Control
    Operators](#name-cddl-control-operators){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [CDDL Type
    Names](#name-cddl-type-names){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [CBOR Tags](#name-cbor-tags){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [CDDL Control
        Operators](#name-cddl-control-operators-2){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [](#appendix-A){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-B){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [](#appendix-C){.xref}[Author\'s
    Address](#name-authors-address){.xref}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Concise Binary Object Representation (CBOR)
\[[RFC8949](#RFC8949){.xref}\] provides for the interchange of
structured data without a requirement for a pre-agreed schema.
\[[RFC8949](#RFC8949){.xref}\] defines a basic set of data types, as
well as a tagging mechanism that enables extending the set of data types
supported via an IANA registry.[¶](#section-1-1){.pilcrow}

This document defines CBOR tags for object identifiers (OIDs)
\[[X.660](#X.660){.xref}\], which many IETF protocols carry. The ASN.1
Basic Encoding Rules (BER) \[[X.690](#X.690){.xref}\] specify binary
encodings of both (absolute) object identifiers and relative object
identifiers. The contents of these encodings (the \"value\" part of
BER\'s type-length-value structure) can be carried in a CBOR byte
string. This document defines two CBOR tags that cover the two kinds of
ASN.1 object identifiers encoded in this way and a third one to enable a
common optimization. The tags can also be applied to arrays and maps to
efficiently tag all elements of an array or all keys of a map. This
document is the reference document for the IANA registration of the tags
so defined.[¶](#section-1-2){.pilcrow}

::: {#terms}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}

The terminology of \[[RFC8949](#RFC8949){.xref}\] applies; in
particular, the term \"byte\" is used in its now-customary sense as a
synonym for \"octet\". The verb \"to tag (something)\" is used to
express the construction of a CBOR tag, with the object (something) as
the tag content and a tag number indicated elsewhere in the sentence
(for instance, in a \"with\" clause or by the shorthand \"an NNN tag\"
for \"a tag with tag number NNN\"). The term \"SDNV\" (Self-Delimiting
Numeric Value) is used as defined in \[[RFC6256](#RFC6256){.xref}\],
with the additional restriction detailed in [Section 2.1](#reqts){.xref}
(no leading zeros).[¶](#section-1.1-2){.pilcrow}
:::
:::
:::
:::

::: {#oids}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Object Identifiers](#name-object-identifiers){.section-name .selfRef} {#name-object-identifiers}

The International Object Identifier tree \[[X.660](#X.660){.xref}\] is a
hierarchically managed space of identifiers, each of which is uniquely
represented as a sequence of unsigned integer values
\[[X.680](#X.680){.xref}\]. (These integer values are called \"primary
integer values\" in \[[X.660](#X.660){.xref}\] because they can be
accompanied by (not necessarily unambiguous) secondary identifiers. We
ignore the latter and simply use the term \"integer values\" here,
occasionally calling out their unsignedness. We also use the term
\"arc\" when the focus is on the edge of the tree labeled by such an
integer value, as well as in the sense of a \"long arc\", i.e., a
(sub)sequence of such integer values.)[¶](#section-2-1){.pilcrow}

While these sequences can easily be represented in CBOR arrays of
unsigned integers, a more compact representation can often be achieved
by adopting the widely used representation of object identifiers defined
in BER; this representation may also be more amenable to processing by
other software that makes use of object
identifiers.[¶](#section-2-2){.pilcrow}

BER represents the sequence of unsigned integers by concatenating
self-delimiting representations \[[RFC6256](#RFC6256){.xref}\] of each
of the integer values in sequence.[¶](#section-2-3){.pilcrow}

ASN.1 distinguishes absolute object identifiers (ASN.1 type
`OBJECT IDENTIFIER`), which begin at a root arc
(\[[X.660](#X.660){.xref}\], Clause 3.5.21), from relative object
identifiers (ASN.1 type `RELATIVE-OID`), which begin relative to some
object identifier known from context (\[[X.680](#X.680){.xref}\], Clause
3.8.63). As a special optimization, BER combines the first two integers
in an absolute object identifier into one numeric identifier by making
use of the property of the hierarchy that the first arc has only three
integer values (0, 1, and 2) and the second arcs under 0 and 1 are
limited to the integer values between 0 and 39. (The root arc
`joint-iso-itu-t(2)` has no such limitations on its second arc.) If X
and Y are the first two integer values, the single integer value
actually encoded is computed as:[¶](#section-2-4){.pilcrow}

X \* 40 + Y[¶](#section-2-5){.pilcrow}

The inverse transformation (again making use of the known ranges of X
and Y) is applied when decoding the object
identifier.[¶](#section-2-6){.pilcrow}

Since the semantics of absolute and relative object identifiers differ
and since it is very common for companies to use self-assigned numbers
under the arc `1.3.6.1.4.1` (IANA Private Enterprise Number OID
\[[IANA.enterprise-numbers](#IANA.enterprise-numbers){.xref}\]) that
adds 5 fixed bytes to an encoded OID value, this specification defines
three tags, collectively called the \"OID tags\"
here:[¶](#section-2-7){.pilcrow}

[]{.break}

Tag number 111:
:   Used to tag a byte string as the BER encoding
    \[[X.690](#X.690){.xref}\] of an absolute object identifier (simply
    \"object identifier\" or \"OID\").[¶](#section-2-8.2){.pilcrow}
:   

Tag number 110:
:   Used to tag a byte string as the BER encoding
    \[[X.690](#X.690){.xref}\] of a relative object identifier (also
    called \"relative OID\"). Since the encoding of each number is the
    same as for Self-Delimiting Numeric Values (SDNVs)
    \[[RFC6256](#RFC6256){.xref}\], this tag can also be used for
    tagging a byte string that contains a sequence of zero or more SDNVs
    (or a more application-specific tag can be created for such an
    application).[¶](#section-2-8.4){.pilcrow}
:   

Tag number 112:
:   Structurally like tag 110 but understood to be relative to
    `1.3.6.1.4.1` (IANA Private Enterprise Number OID
    \[[IANA.enterprise-numbers](#IANA.enterprise-numbers){.xref}\]).
    Hence, the semantics of the result are that of an absolute object
    identifier.[¶](#section-2-8.6){.pilcrow}
:   

::: {#reqts}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Requirements on the Byte String Being Tagged](#name-requirements-on-the-byte-st){.section-name .selfRef} {#name-requirements-on-the-byte-st}

To form a valid tag, a byte string tagged with 111, 110, or 112
[MUST]{.bcp14} be syntactically valid contents (the value part) for a
BER representation of an object identifier (see [Table
1](#oid-x.690){.xref}):[¶](#section-2.1-1){.pilcrow}

[]{#name-tag-number-and-section-of-x}

::: {#oid-x.690}
  Tag number   Section of \[[X.690](#X.690){.xref}\]
  ------------ ---------------------------------------
  111          8.19
  110          8.20
  112          8.20

  : [Table 1](#table-1){.selfRef}: [Tag Number and Section of X.690
  Governing Tag Content](#name-tag-number-and-section-of-x){.selfRef}
:::

This is a concatenation of zero or more SDNV values, where each SDNV
value is a sequence of one or more bytes that all have their most
significant bit set, except for the last byte, where it is unset. Also,
the first byte of each SDNV cannot be a leading zero in SDNV\'s base-128
arithmetic, so it cannot take the value 0x80 (bullet (c) in Section
8.1.2.4.2 of \[[X.690](#X.690){.xref}\]).[¶](#section-2.1-3){.pilcrow}

In other words:[¶](#section-2.1-4){.pilcrow}

-   [The byte string\'s first byte, and any byte that follows a byte
    that has the most significant bit unset, [MUST NOT]{.bcp14} be 0x80
    (this requirement requires expressing the integer values in their
    shortest form, with no leading
    zeroes).[¶](#section-2.1-5.1){.pilcrow}]{#section-2.1-5.1}
-   [The byte string\'s last byte [MUST NOT]{.bcp14} have the most
    significant bit set (this requirement excludes an incomplete final
    integer value).[¶](#section-2.1-5.2){.pilcrow}]{#section-2.1-5.2}

If either of these invalid conditions are encountered, the tag is
invalid.[¶](#section-2.1-6){.pilcrow}

\[[X.680](#X.680){.xref}\] restricts RELATIVE-OID values to having at
least one arc, i.e., their encoding would have at least one SDNV. This
specification permits empty relative object identifiers; they may still
be excluded by application semantics.[¶](#section-2.1-7){.pilcrow}

To facilitate the search for specific object ID values, it is
[RECOMMENDED]{.bcp14} that definite length encoding (see [Section
3.2.3](https://www.rfc-editor.org/rfc/rfc8949#section-3.2.3){.relref} of
\[[RFC8949](#RFC8949){.xref}\]) be used for the byte strings that are
used as tag content for these tags.[¶](#section-2.1-8){.pilcrow}

The valid set of byte strings can also be expressed using regular
expressions on bytes, using no specific notation but resembling Perl
Compatible Regular Expressions \[[PCRE](#PCRE){.xref}\]. Unlike typical
regular expressions that operate on character sequences, the following
regular expressions take bytes as their domain, so they can be applied
directly to CBOR byte strings.[¶](#section-2.1-9){.pilcrow}

For byte strings with tag 111:[¶](#section-2.1-10){.pilcrow}

`/^(([\x81-\xFF][\x80-\xFF]*)?[\x00-\x7F])+$/`[¶](#section-2.1-11){.pilcrow}

For byte strings with tags 110 or 112:[¶](#section-2.1-12){.pilcrow}

`/^(([\x81-\xFF][\x80-\xFF]*)?[\x00-\x7F])*$/`[¶](#section-2.1-13){.pilcrow}

A tag with tagged content that does not conform to the applicable
regular expression is invalid.[¶](#section-2.1-14){.pilcrow}
:::
:::

::: {#prefser}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Preferred Serialization Considerations](#name-preferred-serialization-con){.section-name .selfRef} {#name-preferred-serialization-con}

For an absolute OID with a prefix of `1.3.6.1.4.1`, representations with
both the 111 and 112 tags are applicable, where the representation with
112 will be five bytes shorter (by leaving out the prefix
h\'2b06010401\' from the enclosed byte string). This specification makes
that shorter representation the preferred serialization (see Sections
[3.4](https://www.rfc-editor.org/rfc/rfc8949#section-3.4){.relref} and
[4.1](https://www.rfc-editor.org/rfc/rfc8949#section-4.1){.relref} of
\[[RFC8949](#RFC8949){.xref}\]). Note that this also implies that the
Core Deterministic Encoding Requirements ([Section
4.2.1](https://www.rfc-editor.org/rfc/rfc8949#section-4.2.1){.relref} of
\[[RFC8949](#RFC8949){.xref}\]) require the use of 112 tags instead of
111 tags wherever that is possible.[¶](#section-2.2-1){.pilcrow}
:::
:::

::: {#discussion}
::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Discussion](#name-discussion){.section-name .selfRef} {#name-discussion}

Staying close to the way object identifiers are encoded in ASN.1 BER
makes back-and-forth translation easy; otherwise, we would choose a more
efficient encoding. Object identifiers in IETF protocols are serialized
in dotted decimal form or BER form, so there is an advantage in not
inventing a third form. Also, expectations of the cost of encoding
object identifiers are based on BER; using a different encoding might
not be aligned with these expectations. If additional information about
an OID is desired, lookup services such as the [OID Resolution Service
(ORS)](#X.672){.xref} \[[X.672](#X.672){.xref}\] and the [OID
Repository](#OID-INFO){.xref} \[[OID-INFO](#OID-INFO){.xref}\] are
available.[¶](#section-2.3-1){.pilcrow}
:::
:::
:::
:::

::: {#examples}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Basic Examples](#name-basic-examples){.section-name .selfRef} {#name-basic-examples}

This section gives simple examples of an absolute and a relative object
identifier, represented via tag numbers 111 and 110,
respectively.[¶](#section-3-1){.pilcrow}

::: {#encoding-of-the-sha-256-oid}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Encoding of the SHA-256 OID](#name-encoding-of-the-sha-256-oid){.section-name .selfRef} {#name-encoding-of-the-sha-256-oid}

[]{.break}

ASN.1 Value Notation:

:   ::: {#section-3.1-1.2.1}
    ``` {.sourcecode .lang-asn.1}
    { joint-iso-itu-t(2) country(16) us(840) organization(1) gov(101)
      csor(3) nistalgorithm(4) hashalgs(2) sha256(1) }
    ```

    [¶](#section-3.1-1.2.1){.pilcrow}
    :::

:   

Dotted Decimal Notation:

:   2.16.840.1.101.3.4.2.1[¶](#section-3.1-1.4.1){.pilcrow}

:   

[]{#name-sha-256-oid-in-ber}

::: {#fig-sha-ber}
::: {#section-3.1-2.1}
``` sourcecode
06                                # UNIVERSAL TAG 6
   09                             # 9 bytes, primitive
      60 86 48 01 65 03 04 02 01  # X.690 Clause 8.19
#      |   840  1  |  3  4  2  1    show component encoding
#   2.16         101
```
:::

[Figure 1](#figure-1){.selfRef}: [SHA-256 OID in
BER](#name-sha-256-oid-in-ber){.selfRef}
:::

[]{#name-sha-256-oid-in-cbor}

::: {#fig-sha-cbor}
::: {#section-3.1-3.1}
``` {.sourcecode .lang-cbor-pretty}
D8 6F                             # tag(111)
   49                             # 0b010_01001: mt 2, 9 bytes
      60 86 48 01 65 03 04 02 01  # X.690 Clause 8.19
```
:::

[Figure 2](#figure-2){.selfRef}: [SHA-256 OID in
CBOR](#name-sha-256-oid-in-cbor){.selfRef}
:::
:::
:::

::: {#encoding-of-a-mib-relative-oid}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Encoding of a MIB Relative OID](#name-encoding-of-a-mib-relative-){.section-name .selfRef} {#name-encoding-of-a-mib-relative-}

Given some OID (e.g., `lowpanMib`, assumed to be `1.3.6.1.2.1.226`
\[[RFC7388](#RFC7388){.xref}\]), to which the following is
added:[¶](#section-3.2-1){.pilcrow}

[]{.break}

ASN.1 Value Notation:

:   ::: {#section-3.2-2.2.1}
    ``` {.sourcecode .lang-asn.1}
    { lowpanObjects(1) lowpanStats(1) lowpanOutTransmits(29) }
    ```

    [¶](#section-3.2-2.2.1){.pilcrow}
    :::

:   

Dotted Decimal Notation:

:   .1.1.29[¶](#section-3.2-2.4.1){.pilcrow}

:   

[]{#name-mib-relative-object-identif}

::: {#fig-mib-ber}
::: {#section-3.2-3.1}
``` sourcecode
0D                                # UNIVERSAL TAG 13
   03                             # 3 bytes, primitive
      01 01 1D                    # X.690 Clause 8.20
#      1  1 29                      show component encoding
```
:::

[Figure 3](#figure-3){.selfRef}: [MIB Relative Object Identifier in
BER](#name-mib-relative-object-identif){.selfRef}
:::

[]{#name-mib-relative-object-identifi}

::: {#fig-mib-cbor}
::: {#section-3.2-4.1}
``` {.sourcecode .lang-cbor-pretty}
D8 6E                             # tag(110)
   43                             # 0b010_00011: mt 2 (bstr), 3 bytes
      01 01 1D                    # X.690 Clause 8.20
```
:::

[Figure 4](#figure-4){.selfRef}: [MIB Relative Object Identifier in
CBOR](#name-mib-relative-object-identifi){.selfRef}
:::

This relative OID saves seven bytes compared to the full OID
encoding.[¶](#section-3.2-5){.pilcrow}
:::
:::
:::
:::

::: {#tfs}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Tag Factoring with Arrays and Maps](#name-tag-factoring-with-arrays-a){.section-name .selfRef} {#name-tag-factoring-with-arrays-a}

The tag content of OID tags can be byte strings (as discussed above) but
also CBOR arrays and maps. The idea in the latter case is that the tag
construct is factored out from each individual item in the container;
the tag is placed on the array or map
instead.[¶](#section-4-1){.pilcrow}

When the tag content of an OID tag is an array, this means that the
respective tag is imputed to all elements of the array that are byte
strings, arrays, or maps. (There is no effect on other elements,
including text strings or tags.) For example, when the tag content of a
111 tag is an array, every array element that is a byte string is an
OID, and every element that is an array or map is, in turn, treated as
discussed here.[¶](#section-4-2){.pilcrow}

When the tag content of an OID tag is a map, this means that a tag with
the same tag number is imputed to all keys in the map that are byte
strings, arrays, or maps; again, there is no effect on keys of other
major types. Note that there is also no effect on the values in the
map.[¶](#section-4-3){.pilcrow}

As a result of these rules, tag factoring in nested arrays and maps is
supported. For example, a 3-dimensional array of OIDs can be composed by
using a single 111 tag containing an array of arrays of arrays of byte
strings. All such byte strings are then considered
OIDs.[¶](#section-4-4){.pilcrow}

::: {#preferred-serialization-considerations}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Preferred Serialization Considerations](#name-preferred-serialization-cons){.section-name .selfRef} {#name-preferred-serialization-cons}

Where tag factoring with tag number 111 is used, some OIDs enclosed in
the tag may be encoded in a shorter way by using tag number 112 instead
of encoding an unadorned byte string. This remains the preferred
serialization (see also [Section 2.2](#prefser){.xref}). However, this
specification does not make the presence or absence of tag factoring a
preferred serialization; application protocols can define where tag
factoring is to be used or not (and will need to do so if they have
deterministic encoding requirements).[¶](#section-4.1-1){.pilcrow}
:::
:::

::: {#tag-factoring-example-x500-distinguished-name}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Tag Factoring Example: X.500 Distinguished Name](#name-tag-factoring-example-x500-){.section-name .selfRef} {#name-tag-factoring-example-x500-}

Consider the X.500 distinguished name:[¶](#section-4.2-1){.pilcrow}

[]{#name-example-x500-distinguished-}

::: {#tab-dn-data}
  -----------------------------------------------------------------------
  Attribute Types                     Attribute Values
  ----------------------------------- -----------------------------------
  c (2.5.4.6)                         US

  l (2.5.4.7)\                        Los Angeles\
  s (2.5.4.8)\                        CA\
  postalCode (2.5.4.17)               90013

  street (2.5.4.9)                    532 S Olive St

  businessCategory (2.5.4.15)\        Public Park\
  buildingName                        Pershing Square
  (0.9.2342.19200300.100.1.48)        
  -----------------------------------------------------------------------

  : [Table 2](#table-2){.selfRef}: [Example X.500 Distinguished
  Name](#name-example-x500-distinguished-){.selfRef}
:::

[Table 2](#tab-dn-data){.xref} has four \"relative distinguished names\"
(RDNs). The country (first) and street (third) RDNs are single valued.
The second and fourth RDNs are multivalued.[¶](#section-4.2-3){.pilcrow}

The equivalent representations in CBOR diagnostic notation ([Section
8](https://www.rfc-editor.org/rfc/rfc8949#section-8){.relref} of
\[[RFC8949](#RFC8949){.xref}\]) and CBOR
are:[¶](#section-4.2-4){.pilcrow}

[]{#name-distinguished-name-in-cbor-}

::: {#fig-dn-cbor-diag}
::: {#section-4.2-5.1}
``` {.sourcecode .lang-cbor-diag}
111([{ h'550406': "US" },
     { h'550407': "Los Angeles",
       h'550408': "CA",
       h'550411': "90013" },
     { h'550409': "532 S Olive St" },
     { h'55040f': "Public Park",
       h'0992268993f22c640130': "Pershing Square" }])
```
:::

[Figure 5](#figure-5){.selfRef}: [Distinguished Name in CBOR Diagnostic
Notation](#name-distinguished-name-in-cbor-){.selfRef}
:::

[]{#name-distinguished-name-in-cbor-1}

::: {#fig-dn-cbor}
::: {#section-4.2-6.1}
``` {.sourcecode .lang-cbor-pretty}
d8 6f                                      # tag(111)
   84                                      # array(4)
      a1                                   # map(1)
         43 550406                         # 2.5.4.6 (4)
         62                                # text(2)
            5553                           # "US"
      a3                                   # map(3)
         43 550407                         # 2.5.4.7 (4)
         6b                                # text(11)
            4c6f7320416e67656c6573         # "Los Angeles"
         43 550408                         # 2.5.4.8 (4)
         62                                # text(2)
            4341                           # "CA"
         43 550411                         # 2.5.4.17 (4)
         65                                # text(5)
            3930303133                     # "90013"
      a1                                   # map(1)
         43 550409                         # 2.5.4.9 (4)
         6e                                # text(14)
            3533322053204f6c697665205374   # "532 S Olive St"
      a2                                   # map(2)
         43 55040f                         # 2.5.4.15 (4)
         6b                                # text(11)
            5075626c6963205061726b         # "Public Park"
         4a 0992268993f22c640130    # 0.9.2342.19200300.100.1.48 (11)
         6f                                # text(15)
            5065727368696e6720537175617265 # "Pershing Square"
```
:::

[Figure 6](#figure-6){.selfRef}: [Distinguished Name in CBOR (109
Bytes)](#name-distinguished-name-in-cbor-1){.selfRef}
:::

(This example encoding assumes that all attribute values are UTF-8
strings or can be represented as UTF-8 strings with no loss of
information.)[¶](#section-4.2-7){.pilcrow}
:::
:::
:::
:::

::: {#control}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [CDDL Control Operators](#name-cddl-control-operators){.section-name .selfRef} {#name-cddl-control-operators}

Concise Data Definition Language (CDDL) specifications
\[[RFC8610](#RFC8610){.xref}\] may want to specify the use of SDNVs or
SDNV sequences (as defined for the tag content for tag 110). This
document introduces two new control operators that can be applied to a
target value that is a byte string:[¶](#section-5-1){.pilcrow}

-   [`.sdnv`, with a control type that contains unsigned integers. The
    byte string is specified to be encoded as an SDNV (BER encoding)
    \[[RFC6256](#RFC6256){.xref}\] for the matching values of the
    control type.[¶](#section-5-2.1){.pilcrow}]{#section-5-2.1}
-   [`.sdnvseq`, with a control type that contains arrays of unsigned
    integers. The byte string is specified to be encoded as a sequence
    of SDNVs (BER encoding) \[[RFC6256](#RFC6256){.xref}\] that decodes
    to an array of unsigned integers matching the control
    type.[¶](#section-5-2.2){.pilcrow}]{#section-5-2.2}
-   [`.oid`, like `.sdnvseq`, except that the X\*40+Y translation for
    absolute OIDs is included (see [Figure
    8](#fig-dn-cddl-oid){.xref}).[¶](#section-5-2.3){.pilcrow}]{#section-5-2.3}

[Figure 7](#fig-dn-cddl){.xref} shows an example for the use of
`.sdnvseq` for a part of a structure using OIDs that could be used in
[Figure 6](#fig-dn-cbor){.xref}; [Figure 8](#fig-dn-cddl-oid){.xref}
shows the same with the `.oid` operator.[¶](#section-5-3){.pilcrow}

[]{#name-using-sdnvseq}

::: {#fig-dn-cddl}
::: {#section-5-4.1}
``` {.sourcecode .lang-cddl}
country-rdn = {country-oid => country-value}
country-oid = bytes .sdnvseq [85, 4, 6]
country-value = text .size 2
```
:::

[Figure 7](#figure-7){.selfRef}: [Using
.sdnvseq](#name-using-sdnvseq){.selfRef}
:::

[]{#name-using-oid}

::: {#fig-dn-cddl-oid}
::: {#section-5-5.1}
``` {.sourcecode .lang-cddl}
country-rdn = {country-oid => country-value}
country-oid = bytes .oid [2, 5, 4, 6]
country-value = text .size 2
```
:::

[Figure 8](#figure-8){.selfRef}: [Using .oid](#name-using-oid){.selfRef}
:::

Note that the control type need not be a literal; for example,
`bytes .oid [2, 5, 4, *uint]` matches all OIDs inside OID arc `2.5.4`,
`attributeType`.[¶](#section-5-6){.pilcrow}
:::
:::

::: {#cddl-typenames}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [CDDL Type Names](#name-cddl-type-names){.section-name .selfRef} {#name-cddl-type-names}

For the use with CDDL, the type names defined in [Figure
9](#tag-cddl){.xref} are recommended:[¶](#section-6-1){.pilcrow}

[]{#name-recommended-type-names-for-}

::: {#tag-cddl}
::: {#section-6-2.1}
``` {.sourcecode .lang-cddl}
oid = #6.111(bstr)
roid = #6.110(bstr)
pen = #6.112(bstr)
```
:::

[Figure 9](#figure-9){.selfRef}: [Recommended Type Names for
CDDL](#name-recommended-type-names-for-){.selfRef}
:::
:::
:::

::: {#iana}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#cbor-tags}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [CBOR Tags](#name-cbor-tags){.section-name .selfRef} {#name-cbor-tags}

IANA has assigned the CBOR tag numbers in [Table
3](#tab-tag-values-new){.xref} in the 1+1 byte space (24..255) of the
\"CBOR Tags\" registry \[[IANA.cbor-tags](#IANA.cbor-tags){.xref}\],
with this document as the specification
reference.[¶](#section-7.1-1){.pilcrow}

[]{#name-new-tag-numbers}

::: {#tab-tag-values-new}
  Tag   Data Item                    Semantics                                                                                 Reference
  ----- ---------------------------- ----------------------------------------------------------------------------------------- -----------
  111   byte string, array, or map   object identifier (BER encoding)                                                          RFC 9090
  110   byte string, array, or map   relative object identifier (BER encoding); SDNV \[[RFC6256](#RFC6256){.xref}\] sequence   RFC 9090
  112   byte string, array, or map   object identifier (BER encoding), relative to 1.3.6.1.4.1                                 RFC 9090

  : [Table 3](#table-3){.selfRef}: [New Tag
  Numbers](#name-new-tag-numbers){.selfRef}
:::
:::
:::

::: {#cddl-control-operators}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [CDDL Control Operators](#name-cddl-control-operators-2){.section-name .selfRef} {#name-cddl-control-operators-2}

IANA has assigned the CDDL control operators in [Table
4](#tab-operators-new){.xref} in the \"CDDL Control Operators\" registry
\[[IANA.cddl](#IANA.cddl){.xref}\], with this document as the
specification reference.[¶](#section-7.2-1){.pilcrow}

[]{#name-new-cddl-control-operators}

::: {#tab-operators-new}
  Name       Reference
  ---------- -----------
  .sdnv      RFC 9090
  .sdnvseq   RFC 9090
  .oid       RFC 9090

  : [Table 4](#table-4){.selfRef}: [New CDDL Control
  Operators](#name-new-cddl-control-operators){.selfRef}
:::
:::
:::
:::
:::

::: {#security-considerations}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations of \[[RFC8949](#RFC8949){.xref}\]
apply.[¶](#section-8-1){.pilcrow}

The encodings in Clauses 8.19 and 8.20 of \[[X.690](#X.690){.xref}\] are
quite compact and unambiguous but [MUST]{.bcp14} be followed precisely
to avoid security pitfalls. In particular, the requirements set out in
[Section 2.1](#reqts){.xref} of this document need to be followed;
otherwise, an attacker may be able to subvert a checking process by
submitting alternative representations that are later taken as the
original (or even something else entirely) by another decoder that is
intended to be protected by the checking
process.[¶](#section-8-2){.pilcrow}

OIDs and relative OIDs can always be treated as opaque byte strings.
Actually understanding the structure that was used for generating them
is not necessary, and, except for checking the structure requirements,
it is strongly [NOT RECOMMENDED]{.bcp14} to perform any processing of
this kind (e.g., converting into dotted notation and back) unless
absolutely necessary. If the OIDs are translated into other
representations, the usual security considerations for non-trivial
representation conversions apply; the integer values are unlimited in
range.[¶](#section-8-3){.pilcrow}

An attacker might trick an application into using a byte string inside a
tag-factored data item, where the byte string is not actually intended
to fall under one of the tags defined here. This may cause the
application to emit data with semantics different from what was
intended. Applications therefore need to be restrictive with respect to
what data items they apply tag factoring to.[¶](#section-8-4){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[IANA.cbor-tags\]
:   [IANA]{.refAuthor}, [\"Concise Binary Object Representation (CBOR)
    Tags\"]{.refTitle},
    \<<https://www.iana.org/assignments/cbor-tags>\>.
:   

\[IANA.cddl\]
:   [IANA]{.refAuthor}, [\"Concise Data Definition Language
    (CDDL)\"]{.refTitle}, \<<https://www.iana.org/assignments/cddl>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC6256\]
:   [Eddy, W.]{.refAuthor} and [E. Davies]{.refAuthor}, [\"Using
    Self-Delimiting Numeric Values in Protocols\"]{.refTitle}, [RFC
    6256]{.seriesInfo}, [DOI 10.17487/RFC6256]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6256>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8610\]
:   [Birkholz, H.]{.refAuthor}, [Vigano, C.]{.refAuthor}, and [C.
    Bormann]{.refAuthor}, [\"Concise Data Definition Language (CDDL): A
    Notational Convention to Express Concise Binary Object
    Representation (CBOR) and JSON Data Structures\"]{.refTitle}, [RFC
    8610]{.seriesInfo}, [DOI 10.17487/RFC8610]{.seriesInfo}, June 2019,
    \<<https://www.rfc-editor.org/info/rfc8610>\>.
:   

\[RFC8949\]
:   [Bormann, C.]{.refAuthor} and [P. Hoffman]{.refAuthor}, [\"Concise
    Binary Object Representation (CBOR)\"]{.refTitle}, [STD
    94]{.seriesInfo}, [RFC 8949]{.seriesInfo}, [DOI
    10.17487/RFC8949]{.seriesInfo}, December 2020,
    \<<https://www.rfc-editor.org/info/rfc8949>\>.
:   

\[X.660\]
:   [ITU-T]{.refAuthor}, [\"Information technology - Procedures for the
    operation of object identifier registration authorities: General
    procedures and top arcs of the international object identifier
    tree\"]{.refTitle}, [ITU-T Recommendation X.660]{.seriesInfo}, July
    2011, \<<https://www.itu.int/rec/T-REC-X.660>\>.
:   

\[X.680\]
:   [ITU-T]{.refAuthor}, [\"Information technology - Abstract Syntax
    Notation One (ASN.1): Specification of basic notation\"]{.refTitle},
    [ITU-T Recommendation X.680]{.seriesInfo}, August 2015,
    \<<https://www.itu.int/rec/T-REC-X.680>\>.
:   

\[X.690\]
:   [ITU-T]{.refAuthor}, [\"Information technology - ASN.1 encoding
    rules: Specification of Basic Encoding Rules (BER), Canonical
    Encoding Rules (CER) and Distinguished Encoding Rules
    (DER)\"]{.refTitle}, [ITU-T Recommendation X.690]{.seriesInfo},
    August 2015, \<<https://www.itu.int/rec/T-REC-X.690>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[IANA.enterprise-numbers\]
:   [IANA]{.refAuthor}, [\"Private Enterprise Numbers\"]{.refTitle},
    \<<https://www.iana.org/assignments/enterprise-numbers>\>.
:   

\[OID-INFO\]
:   [Orange SA]{.refAuthor}, [\"Object Identifier (OID)
    Repository\"]{.refTitle}, \<<http://www.oid-info.com/>\>.
:   

\[PCRE\]
:   [\"PCRE - Perl Compatible Regular Expressions\"]{.refTitle},
    \<<http://www.pcre.org/>\>.
:   

\[RFC7388\]
:   [Schoenwaelder, J.]{.refAuthor}, [Sehgal, A.]{.refAuthor},
    [Tsou, T.]{.refAuthor}, and [C. Zhou]{.refAuthor}, [\"Definition of
    Managed Objects for IPv6 over Low-Power Wireless Personal Area
    Networks (6LoWPANs)\"]{.refTitle}, [RFC 7388]{.seriesInfo}, [DOI
    10.17487/RFC7388]{.seriesInfo}, October 2014,
    \<<https://www.rfc-editor.org/info/rfc7388>\>.
:   

\[X.672\]
:   [ITU-T]{.refAuthor}, [\"Information technology - Open systems
    interconnection - Object identifier resolution system
    (ORS)\"]{.refTitle}, [ITU-T Recommendation X.672]{.seriesInfo},
    August 2010, \<<https://www.itu.int/rec/T-REC-X.672>\>.
:   
:::
:::

::: {#acknowledgments}
::: {#appendix-A .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

[Sean Leonard]{.contact-name} started the work on this document in 2014
with an elaborate proposal. [Jim Schaad]{.contact-name} provided a
significant review of this document. [Rob Wilton]{.contact-name}\'s IESG
review prompted us to provide preferred serialization
considerations.[¶](#appendix-A-1){.pilcrow}
:::
:::

::: {#contributors}
::: {#appendix-B .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

::: {.left dir="auto"}
[Sean Leonard]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Penango, Inc.]{.org}
:::

::: {.left dir="auto"}
[5900 Wilshire Boulevard\
21st Floor]{.street-address}
:::

::: {.left dir="auto"}
[Los Angeles]{.locality}, [CA]{.region} [90036]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <dev+ietf@seantek.com>
:::
:::
:::

::: {#authors-addresses}
::: {#appendix-C .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Carsten Bormann]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Universität Bremen TZI]{.org}
:::

::: {.left dir="auto"}
[Postfach 330440]{.street-address}
:::

::: {.left dir="auto"}
[D-28359]{.postal-code} [Bremen]{.locality}
:::

::: {.left dir="auto"}
[Germany]{.country-name}
:::

::: tel
Phone: [+49-421-218-63921](tel:+49-421-218-63921){.tel}
:::

::: email
Email: <cabo@tzi.org>
:::
:::
:::
