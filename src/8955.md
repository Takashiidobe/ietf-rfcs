  RFC 8955        Flow Specification   December 2020
  --------------- -------------------- ---------------
  Loibl, et al.   Standards Track      \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8955](https://www.rfc-editor.org/rfc/rfc8955){.eref}

Obsoletes:
:   [5575](https://www.rfc-editor.org/rfc/rfc5575){.eref},
    [7674](https://www.rfc-editor.org/rfc/rfc7674){.eref}

Category:
:   Standards Track

Published:
:   December 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    C. Loibl
    :::

    ::: org
    next layer Telekom GmbH
    :::
    :::

    ::: author
    ::: author-name
    S. Hares
    :::

    ::: org
    Huawei
    :::
    :::

    ::: author
    ::: author-name
    R. Raszuk
    :::

    ::: org
    NTT Network Innovations
    :::
    :::

    ::: author
    ::: author-name
    D. McPherson
    :::

    ::: org
    Verisign
    :::
    :::

    ::: author
    ::: author-name
    M. Bacher
    :::

    ::: org
    T-Mobile Austria
    :::
    :::
:::

# RFC 8955 {#rfcnum}

# Dissemination of Flow Specification Rules {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document defines a Border Gateway Protocol Network Layer
Reachability Information (BGP NLRI) encoding format that can be used to
distribute (intra-domain and inter-domain) traffic Flow Specifications
for IPv4 unicast and IPv4 BGP/MPLS VPN services. This allows the routing
system to propagate information regarding more specific components of
the traffic aggregate defined by an IP destination
prefix.[¶](#section-abstract-1){.pilcrow}

It also specifies BGP Extended Community encoding formats, which can be
used to propagate Traffic Filtering Actions along with the Flow
Specification NLRI. Those Traffic Filtering Actions encode actions a
routing system can take if the packet matches the Flow
Specification.[¶](#section-abstract-2){.pilcrow}

This document obsoletes both RFC 5575 and RFC
7674.[¶](#section-abstract-3){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8955>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Definitions of Terms Used in This
    Memo](#name-definitions-of-terms-used-i){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Flow
    Specifications](#name-flow-specifications){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Dissemination of IPv4 Flow Specification
    Information](#name-dissemination-of-ipv4-flow-){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Length
        Encoding](#name-length-encoding){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [NLRI Value
        Encoding](#name-nlri-value-encoding){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [Operators](#name-operators){.xref}[¶](#section-toc.1-1.4.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [Components](#name-components){.xref}[¶](#section-toc.1-1.4.2.2.2.2.1){.pilcrow}

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.1}
                [4.2.2.1](#section-4.2.2.1){.xref}.  [Type 1 -
                Destination
                Prefix](#name-type-1-destination-prefix){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.1.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.2}
                [4.2.2.2](#section-4.2.2.2){.xref}.  [Type 2 - Source
                Prefix](#name-type-2-source-prefix){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.2.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.3}
                [4.2.2.3](#section-4.2.2.3){.xref}.  [Type 3 - IP
                Protocol](#name-type-3-ip-protocol){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.3.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.4}
                [4.2.2.4](#section-4.2.2.4){.xref}.  [Type 4 -
                Port](#name-type-4-port){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.4.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.5}
                [4.2.2.5](#section-4.2.2.5){.xref}.  [Type 5 -
                Destination
                Port](#name-type-5-destination-port){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.5.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.6}
                [4.2.2.6](#section-4.2.2.6){.xref}.  [Type 6 - Source
                Port](#name-type-6-source-port){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.6.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.7}
                [4.2.2.7](#section-4.2.2.7){.xref}.  [Type 7 - ICMP
                Type](#name-type-7-icmp-type){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.7.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.8}
                [4.2.2.8](#section-4.2.2.8){.xref}.  [Type 8 - ICMP
                Code](#name-type-8-icmp-code){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.8.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.9}
                [4.2.2.9](#section-4.2.2.9){.xref}.  [Type 9 - TCP
                Flags](#name-type-9-tcp-flags){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.9.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.10}
                [4.2.2.10](#section-4.2.2.10){.xref}. [Type 10 - Packet
                Length](#name-type-10-packet-length){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.10.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.11}
                [4.2.2.11](#section-4.2.2.11){.xref}. [Type 11 - DSCP
                (Diffserv Code
                Point)](#name-type-11-dscp-diffserv-code-){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.11.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.2.2.2.2.12}
                [4.2.2.12](#section-4.2.2.12){.xref}. [Type 12 -
                Fragment](#name-type-12-fragment){.xref}[¶](#section-toc.1-1.4.2.2.2.2.2.12.1){.pilcrow}
                :::
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Examples of
        Encodings](#name-examples-of-encodings){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Traffic
    Filtering](#name-traffic-filtering){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Ordering of Flow
        Specifications](#name-ordering-of-flow-specificat){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Validation
    Procedure](#name-validation-procedure){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Traffic Filtering
    Actions](#name-traffic-filtering-actions){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Traffic Rate in Bytes
        (traffic-rate-bytes) Sub-Type
        0x06](#name-traffic-rate-in-bytes-traff){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Traffic Rate in Packets
        (traffic-rate-packets) Sub-Type
        0x0c](#name-traffic-rate-in-packets-tra){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Traffic-Action (traffic-action)
        Sub-Type
        0x07](#name-traffic-action-traffic-acti){.xref}[¶](#section-toc.1-1.7.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [RT Redirect (rt-redirect) Sub-Type
        0x08](#name-rt-redirect-rt-redirect-sub){.xref}[¶](#section-toc.1-1.7.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.5}
        [7.5](#section-7.5){.xref}.  [Traffic Marking (traffic-marking)
        Sub-Type
        0x09](#name-traffic-marking-traffic-mar){.xref}[¶](#section-toc.1-1.7.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.6}
        [7.6](#section-7.6){.xref}.  [Interaction with Other Filtering
        Mechanisms in
        Routers](#name-interaction-with-other-filt){.xref}[¶](#section-toc.1-1.7.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.7}
        [7.7](#section-7.7){.xref}.  [Considerations on Traffic
        Filtering Action
        Interference](#name-considerations-on-traffic-f){.xref}[¶](#section-toc.1-1.7.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Dissemination of Traffic Filtering in
    BGP/MPLS VPN
    Networks](#name-dissemination-of-traffic-fi){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Traffic
    Monitoring](#name-traffic-monitoring){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Error
    Handling](#name-error-handling){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [AFI/SAFI
        Definitions](#name-afi-safi-definitions){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Flow Component
        Definitions](#name-flow-component-definitions){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.3}
        [11.3](#section-11.3){.xref}.  [Extended Community Flow
        Specification
        Actions](#name-extended-community-flow-spe){.xref}[¶](#section-toc.1-1.11.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [13](#section-13){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}

    -   ::: {#section-toc.1-1.13.2.1}
        [13.1](#section-13.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.13.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.13.2.2}
        [13.2](#section-13.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.13.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.14}
    [Appendix A](#section-appendix.a){.xref}.  [Example Python code:
    flow_rule_cmp](#name-example-python-code-flow_ru){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.15}
    [Appendix B](#section-appendix.b){.xref}.  [Comparison with RFC
    5575](#name-comparison-with-rfc-5575){.xref}[¶](#section-toc.1-1.15.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.16}
    [](#section-appendix.c){.xref}[Acknowledgments](#name-acknowledgments){.xref}[¶](#section-toc.1-1.16.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.17}
    [](#section-appendix.d){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.17.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.18}
    [](#section-appendix.e){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.18.1){.pilcrow}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document obsoletes [\"Dissemination of Flow Specification
Rules\"](#RFC5575){.xref} \[[RFC5575](#RFC5575){.xref}\] (see [Appendix
B](#rfc5575differences){.xref} for the differences). This document also
obsoletes [\"Clarification of the Flowspec Redirect Extended
Community\"](#RFC7674){.xref} \[[RFC7674](#RFC7674){.xref}\], since it
incorporates the encoding of the BGP Flow Specification Redirect
Extended Community in [Section
7.4](#rt_redirect_action_subtype){.xref}.[¶](#section-1-1){.pilcrow}

Modern IP routers have the capability to forward traffic and to
classify, shape, rate limit, filter, or redirect packets based on
administratively defined policies. These traffic policy mechanisms allow
the operator to define match rules that operate on multiple fields of
the packet header. Actions, such as the ones described above, can be
associated with each rule.[¶](#section-1-2){.pilcrow}

The n-tuple consisting of the matching criteria defines an aggregate
traffic Flow Specification. The matching criteria can include elements
such as source and destination address prefixes, IP protocol, and
transport protocol port numbers.[¶](#section-1-3){.pilcrow}

[Section 4](#dissemination_ipv4_flowspec){.xref} of this document
defines a general procedure to encode Flow Specifications for aggregated
traffic flows so that they can be distributed as a BGP
\[[RFC4271](#RFC4271){.xref}\] NLRI. Additionally, [Section
7](#traffic_filtering_actions){.xref} of this document defines the
required Traffic Filtering Actions BGP Extended Communities and
mechanisms to use BGP for intra- and inter-provider distribution of
traffic filtering rules in order to mitigate DoS and DDoS
attacks.[¶](#section-1-4){.pilcrow}

By expanding routing information with Flow Specifications, the routing
system can take advantage of the ACL (Access Control List) or firewall
capabilities in the router\'s forwarding path. Flow Specifications can
be seen as more specific routing entries to a unicast prefix and are
expected to depend upon the existing unicast data
information.[¶](#section-1-5){.pilcrow}

A Flow Specification received from an external autonomous system will
need to be validated against unicast routing before being accepted
([Section 6](#validation_procedure){.xref}). The Flow Specification
received from an internal BGP peer within the same autonomous system
\[[RFC4271](#RFC4271){.xref}\] is assumed to have been validated prior
to transmission within the internal BGP (iBGP) mesh of an autonomous
system. If the aggregate traffic flow defined by the unicast destination
prefix is forwarded to a given BGP peer, then the local system can
install more specific Flow Specifications that may result in different
forwarding behavior, as requested by this
system.[¶](#section-1-6){.pilcrow}

From an operational perspective, the utilization of BGP as the carrier
for this information allows a network service provider to reuse both
internal route distribution infrastructure (e.g., route reflector or
confederation design) and existing external relationships (e.g.,
inter-domain BGP sessions to a customer
network).[¶](#section-1-7){.pilcrow}

While it is certainly possible to address this problem using other
mechanisms, this solution has been utilized in deployments because of
the substantial advantage of being an incremental addition to already
deployed mechanisms.[¶](#section-1-8){.pilcrow}

Possible applications of that extension are: Automated inter-domain
coordination of traffic filtering, such as what is required in order to
mitigate DoS and DDoS attacks or traffic filtering in the context of a
BGP/MPLS VPN service. Other applications (e.g., centralized control of
traffic in a Software-Defined Networking (SDN) or Network Function
Virtualization (NFV) context) are also
possible.[¶](#section-1-9){.pilcrow}

In current deployments, the information distributed by this extension is
originated both manually as well as automatically, the latter by systems
that are able to detect malicious traffic flows. When automated systems
are used, care should be taken to ensure the correctness of the
automated system. The limitations of the receiving systems that need to
process these automated Flow Specifications need to be taken in
consideration as well (see also [Section
12](#security_considerations){.xref}).[¶](#section-1-10){.pilcrow}

This specification defines required protocol extensions to address most
common applications of IPv4 unicast and VPNv4 unicast filtering. The
same mechanism can be reused and new match criteria added to address
similar filtering needs for other BGP address families, such as IPv6
families \[[RFC8956](#RFC8956){.xref}\].[¶](#section-1-11){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Definitions of Terms Used in This Memo](#name-definitions-of-terms-used-i){.section-name .selfRef} {#name-definitions-of-terms-used-i}

[]{.break}

AFI:
:   Address Family Identifier[¶](#section-2-1.2){.pilcrow}
:   

AS:
:   Autonomous System[¶](#section-2-1.4){.pilcrow}
:   

Loc-RIB:
:   The Loc-RIB contains the routes that have been selected by the local
    BGP speaker\'s Decision Process
    \[[RFC4271](#RFC4271){.xref}\].[¶](#section-2-1.6){.pilcrow}
:   

NLRI:
:   Network Layer Reachability Information[¶](#section-2-1.8){.pilcrow}
:   

PE:
:   Provider Edge router[¶](#section-2-1.10){.pilcrow}
:   

RIB:
:   Routing Information Base[¶](#section-2-1.12){.pilcrow}
:   

SAFI:
:   Subsequent Address Family Identifier[¶](#section-2-1.14){.pilcrow}
:   

VRF:
:   Virtual Routing and Forwarding[¶](#section-2-1.16){.pilcrow}
:   

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-2){.pilcrow}
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Flow Specifications](#name-flow-specifications){.section-name .selfRef} {#name-flow-specifications}

A Flow Specification is an n-tuple consisting of several matching
criteria that can be applied to IP traffic. A given IP packet is said to
match the defined Flow Specification if it matches all the specified
criteria. This n-tuple is encoded into a BGP NLRI defined
below.[¶](#section-3-1){.pilcrow}

A given Flow Specification may be associated with a set of attributes,
depending on the particular application; such attributes may or may not
include reachability information (i.e., NEXT_HOP). Well-known or
AS-specific community attributes can be used to encode a set of
predetermined actions.[¶](#section-3-2){.pilcrow}

A particular application is identified by a specific (Address Family
Identifier, Subsequent Address Family Identifier (AFI, SAFI)) pair
\[[RFC4760](#RFC4760){.xref}\] and corresponds to a distinct set of
RIBs. Those RIBs should be treated independently from each other in
order to assure noninterference between distinct
applications.[¶](#section-3-3){.pilcrow}

BGP itself treats the NLRI as a key to an entry in its databases.
Entries that are placed in the Loc-RIB are then associated with a given
set of semantics, which is application dependent. This is consistent
with existing BGP applications. For instance, IP unicast routing (AFI=1,
SAFI=1) and IP multicast reverse-path information (AFI=1, SAFI=2) are
handled by BGP without any particular semantics being associated with
them until installed in the Loc-RIB.[¶](#section-3-4){.pilcrow}

Standard BGP policy mechanisms, such as UPDATE filtering by NLRI prefix
as well as community matching, must apply to the Flow specification
defined NLRI-type. Network operators can also control propagation of
such routing updates by enabling or disabling the exchange of a
particular (AFI, SAFI) pair on a given BGP peering
session.[¶](#section-3-5){.pilcrow}
:::

::: {#dissemination_ipv4_flowspec}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Dissemination of IPv4 Flow Specification Information](#name-dissemination-of-ipv4-flow-){.section-name .selfRef} {#name-dissemination-of-ipv4-flow-}

This document defines a Flow Specification NLRI type ([Figure
1](#fs_nlri){.xref}) that may include several components, such as
destination prefix, source prefix, protocol, ports, and others (see
[Section 4.2](#nlri_value_encoding){.xref}
below).[¶](#section-4-1){.pilcrow}

This NLRI information is encoded using MP_REACH_NLRI and MP_UNREACH_NLRI
attributes, as defined in \[[RFC4760](#RFC4760){.xref}\]. When
advertising Flow Specifications, the Length of the Next-Hop Network
Address [MUST]{.bcp14} be set to 0. The Network Address of the Next-Hop
field [MUST]{.bcp14} be ignored.[¶](#section-4-2){.pilcrow}

The NLRI field of the MP_REACH_NLRI and MP_UNREACH_NLRI is encoded as
one or more 2-tuples of the form \<length, NLRI value>. It consists of a
1- or 2-octet length field followed by a variable-length NLRI value. The
length is expressed in octets.[¶](#section-4-3){.pilcrow}

[]{#name-flow-specification-nlri-for}

::: {#fs_nlri}
::: {#section-4-4.1 .artwork .art-text .alignLeft}
                      +-------------------------------+
                      |    length (0xnn or 0xfnnn)    |
                      +-------------------------------+
                      |    NLRI value   (variable)    |
                      +-------------------------------+
:::

[Figure 1](#figure-1){.selfRef}: [Flow Specification NLRI for
IPv4](#name-flow-specification-nlri-for){.selfRef}
:::

Implementations wishing to exchange Flow Specification [MUST]{.bcp14}
use BGP\'s Capability Advertisement facility to exchange the
Multiprotocol Extension Capability Code (Code 1), as defined in
\[[RFC4760](#RFC4760){.xref}\]. The (AFI, SAFI) pair carried in the
Multiprotocol Extension Capability [MUST]{.bcp14} be (AFI=1, SAFI=133)
for IPv4 Flow Specification and (AFI=1, SAFI=134) for VPNv4 Flow
Specification.[¶](#section-4-5){.pilcrow}

::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Length Encoding](#name-length-encoding){.section-name .selfRef} {#name-length-encoding}

The length field indicates the length in octets of the variable NLRI
value:[¶](#section-4.1-1){.pilcrow}

-   [If the NLRI length is smaller than 240 (0xf0 hex) octets, the
    length field can be encoded as a single
    octet.[¶](#section-4.1-2.1){.pilcrow}]{#section-4.1-2.1}
-   [Otherwise, it is encoded as an extended-length 2-octet value in
    which the most significant nibble has the hex value
    0xf.[¶](#section-4.1-2.2){.pilcrow}]{#section-4.1-2.2}

In [Figure 1](#fs_nlri){.xref} above, values less than 240 are encoded
using two hex digits (0xnn). Values above 239 are encoded using 3 hex
digits (0xfnnn). The highest value that can be represented with this
encoding is 4095. For example, the length value of 239 is encoded as
0xef (single octet), while 240 is encoded as 0xf0f0 (2
octets).[¶](#section-4.1-3){.pilcrow}
:::

::: {#nlri_value_encoding}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [NLRI Value Encoding](#name-nlri-value-encoding){.section-name .selfRef} {#name-nlri-value-encoding}

The Flow Specification NLRI value consists of a list of optional
components and is encoded as follows:[¶](#section-4.2-1){.pilcrow}

Encoding: \<\[component\]+>[¶](#section-4.2-2){.pilcrow}

A specific packet is considered to match the Flow Specification when it
matches the intersection (AND) of all the components present in the Flow
Specification.[¶](#section-4.2-3){.pilcrow}

Components [MUST]{.bcp14} follow strict type ordering by increasing
numerical order. A given component type [MAY]{.bcp14} (exactly once) be
present in the Flow Specification. If present, it [MUST]{.bcp14} precede
any component of higher numeric type value.[¶](#section-4.2-4){.pilcrow}

All combinations of components within a single Flow Specification are
allowed. However, some combinations cannot match any packets (e.g.,
\"ICMP Type AND Port\" will never match any packets) and thus [SHOULD
NOT]{.bcp14} be propagated by BGP.[¶](#section-4.2-5){.pilcrow}

An NLRI value not encoded as specified here, including an NLRI that
contains an unknown component type, is considered malformed and error
handling according to [Section 10](#errorhandling){.xref} is
performed.[¶](#section-4.2-6){.pilcrow}

::: {#operators}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [Operators](#name-operators){.section-name .selfRef} {#name-operators}

Most of the components described below make use of comparison operators.
Which of the two operators is used is defined by the components in
[Section 4.2.2](#flowspec_components){.xref}. The operators are encoded
as a single octet.[¶](#section-4.2.1-1){.pilcrow}

::: {#numeric_operator}
::: {#section-4.2.1.1 .section}
##### [4.2.1.1.](#section-4.2.1.1){.section-number .selfRef} [Numeric Operator (numeric_op)](#name-numeric-operator-numeric_op){.section-name .selfRef} {#name-numeric-operator-numeric_op}

This operator is encoded as shown in [Figure
2](#figure_numeric_operator){.xref}.[¶](#section-4.2.1.1-1){.pilcrow}

[]{#name-numeric-operator-numeric_op-2}

::: {#figure_numeric_operator}
::: {#section-4.2.1.1-2.1 .artwork .art-text .alignLeft}
                        0   1   2   3   4   5   6   7
                      +---+---+---+---+---+---+---+---+
                      | e | a |  len  | 0 |lt |gt |eq |
                      +---+---+---+---+---+---+---+---+
:::

[Figure 2](#figure-2){.selfRef}: [Numeric Operator
(numeric_op)](#name-numeric-operator-numeric_op-2){.selfRef}
:::

[]{.break}

e (end-of-list bit):
:   Set in the last {op, value} pair in the
    list[¶](#section-4.2.1.1-3.2){.pilcrow}
:   

a (AND bit):
:   If unset, the result of the previous {op, value} pair is logically
    ORed with the current one. If set, the operation is a logical AND.
    In the first operator octet of a sequence, it [MUST]{.bcp14} be
    encoded as unset and [MUST]{.bcp14} be treated as always unset on
    decoding. The AND operator has higher priority than OR for the
    purposes of evaluating logical
    expressions.[¶](#section-4.2.1.1-3.4){.pilcrow}
:   

len (length):
:   The length of the value field for this operator given as (1 \<\<
    len). This encodes 1 (len=00), 2 (len=01), 4 (len=10), and 8
    (len=11) octets.[¶](#section-4.2.1.1-3.6){.pilcrow}
:   

0:
:   [MUST]{.bcp14} be set to 0 on NLRI encoding and [MUST]{.bcp14} be
    ignored during decoding[¶](#section-4.2.1.1-3.8){.pilcrow}
:   

lt:
:   less-than comparison between data and
    value[¶](#section-4.2.1.1-3.10){.pilcrow}
:   

gt:
:   greater-than comparison between data and
    value[¶](#section-4.2.1.1-3.12){.pilcrow}
:   

eq:
:   equality between data and value[¶](#section-4.2.1.1-3.14){.pilcrow}
:   

The bits lt, gt, and eq can be combined to produce common relational
operators, such as \"less or equal\", \"greater or equal\", and \"not
equal to\", as shown in [Table
1](#table_comparison_operator){.xref}.[¶](#section-4.2.1.1-4){.pilcrow}

[]{#name-comparison-operation-combin}

::: {#table_comparison_operator}
  lt   gt   eq   Resulting operation
  ---- ---- ---- ----------------------------------
  0    0    0    false (independent of the value)
  0    0    1    == (equal)
  0    1    0    \> (greater than)
  0    1    1    \>= (greater than or equal)
  1    0    0    \< (less than)
  1    0    1    \<= (less than or equal)
  1    1    0    != (not equal value)
  1    1    1    true (independent of the value)

  : [Table 1](#table-1){.selfRef}: [Comparison Operation
  Combinations](#name-comparison-operation-combin){.selfRef}
:::
:::
:::

::: {#bitmask_operator}
::: {#section-4.2.1.2 .section}
##### [4.2.1.2.](#section-4.2.1.2){.section-number .selfRef} [Bitmask Operator (bitmask_op)](#name-bitmask-operator-bitmask_op){.section-name .selfRef} {#name-bitmask-operator-bitmask_op}

This operator is encoded as shown in [Figure
3](#figure_bitmask_operator){.xref}.[¶](#section-4.2.1.2-1){.pilcrow}

[]{#name-bitmask-operator-bitmask_op-2}

::: {#figure_bitmask_operator}
::: {#section-4.2.1.2-2.1 .artwork .art-text .alignLeft}
                        0   1   2   3   4   5   6   7
                      +---+---+---+---+---+---+---+---+
                      | e | a |  len  | 0 | 0 |not| m |
                      +---+---+---+---+---+---+---+---+
:::

[Figure 3](#figure-3){.selfRef}: [Bitmask Operator
(bitmask_op)](#name-bitmask-operator-bitmask_op-2){.selfRef}
:::

[]{.break}

e, a, len (end-of-list bit, AND bit, and length field):
:   Most significant nibble; defined in the Numeric Operator format in
    [Section
    4.2.1.1](#numeric_operator){.xref}.[¶](#section-4.2.1.2-3.2){.pilcrow}
:   

not (NOT bit):
:   If set, logical negation of
    operation.[¶](#section-4.2.1.2-3.4){.pilcrow}
:   

m (Match bit):
:   If set, this is a bitwise match operation defined as \"(data AND
    value) == value\"; if unset, (data AND value) evaluates to TRUE if
    any of the bits in the value mask are set in the
    data.[¶](#section-4.2.1.2-3.6){.pilcrow}
:   

0 (all 0 bits):
:   [MUST]{.bcp14} be set to 0 on NLRI encoding and [MUST]{.bcp14} be
    ignored during decoding[¶](#section-4.2.1.2-3.8){.pilcrow}
:   
:::
:::
:::
:::

::: {#flowspec_components}
::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [Components](#name-components){.section-name .selfRef} {#name-components}

The encoding of each of the components begins with a type field (1
octet) followed by a variable length parameter. The following sections
define component types and parameter encodings for the IPv4 IP layer and
transport layer headers. IPv6 NLRI component types are described in
\[[RFC8956](#RFC8956){.xref}\].[¶](#section-4.2.2-1){.pilcrow}

::: {#type_1}
::: {#section-4.2.2.1 .section}
##### [4.2.2.1.](#section-4.2.2.1){.section-number .selfRef} [Type 1 - Destination Prefix](#name-type-1-destination-prefix){.section-name .selfRef} {#name-type-1-destination-prefix}

Encoding: \<type (1 octet), length (1 octet), prefix
(variable)>[¶](#section-4.2.2.1-1){.pilcrow}

Defines the destination prefix to match. The length and prefix fields
are encoded as in BGP UPDATE messages
\[[RFC4271](#RFC4271){.xref}\].[¶](#section-4.2.2.1-2){.pilcrow}
:::
:::

::: {#type_2}
::: {#section-4.2.2.2 .section}
##### [4.2.2.2.](#section-4.2.2.2){.section-number .selfRef} [Type 2 - Source Prefix](#name-type-2-source-prefix){.section-name .selfRef} {#name-type-2-source-prefix}

Encoding: \<type (1 octet), length (1 octet), prefix
(variable)>[¶](#section-4.2.2.2-1){.pilcrow}

Defines the source prefix to match. The length and prefix fields are
encoded as in BGP UPDATE messages
\[[RFC4271](#RFC4271){.xref}\].[¶](#section-4.2.2.2-2){.pilcrow}
:::
:::

::: {#type_3}
::: {#section-4.2.2.3 .section}
##### [4.2.2.3.](#section-4.2.2.3){.section-number .selfRef} [Type 3 - IP Protocol](#name-type-3-ip-protocol){.section-name .selfRef} {#name-type-3-ip-protocol}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.3-1){.pilcrow}

Contains a list of {numeric_op, value} pairs that are used to match the
IP protocol value octet in IP packet header (see [Section
3.1](https://www.rfc-editor.org/rfc/rfc791#section-3.1){.relref} of
\[[RFC0791](#RFC0791){.xref}\]).[¶](#section-4.2.2.3-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 3 component values
[SHOULD]{.bcp14} be encoded as single octet (numeric_op
len=00).[¶](#section-4.2.2.3-3){.pilcrow}
:::
:::

::: {#type_4}
::: {#section-4.2.2.4 .section}
##### [4.2.2.4.](#section-4.2.2.4){.section-number .selfRef} [Type 4 - Port](#name-type-4-port){.section-name .selfRef} {#name-type-4-port}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.4-1){.pilcrow}

Defines a list of {numeric_op, value} pairs that match source OR
destination TCP/UDP ports (see [Section
3.1](https://www.rfc-editor.org/rfc/rfc793#section-3.1){.relref} of
\[[RFC0793](#RFC0793){.xref}\] and the \"Format\" section of
\[[RFC0768](#RFC0768){.xref}\]). This component matches if either the
destination port OR the source port of an IP packet matches the
value.[¶](#section-4.2.2.4-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 4 component values
[SHOULD]{.bcp14} be encoded as 1- or 2-octet quantities (numeric_op
len=00 or len=01).[¶](#section-4.2.2.4-3){.pilcrow}

In case of the presence of the port (destination-port ([Section
4.2.2.5](#type_5){.xref}), source-port ([Section
4.2.2.6](#type_6){.xref})) component, only TCP or UDP packets can match
the entire Flow Specification. The port component, if present, never
matches when the packet\'s IP protocol value is not 6 (TCP) or 17 (UDP),
if the packet is fragmented and this is not the first fragment, or if
the system is unable to locate the transport header. Different
implementations may or may not be able to decode the transport header in
the presence of IP options or Encapsulating Security Payload (ESP) NULL
\[[RFC4303](#RFC4303){.xref}\]
encryption.[¶](#section-4.2.2.4-4){.pilcrow}
:::
:::

::: {#type_5}
::: {#section-4.2.2.5 .section}
##### [4.2.2.5.](#section-4.2.2.5){.section-number .selfRef} [Type 5 - Destination Port](#name-type-5-destination-port){.section-name .selfRef} {#name-type-5-destination-port}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.5-1){.pilcrow}

Defines a list of {numeric_op, value} pairs used to match the
destination port of a TCP or UDP packet (see also [Section
3.1](https://www.rfc-editor.org/rfc/rfc793#section-3.1){.relref} of
\[[RFC0793](#RFC0793){.xref}\] and the \"Format\" section of
\[[RFC0768](#RFC0768){.xref}\].[¶](#section-4.2.2.5-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 5 component values
[SHOULD]{.bcp14} be encoded as 1- or 2-octet quantities (numeric_op
len=00 or len=01).[¶](#section-4.2.2.5-3){.pilcrow}

The last paragraph of [Section 4.2.2.4](#type_4){.xref} also applies to
this component.[¶](#section-4.2.2.5-4){.pilcrow}
:::
:::

::: {#type_6}
::: {#section-4.2.2.6 .section}
##### [4.2.2.6.](#section-4.2.2.6){.section-number .selfRef} [Type 6 - Source Port](#name-type-6-source-port){.section-name .selfRef} {#name-type-6-source-port}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.6-1){.pilcrow}

Defines a list of {numeric_op, value} pairs used to match the source
port of a TCP or UDP packet (see also [Section
3.1](https://www.rfc-editor.org/rfc/rfc793#section-3.1){.relref} of
\[[RFC0793](#RFC0793){.xref}\] and the \"Format\" section of
\[[RFC0768](#RFC0768){.xref}\].[¶](#section-4.2.2.6-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 6 component values
[SHOULD]{.bcp14} be encoded as 1- or 2-octet quantities (numeric_op
len=00 or len=01).[¶](#section-4.2.2.6-3){.pilcrow}

The last paragraph of [Section 4.2.2.4](#type_4){.xref} also applies to
this component.[¶](#section-4.2.2.6-4){.pilcrow}
:::
:::

::: {#type_7}
::: {#section-4.2.2.7 .section}
##### [4.2.2.7.](#section-4.2.2.7){.section-number .selfRef} [Type 7 - ICMP Type](#name-type-7-icmp-type){.section-name .selfRef} {#name-type-7-icmp-type}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.7-1){.pilcrow}

Defines a list of {numeric_op, value} pairs used to match the type field
of an ICMP packet (see also the \"Message Formats\" section of
\[[RFC0792](#RFC0792){.xref}\]).[¶](#section-4.2.2.7-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 7 component values
[SHOULD]{.bcp14} be encoded as single octet (numeric_op
len=00).[¶](#section-4.2.2.7-3){.pilcrow}

In case of the presence of the ICMP type component, only ICMP packets
can match the entire Flow Specification. The ICMP type component, if
present, never matches when the packet\'s IP protocol value is not 1
(ICMP), if the packet is fragmented and this is not the first fragment,
or if the system is unable to locate the transport header. Different
implementations may or may not be able to decode the transport header in
the presence of IP options or Encapsulating Security Payload (ESP) NULL
\[[RFC4303](#RFC4303){.xref}\]
encryption.[¶](#section-4.2.2.7-4){.pilcrow}
:::
:::

::: {#type_8}
::: {#section-4.2.2.8 .section}
##### [4.2.2.8.](#section-4.2.2.8){.section-number .selfRef} [Type 8 - ICMP Code](#name-type-8-icmp-code){.section-name .selfRef} {#name-type-8-icmp-code}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.8-1){.pilcrow}

Defines a list of {numeric_op, value} pairs used to match the code field
of an ICMP packet (see also the \"Message Formats\" section of
\[[RFC0792](#RFC0792){.xref}\]).[¶](#section-4.2.2.8-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 8 component values
[SHOULD]{.bcp14} be encoded as single octet (numeric_op
len=00).[¶](#section-4.2.2.8-3){.pilcrow}

In case of the presence of the ICMP code component, only ICMP packets
can match the entire Flow Specification. The ICMP code component, if
present, never matches when the packet\'s IP protocol value is not 1
(ICMP), if the packet is fragmented and this is not the first fragment,
or if the system is unable to locate the transport header. Different
implementations may or may not be able to decode the transport header in
the presence of IP options or Encapsulating Security Payload (ESP) NULL
\[[RFC4303](#RFC4303){.xref}\]
encryption.[¶](#section-4.2.2.8-4){.pilcrow}
:::
:::

::: {#type_9}
::: {#section-4.2.2.9 .section}
##### [4.2.2.9.](#section-4.2.2.9){.section-number .selfRef} [Type 9 - TCP Flags](#name-type-9-tcp-flags){.section-name .selfRef} {#name-type-9-tcp-flags}

Encoding: \<type (1 octet), \[bitmask_op,
bitmask\]+>[¶](#section-4.2.2.9-1){.pilcrow}

Defines a list of {bitmask_op, bitmask} pairs used to match TCP control
bits (see also [Section
3.1](https://www.rfc-editor.org/rfc/rfc793#section-3.1){.relref} of
\[[RFC0793](#RFC0793){.xref}\]).[¶](#section-4.2.2.9-2){.pilcrow}

This component uses the Bitmask Operator (bitmask_op) described in
[Section 4.2.1.2](#bitmask_operator){.xref}. Type 9 component bitmasks
[MUST]{.bcp14} be encoded as 1- or 2-octet bitmask (bitmask_op len=00 or
len=01).[¶](#section-4.2.2.9-3){.pilcrow}

When a single octet (bitmask_op len=00) is specified, it matches octet
14 of the TCP header (see also [Section
3.1](https://www.rfc-editor.org/rfc/rfc793#section-3.1){.relref} of
\[[RFC0793](#RFC0793){.xref}\]), which contains the TCP control bits.
When a 2-octet (bitmask_op len=01) encoding is used, it matches octets
13 and 14 of the TCP header with the data offset (leftmost 4 bits)
always treated as 0.[¶](#section-4.2.2.9-4){.pilcrow}

In case of the presence of the TCP flags component, only TCP packets can
match the entire Flow Specification. The TCP flags component, if
present, never matches when the packet\'s IP protocol value is not 6
(TCP), if the packet is fragmented and this is not the first fragment,
or if the system is unable to locate the transport header. Different
implementations may or may not be able to decode the transport header in
the presence of IP options or Encapsulating Security Payload (ESP) NULL
\[[RFC4303](#RFC4303){.xref}\]
encryption.[¶](#section-4.2.2.9-5){.pilcrow}
:::
:::

::: {#type_10}
::: {#section-4.2.2.10 .section}
##### [4.2.2.10.](#section-4.2.2.10){.section-number .selfRef} [Type 10 - Packet Length](#name-type-10-packet-length){.section-name .selfRef} {#name-type-10-packet-length}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.10-1){.pilcrow}

Defines a list of {numeric_op, value} pairs used to match on the total
IP packet length (excluding Layer 2 but including IP
header).[¶](#section-4.2.2.10-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 10 component values
[SHOULD]{.bcp14} be encoded as 1- or 2-octet quantities (numeric_op
len=00 or len=01).[¶](#section-4.2.2.10-3){.pilcrow}
:::
:::

::: {#type_11}
::: {#section-4.2.2.11 .section}
##### [4.2.2.11.](#section-4.2.2.11){.section-number .selfRef} [Type 11 - DSCP (Diffserv Code Point)](#name-type-11-dscp-diffserv-code-){.section-name .selfRef} {#name-type-11-dscp-diffserv-code-}

Encoding: \<type (1 octet), \[numeric_op,
value\]+>[¶](#section-4.2.2.11-1){.pilcrow}

Defines a list of {numeric_op, value} pairs used to match the 6-bit DSCP
field (see also
\[[RFC2474](#RFC2474){.xref}\]).[¶](#section-4.2.2.11-2){.pilcrow}

This component uses the Numeric Operator (numeric_op) described in
[Section 4.2.1.1](#numeric_operator){.xref}. Type 11 component values
[MUST]{.bcp14} be encoded as single octet (numeric_op
len=00).[¶](#section-4.2.2.11-3){.pilcrow}

The six least significant bits contain the DSCP value. All other bits
[SHOULD]{.bcp14} be treated as 0.[¶](#section-4.2.2.11-4){.pilcrow}
:::
:::

::: {#type_12}
::: {#section-4.2.2.12 .section}
##### [4.2.2.12.](#section-4.2.2.12){.section-number .selfRef} [Type 12 - Fragment](#name-type-12-fragment){.section-name .selfRef} {#name-type-12-fragment}

Encoding: \<type (1 octet), \[bitmask_op,
bitmask\]+>[¶](#section-4.2.2.12-1){.pilcrow}

Defines a list of {bitmask_op, bitmask} pairs used to match specific IP
fragments.[¶](#section-4.2.2.12-2){.pilcrow}

This component uses the Bitmask Operator (bitmask_op) described in
[Section 4.2.1.2](#bitmask_operator){.xref}. The Type 12 component
bitmask [MUST]{.bcp14} be encoded as single octet bitmask (bitmask_op
len=00).[¶](#section-4.2.2.12-3){.pilcrow}

[]{#name-fragment-bitmask-operand}

::: {#figure_fragment_bitmask_operand}
::: {#section-4.2.2.12-4.1 .artwork .art-text .alignLeft}
                       0   1   2   3   4   5   6   7
                     +---+---+---+---+---+---+---+---+
                     | 0 | 0 | 0 | 0 |LF |FF |IsF|DF |
                     +---+---+---+---+---+---+---+---+
:::

[Figure 4](#figure-4){.selfRef}: [Fragment Bitmask
Operand](#name-fragment-bitmask-operand){.selfRef}
:::

Bitmask values:[¶](#section-4.2.2.12-5){.pilcrow}

[]{.break}

DF (Don\'t Fragment):
:   match if IP Header Flags Bit-1 (DF) \[[RFC0791](#RFC0791){.xref}\]
    is 1[¶](#section-4.2.2.12-6.2){.pilcrow}
:   

IsF (Is a fragment other than the first):
:   match if the \[[RFC0791](#RFC0791){.xref}\] IP Header Fragment
    Offset is not 0[¶](#section-4.2.2.12-6.4){.pilcrow}
:   

FF (First Fragment):
:   match if the \[[RFC0791](#RFC0791){.xref}\] IP Header Fragment
    Offset is 0 AND Flags Bit-2 (MF) is
    1[¶](#section-4.2.2.12-6.6){.pilcrow}
:   

LF (Last Fragment):
:   match if the \[[RFC0791](#RFC0791){.xref}\] IP Header Fragment
    Offset is not 0 AND Flags Bit-2 (MF) is
    0[¶](#section-4.2.2.12-6.8){.pilcrow}
:   

0:
:   [MUST]{.bcp14} be set to 0 on NLRI encoding and [MUST]{.bcp14} be
    ignored during decoding[¶](#section-4.2.2.12-6.10){.pilcrow}
:   
:::
:::
:::
:::
:::
:::

::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Examples of Encodings](#name-examples-of-encodings){.section-name .selfRef} {#name-examples-of-encodings}

::: {#section-4.3.1 .section}
#### [4.3.1.](#section-4.3.1){.section-number .selfRef} [Example 1](#name-example-1){.section-name .selfRef} {#name-example-1}

An example of a Flow Specification NLRI encoding for: \"all packets to
192.0.2.0/24 and TCP port 25\".[¶](#section-4.3.1-1){.pilcrow}

::: {#ex-1}
  length   destination      protocol   port
  -------- ---------------- ---------- ----------
  0x0b     01 18 c0 00 02   03 81 06   04 81 19

  : [Table 2](#table-2){.selfRef}
:::

Decoded:[¶](#section-4.3.1-3){.pilcrow}

::: {#ex-1-decoded}
  Value                
  ------- ------------ ----------------------------------
  0x0b    length       11 octets (if len\<240, 1 octet)
  0x01    type         Type 1 - Destination Prefix
  0x18    length       24 bit
  0xc0    prefix       192
  0x00    prefix       0
  0x02    prefix       2
  0x03    type         Type 3 - IP Protocol
  0x81    numeric_op   end-of-list, value size=1, ==
  0x06    value        6 (TCP)
  0x04    type         Type 4 - Port
  0x81    numeric_op   end-of-list, value size=1, ==
  0x19    value        25

  : [Table 3](#table-3){.selfRef}
:::

This constitutes an NLRI with an NLRI length of 11
octets.[¶](#section-4.3.1-5){.pilcrow}
:::

::: {#section-4.3.2 .section}
#### [4.3.2.](#section-4.3.2){.section-number .selfRef} [Example 2](#name-example-2){.section-name .selfRef} {#name-example-2}

An example of a Flow Specification NLRI encoding for: \"all packets to
192.0.2.0/24 from 203.0.113.0/24 and port {range \[137, 139\] or
8080}\".[¶](#section-4.3.2-1){.pilcrow}

::: {#ex-2}
  length   destination      source           port
  -------- ---------------- ---------------- -------------------------
  0x12     01 18 c0 00 02   02 18 cb 00 71   04 03 89 45 8b 91 1f 90

  : [Table 4](#table-4){.selfRef}
:::

Decoded:[¶](#section-4.3.2-3){.pilcrow}

::: {#ex-2-decoded}
  Value                 
  -------- ------------ ----------------------------------
  0x12     length       18 octets (if len\<240, 1 octet)
  0x01     type         Type 1 - Destination Prefix
  0x18     length       24 bit
  0xc0     prefix       192
  0x00     prefix       0
  0x02     prefix       2
  0x02     type         Type 2 - Source Prefix
  0x18     length       24 bit
  0xcb     prefix       203
  0x00     prefix       0
  0x71     prefix       113
  0x04     type         Type 4 - Port
  0x03     numeric_op   value size=1, \>=
  0x89     value        137
  0x45     numeric_op   \"AND\", value size=1, \<=
  0x8b     value        139
  0x91     numeric_op   end-of-list, value size=2, ==
  0x1f90   value        8080

  : [Table 5](#table-5){.selfRef}
:::

This constitutes an NLRI with an NLRI length of 18
octets.[¶](#section-4.3.2-5){.pilcrow}
:::

::: {#section-4.3.3 .section}
#### [4.3.3.](#section-4.3.3){.section-number .selfRef} [Example 3](#name-example-3){.section-name .selfRef} {#name-example-3}

An example of a Flow Specification NLRI encoding for: \"all packets to
192.0.2.1/32 and fragment { DF or FF } (matching packet with DF bit set
or First Fragments)[¶](#section-4.3.3-1){.pilcrow}

::: {#ex-3}
  length   destination         fragment
  -------- ------------------- ----------
  0x09     01 20 c0 00 02 01   0c 80 05

  : [Table 6](#table-6){.selfRef}
:::

Decoded:[¶](#section-4.3.3-3){.pilcrow}

  Value                
  ------- ------------ ---------------------------------
  0x09    length       9 octets (if len\<240, 1 octet)
  0x01    type         Type 1 - Destination Prefix
  0x20    length       32 bit
  0xc0    prefix       192
  0x00    prefix       0
  0x02    prefix       2
  0x01    prefix       1
  0x0c    type         Type 12 - Fragment
  0x80    bitmask_op   end-of-list, value size=1
  0x05    bitmask      DF=1, FF=1

  : [Table 7](#table-7){.selfRef}

This constitutes an NLRI with an NLRI length of 9
octets.[¶](#section-4.3.3-5){.pilcrow}
:::
:::
:::
:::

::: {#traffic_filtering}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Traffic Filtering](#name-traffic-filtering){.section-name .selfRef} {#name-traffic-filtering}

Traffic filtering policies have been traditionally considered to be
relatively static. Limitations of these static mechanisms caused this
new dynamic mechanism to be designed for the three new applications of
traffic filtering:[¶](#section-5-1){.pilcrow}

-   [Prevention of traffic-based, denial-of-service (DoS)
    attacks[¶](#section-5-2.1){.pilcrow}]{#section-5-2.1}
-   [Traffic filtering in the context of BGP/MPLS VPN
    service[¶](#section-5-2.2){.pilcrow}]{#section-5-2.2}
-   [Centralized traffic control for SDN/NFV
    networks[¶](#section-5-2.3){.pilcrow}]{#section-5-2.3}

These applications require coordination among service providers and/or
coordination among the AS within a service
provider.[¶](#section-5-3){.pilcrow}

The Flow Specification NLRI defined in [Section
4](#dissemination_ipv4_flowspec){.xref} conveys information about
traffic filtering rules for traffic that should be discarded or handled
in a manner specified by a set of predefined actions (which are defined
in BGP Extended Communities). This mechanism is primarily designed to
allow an upstream autonomous system to perform inbound filtering in
their ingress routers of traffic that a given downstream AS wishes to
drop.[¶](#section-5-4){.pilcrow}

In order to achieve this goal, this document specifies two
application-specific NLRI identifiers that provide traffic filters and a
set of actions encoding in BGP Extended Communities. The two
application-specific NLRI identifiers are:[¶](#section-5-5){.pilcrow}

-   [IPv4 Flow Specification identifier (AFI=1, SAFI=133) along with
    specific semantic rules for IPv4 routes
    and[¶](#section-5-6.1){.pilcrow}]{#section-5-6.1}
-   [VPNv4 Flow Specification identifier (AFI=1, SAFI=134) value, which
    can be used to propagate traffic filtering information in a BGP/MPLS
    VPN environment.[¶](#section-5-6.2){.pilcrow}]{#section-5-6.2}

Encoding of the NLRI is described in [Section
4](#dissemination_ipv4_flowspec){.xref} for IPv4 Flow Specification and
in [Section 8](#traffic_filtering_vpn){.xref} for VPNv4 Flow
Specification. The filtering actions are described in [Section
7](#traffic_filtering_actions){.xref}.[¶](#section-5-7){.pilcrow}

::: {#ordering_of_flow_spec}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Ordering of Flow Specifications](#name-ordering-of-flow-specificat){.section-name .selfRef} {#name-ordering-of-flow-specificat}

More than one Flow Specification may match a particular traffic flow.
Thus, it is necessary to define the order in which Flow Specifications
get matched and actions being applied to a particular traffic flow. This
ordering function is such that it does not depend on the arrival order
of the Flow Specification via BGP and thus is consistent in the
network.[¶](#section-5.1-1){.pilcrow}

The relative order of two Flow Specifications is determined by comparing
their respective components. The algorithm starts by comparing the
left-most components (lowest component type value) of the Flow
Specifications. If the types differ, the Flow Specification with lowest
numeric type value has higher precedence (and thus will match before)
than the Flow Specification that doesn\'t contain that component type.
If the component types are the same, then a type-specific comparison is
performed (see below). If the types are equal, the algorithm continues
with the next component.[¶](#section-5.1-2){.pilcrow}

For IP prefix values (IP destination or source prefix), if one of the
two prefixes to compare is a more specific prefix of the other, the more
specific prefix has higher precedence. Otherwise, the one with the
lowest IP value has higher precedence.[¶](#section-5.1-3){.pilcrow}

For all other component types, unless otherwise specified, the
comparison is performed by comparing the component data as a binary
string using the memcmp() function as defined by
\[[ISO_IEC_9899](#ISO_IEC_9899){.xref}\]. For strings with equal
lengths, the lowest string (memcmp) has higher precedence. For strings
of different lengths, the common prefix is compared. If the common
prefix is not equal, the string with the lowest prefix has higher
precedence. If the common prefix is equal, the longest string is
considered to have higher precedence than the shorter
one.[¶](#section-5.1-4){.pilcrow}

The code in [Appendix A](#flow_rule_cmp_src){.xref} shows a Python3
implementation of the comparison algorithm. The full code was tested
with Python 3.6.3 and can be obtained at
\<<https://github.com/stoffi92/rfc5575bis/tree/master/flowspec-cmp>\>.[¶](#section-5.1-5){.pilcrow}
:::
:::
:::
:::

::: {#validation_procedure}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Validation Procedure](#name-validation-procedure){.section-name .selfRef} {#name-validation-procedure}

Flow Specifications received from a BGP peer that are accepted in the
respective Adj-RIB-In are used as input to the route selection process.
Although the forwarding attributes of two routes for the same Flow
Specification prefix may be the same, BGP is still required to perform
its path selection algorithm in order to select the correct set of
attributes to advertise.[¶](#section-6-1){.pilcrow}

The first step of the BGP Route Selection procedure ([Section
9.1.2](https://www.rfc-editor.org/rfc/rfc4271#section-9.1.2){.relref} of
\[[RFC4271](#RFC4271){.xref}\]) is to exclude from the selection
procedure routes that are considered unfeasible. In the context of IP
routing information, this step is used to validate that the NEXT_HOP
attribute of a given route is resolvable.[¶](#section-6-2){.pilcrow}

The concept can be extended, in the case of the Flow Specification NLRI,
to allow other validation procedures.[¶](#section-6-3){.pilcrow}

The validation process described below validates Flow Specifications
against unicast routes received over the same AFI but the associated
unicast routing information SAFI:[¶](#section-6-4){.pilcrow}

-   [Flow Specification received over SAFI=133 will be validated against
    routes received over
    SAFI=1.[¶](#section-6-5.1){.pilcrow}]{#section-6-5.1}
-   [Flow Specification received over SAFI=134 will be validated against
    routes received over
    SAFI=128.[¶](#section-6-5.2){.pilcrow}]{#section-6-5.2}

In the absence of explicit configuration, a Flow Specification NLRI
[MUST]{.bcp14} be validated such that it is considered feasible if and
only if all of the conditions below are true:[¶](#section-6-6){.pilcrow}

[]{.break}

a\)
:   A destination prefix component is embedded in the Flow
    Specification.[¶](#section-6-7.1){.pilcrow}
:   

b\)
:   The originator of the Flow Specification matches the originator of
    the best-match unicast route for the destination prefix embedded in
    the Flow Specification (this is the unicast route with the longest
    possible prefix length covering the destination prefix embedded in
    the Flow Specification).[¶](#section-6-7.2){.pilcrow}
:   

c\)
:   There are no \"more-specific\" unicast routes, when compared with
    the flow destination prefix, that have been received from a
    different neighboring AS than the best-match unicast route, which
    has been determined in rule b.[¶](#section-6-7.3){.pilcrow}
:   

However, rule a [MAY]{.bcp14} be relaxed by explicit configuration,
permitting Flow Specifications that include no destination prefix
component. If such is the case, rules b and c are moot and
[MUST]{.bcp14} be disregarded.[¶](#section-6-8){.pilcrow}

By \"originator\" of a BGP route, we mean either the address of the
originator in the ORIGINATOR_ID Attribute \[[RFC4456](#RFC4456){.xref}\]
or the source IP address of the BGP peer, if this path attribute is not
present.[¶](#section-6-9){.pilcrow}

BGP implementations [MUST]{.bcp14} also enforce that the AS_PATH
attribute of a route received via the External Border Gateway Protocol
(eBGP) contains the neighboring AS in the left-most position of the
AS_PATH attribute. While this rule is optional in the BGP specification,
it becomes necessary to enforce it here for security
reasons.[¶](#section-6-10){.pilcrow}

The best-match unicast route may change over the time independently of
the Flow Specification NLRI. Therefore, a revalidation of the Flow
Specification NLRI [MUST]{.bcp14} be performed whenever unicast routes
change. Revalidation is defined as retesting rules a to c as described
above.[¶](#section-6-11){.pilcrow}

Explanation:[¶](#section-6-12){.pilcrow}

The underlying concept is that the neighboring AS that advertises the
best unicast route for a destination is allowed to advertise Flow
Specification information that conveys a destination prefix that is more
or equally specific. Thus, as long as there are no \"more-specific\"
unicast routes received from a different neighboring AS, which would be
affected by that Flow Specification, the Flow Specification is validated
successfully.[¶](#section-6-13){.pilcrow}

The neighboring AS is the immediate destination of the traffic described
by the Flow Specification. If it requests these flows to be dropped,
that request can be honored without concern that it represents a denial
of service in itself. The reasoning is that this is as if the traffic is
being dropped by the downstream autonomous system, and there is no added
value in carrying the traffic to it.[¶](#section-6-14){.pilcrow}
:::
:::

::: {#traffic_filtering_actions}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Traffic Filtering Actions](#name-traffic-filtering-actions){.section-name .selfRef} {#name-traffic-filtering-actions}

This document defines a minimum set of Traffic Filtering Actions that it
standardizes as BGP Extended Communities \[[RFC4360](#RFC4360){.xref}\].
This is not meant to be an inclusive list of all the possible actions
but only a subset that can be interpreted consistently across the
network. Additional actions can be defined as either requiring standards
or as vendor specific.[¶](#section-7-1){.pilcrow}

The default action for a matching Flow Specification is to accept the
packet (treat the packet according to the normal forwarding behavior of
the system).[¶](#section-7-2){.pilcrow}

This document defines the following Extended Communities values shown in
[Table 8](#traffic_extended_communities){.xref} in the form 0xttss,
where tt indicates the type and ss indicates the sub-type of the
Extended Community. Encodings for these Extended Communities are
described below.[¶](#section-7-3){.pilcrow}

[]{#name-traffic-filtering-action-ex}

::: {#traffic_extended_communities}
  community 0xttss   action                                                                      encoding
  ------------------ --------------------------------------------------------------------------- -------------------------------------
  0x8006             traffic-rate-bytes ([Section 7.1](#traffic_rate_in_bytes){.xref})           2-octet AS, 4-octet float
  0x800c             traffic-rate-packets ([Section 7.2](#traffic_rate_in_packets){.xref})       2-octet AS, 4-octet float
  0x8007             traffic-action ([Section 7.3](#traffic_action_subtype){.xref})              bitmask
  0x8008             rt-redirect AS-2octet ([Section 7.4](#rt_redirect_action_subtype){.xref})   2-octet AS, 4-octet value
  0x8108             rt-redirect IPv4 ([Section 7.4](#rt_redirect_action_subtype){.xref})        4-octet IPv4 address, 2-octet value
  0x8208             rt-redirect AS-4octet ([Section 7.4](#rt_redirect_action_subtype){.xref})   4-octet AS, 2-octet value
  0x8009             traffic-marking ([Section 7.5](#traffic_marking_subtype){.xref})            DSCP value

  : [Table 8](#table-8){.selfRef}: [Traffic Filtering Action Extended
  Communities](#name-traffic-filtering-action-ex){.selfRef}
:::

Multiple Traffic Filtering Actions defined in this document may be
present for a single Flow Specification and [SHOULD]{.bcp14} be applied
to the traffic flow (for example, traffic-rate-bytes and rt-redirect can
be applied to packets at the same time). If not all of the Traffic
Filtering Actions can be applied to a traffic flow, they should be
treated as interfering Traffic Filtering Actions (see
below).[¶](#section-7-5){.pilcrow}

Some Traffic Filtering Actions may interfere with each other or even
contradict. [Section 7.7](#rules_action_interference){.xref} of this
document provides general considerations on such Traffic Filtering
Action interference. Any additional definition of Traffic Filtering
Actions [SHOULD]{.bcp14} specify the action to take if those Traffic
Filtering Actions interfere (also with existing Traffic Filtering
Actions).[¶](#section-7-6){.pilcrow}

All Traffic Filtering Actions are specified as transitive BGP Extended
Communities.[¶](#section-7-7){.pilcrow}

::: {#traffic_rate_in_bytes}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Traffic Rate in Bytes (traffic-rate-bytes) Sub-Type 0x06](#name-traffic-rate-in-bytes-traff){.section-name .selfRef} {#name-traffic-rate-in-bytes-traff}

The traffic-rate-bytes Extended Community uses the following Extended
Community encoding:[¶](#section-7.1-1){.pilcrow}

The first two octets carry the 2-octet id, which can be assigned from a
2-octet AS number. When a 4-octet AS number is locally present, the 2
least significant octets of such an AS number can be used. This value is
purely informational and [SHOULD NOT]{.bcp14} be interpreted by the
implementation.[¶](#section-7.1-2){.pilcrow}

The remaining 4 octets carry the maximum rate information in IEEE
floating point \[[IEEE.754.1985](#IEEE.754.1985){.xref}\] format, units
being bytes per second. A traffic-rate of 0 should result on all traffic
for the particular flow to be discarded. On encoding, the traffic-rate
[MUST NOT]{.bcp14} be negative. On decoding, negative values
[MUST]{.bcp14} be treated as zero (discard all
traffic).[¶](#section-7.1-3){.pilcrow}

Interferes with: May interfere with the traffic-rate-packets (see
[Section 7.2](#traffic_rate_in_packets){.xref}). A policy may allow both
filtering by traffic-rate-packets and traffic-rate-bytes. If the policy
does not allow this, these two actions will
conflict.[¶](#section-7.1-4){.pilcrow}
:::
:::

::: {#traffic_rate_in_packets}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Traffic Rate in Packets (traffic-rate-packets) Sub-Type 0x0c](#name-traffic-rate-in-packets-tra){.section-name .selfRef} {#name-traffic-rate-in-packets-tra}

The traffic-rate-packets Extended Community uses the same encoding as
the traffic-rate-bytes Extended Community. The floating point value
carries the maximum packet rate in packets per second. A
traffic-rate-packets of 0 should result in all traffic for the
particular flow to be discarded. On encoding, the traffic-rate-packets
[MUST NOT]{.bcp14} be negative. On decoding, negative values
[MUST]{.bcp14} be treated as zero (discard all
traffic).[¶](#section-7.2-1){.pilcrow}

Interferes with: May interfere with the traffic-rate-bytes (see [Section
7.1](#traffic_rate_in_bytes){.xref}). A policy may allow both filtering
by traffic-rate-packets and traffic-rate-bytes. If the policy does not
allow this, these two actions will
conflict.[¶](#section-7.2-2){.pilcrow}
:::
:::

::: {#traffic_action_subtype}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Traffic-Action (traffic-action) Sub-Type 0x07](#name-traffic-action-traffic-acti){.section-name .selfRef} {#name-traffic-action-traffic-acti}

The traffic-action Extended Community consists of 6 octets of which only
the 2 least significant bits of the 6th octet (from left to right) are
defined by this document, as shown in [Figure
5](#figure_traffic_action_encoding){.xref}.[¶](#section-7.3-1){.pilcrow}

[]{#name-traffic-action-extended-com}

::: {#figure_traffic_action_encoding}
::: {#section-7.3-2.1 .artwork .art-text .alignLeft}
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Traffic Action Field                                          |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Tr. Action Field (cont.)  |S|T|
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 5](#figure-5){.selfRef}: [Traffic-Action Extended Community
Encoding](#name-traffic-action-extended-com){.selfRef}
:::

S and T are defined as:[¶](#section-7.3-3){.pilcrow}

[]{.break}

T
:   Terminal Action (bit 47): When this bit is set, the traffic
    filtering engine will evaluate any subsequent Flow Specifications
    (as defined by the ordering procedure [Section
    5.1](#ordering_of_flow_spec){.xref}). If not set, the evaluation of
    the traffic filters stops when this Flow Specification is
    evaluated.[¶](#section-7.3-4.2){.pilcrow}
:   

S
:   Sample (bit 46): Enables traffic sampling and logging for this Flow
    Specification (only effective when
    set).[¶](#section-7.3-4.4){.pilcrow}
:   

Traffic Action Field:
:   Other Traffic Action Field (see [Section 11](#IANA){.xref}) bits
    unused in this specification. These bits [MUST]{.bcp14} be set to 0
    on encoding and [MUST]{.bcp14} be ignored during
    decoding.[¶](#section-7.3-4.6){.pilcrow}
:   

The use of the Terminal Action (bit 47) may result in more than one Flow
Specification matching a particular traffic flow. All the Traffic
Filtering Actions from these Flow Specifications shall be collected and
applied. In case of interfering Traffic Filtering Actions, it is an
implementation decision which Traffic Filtering Actions are selected.
See also [Section
7.7](#rules_action_interference){.xref}.[¶](#section-7.3-5){.pilcrow}

Interferes with: No other BGP Flow Specification Traffic Filtering
Action in this document.[¶](#section-7.3-6){.pilcrow}
:::
:::

::: {#rt_redirect_action_subtype}
::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [RT Redirect (rt-redirect) Sub-Type 0x08](#name-rt-redirect-rt-redirect-sub){.section-name .selfRef} {#name-rt-redirect-rt-redirect-sub}

The redirect Extended Community allows the traffic to be redirected to a
VRF routing instance that lists the specified route-target in its import
policy. If several local instances match this criteria, the choice
between them is a local matter (for example, the instance with the
lowest Route Distinguisher value can be
elected).[¶](#section-7.4-1){.pilcrow}

This Extended Community allows 3 different encodings formats for the
route-target (type 0x80, 0x81, 0x82). It uses the same encoding as the
Route Target Extended Community in Sections
[3.1](https://www.rfc-editor.org/rfc/rfc4360#section-3.1){.relref} (type
0x80: 2-octet AS, 4-octet value),
[3.2](https://www.rfc-editor.org/rfc/rfc4360#section-3.2){.relref} (type
0x81: 4-octet IPv4 address, 2-octet value), and
[4](https://www.rfc-editor.org/rfc/rfc4360#section-4){.relref} of
\[[RFC4360](#RFC4360){.xref}\] and [Section
2](https://www.rfc-editor.org/rfc/rfc5668#section-2){.relref} of
\[[RFC5668](#RFC5668){.xref}\] (type 0x82: 4-octet AS, 2-octet value)
with the high-order octet of the Type field 0x80, 0x81, 0x82
respectively and the low-order octet of the Type field (Sub-Type) always
0x08.[¶](#section-7.4-2){.pilcrow}

Interferes with: No other BGP Flow Specification Traffic Filtering
Action in this document.[¶](#section-7.4-3){.pilcrow}
:::
:::

::: {#traffic_marking_subtype}
::: {#section-7.5 .section}
### [7.5.](#section-7.5){.section-number .selfRef} [Traffic Marking (traffic-marking) Sub-Type 0x09](#name-traffic-marking-traffic-mar){.section-name .selfRef} {#name-traffic-marking-traffic-mar}

The traffic marking Extended Community instructs a system to modify the
DSCP bits in the IP header ([Section
3](https://www.rfc-editor.org/rfc/rfc2474#section-3){.relref} of
\[[RFC2474](#RFC2474){.xref}\]) of a transiting IP packet to the
corresponding value encoded in the 6 least significant bits of the
Extended Community value, as shown in [Figure
6](#figure_traffic_marking_encoding){.xref}.[¶](#section-7.5-1){.pilcrow}

The Extended Community is encoded as
follows:[¶](#section-7.5-2){.pilcrow}

[]{#name-traffic-marking-extended-co}

::: {#figure_traffic_marking_encoding}
::: {#section-7.5-3.1 .artwork .art-text .alignLeft}
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   reserved    |   reserved    |   reserved    |   reserved    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   reserved    | r.|    DSCP   |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 6](#figure-6){.selfRef}: [Traffic Marking Extended Community
Encoding](#name-traffic-marking-extended-co){.selfRef}
:::

[]{.break}

DSCP:
:   new DSCP value for the transiting IP
    packet[¶](#section-7.5-4.2){.pilcrow}
:   

reserved (r):
:   [MUST]{.bcp14} be set to 0 on encoding and [MUST]{.bcp14} be ignored
    during decoding[¶](#section-7.5-4.4){.pilcrow}
:   

Interferes with: No other BGP Flow Specification Traffic Filtering
Action in this document.[¶](#section-7.5-5){.pilcrow}
:::
:::

::: {#section-7.6 .section}
### [7.6.](#section-7.6){.section-number .selfRef} [Interaction with Other Filtering Mechanisms in Routers](#name-interaction-with-other-filt){.section-name .selfRef} {#name-interaction-with-other-filt}

Implementations should provide mechanisms that map an arbitrary BGP
community value (normal or extended) to Traffic Filtering Actions that
require different mappings on different systems in the network. For
instance, providing packets with a worse-than-best-effort per-hop
behavior is a functionality that is likely to be implemented differently
in different systems and for which no standard behavior is currently
known. Rather than attempting to define it here, this can be
accomplished by mapping a user-defined community value to
platform-/network-specific behavior via user
configuration.[¶](#section-7.6-1){.pilcrow}
:::

::: {#rules_action_interference}
::: {#section-7.7 .section}
### [7.7.](#section-7.7){.section-number .selfRef} [Considerations on Traffic Filtering Action Interference](#name-considerations-on-traffic-f){.section-name .selfRef} {#name-considerations-on-traffic-f}

Since Traffic Filtering Actions are represented as BGP extended
community values, Traffic Filtering Actions may interfere with each
other (e.g., there may be more than one conflicting traffic-rate-bytes
Traffic Filtering Action associated with a single Flow Specification).
Traffic Filtering Action interference has no impact on BGP propagation
of Flow Specifications (all communities are propagated according to
policies).[¶](#section-7.7-1){.pilcrow}

If a Flow Specification associated with interfering Traffic Filtering
Actions is selected for packet forwarding, it is an implementation
decision which of the interfering Traffic Filtering Actions are
selected. Implementors of this specification [SHOULD]{.bcp14} document
the behavior of their implementation in such
cases.[¶](#section-7.7-2){.pilcrow}

Operators are encouraged to make use of the BGP policy framework
supported by their implementation in order to achieve a predictable
behavior. See also [Section
12](#security_considerations){.xref}.[¶](#section-7.7-3){.pilcrow}
:::
:::
:::
:::

::: {#traffic_filtering_vpn}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Dissemination of Traffic Filtering in BGP/MPLS VPN Networks](#name-dissemination-of-traffic-fi){.section-name .selfRef} {#name-dissemination-of-traffic-fi}

Provider-based Layer 3 VPN networks, such as the ones using a BGP/ MPLS
IP VPN \[[RFC4364](#RFC4364){.xref}\] control plane, may have different
traffic filtering requirements than Internet service providers. But also
Internet service providers may use those VPNs for scenarios like having
the Internet routing table in a VRF, resulting in the same traffic
filtering requirements as defined for the global routing table
environment within this document. This document defines an additional
BGP NLRI type (AFI=1, SAFI=134) value, which can be used to propagate
Flow Specification in a BGP/MPLS VPN
environment.[¶](#section-8-1){.pilcrow}

The NLRI format for this address family consists of a fixed-length Route
Distinguisher field (8 octets) followed by the Flow Specification NLRI
value ([Section 4.2](#nlri_value_encoding){.xref}). The NLRI length
field shall include both the 8 octets of the Route Distinguisher as well
as the subsequent Flow Specification NLRI value. The resulting encoding
is shown in [Figure
7](#figure_fs_nlri_mpls){.xref}.[¶](#section-8-2){.pilcrow}

[]{#name-flow-specification-nlri-for-}

::: {#figure_fs_nlri_mpls}
::: {#section-8-3.1 .artwork .art-text .alignLeft}
                     +--------------------------------+
                     | length (0xnn or 0xfnnn)        |
                     +--------------------------------+
                     | Route Distinguisher (8 octets) |
                     +--------------------------------+
                     |    NLRI value  (variable)      |
                     +--------------------------------+
:::

[Figure 7](#figure-7){.selfRef}: [Flow Specification NLRI for
MPLS](#name-flow-specification-nlri-for-){.selfRef}
:::

Propagation of this NLRI is controlled by matching Route Target extended
communities associated with the BGP path advertisement with the VRF
import policy, using the same mechanism as described in BGP/ MPLS IP
VPNs \[[RFC4364](#RFC4364){.xref}\].[¶](#section-8-4){.pilcrow}

Flow Specifications received via this NLRI apply only to traffic that
belongs to the VRF(s) in which it is imported. By default, traffic
received from a remote PE is switched via an MPLS forwarding decision
and is not subject to filtering.[¶](#section-8-5){.pilcrow}

Contrary to the behavior specified for the non-VPN NLRI, Flow
Specifications are accepted by default, when received from remote PE
routers.[¶](#section-8-6){.pilcrow}

The validation procedure ([Section 6](#validation_procedure){.xref}) and
Traffic Filtering Actions ([Section
7](#traffic_filtering_actions){.xref}) are the same as for
IPv4.[¶](#section-8-7){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Traffic Monitoring](#name-traffic-monitoring){.section-name .selfRef} {#name-traffic-monitoring}

Traffic filtering applications require monitoring and traffic statistics
facilities. While this is an implementation specific choice,
implementations [SHOULD]{.bcp14} provide:[¶](#section-9-1){.pilcrow}

-   [A mechanism to log the packet header of filtered
    traffic.[¶](#section-9-2.1){.pilcrow}]{#section-9-2.1}
-   [A mechanism to count the number of matches for a given Flow
    Specification rule.[¶](#section-9-2.2){.pilcrow}]{#section-9-2.2}
:::

::: {#errorhandling}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Error Handling](#name-error-handling){.section-name .selfRef} {#name-error-handling}

Error handling according to \[[RFC7606](#RFC7606){.xref}\] and
\[[RFC4760](#RFC4760){.xref}\] applies to this
specification.[¶](#section-10-1){.pilcrow}

This document introduces Traffic Filtering Action Extended Communities.
Malformed Traffic Filtering Action Extended Communities in the sense of
[Section
7.14](https://www.rfc-editor.org/rfc/rfc7606#section-7.14){.relref} of
\[[RFC7606](#RFC7606){.xref}\] are Extended Community values that cannot
be decoded according to [Section 7](#traffic_filtering_actions){.xref}
of this document.[¶](#section-10-2){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This section complies with
\[[RFC7153](#RFC7153){.xref}\].[¶](#section-11-1){.pilcrow}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [AFI/SAFI Definitions](#name-afi-safi-definitions){.section-name .selfRef} {#name-afi-safi-definitions}

IANA maintains a registry entitled \"SAFI Values\". For the purpose of
this work, IANA has updated the following SAFIs as shown in the table
below. (Note: This document obsoletes both
\[[RFC7674](#RFC7674){.xref}\] and \[[RFC5575](#RFC5575){.xref}\], and
all references to those documents have been deleted from the
registry.)[¶](#section-11.1-1){.pilcrow}

[]{#name-registry-safi-values}

::: {#iana_safi}
  Value   Name                                              Reference
  ------- ------------------------------------------------- -----------
  133     Dissemination of Flow Specification rules         RFC 8955
  134     L3VPN Dissemination of Flow Specification rules   RFC 8955

  : [Table 9](#table-9){.selfRef}: [Registry: SAFI
  Values](#name-registry-safi-values){.selfRef}
:::

The above textual changes generalize the definition of the SAFIs rather
than change its underlying meaning. Therefore, based on [\"The YANG 1.1
Data Modeling Language\"](#RFC7950){.xref}
\[[RFC7950](#RFC7950){.xref}\], the above text means that the following
YANG enums from [\"Common YANG Data Types for the Routing
Area\"](#RFC8294){.xref} \[[RFC8294](#RFC8294){.xref}\] have had their
names and descriptions at
\<<https://www.iana.org/assignments/iana-routing-types>\> changed
to:[¶](#section-11.1-3){.pilcrow}

::: {#section-11.1-4}
``` {.sourcecode .lang-yang}
<CODE BEGINS>
   enum flow-spec-safi {
          value 133;
          description
            "Dissemination of Flow Specification rules SAFI.";
        }
   enum l3vpn-flow-spec-safi {
          value 134;
          description
            "L3VPN Dissemination of Flow Specification rules SAFI.";
        }

<CODE ENDS>
```

[¶](#section-11.1-4){.pilcrow}
:::

A new revision statement has been added to the module as
follows:[¶](#section-11.1-5){.pilcrow}

::: {#section-11.1-6}
``` {.sourcecode .lang-yang}
<CODE BEGINS>
   revision 2020-12-31 {
     description "Non-backwards-compatible change of SAFI names
                  (SAFI values 133, 134).";
     reference
       "RFC 8955: Dissemination of Flow Specification Rules.";
  }

<CODE ENDS>
```

[¶](#section-11.1-6){.pilcrow}
:::
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Flow Component Definitions](#name-flow-component-definitions){.section-name .selfRef} {#name-flow-component-definitions}

A Flow Specification consists of a sequence of flow components, which
are identified by an 8-bit component type. IANA has created and
maintains a registry entitled \"Flow Spec Component Types\". IANA has
updated the reference for this registry to RFC 8955. Furthermore, the
references to the values have been updated according to the table below
(Note: This document obsoletes both \[[RFC7674](#RFC7674){.xref}\] and
\[[RFC5575](#RFC5575){.xref}\], and all references to those documents
have been deleted from the registry.)[¶](#section-11.2-1){.pilcrow}

[]{#name-registry-flow-spec-componen}

::: {#iana_flow_component_types}
  Value   Name                 Reference
  ------- -------------------- -----------
  1       Destination Prefix   RFC 8955
  2       Source Prefix        RFC 8955
  3       IP Protocol          RFC 8955
  4       Port                 RFC 8955
  5       Destination port     RFC 8955
  6       Source port          RFC 8955
  7       ICMP type            RFC 8955
  8       ICMP code            RFC 8955
  9       TCP flags            RFC 8955
  10      Packet length        RFC 8955
  11      DSCP                 RFC 8955
  12      Fragment             RFC 8955

  : [Table 10](#table-10){.selfRef}: [Registry: Flow Spec Component
  Types](#name-registry-flow-spec-componen){.selfRef}
:::

In order to manage the limited number space and accommodate several
usages, the following policies defined by \[[RFC8126](#RFC8126){.xref}\]
are used:[¶](#section-11.2-3){.pilcrow}

[]{#name-flow-spec-component-types-p}

::: {#iana_flow_component_types_policies}
  Type Values      Policy
  ---------------- ------------------------
  0                Reserved
  \[1 .. 127\]     Specification Required
  \[128 .. 254\]   Expert Review
  255              Reserved

  : [Table 11](#table-11){.selfRef}: [Flow Spec Component Types
  Policies](#name-flow-spec-component-types-p){.selfRef}
:::

[]{.break}

Guidance for Experts:
:   The registration policy for the range 128-254 is Expert Review. The
    experts are expected to check the clarity of purpose and use of the
    requested code points. The experts must also verify that any
    specification produced in the IETF that requests one of these code
    points has been made available for review by the IDR Working Group
    and that any specification produced outside the IETF does not
    conflict with work that is active or already published within the
    IETF. It must be pointed out that introducing new component types
    may break interoperability with existing implementations of this
    protocol.[¶](#section-11.2-5.2){.pilcrow}
:   
:::

::: {#section-11.3 .section}
### [11.3.](#section-11.3){.section-number .selfRef} [Extended Community Flow Specification Actions](#name-extended-community-flow-spe){.section-name .selfRef} {#name-extended-community-flow-spe}

The Extended Community Flow Specification Action types defined in this
document consist of two parts:[¶](#section-11.3-1){.pilcrow}

-   [Type (BGP Transitive Extended Community
    Type)[¶](#section-11.3-2.1){.pilcrow}]{#section-11.3-2.1}
-   [Sub-Type[¶](#section-11.3-2.2){.pilcrow}]{#section-11.3-2.2}

For the type part, IANA maintains a registry entitled \"BGP Transitive
Extended Community Types\". For the purpose of this work ([Section
7](#traffic_filtering_actions){.xref}), IANA has updated the references
as shown in the table below. (Note: This document obsoletes both
\[[RFC7674](#RFC7674){.xref}\] and \[[RFC5575](#RFC5575){.xref}\], and
all references to those documents have been deleted in the
registry.)[¶](#section-11.3-3){.pilcrow}

[]{#name-registry-bgp-transitive-ext}

::: {#iana_ext_comm_types}
  Type Value   Name                                                                                                                                                                                Reference
  ------------ ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -----------
  0x81         Generic Transitive Experimental Use Extended Community Part 2 (Sub-Types are defined in the \"Generic Transitive Experimental Use Extended Community Part 2 Sub-Types\" Registry)   RFC 8955
  0x82         Generic Transitive Experimental Use Extended Community Part 3 (Sub-Types are defined in the \"Generic Transitive Experimental Use Extended Community Part 3 Sub-Types\" Registry)   RFC 8955

  : [Table 12](#table-12){.selfRef}: [Registry: BGP Transitive Extended
  Community Types](#name-registry-bgp-transitive-ext){.selfRef}
:::

For the sub-type part of the Extended Community Traffic Filtering
Actions, IANA maintains the following registries. IANA has updated all
names and references according to the tables below and assign a new
value for the \"Flow spec traffic-rate-packets\" Sub-Type. (Note: This
document obsoletes both \[[RFC7674](#RFC7674){.xref}\] and
\[[RFC5575](#RFC5575){.xref}\], and all references to those documents
have been deleted from the registries
below.)[¶](#section-11.3-5){.pilcrow}

[]{#name-registry-generic-transitive}

::: {#iana_ext_comm_subtypes}
  Sub-Type Value   Name                                                                                                         Reference
  ---------------- ------------------------------------------------------------------------------------------------------------ -----------
  0x06             Flow spec traffic-rate-bytes                                                                                 RFC 8955
  0x0c             Flow spec traffic-rate-packets                                                                               RFC 8955
  0x07             Flow spec traffic-action (Use of the \"Value\" field is defined in the \"Traffic Action Fields\" registry)   RFC 8955
  0x08             Flow spec rt-redirect AS-2octet format                                                                       RFC 8955
  0x09             Flow spec traffic-remarking                                                                                  RFC 8955

  : [Table 13](#table-13){.selfRef}: [Registry: Generic Transitive
  Experimental Use Extended Community
  Sub-Types](#name-registry-generic-transitive){.selfRef}
:::

[]{#name-registry-generic-transitive-}

::: {#iana_ext_comm_subtypes2}
  Sub-Type Value   Name                                Reference
  ---------------- ----------------------------------- -----------
  0x08             Flow spec rt-redirect IPv4 format   RFC 8955

  : [Table 14](#table-14){.selfRef}: [Registry: Generic Transitive
  Experimental Use Extended Community Part 2
  Sub-Types](#name-registry-generic-transitive-){.selfRef}
:::

[]{#name-registry-generic-transitive-e}

::: {#iana_ext_comm_subtypes3}
  Sub-Type Value   Name                                     Reference
  ---------------- ---------------------------------------- -----------
  0x08             Flow spec rt-redirect AS-4octet format   RFC 8955

  : [Table 15](#table-15){.selfRef}: [Registry: Generic Transitive
  Experimental Use Extended Community Part 3
  Sub-Types](#name-registry-generic-transitive-e){.selfRef}
:::

Furthermore, IANA has updated the reference for the registries \"Generic
Transitive Experimental Use Extended Community Part 2 Sub-Types\" and
\"Generic Transitive Experimental Use Extended Community Part 3
Sub-Types\" to RFC 8955.[¶](#section-11.3-9){.pilcrow}

The \"traffic-action\" Extended Community ([Section
7.3](#traffic_action_subtype){.xref}) defined in this document has 46
unused bits, which can be used to convey additional meaning. IANA
created and maintains a registry entitled \"Traffic Action Fields\".
IANA has updated the reference for this registry to RFC 8955.
Furthermore, IANA has updated the references according to the table
below. These values should be assigned via IETF Review rules only.
(Note: This document obsoletes both \[[RFC7674](#RFC7674){.xref}\] and
\[[RFC5575](#RFC5575){.xref}\], and all references to those documents
have been deleted from the registry.)[¶](#section-11.3-10){.pilcrow}

[]{#name-registry-traffic-action-fie}

::: {#iana_traffic_action_subtype}
  Bit   Name              Reference
  ----- ----------------- -----------
  47    Terminal Action   RFC 8955
  46    Sample            RFC 8955

  : [Table 16](#table-16){.selfRef}: [Registry: Traffic Action
  Fields](#name-registry-traffic-action-fie){.selfRef}
:::
:::
:::
:::

::: {#security_considerations}
::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

As long as Flow Specifications are restricted to match the corresponding
unicast routing paths for the relevant prefixes ([Section
6](#validation_procedure){.xref}), the security characteristics of this
proposal are equivalent to the existing security properties of BGP
unicast routing. Any relaxation of the validation procedure described in
[Section 6](#validation_procedure){.xref} may allow unwanted Flow
Specifications to be propagated, and thus unwanted Traffic Filtering
Actions may be applied to flows.[¶](#section-12-1){.pilcrow}

Where the above mechanisms are not in place, this could open the door to
further denial-of-service attacks, such as unwanted traffic filtering,
remarking, or redirection.[¶](#section-12-2){.pilcrow}

Deployment of specific relaxations of the validation within an
administrative boundary of a network are useful in some networks for
quickly distributing filters to prevent denial-of-service attacks. For a
network to utilize this relaxation, the BGP policies must support
additional filtering since the origin AS field is empty. Specifications
relaxing the validation restrictions [MUST]{.bcp14} contain security
considerations that provide details on the required additional
filtering. For example, the use of origin validation can provide
enhanced filtering within an AS
confederation.[¶](#section-12-3){.pilcrow}

Inter-provider routing is based on a web of trust. Neighboring
autonomous systems are trusted to advertise valid reachability
information. If this trust model is violated, a neighboring autonomous
system may cause a denial-of-service attack by advertising reachability
information for a given prefix for which it does not provide service
(unfiltered address space hijack). Since validation of the Flow
Specification is tied to the announcement of the best unicast route, the
failure in the validation of best path route may prevent the Flow
Specification from being used by a local router. Possible mitigations
are \[[RFC6811](#RFC6811){.xref}\] and
\[[RFC8205](#RFC8205){.xref}\].[¶](#section-12-4){.pilcrow}

On Internet Exchange Points (IXPs), routes are often exchanged via route
servers that do not extend the AS_PATH. In such cases, it is not
possible to enforce the left-most AS in the AS_PATH to be the neighbor
AS (the AS of the route server). Since the validation of Flow
Specification ([Section 6](#validation_procedure){.xref}) depends on
this, additional care must be taken. It is advised to use a strict
inbound route policy in such scenarios.[¶](#section-12-5){.pilcrow}

Enabling firewall-like capabilities in routers without centralized
management could make certain failures harder to diagnose. For example,
it is possible to allow TCP packets to pass between a pair of addresses
but not ICMP packets. It is also possible to permit packets smaller than
900 or greater than 1000 octets to pass between a pair of addresses but
not packets whose length is in the range 900-1000. Such behavior may be
confusing, and these capabilities should be used with care whether
manually configured or coordinated through the protocol extensions
described in this document.[¶](#section-12-6){.pilcrow}

Flow Specification BGP speakers (e.g., automated DDoS controllers) not
properly programmed, algorithms that are not performing as expected, or
simply rogue systems may announce unintended Flow Specifications, send
updates at a high rate, or generate a high number of Flow
Specifications. This may stress the receiving systems, exceed their
capacity, or lead to unwanted Traffic Filtering Actions being applied to
flows.[¶](#section-12-7){.pilcrow}

Systems may not be able to locate all header values required to identify
a packet. This can be especially problematic in the case of fragmented
packets that are not the first fragment and thus lack upper-layer
protocol headers or Encapsulating Security Payload (ESP) NULL
\[[RFC4303](#RFC4303){.xref}\] encryption.[¶](#section-12-8){.pilcrow}

While the general verification of the Flow Specification NLRI is
specified in this document ([Section 6](#validation_procedure){.xref}),
the Traffic Filtering Actions received by a third party may need custom
verification or filtering. In particular, all non-traffic-rate actions
may allow a third party to modify packet forwarding properties and
potentially gain access to other routing-tables/VPNs or undesired
queues. This can be avoided by proper filtering/screening of the Traffic
Filtering Action communities at network borders and only exposing a
predefined subset of Traffic Filtering Actions (see [Section
7](#traffic_filtering_actions){.xref}) to third parties. One way to
achieve this is by mapping user-defined communities, which can be set by
the third party, to Traffic Filtering Actions and not accepting Traffic
Filtering Action extended communities from third
parties.[¶](#section-12-9){.pilcrow}

This extension adds additional information to Internet routers. These
are limited in terms of the maximum number of data elements they can
hold as well as the number of events they are able to process in a given
unit of time. Service providers need to consider the maximum capacity of
their devices and may need to limit the number of Flow Specifications
accepted and processed.[¶](#section-12-10){.pilcrow}
:::
:::

::: {#section-13 .section}
## [13.](#section-13){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-13.1 .section}
### [13.1.](#section-13.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[IEEE.754.1985\]
:   [IEEE]{.refAuthor}, [\"Standard for Binary Floating-Point
    Arithmetic\"]{.refTitle}, [IEEE 754-1985]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2019.8766229]{.seriesInfo}, August 1985,
    \<<https://doi.org/10.1109/IEEESTD.2019.8766229>\>.
:   

\[ISO_IEC_9899\]
:   [ISO]{.refAuthor}, [\"Information technology \-- Programming
    languages \-- C\"]{.refTitle}, [ISO/IEC 9899:2018]{.seriesInfo},
    June 2018.
:   

\[RFC0768\]
:   [Postel, J.]{.refAuthor}, [\"User Datagram Protocol\"]{.refTitle},
    [STD 6]{.seriesInfo}, [RFC 768]{.seriesInfo}, [DOI
    10.17487/RFC0768]{.seriesInfo}, August 1980,
    \<<https://www.rfc-editor.org/info/rfc768>\>.
:   

\[RFC0791\]
:   [Postel, J.]{.refAuthor}, [\"Internet Protocol\"]{.refTitle}, [STD
    5]{.seriesInfo}, [RFC 791]{.seriesInfo}, [DOI
    10.17487/RFC0791]{.seriesInfo}, September 1981,
    \<<https://www.rfc-editor.org/info/rfc791>\>.
:   

\[RFC0792\]
:   [Postel, J.]{.refAuthor}, [\"Internet Control Message
    Protocol\"]{.refTitle}, [STD 5]{.seriesInfo}, [RFC
    792]{.seriesInfo}, [DOI 10.17487/RFC0792]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc792>\>.
:   

\[RFC0793\]
:   [Postel, J.]{.refAuthor}, [\"Transmission Control
    Protocol\"]{.refTitle}, [STD 7]{.seriesInfo}, [RFC
    793]{.seriesInfo}, [DOI 10.17487/RFC0793]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc793>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2474\]
:   [Nichols, K.]{.refAuthor}[, Blake, S.]{.refAuthor}[,
    Baker, F.]{.refAuthor}[, and D. Black]{.refAuthor}, [\"Definition of
    the Differentiated Services Field (DS Field) in the IPv4 and IPv6
    Headers\"]{.refTitle}, [RFC 2474]{.seriesInfo}, [DOI
    10.17487/RFC2474]{.seriesInfo}, December 1998,
    \<<https://www.rfc-editor.org/info/rfc2474>\>.
:   

\[RFC4271\]
:   [Rekhter, Y., Ed.]{.refAuthor}[, Li, T., Ed.]{.refAuthor}[, and S.
    Hares, Ed.]{.refAuthor}, [\"A Border Gateway Protocol 4
    (BGP-4)\"]{.refTitle}, [RFC 4271]{.seriesInfo}, [DOI
    10.17487/RFC4271]{.seriesInfo}, January 2006,
    \<<https://www.rfc-editor.org/info/rfc4271>\>.
:   

\[RFC4360\]
:   [Sangli, S.]{.refAuthor}[, Tappan, D.]{.refAuthor}[, and Y.
    Rekhter]{.refAuthor}, [\"BGP Extended Communities
    Attribute\"]{.refTitle}, [RFC 4360]{.seriesInfo}, [DOI
    10.17487/RFC4360]{.seriesInfo}, February 2006,
    \<<https://www.rfc-editor.org/info/rfc4360>\>.
:   

\[RFC4364\]
:   [Rosen, E.]{.refAuthor}[ and Y. Rekhter]{.refAuthor}, [\"BGP/MPLS IP
    Virtual Private Networks (VPNs)\"]{.refTitle}, [RFC
    4364]{.seriesInfo}, [DOI 10.17487/RFC4364]{.seriesInfo}, February
    2006, \<<https://www.rfc-editor.org/info/rfc4364>\>.
:   

\[RFC4456\]
:   [Bates, T.]{.refAuthor}[, Chen, E.]{.refAuthor}[, and R.
    Chandra]{.refAuthor}, [\"BGP Route Reflection: An Alternative to
    Full Mesh Internal BGP (IBGP)\"]{.refTitle}, [RFC
    4456]{.seriesInfo}, [DOI 10.17487/RFC4456]{.seriesInfo}, April 2006,
    \<<https://www.rfc-editor.org/info/rfc4456>\>.
:   

\[RFC4760\]
:   [Bates, T.]{.refAuthor}[, Chandra, R.]{.refAuthor}[,
    Katz, D.]{.refAuthor}[, and Y. Rekhter]{.refAuthor},
    [\"Multiprotocol Extensions for BGP-4\"]{.refTitle}, [RFC
    4760]{.seriesInfo}, [DOI 10.17487/RFC4760]{.seriesInfo}, January
    2007, \<<https://www.rfc-editor.org/info/rfc4760>\>.
:   

\[RFC5668\]
:   [Rekhter, Y.]{.refAuthor}[, Sangli, S.]{.refAuthor}[, and D.
    Tappan]{.refAuthor}, [\"4-Octet AS Specific BGP Extended
    Community\"]{.refTitle}, [RFC 5668]{.seriesInfo}, [DOI
    10.17487/RFC5668]{.seriesInfo}, October 2009,
    \<<https://www.rfc-editor.org/info/rfc5668>\>.
:   

\[RFC7153\]
:   [Rosen, E.]{.refAuthor}[ and Y. Rekhter]{.refAuthor}, [\"IANA
    Registries for BGP Extended Communities\"]{.refTitle}, [RFC
    7153]{.seriesInfo}, [DOI 10.17487/RFC7153]{.seriesInfo}, March 2014,
    \<<https://www.rfc-editor.org/info/rfc7153>\>.
:   

\[RFC7606\]
:   [Chen, E., Ed.]{.refAuthor}[, Scudder, J., Ed.]{.refAuthor}[,
    Mohapatra, P.]{.refAuthor}[, and K. Patel]{.refAuthor}, [\"Revised
    Error Handling for BGP UPDATE Messages\"]{.refTitle}, [RFC
    7606]{.seriesInfo}, [DOI 10.17487/RFC7606]{.seriesInfo}, August
    2015, \<<https://www.rfc-editor.org/info/rfc7606>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::

::: {#section-13.2 .section}
### [13.2.](#section-13.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC4303\]
:   [Kent, S.]{.refAuthor}, [\"IP Encapsulating Security Payload
    (ESP)\"]{.refTitle}, [RFC 4303]{.seriesInfo}, [DOI
    10.17487/RFC4303]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4303>\>.
:   

\[RFC5575\]
:   [Marques, P.]{.refAuthor}[, Sheth, N.]{.refAuthor}[,
    Raszuk, R.]{.refAuthor}[, Greene, B.]{.refAuthor}[,
    Mauch, J.]{.refAuthor}[, and D. McPherson]{.refAuthor},
    [\"Dissemination of Flow Specification Rules\"]{.refTitle}, [RFC
    5575]{.seriesInfo}, [DOI 10.17487/RFC5575]{.seriesInfo}, August
    2009, \<<https://www.rfc-editor.org/info/rfc5575>\>.
:   

\[RFC6811\]
:   [Mohapatra, P.]{.refAuthor}[, Scudder, J.]{.refAuthor}[,
    Ward, D.]{.refAuthor}[, Bush, R.]{.refAuthor}[, and R.
    Austein]{.refAuthor}, [\"BGP Prefix Origin Validation\"]{.refTitle},
    [RFC 6811]{.seriesInfo}, [DOI 10.17487/RFC6811]{.seriesInfo},
    January 2013, \<<https://www.rfc-editor.org/info/rfc6811>\>.
:   

\[RFC7674\]
:   [Haas, J., Ed.]{.refAuthor}, [\"Clarification of the Flowspec
    Redirect Extended Community\"]{.refTitle}, [RFC 7674]{.seriesInfo},
    [DOI 10.17487/RFC7674]{.seriesInfo}, October 2015,
    \<<https://www.rfc-editor.org/info/rfc7674>\>.
:   

\[RFC7950\]
:   [Bjorklund, M., Ed.]{.refAuthor}, [\"The YANG 1.1 Data Modeling
    Language\"]{.refTitle}, [RFC 7950]{.seriesInfo}, [DOI
    10.17487/RFC7950]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7950>\>.
:   

\[RFC8205\]
:   [Lepinski, M., Ed.]{.refAuthor}[ and K. Sriram, Ed.]{.refAuthor},
    [\"BGPsec Protocol Specification\"]{.refTitle}, [RFC
    8205]{.seriesInfo}, [DOI 10.17487/RFC8205]{.seriesInfo}, September
    2017, \<<https://www.rfc-editor.org/info/rfc8205>\>.
:   

\[RFC8294\]
:   [Liu, X.]{.refAuthor}[, Qu, Y.]{.refAuthor}[,
    Lindem, A.]{.refAuthor}[, Hopps, C.]{.refAuthor}[, and L.
    Berger]{.refAuthor}, [\"Common YANG Data Types for the Routing
    Area\"]{.refTitle}, [RFC 8294]{.seriesInfo}, [DOI
    10.17487/RFC8294]{.seriesInfo}, December 2017,
    \<<https://www.rfc-editor.org/info/rfc8294>\>.
:   

\[RFC8956\]
:   [Loibl, C., Ed.]{.refAuthor}[, Raszuk, R., Ed.]{.refAuthor}[, and S.
    Hares, Ed.]{.refAuthor}, [\"Dissemination of Flow Specification
    Rules for IPv6\"]{.refTitle}, [RFC 8956]{.seriesInfo}, [DOI
    10.17487/RFC8956]{.seriesInfo}, December 2020,
    \<<https://www.rfc-editor.org/info/rfc8956>\>.
:   
:::
:::

::: {#flow_rule_cmp_src}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Example Python code: flow_rule_cmp](#name-example-python-code-flow_ru){.section-name .selfRef} {#name-example-python-code-flow_ru}

::: {#section-appendix.a-1}
``` {.sourcecode .lang-python}
<CODE BEGINS>
"""
Copyright (c) 2020 IETF Trust and the persons identified as
authors of the code.  All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, is permitted pursuant to, and subject to the license
terms contained in, the Simplified BSD License set forth in Section
4.c of the IETF Trust's Legal Provisions Relating to IETF Documents
(https://trustee.ietf.org/license-info).
"""

import itertools
import collections
import ipaddress


EQUAL = 0
A_HAS_PRECEDENCE = 1
B_HAS_PRECEDENCE = 2
IP_DESTINATION = 1
IP_SOURCE = 2

FS_component = collections.namedtuple('FS_component',
                                      'component_type op_value')


class FS_nlri(object):
    """
    FS_nlri class implementation that allows sorting.

    By calling .sort() on an array of FS_nlri objects these will be
    sorted according to the flow_rule_cmp algorithm.

    Example:
    nlri = [ FS_nlri(components=[
             FS_component(component_type=IP_DESTINATION,
                    op_value=ipaddress.ip_network('10.1.0.0/16') ),
             FS_component(component_type=4,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             ]),
             FS_nlri(components=[
             FS_component(component_type=5,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             FS_component(component_type=6,
                    op_value=bytearray([0,1,2,3,4,5,6])),
             ]),
           ]
    nlri.sort() # sorts the array according to the algorithm
    """
    def __init__(self, components = None):
        """
        components: list of type FS_component
        """
        self.components = components

    def __lt__(self, other):
        # use the below algorithm for sorting
        result = flow_rule_cmp(self, other)
        if result == B_HAS_PRECEDENCE:
            return True
        else:
            return False


def flow_rule_cmp(a, b):
    """
    Example of the flowspec comparison algorithm.
    """
    for comp_a, comp_b in itertools.zip_longest(a.components,
                                           b.components):
        # If a component type does not exist in one rule
        # this rule has lower precedence
        if not comp_a:
            return B_HAS_PRECEDENCE
        if not comp_b:
            return A_HAS_PRECEDENCE
        # Higher precedence for lower component type
        if comp_a.component_type < comp_b.component_type:
            return A_HAS_PRECEDENCE
        if comp_a.component_type > comp_b.component_type:
            return B_HAS_PRECEDENCE
        # component types are equal -> type specific comparison
        if comp_a.component_type in (IP_DESTINATION, IP_SOURCE):
            # assuming comp_a.op_value, comp_b.op_value of
            # type ipaddress.IPv4Network
            if comp_a.op_value.overlaps(comp_b.op_value):
                # longest prefixlen has precedence
                if comp_a.op_value.prefixlen > \
                        comp_b.op_value.prefixlen:
                    return A_HAS_PRECEDENCE
                if comp_a.op_value.prefixlen < \
                        comp_b.op_value.prefixlen:
                    return B_HAS_PRECEDENCE
                # components equal -> continue with next component
            elif comp_a.op_value > comp_b.op_value:
                return B_HAS_PRECEDENCE
            elif comp_a.op_value < comp_b.op_value:
                return A_HAS_PRECEDENCE
        else:
            # assuming comp_a.op_value, comp_b.op_value of type
            # bytearray
            if len(comp_a.op_value) == len(comp_b.op_value):
                if comp_a.op_value > comp_b.op_value:
                    return B_HAS_PRECEDENCE
                if comp_a.op_value < comp_b.op_value:
                    return A_HAS_PRECEDENCE
                # components equal -> continue with next component
            else:
                common = min(len(comp_a.op_value),
                             len(comp_b.op_value))
                if comp_a.op_value[:common] > \
                   comp_b.op_value[:common]:
                    return B_HAS_PRECEDENCE
                elif comp_a.op_value[:common] < \
                        comp_b.op_value[:common]:
                    return A_HAS_PRECEDENCE
                # the first common bytes match
                elif len(comp_a.op_value) > len(comp_b.op_value):
                    return A_HAS_PRECEDENCE
                else:
                    return B_HAS_PRECEDENCE
    return EQUAL

<CODE ENDS>
```

[¶](#section-appendix.a-1){.pilcrow}
:::
:::
:::

::: {#rfc5575differences}
::: {#section-appendix.b .section}
## [Appendix B.](#section-appendix.b){.section-number .selfRef} [Comparison with RFC 5575](#name-comparison-with-rfc-5575){.section-name .selfRef} {#name-comparison-with-rfc-5575}

This document includes numerous editorial changes to
\[[RFC5575](#RFC5575){.xref}\]. It also completely incorporates the
redirect action clarification document \[[RFC7674](#RFC7674){.xref}\].
It is recommended to read the entire document. The authors, however,
want to point out the following technical changes to
\[[RFC5575](#RFC5575){.xref}\]:[¶](#section-appendix.b-1){.pilcrow}

-   [[Section 1](#intro){.xref} introduces the Flow Specification NLRI.
    In \[[RFC5575](#RFC5575){.xref}\], BGP treats this NLRI as an opaque
    key to an entry in its databases. This specification has removed all
    references to an opaque key property. BGP implementations are able
    to understand the NLRI
    encoding.[¶](#section-appendix.b-2.1){.pilcrow}]{#section-appendix.b-2.1}
-   [[Section 4.2.1.1](#numeric_operator){.xref} defines a numeric
    operator and comparison bit combinations. In
    \[[RFC5575](#RFC5575){.xref}\], the meaning of those bit combination
    was not explicitly defined and left open to the
    reader.[¶](#section-appendix.b-2.2){.pilcrow}]{#section-appendix.b-2.2}
-   [Sections [4.2.2.3](#type_3){.xref} - [4.2.2.8](#type_8){.xref},
    [4.2.2.10](#type_10){.xref}, and [4.2.2.11](#type_11){.xref} make
    use of the above numeric operator. The allowed length of the
    comparison value was not consistently defined in
    \[[RFC5575](#RFC5575){.xref}\].[¶](#section-appendix.b-2.3){.pilcrow}]{#section-appendix.b-2.3}
-   [[Section 7](#traffic_filtering_actions){.xref} defines all Traffic
    Filtering Action Extended Communities as transitive Extended
    Communities. \[[RFC5575](#RFC5575){.xref}\] defined the traffic-rate
    action to be non-transitive and did not define the transitivity of
    the other Traffic Filtering Action communities at
    all.[¶](#section-appendix.b-2.4){.pilcrow}]{#section-appendix.b-2.4}
-   [[Section 7.2](#traffic_rate_in_packets){.xref} introduces a new
    Traffic Filtering Action (traffic-rate-packets). This action did not
    exist in
    \[[RFC5575](#RFC5575){.xref}\].[¶](#section-appendix.b-2.5){.pilcrow}]{#section-appendix.b-2.5}
-   [[Section 7.4](#rt_redirect_action_subtype){.xref} contains the same
    redirect actions already defined in \[[RFC5575](#RFC5575){.xref}\],
    however, these actions have been renamed to \"rt-redirect\" to make
    it clearer that the redirection is based on route-target. This
    section also completely incorporates the
    \[[RFC7674](#RFC7674){.xref}\] clarifications of the Flowspec
    Redirect Extended
    Community.[¶](#section-appendix.b-2.6){.pilcrow}]{#section-appendix.b-2.6}
-   [[Section 7.7](#rules_action_interference){.xref} contains general
    considerations on interfering traffic actions. [Section
    7.3](#traffic_action_subtype){.xref} also cross-references [Section
    7.7](#rules_action_interference){.xref}.
    \[[RFC5575](#RFC5575){.xref}\] did not mention
    this.[¶](#section-appendix.b-2.7){.pilcrow}]{#section-appendix.b-2.7}
-   [[Section 10](#errorhandling){.xref} contains new error
    handling.[¶](#section-appendix.b-2.8){.pilcrow}]{#section-appendix.b-2.8}
:::
:::

::: {#section-appendix.c .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors would like to thank [Yakov Rekhter]{.contact-name}, [Dennis
Ferguson]{.contact-name}, [Chris Morrow]{.contact-name}, [Charlie
Kaufman]{.contact-name}, and [David Smith]{.contact-name} for their
comments on the original \[[RFC5575](#RFC5575){.xref}\]. [Chaitanya
Kodeboyina]{.contact-name} helped design the flow validation procedure,
and [Steven Lin]{.contact-name} and [Jim Washburn]{.contact-name} ironed
out all the details necessary to produce a working implementation in the
original
\[[RFC5575](#RFC5575){.xref}\].[¶](#section-appendix.c-1){.pilcrow}

A packet rate Traffic Filtering Action was also described in a Flow
Specification extension draft and the authors would like to thank
[Wesley Eddy]{.contact-name}, [Justin Dailey]{.contact-name}, and
[Gilbert Clark]{.contact-name} for their
work.[¶](#section-appendix.c-2){.pilcrow}

Additionally, the authors would like to thank [Alexander
Mayrhofer]{.contact-name}, [Nicolas Fevrier]{.contact-name}, [Job
Snijders]{.contact-name}, [Jeffrey Haas]{.contact-name}, and [Adam
Chappell]{.contact-name} for their comments and
review.[¶](#section-appendix.c-3){.pilcrow}
:::

::: {#section-appendix.d .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

[Barry Greene]{.contact-name}, [Pedro Marques]{.contact-name}, [Jared
Mauch]{.contact-name}, and [Nischal Sheth were]{.contact-name} authors
on \[[RFC5575](#RFC5575){.xref}\] and, therefore, are contributing
authors on this document.[¶](#section-appendix.d-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#section-appendix.e .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Christoph Loibl]{.fn .nameRole}
:::

::: {.left dir="auto"}
[next layer Telekom GmbH]{.org}
:::

::: {.left dir="auto"}
[Mariahilfer Guertel 37/7]{.street-address}
:::

::: {.left dir="auto"}
[1150]{.postal-code} [Vienna]{.locality}
:::

::: {.left dir="auto"}
[Austria]{.country-name}
:::

::: tel
Phone: [+43 664 1176414](tel:+43%20664%201176414){.tel}
:::

::: email
Email: <cl@tix.at>
:::

::: {.left dir="auto"}
[Susan Hares]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei]{.org}
:::

::: {.left dir="auto"}
[7453 Hickory Hill]{.street-address}
:::

::: {.left dir="auto"}
[Saline]{.locality}, [MI]{.region} [48176]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <shares@ndzh.com>
:::

::: {.left dir="auto"}
[Robert Raszuk]{.fn .nameRole}
:::

::: {.left dir="auto"}
[NTT Network Innovations]{.org}
:::

::: {.left dir="auto"}
[940 Stewart Dr]{.street-address}
:::

::: {.left dir="auto"}
[Sunnyvale]{.locality}, [CA]{.region} [94085]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <robert@raszuk.net>
:::

::: {.left dir="auto"}
[Danny McPherson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Verisign]{.org}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <dmcpherson@verisign.com>
:::

::: {.left dir="auto"}
[Martin Bacher]{.fn .nameRole}
:::

::: {.left dir="auto"}
[T-Mobile Austria]{.org}
:::

::: {.left dir="auto"}
[Rennweg 97-99]{.street-address}
:::

::: {.left dir="auto"}
[1030]{.postal-code} [Vienna]{.locality}
:::

::: {.left dir="auto"}
[Austria]{.country-name}
:::

::: email
Email: <mb.ietf@gmail.com>
:::
:::
:::
