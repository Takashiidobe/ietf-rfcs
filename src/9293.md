  RFC 9293   TCP               August 2022
  ---------- ----------------- -------------
  Eddy       Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

STD:
:   7

RFC:
:   [9293](https://www.rfc-editor.org/rfc/rfc9293){.eref}

Obsoletes:
:   [793](https://www.rfc-editor.org/rfc/rfc793){.eref},
    [879](https://www.rfc-editor.org/rfc/rfc879){.eref},
    [2873](https://www.rfc-editor.org/rfc/rfc2873){.eref},
    [6093](https://www.rfc-editor.org/rfc/rfc6093){.eref},
    [6429](https://www.rfc-editor.org/rfc/rfc6429){.eref},
    [6528](https://www.rfc-editor.org/rfc/rfc6528){.eref},
    [6691](https://www.rfc-editor.org/rfc/rfc6691){.eref}

Updates:
:   [1011](https://www.rfc-editor.org/rfc/rfc1011){.eref},
    [1122](https://www.rfc-editor.org/rfc/rfc1122){.eref},
    [5961](https://www.rfc-editor.org/rfc/rfc5961){.eref}

Category:
:   Standards Track

Published:
:   August 2022

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    W. Eddy, [Ed.]{.editor}
    :::

    ::: org
    MTI Systems
    :::
    :::
:::

# RFC 9293 {#rfcnum}

# Transmission Control Protocol (TCP) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies the Transmission Control Protocol (TCP). TCP is
an important transport-layer protocol in the Internet protocol stack,
and it has continuously evolved over decades of use and growth of the
Internet. Over this time, a number of changes have been made to TCP as
it was specified in RFC 793, though these have only been documented in a
piecemeal fashion. This document collects and brings those changes
together with the protocol specification from RFC 793. This document
obsoletes RFC 793, as well as RFCs 879, 2873, 6093, 6429, 6528, and 6691
that updated parts of RFC 793. It updates RFCs 1011 and 1122, and it
should be considered as a replacement for the portions of those
documents dealing with TCP requirements. It also updates RFC 5961 by
adding a small clarification in reset handling while in the SYN-RECEIVED
state. The TCP header control bits from RFC 793 have also been updated
based on RFC 3168.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9293>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}

This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November 10,
2008. The person(s) controlling the copyright in some of this material
may not have granted the IETF Trust the right to allow modifications of
such material outside the IETF Standards Process. Without obtaining an
adequate license from the person(s) controlling the copyright in such
materials, this document may not be modified outside the IETF Standards
Process, and derivative works of it may not be created outside the IETF
Standards Process, except to format it for publication as an RFC or to
translate it into languages other than
English.[¶](#section-boilerplate.2-3){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Purpose and
    Scope](#name-purpose-and-scope){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Key TCP
        Concepts](#name-key-tcp-concepts){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Functional
    Specification](#name-functional-specification){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Header
        Format](#name-header-format){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Specific Option
        Definitions](#name-specific-option-definitions){.xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [Other Common
            Options](#name-other-common-options){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.xref}.  [Experimental TCP
            Options](#name-experimental-tcp-options){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [TCP Terminology
        Overview](#name-tcp-terminology-overview){.xref}

        -   ::: {#section-toc.1-1.3.2.3.2.1}
            [3.3.1](#section-3.3.1){.xref}.  [Key Connection State
            Variables](#name-key-connection-state-variab){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.3.2.2}
            [3.3.2](#section-3.3.2){.xref}.  [State Machine
            Overview](#name-state-machine-overview){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Sequence
        Numbers](#name-sequence-numbers){.xref}

        -   ::: {#section-toc.1-1.3.2.4.2.1}
            [3.4.1](#section-3.4.1){.xref}.  [Initial Sequence Number
            Selection](#name-initial-sequence-number-sel){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.4.2.2}
            [3.4.2](#section-3.4.2){.xref}.  [Knowing When to Keep
            Quiet](#name-knowing-when-to-keep-quiet){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.4.2.3}
            [3.4.3](#section-3.4.3){.xref}.  [The TCP Quiet Time
            Concept](#name-the-tcp-quiet-time-concept){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Establishing a
        Connection](#name-establishing-a-connection){.xref}

        -   ::: {#section-toc.1-1.3.2.5.2.1}
            [3.5.1](#section-3.5.1){.xref}.  [Half-Open Connections and
            Other Anomalies](#name-half-open-connections-and-o){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.5.2.2}
            [3.5.2](#section-3.5.2){.xref}.  [Reset
            Generation](#name-reset-generation){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.5.2.3}
            [3.5.3](#section-3.5.3){.xref}.  [Reset
            Processing](#name-reset-processing){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [Closing a
        Connection](#name-closing-a-connection){.xref}

        -   ::: {#section-toc.1-1.3.2.6.2.1}
            [3.6.1](#section-3.6.1){.xref}.  [Half-Closed
            Connections](#name-half-closed-connections){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Segmentation](#name-segmentation){.xref}

        -   ::: {#section-toc.1-1.3.2.7.2.1}
            [3.7.1](#section-3.7.1){.xref}.  [Maximum Segment Size
            Option](#name-maximum-segment-size-option){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.7.2.2}
            [3.7.2](#section-3.7.2){.xref}.  [Path MTU
            Discovery](#name-path-mtu-discovery){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.7.2.3}
            [3.7.3](#section-3.7.3){.xref}.  [Interfaces with Variable
            MTU Values](#name-interfaces-with-variable-mt){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.7.2.4}
            [3.7.4](#section-3.7.4){.xref}.  [Nagle
            Algorithm](#name-nagle-algorithm){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.7.2.5}
            [3.7.5](#section-3.7.5){.xref}.  [IPv6
            Jumbograms](#name-ipv6-jumbograms){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.8}
        [3.8](#section-3.8){.xref}.  [Data
        Communication](#name-data-communication){.xref}

        -   ::: {#section-toc.1-1.3.2.8.2.1}
            [3.8.1](#section-3.8.1){.xref}.  [Retransmission
            Timeout](#name-retransmission-timeout){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.2}
            [3.8.2](#section-3.8.2){.xref}.  [TCP Congestion
            Control](#name-tcp-congestion-control){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.3}
            [3.8.3](#section-3.8.3){.xref}.  [TCP Connection
            Failures](#name-tcp-connection-failures){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.4}
            [3.8.4](#section-3.8.4){.xref}.  [TCP
            Keep-Alives](#name-tcp-keep-alives){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.5}
            [3.8.5](#section-3.8.5){.xref}.  [The Communication of
            Urgent
            Information](#name-the-communication-of-urgent){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.8.2.6}
            [3.8.6](#section-3.8.6){.xref}.  [Managing the
            Window](#name-managing-the-window){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.9}
        [3.9](#section-3.9){.xref}.  [Interfaces](#name-interfaces){.xref}

        -   ::: {#section-toc.1-1.3.2.9.2.1}
            [3.9.1](#section-3.9.1){.xref}.  [User/TCP
            Interface](#name-user-tcp-interface){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.9.2.2}
            [3.9.2](#section-3.9.2){.xref}.  [TCP/Lower-Level
            Interface](#name-tcp-lower-level-interface){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.10}
        [3.10](#section-3.10){.xref}. [Event
        Processing](#name-event-processing){.xref}

        -   ::: {#section-toc.1-1.3.2.10.2.1}
            [3.10.1](#section-3.10.1){.xref}.  [OPEN
            Call](#name-open-call){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.2}
            [3.10.2](#section-3.10.2){.xref}.  [SEND
            Call](#name-send-call){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.3}
            [3.10.3](#section-3.10.3){.xref}.  [RECEIVE
            Call](#name-receive-call){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.4}
            [3.10.4](#section-3.10.4){.xref}.  [CLOSE
            Call](#name-close-call){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.5}
            [3.10.5](#section-3.10.5){.xref}.  [ABORT
            Call](#name-abort-call){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.6}
            [3.10.6](#section-3.10.6){.xref}.  [STATUS
            Call](#name-status-call){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.7}
            [3.10.7](#section-3.10.7){.xref}.  [SEGMENT
            ARRIVES](#name-segment-arrives){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.10.2.8}
            [3.10.8](#section-3.10.8){.xref}.  [Timeouts](#name-timeouts){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Glossary](#name-glossary){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Changes from RFC
    793](#name-changes-from-rfc-793){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security and Privacy
    Considerations](#name-security-and-privacy-consid){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [Appendix A](#appendix-A){.xref}.  [Other Implementation
    Notes](#name-other-implementation-notes){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [A.1](#appendix-A.1){.xref}.  [IP Security Compartment and
        Precedence](#name-ip-security-compartment-and){.xref}

        -   ::: {#section-toc.1-1.9.2.1.2.1}
            [A.1.1](#appendix-A.1.1){.xref}.  [Precedence](#name-precedence){.xref}
            :::

        -   ::: {#section-toc.1-1.9.2.1.2.2}
            [A.1.2](#appendix-A.1.2){.xref}.  [MLS
            Systems](#name-mls-systems){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [A.2](#appendix-A.2){.xref}.  [Sequence Number
        Validation](#name-sequence-number-validation){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [A.3](#appendix-A.3){.xref}.  [Nagle
        Modification](#name-nagle-modification){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.4}
        [A.4](#appendix-A.4){.xref}.  [Low Watermark
        Settings](#name-low-watermark-settings){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix B](#appendix-B){.xref}.  [TCP Requirement
    Summary](#name-tcp-requirement-summary){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-C){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [](#appendix-D){.xref}[Author\'s
    Address](#name-authors-address){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Purpose and Scope](#name-purpose-and-scope){.section-name .selfRef} {#name-purpose-and-scope}

In 1981, [RFC 793](#RFC0793){.xref} \[[16](#RFC0793){.xref}\] was
released, documenting the Transmission Control Protocol (TCP) and
replacing earlier published specifications for
TCP.[¶](#section-1-1){.pilcrow}

Since then, TCP has been widely implemented, and it has been used as a
transport protocol for numerous applications on the
Internet.[¶](#section-1-2){.pilcrow}

For several decades, RFC 793 plus a number of other documents have
combined to serve as the core specification for TCP
\[[49](#RFC7414){.xref}\]. Over time, a number of errata have been filed
against RFC 793. There have also been deficiencies found and resolved in
security, performance, and many other aspects. The number of
enhancements has grown over time across many separate documents. These
were never accumulated together into a comprehensive update to the base
specification.[¶](#section-1-3){.pilcrow}

The purpose of this document is to bring together all of the IETF
Standards Track changes and other clarifications that have been made to
the base TCP functional specification (RFC 793) and to unify them into
an updated version of the specification.[¶](#section-1-4){.pilcrow}

Some companion documents are referenced for important algorithms that
are used by TCP (e.g., for congestion control) but have not been
completely included in this document. This is a conscious choice, as
this base specification can be used with multiple additional algorithms
that are developed and incorporated separately. This document focuses on
the common basis that all TCP implementations must support in order to
interoperate. Since some additional TCP features have become quite
complicated themselves (e.g., advanced loss recovery and congestion
control), future companion documents may attempt to similarly bring
these together.[¶](#section-1-5){.pilcrow}

In addition to the protocol specification that describes the TCP segment
format, generation, and processing rules that are to be implemented in
code, RFC 793 and other updates also contain informative and descriptive
text for readers to understand aspects of the protocol design and
operation. This document does not attempt to alter or update this
informative text and is focused only on updating the normative protocol
specification. This document preserves references to the documentation
containing the important explanations and rationale, where
appropriate.[¶](#section-1-6){.pilcrow}

This document is intended to be useful both in checking existing TCP
implementations for conformance purposes, as well as in writing new
implementations.[¶](#section-1-7){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

RFC 793 contains a discussion of the TCP design goals and provides
examples of its operation, including examples of connection
establishment, connection termination, and packet retransmission to
repair losses.[¶](#section-2-1){.pilcrow}

This document describes the basic functionality expected in modern TCP
implementations and replaces the protocol specification in RFC 793. It
does not replicate or attempt to update the introduction and philosophy
content in Sections 1 and 2 of RFC 793. Other documents are referenced
to provide explanations of the theory of operation, rationale, and
detailed discussion of design decisions. This document only focuses on
the normative behavior of the protocol.[¶](#section-2-2){.pilcrow}

The \"TCP Roadmap\" \[[49](#RFC7414){.xref}\] provides a more extensive
guide to the RFCs that define TCP and describe various important
algorithms. The TCP Roadmap contains sections on strongly encouraged
enhancements that improve performance and other aspects of TCP beyond
the basic operation specified in this document. As one example,
implementing congestion control (e.g., \[[8](#RFC5681){.xref}\]) is a
TCP requirement, but it is a complex topic on its own and not described
in detail in this document, as there are many options and possibilities
that do not impact basic interoperability. Similarly, most TCP
implementations today include the high-performance extensions in
\[[47](#RFC7323){.xref}\], but these are not strictly required or
discussed in this document. Multipath considerations for TCP are also
specified separately in
\[[59](#RFC8684){.xref}\].[¶](#section-2-3){.pilcrow}

A list of changes from RFC 793 is contained in [Section
5](#changes){.xref}.[¶](#section-2-4){.pilcrow}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[3](#RFC2119){.xref}\]
\[[12](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.1-1){.pilcrow}

Each use of RFC 2119 keywords in the document is individually labeled
and referenced in [Appendix B](#reqs){.xref}, which summarizes
implementation requirements.[¶](#section-2.1-2){.pilcrow}

Sentences using \"[MUST]{.bcp14}\" are labeled as \"MUST-X\" with X
being a numeric identifier enabling the requirement to be located easily
when referenced from [Appendix
B](#reqs){.xref}.[¶](#section-2.1-3){.pilcrow}

Similarly, sentences using \"[SHOULD]{.bcp14}\" are labeled with
\"SHLD-X\", \"[MAY]{.bcp14}\" with \"MAY-X\", and
\"[RECOMMENDED]{.bcp14}\" with \"REC-X\".[¶](#section-2.1-4){.pilcrow}

For the purposes of this labeling, \"[SHOULD NOT]{.bcp14}\" and \"[MUST
NOT]{.bcp14}\" are labeled the same as \"[SHOULD]{.bcp14}\" and
\"[MUST]{.bcp14}\" instances.[¶](#section-2.1-5){.pilcrow}
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Key TCP Concepts](#name-key-tcp-concepts){.section-name .selfRef} {#name-key-tcp-concepts}

TCP provides a reliable, in-order, byte-stream service to
applications.[¶](#section-2.2-1){.pilcrow}

The application byte-stream is conveyed over the network via TCP
segments, with each TCP segment sent as an Internet Protocol (IP)
datagram.[¶](#section-2.2-2){.pilcrow}

TCP reliability consists of detecting packet losses (via sequence
numbers) and errors (via per-segment checksums), as well as correction
via retransmission.[¶](#section-2.2-3){.pilcrow}

TCP supports unicast delivery of data. There are anycast applications
that can successfully use TCP without modifications, though there is
some risk of instability due to changes of lower-layer forwarding
behavior \[[46](#RFC7094){.xref}\].[¶](#section-2.2-4){.pilcrow}

TCP is connection oriented, though it does not inherently include a
liveness detection capability.[¶](#section-2.2-5){.pilcrow}

Data flow is supported bidirectionally over TCP connections, though
applications are free to send data only unidirectionally, if they so
choose.[¶](#section-2.2-6){.pilcrow}

TCP uses port numbers to identify application services and to multiplex
distinct flows between hosts.[¶](#section-2.2-7){.pilcrow}

A more detailed description of TCP features compared to other transport
protocols can be found in [Section
3.1](https://www.rfc-editor.org/rfc/rfc8095#section-3.1){.relref} of
\[[52](#RFC8095){.xref}\]. Further description of the motivations for
developing TCP and its role in the Internet protocol stack can be found
in [Section 2](https://www.rfc-editor.org/rfc/rfc793#section-2){.relref}
of \[[16](#RFC0793){.xref}\] and earlier versions of the TCP
specification.[¶](#section-2.2-8){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Functional Specification](#name-functional-specification){.section-name .selfRef} {#name-functional-specification}

::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Header Format](#name-header-format){.section-name .selfRef} {#name-header-format}

TCP segments are sent as internet datagrams. The Internet Protocol (IP)
header carries several information fields, including the source and
destination host addresses \[[1](#RFC0791){.xref}\]
\[[13](#RFC8200){.xref}\]. A TCP header follows the IP headers,
supplying information specific to TCP. This division allows for the
existence of host-level protocols other than TCP. In the early
development of the Internet suite of protocols, the IP header fields had
been a part of TCP.[¶](#section-3.1-1){.pilcrow}

This document describes TCP, which uses TCP
headers.[¶](#section-3.1-2){.pilcrow}

A TCP header, followed by any user data in the segment, is formatted as
follows, using the style from
\[[66](#I-D.mcquistin-augmented-ascii-diagrams){.xref}\]:[¶](#section-3.1-3){.pilcrow}

[]{#name-tcp-header-format}

::: {#header_format}
::: {#section-3.1-4.1 .alignLeft .art-text .artwork}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          Source Port          |       Destination Port        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Sequence Number                        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                    Acknowledgment Number                      |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Data |       |C|E|U|A|P|R|S|F|                               |
       | Offset| Rsrvd |W|C|R|C|S|S|Y|I|            Window             |
       |       |       |R|E|G|K|H|T|N|N|                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Checksum            |         Urgent Pointer        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           [Options]                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               :
       :                             Data                              :
       :                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

              Note that one tick mark represents one bit position.
:::

[Figure 1](#figure-1){.selfRef}: [TCP Header
Format](#name-tcp-header-format){.selfRef}
:::

where:[¶](#section-3.1-5){.pilcrow}

[]{.break}

Source Port:

:   16 bits[¶](#section-3.1-6.2.1){.pilcrow}

    The source port number.[¶](#section-3.1-6.2.2){.pilcrow}

:   

Destination Port:

:   16 bits[¶](#section-3.1-6.4.1){.pilcrow}

    The destination port number.[¶](#section-3.1-6.4.2){.pilcrow}

:   

Sequence Number:

:   32 bits[¶](#section-3.1-6.6.1){.pilcrow}

    The sequence number of the first data octet in this segment (except
    when the SYN flag is set). If SYN is set, the sequence number is the
    initial sequence number (ISN) and the first data octet is
    ISN+1.[¶](#section-3.1-6.6.2){.pilcrow}

:   

Acknowledgment Number:

:   32 bits[¶](#section-3.1-6.8.1){.pilcrow}

    If the ACK control bit is set, this field contains the value of the
    next sequence number the sender of the segment is expecting to
    receive. Once a connection is established, this is always
    sent.[¶](#section-3.1-6.8.2){.pilcrow}

:   

Data Offset (DOffset):

:   4 bits[¶](#section-3.1-6.10.1){.pilcrow}

    The number of 32-bit words in the TCP header. This indicates where
    the data begins. The TCP header (even one including options) is an
    integer multiple of 32 bits long.[¶](#section-3.1-6.10.2){.pilcrow}

:   

Reserved (Rsrvd):

:   4 bits[¶](#section-3.1-6.12.1){.pilcrow}

    A set of control bits reserved for future use. Must be zero in
    generated segments and must be ignored in received segments if the
    corresponding future features are not implemented by the sending or
    receiving host.[¶](#section-3.1-6.12.2){.pilcrow}

:   

Control bits:

:   The control bits are also known as \"flags\". Assignment is managed
    by IANA from the \"TCP Header Flags\" registry
    \[[62](#TCP-parameters-registry){.xref}\]. The currently assigned
    control bits are CWR, ECE, URG, ACK, PSH, RST, SYN, and
    FIN.[¶](#section-3.1-6.14.1){.pilcrow}

    []{.break}

    CWR:

    :   1 bit[¶](#section-3.1-6.14.2.2.1){.pilcrow}

        Congestion Window Reduced (see
        \[[6](#RFC3168){.xref}\]).[¶](#section-3.1-6.14.2.2.2){.pilcrow}

    :   

    ECE:

    :   1 bit[¶](#section-3.1-6.14.2.4.1){.pilcrow}

        ECN-Echo (see
        \[[6](#RFC3168){.xref}\]).[¶](#section-3.1-6.14.2.4.2){.pilcrow}

    :   

    URG:

    :   1 bit[¶](#section-3.1-6.14.2.6.1){.pilcrow}

        Urgent pointer field is
        significant.[¶](#section-3.1-6.14.2.6.2){.pilcrow}

    :   

    ACK:

    :   1 bit[¶](#section-3.1-6.14.2.8.1){.pilcrow}

        Acknowledgment field is
        significant.[¶](#section-3.1-6.14.2.8.2){.pilcrow}

    :   

    PSH:

    :   1 bit[¶](#section-3.1-6.14.2.10.1){.pilcrow}

        Push function (see the Send Call description in [Section
        3.9.1](#user-api){.xref}).[¶](#section-3.1-6.14.2.10.2){.pilcrow}

    :   

    RST:

    :   1 bit[¶](#section-3.1-6.14.2.12.1){.pilcrow}

        Reset the connection.[¶](#section-3.1-6.14.2.12.2){.pilcrow}

    :   

    SYN:

    :   1 bit[¶](#section-3.1-6.14.2.14.1){.pilcrow}

        Synchronize sequence
        numbers.[¶](#section-3.1-6.14.2.14.2){.pilcrow}

    :   

    FIN:

    :   1 bit[¶](#section-3.1-6.14.2.16.1){.pilcrow}

        No more data from sender.[¶](#section-3.1-6.14.2.16.2){.pilcrow}

    :   

:   

Window:

:   16 bits[¶](#section-3.1-6.16.1){.pilcrow}

    The number of data octets beginning with the one indicated in the
    acknowledgment field that the sender of this segment is willing to
    accept. The value is shifted when the window scaling extension is
    used \[[47](#RFC7323){.xref}\].[¶](#section-3.1-6.16.2){.pilcrow}

    The window size [MUST]{.bcp14} be treated as an unsigned number, or
    else large window sizes will appear like negative windows and TCP
    will not work (MUST-1). It is [RECOMMENDED]{.bcp14} that
    implementations will reserve 32-bit fields for the send and receive
    window sizes in the connection record and do all window computations
    with 32 bits (REC-1).[¶](#section-3.1-6.16.3){.pilcrow}

:   

Checksum:

:   16 bits[¶](#section-3.1-6.18.1){.pilcrow}

    The checksum field is the 16-bit ones\' complement of the ones\'
    complement sum of all 16-bit words in the header and text. The
    checksum computation needs to ensure the 16-bit alignment of the
    data being summed. If a segment contains an odd number of header and
    text octets, alignment can be achieved by padding the last octet
    with zeros on its right to form a 16-bit word for checksum purposes.
    The pad is not transmitted as part of the segment. While computing
    the checksum, the checksum field itself is replaced with
    zeros.[¶](#section-3.1-6.18.2){.pilcrow}

    The checksum also covers a pseudo-header ([Figure
    2](#v4pseudo){.xref}) conceptually prefixed to the TCP header. The
    pseudo-header is 96 bits for IPv4 and 320 bits for IPv6. Including
    the pseudo-header in the checksum gives the TCP connection
    protection against misrouted segments. This information is carried
    in IP headers and is transferred across the TCP/network interface in
    the arguments or results of calls by the TCP implementation on the
    IP layer.[¶](#section-3.1-6.18.3){.pilcrow}

    []{#name-ipv4-pseudo-header}

    ::: {#v4pseudo}
    ::: {#section-3.1-6.18.4.1 .alignLeft .art-text .artwork}
                        +--------+--------+--------+--------+
                        |           Source Address          |
                        +--------+--------+--------+--------+
                        |         Destination Address       |
                        +--------+--------+--------+--------+
                        |  zero  |  PTCL  |    TCP Length   |
                        +--------+--------+--------+--------+
    :::

    [Figure 2](#figure-2){.selfRef}: [IPv4
    Pseudo-header](#name-ipv4-pseudo-header){.selfRef}
    :::

    []{.break}

    Pseudo-header components for IPv4:
    :   []{.break}

        Source Address:
        :   the IPv4 source address in network byte
            order[¶](#section-3.1-6.18.5.2.1.2){.pilcrow}
        :   

        Destination Address:
        :   the IPv4 destination address in network byte
            order[¶](#section-3.1-6.18.5.2.1.4){.pilcrow}
        :   

        zero:
        :   bits set to zero[¶](#section-3.1-6.18.5.2.1.6){.pilcrow}
        :   

        PTCL:
        :   the protocol number from the IP
            header[¶](#section-3.1-6.18.5.2.1.8){.pilcrow}
        :   

        TCP Length:
        :   the TCP header length plus the data length in octets (this
            is not an explicitly transmitted quantity but is computed),
            and it does not count the 12 octets of the
            pseudo-header.[¶](#section-3.1-6.18.5.2.1.10){.pilcrow}
        :   
    :   

    For IPv6, the pseudo-header is defined in Section
    [8.1](https://www.rfc-editor.org/rfc/rfc8200#section-8.1){.relref}
    of RFC 8200 \[[13](#RFC8200){.xref}\] and contains the IPv6 Source
    Address and Destination Address, an Upper-Layer Packet Length (a
    32-bit value otherwise equivalent to TCP Length in the IPv4
    pseudo-header), three bytes of zero padding, and a Next Header
    value, which differs from the IPv6 header value if there are
    extension headers present between IPv6 and
    TCP.[¶](#section-3.1-6.18.6){.pilcrow}

    The TCP checksum is never optional. The sender [MUST]{.bcp14}
    generate it (MUST-2) and the receiver [MUST]{.bcp14} check it
    (MUST-3).[¶](#section-3.1-6.18.7){.pilcrow}

:   

Urgent Pointer:

:   16 bits[¶](#section-3.1-6.20.1){.pilcrow}

    This field communicates the current value of the urgent pointer as a
    positive offset from the sequence number in this segment. The urgent
    pointer points to the sequence number of the octet following the
    urgent data. This field is only to be interpreted in segments with
    the URG control bit set.[¶](#section-3.1-6.20.2){.pilcrow}

:   

Options:

:   \[TCP Option\]; size(Options) == (DOffset-5)\*32; present only when
    DOffset > 5. Note that this size expression also includes any
    padding trailing the actual options
    present.[¶](#section-3.1-6.22.1){.pilcrow}

    Options may occupy space at the end of the TCP header and are a
    multiple of 8 bits in length. All options are included in the
    checksum. An option may begin on any octet boundary. There are two
    cases for the format of an option:[¶](#section-3.1-6.22.2){.pilcrow}

    []{.break}

    Case 1:
    :   A single octet of
        option-kind.[¶](#section-3.1-6.22.3.2){.pilcrow}
    :   

    Case 2:
    :   An octet of option-kind (Kind), an octet of option-length, and
        the actual option-data
        octets.[¶](#section-3.1-6.22.3.4){.pilcrow}
    :   

    The option-length counts the two octets of option-kind and
    option-length as well as the option-data
    octets.[¶](#section-3.1-6.22.4){.pilcrow}

    Note that the list of options may be shorter than the Data Offset
    field might imply. The content of the header beyond the End of
    Option List Option [MUST]{.bcp14} be header padding of zeros
    (MUST-69).[¶](#section-3.1-6.22.5){.pilcrow}

    The list of all currently defined options is managed by IANA
    \[[62](#TCP-parameters-registry){.xref}\], and each option is
    defined in other RFCs, as indicated there. That set includes
    experimental options that can be extended to support multiple
    concurrent usages
    \[[45](#RFC6994){.xref}\].[¶](#section-3.1-6.22.6){.pilcrow}

    A given TCP implementation can support any currently defined
    options, but the following options [MUST]{.bcp14} be supported
    (MUST-4 \-- note Maximum Segment Size Option support is also part of
    MUST-14 in [Section
    3.7.1](#mss){.xref}):[¶](#section-3.1-6.22.7){.pilcrow}

    []{#name-mandatory-option-set}

      Kind   Length   Meaning
      ------ -------- ----------------------------
      0      \-       End of Option List Option.
      1      \-       No-Operation.
      2      4        Maximum Segment Size.

      : [Table 1](#table-1){.selfRef}: [Mandatory Option
      Set](#name-mandatory-option-set){.selfRef}

    These options are specified in detail in [Section
    3.2](#Option-Definitions){.xref}.[¶](#section-3.1-6.22.9){.pilcrow}

    A TCP implementation [MUST]{.bcp14} be able to receive a TCP Option
    in any segment (MUST-5).[¶](#section-3.1-6.22.10){.pilcrow}

    A TCP implementation [MUST]{.bcp14} (MUST-6) ignore without error
    any TCP Option it does not implement, assuming that the option has a
    length field. All TCP Options except End of Option List Option (EOL)
    and No-Operation (NOP) [MUST]{.bcp14} have length fields, including
    all future options (MUST-68). TCP implementations [MUST]{.bcp14} be
    prepared to handle an illegal option length (e.g., zero); a
    suggested procedure is to reset the connection and log the error
    cause (MUST-7).[¶](#section-3.1-6.22.11){.pilcrow}

    Note: There is ongoing work to extend the space available for TCP
    Options, such as
    \[[65](#I-D.ietf-tcpm-tcp-edo){.xref}\].[¶](#section-3.1-6.22.12){.pilcrow}

:   

Data:

:   variable length[¶](#section-3.1-6.24.1){.pilcrow}

    User data carried by the TCP
    segment.[¶](#section-3.1-6.24.2){.pilcrow}

:   
:::

::: {#Option-Definitions}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Specific Option Definitions](#name-specific-option-definitions){.section-name .selfRef} {#name-specific-option-definitions}

A TCP Option, in the mandatory option set, is one of an End of Option
List Option, a No-Operation Option, or a Maximum Segment Size
Option.[¶](#section-3.2-1){.pilcrow}

An End of Option List Option is formatted as
follows:[¶](#section-3.2-2){.pilcrow}

::: {#section-3.2-3 .alignLeft .art-text .artwork}
        0
        0 1 2 3 4 5 6 7
       +-+-+-+-+-+-+-+-+
       |       0       |
       +-+-+-+-+-+-+-+-+

[¶](#section-3.2-3){.pilcrow}
:::

where:[¶](#section-3.2-4){.pilcrow}

[]{.break}

Kind:

:   1 byte; Kind == 0.[¶](#section-3.2-5.2.1){.pilcrow}

    This option code indicates the end of the option list. This might
    not coincide with the end of the TCP header according to the Data
    Offset field. This is used at the end of all options, not the end of
    each option, and need only be used if the end of the options would
    not otherwise coincide with the end of the TCP
    header.[¶](#section-3.2-5.2.2){.pilcrow}

:   

A No-Operation Option is formatted as
follows:[¶](#section-3.2-6){.pilcrow}

::: {#section-3.2-7 .alignLeft .art-text .artwork}
        0
        0 1 2 3 4 5 6 7
       +-+-+-+-+-+-+-+-+
       |       1       |
       +-+-+-+-+-+-+-+-+

[¶](#section-3.2-7){.pilcrow}
:::

where:[¶](#section-3.2-8){.pilcrow}

[]{.break}

Kind:

:   1 byte; Kind == 1.[¶](#section-3.2-9.2.1){.pilcrow}

    This option code can be used between options, for example, to align
    the beginning of a subsequent option on a word boundary. There is no
    guarantee that senders will use this option, so receivers
    [MUST]{.bcp14} be prepared to process options even if they do not
    begin on a word boundary (MUST-64).[¶](#section-3.2-9.2.2){.pilcrow}

:   

A Maximum Segment Size Option is formatted as
follows:[¶](#section-3.2-10){.pilcrow}

::: {#section-3.2-11 .alignLeft .art-text .artwork}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |       2       |     Length    |   Maximum Segment Size (MSS)  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-3.2-11){.pilcrow}
:::

where:[¶](#section-3.2-12){.pilcrow}

[]{.break}

Kind:

:   1 byte; Kind == 2.[¶](#section-3.2-13.2.1){.pilcrow}

    If this option is present, then it communicates the maximum receive
    segment size at the TCP endpoint that sends this segment. This value
    is limited by the IP reassembly limit. This field may be sent in the
    initial connection request (i.e., in segments with the SYN control
    bit set) and [MUST NOT]{.bcp14} be sent in other segments (MUST-65).
    If this option is not used, any segment size is allowed. A more
    complete description of this option is provided in [Section
    3.7.1](#mss){.xref}.[¶](#section-3.2-13.2.2){.pilcrow}

:   

Length:

:   1 byte; Length == 4.[¶](#section-3.2-13.4.1){.pilcrow}

    Length of the option in bytes.[¶](#section-3.2-13.4.2){.pilcrow}

:   

Maximum Segment Size (MSS):

:   2 bytes.[¶](#section-3.2-13.6.1){.pilcrow}

    The maximum receive segment size at the TCP endpoint that sends this
    segment.[¶](#section-3.2-13.6.2){.pilcrow}

:   

::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Other Common Options](#name-other-common-options){.section-name .selfRef} {#name-other-common-options}

Additional RFCs define some other commonly used options that are
recommended to implement for high performance but are not necessary for
basic TCP interoperability. These are the TCP Selective Acknowledgment
(SACK) Option \[[22](#RFC2018){.xref}\] \[[26](#RFC2883){.xref}\], TCP
Timestamp (TS) Option \[[47](#RFC7323){.xref}\], and TCP Window Scale
(WS) Option \[[47](#RFC7323){.xref}\].[¶](#section-3.2.1-1){.pilcrow}
:::

::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [Experimental TCP Options](#name-experimental-tcp-options){.section-name .selfRef} {#name-experimental-tcp-options}

Experimental TCP Option values are defined in \[[30](#RFC4727){.xref}\],
and \[[45](#RFC6994){.xref}\] describes the current recommended usage
for these experimental values.[¶](#section-3.2.2-1){.pilcrow}
:::
:::
:::

::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [TCP Terminology Overview](#name-tcp-terminology-overview){.section-name .selfRef} {#name-tcp-terminology-overview}

This section includes an overview of key terms needed to understand the
detailed protocol operation in the rest of the document. There is a
glossary of terms in [Section
4](#glossary){.xref}.[¶](#section-3.3-1){.pilcrow}

::: {#section-3.3.1 .section}
#### [3.3.1.](#section-3.3.1){.section-number .selfRef} [Key Connection State Variables](#name-key-connection-state-variab){.section-name .selfRef} {#name-key-connection-state-variab}

Before we can discuss the operation of the TCP implementation in detail,
we need to introduce some detailed terminology. The maintenance of a TCP
connection requires maintaining state for several variables. We conceive
of these variables being stored in a connection record called a
Transmission Control Block or TCB. Among the variables stored in the TCB
are the local and remote IP addresses and port numbers, the IP security
level, and compartment of the connection (see [Appendix
A.1](#seccomp){.xref}), pointers to the user\'s send and receive
buffers, pointers to the retransmit queue and to the current segment. In
addition, several variables relating to the send and receive sequence
numbers are stored in the TCB.[¶](#section-3.3.1-1){.pilcrow}

[]{#name-send-sequence-variables}

  Variable   Description
  ---------- -----------------------------------------------------------
  SND.UNA    send unacknowledged
  SND.NXT    send next
  SND.WND    send window
  SND.UP     send urgent pointer
  SND.WL1    segment sequence number used for last window update
  SND.WL2    segment acknowledgment number used for last window update
  ISS        initial send sequence number

  : [Table 2](#table-2){.selfRef}: [Send Sequence
  Variables](#name-send-sequence-variables){.selfRef}

[]{#name-receive-sequence-variables}

  Variable   Description
  ---------- ---------------------------------
  RCV.NXT    receive next
  RCV.WND    receive window
  RCV.UP     receive urgent pointer
  IRS        initial receive sequence number

  : [Table 3](#table-3){.selfRef}: [Receive Sequence
  Variables](#name-receive-sequence-variables){.selfRef}

The following diagrams may help to relate some of these variables to the
sequence space.[¶](#section-3.3.1-4){.pilcrow}

[]{#name-send-sequence-space}

::: {#send_seq_space}
::: {#section-3.3.1-5.1 .alignLeft .art-text .artwork}
                       1         2          3          4
                  ----------|----------|----------|----------
                         SND.UNA    SND.NXT    SND.UNA
                                              +SND.WND

            1 - old sequence numbers that have been acknowledged
            2 - sequence numbers of unacknowledged data
            3 - sequence numbers allowed for new data transmission
            4 - future sequence numbers that are not yet allowed
:::

[Figure 3](#figure-3){.selfRef}: [Send Sequence
Space](#name-send-sequence-space){.selfRef}
:::

The send window is the portion of the sequence space labeled 3 in
[Figure 3](#send_seq_space){.xref}.[¶](#section-3.3.1-6){.pilcrow}

[]{#name-receive-sequence-space}

::: {#recv_seq_space}
::: {#section-3.3.1-7.1 .alignLeft .art-text .artwork}
                           1          2          3
                       ----------|----------|----------
                              RCV.NXT    RCV.NXT
                                        +RCV.WND

            1 - old sequence numbers that have been acknowledged
            2 - sequence numbers allowed for new reception
            3 - future sequence numbers that are not yet allowed
:::

[Figure 4](#figure-4){.selfRef}: [Receive Sequence
Space](#name-receive-sequence-space){.selfRef}
:::

The receive window is the portion of the sequence space labeled 2 in
[Figure 4](#recv_seq_space){.xref}.[¶](#section-3.3.1-8){.pilcrow}

There are also some variables used frequently in the discussion that
take their values from the fields of the current
segment.[¶](#section-3.3.1-9){.pilcrow}

[]{#name-current-segment-variables}

  Variable   Description
  ---------- -------------------------------
  SEG.SEQ    segment sequence number
  SEG.ACK    segment acknowledgment number
  SEG.LEN    segment length
  SEG.WND    segment window
  SEG.UP     segment urgent pointer

  : [Table 4](#table-4){.selfRef}: [Current Segment
  Variables](#name-current-segment-variables){.selfRef}
:::

::: {#section-3.3.2 .section}
#### [3.3.2.](#section-3.3.2){.section-number .selfRef} [State Machine Overview](#name-state-machine-overview){.section-name .selfRef} {#name-state-machine-overview}

A connection progresses through a series of states during its lifetime.
The states are: LISTEN, SYN-SENT, SYN-RECEIVED, ESTABLISHED, FIN-WAIT-1,
FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK, TIME-WAIT, and the fictional
state CLOSED. CLOSED is fictional because it represents the state when
there is no TCB, and therefore, no connection. Briefly the meanings of
the states are:[¶](#section-3.3.2-1){.pilcrow}

[]{.break}

LISTEN -
:   represents waiting for a connection request from any remote TCP peer
    and port.[¶](#section-3.3.2-2.2){.pilcrow}
:   

SYN-SENT -
:   represents waiting for a matching connection request after having
    sent a connection request.[¶](#section-3.3.2-2.4){.pilcrow}
:   

SYN-RECEIVED -
:   represents waiting for a confirming connection request
    acknowledgment after having both received and sent a connection
    request.[¶](#section-3.3.2-2.6){.pilcrow}
:   

ESTABLISHED -
:   represents an open connection, data received can be delivered to the
    user. The normal state for the data transfer phase of the
    connection.[¶](#section-3.3.2-2.8){.pilcrow}
:   

FIN-WAIT-1 -
:   represents waiting for a connection termination request from the
    remote TCP peer, or an acknowledgment of the connection termination
    request previously sent.[¶](#section-3.3.2-2.10){.pilcrow}
:   

FIN-WAIT-2 -
:   represents waiting for a connection termination request from the
    remote TCP peer.[¶](#section-3.3.2-2.12){.pilcrow}
:   

CLOSE-WAIT -
:   represents waiting for a connection termination request from the
    local user.[¶](#section-3.3.2-2.14){.pilcrow}
:   

CLOSING -
:   represents waiting for a connection termination request
    acknowledgment from the remote TCP
    peer.[¶](#section-3.3.2-2.16){.pilcrow}
:   

LAST-ACK -
:   represents waiting for an acknowledgment of the connection
    termination request previously sent to the remote TCP peer (this
    termination request sent to the remote TCP peer already included an
    acknowledgment of the termination request sent from the remote TCP
    peer).[¶](#section-3.3.2-2.18){.pilcrow}
:   

TIME-WAIT -
:   represents waiting for enough time to pass to be sure the remote TCP
    peer received the acknowledgment of its connection termination
    request and to avoid new connections being impacted by delayed
    segments from previous
    connections.[¶](#section-3.3.2-2.20){.pilcrow}
:   

CLOSED -
:   represents no connection state at
    all.[¶](#section-3.3.2-2.22){.pilcrow}
:   

A TCP connection progresses from one state to another in response to
events. The events are the user calls, OPEN, SEND, RECEIVE, CLOSE,
ABORT, and STATUS; the incoming segments, particularly those containing
the SYN, ACK, RST, and FIN flags; and
timeouts.[¶](#section-3.3.2-3){.pilcrow}

The OPEN call specifies whether connection establishment is to be
actively pursued, or to be passively waited
for.[¶](#section-3.3.2-4){.pilcrow}

A passive OPEN request means that the process wants to accept incoming
connection requests, in contrast to an active OPEN attempting to
initiate a connection.[¶](#section-3.3.2-5){.pilcrow}

The state diagram in [Figure 5](#conn_states){.xref} illustrates only
state changes, together with the causing events and resulting actions,
but addresses neither error conditions nor actions that are not
connected with state changes. In a later section, more detail is offered
with respect to the reaction of the TCP implementation to events. Some
state names are abbreviated or hyphenated differently in the diagram
from how they appear elsewhere in the
document.[¶](#section-3.3.2-6){.pilcrow}

[]{.break}

NOTA BENE:
:   This diagram is only a summary and must not be taken as the total
    specification. Many details are not
    included.[¶](#section-3.3.2-7.2){.pilcrow}
:   

[]{#name-tcp-connection-state-diagra}

::: {#conn_states}
::: {#section-3.3.2-8.1 .alignLeft .art-text .artwork}
                                +---------+ ---------\      active OPEN
                                |  CLOSED |            \    -----------
                                +---------+<---------\   \   create TCB
                                  |     ^              \   \  snd SYN
                     passive OPEN |     |   CLOSE        \   \
                     ------------ |     | ----------       \   \
                      create TCB  |     | delete TCB         \   \
                                  V     |                      \   \
              rcv RST (note 1)  +---------+            CLOSE    |    \
           -------------------->|  LISTEN |          ---------- |     |
          /                     +---------+          delete TCB |     |
         /           rcv SYN      |     |     SEND              |     |
        /           -----------   |     |    -------            |     V
    +--------+      snd SYN,ACK  /       \   snd SYN          +--------+
    |        |<-----------------           ------------------>|        |
    |  SYN   |                    rcv SYN                     |  SYN   |
    |  RCVD  |<-----------------------------------------------|  SENT  |
    |        |                  snd SYN,ACK                   |        |
    |        |------------------           -------------------|        |
    +--------+   rcv ACK of SYN  \       /  rcv SYN,ACK       +--------+
       |         --------------   |     |   -----------
       |                x         |     |     snd ACK
       |                          V     V
       |  CLOSE                 +---------+
       | -------                |  ESTAB  |
       | snd FIN                +---------+
       |                 CLOSE    |     |    rcv FIN
       V                -------   |     |    -------
    +---------+         snd FIN  /       \   snd ACK         +---------+
    |  FIN    |<----------------          ------------------>|  CLOSE  |
    | WAIT-1  |------------------                            |   WAIT  |
    +---------+          rcv FIN  \                          +---------+
      | rcv ACK of FIN   -------   |                          CLOSE  |
      | --------------   snd ACK   |                         ------- |
      V        x                   V                         snd FIN V
    +---------+               +---------+                    +---------+
    |FINWAIT-2|               | CLOSING |                    | LAST-ACK|
    +---------+               +---------+                    +---------+
      |              rcv ACK of FIN |                 rcv ACK of FIN |
      |  rcv FIN     -------------- |    Timeout=2MSL -------------- |
      |  -------            x       V    ------------        x       V
       \ snd ACK              +---------+delete TCB          +---------+
         -------------------->|TIME-WAIT|------------------->| CLOSED  |
                              +---------+                    +---------+
:::

[Figure 5](#figure-5){.selfRef}: [TCP Connection State
Diagram](#name-tcp-connection-state-diagra){.selfRef}
:::

The following notes apply to [Figure
5](#conn_states){.xref}:[¶](#section-3.3.2-9){.pilcrow}

[]{.break}

Note 1:
:   The transition from SYN-RECEIVED to LISTEN on receiving a RST is
    conditional on having reached SYN-RECEIVED after a passive
    OPEN.[¶](#section-3.3.2-10.2){.pilcrow}
:   

Note 2:
:   The figure omits a transition from FIN-WAIT-1 to TIME-WAIT if a FIN
    is received and the local FIN is also
    acknowledged.[¶](#section-3.3.2-10.4){.pilcrow}
:   

Note 3:
:   A RST can be sent from any state with a corresponding transition to
    TIME-WAIT (see \[[70](#FTY99){.xref}\] for rationale). These
    transitions are not explicitly shown; otherwise, the diagram would
    become very difficult to read. Similarly, receipt of a RST from any
    state results in a transition to LISTEN or CLOSED, though this is
    also omitted from the diagram for
    legibility.[¶](#section-3.3.2-10.6){.pilcrow}
:   
:::
:::

::: {#sequence-numbers}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Sequence Numbers](#name-sequence-numbers){.section-name .selfRef} {#name-sequence-numbers}

A fundamental notion in the design is that every octet of data sent over
a TCP connection has a sequence number. Since every octet is sequenced,
each of them can be acknowledged. The acknowledgment mechanism employed
is cumulative so that an acknowledgment of sequence number X indicates
that all octets up to but not including X have been received. This
mechanism allows for straightforward duplicate detection in the presence
of retransmission. The numbering scheme of octets within a segment is as
follows: the first data octet immediately following the header is the
lowest numbered, and the following octets are numbered
consecutively.[¶](#section-3.4-1){.pilcrow}

It is essential to remember that the actual sequence number space is
finite, though large. This space ranges from 0 to 2^32^ - 1. Since the
space is finite, all arithmetic dealing with sequence numbers must be
performed modulo 2^32^. This unsigned arithmetic preserves the
relationship of sequence numbers as they cycle from 2^32^ - 1 to 0
again. There are some subtleties to computer modulo arithmetic, so great
care should be taken in programming the comparison of such values. The
symbol \"=\<\" means \"less than or equal\" (modulo
2^32^).[¶](#section-3.4-2){.pilcrow}

The typical kinds of sequence number comparisons that the TCP
implementation must perform include:[¶](#section-3.4-3){.pilcrow}

[]{.break}

\(a\)
:   Determining that an acknowledgment refers to some sequence number
    sent but not yet acknowledged.[¶](#section-3.4-4.1){.pilcrow}
:   

\(b\)
:   Determining that all sequence numbers occupied by a segment have
    been acknowledged (e.g., to remove the segment from a retransmission
    queue).[¶](#section-3.4-4.2){.pilcrow}
:   

\(c\)
:   Determining that an incoming segment contains sequence numbers that
    are expected (i.e., that the segment \"overlaps\" the receive
    window).[¶](#section-3.4-4.3){.pilcrow}
:   

In response to sending data, the TCP endpoint will receive
acknowledgments. The following comparisons are needed to process the
acknowledgments:[¶](#section-3.4-5){.pilcrow}

SND.UNA = oldest unacknowledged sequence
number[¶](#section-3.4-6){.pilcrow}

SND.NXT = next sequence number to be sent[¶](#section-3.4-7){.pilcrow}

SEG.ACK = acknowledgment from the receiving TCP peer (next sequence
number expected by the receiving TCP peer)[¶](#section-3.4-8){.pilcrow}

SEG.SEQ = first sequence number of a
segment[¶](#section-3.4-9){.pilcrow}

SEG.LEN = the number of octets occupied by the data in the segment
(counting SYN and FIN)[¶](#section-3.4-10){.pilcrow}

SEG.SEQ+SEG.LEN-1 = last sequence number of a
segment[¶](#section-3.4-11){.pilcrow}

A new acknowledgment (called an \"acceptable ack\") is one for which the
inequality below holds:[¶](#section-3.4-12){.pilcrow}

SND.UNA \< SEG.ACK =\< SND.NXT[¶](#section-3.4-13){.pilcrow}

A segment on the retransmission queue is fully acknowledged if the sum
of its sequence number and length is less than or equal to the
acknowledgment value in the incoming
segment.[¶](#section-3.4-14){.pilcrow}

When data is received, the following comparisons are
needed:[¶](#section-3.4-15){.pilcrow}

RCV.NXT = next sequence number expected on an incoming segment, and is
the left or lower edge of the receive
window[¶](#section-3.4-16){.pilcrow}

RCV.NXT+RCV.WND-1 = last sequence number expected on an incoming
segment, and is the right or upper edge of the receive
window[¶](#section-3.4-17){.pilcrow}

SEG.SEQ = first sequence number occupied by the incoming
segment[¶](#section-3.4-18){.pilcrow}

SEG.SEQ+SEG.LEN-1 = last sequence number occupied by the incoming
segment[¶](#section-3.4-19){.pilcrow}

A segment is judged to occupy a portion of valid receive sequence space
if[¶](#section-3.4-20){.pilcrow}

RCV.NXT =\< SEG.SEQ \< RCV.NXT+RCV.WND[¶](#section-3.4-21){.pilcrow}

or[¶](#section-3.4-22){.pilcrow}

RCV.NXT =\< SEG.SEQ+SEG.LEN-1 \<
RCV.NXT+RCV.WND[¶](#section-3.4-23){.pilcrow}

The first part of this test checks to see if the beginning of the
segment falls in the window, the second part of the test checks to see
if the end of the segment falls in the window; if the segment passes
either part of the test, it contains data in the
window.[¶](#section-3.4-24){.pilcrow}

Actually, it is a little more complicated than this. Due to zero windows
and zero-length segments, we have four cases for the acceptability of an
incoming segment:[¶](#section-3.4-25){.pilcrow}

[]{#name-segment-acceptability-tests}

+-----------------------+-----------------------+-----------------------+
| Segment Length        | Receive Window        | Test                  |
+=======================+=======================+=======================+
| 0                     | 0                     | SEG.SEQ = RCV.NXT     |
+-----------------------+-----------------------+-----------------------+
| 0                     | \>0                   | RCV.NXT =\< SEG.SEQ   |
|                       |                       | \< RCV.NXT+RCV.WND    |
+-----------------------+-----------------------+-----------------------+
| \>0                   | 0                     | not acceptable        |
+-----------------------+-----------------------+-----------------------+
| \>0                   | \>0                   | RCV.NXT =\< SEG.SEQ   |
|                       |                       | \<                    |
|                       |                       | RCV.NXT+RCV           |
|                       |                       | .WND[¶](#section-3.4- |
|                       |                       | 26.2.4.3.1){.pilcrow} |
|                       |                       |                       |
|                       |                       | or[¶](#section-3.4-   |
|                       |                       | 26.2.4.3.2){.pilcrow} |
|                       |                       |                       |
|                       |                       | RCV.NXT =\<           |
|                       |                       | SEG.SEQ+SEG.LEN-1 \<  |
|                       |                       | RCV.NXT+RCV           |
|                       |                       | .WND[¶](#section-3.4- |
|                       |                       | 26.2.4.3.3){.pilcrow} |
+-----------------------+-----------------------+-----------------------+

: [Table 5](#table-5){.selfRef}: [Segment Acceptability
Tests](#name-segment-acceptability-tests){.selfRef}

Note that when the receive window is zero no segments should be
acceptable except ACK segments. Thus, it is possible for a TCP
implementation to maintain a zero receive window while transmitting data
and receiving ACKs. A TCP receiver [MUST]{.bcp14} process the RST and
URG fields of all incoming segments, even when the receive window is
zero (MUST-66).[¶](#section-3.4-27){.pilcrow}

We have taken advantage of the numbering scheme to protect certain
control information as well. This is achieved by implicitly including
some control flags in the sequence space so they can be retransmitted
and acknowledged without confusion (i.e., one and only one copy of the
control will be acted upon). Control information is not physically
carried in the segment data space. Consequently, we must adopt rules for
implicitly assigning sequence numbers to control. The SYN and FIN are
the only controls requiring this protection, and these controls are used
only at connection opening and closing. For sequence number purposes,
the SYN is considered to occur before the first actual data octet of the
segment in which it occurs, while the FIN is considered to occur after
the last actual data octet in a segment in which it occurs. The segment
length (SEG.LEN) includes both data and sequence space-occupying
controls. When a SYN is present, then SEG.SEQ is the sequence number of
the SYN.[¶](#section-3.4-28){.pilcrow}

::: {#section-3.4.1 .section}
#### [3.4.1.](#section-3.4.1){.section-number .selfRef} [Initial Sequence Number Selection](#name-initial-sequence-number-sel){.section-name .selfRef} {#name-initial-sequence-number-sel}

A connection is defined by a pair of sockets. Connections can be reused.
New instances of a connection will be referred to as incarnations of the
connection. The problem that arises from this is \-- \"how does the TCP
implementation identify duplicate segments from previous incarnations of
the connection?\" This problem becomes apparent if the connection is
being opened and closed in quick succession, or if the connection breaks
with loss of memory and is then reestablished. To support this, the
TIME-WAIT state limits the rate of connection reuse, while the initial
sequence number selection described below further protects against
ambiguity about which incarnation of a connection an incoming packet
corresponds to.[¶](#section-3.4.1-1){.pilcrow}

To avoid confusion, we must prevent segments from one incarnation of a
connection from being used while the same sequence numbers may still be
present in the network from an earlier incarnation. We want to assure
this even if a TCP endpoint loses all knowledge of the sequence numbers
it has been using. When new connections are created, an initial sequence
number (ISN) generator is employed that selects a new 32-bit ISN. There
are security issues that result if an off-path attacker is able to
predict or guess ISN values
\[[42](#RFC6528){.xref}\].[¶](#section-3.4.1-2){.pilcrow}

TCP initial sequence numbers are generated from a number sequence that
monotonically increases until it wraps, known loosely as a \"clock\".
This clock is a 32-bit counter that typically increments at least once
every roughly 4 microseconds, although it is neither assumed to be
realtime nor precise, and need not persist across reboots. The clock
component is intended to ensure that with a Maximum Segment Lifetime
(MSL), generated ISNs will be unique since it cycles approximately every
4.55 hours, which is much longer than the MSL. Please note that for
modern networks that support high data rates where the connection might
start and quickly advance sequence numbers to overlap within the MSL, it
is recommended to implement the Timestamp Option as mentioned later in
[Section
3.4.3](#tcp_quiet_time_concept){.xref}.[¶](#section-3.4.1-3){.pilcrow}

A TCP implementation [MUST]{.bcp14} use the above type of \"clock\" for
clock-driven selection of initial sequence numbers (MUST-8), and
[SHOULD]{.bcp14} generate its initial sequence numbers with the
expression:[¶](#section-3.4.1-4){.pilcrow}

ISN = M + F(localip, localport, remoteip, remoteport,
secretkey)[¶](#section-3.4.1-5){.pilcrow}

where M is the 4 microsecond timer, and F() is a pseudorandom function
(PRF) of the connection\'s identifying parameters (\"localip, localport,
remoteip, remoteport\") and a secret key (\"secretkey\") (SHLD-1). F()
[MUST NOT]{.bcp14} be computable from the outside (MUST-9), or an
attacker could still guess at sequence numbers from the ISN used for
some other connection. The PRF could be implemented as a cryptographic
hash of the concatenation of the TCP connection parameters and some
secret data. For discussion of the selection of a specific hash
algorithm and management of the secret key data, please see [Section
3](https://www.rfc-editor.org/rfc/rfc6528#section-3){.relref} of
\[[42](#RFC6528){.xref}\].[¶](#section-3.4.1-6){.pilcrow}

For each connection there is a send sequence number and a receive
sequence number. The initial send sequence number (ISS) is chosen by the
data sending TCP peer, and the initial receive sequence number (IRS) is
learned during the connection-establishing
procedure.[¶](#section-3.4.1-7){.pilcrow}

For a connection to be established or initialized, the two TCP peers
must synchronize on each other\'s initial sequence numbers. This is done
in an exchange of connection-establishing segments carrying a control
bit called \"SYN\" (for synchronize) and the initial sequence numbers.
As a shorthand, segments carrying the SYN bit are also called \"SYNs\".
Hence, the solution requires a suitable mechanism for picking an initial
sequence number and a slightly involved handshake to exchange the
ISNs.[¶](#section-3.4.1-8){.pilcrow}

The synchronization requires each side to send its own initial sequence
number and to receive a confirmation of it in acknowledgment from the
remote TCP peer. Each side must also receive the remote peer\'s initial
sequence number and send a confirming
acknowledgment.[¶](#section-3.4.1-9){.pilcrow}

::: {#section-3.4.1-10 .alignLeft .art-text .artwork}
        1) A --> B  SYN my sequence number is X
        2) A <-- B  ACK your sequence number is X
        3) A <-- B  SYN my sequence number is Y
        4) A --> B  ACK your sequence number is Y

[¶](#section-3.4.1-10){.pilcrow}
:::

Because steps 2 and 3 can be combined in a single message this is called
the three-way (or three message) handshake
(3WHS).[¶](#section-3.4.1-11){.pilcrow}

A 3WHS is necessary because sequence numbers are not tied to a global
clock in the network, and TCP implementations may have different
mechanisms for picking the ISNs. The receiver of the first SYN has no
way of knowing whether the segment was an old one or not, unless it
remembers the last sequence number used on the connection (which is not
always possible), and so it must ask the sender to verify this SYN. The
three-way handshake and the advantages of a clock-driven scheme for ISN
selection are discussed in
\[[69](#DS78){.xref}\].[¶](#section-3.4.1-12){.pilcrow}
:::

::: {#section-3.4.2 .section}
#### [3.4.2.](#section-3.4.2){.section-number .selfRef} [Knowing When to Keep Quiet](#name-knowing-when-to-keep-quiet){.section-name .selfRef} {#name-knowing-when-to-keep-quiet}

A theoretical problem exists where data could be corrupted due to
confusion between old segments in the network and new ones after a host
reboots if the same port numbers and sequence space are reused. The
\"quiet time\" concept discussed below addresses this, and the
discussion of it is included for situations where it might be relevant,
although it is not felt to be necessary in most current implementations.
The problem was more relevant earlier in the history of TCP. In
practical use on the Internet today, the error-prone conditions are
sufficiently unlikely that it is safe to ignore. Reasons why it is now
negligible include: (a) ISS and ephemeral port randomization have
reduced likelihood of reuse of port numbers and sequence numbers after
reboots, (b) the effective MSL of the Internet has declined as links
have become faster, and (c) reboots often taking longer than an MSL
anyways.[¶](#section-3.4.2-1){.pilcrow}

To be sure that a TCP implementation does not create a segment carrying
a sequence number that may be duplicated by an old segment remaining in
the network, the TCP endpoint must keep quiet for an MSL before
assigning any sequence numbers upon starting up or recovering from a
situation where memory of sequence numbers in use was lost. For this
specification the MSL is taken to be 2 minutes. This is an engineering
choice, and may be changed if experience indicates it is desirable to do
so. Note that if a TCP endpoint is reinitialized in some sense, yet
retains its memory of sequence numbers in use, then it need not wait at
all; it must only be sure to use sequence numbers larger than those
recently used.[¶](#section-3.4.2-2){.pilcrow}
:::

::: {#tcp_quiet_time_concept}
::: {#section-3.4.3 .section}
#### [3.4.3.](#section-3.4.3){.section-number .selfRef} [The TCP Quiet Time Concept](#name-the-tcp-quiet-time-concept){.section-name .selfRef} {#name-the-tcp-quiet-time-concept}

Hosts that for any reason lose knowledge of the last sequence numbers
transmitted on each active (i.e., not closed) connection shall delay
emitting any TCP segments for at least the agreed MSL in the internet
system that the host is a part of. In the paragraphs below, an
explanation for this specification is given. TCP implementers may
violate the \"quiet time\" restriction, but only at the risk of causing
some old data to be accepted as new or new data rejected as old
duplicated data by some receivers in the internet
system.[¶](#section-3.4.3-1){.pilcrow}

TCP endpoints consume sequence number space each time a segment is
formed and entered into the network output queue at a source host. The
duplicate detection and sequencing algorithm in TCP relies on the unique
binding of segment data to sequence space to the extent that sequence
numbers will not cycle through all 2^32^ values before the segment data
bound to those sequence numbers has been delivered and acknowledged by
the receiver and all duplicate copies of the segments have \"drained\"
from the internet. Without such an assumption, two distinct TCP segments
could conceivably be assigned the same or overlapping sequence numbers,
causing confusion at the receiver as to which data is new and which is
old. Remember that each segment is bound to as many consecutive sequence
numbers as there are octets of data and SYN or FIN flags in the
segment.[¶](#section-3.4.3-2){.pilcrow}

Under normal conditions, TCP implementations keep track of the next
sequence number to emit and the oldest awaiting acknowledgment so as to
avoid mistakenly reusing a sequence number before its first use has been
acknowledged. This alone does not guarantee that old duplicate data is
drained from the net, so the sequence space has been made large to
reduce the probability that a wandering duplicate will cause trouble
upon arrival. At 2 megabits/sec., it takes 4.5 hours to use up 2^32^
octets of sequence space. Since the maximum segment lifetime in the net
is not likely to exceed a few tens of seconds, this is deemed ample
protection for foreseeable nets, even if data rates escalate to 10s of
megabits/sec. At 100 megabits/sec., the cycle time is 5.4 minutes, which
may be a little short but still within reason. Much higher data rates
are possible today, with implications described in the final paragraph
of this subsection.[¶](#section-3.4.3-3){.pilcrow}

The basic duplicate detection and sequencing algorithm in TCP can be
defeated, however, if a source TCP endpoint does not have any memory of
the sequence numbers it last used on a given connection. For example, if
the TCP implementation were to start all connections with sequence
number 0, then upon the host rebooting, a TCP peer might re-form an
earlier connection (possibly after half-open connection resolution) and
emit packets with sequence numbers identical to or overlapping with
packets still in the network, which were emitted on an earlier
incarnation of the same connection. In the absence of knowledge about
the sequence numbers used on a particular connection, the TCP
specification recommends that the source delay for MSL seconds before
emitting segments on the connection, to allow time for segments from the
earlier connection incarnation to drain from the
system.[¶](#section-3.4.3-4){.pilcrow}

Even hosts that can remember the time of day and use it to select
initial sequence number values are not immune from this problem (i.e.,
even if time of day is used to select an initial sequence number for
each new connection incarnation).[¶](#section-3.4.3-5){.pilcrow}

Suppose, for example, that a connection is opened starting with sequence
number S. Suppose that this connection is not used much and that
eventually the initial sequence number function (ISN(t)) takes on a
value equal to the sequence number, say S1, of the last segment sent by
this TCP endpoint on a particular connection. Now suppose, at this
instant, the host reboots and establishes a new incarnation of the
connection. The initial sequence number chosen is S1 = ISN(t) \-- last
used sequence number on old incarnation of connection! If the recovery
occurs quickly enough, any old duplicates in the net bearing sequence
numbers in the neighborhood of S1 may arrive and be treated as new
packets by the receiver of the new incarnation of the
connection.[¶](#section-3.4.3-6){.pilcrow}

The problem is that the recovering host may not know for how long it was
down between rebooting nor does it know whether there are still old
duplicates in the system from earlier connection
incarnations.[¶](#section-3.4.3-7){.pilcrow}

One way to deal with this problem is to deliberately delay emitting
segments for one MSL after recovery from a reboot \-- this is the
\"quiet time\" specification. Hosts that prefer to avoid waiting and are
willing to risk possible confusion of old and new packets at a given
destination may choose not to wait for the \"quiet time\". Implementers
may provide TCP users with the ability to select on a
connection-by-connection basis whether to wait after a reboot, or may
informally implement the \"quiet time\" for all connections. Obviously,
even where a user selects to \"wait\", this is not necessary after the
host has been \"up\" for at least MSL
seconds.[¶](#section-3.4.3-8){.pilcrow}

To summarize: every segment emitted occupies one or more sequence
numbers in the sequence space, and the numbers occupied by a segment are
\"busy\" or \"in use\" until MSL seconds have passed. Upon rebooting, a
block of space-time is occupied by the octets and SYN or FIN flags of
any potentially still in-flight segments. If a new connection is started
too soon and uses any of the sequence numbers in the space-time
footprint of those potentially still in-flight segments of the previous
connection incarnation, there is a potential sequence number overlap
area that could cause confusion at the
receiver.[¶](#section-3.4.3-9){.pilcrow}

High-performance cases will have shorter cycle times than those in the
megabits per second that the base TCP design described above considers.
At 1 Gbps, the cycle time is 34 seconds, only 3 seconds at 10 Gbps, and
around a third of a second at 100 Gbps. In these higher-performance
cases, TCP Timestamp Options and Protection Against Wrapped Sequences
(PAWS) \[[47](#RFC7323){.xref}\] provide the needed capability to detect
and discard old duplicates.[¶](#section-3.4.3-10){.pilcrow}
:::
:::
:::
:::

::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Establishing a Connection](#name-establishing-a-connection){.section-name .selfRef} {#name-establishing-a-connection}

The \"three-way handshake\" is the procedure used to establish a
connection. This procedure normally is initiated by one TCP peer and
responded to by another TCP peer. The procedure also works if two TCP
peers simultaneously initiate the procedure. When simultaneous open
occurs, each TCP peer receives a SYN segment that carries no
acknowledgment after it has sent a SYN. Of course, the arrival of an old
duplicate SYN segment can potentially make it appear, to the recipient,
that a simultaneous connection initiation is in progress. Proper use of
\"reset\" segments can disambiguate these
cases.[¶](#section-3.5-1){.pilcrow}

Several examples of connection initiation follow. Although these
examples do not show connection synchronization using data-carrying
segments, this is perfectly legitimate, so long as the receiving TCP
endpoint doesn\'t deliver the data to the user until it is clear the
data is valid (e.g., the data is buffered at the receiver until the
connection reaches the ESTABLISHED state, given that the three-way
handshake reduces the possibility of false connections). It is a
trade-off between memory and messages to provide information for this
checking.[¶](#section-3.5-2){.pilcrow}

The simplest 3WHS is shown in [Figure 6](#handshake){.xref}. The figures
should be interpreted in the following way. Each line is numbered for
reference purposes. Right arrows (\--\>) indicate departure of a TCP
segment from TCP Peer A to TCP Peer B or arrival of a segment at B from
A. Left arrows (\<\--) indicate the reverse. Ellipses (\...) indicate a
segment that is still in the network (delayed). Comments appear in
parentheses. TCP connection states represent the state AFTER the
departure or arrival of the segment (whose contents are shown in the
center of each line). Segment contents are shown in abbreviated form,
with sequence number, control flags, and ACK field. Other fields such as
window, addresses, lengths, and text have been left out in the interest
of clarity.[¶](#section-3.5-3){.pilcrow}

[]{#name-basic-three-way-handshake-f}

::: {#handshake}
::: {#section-3.5-4.1 .alignLeft .art-text .artwork}
        TCP Peer A                                           TCP Peer B

    1.  CLOSED                                               LISTEN

    2.  SYN-SENT    --> <SEQ=100><CTL=SYN>               --> SYN-RECEIVED

    3.  ESTABLISHED <-- <SEQ=300><ACK=101><CTL=SYN,ACK>  <-- SYN-RECEIVED

    4.  ESTABLISHED --> <SEQ=101><ACK=301><CTL=ACK>       --> ESTABLISHED

    5.  ESTABLISHED --> <SEQ=101><ACK=301><CTL=ACK><DATA> --> ESTABLISHED
:::

[Figure 6](#figure-6){.selfRef}: [Basic Three-Way Handshake for
Connection Synchronization](#name-basic-three-way-handshake-f){.selfRef}
:::

In line 2 of [Figure 6](#handshake){.xref}, TCP Peer A begins by sending
a SYN segment indicating that it will use sequence numbers starting with
sequence number 100. In line 3, TCP Peer B sends a SYN and acknowledges
the SYN it received from TCP Peer A. Note that the acknowledgment field
indicates TCP Peer B is now expecting to hear sequence 101,
acknowledging the SYN that occupied sequence
100.[¶](#section-3.5-5){.pilcrow}

At line 4, TCP Peer A responds with an empty segment containing an ACK
for TCP Peer B\'s SYN; and in line 5, TCP Peer A sends some data. Note
that the sequence number of the segment in line 5 is the same as in line
4 because the ACK does not occupy sequence number space (if it did, we
would wind up ACKing ACKs!).[¶](#section-3.5-6){.pilcrow}

Simultaneous initiation is only slightly more complex, as is shown in
[Figure 7](#simul_connect){.xref}. Each TCP peer\'s connection state
cycles from CLOSED to SYN-SENT to SYN-RECEIVED to
ESTABLISHED.[¶](#section-3.5-7){.pilcrow}

[]{#name-simultaneous-connection-syn}

::: {#simul_connect}
::: {#section-3.5-8.1 .alignLeft .art-text .artwork}
        TCP Peer A                                       TCP Peer B

    1.  CLOSED                                           CLOSED

    2.  SYN-SENT     --> <SEQ=100><CTL=SYN>              ...

    3.  SYN-RECEIVED <-- <SEQ=300><CTL=SYN>              <-- SYN-SENT

    4.               ... <SEQ=100><CTL=SYN>              --> SYN-RECEIVED

    5.  SYN-RECEIVED --> <SEQ=100><ACK=301><CTL=SYN,ACK> ...

    6.  ESTABLISHED  <-- <SEQ=300><ACK=101><CTL=SYN,ACK> <-- SYN-RECEIVED

    7.               ... <SEQ=100><ACK=301><CTL=SYN,ACK> --> ESTABLISHED
:::

[Figure 7](#figure-7){.selfRef}: [Simultaneous Connection
Synchronization](#name-simultaneous-connection-syn){.selfRef}
:::

A TCP implementation [MUST]{.bcp14} support simultaneous open attempts
(MUST-10).[¶](#section-3.5-9){.pilcrow}

Note that a TCP implementation [MUST]{.bcp14} keep track of whether a
connection has reached SYN-RECEIVED state as the result of a passive
OPEN or an active OPEN (MUST-11).[¶](#section-3.5-10){.pilcrow}

The principal reason for the three-way handshake is to prevent old
duplicate connection initiations from causing confusion. To deal with
this, a special control message, reset, is specified. If the receiving
TCP peer is in a non-synchronized state (i.e., SYN-SENT, SYN-RECEIVED),
it returns to LISTEN on receiving an acceptable reset. If the TCP peer
is in one of the synchronized states (ESTABLISHED, FIN-WAIT-1,
FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK, TIME-WAIT), it aborts the
connection and informs its user. We discuss this latter case under
\"half-open\" connections below.[¶](#section-3.5-11){.pilcrow}

[]{#name-recovery-from-old-duplicate}

::: {#dup_syn}
::: {#section-3.5-12.1 .alignLeft .art-text .artwork}
        TCP Peer A                                           TCP Peer B

    1.  CLOSED                                               LISTEN

    2.  SYN-SENT    --> <SEQ=100><CTL=SYN>               ...

    3.  (duplicate) ... <SEQ=90><CTL=SYN>               --> SYN-RECEIVED

    4.  SYN-SENT    <-- <SEQ=300><ACK=91><CTL=SYN,ACK>  <-- SYN-RECEIVED

    5.  SYN-SENT    --> <SEQ=91><CTL=RST>               --> LISTEN

    6.              ... <SEQ=100><CTL=SYN>               --> SYN-RECEIVED

    7.  ESTABLISHED <-- <SEQ=400><ACK=101><CTL=SYN,ACK>  <-- SYN-RECEIVED

    8.  ESTABLISHED --> <SEQ=101><ACK=401><CTL=ACK>      --> ESTABLISHED
:::

[Figure 8](#figure-8){.selfRef}: [Recovery from Old Duplicate
SYN](#name-recovery-from-old-duplicate){.selfRef}
:::

As a simple example of recovery from old duplicates, consider [Figure
8](#dup_syn){.xref}. At line 3, an old duplicate SYN arrives at TCP Peer
B. TCP Peer B cannot tell that this is an old duplicate, so it responds
normally (line 4). TCP Peer A detects that the ACK field is incorrect
and returns a RST (reset) with its SEQ field selected to make the
segment believable. TCP Peer B, on receiving the RST, returns to the
LISTEN state. When the original SYN finally arrives at line 6, the
synchronization proceeds normally. If the SYN at line 6 had arrived
before the RST, a more complex exchange might have occurred with RSTs
sent in both directions.[¶](#section-3.5-13){.pilcrow}

::: {#section-3.5.1 .section}
#### [3.5.1.](#section-3.5.1){.section-number .selfRef} [Half-Open Connections and Other Anomalies](#name-half-open-connections-and-o){.section-name .selfRef} {#name-half-open-connections-and-o}

An established connection is said to be \"half-open\" if one of the TCP
peers has closed or aborted the connection at its end without the
knowledge of the other, or if the two ends of the connection have become
desynchronized owing to a failure or reboot that resulted in loss of
memory. Such connections will automatically become reset if an attempt
is made to send data in either direction. However, half-open connections
are expected to be unusual.[¶](#section-3.5.1-1){.pilcrow}

If at site A the connection no longer exists, then an attempt by the
user at site B to send any data on it will result in the site B TCP
endpoint receiving a reset control message. Such a message indicates to
the site B TCP endpoint that something is wrong, and it is expected to
abort the connection.[¶](#section-3.5.1-2){.pilcrow}

Assume that two user processes A and B are communicating with one
another when a failure or reboot occurs causing loss of memory to A\'s
TCP implementation. Depending on the operating system supporting A\'s
TCP implementation, it is likely that some error recovery mechanism
exists. When the TCP endpoint is up again, A is likely to start again
from the beginning or from a recovery point. As a result, A will
probably try to OPEN the connection again or try to SEND on the
connection it believes open. In the latter case, it receives the error
message \"connection not open\" from the local (A\'s) TCP
implementation. In an attempt to establish the connection, A\'s TCP
implementation will send a segment containing SYN. This scenario leads
to the example shown in [Figure 9](#half_open){.xref}. After TCP Peer A
reboots, the user attempts to reopen the connection. TCP Peer B, in the
meantime, thinks the connection is open.[¶](#section-3.5.1-3){.pilcrow}

[]{#name-half-open-connection-discov}

::: {#half_open}
::: {#section-3.5.1-4.1 .alignLeft .art-text .artwork}
          TCP Peer A                                      TCP Peer B

      1.  (REBOOT)                              (send 300,receive 100)

      2.  CLOSED                                           ESTABLISHED

      3.  SYN-SENT --> <SEQ=400><CTL=SYN>              --> (??)

      4.  (!!)     <-- <SEQ=300><ACK=100><CTL=ACK>     <-- ESTABLISHED

      5.  SYN-SENT --> <SEQ=100><CTL=RST>              --> (Abort!!)

      6.  SYN-SENT                                         CLOSED

      7.  SYN-SENT --> <SEQ=400><CTL=SYN>              -->
:::

[Figure 9](#figure-9){.selfRef}: [Half-Open Connection
Discovery](#name-half-open-connection-discov){.selfRef}
:::

When the SYN arrives at line 3, TCP Peer B, being in a synchronized
state, and the incoming segment outside the window, responds with an
acknowledgment indicating what sequence it next expects to hear (ACK
100). TCP Peer A sees that this segment does not acknowledge anything it
sent and, being unsynchronized, sends a reset (RST) because it has
detected a half-open connection. TCP Peer B aborts at line 5. TCP Peer A
will continue to try to establish the connection; the problem is now
reduced to the basic three-way handshake of [Figure
6](#handshake){.xref}.[¶](#section-3.5.1-5){.pilcrow}

An interesting alternative case occurs when TCP Peer A reboots and TCP
Peer B tries to send data on what it thinks is a synchronized
connection. This is illustrated in [Figure 10](#crash){.xref}. In this
case, the data arriving at TCP Peer A from TCP Peer B (line 2) is
unacceptable because no such connection exists, so TCP Peer A sends a
RST. The RST is acceptable so TCP Peer B processes it and aborts the
connection.[¶](#section-3.5.1-6){.pilcrow}

[]{#name-active-side-causes-half-ope}

::: {#crash}
::: {#section-3.5.1-7.1 .alignLeft .art-text .artwork}
          TCP Peer A                                         TCP Peer B

    1.  (REBOOT)                                  (send 300,receive 100)

    2.  (??)    <-- <SEQ=300><ACK=100><DATA=10><CTL=ACK> <-- ESTABLISHED

    3.          --> <SEQ=100><CTL=RST>                   --> (ABORT!!)
:::

[Figure 10](#figure-10){.selfRef}: [Active Side Causes Half-Open
Connection Discovery](#name-active-side-causes-half-ope){.selfRef}
:::

In [Figure 11](#passive_reset){.xref}, two TCP Peers A and B with
passive connections waiting for SYN are depicted. An old duplicate
arriving at TCP Peer B (line 2) stirs B into action. A SYN-ACK is
returned (line 3) and causes TCP A to generate a RST (the ACK in line 3
is not acceptable). TCP Peer B accepts the reset and returns to its
passive LISTEN state.[¶](#section-3.5.1-8){.pilcrow}

[]{#name-old-duplicate-syn-initiates}

::: {#passive_reset}
::: {#section-3.5.1-9.1 .alignLeft .art-text .artwork}
        TCP Peer A                                    TCP Peer B

    1.  LISTEN                                        LISTEN

    2.       ... <SEQ=Z><CTL=SYN>                -->  SYN-RECEIVED

    3.  (??) <-- <SEQ=X><ACK=Z+1><CTL=SYN,ACK>   <--  SYN-RECEIVED

    4.       --> <SEQ=Z+1><CTL=RST>              -->  (return to LISTEN!)

    5.  LISTEN                                        LISTEN
:::

[Figure 11](#figure-11){.selfRef}: [Old Duplicate SYN Initiates a Reset
on Two Passive Sockets](#name-old-duplicate-syn-initiates){.selfRef}
:::

A variety of other cases are possible, all of which are accounted for by
the following rules for RST generation and
processing.[¶](#section-3.5.1-10){.pilcrow}
:::

::: {#section-3.5.2 .section}
#### [3.5.2.](#section-3.5.2){.section-number .selfRef} [Reset Generation](#name-reset-generation){.section-name .selfRef} {#name-reset-generation}

A TCP user or application can issue a reset on a connection at any time,
though reset events are also generated by the protocol itself when
various error conditions occur, as described below. The side of a
connection issuing a reset should enter the TIME-WAIT state, as this
generally helps to reduce the load on busy servers for reasons described
in \[[70](#FTY99){.xref}\].[¶](#section-3.5.2-1){.pilcrow}

As a general rule, reset (RST) is sent whenever a segment arrives that
apparently is not intended for the current connection. A reset must not
be sent if it is not clear that this is the
case.[¶](#section-3.5.2-2){.pilcrow}

There are three groups of states:[¶](#section-3.5.2-3){.pilcrow}

1.  ::: {#section-3.5.2-4.1}
    If the connection does not exist (CLOSED), then a reset is sent in
    response to any incoming segment except another reset. A SYN segment
    that does not match an existing connection is rejected by this
    means.[¶](#section-3.5.2-4.1.1){.pilcrow}

    If the incoming segment has the ACK bit set, the reset takes its
    sequence number from the ACK field of the segment; otherwise, the
    reset has sequence number zero and the ACK field is set to the sum
    of the sequence number and segment length of the incoming segment.
    The connection remains in the CLOSED
    state.[¶](#section-3.5.2-4.1.2){.pilcrow}
    :::

2.  ::: {#section-3.5.2-4.2}
    If the connection is in any non-synchronized state (LISTEN,
    SYN-SENT, SYN-RECEIVED), and the incoming segment acknowledges
    something not yet sent (the segment carries an unacceptable ACK), or
    if an incoming segment has a security level or compartment
    ([Appendix A.1](#seccomp){.xref}) that does not exactly match the
    level and compartment requested for the connection, a reset is
    sent.[¶](#section-3.5.2-4.2.1){.pilcrow}

    If the incoming segment has an ACK field, the reset takes its
    sequence number from the ACK field of the segment; otherwise, the
    reset has sequence number zero and the ACK field is set to the sum
    of the sequence number and segment length of the incoming segment.
    The connection remains in the same
    state.[¶](#section-3.5.2-4.2.2){.pilcrow}
    :::

3.  ::: {#section-3.5.2-4.3}
    If the connection is in a synchronized state (ESTABLISHED,
    FIN-WAIT-1, FIN-WAIT-2, CLOSE-WAIT, CLOSING, LAST-ACK, TIME-WAIT),
    any unacceptable segment (out-of-window sequence number or
    unacceptable acknowledgment number) must be responded to with an
    empty acknowledgment segment (without any user data) containing the
    current send sequence number and an acknowledgment indicating the
    next sequence number expected to be received, and the connection
    remains in the same state.[¶](#section-3.5.2-4.3.1){.pilcrow}

    If an incoming segment has a security level or compartment that does
    not exactly match the level and compartment requested for the
    connection, a reset is sent and the connection goes to the CLOSED
    state. The reset takes its sequence number from the ACK field of the
    incoming segment.[¶](#section-3.5.2-4.3.2){.pilcrow}
    :::
:::

::: {#section-3.5.3 .section}
#### [3.5.3.](#section-3.5.3){.section-number .selfRef} [Reset Processing](#name-reset-processing){.section-name .selfRef} {#name-reset-processing}

In all states except SYN-SENT, all reset (RST) segments are validated by
checking their SEQ fields. A reset is valid if its sequence number is in
the window. In the SYN-SENT state (a RST received in response to an
initial SYN), the RST is acceptable if the ACK field acknowledges the
SYN.[¶](#section-3.5.3-1){.pilcrow}

The receiver of a RST first validates it, then changes state. If the
receiver was in the LISTEN state, it ignores it. If the receiver was in
SYN-RECEIVED state and had previously been in the LISTEN state, then the
receiver returns to the LISTEN state; otherwise, the receiver aborts the
connection and goes to the CLOSED state. If the receiver was in any
other state, it aborts the connection and advises the user and goes to
the CLOSED state.[¶](#section-3.5.3-2){.pilcrow}

TCP implementations [SHOULD]{.bcp14} allow a received RST segment to
include data (SHLD-2). It has been suggested that a RST segment could
contain diagnostic data that explains the cause of the RST. No standard
has yet been established for such data.[¶](#section-3.5.3-3){.pilcrow}
:::
:::

::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [Closing a Connection](#name-closing-a-connection){.section-name .selfRef} {#name-closing-a-connection}

CLOSE is an operation meaning \"I have no more data to send.\" The
notion of closing a full-duplex connection is subject to ambiguous
interpretation, of course, since it may not be obvious how to treat the
receiving side of the connection. We have chosen to treat CLOSE in a
simplex fashion. The user who CLOSEs may continue to RECEIVE until the
TCP receiver is told that the remote peer has CLOSED also. Thus, a
program could initiate several SENDs followed by a CLOSE, and then
continue to RECEIVE until signaled that a RECEIVE failed because the
remote peer has CLOSED. The TCP implementation will signal a user, even
if no RECEIVEs are outstanding, that the remote peer has closed, so the
user can terminate their side gracefully. A TCP implementation will
reliably deliver all buffers SENT before the connection was CLOSED so a
user who expects no data in return need only wait to hear the connection
was CLOSED successfully to know that all their data was received at the
destination TCP endpoint. Users must keep reading connections they close
for sending until the TCP implementation indicates there is no more
data.[¶](#section-3.6-1){.pilcrow}

There are essentially three cases:[¶](#section-3.6-2){.pilcrow}

[]{.break}

1\)
:   The user initiates by telling the TCP implementation to CLOSE the
    connection (TCP Peer A in [Figure
    12](#normal_close){.xref}).[¶](#section-3.6-3.1){.pilcrow}
:   

2\)
:   The remote TCP endpoint initiates by sending a FIN control signal
    (TCP Peer B in [Figure
    12](#normal_close){.xref}).[¶](#section-3.6-3.2){.pilcrow}
:   

3\)
:   Both users CLOSE simultaneously ([Figure
    13](#simul_close){.xref}).[¶](#section-3.6-3.3){.pilcrow}
:   

[]{.break}

Case 1:

:   Local user initiates the close[¶](#section-3.6-4.2.1){.pilcrow}

    In this case, a FIN segment can be constructed and placed on the
    outgoing segment queue. No further SENDs from the user will be
    accepted by the TCP implementation, and it enters the FIN-WAIT-1
    state. RECEIVEs are allowed in this state. All segments preceding
    and including FIN will be retransmitted until acknowledged. When the
    other TCP peer has both acknowledged the FIN and sent a FIN of its
    own, the first TCP peer can ACK this FIN. Note that a TCP endpoint
    receiving a FIN will ACK but not send its own FIN until its user has
    CLOSED the connection also.[¶](#section-3.6-4.2.2){.pilcrow}

:   

Case 2:

:   TCP endpoint receives a FIN from the
    network[¶](#section-3.6-4.4.1){.pilcrow}

    If an unsolicited FIN arrives from the network, the receiving TCP
    endpoint can ACK it and tell the user that the connection is
    closing. The user will respond with a CLOSE, upon which the TCP
    endpoint can send a FIN to the other TCP peer after sending any
    remaining data. The TCP endpoint then waits until its own FIN is
    acknowledged whereupon it deletes the connection. If an ACK is not
    forthcoming, after the user timeout the connection is aborted and
    the user is told.[¶](#section-3.6-4.4.2){.pilcrow}

:   

Case 3:

:   Both users close simultaneously[¶](#section-3.6-4.6.1){.pilcrow}

    A simultaneous CLOSE by users at both ends of a connection causes
    FIN segments to be exchanged ([Figure 13](#simul_close){.xref}).
    When all segments preceding the FINs have been processed and
    acknowledged, each TCP peer can ACK the FIN it has received. Both
    will, upon receiving these ACKs, delete the
    connection.[¶](#section-3.6-4.6.2){.pilcrow}

:   

[]{#name-normal-close-sequence}

::: {#normal_close}
::: {#section-3.6-5.1 .alignLeft .art-text .artwork}
        TCP Peer A                                           TCP Peer B

    1.  ESTABLISHED                                          ESTABLISHED

    2.  (Close)
        FIN-WAIT-1  --> <SEQ=100><ACK=300><CTL=FIN,ACK>  --> CLOSE-WAIT

    3.  FIN-WAIT-2  <-- <SEQ=300><ACK=101><CTL=ACK>      <-- CLOSE-WAIT

    4.                                                       (Close)
        TIME-WAIT   <-- <SEQ=300><ACK=101><CTL=FIN,ACK>  <-- LAST-ACK

    5.  TIME-WAIT   --> <SEQ=101><ACK=301><CTL=ACK>      --> CLOSED

    6.  (2 MSL)
        CLOSED
:::

[Figure 12](#figure-12){.selfRef}: [Normal Close
Sequence](#name-normal-close-sequence){.selfRef}
:::

[]{#name-simultaneous-close-sequence}

::: {#simul_close}
::: {#section-3.6-6.1 .alignLeft .art-text .artwork}
        TCP Peer A                                           TCP Peer B

    1.  ESTABLISHED                                          ESTABLISHED

    2.  (Close)                                              (Close)
        FIN-WAIT-1  --> <SEQ=100><ACK=300><CTL=FIN,ACK>  ... FIN-WAIT-1
                    <-- <SEQ=300><ACK=100><CTL=FIN,ACK>  <--
                    ... <SEQ=100><ACK=300><CTL=FIN,ACK>  -->

    3.  CLOSING     --> <SEQ=101><ACK=301><CTL=ACK>      ... CLOSING
                    <-- <SEQ=301><ACK=101><CTL=ACK>      <--
                    ... <SEQ=101><ACK=301><CTL=ACK>      -->

    4.  TIME-WAIT                                            TIME-WAIT
        (2 MSL)                                              (2 MSL)
        CLOSED                                               CLOSED
:::

[Figure 13](#figure-13){.selfRef}: [Simultaneous Close
Sequence](#name-simultaneous-close-sequence){.selfRef}
:::

A TCP connection may terminate in two ways: (1) the normal TCP close
sequence using a FIN handshake ([Figure 12](#normal_close){.xref}), and
(2) an \"abort\" in which one or more RST segments are sent and the
connection state is immediately discarded. If the local TCP connection
is closed by the remote side due to a FIN or RST received from the
remote side, then the local application [MUST]{.bcp14} be informed
whether it closed normally or was aborted
(MUST-12).[¶](#section-3.6-7){.pilcrow}

::: {#section-3.6.1 .section}
#### [3.6.1.](#section-3.6.1){.section-number .selfRef} [Half-Closed Connections](#name-half-closed-connections){.section-name .selfRef} {#name-half-closed-connections}

The normal TCP close sequence delivers buffered data reliably in both
directions. Since the two directions of a TCP connection are closed
independently, it is possible for a connection to be \"half closed\",
i.e., closed in only one direction, and a host is permitted to continue
sending data in the open direction on a half-closed
connection.[¶](#section-3.6.1-1){.pilcrow}

A host [MAY]{.bcp14} implement a \"half-duplex\" TCP close sequence, so
that an application that has called CLOSE cannot continue to read data
from the connection (MAY-1). If such a host issues a CLOSE call while
received data is still pending in the TCP connection, or if new data is
received after CLOSE is called, its TCP implementation [SHOULD]{.bcp14}
send a RST to show that data was lost (SHLD-3). See
\[[23](#RFC2525){.xref}\], [Section
2.17](https://www.rfc-editor.org/rfc/rfc2525#section-2.17){.relref} for
discussion.[¶](#section-3.6.1-2){.pilcrow}

When a connection is closed actively, it [MUST]{.bcp14} linger in the
TIME-WAIT state for a time 2xMSL (Maximum Segment Lifetime) (MUST-13).
However, it [MAY]{.bcp14} accept a new SYN from the remote TCP endpoint
to reopen the connection directly from TIME-WAIT state (MAY-2), if
it:[¶](#section-3.6.1-3){.pilcrow}

[]{.break}

\(1\)
:   assigns its initial sequence number for the new connection to be
    larger than the largest sequence number it used on the previous
    connection incarnation, and[¶](#section-3.6.1-4.1){.pilcrow}
:   

\(2\)
:   returns to TIME-WAIT state if the SYN turns out to be an old
    duplicate.[¶](#section-3.6.1-4.2){.pilcrow}
:   

When the TCP Timestamp Options are available, an improved algorithm is
described in \[[40](#RFC6191){.xref}\] in order to support higher
connection establishment rates. This algorithm for reducing TIME-WAIT is
a Best Current Practice that [SHOULD]{.bcp14} be implemented since
Timestamp Options are commonly used, and using them to reduce TIME-WAIT
provides benefits for busy Internet servers
(SHLD-4).[¶](#section-3.6.1-5){.pilcrow}
:::
:::

::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Segmentation](#name-segmentation){.section-name .selfRef} {#name-segmentation}

The term \"segmentation\" refers to the activity TCP performs when
ingesting a stream of bytes from a sending application and packetizing
that stream of bytes into TCP segments. Individual TCP segments often do
not correspond one-for-one to individual send (or socket write) calls
from the application. Applications may perform writes at the granularity
of messages in the upper-layer protocol, but TCP guarantees no
correlation between the boundaries of TCP segments sent and received and
the boundaries of the read or write buffers of user application data. In
some specific protocols, such as Remote Direct Memory Access (RDMA)
using Direct Data Placement (DDP) and Marker PDU Aligned Framing (MPA)
\[[34](#RFC5044){.xref}\], there are performance optimizations possible
when the relation between TCP segments and application data units can be
controlled, and MPA includes a specific mechanism for detecting and
verifying this relationship between TCP segments and application message
data structures, but this is specific to applications like RDMA. In
general, multiple goals influence the sizing of TCP segments created by
a TCP implementation.[¶](#section-3.7-1){.pilcrow}

Goals driving the sending of larger segments
include:[¶](#section-3.7-2){.pilcrow}

-   [Reducing the number of packets in flight within the
    network.[¶](#section-3.7-3.1){.pilcrow}]{#section-3.7-3.1}
-   [Increasing processing efficiency and potential performance by
    enabling a smaller number of interrupts and inter-layer
    interactions.[¶](#section-3.7-3.2){.pilcrow}]{#section-3.7-3.2}
-   [Limiting the overhead of TCP
    headers.[¶](#section-3.7-3.3){.pilcrow}]{#section-3.7-3.3}

Note that the performance benefits of sending larger segments may
decrease as the size increases, and there may be boundaries where
advantages are reversed. For instance, on some implementation
architectures, 1025 bytes within a segment could lead to worse
performance than 1024 bytes, due purely to data alignment on copy
operations.[¶](#section-3.7-4){.pilcrow}

Goals driving the sending of smaller segments
include:[¶](#section-3.7-5){.pilcrow}

-   [Avoiding sending a TCP segment that would result in an IP datagram
    larger than the smallest MTU along an IP network path because this
    results in either packet loss or packet fragmentation. Making
    matters worse, some firewalls or middleboxes may drop fragmented
    packets or ICMP messages related to
    fragmentation.[¶](#section-3.7-6.1){.pilcrow}]{#section-3.7-6.1}
-   [Preventing delays to the application data stream, especially when
    TCP is waiting on the application to generate more data, or when the
    application is waiting on an event or input from its peer in order
    to generate more
    data.[¶](#section-3.7-6.2){.pilcrow}]{#section-3.7-6.2}
-   [Enabling \"fate sharing\" between TCP segments and lower-layer data
    units (e.g., below IP, for links with cell or frame sizes smaller
    than the IP MTU).[¶](#section-3.7-6.3){.pilcrow}]{#section-3.7-6.3}

Towards meeting these competing sets of goals, TCP includes several
mechanisms, including the Maximum Segment Size Option, Path MTU
Discovery, the Nagle algorithm, and support for IPv6 Jumbograms, as
discussed in the following subsections.[¶](#section-3.7-7){.pilcrow}

::: {#mss}
::: {#section-3.7.1 .section}
#### [3.7.1.](#section-3.7.1){.section-number .selfRef} [Maximum Segment Size Option](#name-maximum-segment-size-option){.section-name .selfRef} {#name-maximum-segment-size-option}

TCP endpoints [MUST]{.bcp14} implement both sending and receiving the
MSS Option (MUST-14).[¶](#section-3.7.1-1){.pilcrow}

TCP implementations [SHOULD]{.bcp14} send an MSS Option in every SYN
segment when its receive MSS differs from the default 536 for IPv4 or
1220 for IPv6 (SHLD-5), and [MAY]{.bcp14} send it always
(MAY-3).[¶](#section-3.7.1-2){.pilcrow}

If an MSS Option is not received at connection setup, TCP
implementations [MUST]{.bcp14} assume a default send MSS of 536 (576 -
40) for IPv4 or 1220 (1280 - 60) for IPv6
(MUST-15).[¶](#section-3.7.1-3){.pilcrow}

The maximum size of a segment that a TCP endpoint really sends, the
\"effective send MSS\", [MUST]{.bcp14} be the smaller (MUST-16) of the
send MSS (that reflects the available reassembly buffer size at the
remote host, the EMTU_R \[[19](#RFC1122){.xref}\]) and the largest
transmission size permitted by the IP layer (EMTU_S
\[[19](#RFC1122){.xref}\]):[¶](#section-3.7.1-4){.pilcrow}

Eff.snd.MSS = min(SendMSS+20, MMS_S) - TCPhdrsize -
IPoptionsize[¶](#section-3.7.1-5){.pilcrow}

where:[¶](#section-3.7.1-6){.pilcrow}

-   [SendMSS is the MSS value received from the remote host, or the
    default 536 for IPv4 or 1220 for IPv6, if no MSS Option is
    received.[¶](#section-3.7.1-7.1){.pilcrow}]{#section-3.7.1-7.1}
-   [MMS_S is the maximum size for a transport-layer message that TCP
    may send.[¶](#section-3.7.1-7.2){.pilcrow}]{#section-3.7.1-7.2}
-   [TCPhdrsize is the size of the fixed TCP header and any options.
    This is 20 in the (rare) case that no options are present but may be
    larger if TCP Options are to be sent. Note that some options might
    not be included on all segments, but that for each segment sent, the
    sender should adjust the data length accordingly, within the
    Eff.snd.MSS.[¶](#section-3.7.1-7.3){.pilcrow}]{#section-3.7.1-7.3}
-   [IPoptionsize is the size of any IPv4 options or IPv6 extension
    headers associated with a TCP connection. Note that some options or
    extension headers might not be included on all packets, but that for
    each segment sent, the sender should adjust the data length
    accordingly, within the
    Eff.snd.MSS.[¶](#section-3.7.1-7.4){.pilcrow}]{#section-3.7.1-7.4}

The MSS value to be sent in an MSS Option should be equal to the
effective MTU minus the fixed IP and TCP headers. By ignoring both IP
and TCP Options when calculating the value for the MSS Option, if there
are any IP or TCP Options to be sent in a packet, then the sender must
decrease the size of the TCP data accordingly. RFC 6691
\[[43](#RFC6691){.xref}\] discusses this in greater
detail.[¶](#section-3.7.1-8){.pilcrow}

The MSS value to be sent in an MSS Option must be less than or equal
to:[¶](#section-3.7.1-9){.pilcrow}

MMS_R - 20[¶](#section-3.7.1-10){.pilcrow}

where MMS_R is the maximum size for a transport-layer message that can
be received (and reassembled at the IP layer) (MUST-67). TCP obtains
MMS_R and MMS_S from the IP layer; see the generic call GET_MAXSIZES in
Section
[3.4](https://www.rfc-editor.org/rfc/rfc1122#section-3.4){.relref} of
RFC 1122. These are defined in terms of their IP MTU equivalents, EMTU_R
and EMTU_S \[[19](#RFC1122){.xref}\].[¶](#section-3.7.1-11){.pilcrow}

When TCP is used in a situation where either the IP or TCP headers are
not fixed, the sender must reduce the amount of TCP data in any given
packet by the number of octets used by the IP and TCP options. This has
been a point of confusion historically, as explained in RFC 6691,
Section
[3.1](https://www.rfc-editor.org/rfc/rfc6691#section-3.1){.relref}.[¶](#section-3.7.1-12){.pilcrow}
:::
:::

::: {#pmtud}
::: {#section-3.7.2 .section}
#### [3.7.2.](#section-3.7.2){.section-number .selfRef} [Path MTU Discovery](#name-path-mtu-discovery){.section-name .selfRef} {#name-path-mtu-discovery}

A TCP implementation may be aware of the MTU on directly connected
links, but will rarely have insight about MTUs across an entire network
path. For IPv4, RFC 1122 recommends an IP-layer default effective MTU of
less than or equal to 576 for destinations not directly connected, and
for IPv6 this would be 1280. Using these fixed values limits TCP
connection performance and efficiency. Instead, implementation of Path
MTU Discovery (PMTUD) and Packetization Layer Path MTU Discovery
(PLPMTUD) is strongly recommended in order for TCP to improve
segmentation decisions. Both PMTUD and PLPMTUD help TCP choose segment
sizes that avoid both on-path (for IPv4) and source fragmentation (IPv4
and IPv6).[¶](#section-3.7.2-1){.pilcrow}

PMTUD for IPv4 \[[2](#RFC1191){.xref}\] or IPv6
\[[14](#RFC8201){.xref}\] is implemented in conjunction between TCP, IP,
and ICMP. It relies both on avoiding source fragmentation and setting
the IPv4 DF (don\'t fragment) flag, the latter to inhibit on-path
fragmentation. It relies on ICMP errors from routers along the path
whenever a segment is too large to traverse a link. Several adjustments
to a TCP implementation with PMTUD are described in RFC 2923 in order to
deal with problems experienced in practice \[[27](#RFC2923){.xref}\].
PLPMTUD \[[31](#RFC4821){.xref}\] is a Standards Track improvement to
PMTUD that relaxes the requirement for ICMP support across a path, and
improves performance in cases where ICMP is not consistently conveyed,
but still tries to avoid source fragmentation. The mechanisms in all
four of these RFCs are recommended to be included in TCP
implementations.[¶](#section-3.7.2-2){.pilcrow}

The TCP MSS Option specifies an upper bound for the size of packets that
can be received (see \[[43](#RFC6691){.xref}\]). Hence, setting the
value in the MSS Option too small can impact the ability for PMTUD or
PLPMTUD to find a larger path MTU. RFC 1191 discusses this implication
of many older TCP implementations setting the TCP MSS to 536
(corresponding to the IPv4 576 byte default MTU) for non-local
destinations, rather than deriving it from the MTUs of connected
interfaces as recommended.[¶](#section-3.7.2-3){.pilcrow}
:::
:::

::: {#section-3.7.3 .section}
#### [3.7.3.](#section-3.7.3){.section-number .selfRef} [Interfaces with Variable MTU Values](#name-interfaces-with-variable-mt){.section-name .selfRef} {#name-interfaces-with-variable-mt}

The effective MTU can sometimes vary, as when used with variable
compression, e.g., RObust Header Compression (ROHC)
\[[37](#RFC5795){.xref}\]. It is tempting for a TCP implementation to
advertise the largest possible MSS, to support the most efficient use of
compressed payloads. Unfortunately, some compression schemes
occasionally need to transmit full headers (and thus smaller payloads)
to resynchronize state at their endpoint compressors/decompressors. If
the largest MTU is used to calculate the value to advertise in the MSS
Option, TCP retransmission may interfere with compressor
resynchronization.[¶](#section-3.7.3-1){.pilcrow}

As a result, when the effective MTU of an interface varies
packet-to-packet, TCP implementations [SHOULD]{.bcp14} use the smallest
effective MTU of the interface to calculate the value to advertise in
the MSS Option (SHLD-6).[¶](#section-3.7.3-2){.pilcrow}
:::

::: {#nagle}
::: {#section-3.7.4 .section}
#### [3.7.4.](#section-3.7.4){.section-number .selfRef} [Nagle Algorithm](#name-nagle-algorithm){.section-name .selfRef} {#name-nagle-algorithm}

The \"Nagle algorithm\" was described in RFC 896
\[[17](#RFC0896){.xref}\] and was recommended in RFC 1122
\[[19](#RFC1122){.xref}\] for mitigation of an early problem of too many
small packets being generated. It has been implemented in most current
TCP code bases, sometimes with minor variations (see [Appendix
A.3](#minshall){.xref}).[¶](#section-3.7.4-1){.pilcrow}

If there is unacknowledged data (i.e., SND.NXT \> SND.UNA), then the
sending TCP endpoint buffers all user data (regardless of the PSH bit)
until the outstanding data has been acknowledged or until the TCP
endpoint can send a full-sized segment (Eff.snd.MSS
bytes).[¶](#section-3.7.4-2){.pilcrow}

A TCP implementation [SHOULD]{.bcp14} implement the Nagle algorithm to
coalesce short segments (SHLD-7). However, there [MUST]{.bcp14} be a way
for an application to disable the Nagle algorithm on an individual
connection (MUST-17). In all cases, sending data is also subject to the
limitation imposed by the slow start algorithm
\[[8](#RFC5681){.xref}\].[¶](#section-3.7.4-3){.pilcrow}

Since there can be problematic interactions between the Nagle algorithm
and delayed acknowledgments, some implementations use minor variations
of the Nagle algorithm, such as the one described in [Appendix
A.3](#minshall){.xref}.[¶](#section-3.7.4-4){.pilcrow}
:::
:::

::: {#section-3.7.5 .section}
#### [3.7.5.](#section-3.7.5){.section-number .selfRef} [IPv6 Jumbograms](#name-ipv6-jumbograms){.section-name .selfRef} {#name-ipv6-jumbograms}

In order to support TCP over IPv6 Jumbograms, implementations need to be
able to send TCP segments larger than the 64-KB limit that the MSS
Option can convey. RFC 2675 \[[24](#RFC2675){.xref}\] defines that an
MSS value of 65,535 bytes is to be treated as infinity, and Path MTU
Discovery \[[14](#RFC8201){.xref}\] is used to determine the actual
MSS.[¶](#section-3.7.5-1){.pilcrow}

The Jumbo Payload Option need not be implemented or understood by IPv6
nodes that do not support attachment to links with an MTU greater than
65,575 \[[24](#RFC2675){.xref}\], and the present IPv6 Node Requirements
does not include support for Jumbograms
\[[55](#RFC8504){.xref}\].[¶](#section-3.7.5-2){.pilcrow}
:::
:::

::: {#datacomm}
::: {#section-3.8 .section}
### [3.8.](#section-3.8){.section-number .selfRef} [Data Communication](#name-data-communication){.section-name .selfRef} {#name-data-communication}

Once the connection is established, data is communicated by the exchange
of segments. Because segments may be lost due to errors (checksum test
failure) or network congestion, TCP uses retransmission to ensure
delivery of every segment. Duplicate segments may arrive due to network
or TCP retransmission. As discussed in the section on sequence numbers
([Section 3.4](#sequence-numbers){.xref}), the TCP implementation
performs certain tests on the sequence and acknowledgment numbers in the
segments to verify their acceptability.[¶](#section-3.8-1){.pilcrow}

The sender of data keeps track of the next sequence number to use in the
variable SND.NXT. The receiver of data keeps track of the next sequence
number to expect in the variable RCV.NXT. The sender of data keeps track
of the oldest unacknowledged sequence number in the variable SND.UNA. If
the data flow is momentarily idle and all data sent has been
acknowledged, then the three variables will be
equal.[¶](#section-3.8-2){.pilcrow}

When the sender creates a segment and transmits it, the sender advances
SND.NXT. When the receiver accepts a segment, it advances RCV.NXT and
sends an acknowledgment. When the data sender receives an
acknowledgment, it advances SND.UNA. The extent to which the values of
these variables differ is a measure of the delay in the communication.
The amount by which the variables are advanced is the length of the data
and SYN or FIN flags in the segment. Note that, once in the ESTABLISHED
state, all segments must carry current acknowledgment
information.[¶](#section-3.8-3){.pilcrow}

The CLOSE user call implies a push function (see [Section
3.9.1](#user-api){.xref}), as does the FIN control flag in an incoming
segment.[¶](#section-3.8-4){.pilcrow}

::: {#RTO}
::: {#section-3.8.1 .section}
#### [3.8.1.](#section-3.8.1){.section-number .selfRef} [Retransmission Timeout](#name-retransmission-timeout){.section-name .selfRef} {#name-retransmission-timeout}

Because of the variability of the networks that compose an internetwork
system and the wide range of uses of TCP connections, the retransmission
timeout (RTO) must be dynamically
determined.[¶](#section-3.8.1-1){.pilcrow}

The RTO [MUST]{.bcp14} be computed according to the algorithm in
\[[10](#RFC6298){.xref}\], including Karn\'s algorithm for taking RTT
samples (MUST-18).[¶](#section-3.8.1-2){.pilcrow}

RFC 793 contains an early example procedure for computing the RTO, based
on work mentioned in IEN 177 \[[71](#IEN177){.xref}\]. This was then
replaced by the algorithm described in RFC 1122, which was subsequently
updated in RFC 2988 and then again in RFC
6298.[¶](#section-3.8.1-3){.pilcrow}

RFC 1122 allows that if a retransmitted packet is identical to the
original packet (which implies not only that the data boundaries have
not changed, but also that none of the headers have changed), then the
same IPv4 Identification field [MAY]{.bcp14} be used (see Section
[3.2.1.5](https://www.rfc-editor.org/rfc/rfc1122#section-3.2.1.5){.relref}
of RFC 1122) (MAY-4). The same IP Identification field may be reused
anyways since it is only meaningful when a datagram is fragmented
\[[44](#RFC6864){.xref}\]. TCP implementations should not rely on or
typically interact with this IPv4 header field in any way. It is not a
reasonable way to indicate duplicate sent segments nor to identify
duplicate received segments.[¶](#section-3.8.1-4){.pilcrow}
:::
:::

::: {#section-3.8.2 .section}
#### [3.8.2.](#section-3.8.2){.section-number .selfRef} [TCP Congestion Control](#name-tcp-congestion-control){.section-name .selfRef} {#name-tcp-congestion-control}

RFC 2914 \[[5](#RFC2914){.xref}\] explains the importance of congestion
control for the Internet.[¶](#section-3.8.2-1){.pilcrow}

RFC 1122 required implementation of Van Jacobson\'s congestion control
algorithms slow start and congestion avoidance together with exponential
backoff for successive RTO values for the same segment. RFC 2581
provided IETF Standards Track description of slow start and congestion
avoidance, along with fast retransmit and fast recovery. RFC 5681 is the
current description of these algorithms and is the current Standards
Track specification providing guidelines for TCP congestion control. RFC
6298 describes exponential backoff of RTO values, including keeping the
backed-off value until a subsequent segment with new data has been sent
and acknowledged without retransmission.[¶](#section-3.8.2-2){.pilcrow}

A TCP endpoint [MUST]{.bcp14} implement the basic congestion control
algorithms slow start, congestion avoidance, and exponential backoff of
RTO to avoid creating congestion collapse conditions (MUST-19). RFC 5681
and RFC 6298 describe the basic algorithms on the IETF Standards Track
that are broadly applicable. Multiple other suitable algorithms exist
and have been widely used. Many TCP implementations support a set of
alternative algorithms that can be configured for use on the endpoint.
An endpoint [MAY]{.bcp14} implement such alternative algorithms provided
that the algorithms are conformant with the TCP specifications from the
IETF Standards Track as described in RFC 2914, RFC 5033
\[[7](#RFC5033){.xref}\], and RFC 8961 \[[15](#RFC8961){.xref}\]
(MAY-18).[¶](#section-3.8.2-3){.pilcrow}

Explicit Congestion Notification (ECN) was defined in RFC 3168 and is an
IETF Standards Track enhancement that has many benefits
\[[51](#RFC8087){.xref}\].[¶](#section-3.8.2-4){.pilcrow}

A TCP endpoint [SHOULD]{.bcp14} implement ECN as described in RFC 3168
(SHLD-8).[¶](#section-3.8.2-5){.pilcrow}
:::

::: {#connfail}
::: {#section-3.8.3 .section}
#### [3.8.3.](#section-3.8.3){.section-number .selfRef} [TCP Connection Failures](#name-tcp-connection-failures){.section-name .selfRef} {#name-tcp-connection-failures}

Excessive retransmission of the same segment by a TCP endpoint indicates
some failure of the remote host or the internetwork path. This failure
may be of short or long duration. The following procedure [MUST]{.bcp14}
be used to handle excessive retransmissions of data segments
(MUST-20):[¶](#section-3.8.3-1){.pilcrow}

[]{.break}

\(a\)
:   There are two thresholds R1 and R2 measuring the amount of
    retransmission that has occurred for the same segment. R1 and R2
    might be measured in time units or as a count of retransmissions
    (with the current RTO and corresponding backoffs as a conversion
    factor, if needed).[¶](#section-3.8.3-2.1){.pilcrow}
:   

\(b\)
:   When the number of transmissions of the same segment reaches or
    exceeds threshold R1, pass negative advice (see [Section
    3.3.1.4](https://www.rfc-editor.org/rfc/rfc1122#section-3.3.1.4){.relref}
    of \[[19](#RFC1122){.xref}\]) to the IP layer, to trigger
    dead-gateway diagnosis.[¶](#section-3.8.3-2.2){.pilcrow}
:   

\(c\)
:   When the number of transmissions of the same segment reaches a
    threshold R2 greater than R1, close the
    connection.[¶](#section-3.8.3-2.3){.pilcrow}
:   

\(d\)
:   An application [MUST]{.bcp14} (MUST-21) be able to set the value for
    R2 for a particular connection. For example, an interactive
    application might set R2 to \"infinity\", giving the user control
    over when to disconnect.[¶](#section-3.8.3-2.4){.pilcrow}
:   

\(e\)
:   TCP implementations [SHOULD]{.bcp14} inform the application of the
    delivery problem (unless such information has been disabled by the
    application; see the \"Asynchronous Reports\" section ([Section
    3.9.1.8](#asynchronous-reports){.xref})), when R1 is reached and
    before R2 (SHLD-9). This will allow a remote login application
    program to inform the user, for
    example.[¶](#section-3.8.3-2.5){.pilcrow}
:   

The value of R1 [SHOULD]{.bcp14} correspond to at least 3
retransmissions, at the current RTO (SHLD-10). The value of R2
[SHOULD]{.bcp14} correspond to at least 100 seconds
(SHLD-11).[¶](#section-3.8.3-3){.pilcrow}

An attempt to open a TCP connection could fail with excessive
retransmissions of the SYN segment or by receipt of a RST segment or an
ICMP Port Unreachable. SYN retransmissions [MUST]{.bcp14} be handled in
the general way just described for data retransmissions, including
notification of the application layer.[¶](#section-3.8.3-4){.pilcrow}

However, the values of R1 and R2 may be different for SYN and data
segments. In particular, R2 for a SYN segment [MUST]{.bcp14} be set
large enough to provide retransmission of the segment for at least 3
minutes (MUST-23). The application can close the connection (i.e., give
up on the open attempt) sooner, of
course.[¶](#section-3.8.3-5){.pilcrow}
:::
:::

::: {#section-3.8.4 .section}
#### [3.8.4.](#section-3.8.4){.section-number .selfRef} [TCP Keep-Alives](#name-tcp-keep-alives){.section-name .selfRef} {#name-tcp-keep-alives}

A TCP connection is said to be \"idle\" if for some long amount of time
there have been no incoming segments received and there is no new or
unacknowledged data to be sent.[¶](#section-3.8.4-1){.pilcrow}

Implementers [MAY]{.bcp14} include \"keep-alives\" in their TCP
implementations (MAY-5), although this practice is not universally
accepted. Some TCP implementations, however, have included a keep-alive
mechanism. To confirm that an idle connection is still active, these
implementations send a probe segment designed to elicit a response from
the TCP peer. Such a segment generally contains SEG.SEQ = SND.NXT-1 and
may or may not contain one garbage octet of data. If keep-alives are
included, the application [MUST]{.bcp14} be able to turn them on or off
for each TCP connection (MUST-24), and they [MUST]{.bcp14} default to
off (MUST-25).[¶](#section-3.8.4-2){.pilcrow}

Keep-alive packets [MUST]{.bcp14} only be sent when no sent data is
outstanding, and no data or acknowledgment packets have been received
for the connection within an interval (MUST-26). This interval
[MUST]{.bcp14} be configurable (MUST-27) and [MUST]{.bcp14} default to
no less than two hours (MUST-28).[¶](#section-3.8.4-3){.pilcrow}

It is extremely important to remember that ACK segments that contain no
data are not reliably transmitted by TCP. Consequently, if a keep-alive
mechanism is implemented it [MUST NOT]{.bcp14} interpret failure to
respond to any specific probe as a dead connection
(MUST-29).[¶](#section-3.8.4-4){.pilcrow}

An implementation [SHOULD]{.bcp14} send a keep-alive segment with no
data (SHLD-12); however, it [MAY]{.bcp14} be configurable to send a
keep-alive segment containing one garbage octet (MAY-6), for
compatibility with erroneous TCP
implementations.[¶](#section-3.8.4-5){.pilcrow}
:::

::: {#urgent}
::: {#section-3.8.5 .section}
#### [3.8.5.](#section-3.8.5){.section-number .selfRef} [The Communication of Urgent Information](#name-the-communication-of-urgent){.section-name .selfRef} {#name-the-communication-of-urgent}

As a result of implementation differences and middlebox interactions,
new applications [SHOULD NOT]{.bcp14} employ the TCP urgent mechanism
(SHLD-13). However, TCP implementations [MUST]{.bcp14} still include
support for the urgent mechanism (MUST-30). Information on how some TCP
implementations interpret the urgent pointer can be found in RFC 6093
\[[39](#RFC6093){.xref}\].[¶](#section-3.8.5-1){.pilcrow}

The objective of the TCP urgent mechanism is to allow the sending user
to stimulate the receiving user to accept some urgent data and to permit
the receiving TCP endpoint to indicate to the receiving user when all
the currently known urgent data has been received by the
user.[¶](#section-3.8.5-2){.pilcrow}

This mechanism permits a point in the data stream to be designated as
the end of urgent information. Whenever this point is in advance of the
receive sequence number (RCV.NXT) at the receiving TCP endpoint, then
the TCP implementation must tell the user to go into \"urgent mode\";
when the receive sequence number catches up to the urgent pointer, the
TCP implementation must tell user to go into \"normal mode\". If the
urgent pointer is updated while the user is in \"urgent mode\", the
update will be invisible to the user.[¶](#section-3.8.5-3){.pilcrow}

The method employs an urgent field that is carried in all segments
transmitted. The URG control flag indicates that the urgent field is
meaningful and must be added to the segment sequence number to yield the
urgent pointer. The absence of this flag indicates that there is no
urgent data outstanding.[¶](#section-3.8.5-4){.pilcrow}

To send an urgent indication, the user must also send at least one data
octet. If the sending user also indicates a push, timely delivery of the
urgent information to the destination process is enhanced. Note that
because changes in the urgent pointer correspond to data being written
by a sending application, the urgent pointer cannot \"recede\" in the
sequence space, but a TCP receiver should be robust to invalid urgent
pointer values.[¶](#section-3.8.5-5){.pilcrow}

A TCP implementation [MUST]{.bcp14} support a sequence of urgent data of
any length (MUST-31)
\[[19](#RFC1122){.xref}\].[¶](#section-3.8.5-6){.pilcrow}

The urgent pointer [MUST]{.bcp14} point to the sequence number of the
octet following the urgent data
(MUST-62).[¶](#section-3.8.5-7){.pilcrow}

A TCP implementation [MUST]{.bcp14} (MUST-32) inform the application
layer asynchronously whenever it receives an urgent pointer and there
was previously no pending urgent data, or whenever the urgent pointer
advances in the data stream. The TCP implementation [MUST]{.bcp14}
(MUST-33) provide a way for the application to learn how much urgent
data remains to be read from the connection, or at least to determine
whether more urgent data remains to be read
\[[19](#RFC1122){.xref}\].[¶](#section-3.8.5-8){.pilcrow}
:::
:::

::: {#section-3.8.6 .section}
#### [3.8.6.](#section-3.8.6){.section-number .selfRef} [Managing the Window](#name-managing-the-window){.section-name .selfRef} {#name-managing-the-window}

The window sent in each segment indicates the range of sequence numbers
the sender of the window (the data receiver) is currently prepared to
accept. There is an assumption that this is related to the data buffer
space currently available for this
connection.[¶](#section-3.8.6-1){.pilcrow}

The sending TCP endpoint packages the data to be transmitted into
segments that fit the current window, and may repackage segments on the
retransmission queue. Such repackaging is not required but may be
helpful.[¶](#section-3.8.6-2){.pilcrow}

In a connection with a one-way data flow, the window information will be
carried in acknowledgment segments that all have the same sequence
number, so there will be no way to reorder them if they arrive out of
order. This is not a serious problem, but it will allow the window
information to be on occasion temporarily based on old reports from the
data receiver. A refinement to avoid this problem is to act on the
window information from segments that carry the highest acknowledgment
number (that is, segments with an acknowledgment number equal to or
greater than the highest previously
received).[¶](#section-3.8.6-3){.pilcrow}

Indicating a large window encourages transmissions. If more data arrives
than can be accepted, it will be discarded. This will result in
excessive retransmissions, adding unnecessarily to the load on the
network and the TCP endpoints. Indicating a small window may restrict
the transmission of data to the point of introducing a round-trip delay
between each new segment transmitted.[¶](#section-3.8.6-4){.pilcrow}

The mechanisms provided allow a TCP endpoint to advertise a large window
and to subsequently advertise a much smaller window without having
accepted that much data. This so-called \"shrinking the window\" is
strongly discouraged. The robustness principle \[[19](#RFC1122){.xref}\]
dictates that TCP peers will not shrink the window themselves, but will
be prepared for such behavior on the part of other TCP
peers.[¶](#section-3.8.6-5){.pilcrow}

A TCP receiver [SHOULD NOT]{.bcp14} shrink the window, i.e., move the
right window edge to the left (SHLD-14). However, a sending TCP peer
[MUST]{.bcp14} be robust against window shrinking, which may cause the
\"usable window\" (see [Section 3.8.6.2.1](#SWSsender){.xref}) to become
negative (MUST-34).[¶](#section-3.8.6-6){.pilcrow}

If this happens, the sender [SHOULD NOT]{.bcp14} send new data
(SHLD-15), but [SHOULD]{.bcp14} retransmit normally the old
unacknowledged data between SND.UNA and SND.UNA+SND.WND (SHLD-16). The
sender [MAY]{.bcp14} also retransmit old data beyond SND.UNA+SND.WND
(MAY-7), but [SHOULD NOT]{.bcp14} time out the connection if data beyond
the right window edge is not acknowledged (SHLD-17). If the window
shrinks to zero, the TCP implementation [MUST]{.bcp14} probe it in the
standard way (described below) (MUST-35).[¶](#section-3.8.6-7){.pilcrow}

::: {#zwp}
::: {#section-3.8.6.1 .section}
##### [3.8.6.1.](#section-3.8.6.1){.section-number .selfRef} [Zero-Window Probing](#name-zero-window-probing){.section-name .selfRef} {#name-zero-window-probing}

The sending TCP peer must regularly transmit at least one octet of new
data (if available), or retransmit to the receiving TCP peer even if the
send window is zero, in order to \"probe\" the window. This
retransmission is essential to guarantee that when either TCP peer has a
zero window the reopening of the window will be reliably reported to the
other. This is referred to as Zero-Window Probing (ZWP) in other
documents.[¶](#section-3.8.6.1-1){.pilcrow}

Probing of zero (offered) windows [MUST]{.bcp14} be supported
(MUST-36).[¶](#section-3.8.6.1-2){.pilcrow}

A TCP implementation [MAY]{.bcp14} keep its offered receive window
closed indefinitely (MAY-8). As long as the receiving TCP peer continues
to send acknowledgments in response to the probe segments, the sending
TCP peer [MUST]{.bcp14} allow the connection to stay open (MUST-37).
This enables TCP to function in scenarios such as the \"printer ran out
of paper\" situation described in [Section
4.2.2.17](https://www.rfc-editor.org/rfc/rfc1122#section-4.2.2.17){.relref}
of \[[19](#RFC1122){.xref}\]. The behavior is subject to the
implementation\'s resource management concerns, as noted in
\[[41](#RFC6429){.xref}\].[¶](#section-3.8.6.1-3){.pilcrow}

When the receiving TCP peer has a zero window and a segment arrives, it
must still send an acknowledgment showing its next expected sequence
number and current window (zero).[¶](#section-3.8.6.1-4){.pilcrow}

The transmitting host [SHOULD]{.bcp14} send the first zero-window probe
when a zero window has existed for the retransmission timeout period
(SHLD-29) ([Section 3.8.1](#RTO){.xref}), and [SHOULD]{.bcp14} increase
exponentially the interval between successive probes
(SHLD-30).[¶](#section-3.8.6.1-5){.pilcrow}
:::
:::

::: {#section-3.8.6.2 .section}
##### [3.8.6.2.](#section-3.8.6.2){.section-number .selfRef} [Silly Window Syndrome Avoidance](#name-silly-window-syndrome-avoid){.section-name .selfRef} {#name-silly-window-syndrome-avoid}

The \"Silly Window Syndrome\" (SWS) is a stable pattern of small
incremental window movements resulting in extremely poor TCP
performance. Algorithms to avoid SWS are described below for both the
sending side and the receiving side. RFC 1122 contains more detailed
discussion of the SWS problem. Note that the Nagle algorithm and the
sender SWS avoidance algorithm play complementary roles in improving
performance. The Nagle algorithm discourages sending tiny segments when
the data to be sent increases in small increments, while the SWS
avoidance algorithm discourages small segments resulting from the right
window edge advancing in small
increments.[¶](#section-3.8.6.2-1){.pilcrow}

::: {#SWSsender}
::: {#section-3.8.6.2.1 .section}
###### [3.8.6.2.1.](#section-3.8.6.2.1){.section-number .selfRef} [Sender\'s Algorithm \-- When to Send Data](#name-senders-algorithm-when-to-s){.section-name .selfRef} {#name-senders-algorithm-when-to-s}

A TCP implementation [MUST]{.bcp14} include a SWS avoidance algorithm in
the sender (MUST-38).[¶](#section-3.8.6.2.1-1){.pilcrow}

The Nagle algorithm from [Section 3.7.4](#nagle){.xref} additionally
describes how to coalesce short
segments.[¶](#section-3.8.6.2.1-2){.pilcrow}

The sender\'s SWS avoidance algorithm is more difficult than the
receiver\'s because the sender does not know (directly) the receiver\'s
total buffer space (RCV.BUFF). An approach that has been found to work
well is for the sender to calculate Max(SND.WND), which is the maximum
send window it has seen so far on the connection, and to use this value
as an estimate of RCV.BUFF. Unfortunately, this can only be an estimate;
the receiver may at any time reduce the size of RCV.BUFF. To avoid a
resulting deadlock, it is necessary to have a timeout to force
transmission of data, overriding the SWS avoidance algorithm. In
practice, this timeout should seldom
occur.[¶](#section-3.8.6.2.1-3){.pilcrow}

The \"usable window\" is:[¶](#section-3.8.6.2.1-4){.pilcrow}

U = SND.UNA + SND.WND - SND.NXT[¶](#section-3.8.6.2.1-5){.pilcrow}

i.e., the offered window less the amount of data sent but not
acknowledged. If D is the amount of data queued in the sending TCP
endpoint but not yet sent, then the following set of rules is
recommended.[¶](#section-3.8.6.2.1-6){.pilcrow}

Send data:[¶](#section-3.8.6.2.1-7){.pilcrow}

[]{.break}

\(1\)

:   if a maximum-sized segment can be sent, i.e.,
    if:[¶](#section-3.8.6.2.1-8.1.1){.pilcrow}

    min(D,U) >= Eff.snd.MSS;[¶](#section-3.8.6.2.1-8.1.2){.pilcrow}

:   

\(2\)

:   or if the data is pushed and all queued data can be sent now, i.e.,
    if:[¶](#section-3.8.6.2.1-8.2.1){.pilcrow}

    \[SND.NXT = SND.UNA and\] PUSHed and D \<=
    U[¶](#section-3.8.6.2.1-8.2.2){.pilcrow}

    (the bracketed condition is imposed by the Nagle
    algorithm);[¶](#section-3.8.6.2.1-8.2.3){.pilcrow}

:   

\(3\)

:   or if at least a fraction Fs of the maximum window can be sent,
    i.e., if:[¶](#section-3.8.6.2.1-8.3.1){.pilcrow}

    \[SND.NXT = SND.UNA and\][¶](#section-3.8.6.2.1-8.3.2){.pilcrow}

    min(D,U) >= Fs \*
    Max(SND.WND);[¶](#section-3.8.6.2.1-8.3.3){.pilcrow}

:   

\(4\)
:   or if the override timeout
    occurs.[¶](#section-3.8.6.2.1-8.4){.pilcrow}
:   

Here Fs is a fraction whose recommended value is 1/2. The override
timeout should be in the range 0.1 - 1.0 seconds. It may be convenient
to combine this timer with the timer used to probe zero windows
([Section 3.8.6.1](#zwp){.xref}).[¶](#section-3.8.6.2.1-9){.pilcrow}
:::
:::

::: {#section-3.8.6.2.2 .section}
###### [3.8.6.2.2.](#section-3.8.6.2.2){.section-number .selfRef} [Receiver\'s Algorithm \-- When to Send a Window Update](#name-receivers-algorithm-when-to){.section-name .selfRef} {#name-receivers-algorithm-when-to}

A TCP implementation [MUST]{.bcp14} include a SWS avoidance algorithm in
the receiver (MUST-39).[¶](#section-3.8.6.2.2-1){.pilcrow}

The receiver\'s SWS avoidance algorithm determines when the right window
edge may be advanced; this is customarily known as \"updating the
window\". This algorithm combines with the delayed ACK algorithm
([Section 3.8.6.3](#delACK){.xref}) to determine when an ACK segment
containing the current window will really be sent to the
receiver.[¶](#section-3.8.6.2.2-2){.pilcrow}

The solution to receiver SWS is to avoid advancing the right window edge
RCV.NXT+RCV.WND in small increments, even if data is received from the
network in small segments.[¶](#section-3.8.6.2.2-3){.pilcrow}

Suppose the total receive buffer space is RCV.BUFF. At any given moment,
RCV.USER octets of this total may be tied up with data that has been
received and acknowledged but that the user process has not yet
consumed. When the connection is quiescent, RCV.WND = RCV.BUFF and
RCV.USER = 0.[¶](#section-3.8.6.2.2-4){.pilcrow}

Keeping the right window edge fixed as data arrives and is acknowledged
requires that the receiver offer less than its full buffer space, i.e.,
the receiver must specify a RCV.WND that keeps RCV.NXT+RCV.WND constant
as RCV.NXT increases. Thus, the total buffer space RCV.BUFF is generally
divided into three parts:[¶](#section-3.8.6.2.2-5){.pilcrow}

::: {#section-3.8.6.2.2-6 .alignLeft .art-text .artwork}
                   |<------- RCV.BUFF ---------------->|
                        1             2            3
               ----|---------|------------------|------|----
                          RCV.NXT               ^
                                             (Fixed)

               1 - RCV.USER =  data received but not yet consumed;
               2 - RCV.WND =   space advertised to sender;
               3 - Reduction = space available but not yet
                               advertised.

[¶](#section-3.8.6.2.2-6){.pilcrow}
:::

The suggested SWS avoidance algorithm for the receiver is to keep
RCV.NXT+RCV.WND fixed until the reduction
satisfies:[¶](#section-3.8.6.2.2-7){.pilcrow}

::: {#section-3.8.6.2.2-8 .alignLeft .art-text .artwork}
                 RCV.BUFF - RCV.USER - RCV.WND  >=

                        min( Fr * RCV.BUFF, Eff.snd.MSS )

[¶](#section-3.8.6.2.2-8){.pilcrow}
:::

where Fr is a fraction whose recommended value is 1/2, and Eff.snd.MSS
is the effective send MSS for the connection (see [Section
3.7.1](#mss){.xref}). When the inequality is satisfied, RCV.WND is set
to RCV.BUFF-RCV.USER.[¶](#section-3.8.6.2.2-9){.pilcrow}

Note that the general effect of this algorithm is to advance RCV.WND in
increments of Eff.snd.MSS (for realistic receive buffers: Eff.snd.MSS \<
RCV.BUFF/2). Note also that the receiver must use its own Eff.snd.MSS,
making the assumption that it is the same as the
sender\'s.[¶](#section-3.8.6.2.2-10){.pilcrow}
:::
:::

::: {#delACK}
::: {#section-3.8.6.3 .section}
##### [3.8.6.3.](#section-3.8.6.3){.section-number .selfRef} [Delayed Acknowledgments \-- When to Send an ACK Segment](#name-delayed-acknowledgments-whe){.section-name .selfRef} {#name-delayed-acknowledgments-whe}

A host that is receiving a stream of TCP data segments can increase
efficiency in both the network and the hosts by sending fewer than one
ACK (acknowledgment) segment per data segment received; this is known as
a \"delayed ACK\".[¶](#section-3.8.6.3-1){.pilcrow}

A TCP endpoint [SHOULD]{.bcp14} implement a delayed ACK (SHLD-18), but
an ACK should not be excessively delayed; in particular, the delay
[MUST]{.bcp14} be less than 0.5 seconds (MUST-40). An ACK
[SHOULD]{.bcp14} be generated for at least every second full-sized
segment or 2\*RMSS bytes of new data (where RMSS is the MSS specified by
the TCP endpoint receiving the segments to be acknowledged, or the
default value if not specified) (SHLD-19). Excessive delays on ACKs can
disturb the round-trip timing and packet \"clocking\" algorithms. More
complete discussion of delayed ACK behavior is in Section
[4.2](https://www.rfc-editor.org/rfc/rfc5681#section-4.2){.relref} of
RFC 5681 \[[8](#RFC5681){.xref}\], including recommendations to
immediately acknowledge out-of-order segments, segments above a gap in
sequence space, or segments that fill all or part of a gap, in order to
accelerate loss recovery.[¶](#section-3.8.6.3-2){.pilcrow}

Note that there are several current practices that further lead to a
reduced number of ACKs, including generic receive offload (GRO)
\[[72](#offload){.xref}\], ACK compression, and ACK decimation
\[[28](#RFC3449){.xref}\].[¶](#section-3.8.6.3-3){.pilcrow}
:::
:::
:::
:::
:::

::: {#section-3.9 .section}
### [3.9.](#section-3.9){.section-number .selfRef} [Interfaces](#name-interfaces){.section-name .selfRef} {#name-interfaces}

There are of course two interfaces of concern: the user/TCP interface
and the TCP/lower-level interface. We have a fairly elaborate model of
the user/TCP interface, but the interface to the lower-level protocol
module is left unspecified here since it will be specified in detail by
the specification of the lower-level protocol. For the case that the
lower level is IP, we note some of the parameter values that TCP
implementations might use.[¶](#section-3.9-1){.pilcrow}

::: {#user-api}
::: {#section-3.9.1 .section}
#### [3.9.1.](#section-3.9.1){.section-number .selfRef} [User/TCP Interface](#name-user-tcp-interface){.section-name .selfRef} {#name-user-tcp-interface}

The following functional description of user commands to the TCP
implementation is, at best, fictional, since every operating system will
have different facilities. Consequently, we must warn readers that
different TCP implementations may have different user interfaces.
However, all TCP implementations must provide a certain minimum set of
services to guarantee that all TCP implementations can support the same
protocol hierarchy. This section specifies the functional interfaces
required of all TCP implementations.[¶](#section-3.9.1-1){.pilcrow}

[Section
3.1](https://www.rfc-editor.org/rfc/rfc8303#section-3.1){.relref} of
\[[53](#RFC8303){.xref}\] also identifies primitives provided by TCP and
could be used as an additional reference for
implementers.[¶](#section-3.9.1-2){.pilcrow}

The following sections functionally characterize a user/TCP interface.
The notation used is similar to most procedure or function calls in
high-level languages, but this usage is not meant to rule out trap-type
service calls.[¶](#section-3.9.1-3){.pilcrow}

The user commands described below specify the basic functions the TCP
implementation must perform to support interprocess communication.
Individual implementations must define their own exact format and may
provide combinations or subsets of the basic functions in single calls.
In particular, some implementations may wish to automatically OPEN a
connection on the first SEND or RECEIVE issued by the user for a given
connection.[¶](#section-3.9.1-4){.pilcrow}

In providing interprocess communication facilities, the TCP
implementation must not only accept commands, but must also return
information to the processes it serves. The latter consists
of:[¶](#section-3.9.1-5){.pilcrow}

[]{.break}

\(a\)
:   general information about a connection (e.g., interrupts, remote
    close, binding of unspecified remote
    socket).[¶](#section-3.9.1-6.1){.pilcrow}
:   

\(b\)
:   replies to specific user commands indicating success or various
    types of failure.[¶](#section-3.9.1-6.2){.pilcrow}
:   

::: {#section-3.9.1.1 .section}
##### [3.9.1.1.](#section-3.9.1.1){.section-number .selfRef} [Open](#name-open){.section-name .selfRef} {#name-open}

Format: OPEN (local port, remote socket, active/passive \[, timeout\]
\[, Diffserv field\] \[, security/compartment\] \[, local IP address\]
\[, options\]) -\> local connection
name[¶](#section-3.9.1.1-1){.pilcrow}

If the active/passive flag is set to passive, then this is a call to
LISTEN for an incoming connection. A passive OPEN may have either a
fully specified remote socket to wait for a particular connection or an
unspecified remote socket to wait for any call. A fully specified
passive call can be made active by the subsequent execution of a
SEND.[¶](#section-3.9.1.1-2){.pilcrow}

A transmission control block (TCB) is created and partially filled in
with data from the OPEN command
parameters.[¶](#section-3.9.1.1-3){.pilcrow}

Every passive OPEN call either creates a new connection record in LISTEN
state, or it returns an error; it [MUST NOT]{.bcp14} affect any
previously created connection record
(MUST-41).[¶](#section-3.9.1.1-4){.pilcrow}

A TCP implementation that supports multiple concurrent connections
[MUST]{.bcp14} provide an OPEN call that will functionally allow an
application to LISTEN on a port while a connection block with the same
local port is in SYN-SENT or SYN-RECEIVED state
(MUST-42).[¶](#section-3.9.1.1-5){.pilcrow}

On an active OPEN command, the TCP endpoint will begin the procedure to
synchronize (i.e., establish) the connection at
once.[¶](#section-3.9.1.1-6){.pilcrow}

The timeout, if present, permits the caller to set up a timeout for all
data submitted to TCP. If data is not successfully delivered to the
destination within the timeout period, the TCP endpoint will abort the
connection. The present global default is five
minutes.[¶](#section-3.9.1.1-7){.pilcrow}

The TCP implementation or some component of the operating system will
verify the user\'s authority to open a connection with the specified
Diffserv field value or security/compartment. The absence of a Diffserv
field value or security/compartment specification in the OPEN call
indicates the default values must be
used.[¶](#section-3.9.1.1-8){.pilcrow}

TCP will accept incoming requests as matching only if the
security/compartment information is exactly the same as that requested
in the OPEN call.[¶](#section-3.9.1.1-9){.pilcrow}

The Diffserv field value indicated by the user only impacts outgoing
packets, may be altered en route through the network, and has no direct
bearing or relation to received
packets.[¶](#section-3.9.1.1-10){.pilcrow}

A local connection name will be returned to the user by the TCP
implementation. The local connection name can then be used as a
shorthand term for the connection defined by the \<local socket, remote
socket> pair.[¶](#section-3.9.1.1-11){.pilcrow}

The optional \"local IP address\" parameter [MUST]{.bcp14} be supported
to allow the specification of the local IP address (MUST-43). This
enables applications that need to select the local IP address used when
multihoming is present.[¶](#section-3.9.1.1-12){.pilcrow}

A passive OPEN call with a specified \"local IP address\" parameter will
await an incoming connection request to that address. If the parameter
is unspecified, a passive OPEN will await an incoming connection request
to any local IP address and then bind the local IP address of the
connection to the particular address that is
used.[¶](#section-3.9.1.1-13){.pilcrow}

For an active OPEN call, a specified \"local IP address\" parameter will
be used for opening the connection. If the parameter is unspecified, the
host will choose an appropriate local IP address (see RFC 1122, Section
[3.3.4.2](https://www.rfc-editor.org/rfc/rfc1122#section-3.3.4.2){.relref}).[¶](#section-3.9.1.1-14){.pilcrow}

If an application on a multihomed host does not specify the local IP
address when actively opening a TCP connection, then the TCP
implementation [MUST]{.bcp14} ask the IP layer to select a local IP
address before sending the (first) SYN (MUST-44). See the function
GET_SRCADDR() in Section
[3.4](https://www.rfc-editor.org/rfc/rfc1122#section-3.4){.relref} of
RFC 1122.[¶](#section-3.9.1.1-15){.pilcrow}

At all other times, a previous segment has either been sent or received
on this connection, and TCP implementations [MUST]{.bcp14} use the same
local address that was used in those previous segments
(MUST-45).[¶](#section-3.9.1.1-16){.pilcrow}

A TCP implementation [MUST]{.bcp14} reject as an error a local OPEN call
for an invalid remote IP address (e.g., a broadcast or multicast
address) (MUST-46).[¶](#section-3.9.1.1-17){.pilcrow}
:::

::: {#section-3.9.1.2 .section}
##### [3.9.1.2.](#section-3.9.1.2){.section-number .selfRef} [Send](#name-send){.section-name .selfRef} {#name-send}

Format: SEND (local connection name, buffer address, byte count, URGENT
flag \[, PUSH flag\] \[, timeout\])[¶](#section-3.9.1.2-1){.pilcrow}

This call causes the data contained in the indicated user buffer to be
sent on the indicated connection. If the connection has not been opened,
the SEND is considered an error. Some implementations may allow users to
SEND first; in which case, an automatic OPEN would be done. For example,
this might be one way for application data to be included in SYN
segments. If the calling process is not authorized to use this
connection, an error is returned.[¶](#section-3.9.1.2-2){.pilcrow}

A TCP endpoint [MAY]{.bcp14} implement PUSH flags on SEND calls
(MAY-15). If PUSH flags are not implemented, then the sending TCP peer:
(1) [MUST NOT]{.bcp14} buffer data indefinitely (MUST-60), and (2)
[MUST]{.bcp14} set the PSH bit in the last buffered segment (i.e., when
there is no more queued data to be sent) (MUST-61). The remaining
description below assumes the PUSH flag is supported on SEND
calls.[¶](#section-3.9.1.2-3){.pilcrow}

If the PUSH flag is set, the application intends the data to be
transmitted promptly to the receiver, and the PSH bit will be set in the
last TCP segment created from the
buffer.[¶](#section-3.9.1.2-4){.pilcrow}

The PSH bit is not a record marker and is independent of segment
boundaries. The transmitter [SHOULD]{.bcp14} collapse successive bits
when it packetizes data, to send the largest possible segment
(SHLD-27).[¶](#section-3.9.1.2-5){.pilcrow}

If the PUSH flag is not set, the data may be combined with data from
subsequent SENDs for transmission efficiency. When an application issues
a series of SEND calls without setting the PUSH flag, the TCP
implementation [MAY]{.bcp14} aggregate the data internally without
sending it (MAY-16). Note that when the Nagle algorithm is in use, TCP
implementations may buffer the data before sending, without regard to
the PUSH flag (see [Section
3.7.4](#nagle){.xref}).[¶](#section-3.9.1.2-6){.pilcrow}

An application program is logically required to set the PUSH flag in a
SEND call whenever it needs to force delivery of the data to avoid a
communication deadlock. However, a TCP implementation [SHOULD]{.bcp14}
send a maximum-sized segment whenever possible (SHLD-28) to improve
performance (see [Section
3.8.6.2.1](#SWSsender){.xref}).[¶](#section-3.9.1.2-7){.pilcrow}

New applications [SHOULD NOT]{.bcp14} set the URGENT flag
\[[39](#RFC6093){.xref}\] due to implementation differences and
middlebox issues (SHLD-13).[¶](#section-3.9.1.2-8){.pilcrow}

If the URGENT flag is set, segments sent to the destination TCP peer
will have the urgent pointer set. The receiving TCP peer will signal the
urgent condition to the receiving process if the urgent pointer
indicates that data preceding the urgent pointer has not been consumed
by the receiving process. The purpose of the URGENT flag is to stimulate
the receiver to process the urgent data and to indicate to the receiver
when all the currently known urgent data has been received. The number
of times the sending user\'s TCP implementation signals urgent will not
necessarily be equal to the number of times the receiving user will be
notified of the presence of urgent
data.[¶](#section-3.9.1.2-9){.pilcrow}

If no remote socket was specified in the OPEN, but the connection is
established (e.g., because a LISTENing connection has become specific
due to a remote segment arriving for the local socket), then the
designated buffer is sent to the implied remote socket. Users who make
use of OPEN with an unspecified remote socket can make use of SEND
without ever explicitly knowing the remote socket
address.[¶](#section-3.9.1.2-10){.pilcrow}

However, if a SEND is attempted before the remote socket becomes
specified, an error will be returned. Users can use the STATUS call to
determine the status of the connection. Some TCP implementations may
notify the user when an unspecified socket is
bound.[¶](#section-3.9.1.2-11){.pilcrow}

If a timeout is specified, the current user timeout for this connection
is changed to the new one.[¶](#section-3.9.1.2-12){.pilcrow}

In the simplest implementation, SEND would not return control to the
sending process until either the transmission was complete or the
timeout had been exceeded. However, this simple method is both subject
to deadlocks (for example, both sides of the connection might try to do
SENDs before doing any RECEIVEs) and offers poor performance, so it is
not recommended. A more sophisticated implementation would return
immediately to allow the process to run concurrently with network I/O,
and, furthermore, to allow multiple SENDs to be in progress. Multiple
SENDs are served in first come, first served order, so the TCP endpoint
will queue those it cannot service
immediately.[¶](#section-3.9.1.2-13){.pilcrow}

We have implicitly assumed an asynchronous user interface in which a
SEND later elicits some kind of SIGNAL or pseudo-interrupt from the
serving TCP endpoint. An alternative is to return a response
immediately. For instance, SENDs might return immediate local
acknowledgment, even if the segment sent had not been acknowledged by
the distant TCP endpoint. We could optimistically assume eventual
success. If we are wrong, the connection will close anyway due to the
timeout. In implementations of this kind (synchronous), there will still
be some asynchronous signals, but these will deal with the connection
itself, and not with specific segments or
buffers.[¶](#section-3.9.1.2-14){.pilcrow}

In order for the process to distinguish among error or success
indications for different SENDs, it might be appropriate for the buffer
address to be returned along with the coded response to the SEND
request. TCP-to-user signals are discussed below, indicating the
information that should be returned to the calling
process.[¶](#section-3.9.1.2-15){.pilcrow}
:::

::: {#section-3.9.1.3 .section}
##### [3.9.1.3.](#section-3.9.1.3){.section-number .selfRef} [Receive](#name-receive){.section-name .selfRef} {#name-receive}

Format: RECEIVE (local connection name, buffer address, byte count) -\>
byte count, URGENT flag \[, PUSH flag\][¶](#section-3.9.1.3-1){.pilcrow}

This command allocates a receiving buffer associated with the specified
connection. If no OPEN precedes this command or the calling process is
not authorized to use this connection, an error is
returned.[¶](#section-3.9.1.3-2){.pilcrow}

In the simplest implementation, control would not return to the calling
program until either the buffer was filled or some error occurred, but
this scheme is highly subject to deadlocks. A more sophisticated
implementation would permit several RECEIVEs to be outstanding at once.
These would be filled as segments arrive. This strategy permits
increased throughput at the cost of a more elaborate scheme (possibly
asynchronous) to notify the calling program that a PUSH has been seen or
a buffer filled.[¶](#section-3.9.1.3-3){.pilcrow}

A TCP receiver [MAY]{.bcp14} pass a received PSH bit to the application
layer via the PUSH flag in the interface (MAY-17), but it is not
required (this was clarified in RFC 1122, Section
[4.2.2.2](https://www.rfc-editor.org/rfc/rfc1122#section-4.2.2.2){.relref}).
The remainder of text describing the RECEIVE call below assumes that
passing the PUSH indication is
supported.[¶](#section-3.9.1.3-4){.pilcrow}

If enough data arrive to fill the buffer before a PUSH is seen, the PUSH
flag will not be set in the response to the RECEIVE. The buffer will be
filled with as much data as it can hold. If a PUSH is seen before the
buffer is filled, the buffer will be returned partially filled and PUSH
indicated.[¶](#section-3.9.1.3-5){.pilcrow}

If there is urgent data, the user will have been informed as soon as it
arrived via a TCP-to-user signal. The receiving user should thus be in
\"urgent mode\". If the URGENT flag is on, additional urgent data
remains. If the URGENT flag is off, this call to RECEIVE has returned
all the urgent data, and the user may now leave \"urgent mode\". Note
that data following the urgent pointer (non-urgent data) cannot be
delivered to the user in the same buffer with preceding urgent data
unless the boundary is clearly marked for the
user.[¶](#section-3.9.1.3-6){.pilcrow}

To distinguish among several outstanding RECEIVEs and to take care of
the case that a buffer is not completely filled, the return code is
accompanied by both a buffer pointer and a byte count indicating the
actual length of the data received.[¶](#section-3.9.1.3-7){.pilcrow}

Alternative implementations of RECEIVE might have the TCP endpoint
allocate buffer storage, or the TCP endpoint might share a ring buffer
with the user.[¶](#section-3.9.1.3-8){.pilcrow}
:::

::: {#section-3.9.1.4 .section}
##### [3.9.1.4.](#section-3.9.1.4){.section-number .selfRef} [Close](#name-close){.section-name .selfRef} {#name-close}

Format: CLOSE (local connection name)[¶](#section-3.9.1.4-1){.pilcrow}

This command causes the connection specified to be closed. If the
connection is not open or the calling process is not authorized to use
this connection, an error is returned. Closing connections is intended
to be a graceful operation in the sense that outstanding SENDs will be
transmitted (and retransmitted), as flow control permits, until all have
been serviced. Thus, it should be acceptable to make several SEND calls,
followed by a CLOSE, and expect all the data to be sent to the
destination. It should also be clear that users should continue to
RECEIVE on CLOSING connections since the remote peer may be trying to
transmit the last of its data. Thus, CLOSE means \"I have no more to
send\" but does not mean \"I will not receive any more.\" It may happen
(if the user-level protocol is not well thought out) that the closing
side is unable to get rid of all its data before timing out. In this
event, CLOSE turns into ABORT, and the closing TCP peer gives
up.[¶](#section-3.9.1.4-2){.pilcrow}

The user may CLOSE the connection at any time on their own initiative,
or in response to various prompts from the TCP implementation (e.g.,
remote close executed, transmission timeout exceeded, destination
inaccessible).[¶](#section-3.9.1.4-3){.pilcrow}

Because closing a connection requires communication with the remote TCP
peer, connections may remain in the closing state for a short time.
Attempts to reopen the connection before the TCP peer replies to the
CLOSE command will result in error
responses.[¶](#section-3.9.1.4-4){.pilcrow}

Close also implies push function.[¶](#section-3.9.1.4-5){.pilcrow}
:::

::: {#section-3.9.1.5 .section}
##### [3.9.1.5.](#section-3.9.1.5){.section-number .selfRef} [Status](#name-status){.section-name .selfRef} {#name-status}

Format: STATUS (local connection name) -\> status
data[¶](#section-3.9.1.5-1){.pilcrow}

This is an implementation-dependent user command and could be excluded
without adverse effect. Information returned would typically come from
the TCB associated with the connection.[¶](#section-3.9.1.5-2){.pilcrow}

This command returns a data block containing the following
information:[¶](#section-3.9.1.5-3){.pilcrow}

-   [local
    socket,[¶](#section-3.9.1.5-4.1){.pilcrow}]{#section-3.9.1.5-4.1}
-   [remote
    socket,[¶](#section-3.9.1.5-4.2){.pilcrow}]{#section-3.9.1.5-4.2}
-   [local connection
    name,[¶](#section-3.9.1.5-4.3){.pilcrow}]{#section-3.9.1.5-4.3}
-   [receive
    window,[¶](#section-3.9.1.5-4.4){.pilcrow}]{#section-3.9.1.5-4.4}
-   [send
    window,[¶](#section-3.9.1.5-4.5){.pilcrow}]{#section-3.9.1.5-4.5}
-   [connection
    state,[¶](#section-3.9.1.5-4.6){.pilcrow}]{#section-3.9.1.5-4.6}
-   [number of buffers awaiting
    acknowledgment,[¶](#section-3.9.1.5-4.7){.pilcrow}]{#section-3.9.1.5-4.7}
-   [number of buffers pending
    receipt,[¶](#section-3.9.1.5-4.8){.pilcrow}]{#section-3.9.1.5-4.8}
-   [urgent
    state,[¶](#section-3.9.1.5-4.9){.pilcrow}]{#section-3.9.1.5-4.9}
-   [Diffserv field
    value,[¶](#section-3.9.1.5-4.10){.pilcrow}]{#section-3.9.1.5-4.10}
-   [security/compartment,
    and[¶](#section-3.9.1.5-4.11){.pilcrow}]{#section-3.9.1.5-4.11}
-   [transmission
    timeout.[¶](#section-3.9.1.5-4.12){.pilcrow}]{#section-3.9.1.5-4.12}

Depending on the state of the connection, or on the implementation
itself, some of this information may not be available or meaningful. If
the calling process is not authorized to use this connection, an error
is returned. This prevents unauthorized processes from gaining
information about a connection.[¶](#section-3.9.1.5-5){.pilcrow}
:::

::: {#section-3.9.1.6 .section}
##### [3.9.1.6.](#section-3.9.1.6){.section-number .selfRef} [Abort](#name-abort){.section-name .selfRef} {#name-abort}

Format: ABORT (local connection name)[¶](#section-3.9.1.6-1){.pilcrow}

This command causes all pending SENDs and RECEIVES to be aborted, the
TCB to be removed, and a special RST message to be sent to the remote
TCP peer of the connection. Depending on the implementation, users may
receive abort indications for each outstanding SEND or RECEIVE, or may
simply receive an ABORT-acknowledgment.[¶](#section-3.9.1.6-2){.pilcrow}
:::

::: {#section-3.9.1.7 .section}
##### [3.9.1.7.](#section-3.9.1.7){.section-number .selfRef} [Flush](#name-flush){.section-name .selfRef} {#name-flush}

Some TCP implementations have included a FLUSH call, which will empty
the TCP send queue of any data that the user has issued SEND calls for
but is still to the right of the current send window. That is, it
flushes as much queued send data as possible without losing sequence
number synchronization. The FLUSH call [MAY]{.bcp14} be implemented
(MAY-14).[¶](#section-3.9.1.7-1){.pilcrow}
:::

::: {#asynchronous-reports}
::: {#section-3.9.1.8 .section}
##### [3.9.1.8.](#section-3.9.1.8){.section-number .selfRef} [Asynchronous Reports](#name-asynchronous-reports){.section-name .selfRef} {#name-asynchronous-reports}

There [MUST]{.bcp14} be a mechanism for reporting soft TCP error
conditions to the application (MUST-47). Generically, we assume this
takes the form of an application-supplied ERROR_REPORT routine that may
be upcalled asynchronously from the transport
layer:[¶](#section-3.9.1.8-1){.pilcrow}

-   [ERROR_REPORT(local connection name, reason,
    subreason)[¶](#section-3.9.1.8-2.1){.pilcrow}]{#section-3.9.1.8-2.1}

The precise encoding of the reason and subreason parameters is not
specified here. However, the conditions that are reported asynchronously
to the application [MUST]{.bcp14}
include:[¶](#section-3.9.1.8-3){.pilcrow}

-   [ICMP error message arrived (see [Section 3.9.2.2](#icmp){.xref} for
    description of handling each ICMP message type since some message
    types need to be suppressed from generating reports to the
    application)[¶](#section-3.9.1.8-4.1){.pilcrow}]{#section-3.9.1.8-4.1}
-   [Excessive retransmissions (see [Section
    3.8.3](#connfail){.xref})[¶](#section-3.9.1.8-4.2){.pilcrow}]{#section-3.9.1.8-4.2}
-   [Urgent pointer advance (see [Section
    3.8.5](#urgent){.xref})[¶](#section-3.9.1.8-4.3){.pilcrow}]{#section-3.9.1.8-4.3}

However, an application program that does not want to receive such
ERROR_REPORT calls [SHOULD]{.bcp14} be able to effectively disable these
calls (SHLD-20).[¶](#section-3.9.1.8-5){.pilcrow}
:::
:::

::: {#section-3.9.1.9 .section}
##### [3.9.1.9.](#section-3.9.1.9){.section-number .selfRef} [Set Differentiated Services Field (IPv4 TOS or IPv6 Traffic Class)](#name-set-differentiated-services){.section-name .selfRef} {#name-set-differentiated-services}

The application layer [MUST]{.bcp14} be able to specify the
Differentiated Services field for segments that are sent on a connection
(MUST-48). The Differentiated Services field includes the 6-bit
Differentiated Services Codepoint (DSCP) value. It is not required, but
the application [SHOULD]{.bcp14} be able to change the Differentiated
Services field during the connection lifetime (SHLD-21). TCP
implementations [SHOULD]{.bcp14} pass the current Differentiated
Services field value without change to the IP layer, when it sends
segments on the connection (SHLD-22).[¶](#section-3.9.1.9-1){.pilcrow}

The Differentiated Services field will be specified independently in
each direction on the connection, so that the receiver application will
specify the Differentiated Services field used for ACK
segments.[¶](#section-3.9.1.9-2){.pilcrow}

TCP implementations [MAY]{.bcp14} pass the most recently received
Differentiated Services field up to the application
(MAY-9).[¶](#section-3.9.1.9-3){.pilcrow}
:::
:::
:::

::: {#section-3.9.2 .section}
#### [3.9.2.](#section-3.9.2){.section-number .selfRef} [TCP/Lower-Level Interface](#name-tcp-lower-level-interface){.section-name .selfRef} {#name-tcp-lower-level-interface}

The TCP endpoint calls on a lower-level protocol module to actually send
and receive information over a network. The two current standard
Internet Protocol (IP) versions layered below TCP are IPv4
\[[1](#RFC0791){.xref}\] and IPv6
\[[13](#RFC8200){.xref}\].[¶](#section-3.9.2-1){.pilcrow}

If the lower-level protocol is IPv4, it provides arguments for a type of
service (used within the Differentiated Services field) and for a time
to live. TCP uses the following settings for these
parameters:[¶](#section-3.9.2-2){.pilcrow}

[]{.break}

Diffserv field:
:   The IP header value for the Diffserv field is given by the user.
    This includes the bits of the Diffserv Codepoint
    (DSCP).[¶](#section-3.9.2-3.2){.pilcrow}
:   

Time to Live (TTL):

:   The TTL value used to send TCP segments [MUST]{.bcp14} be
    configurable (MUST-49).[¶](#section-3.9.2-3.4.1){.pilcrow}

    -   [Note that RFC 793 specified one minute (60 seconds) as a
        constant for the TTL because the assumed maximum segment
        lifetime was two minutes. This was intended to explicitly ask
        that a segment be destroyed if it could not be delivered by the
        internet system within one minute. RFC 1122 updated RFC 793 to
        require that the TTL be
        configurable.[¶](#section-3.9.2-3.4.2.1){.pilcrow}]{#section-3.9.2-3.4.2.1}
    -   [Note that the Diffserv field is permitted to change during a
        connection (Section
        [4.2.4.2](https://www.rfc-editor.org/rfc/rfc1122#section-4.2.4.2){.relref}
        of RFC 1122). However, the application interface might not
        support this ability, and the application does not have
        knowledge about individual TCP segments, so this can only be
        done on a coarse granularity, at best. This limitation is
        further discussed in RFC 7657 (Sections
        [5.1](https://www.rfc-editor.org/rfc/rfc7657#section-5.1){.relref},
        [5.3](https://www.rfc-editor.org/rfc/rfc7657#section-5.3){.relref},
        and
        [6](https://www.rfc-editor.org/rfc/rfc7657#section-6){.relref})
        \[[50](#RFC7657){.xref}\]. Generally, an application [SHOULD
        NOT]{.bcp14} change the Diffserv field value during the course
        of a connection
        (SHLD-23).[¶](#section-3.9.2-3.4.2.2){.pilcrow}]{#section-3.9.2-3.4.2.2}

:   

Any lower-level protocol will have to provide the source address,
destination address, and protocol fields, and some way to determine the
\"TCP length\", both to provide the functional equivalent service of IP
and to be used in the TCP checksum.[¶](#section-3.9.2-4){.pilcrow}

When received options are passed up to TCP from the IP layer, a TCP
implementation [MUST]{.bcp14} ignore options that it does not understand
(MUST-50).[¶](#section-3.9.2-5){.pilcrow}

A TCP implementation [MAY]{.bcp14} support the Timestamp (MAY-10) and
Record Route (MAY-11) Options.[¶](#section-3.9.2-6){.pilcrow}

::: {#section-3.9.2.1 .section}
##### [3.9.2.1.](#section-3.9.2.1){.section-number .selfRef} [Source Routing](#name-source-routing){.section-name .selfRef} {#name-source-routing}

If the lower level is IP (or other protocol that provides this feature)
and source routing is used, the interface must allow the route
information to be communicated. This is especially important so that the
source and destination addresses used in the TCP checksum be the
originating source and ultimate destination. It is also important to
preserve the return route to answer connection
requests.[¶](#section-3.9.2.1-1){.pilcrow}

An application [MUST]{.bcp14} be able to specify a source route when it
actively opens a TCP connection (MUST-51), and this [MUST]{.bcp14} take
precedence over a source route received in a datagram
(MUST-52).[¶](#section-3.9.2.1-2){.pilcrow}

When a TCP connection is OPENed passively and a packet arrives with a
completed IP Source Route Option (containing a return route), TCP
implementations [MUST]{.bcp14} save the return route and use it for all
segments sent on this connection (MUST-53). If a different source route
arrives in a later segment, the later definition [SHOULD]{.bcp14}
override the earlier one (SHLD-24).[¶](#section-3.9.2.1-3){.pilcrow}
:::

::: {#icmp}
::: {#section-3.9.2.2 .section}
##### [3.9.2.2.](#section-3.9.2.2){.section-number .selfRef} [ICMP Messages](#name-icmp-messages){.section-name .selfRef} {#name-icmp-messages}

TCP implementations [MUST]{.bcp14} act on an ICMP error message passed
up from the IP layer, directing it to the connection that created the
error (MUST-54). The necessary demultiplexing information can be found
in the IP header contained within the ICMP
message.[¶](#section-3.9.2.2-1){.pilcrow}

This applies to ICMPv6 in addition to IPv4
ICMP.[¶](#section-3.9.2.2-2){.pilcrow}

\[[35](#RFC5461){.xref}\] contains discussion of specific ICMP and
ICMPv6 messages classified as either \"soft\" or \"hard\" errors that
may bear different responses. Treatment for classes of ICMP messages is
described below:[¶](#section-3.9.2.2-3){.pilcrow}

[]{.break}

Source Quench
:   TCP implementations [MUST]{.bcp14} silently discard any received
    ICMP Source Quench messages (MUST-55). See \[[11](#RFC6633){.xref}\]
    for discussion.[¶](#section-3.9.2.2-4.2){.pilcrow}
:   

Soft Errors

:   For IPv4 ICMP, these include: Destination Unreachable \-- codes 0,
    1, 5; Time Exceeded \-- codes 0, 1; and Parameter
    Problem.[¶](#section-3.9.2.2-4.4.1){.pilcrow}

    For ICMPv6, these include: Destination Unreachable \-- codes 0, 3;
    Time Exceeded \-- codes 0, 1; and Parameter Problem \-- codes 0, 1,
    2.[¶](#section-3.9.2.2-4.4.2){.pilcrow}

    Since these Unreachable messages indicate soft error conditions, a
    TCP implementation [MUST NOT]{.bcp14} abort the connection
    (MUST-56), and it [SHOULD]{.bcp14} make the information available to
    the application (SHLD-25).[¶](#section-3.9.2.2-4.4.3){.pilcrow}

:   

Hard Errors

:   For ICMP these include Destination Unreachable \-- codes
    2-4.[¶](#section-3.9.2.2-4.6.1){.pilcrow}

    These are hard error conditions, so TCP implementations
    [SHOULD]{.bcp14} abort the connection (SHLD-26).
    \[[35](#RFC5461){.xref}\] notes that some implementations do not
    abort connections when an ICMP hard error is received for a
    connection that is in any of the synchronized
    states.[¶](#section-3.9.2.2-4.6.2){.pilcrow}

:   

Note that \[[35](#RFC5461){.xref}\], [Section
4](https://www.rfc-editor.org/rfc/rfc5461#section-4){.relref} describes
widespread implementation behavior that treats soft errors as hard
errors during connection establishment.[¶](#section-3.9.2.2-5){.pilcrow}
:::
:::

::: {#section-3.9.2.3 .section}
##### [3.9.2.3.](#section-3.9.2.3){.section-number .selfRef} [Source Address Validation](#name-source-address-validation){.section-name .selfRef} {#name-source-address-validation}

RFC 1122 requires addresses to be validated in incoming SYN
packets:[¶](#section-3.9.2.3-1){.pilcrow}

> An incoming SYN with an invalid source address [MUST]{.bcp14} be
> ignored either by TCP or by the IP layer \[(MUST-63)\] (see Section
> [3.2.1.3](https://www.rfc-editor.org/rfc/rfc1122#section-3.2.1.3){.relref}).[¶](#section-3.9.2.3-2.1){.pilcrow}
>
> A TCP implementation [MUST]{.bcp14} silently discard an incoming SYN
> segment that is addressed to a broadcast or multicast address
> \[(MUST-57)\].[¶](#section-3.9.2.3-2.2){.pilcrow}

This prevents connection state and replies from being erroneously
generated, and implementers should note that this guidance is applicable
to all incoming segments, not just SYNs, as specifically indicated in
RFC 1122.[¶](#section-3.9.2.3-3){.pilcrow}
:::
:::
:::

::: {#section-3.10 .section}
### [3.10.](#section-3.10){.section-number .selfRef} [Event Processing](#name-event-processing){.section-name .selfRef} {#name-event-processing}

The processing depicted in this section is an example of one possible
implementation. Other implementations may have slightly different
processing sequences, but they should differ from those in this section
only in detail, not in substance.[¶](#section-3.10-1){.pilcrow}

The activity of the TCP endpoint can be characterized as responding to
events. The events that occur can be cast into three categories: user
calls, arriving segments, and timeouts. This section describes the
processing the TCP endpoint does in response to each of the events. In
many cases, the processing required depends on the state of the
connection.[¶](#section-3.10-2){.pilcrow}

Events that occur:[¶](#section-3.10-3){.pilcrow}

-   ::: {#section-3.10-4.1}
    User Calls[¶](#section-3.10-4.1.1){.pilcrow}

    -   [OPEN[¶](#section-3.10-4.1.2.1){.pilcrow}]{#section-3.10-4.1.2.1}
    -   [SEND[¶](#section-3.10-4.1.2.2){.pilcrow}]{#section-3.10-4.1.2.2}
    -   [RECEIVE[¶](#section-3.10-4.1.2.3){.pilcrow}]{#section-3.10-4.1.2.3}
    -   [CLOSE[¶](#section-3.10-4.1.2.4){.pilcrow}]{#section-3.10-4.1.2.4}
    -   [ABORT[¶](#section-3.10-4.1.2.5){.pilcrow}]{#section-3.10-4.1.2.5}
    -   [STATUS[¶](#section-3.10-4.1.2.6){.pilcrow}]{#section-3.10-4.1.2.6}
    :::

-   ::: {#section-3.10-4.2}
    Arriving Segments[¶](#section-3.10-4.2.1){.pilcrow}

    -   [SEGMENT
        ARRIVES[¶](#section-3.10-4.2.2.1){.pilcrow}]{#section-3.10-4.2.2.1}
    :::

-   ::: {#section-3.10-4.3}
    Timeouts[¶](#section-3.10-4.3.1){.pilcrow}

    -   [USER
        TIMEOUT[¶](#section-3.10-4.3.2.1){.pilcrow}]{#section-3.10-4.3.2.1}
    -   [RETRANSMISSION
        TIMEOUT[¶](#section-3.10-4.3.2.2){.pilcrow}]{#section-3.10-4.3.2.2}
    -   [TIME-WAIT
        TIMEOUT[¶](#section-3.10-4.3.2.3){.pilcrow}]{#section-3.10-4.3.2.3}
    :::

The model of the TCP/user interface is that user commands receive an
immediate return and possibly a delayed response via an event or
pseudo-interrupt. In the following descriptions, the term \"signal\"
means cause a delayed response.[¶](#section-3.10-5){.pilcrow}

Error responses in this document are identified by character strings.
For example, user commands referencing connections that do not exist
receive \"error: connection not open\".[¶](#section-3.10-6){.pilcrow}

Please note in the following that all arithmetic on sequence numbers,
acknowledgment numbers, windows, et cetera, is modulo 2^32^ (the size of
the sequence number space). Also note that \"=\<\" means less than or
equal to (modulo 2^32^).[¶](#section-3.10-7){.pilcrow}

A natural way to think about processing incoming segments is to imagine
that they are first tested for proper sequence number (i.e., that their
contents lie in the range of the expected \"receive window\" in the
sequence number space) and then that they are generally queued and
processed in sequence number order.[¶](#section-3.10-8){.pilcrow}

When a segment overlaps other already received segments, we reconstruct
the segment to contain just the new data and adjust the header fields to
be consistent.[¶](#section-3.10-9){.pilcrow}

Note that if no state change is mentioned, the TCP connection stays in
the same state.[¶](#section-3.10-10){.pilcrow}

::: {#section-3.10.1 .section}
#### [3.10.1.](#section-3.10.1){.section-number .selfRef} [OPEN Call](#name-open-call){.section-name .selfRef} {#name-open-call}

CLOSED STATE (i.e., TCB does not exist)[¶](#section-3.10.1-1){.pilcrow}

-   [Create a new transmission control block (TCB) to hold connection
    state information. Fill in local socket identifier, remote socket,
    Diffserv field, security/compartment, and user timeout information.
    Note that some parts of the remote socket may be unspecified in a
    passive OPEN and are to be filled in by the parameters of the
    incoming SYN segment. Verify the security and Diffserv value
    requested are allowed for this user, if not, return \"error:
    Diffserv value not allowed\" or \"error: security/compartment not
    allowed\". If passive, enter the LISTEN state and return. If active
    and the remote socket is unspecified, return \"error: remote socket
    unspecified\"; if active and the remote socket is specified, issue a
    SYN segment. An initial send sequence number (ISS) is selected. A
    SYN segment of the form \<SEQ=ISS>\<CTL=SYN> is sent. Set SND.UNA to
    ISS, SND.NXT to ISS+1, enter SYN-SENT state, and
    return.[¶](#section-3.10.1-2.1){.pilcrow}]{#section-3.10.1-2.1}
-   [If the caller does not have access to the local socket specified,
    return \"error: connection illegal for this process\". If there is
    no room to create a new connection, return \"error: insufficient
    resources\".[¶](#section-3.10.1-2.2){.pilcrow}]{#section-3.10.1-2.2}

LISTEN STATE[¶](#section-3.10.1-3){.pilcrow}

-   [If the OPEN call is active and the remote socket is specified, then
    change the connection from passive to active, select an ISS. Send a
    SYN segment, set SND.UNA to ISS, SND.NXT to ISS+1. Enter SYN-SENT
    state. Data associated with SEND may be sent with SYN segment or
    queued for transmission after entering ESTABLISHED state. The urgent
    bit if requested in the command must be sent with the data segments
    sent as a result of this command. If there is no room to queue the
    request, respond with \"error: insufficient resources\". If the
    remote socket was not specified, then return \"error: remote socket
    unspecified\".[¶](#section-3.10.1-4.1){.pilcrow}]{#section-3.10.1-4.1}

SYN-SENT STATE[¶](#section-3.10.1-5){.pilcrow}

SYN-RECEIVED STATE[¶](#section-3.10.1-6){.pilcrow}

ESTABLISHED STATE[¶](#section-3.10.1-7){.pilcrow}

FIN-WAIT-1 STATE[¶](#section-3.10.1-8){.pilcrow}

FIN-WAIT-2 STATE[¶](#section-3.10.1-9){.pilcrow}

CLOSE-WAIT STATE[¶](#section-3.10.1-10){.pilcrow}

CLOSING STATE[¶](#section-3.10.1-11){.pilcrow}

LAST-ACK STATE[¶](#section-3.10.1-12){.pilcrow}

TIME-WAIT STATE[¶](#section-3.10.1-13){.pilcrow}

-   [Return \"error: connection already
    exists\".[¶](#section-3.10.1-14.1){.pilcrow}]{#section-3.10.1-14.1}
:::

::: {#section-3.10.2 .section}
#### [3.10.2.](#section-3.10.2){.section-number .selfRef} [SEND Call](#name-send-call){.section-name .selfRef} {#name-send-call}

CLOSED STATE (i.e., TCB does not exist)[¶](#section-3.10.2-1){.pilcrow}

-   [If the user does not have access to such a connection, then return
    \"error: connection illegal for this
    process\".[¶](#section-3.10.2-2.1){.pilcrow}]{#section-3.10.2-2.1}
-   [Otherwise, return \"error: connection does not
    exist\".[¶](#section-3.10.2-2.2){.pilcrow}]{#section-3.10.2-2.2}

LISTEN STATE[¶](#section-3.10.2-3){.pilcrow}

-   [If the remote socket is specified, then change the connection from
    passive to active, select an ISS. Send a SYN segment, set SND.UNA to
    ISS, SND.NXT to ISS+1. Enter SYN-SENT state. Data associated with
    SEND may be sent with SYN segment or queued for transmission after
    entering ESTABLISHED state. The urgent bit if requested in the
    command must be sent with the data segments sent as a result of this
    command. If there is no room to queue the request, respond with
    \"error: insufficient resources\". If the remote socket was not
    specified, then return \"error: remote socket
    unspecified\".[¶](#section-3.10.2-4.1){.pilcrow}]{#section-3.10.2-4.1}

SYN-SENT STATE[¶](#section-3.10.2-5){.pilcrow}

SYN-RECEIVED STATE[¶](#section-3.10.2-6){.pilcrow}

-   [Queue the data for transmission after entering ESTABLISHED state.
    If no space to queue, respond with \"error: insufficient
    resources\".[¶](#section-3.10.2-7.1){.pilcrow}]{#section-3.10.2-7.1}

ESTABLISHED STATE[¶](#section-3.10.2-8){.pilcrow}

CLOSE-WAIT STATE[¶](#section-3.10.2-9){.pilcrow}

-   [Segmentize the buffer and send it with a piggybacked acknowledgment
    (acknowledgment value = RCV.NXT). If there is insufficient space to
    remember this buffer, simply return \"error: insufficient
    resources\".[¶](#section-3.10.2-10.1){.pilcrow}]{#section-3.10.2-10.1}
-   [If the URGENT flag is set, then SND.UP \<- SND.NXT and set the
    urgent pointer in the outgoing
    segments.[¶](#section-3.10.2-10.2){.pilcrow}]{#section-3.10.2-10.2}

FIN-WAIT-1 STATE[¶](#section-3.10.2-11){.pilcrow}

FIN-WAIT-2 STATE[¶](#section-3.10.2-12){.pilcrow}

CLOSING STATE[¶](#section-3.10.2-13){.pilcrow}

LAST-ACK STATE[¶](#section-3.10.2-14){.pilcrow}

TIME-WAIT STATE[¶](#section-3.10.2-15){.pilcrow}

-   [Return \"error: connection closing\" and do not service
    request.[¶](#section-3.10.2-16.1){.pilcrow}]{#section-3.10.2-16.1}
:::

::: {#section-3.10.3 .section}
#### [3.10.3.](#section-3.10.3){.section-number .selfRef} [RECEIVE Call](#name-receive-call){.section-name .selfRef} {#name-receive-call}

CLOSED STATE (i.e., TCB does not exist)[¶](#section-3.10.3-1){.pilcrow}

-   [If the user does not have access to such a connection, return
    \"error: connection illegal for this
    process\".[¶](#section-3.10.3-2.1){.pilcrow}]{#section-3.10.3-2.1}
-   [Otherwise, return \"error: connection does not
    exist\".[¶](#section-3.10.3-2.2){.pilcrow}]{#section-3.10.3-2.2}

LISTEN STATE[¶](#section-3.10.3-3){.pilcrow}

SYN-SENT STATE[¶](#section-3.10.3-4){.pilcrow}

SYN-RECEIVED STATE[¶](#section-3.10.3-5){.pilcrow}

-   [Queue for processing after entering ESTABLISHED state. If there is
    no room to queue this request, respond with \"error: insufficient
    resources\".[¶](#section-3.10.3-6.1){.pilcrow}]{#section-3.10.3-6.1}

ESTABLISHED STATE[¶](#section-3.10.3-7){.pilcrow}

FIN-WAIT-1 STATE[¶](#section-3.10.3-8){.pilcrow}

FIN-WAIT-2 STATE[¶](#section-3.10.3-9){.pilcrow}

-   [If insufficient incoming segments are queued to satisfy the
    request, queue the request. If there is no queue space to remember
    the RECEIVE, respond with \"error: insufficient
    resources\".[¶](#section-3.10.3-10.1){.pilcrow}]{#section-3.10.3-10.1}
-   [Reassemble queued incoming segments into receive buffer and return
    to user. Mark \"push seen\" (PUSH) if this is the
    case.[¶](#section-3.10.3-10.2){.pilcrow}]{#section-3.10.3-10.2}
-   [If RCV.UP is in advance of the data currently being passed to the
    user, notify the user of the presence of urgent
    data.[¶](#section-3.10.3-10.3){.pilcrow}]{#section-3.10.3-10.3}
-   [When the TCP endpoint takes responsibility for delivering data to
    the user, that fact must be communicated to the sender via an
    acknowledgment. The formation of such an acknowledgment is described
    below in the discussion of processing an incoming
    segment.[¶](#section-3.10.3-10.4){.pilcrow}]{#section-3.10.3-10.4}

CLOSE-WAIT STATE[¶](#section-3.10.3-11){.pilcrow}

-   [Since the remote side has already sent FIN, RECEIVEs must be
    satisfied by data already on hand, but not yet delivered to the
    user. If no text is awaiting delivery, the RECEIVE will get an
    \"error: connection closing\" response. Otherwise, any remaining
    data can be used to satisfy the
    RECEIVE.[¶](#section-3.10.3-12.1){.pilcrow}]{#section-3.10.3-12.1}

CLOSING STATE[¶](#section-3.10.3-13){.pilcrow}

LAST-ACK STATE[¶](#section-3.10.3-14){.pilcrow}

TIME-WAIT STATE[¶](#section-3.10.3-15){.pilcrow}

-   [Return \"error: connection
    closing\".[¶](#section-3.10.3-16.1){.pilcrow}]{#section-3.10.3-16.1}
:::

::: {#section-3.10.4 .section}
#### [3.10.4.](#section-3.10.4){.section-number .selfRef} [CLOSE Call](#name-close-call){.section-name .selfRef} {#name-close-call}

CLOSED STATE (i.e., TCB does not exist)[¶](#section-3.10.4-1){.pilcrow}

-   [If the user does not have access to such a connection, return
    \"error: connection illegal for this
    process\".[¶](#section-3.10.4-2.1){.pilcrow}]{#section-3.10.4-2.1}
-   [Otherwise, return \"error: connection does not
    exist\".[¶](#section-3.10.4-2.2){.pilcrow}]{#section-3.10.4-2.2}

LISTEN STATE[¶](#section-3.10.4-3){.pilcrow}

-   [Any outstanding RECEIVEs are returned with \"error: closing\"
    responses. Delete TCB, enter CLOSED state, and
    return.[¶](#section-3.10.4-4.1){.pilcrow}]{#section-3.10.4-4.1}

SYN-SENT STATE[¶](#section-3.10.4-5){.pilcrow}

-   [Delete the TCB and return \"error: closing\" responses to any
    queued SENDs, or
    RECEIVEs.[¶](#section-3.10.4-6.1){.pilcrow}]{#section-3.10.4-6.1}

SYN-RECEIVED STATE[¶](#section-3.10.4-7){.pilcrow}

-   [If no SENDs have been issued and there is no pending data to send,
    then form a FIN segment and send it, and enter FIN-WAIT-1 state;
    otherwise, queue for processing after entering ESTABLISHED
    state.[¶](#section-3.10.4-8.1){.pilcrow}]{#section-3.10.4-8.1}

ESTABLISHED STATE[¶](#section-3.10.4-9){.pilcrow}

-   [Queue this until all preceding SENDs have been segmentized, then
    form a FIN segment and send it. In any case, enter FIN-WAIT-1
    state.[¶](#section-3.10.4-10.1){.pilcrow}]{#section-3.10.4-10.1}

FIN-WAIT-1 STATE[¶](#section-3.10.4-11){.pilcrow}

FIN-WAIT-2 STATE[¶](#section-3.10.4-12){.pilcrow}

-   [Strictly speaking, this is an error and should receive an \"error:
    connection closing\" response. An \"ok\" response would be
    acceptable, too, as long as a second FIN is not emitted (the first
    FIN may be retransmitted,
    though).[¶](#section-3.10.4-13.1){.pilcrow}]{#section-3.10.4-13.1}

CLOSE-WAIT STATE[¶](#section-3.10.4-14){.pilcrow}

-   [Queue this request until all preceding SENDs have been segmentized;
    then send a FIN segment, enter LAST-ACK
    state.[¶](#section-3.10.4-15.1){.pilcrow}]{#section-3.10.4-15.1}

CLOSING STATE[¶](#section-3.10.4-16){.pilcrow}

LAST-ACK STATE[¶](#section-3.10.4-17){.pilcrow}

TIME-WAIT STATE[¶](#section-3.10.4-18){.pilcrow}

-   [Respond with \"error: connection
    closing\".[¶](#section-3.10.4-19.1){.pilcrow}]{#section-3.10.4-19.1}
:::

::: {#section-3.10.5 .section}
#### [3.10.5.](#section-3.10.5){.section-number .selfRef} [ABORT Call](#name-abort-call){.section-name .selfRef} {#name-abort-call}

CLOSED STATE (i.e., TCB does not exist)[¶](#section-3.10.5-1){.pilcrow}

-   [If the user should not have access to such a connection, return
    \"error: connection illegal for this
    process\".[¶](#section-3.10.5-2.1){.pilcrow}]{#section-3.10.5-2.1}
-   [Otherwise, return \"error: connection does not
    exist\".[¶](#section-3.10.5-2.2){.pilcrow}]{#section-3.10.5-2.2}

LISTEN STATE[¶](#section-3.10.5-3){.pilcrow}

-   [Any outstanding RECEIVEs should be returned with \"error:
    connection reset\" responses. Delete TCB, enter CLOSED state, and
    return.[¶](#section-3.10.5-4.1){.pilcrow}]{#section-3.10.5-4.1}

SYN-SENT STATE[¶](#section-3.10.5-5){.pilcrow}

-   [All queued SENDs and RECEIVEs should be given \"connection reset\"
    notification. Delete the TCB, enter CLOSED state, and
    return.[¶](#section-3.10.5-6.1){.pilcrow}]{#section-3.10.5-6.1}

SYN-RECEIVED STATE[¶](#section-3.10.5-7){.pilcrow}

ESTABLISHED STATE[¶](#section-3.10.5-8){.pilcrow}

FIN-WAIT-1 STATE[¶](#section-3.10.5-9){.pilcrow}

FIN-WAIT-2 STATE[¶](#section-3.10.5-10){.pilcrow}

CLOSE-WAIT STATE[¶](#section-3.10.5-11){.pilcrow}

-   ::: {#section-3.10.5-12.1}
    Send a reset segment:[¶](#section-3.10.5-12.1.1){.pilcrow}

    \<SEQ=SND.NXT>\<CTL=RST>[¶](#section-3.10.5-12.1.2){.pilcrow}
    :::

-   [All queued SENDs and RECEIVEs should be given \"connection reset\"
    notification; all segments queued for transmission (except for the
    RST formed above) or retransmission should be flushed. Delete the
    TCB, enter CLOSED state, and
    return.[¶](#section-3.10.5-12.2){.pilcrow}]{#section-3.10.5-12.2}

CLOSING STATE[¶](#section-3.10.5-13){.pilcrow}

LAST-ACK STATE[¶](#section-3.10.5-14){.pilcrow}

TIME-WAIT STATE[¶](#section-3.10.5-15){.pilcrow}

-   [Respond with \"ok\" and delete the TCB, enter CLOSED state, and
    return.[¶](#section-3.10.5-16.1){.pilcrow}]{#section-3.10.5-16.1}
:::

::: {#section-3.10.6 .section}
#### [3.10.6.](#section-3.10.6){.section-number .selfRef} [STATUS Call](#name-status-call){.section-name .selfRef} {#name-status-call}

CLOSED STATE (i.e., TCB does not exist)[¶](#section-3.10.6-1){.pilcrow}

-   [If the user should not have access to such a connection, return
    \"error: connection illegal for this
    process\".[¶](#section-3.10.6-2.1){.pilcrow}]{#section-3.10.6-2.1}
-   [Otherwise, return \"error: connection does not
    exist\".[¶](#section-3.10.6-2.2){.pilcrow}]{#section-3.10.6-2.2}

LISTEN STATE[¶](#section-3.10.6-3){.pilcrow}

-   [Return \"state = LISTEN\" and the TCB
    pointer.[¶](#section-3.10.6-4.1){.pilcrow}]{#section-3.10.6-4.1}

SYN-SENT STATE[¶](#section-3.10.6-5){.pilcrow}

-   [Return \"state = SYN-SENT\" and the TCB
    pointer.[¶](#section-3.10.6-6.1){.pilcrow}]{#section-3.10.6-6.1}

SYN-RECEIVED STATE[¶](#section-3.10.6-7){.pilcrow}

-   [Return \"state = SYN-RECEIVED\" and the TCB
    pointer.[¶](#section-3.10.6-8.1){.pilcrow}]{#section-3.10.6-8.1}

ESTABLISHED STATE[¶](#section-3.10.6-9){.pilcrow}

-   [Return \"state = ESTABLISHED\" and the TCB
    pointer.[¶](#section-3.10.6-10.1){.pilcrow}]{#section-3.10.6-10.1}

FIN-WAIT-1 STATE[¶](#section-3.10.6-11){.pilcrow}

-   [Return \"state = FIN-WAIT-1\" and the TCB
    pointer.[¶](#section-3.10.6-12.1){.pilcrow}]{#section-3.10.6-12.1}

FIN-WAIT-2 STATE[¶](#section-3.10.6-13){.pilcrow}

-   [Return \"state = FIN-WAIT-2\" and the TCB
    pointer.[¶](#section-3.10.6-14.1){.pilcrow}]{#section-3.10.6-14.1}

CLOSE-WAIT STATE[¶](#section-3.10.6-15){.pilcrow}

-   [Return \"state = CLOSE-WAIT\" and the TCB
    pointer.[¶](#section-3.10.6-16.1){.pilcrow}]{#section-3.10.6-16.1}

CLOSING STATE[¶](#section-3.10.6-17){.pilcrow}

-   [Return \"state = CLOSING\" and the TCB
    pointer.[¶](#section-3.10.6-18.1){.pilcrow}]{#section-3.10.6-18.1}

LAST-ACK STATE[¶](#section-3.10.6-19){.pilcrow}

-   [Return \"state = LAST-ACK\" and the TCB
    pointer.[¶](#section-3.10.6-20.1){.pilcrow}]{#section-3.10.6-20.1}

TIME-WAIT STATE[¶](#section-3.10.6-21){.pilcrow}

-   [Return \"state = TIME-WAIT\" and the TCB
    pointer.[¶](#section-3.10.6-22.1){.pilcrow}]{#section-3.10.6-22.1}
:::

::: {#section-3.10.7 .section}
#### [3.10.7.](#section-3.10.7){.section-number .selfRef} [SEGMENT ARRIVES](#name-segment-arrives){.section-name .selfRef} {#name-segment-arrives}

::: {#section-3.10.7.1 .section}
##### [3.10.7.1.](#section-3.10.7.1){.section-number .selfRef} [CLOSED STATE](#name-closed-state){.section-name .selfRef} {#name-closed-state}

If the state is CLOSED (i.e., TCB does not exist),
then[¶](#section-3.10.7.1-1){.pilcrow}

-   [all data in the incoming segment is discarded. An incoming segment
    containing a RST is discarded. An incoming segment not containing a
    RST causes a RST to be sent in response. The acknowledgment and
    sequence field values are selected to make the reset sequence
    acceptable to the TCP endpoint that sent the offending
    segment.[¶](#section-3.10.7.1-2.1){.pilcrow}]{#section-3.10.7.1-2.1}

-   ::: {#section-3.10.7.1-2.2}
    If the ACK bit is off, sequence number zero is
    used,[¶](#section-3.10.7.1-2.2.1){.pilcrow}

    -   [\<SEQ=0>\<ACK=SEG.SEQ+SEG.LEN>\<CTL=RST,ACK>[¶](#section-3.10.7.1-2.2.2.1){.pilcrow}]{#section-3.10.7.1-2.2.2.1}
    :::

-   ::: {#section-3.10.7.1-2.3}
    If the ACK bit is on,[¶](#section-3.10.7.1-2.3.1){.pilcrow}

    -   [\<SEQ=SEG.ACK>\<CTL=RST>[¶](#section-3.10.7.1-2.3.2.1){.pilcrow}]{#section-3.10.7.1-2.3.2.1}
    :::

-   [Return.[¶](#section-3.10.7.1-2.4){.pilcrow}]{#section-3.10.7.1-2.4}
:::

::: {#section-3.10.7.2 .section}
##### [3.10.7.2.](#section-3.10.7.2){.section-number .selfRef} [LISTEN STATE](#name-listen-state){.section-name .selfRef} {#name-listen-state}

If the state is LISTEN, then[¶](#section-3.10.7.2-1){.pilcrow}

-   ::: {#section-3.10.7.2-2.1}
    First, check for a RST:[¶](#section-3.10.7.2-2.1.1){.pilcrow}

    -   [An incoming RST segment could not be valid since it could not
        have been sent in response to anything sent by this incarnation
        of the connection. An incoming RST should be ignored.
        Return.[¶](#section-3.10.7.2-2.1.2.1){.pilcrow}]{#section-3.10.7.2-2.1.2.1}
    :::

-   ::: {#section-3.10.7.2-2.2}
    Second, check for an ACK:[¶](#section-3.10.7.2-2.2.1){.pilcrow}

    -   ::: {#section-3.10.7.2-2.2.2.1}
        Any acknowledgment is bad if it arrives on a connection still in
        the LISTEN state. An acceptable reset segment should be formed
        for any arriving ACK-bearing segment. The RST should be
        formatted as follows:[¶](#section-3.10.7.2-2.2.2.1.1){.pilcrow}

        -   [\<SEQ=SEG.ACK>\<CTL=RST>[¶](#section-3.10.7.2-2.2.2.1.2.1){.pilcrow}]{#section-3.10.7.2-2.2.2.1.2.1}
        :::

    -   [Return.[¶](#section-3.10.7.2-2.2.2.2){.pilcrow}]{#section-3.10.7.2-2.2.2.2}
    :::

-   ::: {#section-3.10.7.2-2.3}
    Third, check for a SYN:[¶](#section-3.10.7.2-2.3.1){.pilcrow}

    -   ::: {#section-3.10.7.2-2.3.2.1}
        If the SYN bit is set, check the security. If the
        security/compartment on the incoming segment does not exactly
        match the security/compartment in the TCB, then send a reset and
        return.[¶](#section-3.10.7.2-2.3.2.1.1){.pilcrow}

        -   [\<SEQ=0>\<ACK=SEG.SEQ+SEG.LEN>\<CTL=RST,ACK>[¶](#section-3.10.7.2-2.3.2.1.2.1){.pilcrow}]{#section-3.10.7.2-2.3.2.1.2.1}
        :::

    -   ::: {#section-3.10.7.2-2.3.2.2}
        Set RCV.NXT to SEG.SEQ+1, IRS is set to SEG.SEQ, and any other
        control or text should be queued for processing later. ISS
        should be selected and a SYN segment sent of the
        form:[¶](#section-3.10.7.2-2.3.2.2.1){.pilcrow}

        -   [\<SEQ=ISS>\<ACK=RCV.NXT>\<CTL=SYN,ACK>[¶](#section-3.10.7.2-2.3.2.2.2.1){.pilcrow}]{#section-3.10.7.2-2.3.2.2.2.1}
        :::

    -   [SND.NXT is set to ISS+1 and SND.UNA to ISS. The connection
        state should be changed to SYN-RECEIVED. Note that any other
        incoming control or data (combined with SYN) will be processed
        in the SYN-RECEIVED state, but processing of SYN and ACK should
        not be repeated. If the listen was not fully specified (i.e.,
        the remote socket was not fully specified), then the unspecified
        fields should be filled in
        now.[¶](#section-3.10.7.2-2.3.2.3){.pilcrow}]{#section-3.10.7.2-2.3.2.3}
    :::

-   ::: {#section-3.10.7.2-2.4}
    Fourth, other data or control:[¶](#section-3.10.7.2-2.4.1){.pilcrow}

    -   [This should not be reached. Drop the segment and return. Any
        other control or data-bearing segment (not containing SYN) must
        have an ACK and thus would have been discarded by the ACK
        processing in the second step, unless it was first discarded by
        RST checking in the first
        step.[¶](#section-3.10.7.2-2.4.2.1){.pilcrow}]{#section-3.10.7.2-2.4.2.1}
    :::
:::

::: {#section-3.10.7.3 .section}
##### [3.10.7.3.](#section-3.10.7.3){.section-number .selfRef} [SYN-SENT STATE](#name-syn-sent-state){.section-name .selfRef} {#name-syn-sent-state}

If the state is SYN-SENT, then[¶](#section-3.10.7.3-1){.pilcrow}

-   ::: {#section-3.10.7.3-2.1}
    First, check the ACK bit:[¶](#section-3.10.7.3-2.1.1){.pilcrow}

    -   ::: {#section-3.10.7.3-2.1.2.1}
        If the ACK bit is set,[¶](#section-3.10.7.3-2.1.2.1.1){.pilcrow}

        -   ::: {#section-3.10.7.3-2.1.2.1.2.1}
            If SEG.ACK =\< ISS or SEG.ACK > SND.NXT, send a reset
            (unless the RST bit is set, if so drop the segment and
            return)[¶](#section-3.10.7.3-2.1.2.1.2.1.1){.pilcrow}

            -   [\<SEQ=SEG.ACK>\<CTL=RST>[¶](#section-3.10.7.3-2.1.2.1.2.1.2.1){.pilcrow}]{#section-3.10.7.3-2.1.2.1.2.1.2.1}
            :::

        -   [and discard the segment.
            Return.[¶](#section-3.10.7.3-2.1.2.1.2.2){.pilcrow}]{#section-3.10.7.3-2.1.2.1.2.2}

        -   [If SND.UNA \< SEG.ACK =\< SND.NXT, then the ACK is
            acceptable. Some deployed TCP code has used the check
            SEG.ACK == SND.NXT (using \"==\" rather than \"=\<\"), but
            this is not appropriate when the stack is capable of sending
            data on the SYN because the TCP peer may not accept and
            acknowledge all of the data on the
            SYN.[¶](#section-3.10.7.3-2.1.2.1.2.3){.pilcrow}]{#section-3.10.7.3-2.1.2.1.2.3}
        :::
    :::

-   ::: {#section-3.10.7.3-2.2}
    Second, check the RST bit:[¶](#section-3.10.7.3-2.2.1){.pilcrow}

    -   ::: {#section-3.10.7.3-2.2.2.1}
        If the RST bit is set,[¶](#section-3.10.7.3-2.2.2.1.1){.pilcrow}

        -   [A potential blind reset attack is described in RFC 5961
            \[[9](#RFC5961){.xref}\]. The mitigation described in that
            document has specific applicability explained therein, and
            is not a substitute for cryptographic protection (e.g.,
            IPsec or TCP-AO). A TCP implementation that supports the
            mitigation described in RFC 5961 [SHOULD]{.bcp14} first
            check that the sequence number exactly matches RCV.NXT prior
            to executing the action in the next
            paragraph.[¶](#section-3.10.7.3-2.2.2.1.2.1){.pilcrow}]{#section-3.10.7.3-2.2.2.1.2.1}
        -   [If the ACK was acceptable, then signal to the user \"error:
            connection reset\", drop the segment, enter CLOSED state,
            delete TCB, and return. Otherwise (no ACK), drop the segment
            and
            return.[¶](#section-3.10.7.3-2.2.2.1.2.2){.pilcrow}]{#section-3.10.7.3-2.2.2.1.2.2}
        :::
    :::

-   ::: {#section-3.10.7.3-2.3}
    Third, check the security:[¶](#section-3.10.7.3-2.3.1){.pilcrow}

    -   ::: {#section-3.10.7.3-2.3.2.1}
        If the security/compartment in the segment does not exactly
        match the security/compartment in the TCB, send a
        reset:[¶](#section-3.10.7.3-2.3.2.1.1){.pilcrow}

        -   ::: {#section-3.10.7.3-2.3.2.1.2.1}
            If there is an
            ACK,[¶](#section-3.10.7.3-2.3.2.1.2.1.1){.pilcrow}

            -   [\<SEQ=SEG.ACK>\<CTL=RST>[¶](#section-3.10.7.3-2.3.2.1.2.1.2.1){.pilcrow}]{#section-3.10.7.3-2.3.2.1.2.1.2.1}
            :::

        -   ::: {#section-3.10.7.3-2.3.2.1.2.2}
            Otherwise,[¶](#section-3.10.7.3-2.3.2.1.2.2.1){.pilcrow}

            -   [\<SEQ=0>\<ACK=SEG.SEQ+SEG.LEN>\<CTL=RST,ACK>[¶](#section-3.10.7.3-2.3.2.1.2.2.2.1){.pilcrow}]{#section-3.10.7.3-2.3.2.1.2.2.2.1}
            :::
        :::

    -   [If a reset was sent, discard the segment and
        return.[¶](#section-3.10.7.3-2.3.2.2){.pilcrow}]{#section-3.10.7.3-2.3.2.2}
    :::

-   ::: {#section-3.10.7.3-2.4}
    Fourth, check the SYN bit:[¶](#section-3.10.7.3-2.4.1){.pilcrow}

    -   [This step should be reached only if the ACK is ok, or there is
        no ACK, and the segment did not contain a
        RST.[¶](#section-3.10.7.3-2.4.2.1){.pilcrow}]{#section-3.10.7.3-2.4.2.1}

    -   [If the SYN bit is on and the security/compartment is
        acceptable, then RCV.NXT is set to SEG.SEQ+1, IRS is set to
        SEG.SEQ. SND.UNA should be advanced to equal SEG.ACK (if there
        is an ACK), and any segments on the retransmission queue that
        are thereby acknowledged should be
        removed.[¶](#section-3.10.7.3-2.4.2.2){.pilcrow}]{#section-3.10.7.3-2.4.2.2}

    -   ::: {#section-3.10.7.3-2.4.2.3}
        If SND.UNA > ISS (our SYN has been ACKed), change the connection
        state to ESTABLISHED, form an ACK
        segment[¶](#section-3.10.7.3-2.4.2.3.1){.pilcrow}

        -   [\<SEQ=SND.NXT>\<ACK=RCV.NXT>\<CTL=ACK>[¶](#section-3.10.7.3-2.4.2.3.2.1){.pilcrow}]{#section-3.10.7.3-2.4.2.3.2.1}
        :::

    -   [and send it. Data or controls that were queued for transmission
        [MAY]{.bcp14} be included. Some TCP implementations suppress
        sending this segment when the received segment contains data
        that will anyways generate an acknowledgment in the later
        processing steps, saving this extra acknowledgment of the SYN
        from being sent. If there are other controls or text in the
        segment, then continue processing at the [sixth
        step](#check-urg-bit){.xref} under [Section
        3.10.7.4](#other-states){.xref} where the URG bit is checked;
        otherwise,
        return.[¶](#section-3.10.7.3-2.4.2.4){.pilcrow}]{#section-3.10.7.3-2.4.2.4}

    -   ::: {#section-3.10.7.3-2.4.2.5}
        Otherwise, enter SYN-RECEIVED, form a SYN,ACK
        segment[¶](#section-3.10.7.3-2.4.2.5.1){.pilcrow}

        -   [\<SEQ=ISS>\<ACK=RCV.NXT>\<CTL=SYN,ACK>[¶](#section-3.10.7.3-2.4.2.5.2.1){.pilcrow}]{#section-3.10.7.3-2.4.2.5.2.1}
        :::

    -   ::: {#section-3.10.7.3-2.4.2.6}
        and send it. Set the
        variables:[¶](#section-3.10.7.3-2.4.2.6.1){.pilcrow}

        -   ::: {#section-3.10.7.3-2.4.2.6.2.1}
            SND.WND \<-
            SEG.WND[¶](#section-3.10.7.3-2.4.2.6.2.1.1){.pilcrow}

            SND.WL1 \<-
            SEG.SEQ[¶](#section-3.10.7.3-2.4.2.6.2.1.2){.pilcrow}

            SND.WL2 \<-
            SEG.ACK[¶](#section-3.10.7.3-2.4.2.6.2.1.3){.pilcrow}
            :::

        If there are other controls or text in the segment, queue them
        for processing after the ESTABLISHED state has been reached,
        return.[¶](#section-3.10.7.3-2.4.2.6.3){.pilcrow}
        :::

    -   [Note that it is legal to send and receive application data on
        SYN segments (this is the \"text in the segment\" mentioned
        above). There has been significant misinformation and
        misunderstanding of this topic historically. Some firewalls and
        security devices consider this suspicious. However, the
        capability was used in T/TCP \[[21](#RFC1644){.xref}\] and is
        used in TCP Fast Open (TFO) \[[48](#RFC7413){.xref}\], so is
        important for implementations and network devices to
        permit.[¶](#section-3.10.7.3-2.4.2.7){.pilcrow}]{#section-3.10.7.3-2.4.2.7}
    :::

-   [Fifth, if neither of the SYN or RST bits is set, then drop the
    segment and
    return.[¶](#section-3.10.7.3-2.5){.pilcrow}]{#section-3.10.7.3-2.5}
:::

::: {#other-states}
::: {#section-3.10.7.4 .section}
##### [3.10.7.4.](#section-3.10.7.4){.section-number .selfRef} [Other States](#name-other-states){.section-name .selfRef} {#name-other-states}

Otherwise,[¶](#section-3.10.7.4-1){.pilcrow}

-   ::: {#section-3.10.7.4-2.1}
    First, check sequence number:[¶](#section-3.10.7.4-2.1.1){.pilcrow}

    -   [SYN-RECEIVED
        STATE[¶](#section-3.10.7.4-2.1.2.1){.pilcrow}]{#section-3.10.7.4-2.1.2.1}

    -   [ESTABLISHED
        STATE[¶](#section-3.10.7.4-2.1.2.2){.pilcrow}]{#section-3.10.7.4-2.1.2.2}

    -   [FIN-WAIT-1
        STATE[¶](#section-3.10.7.4-2.1.2.3){.pilcrow}]{#section-3.10.7.4-2.1.2.3}

    -   [FIN-WAIT-2
        STATE[¶](#section-3.10.7.4-2.1.2.4){.pilcrow}]{#section-3.10.7.4-2.1.2.4}

    -   [CLOSE-WAIT
        STATE[¶](#section-3.10.7.4-2.1.2.5){.pilcrow}]{#section-3.10.7.4-2.1.2.5}

    -   [CLOSING
        STATE[¶](#section-3.10.7.4-2.1.2.6){.pilcrow}]{#section-3.10.7.4-2.1.2.6}

    -   [LAST-ACK
        STATE[¶](#section-3.10.7.4-2.1.2.7){.pilcrow}]{#section-3.10.7.4-2.1.2.7}

    -   ::: {#section-3.10.7.4-2.1.2.8}
        TIME-WAIT STATE[¶](#section-3.10.7.4-2.1.2.8.1){.pilcrow}

        -   [Segments are processed in sequence. Initial tests on
            arrival are used to discard old duplicates, but further
            processing is done in SEG.SEQ order. If a segment\'s
            contents straddle the boundary between old and new, only the
            new parts are
            processed.[¶](#section-3.10.7.4-2.1.2.8.2.1){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.1}

        -   [In general, the processing of received segments
            [MUST]{.bcp14} be implemented to aggregate ACK segments
            whenever possible (MUST-58). For example, if the TCP
            endpoint is processing a series of queued segments, it
            [MUST]{.bcp14} process them all before sending any ACK
            segments
            (MUST-59).[¶](#section-3.10.7.4-2.1.2.8.2.2){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.2}

        -   ::: {#section-3.10.7.4-2.1.2.8.2.3}
            There are four cases for the acceptability test for an
            incoming
            segment:[¶](#section-3.10.7.4-2.1.2.8.2.3.1){.pilcrow}

            []{#name-segment-acceptability-tests-2}
            +-----------------------+-----------------------+-----------------------+
            | Segment Length        | Receive Window        | Test                  |
            +=======================+=======================+=======================+
            | 0                     | 0                     | SEG.SEQ = RCV.NXT     |
            +-----------------------+-----------------------+-----------------------+
            | 0                     | \>0                   | RCV.NXT =\< SEG.SEQ   |
            |                       |                       | \< RCV.NXT+RCV.WND    |
            +-----------------------+-----------------------+-----------------------+
            | \>0                   | 0                     | not acceptable        |
            +-----------------------+-----------------------+-----------------------+
            | \>0                   | \>0                   | RCV.NXT =\< SEG.SEQ   |
            |                       |                       | \<                    |
            |                       |                       | RCV.NX                |
            |                       |                       | T+RCV.WND[¶](#section |
            |                       |                       | -3.10.7.4-2.1.2.8.2.3 |
            |                       |                       | .2.2.4.3.1){.pilcrow} |
            |                       |                       |                       |
            |                       |                       | or[¶](#section        |
            |                       |                       | -3.10.7.4-2.1.2.8.2.3 |
            |                       |                       | .2.2.4.3.2){.pilcrow} |
            |                       |                       |                       |
            |                       |                       | RCV.NXT =\<           |
            |                       |                       | SEG.SEQ+SEG.LEN-1 \<  |
            |                       |                       | RCV.NX                |
            |                       |                       | T+RCV.WND[¶](#section |
            |                       |                       | -3.10.7.4-2.1.2.8.2.3 |
            |                       |                       | .2.2.4.3.3){.pilcrow} |
            +-----------------------+-----------------------+-----------------------+

            : [Table 6](#table-6){.selfRef}: [Segment Acceptability
            Tests](#name-segment-acceptability-tests-2){.selfRef}
            :::

        -   [In implementing sequence number validation as described
            here, please note [Appendix
            A.2](#seqval){.xref}.[¶](#section-3.10.7.4-2.1.2.8.2.4){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.4}

        -   [If the RCV.WND is zero, no segments will be acceptable, but
            special allowance should be made to accept valid ACKs, URGs,
            and
            RSTs.[¶](#section-3.10.7.4-2.1.2.8.2.5){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.5}

        -   ::: {#section-3.10.7.4-2.1.2.8.2.6}
            If an incoming segment is not acceptable, an acknowledgment
            should be sent in reply (unless the RST bit is set, if so
            drop the segment and
            return):[¶](#section-3.10.7.4-2.1.2.8.2.6.1){.pilcrow}

            \<SEQ=SND.NXT>\<ACK=RCV.NXT>\<CTL=ACK>[¶](#section-3.10.7.4-2.1.2.8.2.6.2){.pilcrow}
            :::

        -   [After sending the acknowledgment, drop the unacceptable
            segment and
            return.[¶](#section-3.10.7.4-2.1.2.8.2.7){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.7}

        -   [Note that for the TIME-WAIT state, there is an improved
            algorithm described in \[[40](#RFC6191){.xref}\] for
            handling incoming SYN segments that utilizes timestamps
            rather than relying on the sequence number check described
            here. When the improved algorithm is implemented, the logic
            above is not applicable for incoming SYN segments with
            Timestamp Options, received on a connection in the TIME-WAIT
            state.[¶](#section-3.10.7.4-2.1.2.8.2.8){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.8}

        -   [In the following it is assumed that the segment is the
            idealized segment that begins at RCV.NXT and does not exceed
            the window. One could tailor actual segments to fit this
            assumption by trimming off any portions that lie outside the
            window (including SYN and FIN) and only processing further
            if the segment then begins at RCV.NXT. Segments with higher
            beginning sequence numbers [SHOULD]{.bcp14} be held for
            later processing
            (SHLD-31).[¶](#section-3.10.7.4-2.1.2.8.2.9){.pilcrow}]{#section-3.10.7.4-2.1.2.8.2.9}
        :::
    :::

-   ::: {#section-3.10.7.4-2.2}
    Second, check the RST bit:[¶](#section-3.10.7.4-2.2.1){.pilcrow}

    -   ::: {#section-3.10.7.4-2.2.2.1}
        RFC 5961 \[[9](#RFC5961){.xref}\], Section
        [3](https://www.rfc-editor.org/rfc/rfc5961#section-3){.relref}
        describes a potential blind reset attack and optional mitigation
        approach. This does not provide a cryptographic protection
        (e.g., as in IPsec or TCP-AO) but can be applicable in
        situations described in RFC 5961. For stacks implementing the
        protection described in RFC 5961, the three checks below apply;
        otherwise, processing for these states is indicated further
        below.[¶](#section-3.10.7.4-2.2.2.1.1){.pilcrow}

        []{.break}

        1\)
        :   If the RST bit is set and the sequence number is outside the
            current receive window, silently drop the
            segment.[¶](#section-3.10.7.4-2.2.2.1.2.1){.pilcrow}
        :   

        2\)
        :   If the RST bit is set and the sequence number exactly
            matches the next expected sequence number (RCV.NXT), then
            TCP endpoints [MUST]{.bcp14} reset the connection in the
            manner prescribed below according to the connection
            state.[¶](#section-3.10.7.4-2.2.2.1.2.2){.pilcrow}
        :   

        3\)

        :   If the RST bit is set and the sequence number does not
            exactly match the next expected sequence value, yet is
            within the current receive window, TCP endpoints
            [MUST]{.bcp14} send an acknowledgment (challenge
            ACK):[¶](#section-3.10.7.4-2.2.2.1.2.3.1){.pilcrow}

            \<SEQ=SND.NXT>\<ACK=RCV.NXT>\<CTL=ACK>[¶](#section-3.10.7.4-2.2.2.1.2.3.2){.pilcrow}

            After sending the challenge ACK, TCP endpoints
            [MUST]{.bcp14} drop the unacceptable segment and stop
            processing the incoming packet further. Note that RFC 5961
            and Errata ID 4772 \[[99](#Err4772){.xref}\] contain
            additional considerations for ACK throttling in an
            implementation.[¶](#section-3.10.7.4-2.2.2.1.2.3.3){.pilcrow}

        :   
        :::

    -   ::: {#section-3.10.7.4-2.2.2.2}
        SYN-RECEIVED STATE[¶](#section-3.10.7.4-2.2.2.2.1){.pilcrow}

        -   ::: {#section-3.10.7.4-2.2.2.2.2.1}
            If the RST bit is
            set,[¶](#section-3.10.7.4-2.2.2.2.2.1.1){.pilcrow}

            -   [If this connection was initiated with a passive OPEN
                (i.e., came from the LISTEN state), then return this
                connection to LISTEN state and return. The user need not
                be informed. If this connection was initiated with an
                active OPEN (i.e., came from SYN-SENT state), then the
                connection was refused; signal the user \"connection
                refused\". In either case, the retransmission queue
                should be flushed. And in the active OPEN case, enter
                the CLOSED state and delete the TCB, and
                return.[¶](#section-3.10.7.4-2.2.2.2.2.1.2.1){.pilcrow}]{#section-3.10.7.4-2.2.2.2.2.1.2.1}
            :::
        :::

    -   [ESTABLISHED
        STATE[¶](#section-3.10.7.4-2.2.2.3){.pilcrow}]{#section-3.10.7.4-2.2.2.3}

    -   [FIN-WAIT-1
        STATE[¶](#section-3.10.7.4-2.2.2.4){.pilcrow}]{#section-3.10.7.4-2.2.2.4}

    -   [FIN-WAIT-2
        STATE[¶](#section-3.10.7.4-2.2.2.5){.pilcrow}]{#section-3.10.7.4-2.2.2.5}

    -   ::: {#section-3.10.7.4-2.2.2.6}
        CLOSE-WAIT STATE[¶](#section-3.10.7.4-2.2.2.6.1){.pilcrow}

        -   [If the RST bit is set, then any outstanding RECEIVEs and
            SEND should receive \"reset\" responses. All segment queues
            should be flushed. Users should also receive an unsolicited
            general \"connection reset\" signal. Enter the CLOSED state,
            delete the TCB, and
            return.[¶](#section-3.10.7.4-2.2.2.6.2.1){.pilcrow}]{#section-3.10.7.4-2.2.2.6.2.1}
        :::

    -   [CLOSING
        STATE[¶](#section-3.10.7.4-2.2.2.7){.pilcrow}]{#section-3.10.7.4-2.2.2.7}

    -   [LAST-ACK
        STATE[¶](#section-3.10.7.4-2.2.2.8){.pilcrow}]{#section-3.10.7.4-2.2.2.8}

    -   ::: {#section-3.10.7.4-2.2.2.9}
        TIME-WAIT STATE[¶](#section-3.10.7.4-2.2.2.9.1){.pilcrow}

        -   [If the RST bit is set, then enter the CLOSED state, delete
            the TCB, and
            return.[¶](#section-3.10.7.4-2.2.2.9.2.1){.pilcrow}]{#section-3.10.7.4-2.2.2.9.2.1}
        :::
    :::

-   ::: {#section-3.10.7.4-2.3}
    Third, check security:[¶](#section-3.10.7.4-2.3.1){.pilcrow}

    -   ::: {#section-3.10.7.4-2.3.2.1}
        SYN-RECEIVED STATE[¶](#section-3.10.7.4-2.3.2.1.1){.pilcrow}

        -   [If the security/compartment in the segment does not exactly
            match the security/compartment in the TCB, then send a reset
            and
            return.[¶](#section-3.10.7.4-2.3.2.1.2.1){.pilcrow}]{#section-3.10.7.4-2.3.2.1.2.1}
        :::

    -   [ESTABLISHED
        STATE[¶](#section-3.10.7.4-2.3.2.2){.pilcrow}]{#section-3.10.7.4-2.3.2.2}

    -   [FIN-WAIT-1
        STATE[¶](#section-3.10.7.4-2.3.2.3){.pilcrow}]{#section-3.10.7.4-2.3.2.3}

    -   [FIN-WAIT-2
        STATE[¶](#section-3.10.7.4-2.3.2.4){.pilcrow}]{#section-3.10.7.4-2.3.2.4}

    -   [CLOSE-WAIT
        STATE[¶](#section-3.10.7.4-2.3.2.5){.pilcrow}]{#section-3.10.7.4-2.3.2.5}

    -   [CLOSING
        STATE[¶](#section-3.10.7.4-2.3.2.6){.pilcrow}]{#section-3.10.7.4-2.3.2.6}

    -   [LAST-ACK
        STATE[¶](#section-3.10.7.4-2.3.2.7){.pilcrow}]{#section-3.10.7.4-2.3.2.7}

    -   ::: {#section-3.10.7.4-2.3.2.8}
        TIME-WAIT STATE[¶](#section-3.10.7.4-2.3.2.8.1){.pilcrow}

        -   [If the security/compartment in the segment does not exactly
            match the security/compartment in the TCB, then send a
            reset; any outstanding RECEIVEs and SEND should receive
            \"reset\" responses. All segment queues should be flushed.
            Users should also receive an unsolicited general
            \"connection reset\" signal. Enter the CLOSED state, delete
            the TCB, and
            return.[¶](#section-3.10.7.4-2.3.2.8.2.1){.pilcrow}]{#section-3.10.7.4-2.3.2.8.2.1}
        :::

    -   [Note this check is placed following the sequence check to
        prevent a segment from an old connection between these port
        numbers with a different security from causing an abort of the
        current
        connection.[¶](#section-3.10.7.4-2.3.2.9){.pilcrow}]{#section-3.10.7.4-2.3.2.9}
    :::

-   ::: {#section-3.10.7.4-2.4}
    Fourth, check the SYN bit:[¶](#section-3.10.7.4-2.4.1){.pilcrow}

    -   ::: {#section-3.10.7.4-2.4.2.1}
        SYN-RECEIVED STATE[¶](#section-3.10.7.4-2.4.2.1.1){.pilcrow}

        -   [If the connection was initiated with a passive OPEN, then
            return this connection to the LISTEN state and return.
            Otherwise, handle per the directions for synchronized states
            below.[¶](#section-3.10.7.4-2.4.2.1.2.1){.pilcrow}]{#section-3.10.7.4-2.4.2.1.2.1}
        :::

    -   [ESTABLISHED
        STATE[¶](#section-3.10.7.4-2.4.2.2){.pilcrow}]{#section-3.10.7.4-2.4.2.2}

    -   [FIN-WAIT-1
        STATE[¶](#section-3.10.7.4-2.4.2.3){.pilcrow}]{#section-3.10.7.4-2.4.2.3}

    -   [FIN-WAIT-2
        STATE[¶](#section-3.10.7.4-2.4.2.4){.pilcrow}]{#section-3.10.7.4-2.4.2.4}

    -   [CLOSE-WAIT
        STATE[¶](#section-3.10.7.4-2.4.2.5){.pilcrow}]{#section-3.10.7.4-2.4.2.5}

    -   [CLOSING
        STATE[¶](#section-3.10.7.4-2.4.2.6){.pilcrow}]{#section-3.10.7.4-2.4.2.6}

    -   [LAST-ACK
        STATE[¶](#section-3.10.7.4-2.4.2.7){.pilcrow}]{#section-3.10.7.4-2.4.2.7}

    -   ::: {#section-3.10.7.4-2.4.2.8}
        TIME-WAIT STATE[¶](#section-3.10.7.4-2.4.2.8.1){.pilcrow}

        -   ::: {#section-3.10.7.4-2.4.2.8.2.1}
            If the SYN bit is set in these synchronized states, it may
            be either a legitimate new connection attempt (e.g., in the
            case of TIME-WAIT), an error where the connection should be
            reset, or the result of an attack attempt, as described in
            RFC 5961 \[[9](#RFC5961){.xref}\]. For the TIME-WAIT state,
            new connections can be accepted if the Timestamp Option is
            used and meets expectations (per \[[40](#RFC6191){.xref}\]).
            For all other cases, RFC 5961 provides a mitigation with
            applicability to some situations, though there are also
            alternatives that offer cryptographic protection (see
            [Section 7](#Security){.xref}). RFC 5961 recommends that in
            these synchronized states, if the SYN bit is set,
            irrespective of the sequence number, TCP endpoints
            [MUST]{.bcp14} send a \"challenge ACK\" to the remote
            peer:[¶](#section-3.10.7.4-2.4.2.8.2.1.1){.pilcrow}

            \<SEQ=SND.NXT>\<ACK=RCV.NXT>\<CTL=ACK>[¶](#section-3.10.7.4-2.4.2.8.2.1.2){.pilcrow}
            :::

        -   [After sending the acknowledgment, TCP implementations
            [MUST]{.bcp14} drop the unacceptable segment and stop
            processing further. Note that RFC 5961 and Errata ID 4772
            \[[99](#Err4772){.xref}\] contain additional ACK throttling
            notes for an
            implementation.[¶](#section-3.10.7.4-2.4.2.8.2.2){.pilcrow}]{#section-3.10.7.4-2.4.2.8.2.2}

        -   [For implementations that do not follow RFC 5961, the
            original behavior described in RFC 793 follows in this
            paragraph. If the SYN is in the window it is an error: send
            a reset, any outstanding RECEIVEs and SEND should receive
            \"reset\" responses, all segment queues should be flushed,
            the user should also receive an unsolicited general
            \"connection reset\" signal, enter the CLOSED state, delete
            the TCB, and
            return.[¶](#section-3.10.7.4-2.4.2.8.2.3){.pilcrow}]{#section-3.10.7.4-2.4.2.8.2.3}

        -   [If the SYN is not in the window, this step would not be
            reached and an ACK would have been sent in the first step
            (sequence number
            check).[¶](#section-3.10.7.4-2.4.2.8.2.4){.pilcrow}]{#section-3.10.7.4-2.4.2.8.2.4}
        :::
    :::

-   ::: {#section-3.10.7.4-2.5}
    Fifth, check the ACK field:[¶](#section-3.10.7.4-2.5.1){.pilcrow}

    -   [if the ACK bit is off, drop the segment and
        return[¶](#section-3.10.7.4-2.5.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.1}

    -   ::: {#section-3.10.7.4-2.5.2.2}
        if the ACK bit is on,[¶](#section-3.10.7.4-2.5.2.2.1){.pilcrow}

        -   [RFC 5961 \[[9](#RFC5961){.xref}\], [Section
            5](https://www.rfc-editor.org/rfc/rfc5961#section-5){.relref}
            describes a potential blind data injection attack, and
            mitigation that implementations [MAY]{.bcp14} choose to
            include (MAY-12). TCP stacks that implement RFC 5961
            [MUST]{.bcp14} add an input check that the ACK value is
            acceptable only if it is in the range of ((SND.UNA -
            MAX.SND.WND) =\< SEG.ACK =\< SND.NXT). All incoming segments
            whose ACK value doesn\'t satisfy the above condition
            [MUST]{.bcp14} be discarded and an ACK sent back. The new
            state variable MAX.SND.WND is defined as the largest window
            that the local sender has ever received from its peer
            (subject to window scaling) or may be hard-coded to a
            maximum permissible window value. When the ACK value is
            acceptable, the per-state processing below
            applies:[¶](#section-3.10.7.4-2.5.2.2.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.1}

        -   ::: {#section-3.10.7.4-2.5.2.2.2.2}
            SYN-RECEIVED
            STATE[¶](#section-3.10.7.4-2.5.2.2.2.2.1){.pilcrow}

            -   ::: {#section-3.10.7.4-2.5.2.2.2.2.2.1}
                If SND.UNA \< SEG.ACK =\< SND.NXT, then enter
                ESTABLISHED state and continue processing with the
                variables below set
                to:[¶](#section-3.10.7.4-2.5.2.2.2.2.2.1.1){.pilcrow}

                -   [SND.WND \<-
                    SEG.WND[¶](#section-3.10.7.4-2.5.2.2.2.2.2.1.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.2.2.1.2.1}
                -   [SND.WL1 \<-
                    SEG.SEQ[¶](#section-3.10.7.4-2.5.2.2.2.2.2.1.2.2){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.2.2.1.2.2}
                -   [SND.WL2 \<-
                    SEG.ACK[¶](#section-3.10.7.4-2.5.2.2.2.2.2.1.2.3){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.2.2.1.2.3}
                :::

            -   ::: {#section-3.10.7.4-2.5.2.2.2.2.2.2}
                If the segment acknowledgment is not acceptable, form a
                reset
                segment[¶](#section-3.10.7.4-2.5.2.2.2.2.2.2.1){.pilcrow}

                -   [\<SEQ=SEG.ACK>\<CTL=RST>[¶](#section-3.10.7.4-2.5.2.2.2.2.2.2.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.2.2.2.2.1}
                :::

            -   [and send
                it.[¶](#section-3.10.7.4-2.5.2.2.2.2.2.3){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.2.2.3}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.3}
            ESTABLISHED
            STATE[¶](#section-3.10.7.4-2.5.2.2.2.3.1){.pilcrow}

            -   [If SND.UNA \< SEG.ACK =\< SND.NXT, then set SND.UNA \<-
                SEG.ACK. Any segments on the retransmission queue that
                are thereby entirely acknowledged are removed. Users
                should receive positive acknowledgments for buffers that
                have been SENT and fully acknowledged (i.e., SEND buffer
                should be returned with \"ok\" response). If the ACK is
                a duplicate (SEG.ACK =\< SND.UNA), it can be ignored. If
                the ACK acks something not yet sent (SEG.ACK > SND.NXT),
                then send an ACK, drop the segment, and
                return.[¶](#section-3.10.7.4-2.5.2.2.2.3.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.3.2.1}
            -   [If SND.UNA =\< SEG.ACK =\< SND.NXT, the send window
                should be updated. If (SND.WL1 \< SEG.SEQ or (SND.WL1 =
                SEG.SEQ and SND.WL2 =\< SEG.ACK)), set SND.WND \<-
                SEG.WND, set SND.WL1 \<- SEG.SEQ, and set SND.WL2 \<-
                SEG.ACK.[¶](#section-3.10.7.4-2.5.2.2.2.3.2.2){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.3.2.2}
            -   [Note that SND.WND is an offset from SND.UNA, that
                SND.WL1 records the sequence number of the last segment
                used to update SND.WND, and that SND.WL2 records the
                acknowledgment number of the last segment used to update
                SND.WND. The check here prevents using old segments to
                update the
                window.[¶](#section-3.10.7.4-2.5.2.2.2.3.2.3){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.3.2.3}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.4}
            FIN-WAIT-1
            STATE[¶](#section-3.10.7.4-2.5.2.2.2.4.1){.pilcrow}

            -   [In addition to the processing for the ESTABLISHED
                state, if the FIN segment is now acknowledged, then
                enter FIN-WAIT-2 and continue processing in that
                state.[¶](#section-3.10.7.4-2.5.2.2.2.4.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.4.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.5}
            FIN-WAIT-2
            STATE[¶](#section-3.10.7.4-2.5.2.2.2.5.1){.pilcrow}

            -   [In addition to the processing for the ESTABLISHED
                state, if the retransmission queue is empty, the user\'s
                CLOSE can be acknowledged (\"ok\") but do not delete the
                TCB.[¶](#section-3.10.7.4-2.5.2.2.2.5.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.5.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.6}
            CLOSE-WAIT
            STATE[¶](#section-3.10.7.4-2.5.2.2.2.6.1){.pilcrow}

            -   [Do the same processing as for the ESTABLISHED
                state.[¶](#section-3.10.7.4-2.5.2.2.2.6.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.6.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.7}
            CLOSING STATE[¶](#section-3.10.7.4-2.5.2.2.2.7.1){.pilcrow}

            -   [In addition to the processing for the ESTABLISHED
                state, if the ACK acknowledges our FIN, then enter the
                TIME-WAIT state; otherwise, ignore the
                segment.[¶](#section-3.10.7.4-2.5.2.2.2.7.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.7.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.8}
            LAST-ACK STATE[¶](#section-3.10.7.4-2.5.2.2.2.8.1){.pilcrow}

            -   [The only thing that can arrive in this state is an
                acknowledgment of our FIN. If our FIN is now
                acknowledged, delete the TCB, enter the CLOSED state,
                and
                return.[¶](#section-3.10.7.4-2.5.2.2.2.8.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.8.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.5.2.2.2.9}
            TIME-WAIT
            STATE[¶](#section-3.10.7.4-2.5.2.2.2.9.1){.pilcrow}

            -   [The only thing that can arrive in this state is a
                retransmission of the remote FIN. Acknowledge it, and
                restart the 2 MSL
                timeout.[¶](#section-3.10.7.4-2.5.2.2.2.9.2.1){.pilcrow}]{#section-3.10.7.4-2.5.2.2.2.9.2.1}
            :::
        :::
    :::

-   ::: {#section-3.10.7.4-2.6}
    ::: {#check-urg-bit}
    Sixth, check the URG bit:[¶](#section-3.10.7.4-2.6.1){.pilcrow}
    :::

    -   [ESTABLISHED
        STATE[¶](#section-3.10.7.4-2.6.2.1){.pilcrow}]{#section-3.10.7.4-2.6.2.1}

    -   [FIN-WAIT-1
        STATE[¶](#section-3.10.7.4-2.6.2.2){.pilcrow}]{#section-3.10.7.4-2.6.2.2}

    -   ::: {#section-3.10.7.4-2.6.2.3}
        FIN-WAIT-2 STATE[¶](#section-3.10.7.4-2.6.2.3.1){.pilcrow}

        -   [If the URG bit is set, RCV.UP \<- max(RCV.UP,SEG.UP), and
            signal the user that the remote side has urgent data if the
            urgent pointer (RCV.UP) is in advance of the data consumed.
            If the user has already been signaled (or is still in the
            \"urgent mode\") for this continuous sequence of urgent
            data, do not signal the user
            again.[¶](#section-3.10.7.4-2.6.2.3.2.1){.pilcrow}]{#section-3.10.7.4-2.6.2.3.2.1}
        :::

    -   [CLOSE-WAIT
        STATE[¶](#section-3.10.7.4-2.6.2.4){.pilcrow}]{#section-3.10.7.4-2.6.2.4}

    -   [CLOSING
        STATE[¶](#section-3.10.7.4-2.6.2.5){.pilcrow}]{#section-3.10.7.4-2.6.2.5}

    -   [LAST-ACK
        STATE[¶](#section-3.10.7.4-2.6.2.6){.pilcrow}]{#section-3.10.7.4-2.6.2.6}

    -   ::: {#section-3.10.7.4-2.6.2.7}
        TIME-WAIT STATE[¶](#section-3.10.7.4-2.6.2.7.1){.pilcrow}

        -   [This should not occur since a FIN has been received from
            the remote side. Ignore the
            URG.[¶](#section-3.10.7.4-2.6.2.7.2.1){.pilcrow}]{#section-3.10.7.4-2.6.2.7.2.1}
        :::
    :::

-   ::: {#section-3.10.7.4-2.7}
    Seventh, process the segment
    text:[¶](#section-3.10.7.4-2.7.1){.pilcrow}

    -   [ESTABLISHED
        STATE[¶](#section-3.10.7.4-2.7.2.1){.pilcrow}]{#section-3.10.7.4-2.7.2.1}

    -   [FIN-WAIT-1
        STATE[¶](#section-3.10.7.4-2.7.2.2){.pilcrow}]{#section-3.10.7.4-2.7.2.2}

    -   ::: {#section-3.10.7.4-2.7.2.3}
        FIN-WAIT-2 STATE[¶](#section-3.10.7.4-2.7.2.3.1){.pilcrow}

        -   [Once in the ESTABLISHED state, it is possible to deliver
            segment data to user RECEIVE buffers. Data from segments can
            be moved into buffers until either the buffer is full or the
            segment is empty. If the segment empties and carries a PUSH
            flag, then the user is informed, when the buffer is
            returned, that a PUSH has been
            received.[¶](#section-3.10.7.4-2.7.2.3.2.1){.pilcrow}]{#section-3.10.7.4-2.7.2.3.2.1}

        -   [When the TCP endpoint takes responsibility for delivering
            the data to the user, it must also acknowledge the receipt
            of the
            data.[¶](#section-3.10.7.4-2.7.2.3.2.2){.pilcrow}]{#section-3.10.7.4-2.7.2.3.2.2}

        -   [Once the TCP endpoint takes responsibility for the data, it
            advances RCV.NXT over the data accepted, and adjusts RCV.WND
            as appropriate to the current buffer availability. The total
            of RCV.NXT and RCV.WND should not be
            reduced.[¶](#section-3.10.7.4-2.7.2.3.2.3){.pilcrow}]{#section-3.10.7.4-2.7.2.3.2.3}

        -   [A TCP implementation [MAY]{.bcp14} send an ACK segment
            acknowledging RCV.NXT when a valid segment arrives that is
            in the window but not at the left window edge
            (MAY-13).[¶](#section-3.10.7.4-2.7.2.3.2.4){.pilcrow}]{#section-3.10.7.4-2.7.2.3.2.4}

        -   [Please note the window management suggestions in [Section
            3.8](#datacomm){.xref}.[¶](#section-3.10.7.4-2.7.2.3.2.5){.pilcrow}]{#section-3.10.7.4-2.7.2.3.2.5}

        -   ::: {#section-3.10.7.4-2.7.2.3.2.6}
            Send an acknowledgment of the
            form:[¶](#section-3.10.7.4-2.7.2.3.2.6.1){.pilcrow}

            \<SEQ=SND.NXT>\<ACK=RCV.NXT>\<CTL=ACK>[¶](#section-3.10.7.4-2.7.2.3.2.6.2){.pilcrow}
            :::

        -   [This acknowledgment should be piggybacked on a segment
            being transmitted if possible without incurring undue
            delay.[¶](#section-3.10.7.4-2.7.2.3.2.7){.pilcrow}]{#section-3.10.7.4-2.7.2.3.2.7}
        :::

    -   [CLOSE-WAIT
        STATE[¶](#section-3.10.7.4-2.7.2.4){.pilcrow}]{#section-3.10.7.4-2.7.2.4}

    -   [CLOSING
        STATE[¶](#section-3.10.7.4-2.7.2.5){.pilcrow}]{#section-3.10.7.4-2.7.2.5}

    -   [LAST-ACK
        STATE[¶](#section-3.10.7.4-2.7.2.6){.pilcrow}]{#section-3.10.7.4-2.7.2.6}

    -   ::: {#section-3.10.7.4-2.7.2.7}
        TIME-WAIT STATE[¶](#section-3.10.7.4-2.7.2.7.1){.pilcrow}

        -   [This should not occur since a FIN has been received from
            the remote side. Ignore the segment
            text.[¶](#section-3.10.7.4-2.7.2.7.2.1){.pilcrow}]{#section-3.10.7.4-2.7.2.7.2.1}
        :::
    :::

-   ::: {#section-3.10.7.4-2.8}
    Eighth, check the FIN bit:[¶](#section-3.10.7.4-2.8.1){.pilcrow}

    -   [Do not process the FIN if the state is CLOSED, LISTEN, or
        SYN-SENT since the SEG.SEQ cannot be validated; drop the segment
        and
        return.[¶](#section-3.10.7.4-2.8.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.1}

    -   ::: {#section-3.10.7.4-2.8.2.2}
        If the FIN bit is set, signal the user \"connection closing\"
        and return any pending RECEIVEs with same message, advance
        RCV.NXT over the FIN, and send an acknowledgment for the FIN.
        Note that FIN implies PUSH for any segment text not yet
        delivered to the user.[¶](#section-3.10.7.4-2.8.2.2.1){.pilcrow}

        -   [SYN-RECEIVED
            STATE[¶](#section-3.10.7.4-2.8.2.2.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.1}

        -   ::: {#section-3.10.7.4-2.8.2.2.2.2}
            ESTABLISHED
            STATE[¶](#section-3.10.7.4-2.8.2.2.2.2.1){.pilcrow}

            -   [Enter the CLOSE-WAIT
                state.[¶](#section-3.10.7.4-2.8.2.2.2.2.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.2.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.8.2.2.2.3}
            FIN-WAIT-1
            STATE[¶](#section-3.10.7.4-2.8.2.2.2.3.1){.pilcrow}

            -   [If our FIN has been ACKed (perhaps in this segment),
                then enter TIME-WAIT, start the time-wait timer, turn
                off the other timers; otherwise, enter the CLOSING
                state.[¶](#section-3.10.7.4-2.8.2.2.2.3.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.3.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.8.2.2.2.4}
            FIN-WAIT-2
            STATE[¶](#section-3.10.7.4-2.8.2.2.2.4.1){.pilcrow}

            -   [Enter the TIME-WAIT state. Start the time-wait timer,
                turn off the other
                timers.[¶](#section-3.10.7.4-2.8.2.2.2.4.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.4.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.8.2.2.2.5}
            CLOSE-WAIT
            STATE[¶](#section-3.10.7.4-2.8.2.2.2.5.1){.pilcrow}

            -   [Remain in the CLOSE-WAIT
                state.[¶](#section-3.10.7.4-2.8.2.2.2.5.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.5.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.8.2.2.2.6}
            CLOSING STATE[¶](#section-3.10.7.4-2.8.2.2.2.6.1){.pilcrow}

            -   [Remain in the CLOSING
                state.[¶](#section-3.10.7.4-2.8.2.2.2.6.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.6.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.8.2.2.2.7}
            LAST-ACK STATE[¶](#section-3.10.7.4-2.8.2.2.2.7.1){.pilcrow}

            -   [Remain in the LAST-ACK
                state.[¶](#section-3.10.7.4-2.8.2.2.2.7.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.7.2.1}
            :::

        -   ::: {#section-3.10.7.4-2.8.2.2.2.8}
            TIME-WAIT
            STATE[¶](#section-3.10.7.4-2.8.2.2.2.8.1){.pilcrow}

            -   [Remain in the TIME-WAIT state. Restart the 2 MSL
                time-wait
                timeout.[¶](#section-3.10.7.4-2.8.2.2.2.8.2.1){.pilcrow}]{#section-3.10.7.4-2.8.2.2.2.8.2.1}
            :::
        :::
    :::

-   [and
    return.[¶](#section-3.10.7.4-2.9){.pilcrow}]{#section-3.10.7.4-2.9}
:::
:::
:::

::: {#section-3.10.8 .section}
#### [3.10.8.](#section-3.10.8){.section-number .selfRef} [Timeouts](#name-timeouts){.section-name .selfRef} {#name-timeouts}

USER TIMEOUT[¶](#section-3.10.8-1){.pilcrow}

-   [For any state if the user timeout expires, flush all queues, signal
    the user \"error: connection aborted due to user timeout\" in
    general and for any outstanding calls, delete the TCB, enter the
    CLOSED state, and
    return.[¶](#section-3.10.8-2.1){.pilcrow}]{#section-3.10.8-2.1}

RETRANSMISSION TIMEOUT[¶](#section-3.10.8-3){.pilcrow}

-   [For any state if the retransmission timeout expires on a segment in
    the retransmission queue, send the segment at the front of the
    retransmission queue again, reinitialize the retransmission timer,
    and return.[¶](#section-3.10.8-4.1){.pilcrow}]{#section-3.10.8-4.1}

TIME-WAIT TIMEOUT[¶](#section-3.10.8-5){.pilcrow}

-   [If the time-wait timeout expires on a connection, delete the TCB,
    enter the CLOSED state, and
    return.[¶](#section-3.10.8-6.1){.pilcrow}]{#section-3.10.8-6.1}
:::
:::
:::

::: {#glossary}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Glossary](#name-glossary){.section-name .selfRef} {#name-glossary}

[]{.break}

ACK
:   A control bit (acknowledge) occupying no sequence space, which
    indicates that the acknowledgment field of this segment specifies
    the next sequence number the sender of this segment is expecting to
    receive, hence acknowledging receipt of all previous sequence
    numbers.[¶](#section-4-1.2){.pilcrow}
:   

connection
:   A logical communication path identified by a pair of
    sockets.[¶](#section-4-1.4){.pilcrow}
:   

datagram
:   A message sent in a packet-switched computer communications
    network.[¶](#section-4-1.6){.pilcrow}
:   

Destination Address
:   The network-layer address of the endpoint intended to receive a
    segment.[¶](#section-4-1.8){.pilcrow}
:   

FIN
:   A control bit (finis) occupying one sequence number, which indicates
    that the sender will send no more data or control occupying sequence
    space.[¶](#section-4-1.10){.pilcrow}
:   

flush
:   To remove all of the contents (data or segments) from a store
    (buffer or queue).[¶](#section-4-1.12){.pilcrow}
:   

fragment
:   A portion of a logical unit of data. In particular, an internet
    fragment is a portion of an internet
    datagram.[¶](#section-4-1.14){.pilcrow}
:   

header
:   Control information at the beginning of a message, segment,
    fragment, packet, or block of data.[¶](#section-4-1.16){.pilcrow}
:   

host
:   A computer. In particular, a source or destination of messages from
    the point of view of the communication
    network.[¶](#section-4-1.18){.pilcrow}
:   

Identification
:   An Internet Protocol field. This identifying value assigned by the
    sender aids in assembling the fragments of a
    datagram.[¶](#section-4-1.20){.pilcrow}
:   

internet address
:   A network-layer address.[¶](#section-4-1.22){.pilcrow}
:   

internet datagram
:   A unit of data exchanged between internet hosts, together with the
    internet header that allows the datagram to be routed from source to
    destination.[¶](#section-4-1.24){.pilcrow}
:   

internet fragment
:   A portion of the data of an internet datagram with an internet
    header.[¶](#section-4-1.26){.pilcrow}
:   

IP
:   Internet Protocol. See \[[1](#RFC0791){.xref}\] and
    \[[13](#RFC8200){.xref}\].[¶](#section-4-1.28){.pilcrow}
:   

IRS
:   The Initial Receive Sequence number. The first sequence number used
    by the sender on a connection.[¶](#section-4-1.30){.pilcrow}
:   

ISN
:   The Initial Sequence Number. The first sequence number used on a
    connection (either ISS or IRS). Selected in a way that is unique
    within a given period of time and is unpredictable to
    attackers.[¶](#section-4-1.32){.pilcrow}
:   

ISS
:   The Initial Send Sequence number. The first sequence number used by
    the sender on a connection.[¶](#section-4-1.34){.pilcrow}
:   

left sequence
:   This is the next sequence number to be acknowledged by the
    data-receiving TCP endpoint (or the lowest currently unacknowledged
    sequence number) and is sometimes referred to as the left edge of
    the send window.[¶](#section-4-1.36){.pilcrow}
:   

module
:   An implementation, usually in software, of a protocol or other
    procedure.[¶](#section-4-1.38){.pilcrow}
:   

MSL
:   Maximum Segment Lifetime, the time a TCP segment can exist in the
    internetwork system. Arbitrarily defined to be 2
    minutes.[¶](#section-4-1.40){.pilcrow}
:   

octet
:   An eight-bit byte.[¶](#section-4-1.42){.pilcrow}
:   

Options
:   An Option field may contain several options, and each option may be
    several octets in length.[¶](#section-4-1.44){.pilcrow}
:   

packet
:   A package of data with a header that may or may not be logically
    complete. More often a physical packaging than a logical packaging
    of data.[¶](#section-4-1.46){.pilcrow}
:   

port
:   The portion of a connection identifier used for demultiplexing
    connections at an endpoint.[¶](#section-4-1.48){.pilcrow}
:   

process
:   A program in execution. A source or destination of data from the
    point of view of the TCP endpoint or other host-to-host
    protocol.[¶](#section-4-1.50){.pilcrow}
:   

PUSH
:   A control bit occupying no sequence space, indicating that this
    segment contains data that must be pushed through to the receiving
    user.[¶](#section-4-1.52){.pilcrow}
:   

RCV.NXT
:   receive next sequence number[¶](#section-4-1.54){.pilcrow}
:   

RCV.UP
:   receive urgent pointer[¶](#section-4-1.56){.pilcrow}
:   

RCV.WND
:   receive window[¶](#section-4-1.58){.pilcrow}
:   

receive next sequence number
:   This is the next sequence number the local TCP endpoint is expecting
    to receive.[¶](#section-4-1.60){.pilcrow}
:   

receive window
:   This represents the sequence numbers the local (receiving) TCP
    endpoint is willing to receive. Thus, the local TCP endpoint
    considers that segments overlapping the range RCV.NXT to RCV.NXT +
    RCV.WND - 1 carry acceptable data or control. Segments containing
    sequence numbers entirely outside this range are considered
    duplicates or injection attacks and
    discarded.[¶](#section-4-1.62){.pilcrow}
:   

RST
:   A control bit (reset), occupying no sequence space, indicating that
    the receiver should delete the connection without further
    interaction. The receiver can determine, based on the sequence
    number and acknowledgment fields of the incoming segment, whether it
    should honor the reset command or ignore it. In no case does receipt
    of a segment containing RST give rise to a RST in
    response.[¶](#section-4-1.64){.pilcrow}
:   

SEG.ACK
:   segment acknowledgment[¶](#section-4-1.66){.pilcrow}
:   

SEG.LEN
:   segment length[¶](#section-4-1.68){.pilcrow}
:   

SEG.SEQ
:   segment sequence[¶](#section-4-1.70){.pilcrow}
:   

SEG.UP
:   segment urgent pointer field[¶](#section-4-1.72){.pilcrow}
:   

SEG.WND
:   segment window field[¶](#section-4-1.74){.pilcrow}
:   

segment
:   A logical unit of data. In particular, a TCP segment is the unit of
    data transferred between a pair of TCP
    modules.[¶](#section-4-1.76){.pilcrow}
:   

segment acknowledgment
:   The sequence number in the acknowledgment field of the arriving
    segment.[¶](#section-4-1.78){.pilcrow}
:   

segment length
:   The amount of sequence number space occupied by a segment, including
    any controls that occupy sequence
    space.[¶](#section-4-1.80){.pilcrow}
:   

segment sequence
:   The number in the sequence field of the arriving
    segment.[¶](#section-4-1.82){.pilcrow}
:   

send sequence
:   This is the next sequence number the local (sending) TCP endpoint
    will use on the connection. It is initially selected from an initial
    sequence number curve (ISN) and is incremented for each octet of
    data or sequenced control transmitted.[¶](#section-4-1.84){.pilcrow}
:   

send window
:   This represents the sequence numbers that the remote (receiving) TCP
    endpoint is willing to receive. It is the value of the window field
    specified in segments from the remote (data-receiving) TCP endpoint.
    The range of new sequence numbers that may be emitted by a TCP
    implementation lies between SND.NXT and SND.UNA + SND.WND - 1.
    (Retransmissions of sequence numbers between SND.UNA and SND.NXT are
    expected, of course.)[¶](#section-4-1.86){.pilcrow}
:   

SND.NXT
:   send sequence[¶](#section-4-1.88){.pilcrow}
:   

SND.UNA
:   left sequence[¶](#section-4-1.90){.pilcrow}
:   

SND.UP
:   send urgent pointer[¶](#section-4-1.92){.pilcrow}
:   

SND.WL1
:   segment sequence number at last window
    update[¶](#section-4-1.94){.pilcrow}
:   

SND.WL2
:   segment acknowledgment number at last window
    update[¶](#section-4-1.96){.pilcrow}
:   

SND.WND
:   send window[¶](#section-4-1.98){.pilcrow}
:   

socket (or socket number, or socket address, or socket identifier)
:   An address that specifically includes a port identifier, that is,
    the concatenation of an Internet Address with a TCP
    port.[¶](#section-4-1.100){.pilcrow}
:   

Source Address
:   The network-layer address of the sending
    endpoint.[¶](#section-4-1.102){.pilcrow}
:   

SYN
:   A control bit in the incoming segment, occupying one sequence
    number, used at the initiation of a connection to indicate where the
    sequence numbering will start.[¶](#section-4-1.104){.pilcrow}
:   

TCB
:   Transmission control block, the data structure that records the
    state of a connection.[¶](#section-4-1.106){.pilcrow}
:   

TCP
:   Transmission Control Protocol: a host-to-host protocol for reliable
    communication in internetwork
    environments.[¶](#section-4-1.108){.pilcrow}
:   

TOS
:   Type of Service, an obsoleted IPv4 field. The same header bits
    currently are used for the Differentiated Services field
    \[[4](#RFC2474){.xref}\] containing the Differentiated Services
    Codepoint (DSCP) value and the 2-bit ECN codepoint
    \[[6](#RFC3168){.xref}\].[¶](#section-4-1.110){.pilcrow}
:   

Type of Service
:   See \"TOS\".[¶](#section-4-1.112){.pilcrow}
:   

URG
:   A control bit (urgent), occupying no sequence space, used to
    indicate that the receiving user should be notified to do urgent
    processing as long as there is data to be consumed with sequence
    numbers less than the value indicated by the urgent
    pointer.[¶](#section-4-1.114){.pilcrow}
:   

urgent pointer
:   A control field meaningful only when the URG bit is on. This field
    communicates the value of the urgent pointer that indicates the data
    octet associated with the sending user\'s urgent
    call.[¶](#section-4-1.116){.pilcrow}
:   
:::
:::

::: {#changes}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Changes from RFC 793](#name-changes-from-rfc-793){.section-name .selfRef} {#name-changes-from-rfc-793}

This document obsoletes RFC 793 as well as RFCs 6093 and 6528, which
updated 793. In all cases, only the normative protocol specification and
requirements have been incorporated into this document, and some
informational text with background and rationale may not have been
carried in. The informational content of those documents is still
valuable in learning about and understanding TCP, and they are valid
Informational references, even though their normative content has been
incorporated into this document.[¶](#section-5-1){.pilcrow}

The main body of this document was adapted from RFC 793\'s Section
[3](https://www.rfc-editor.org/rfc/rfc793#section-3){.relref}, titled
\"FUNCTIONAL SPECIFICATION\", with an attempt to keep formatting and
layout as close as possible.[¶](#section-5-2){.pilcrow}

The collection of applicable RFC errata that have been reported and
either accepted or held for an update to RFC 793 were incorporated
(Errata IDs: 573 \[[73](#Err573){.xref}\], 574 \[[74](#Err574){.xref}\],
700 \[[75](#Err700){.xref}\], 701 \[[76](#Err701){.xref}\], 1283
\[[77](#Err1283){.xref}\], 1561 \[[78](#Err1561){.xref}\], 1562
\[[79](#Err1562){.xref}\], 1564 \[[80](#Err1564){.xref}\], 1571
\[[81](#Err1571){.xref}\], 1572 \[[82](#Err1572){.xref}\], 2297
\[[83](#Err2297){.xref}\], 2298 \[[84](#Err2298){.xref}\], 2748
\[[85](#Err2748){.xref}\], 2749 \[[86](#Err2749){.xref}\], 2934
\[[87](#Err2934){.xref}\], 3213 \[[88](#Err3213){.xref}\], 3300
\[[89](#Err3300){.xref}\], 3301 \[[90](#Err3301){.xref}\], 6222
\[[91](#Err6222){.xref}\]). Some errata were not applicable due to other
changes (Errata IDs: 572 \[[92](#Err572){.xref}\], 575
\[[93](#Err575){.xref}\], 1565 \[[94](#Err1565){.xref}\], 1569
\[[95](#Err1569){.xref}\], 2296 \[[96](#Err2296){.xref}\], 3305
\[[97](#Err3305){.xref}\], 3602
\[[98](#Err3602){.xref}\]).[¶](#section-5-3){.pilcrow}

Changes to the specification of the urgent pointer described in RFCs
1011, 1122, and 6093 were incorporated. See RFC 6093 for detailed
discussion of why these changes were
necessary.[¶](#section-5-4){.pilcrow}

The discussion of the RTO from RFC 793 was updated to refer to RFC 6298.
The text on the RTO in RFC 1122 originally replaced the text in RFC 793;
however, RFC 2988 should have updated RFC 1122 and has subsequently been
obsoleted by RFC 6298.[¶](#section-5-5){.pilcrow}

RFC 1011 \[[18](#RFC1011){.xref}\] contains a number of comments about
RFC 793, including some needed changes to the TCP specification. These
are expanded in RFC 1122, which contains a collection of other changes
and clarifications to RFC 793. The normative items impacting the
protocol have been incorporated here, though some historically useful
implementation advice and informative discussion from RFC 1122 is not
included here. The present document, which is now the TCP specification
rather than RFC 793, updates RFC 1011, and the comments noted in RFC
1011 have been incorporated.[¶](#section-5-6){.pilcrow}

RFC 1122 contains more than just TCP requirements, so this document
can\'t obsolete RFC 1122 entirely. It is only marked as \"updating\" RFC
1122; however, it should be understood to effectively obsolete all of
the material on TCP found in RFC 1122.[¶](#section-5-7){.pilcrow}

The more secure initial sequence number generation algorithm from RFC
6528 was incorporated. See RFC 6528 for discussion of the attacks that
this mitigates, as well as advice on selecting PRF algorithms and
managing secret key data.[¶](#section-5-8){.pilcrow}

A note based on RFC 6429 was added to explicitly clarify that system
resource management concerns allow connection resources to be reclaimed.
RFC 6429 is obsoleted in the sense that the clarification it describes
has been reflected within this base TCP
specification.[¶](#section-5-9){.pilcrow}

The description of congestion control implementation was added based on
the set of documents that are IETF BCP or Standards Track on the topic
and the current state of common
implementations.[¶](#section-5-10){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

In the \"Transmission Control Protocol (TCP) Header Flags\" registry,
IANA has made several changes as described in this
section.[¶](#section-6-1){.pilcrow}

RFC 3168 originally created this registry but only populated it with the
new bits defined in RFC 3168, neglecting the other bits that had
previously been described in RFC 793 and other documents. Bit 7 has
since also been updated by RFC 8311
\[[54](#RFC8311){.xref}\].[¶](#section-6-2){.pilcrow}

The \"Bit\" column has been renamed below as the \"Bit Offset\" column
because it references each header flag\'s offset within the 16-bit
aligned view of the TCP header in [Figure 1](#header_format){.xref}. The
bits in offsets 0 through 3 are the TCP segment Data Offset field, and
not header flags.[¶](#section-6-3){.pilcrow}

IANA has added a column for \"Assignment
Notes\".[¶](#section-6-4){.pilcrow}

IANA has assigned values as indicated below.[¶](#section-6-5){.pilcrow}

[]{#name-tcp-header-flags}

  Bit Offset   Name                                        Reference   Assignment Notes
  ------------ ------------------------------------------- ----------- ---------------------------------------------------------
  4            Reserved for future use                     RFC 9293    
  5            Reserved for future use                     RFC 9293    
  6            Reserved for future use                     RFC 9293    
  7            Reserved for future use                     RFC 8311    Previously used by Historic RFC 3540 as NS (Nonce Sum).
  8            CWR (Congestion Window Reduced)             RFC 3168    
  9            ECE (ECN-Echo)                              RFC 3168    
  10           Urgent pointer field is significant (URG)   RFC 9293    
  11           Acknowledgment field is significant (ACK)   RFC 9293    
  12           Push function (PSH)                         RFC 9293    
  13           Reset the connection (RST)                  RFC 9293    
  14           Synchronize sequence numbers (SYN)          RFC 9293    
  15           No more data from sender (FIN)              RFC 9293    

  : [Table 7](#table-7){.selfRef}: [TCP Header
  Flags](#name-tcp-header-flags){.selfRef}

The \"TCP Header Flags\" registry has also been moved to a subregistry
under the global \"Transmission Control Protocol (TCP) Parameters\"
registry
\<<https://www.iana.org/assignments/tcp-parameters/>\>.[¶](#section-6-7){.pilcrow}

The registry\'s Registration Procedure remains Standards Action, but the
Reference has been updated to this document, and the Note has been
removed.[¶](#section-6-8){.pilcrow}
:::
:::

::: {#Security}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security and Privacy Considerations](#name-security-and-privacy-consid){.section-name .selfRef} {#name-security-and-privacy-consid}

The TCP design includes only rudimentary security features that improve
the robustness and reliability of connections and application data
transfer, but there are no built-in cryptographic capabilities to
support any form of confidentiality, authentication, or other typical
security functions. Non-cryptographic enhancements (e.g.,
\[[9](#RFC5961){.xref}\]) have been developed to improve robustness of
TCP connections to particular types of attacks, but the applicability
and protections of non-cryptographic enhancements are limited (e.g., see
[Section
1.1](https://www.rfc-editor.org/rfc/rfc5961#section-1.1){.relref} of
\[[9](#RFC5961){.xref}\]). Applications typically utilize lower-layer
(e.g., IPsec) and upper-layer (e.g., TLS) protocols to provide security
and privacy for TCP connections and application data carried in TCP.
Methods based on TCP Options have been developed as well, to support
some security capabilities.[¶](#section-7-1){.pilcrow}

In order to fully provide confidentiality, integrity protection, and
authentication for TCP connections (including their control flags),
IPsec is the only current effective method. For integrity protection and
authentication, the TCP Authentication Option (TCP-AO)
\[[38](#RFC5925){.xref}\] is available, with a proposed extension to
also provide confidentiality for the segment payload. Other methods
discussed in this section may provide confidentiality or integrity
protection for the payload, but for the TCP header only cover either a
subset of the fields (e.g., tcpcrypt \[[57](#RFC8548){.xref}\]) or none
at all (e.g., TLS). Other security features that have been added to TCP
(e.g., ISN generation, sequence number checks, and others) are only
capable of partially hindering attacks.[¶](#section-7-2){.pilcrow}

Applications using long-lived TCP flows have been vulnerable to attacks
that exploit the processing of control flags described in earlier TCP
specifications \[[33](#RFC4953){.xref}\]. TCP-MD5 was a commonly
implemented TCP Option to support authentication for some of these
connections, but had flaws and is now deprecated. TCP-AO provides a
capability to protect long-lived TCP connections from attacks and has
superior properties to TCP-MD5. It does not provide any privacy for
application data or for the TCP headers.[¶](#section-7-3){.pilcrow}

The \"tcpcrypt\" \[[57](#RFC8548){.xref}\] experimental extension to TCP
provides the ability to cryptographically protect connection data.
Metadata aspects of the TCP flow are still visible, but the application
stream is well protected. Within the TCP header, only the urgent pointer
and FIN flag are protected through tcpcrypt.[¶](#section-7-4){.pilcrow}

The TCP Roadmap \[[49](#RFC7414){.xref}\] includes notes about several
RFCs related to TCP security. Many of the enhancements provided by these
RFCs have been integrated into the present document, including ISN
generation, mitigating blind in-window attacks, and improving handling
of soft errors and ICMP packets. These are all discussed in greater
detail in the referenced RFCs that originally described the changes
needed to earlier TCP specifications. Additionally, see RFC 6093
\[[39](#RFC6093){.xref}\] for discussion of security considerations
related to the urgent pointer field, which also discourages new
applications from using the urgent pointer.[¶](#section-7-5){.pilcrow}

Since TCP is often used for bulk transfer flows, some attacks are
possible that abuse the TCP congestion control logic. An example is
\"ACK-division\" attacks. Updates that have been made to the TCP
congestion control specifications include mechanisms like Appropriate
Byte Counting (ABC) \[[29](#RFC3465){.xref}\] that act as mitigations to
these attacks.[¶](#section-7-6){.pilcrow}

Other attacks are focused on exhausting the resources of a TCP server.
Examples include SYN flooding \[[32](#RFC4987){.xref}\] or wasting
resources on non-progressing connections \[[41](#RFC6429){.xref}\].
Operating systems commonly implement mitigations for these attacks. Some
common defenses also utilize proxies, stateful firewalls, and other
technologies outside the end-host TCP
implementation.[¶](#section-7-7){.pilcrow}

The concept of a protocol\'s \"wire image\" is described in RFC 8546
\[[56](#RFC8546){.xref}\], which describes how TCP\'s cleartext headers
expose more metadata to nodes on the path than is strictly required to
route the packets to their destination. On-path adversaries may be able
to leverage this metadata. Lessons learned in this respect from TCP have
been applied in the design of newer transports like QUIC
\[[60](#RFC9000){.xref}\]. Additionally, based partly on experiences
with TCP and its extensions, there are considerations that might be
applicable for future TCP extensions and other transports that the IETF
has documented in RFC 9065 \[[61](#RFC9065){.xref}\], along with IAB
recommendations in RFC 8558 \[[58](#RFC8558){.xref}\] and
\[[67](#RFC9170){.xref}\].[¶](#section-7-8){.pilcrow}

There are also methods of \"fingerprinting\" that can be used to infer
the host TCP implementation (operating system) version or platform
information. These collect observations of several aspects, such as the
options present in segments, the ordering of options, the specific
behaviors in the case of various conditions, packet timing, packet
sizing, and other aspects of the protocol that are left to be determined
by an implementer, and can use those observations to identify
information about the host and
implementation.[¶](#section-7-9){.pilcrow}

Since ICMP message processing also can interact with TCP connections,
there is potential for ICMP-based attacks against TCP connections. These
are discussed in RFC 5927 \[[100](#RFC5927){.xref}\], along with
mitigations that have been implemented.[¶](#section-7-10){.pilcrow}
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[1\]
:   [Postel, J.]{.refAuthor}, [\"Internet Protocol\"]{.refTitle}, [STD
    5]{.seriesInfo}, [RFC 791]{.seriesInfo}, [DOI
    10.17487/RFC0791]{.seriesInfo}, September 1981,
    \<<https://www.rfc-editor.org/info/rfc791>\>.
:   

\[2\]
:   [Mogul, J.]{.refAuthor} and [S. Deering]{.refAuthor}, [\"Path MTU
    discovery\"]{.refTitle}, [RFC 1191]{.seriesInfo}, [DOI
    10.17487/RFC1191]{.seriesInfo}, November 1990,
    \<<https://www.rfc-editor.org/info/rfc1191>\>.
:   

\[3\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[4\]
:   [Nichols, K.]{.refAuthor}, [Blake, S.]{.refAuthor},
    [Baker, F.]{.refAuthor}, and [D. Black]{.refAuthor}, [\"Definition
    of the Differentiated Services Field (DS Field) in the IPv4 and IPv6
    Headers\"]{.refTitle}, [RFC 2474]{.seriesInfo}, [DOI
    10.17487/RFC2474]{.seriesInfo}, December 1998,
    \<<https://www.rfc-editor.org/info/rfc2474>\>.
:   

\[5\]
:   [Floyd, S.]{.refAuthor}, [\"Congestion Control
    Principles\"]{.refTitle}, [BCP 41]{.seriesInfo}, [RFC
    2914]{.seriesInfo}, [DOI 10.17487/RFC2914]{.seriesInfo}, September
    2000, \<<https://www.rfc-editor.org/info/rfc2914>\>.
:   

\[6\]
:   [Ramakrishnan, K.]{.refAuthor}, [Floyd, S.]{.refAuthor}, and [D.
    Black]{.refAuthor}, [\"The Addition of Explicit Congestion
    Notification (ECN) to IP\"]{.refTitle}, [RFC 3168]{.seriesInfo},
    [DOI 10.17487/RFC3168]{.seriesInfo}, September 2001,
    \<<https://www.rfc-editor.org/info/rfc3168>\>.
:   

\[7\]
:   [Floyd, S.]{.refAuthor} and [M. Allman]{.refAuthor}, [\"Specifying
    New Congestion Control Algorithms\"]{.refTitle}, [BCP
    133]{.seriesInfo}, [RFC 5033]{.seriesInfo}, [DOI
    10.17487/RFC5033]{.seriesInfo}, August 2007,
    \<<https://www.rfc-editor.org/info/rfc5033>\>.
:   

\[8\]
:   [Allman, M.]{.refAuthor}, [Paxson, V.]{.refAuthor}, and [E.
    Blanton]{.refAuthor}, [\"TCP Congestion Control\"]{.refTitle}, [RFC
    5681]{.seriesInfo}, [DOI 10.17487/RFC5681]{.seriesInfo}, September
    2009, \<<https://www.rfc-editor.org/info/rfc5681>\>.
:   

\[9\]
:   [Ramaiah, A.]{.refAuthor}, [Stewart, R.]{.refAuthor}, and [M.
    Dalal]{.refAuthor}, [\"Improving TCP\'s Robustness to Blind
    In-Window Attacks\"]{.refTitle}, [RFC 5961]{.seriesInfo}, [DOI
    10.17487/RFC5961]{.seriesInfo}, August 2010,
    \<<https://www.rfc-editor.org/info/rfc5961>\>.
:   

\[10\]
:   [Paxson, V.]{.refAuthor}, [Allman, M.]{.refAuthor},
    [Chu, J.]{.refAuthor}, and [M. Sargent]{.refAuthor}, [\"Computing
    TCP\'s Retransmission Timer\"]{.refTitle}, [RFC 6298]{.seriesInfo},
    [DOI 10.17487/RFC6298]{.seriesInfo}, June 2011,
    \<<https://www.rfc-editor.org/info/rfc6298>\>.
:   

\[11\]
:   [Gont, F.]{.refAuthor}, [\"Deprecation of ICMP Source Quench
    Messages\"]{.refTitle}, [RFC 6633]{.seriesInfo}, [DOI
    10.17487/RFC6633]{.seriesInfo}, May 2012,
    \<<https://www.rfc-editor.org/info/rfc6633>\>.
:   

\[12\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[13\]
:   [Deering, S.]{.refAuthor} and [R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [STD
    86]{.seriesInfo}, [RFC 8200]{.seriesInfo}, [DOI
    10.17487/RFC8200]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8200>\>.
:   

\[14\]
:   [McCann, J.]{.refAuthor}, [Deering, S.]{.refAuthor},
    [Mogul, J.]{.refAuthor}, and [R. Hinden, Ed.]{.refAuthor}, [\"Path
    MTU Discovery for IP version 6\"]{.refTitle}, [STD 87]{.seriesInfo},
    [RFC 8201]{.seriesInfo}, [DOI 10.17487/RFC8201]{.seriesInfo}, July
    2017, \<<https://www.rfc-editor.org/info/rfc8201>\>.
:   

\[15\]
:   [Allman, M.]{.refAuthor}, [\"Requirements for Time-Based Loss
    Detection\"]{.refTitle}, [BCP 233]{.seriesInfo}, [RFC
    8961]{.seriesInfo}, [DOI 10.17487/RFC8961]{.seriesInfo}, November
    2020, \<<https://www.rfc-editor.org/info/rfc8961>\>.
:   
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[16\]
:   [Postel, J.]{.refAuthor}, [\"Transmission Control
    Protocol\"]{.refTitle}, [STD 7]{.seriesInfo}, [RFC
    793]{.seriesInfo}, [DOI 10.17487/RFC0793]{.seriesInfo}, September
    1981, \<<https://www.rfc-editor.org/info/rfc793>\>.
:   

\[17\]
:   [Nagle, J.]{.refAuthor}, [\"Congestion Control in IP/TCP
    Internetworks\"]{.refTitle}, [RFC 896]{.seriesInfo}, [DOI
    10.17487/RFC0896]{.seriesInfo}, January 1984,
    \<<https://www.rfc-editor.org/info/rfc896>\>.
:   

\[18\]
:   [Reynolds, J.]{.refAuthor} and [J. Postel]{.refAuthor}, [\"Official
    Internet protocols\"]{.refTitle}, [RFC 1011]{.seriesInfo}, [DOI
    10.17487/RFC1011]{.seriesInfo}, May 1987,
    \<<https://www.rfc-editor.org/info/rfc1011>\>.
:   

\[19\]
:   [Braden, R., Ed.]{.refAuthor}, [\"Requirements for Internet Hosts -
    Communication Layers\"]{.refTitle}, [STD 3]{.seriesInfo}, [RFC
    1122]{.seriesInfo}, [DOI 10.17487/RFC1122]{.seriesInfo}, October
    1989, \<<https://www.rfc-editor.org/info/rfc1122>\>.
:   

\[20\]
:   [Almquist, P.]{.refAuthor}, [\"Type of Service in the Internet
    Protocol Suite\"]{.refTitle}, [RFC 1349]{.seriesInfo}, [DOI
    10.17487/RFC1349]{.seriesInfo}, July 1992,
    \<<https://www.rfc-editor.org/info/rfc1349>\>.
:   

\[21\]
:   [Braden, R.]{.refAuthor}, [\"T/TCP \-- TCP Extensions for
    Transactions Functional Specification\"]{.refTitle}, [RFC
    1644]{.seriesInfo}, [DOI 10.17487/RFC1644]{.seriesInfo}, July 1994,
    \<<https://www.rfc-editor.org/info/rfc1644>\>.
:   

\[22\]
:   [Mathis, M.]{.refAuthor}, [Mahdavi, J.]{.refAuthor},
    [Floyd, S.]{.refAuthor}, and [A. Romanow]{.refAuthor}, [\"TCP
    Selective Acknowledgment Options\"]{.refTitle}, [RFC
    2018]{.seriesInfo}, [DOI 10.17487/RFC2018]{.seriesInfo}, October
    1996, \<<https://www.rfc-editor.org/info/rfc2018>\>.
:   

\[23\]
:   [Paxson, V.]{.refAuthor}, [Allman, M.]{.refAuthor},
    [Dawson, S.]{.refAuthor}, [Fenner, W.]{.refAuthor},
    [Griner, J.]{.refAuthor}, [Heavens, I.]{.refAuthor},
    [Lahey, K.]{.refAuthor}, [Semke, J.]{.refAuthor}, and [B.
    Volz]{.refAuthor}, [\"Known TCP Implementation
    Problems\"]{.refTitle}, [RFC 2525]{.seriesInfo}, [DOI
    10.17487/RFC2525]{.seriesInfo}, March 1999,
    \<<https://www.rfc-editor.org/info/rfc2525>\>.
:   

\[24\]
:   [Borman, D.]{.refAuthor}, [Deering, S.]{.refAuthor}, and [R.
    Hinden]{.refAuthor}, [\"IPv6 Jumbograms\"]{.refTitle}, [RFC
    2675]{.seriesInfo}, [DOI 10.17487/RFC2675]{.seriesInfo}, August
    1999, \<<https://www.rfc-editor.org/info/rfc2675>\>.
:   

\[25\]
:   [Xiao, X.]{.refAuthor}, [Hannan, A.]{.refAuthor},
    [Paxson, V.]{.refAuthor}, and [E. Crabbe]{.refAuthor}, [\"TCP
    Processing of the IPv4 Precedence Field\"]{.refTitle}, [RFC
    2873]{.seriesInfo}, [DOI 10.17487/RFC2873]{.seriesInfo}, June 2000,
    \<<https://www.rfc-editor.org/info/rfc2873>\>.
:   

\[26\]
:   [Floyd, S.]{.refAuthor}, [Mahdavi, J.]{.refAuthor},
    [Mathis, M.]{.refAuthor}, and [M. Podolsky]{.refAuthor}, [\"An
    Extension to the Selective Acknowledgement (SACK) Option for
    TCP\"]{.refTitle}, [RFC 2883]{.seriesInfo}, [DOI
    10.17487/RFC2883]{.seriesInfo}, July 2000,
    \<<https://www.rfc-editor.org/info/rfc2883>\>.
:   

\[27\]
:   [Lahey, K.]{.refAuthor}, [\"TCP Problems with Path MTU
    Discovery\"]{.refTitle}, [RFC 2923]{.seriesInfo}, [DOI
    10.17487/RFC2923]{.seriesInfo}, September 2000,
    \<<https://www.rfc-editor.org/info/rfc2923>\>.
:   

\[28\]
:   [Balakrishnan, H.]{.refAuthor}, [Padmanabhan, V.]{.refAuthor},
    [Fairhurst, G.]{.refAuthor}, and [M. Sooriyabandara]{.refAuthor},
    [\"TCP Performance Implications of Network Path
    Asymmetry\"]{.refTitle}, [BCP 69]{.seriesInfo}, [RFC
    3449]{.seriesInfo}, [DOI 10.17487/RFC3449]{.seriesInfo}, December
    2002, \<<https://www.rfc-editor.org/info/rfc3449>\>.
:   

\[29\]
:   [Allman, M.]{.refAuthor}, [\"TCP Congestion Control with Appropriate
    Byte Counting (ABC)\"]{.refTitle}, [RFC 3465]{.seriesInfo}, [DOI
    10.17487/RFC3465]{.seriesInfo}, February 2003,
    \<<https://www.rfc-editor.org/info/rfc3465>\>.
:   

\[30\]
:   [Fenner, B.]{.refAuthor}, [\"Experimental Values In IPv4, IPv6,
    ICMPv4, ICMPv6, UDP, and TCP Headers\"]{.refTitle}, [RFC
    4727]{.seriesInfo}, [DOI 10.17487/RFC4727]{.seriesInfo}, November
    2006, \<<https://www.rfc-editor.org/info/rfc4727>\>.
:   

\[31\]
:   [Mathis, M.]{.refAuthor} and [J. Heffner]{.refAuthor},
    [\"Packetization Layer Path MTU Discovery\"]{.refTitle}, [RFC
    4821]{.seriesInfo}, [DOI 10.17487/RFC4821]{.seriesInfo}, March 2007,
    \<<https://www.rfc-editor.org/info/rfc4821>\>.
:   

\[32\]
:   [Eddy, W.]{.refAuthor}, [\"TCP SYN Flooding Attacks and Common
    Mitigations\"]{.refTitle}, [RFC 4987]{.seriesInfo}, [DOI
    10.17487/RFC4987]{.seriesInfo}, August 2007,
    \<<https://www.rfc-editor.org/info/rfc4987>\>.
:   

\[33\]
:   [Touch, J.]{.refAuthor}, [\"Defending TCP Against Spoofing
    Attacks\"]{.refTitle}, [RFC 4953]{.seriesInfo}, [DOI
    10.17487/RFC4953]{.seriesInfo}, July 2007,
    \<<https://www.rfc-editor.org/info/rfc4953>\>.
:   

\[34\]
:   [Culley, P.]{.refAuthor}, [Elzur, U.]{.refAuthor},
    [Recio, R.]{.refAuthor}, [Bailey, S.]{.refAuthor}, and [J.
    Carrier]{.refAuthor}, [\"Marker PDU Aligned Framing for TCP
    Specification\"]{.refTitle}, [RFC 5044]{.seriesInfo}, [DOI
    10.17487/RFC5044]{.seriesInfo}, October 2007,
    \<<https://www.rfc-editor.org/info/rfc5044>\>.
:   

\[35\]
:   [Gont, F.]{.refAuthor}, [\"TCP\'s Reaction to Soft
    Errors\"]{.refTitle}, [RFC 5461]{.seriesInfo}, [DOI
    10.17487/RFC5461]{.seriesInfo}, February 2009,
    \<<https://www.rfc-editor.org/info/rfc5461>\>.
:   

\[36\]
:   [StJohns, M.]{.refAuthor}, [Atkinson, R.]{.refAuthor}, and [G.
    Thomas]{.refAuthor}, [\"Common Architecture Label IPv6 Security
    Option (CALIPSO)\"]{.refTitle}, [RFC 5570]{.seriesInfo}, [DOI
    10.17487/RFC5570]{.seriesInfo}, July 2009,
    \<<https://www.rfc-editor.org/info/rfc5570>\>.
:   

\[37\]
:   [Sandlund, K.]{.refAuthor}, [Pelletier, G.]{.refAuthor}, and [L-E.
    Jonsson]{.refAuthor}, [\"The RObust Header Compression (ROHC)
    Framework\"]{.refTitle}, [RFC 5795]{.seriesInfo}, [DOI
    10.17487/RFC5795]{.seriesInfo}, March 2010,
    \<<https://www.rfc-editor.org/info/rfc5795>\>.
:   

\[38\]
:   [Touch, J.]{.refAuthor}, [Mankin, A.]{.refAuthor}, and [R.
    Bonica]{.refAuthor}, [\"The TCP Authentication Option\"]{.refTitle},
    [RFC 5925]{.seriesInfo}, [DOI 10.17487/RFC5925]{.seriesInfo}, June
    2010, \<<https://www.rfc-editor.org/info/rfc5925>\>.
:   

\[39\]
:   [Gont, F.]{.refAuthor} and [A. Yourtchenko]{.refAuthor}, [\"On the
    Implementation of the TCP Urgent Mechanism\"]{.refTitle}, [RFC
    6093]{.seriesInfo}, [DOI 10.17487/RFC6093]{.seriesInfo}, January
    2011, \<<https://www.rfc-editor.org/info/rfc6093>\>.
:   

\[40\]
:   [Gont, F.]{.refAuthor}, [\"Reducing the TIME-WAIT State Using TCP
    Timestamps\"]{.refTitle}, [BCP 159]{.seriesInfo}, [RFC
    6191]{.seriesInfo}, [DOI 10.17487/RFC6191]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6191>\>.
:   

\[41\]
:   [Bashyam, M.]{.refAuthor}, [Jethanandani, M.]{.refAuthor}, and [A.
    Ramaiah]{.refAuthor}, [\"TCP Sender Clarification for Persist
    Condition\"]{.refTitle}, [RFC 6429]{.seriesInfo}, [DOI
    10.17487/RFC6429]{.seriesInfo}, December 2011,
    \<<https://www.rfc-editor.org/info/rfc6429>\>.
:   

\[42\]
:   [Gont, F.]{.refAuthor} and [S. Bellovin]{.refAuthor}, [\"Defending
    against Sequence Number Attacks\"]{.refTitle}, [RFC
    6528]{.seriesInfo}, [DOI 10.17487/RFC6528]{.seriesInfo}, February
    2012, \<<https://www.rfc-editor.org/info/rfc6528>\>.
:   

\[43\]
:   [Borman, D.]{.refAuthor}, [\"TCP Options and Maximum Segment Size
    (MSS)\"]{.refTitle}, [RFC 6691]{.seriesInfo}, [DOI
    10.17487/RFC6691]{.seriesInfo}, July 2012,
    \<<https://www.rfc-editor.org/info/rfc6691>\>.
:   

\[44\]
:   [Touch, J.]{.refAuthor}, [\"Updated Specification of the IPv4 ID
    Field\"]{.refTitle}, [RFC 6864]{.seriesInfo}, [DOI
    10.17487/RFC6864]{.seriesInfo}, February 2013,
    \<<https://www.rfc-editor.org/info/rfc6864>\>.
:   

\[45\]
:   [Touch, J.]{.refAuthor}, [\"Shared Use of Experimental TCP
    Options\"]{.refTitle}, [RFC 6994]{.seriesInfo}, [DOI
    10.17487/RFC6994]{.seriesInfo}, August 2013,
    \<<https://www.rfc-editor.org/info/rfc6994>\>.
:   

\[46\]
:   [McPherson, D.]{.refAuthor}, [Oran, D.]{.refAuthor},
    [Thaler, D.]{.refAuthor}, and [E. Osterweil]{.refAuthor},
    [\"Architectural Considerations of IP Anycast\"]{.refTitle}, [RFC
    7094]{.seriesInfo}, [DOI 10.17487/RFC7094]{.seriesInfo}, January
    2014, \<<https://www.rfc-editor.org/info/rfc7094>\>.
:   

\[47\]
:   [Borman, D.]{.refAuthor}, [Braden, B.]{.refAuthor},
    [Jacobson, V.]{.refAuthor}, and [R. Scheffenegger, Ed.]{.refAuthor},
    [\"TCP Extensions for High Performance\"]{.refTitle}, [RFC
    7323]{.seriesInfo}, [DOI 10.17487/RFC7323]{.seriesInfo}, September
    2014, \<<https://www.rfc-editor.org/info/rfc7323>\>.
:   

\[48\]
:   [Cheng, Y.]{.refAuthor}, [Chu, J.]{.refAuthor},
    [Radhakrishnan, S.]{.refAuthor}, and [A. Jain]{.refAuthor}, [\"TCP
    Fast Open\"]{.refTitle}, [RFC 7413]{.seriesInfo}, [DOI
    10.17487/RFC7413]{.seriesInfo}, December 2014,
    \<<https://www.rfc-editor.org/info/rfc7413>\>.
:   

\[49\]
:   [Duke, M.]{.refAuthor}, [Braden, R.]{.refAuthor},
    [Eddy, W.]{.refAuthor}, [Blanton, E.]{.refAuthor}, and [A.
    Zimmermann]{.refAuthor}, [\"A Roadmap for Transmission Control
    Protocol (TCP) Specification Documents\"]{.refTitle}, [RFC
    7414]{.seriesInfo}, [DOI 10.17487/RFC7414]{.seriesInfo}, February
    2015, \<<https://www.rfc-editor.org/info/rfc7414>\>.
:   

\[50\]
:   [Black, D., Ed.]{.refAuthor} and [P. Jones]{.refAuthor},
    [\"Differentiated Services (Diffserv) and Real-Time
    Communication\"]{.refTitle}, [RFC 7657]{.seriesInfo}, [DOI
    10.17487/RFC7657]{.seriesInfo}, November 2015,
    \<<https://www.rfc-editor.org/info/rfc7657>\>.
:   

\[51\]
:   [Fairhurst, G.]{.refAuthor} and [M. Welzl]{.refAuthor}, [\"The
    Benefits of Using Explicit Congestion Notification
    (ECN)\"]{.refTitle}, [RFC 8087]{.seriesInfo}, [DOI
    10.17487/RFC8087]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8087>\>.
:   

\[52\]
:   [Fairhurst, G., Ed.]{.refAuthor}, [Trammell, B., Ed.]{.refAuthor},
    and [M. Kuehlewind, Ed.]{.refAuthor}, [\"Services Provided by IETF
    Transport Protocols and Congestion Control Mechanisms\"]{.refTitle},
    [RFC 8095]{.seriesInfo}, [DOI 10.17487/RFC8095]{.seriesInfo}, March
    2017, \<<https://www.rfc-editor.org/info/rfc8095>\>.
:   

\[53\]
:   [Welzl, M.]{.refAuthor}, [Tuexen, M.]{.refAuthor}, and [N.
    Khademi]{.refAuthor}, [\"On the Usage of Transport Features Provided
    by IETF Transport Protocols\"]{.refTitle}, [RFC 8303]{.seriesInfo},
    [DOI 10.17487/RFC8303]{.seriesInfo}, February 2018,
    \<<https://www.rfc-editor.org/info/rfc8303>\>.
:   

\[54\]
:   [Black, D.]{.refAuthor}, [\"Relaxing Restrictions on Explicit
    Congestion Notification (ECN) Experimentation\"]{.refTitle}, [RFC
    8311]{.seriesInfo}, [DOI 10.17487/RFC8311]{.seriesInfo}, January
    2018, \<<https://www.rfc-editor.org/info/rfc8311>\>.
:   

\[55\]
:   [Chown, T.]{.refAuthor}, [Loughney, J.]{.refAuthor}, and [T.
    Winters]{.refAuthor}, [\"IPv6 Node Requirements\"]{.refTitle}, [BCP
    220]{.seriesInfo}, [RFC 8504]{.seriesInfo}, [DOI
    10.17487/RFC8504]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8504>\>.
:   

\[56\]
:   [Trammell, B.]{.refAuthor} and [M. Kuehlewind]{.refAuthor}, [\"The
    Wire Image of a Network Protocol\"]{.refTitle}, [RFC
    8546]{.seriesInfo}, [DOI 10.17487/RFC8546]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8546>\>.
:   

\[57\]
:   [Bittau, A.]{.refAuthor}, [Giffin, D.]{.refAuthor},
    [Handley, M.]{.refAuthor}, [Mazieres, D.]{.refAuthor},
    [Slack, Q.]{.refAuthor}, and [E. Smith]{.refAuthor},
    [\"Cryptographic Protection of TCP Streams (tcpcrypt)\"]{.refTitle},
    [RFC 8548]{.seriesInfo}, [DOI 10.17487/RFC8548]{.seriesInfo}, May
    2019, \<<https://www.rfc-editor.org/info/rfc8548>\>.
:   

\[58\]
:   [Hardie, T., Ed.]{.refAuthor}, [\"Transport Protocol Path
    Signals\"]{.refTitle}, [RFC 8558]{.seriesInfo}, [DOI
    10.17487/RFC8558]{.seriesInfo}, April 2019,
    \<<https://www.rfc-editor.org/info/rfc8558>\>.
:   

\[59\]
:   [Ford, A.]{.refAuthor}, [Raiciu, C.]{.refAuthor},
    [Handley, M.]{.refAuthor}, [Bonaventure, O.]{.refAuthor}, and [C.
    Paasch]{.refAuthor}, [\"TCP Extensions for Multipath Operation with
    Multiple Addresses\"]{.refTitle}, [RFC 8684]{.seriesInfo}, [DOI
    10.17487/RFC8684]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8684>\>.
:   

\[60\]
:   [Iyengar, J., Ed.]{.refAuthor} and [M. Thomson, Ed.]{.refAuthor},
    [\"QUIC: A UDP-Based Multiplexed and Secure Transport\"]{.refTitle},
    [RFC 9000]{.seriesInfo}, [DOI 10.17487/RFC9000]{.seriesInfo}, May
    2021, \<<https://www.rfc-editor.org/info/rfc9000>\>.
:   

\[61\]
:   [Fairhurst, G.]{.refAuthor} and [C. Perkins]{.refAuthor},
    [\"Considerations around Transport Header Confidentiality, Network
    Operations, and the Evolution of Internet Transport
    Protocols\"]{.refTitle}, [RFC 9065]{.seriesInfo}, [DOI
    10.17487/RFC9065]{.seriesInfo}, July 2021,
    \<<https://www.rfc-editor.org/info/rfc9065>\>.
:   

\[62\]
:   [IANA]{.refAuthor}, [\"Transmission Control Protocol (TCP)
    Parameters\"]{.refTitle},
    \<<https://www.iana.org/assignments/tcp-parameters/>\>.
:   

\[63\]
:   [Gont, F.]{.refAuthor}, [\"Processing of IP Security/Compartment and
    Precedence Information by TCP\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-gont-tcpm-tcp-seccomp-prec-00]{.seriesInfo}, 29 March 2012,
    \<<https://datatracker.ietf.org/doc/html/draft-gont-tcpm-tcp-seccomp-prec-00>\>.
:   

\[64\]
:   [Gont, F.]{.refAuthor} and [D. Borman]{.refAuthor}, [\"On the
    Validation of TCP Sequence Numbers\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-gont-tcpm-tcp-seq-validation-04]{.seriesInfo}, 11 March 2019,
    \<<https://datatracker.ietf.org/doc/html/draft-gont-tcpm-tcp-seq-validation-04>\>.
:   

\[65\]
:   [Touch, J.]{.refAuthor} and [W. M. Eddy]{.refAuthor}, [\"TCP
    Extended Data Offset Option\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-tcpm-tcp-edo-12]{.seriesInfo}, 15 April 2022,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-tcpm-tcp-edo-12>\>.
:   

\[66\]
:   [McQuistin, S.]{.refAuthor}, [Band, V.]{.refAuthor},
    [Jacob, D.]{.refAuthor}, and [C. Perkins]{.refAuthor}, [\"Describing
    Protocol Data Units with Augmented Packet Header
    Diagrams\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-mcquistin-augmented-ascii-diagrams-10]{.seriesInfo}, 7 March
    2022,
    \<<https://datatracker.ietf.org/doc/html/draft-mcquistin-augmented-ascii-diagrams-10>\>.
:   

\[67\]
:   [Thomson, M.]{.refAuthor} and [T. Pauly]{.refAuthor}, [\"Long-Term
    Viability of Protocol Extension Mechanisms\"]{.refTitle}, [RFC
    9170]{.seriesInfo}, [DOI 10.17487/RFC9170]{.seriesInfo}, December
    2021, \<<https://www.rfc-editor.org/info/rfc9170>\>.
:   

\[68\]
:   [Minshall, G.]{.refAuthor}, [\"A Suggested Modification to Nagle\'s
    Algorithm\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-minshall-nagle-01]{.seriesInfo}, 18 June
    1999,
    \<<https://datatracker.ietf.org/doc/html/draft-minshall-nagle-01>\>.
:   

\[69\]
:   [Dalal, Y.]{.refAuthor} and [C. Sunshine]{.refAuthor}, [\"Connection
    Management in Transport Protocols\"]{.refTitle}, [Computer Networks,
    Vol. 2, No. 6, pp. 454-473]{.refContent}, [DOI
    10.1016/0376-5075(78)90053-3]{.seriesInfo}, December 1978,
    \<<https://doi.org/10.1016/0376-5075(78)90053-3>\>.
:   

\[70\]
:   [Faber, T.]{.refAuthor}, [Touch, J.]{.refAuthor}, and [W.
    Yui]{.refAuthor}, [\"The TIME-WAIT state in TCP and Its Effect on
    Busy Servers\"]{.refTitle}, [Proceedings of IEEE INFOCOM, pp.
    1573-1583]{.refContent}, [DOI
    10.1109/INFCOM.1999.752180]{.seriesInfo}, March 1999,
    \<<https://doi.org/10.1109/INFCOM.1999.752180>\>.
:   

\[71\]
:   [Postel, J.]{.refAuthor}, [\"Comments on Action Items from the
    January Meeting\"]{.refTitle}, [IEN 177]{.seriesInfo}, March 1981,
    \<<https://www.rfc-editor.org/ien/ien177.txt>\>.
:   

\[72\]
:   [\"Segmentation Offloads\"]{.refTitle}, [The Linux Kernel
    Documentation]{.refContent},
    \<<https://www.kernel.org/doc/html/latest/networking/segmentation-offloads.html>\>.
:   

\[73\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 573]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid573>\>.
:   

\[74\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 574]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid574>\>.
:   

\[75\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 700]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid700>\>.
:   

\[76\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 701]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid701>\>.
:   

\[77\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1283]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1283>\>.
:   

\[78\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1561]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1561>\>.
:   

\[79\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1562]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1562>\>.
:   

\[80\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1564]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1564>\>.
:   

\[81\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1571]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1571>\>.
:   

\[82\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1572]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1572>\>.
:   

\[83\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 2297]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid2297>\>.
:   

\[84\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 2298]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid2298>\>.
:   

\[85\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 2748]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid2748>\>.
:   

\[86\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 2749]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid2749>\>.
:   

\[87\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 2934]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid2934>\>.
:   

\[88\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 3213]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid3213>\>.
:   

\[89\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 3300]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid3300>\>.
:   

\[90\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 3301]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid3301>\>.
:   

\[91\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 6222]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid6222>\>.
:   

\[92\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 572]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid572>\>.
:   

\[93\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 575]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid575>\>.
:   

\[94\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1565]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1565>\>.
:   

\[95\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 1569]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid1569>\>.
:   

\[96\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 2296]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid2296>\>.
:   

\[97\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 3305]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid3305>\>.
:   

\[98\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 3602]{.refTitle}, [RFC
    793]{.refContent}, \<<https://www.rfc-editor.org/errata/eid3602>\>.
:   

\[99\]
:   [RFC Errata]{.refAuthor}, [Erratum ID 4772]{.refTitle}, [RFC
    5961]{.refContent}, \<<https://www.rfc-editor.org/errata/eid4772>\>.
:   

\[100\]
:   [Gont, F.]{.refAuthor}, [\"ICMP Attacks against TCP\"]{.refTitle},
    [RFC 5927]{.seriesInfo}, [DOI 10.17487/RFC5927]{.seriesInfo}, July
    2010, \<<https://www.rfc-editor.org/info/rfc5927>\>.
:   
:::
:::

::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Other Implementation Notes](#name-other-implementation-notes){.section-name .selfRef} {#name-other-implementation-notes}

This section includes additional notes and references on TCP
implementation decisions that are currently not a part of the RFC series
or included within the TCP standard. These items can be considered by
implementers, but there was not yet a consensus to include them in the
standard.[¶](#appendix-A-1){.pilcrow}

::: {#seccomp}
::: {#appendix-A.1 .section}
### [A.1.](#appendix-A.1){.section-number .selfRef} [IP Security Compartment and Precedence](#name-ip-security-compartment-and){.section-name .selfRef} {#name-ip-security-compartment-and}

The IPv4 specification \[[1](#RFC0791){.xref}\] includes a precedence
value in the (now obsoleted) Type of Service (TOS) field. It was
modified in \[[20](#RFC1349){.xref}\] and then obsoleted by the
definition of Differentiated Services (Diffserv)
\[[4](#RFC2474){.xref}\]. Setting and conveying TOS between the network
layer, TCP implementation, and applications is obsolete and is replaced
by Diffserv in the current TCP
specification.[¶](#appendix-A.1-1){.pilcrow}

RFC 793 required checking the IP security compartment and precedence on
incoming TCP segments for consistency within a connection and with
application requests. Each of these aspects of IP have become outdated,
without specific updates to RFC 793. The issues with precedence were
fixed by \[[25](#RFC2873){.xref}\], which is Standards Track, and so
this present TCP specification includes those changes. However, the
state of IP security options that may be used by Multi-Level Secure
(MLS) systems is not as apparent in the IETF
currently.[¶](#appendix-A.1-2){.pilcrow}

Resetting connections when incoming packets do not meet expected
security compartment or precedence expectations has been recognized as a
possible attack vector \[[63](#I-D.gont-tcpm-tcp-seccomp-prec){.xref}\],
and there has been discussion about amending the TCP specification to
prevent connections from being aborted due to nonmatching IP security
compartment and Diffserv codepoint values.[¶](#appendix-A.1-3){.pilcrow}

::: {#appendix-A.1.1 .section}
#### [A.1.1.](#appendix-A.1.1){.section-number .selfRef} [Precedence](#name-precedence){.section-name .selfRef} {#name-precedence}

In Diffserv, the former precedence values are treated as Class Selector
codepoints, and methods for compatible treatment are described in the
Diffserv architecture. The RFC TCP specification defined by RFCs 793 and
1122 included logic intending to have connections use the highest
precedence requested by either endpoint application, and to keep the
precedence consistent throughout a connection. This logic from the
obsolete TOS is not applicable to Diffserv and should not be included in
TCP implementations, though changes to Diffserv values within a
connection are discouraged. For discussion of this, see RFC 7657
(Sections
[5.1](https://www.rfc-editor.org/rfc/rfc7657#section-5.1){.relref},
[5.3](https://www.rfc-editor.org/rfc/rfc7657#section-5.3){.relref}, and
[6](https://www.rfc-editor.org/rfc/rfc7657#section-6){.relref})
\[[50](#RFC7657){.xref}\].[¶](#appendix-A.1.1-1){.pilcrow}

The obsoleted TOS processing rules in TCP assumed bidirectional (or
symmetric) precedence values used on a connection, but the Diffserv
architecture is asymmetric. Problems with the old TCP logic in this
regard were described in \[[25](#RFC2873){.xref}\], and the solution
described is to ignore IP precedence in TCP. Since RFC 2873 is a
Standards Track document (although not marked as updating RFC 793),
current implementations are expected to be robust in these conditions.
Note that the Diffserv field value used in each direction is a part of
the interface between TCP and the network layer, and values in use can
be indicated both ways between TCP and the
application.[¶](#appendix-A.1.1-2){.pilcrow}
:::

::: {#appendix-A.1.2 .section}
#### [A.1.2.](#appendix-A.1.2){.section-number .selfRef} [MLS Systems](#name-mls-systems){.section-name .selfRef} {#name-mls-systems}

The IP Security Option (IPSO) and compartment defined in
\[[1](#RFC0791){.xref}\] was refined in RFC 1038, which was later
obsoleted by RFC 1108. The Commercial IP Security Option (CIPSO) is
defined in FIPS-188 (withdrawn by NIST in 2015) and is supported by some
vendors and operating systems. RFC 1108 is now Historic, though RFC 791
itself has not been updated to remove the IP Security Option. For IPv6,
a similar option (Common Architecture Label IPv6 Security Option
(CALIPSO)) has been defined \[[36](#RFC5570){.xref}\]. RFC 793 includes
logic that includes the IP security/compartment information in treatment
of TCP segments. References to the IP \"security/compartment\" in this
document may be relevant for Multi-Level Secure (MLS) system
implementers but can be ignored for non-MLS implementations, consistent
with running code on the Internet. See [Appendix A.1](#seccomp){.xref}
for further discussion. Note that RFC 5570 describes some MLS networking
scenarios where IPSO, CIPSO, or CALIPSO may be used. In these special
cases, TCP implementers should see Section
[7.3.1](https://www.rfc-editor.org/rfc/rfc5570#section-7.3.1){.relref}
of RFC 5570 and follow the guidance in that
document.[¶](#appendix-A.1.2-1){.pilcrow}
:::
:::
:::

::: {#seqval}
::: {#appendix-A.2 .section}
### [A.2.](#appendix-A.2){.section-number .selfRef} [Sequence Number Validation](#name-sequence-number-validation){.section-name .selfRef} {#name-sequence-number-validation}

There are cases where the TCP sequence number validation rules can
prevent ACK fields from being processed. This can result in connection
issues, as described in
\[[64](#I-D.gont-tcpm-tcp-seq-validation){.xref}\], which includes
descriptions of potential problems in conditions of simultaneous open,
self-connects, simultaneous close, and simultaneous window probes. The
document also describes potential changes to the TCP specification to
mitigate the issue by expanding the acceptable sequence
numbers.[¶](#appendix-A.2-1){.pilcrow}

In Internet usage of TCP, these conditions rarely occur. Common
operating systems include different alternative mitigations, and the
standard has not been updated yet to codify one of them, but
implementers should consider the problems described in
\[[64](#I-D.gont-tcpm-tcp-seq-validation){.xref}\].[¶](#appendix-A.2-2){.pilcrow}
:::
:::

::: {#minshall}
::: {#appendix-A.3 .section}
### [A.3.](#appendix-A.3){.section-number .selfRef} [Nagle Modification](#name-nagle-modification){.section-name .selfRef} {#name-nagle-modification}

In common operating systems, both the Nagle algorithm and delayed
acknowledgments are implemented and enabled by default. TCP is used by
many applications that have a request-response style of communication,
where the combination of the Nagle algorithm and delayed acknowledgments
can result in poor application performance. A modification to the Nagle
algorithm is described in \[[68](#I-D.minshall-nagle){.xref}\] that
improves the situation for these
applications.[¶](#appendix-A.3-1){.pilcrow}

This modification is implemented in some common operating systems and
does not impact TCP interoperability. Additionally, many applications
simply disable Nagle since this is generally supported by a socket
option. The TCP standard has not been updated to include this Nagle
modification, but implementers may find it beneficial to
consider.[¶](#appendix-A.3-2){.pilcrow}
:::
:::

::: {#appendix-A.4 .section}
### [A.4.](#appendix-A.4){.section-number .selfRef} [Low Watermark Settings](#name-low-watermark-settings){.section-name .selfRef} {#name-low-watermark-settings}

Some operating system kernel TCP implementations include socket options
that allow specifying the number of bytes in the buffer until the socket
layer will pass sent data to TCP (SO_SNDLOWAT) or to the application on
receiving (SO_RCVLOWAT).[¶](#appendix-A.4-1){.pilcrow}

In addition, another socket option (TCP_NOTSENT_LOWAT) can be used to
control the amount of unsent bytes in the write queue. This can help a
sending TCP application to avoid creating large amounts of buffered data
(and corresponding latency). As an example, this may be useful for
applications that are multiplexing data from multiple upper-level
streams onto a connection, especially when streams may be a mix of
interactive/real-time and bulk data
transfer.[¶](#appendix-A.4-2){.pilcrow}
:::
:::

::: {#reqs}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [TCP Requirement Summary](#name-tcp-requirement-summary){.section-name .selfRef} {#name-tcp-requirement-summary}

This section is adapted from RFC 1122.[¶](#appendix-B-1){.pilcrow}

Note that there is no requirement related to PLPMTUD in this list, but
that PLPMTUD is recommended.[¶](#appendix-B-2){.pilcrow}

[]{#name-tcp-requirements-summary}

::: {#tcp-req-summary}
+---------+---------+---------+---------+---------+---------+---------+
| Feature | ReqID   | [MUST]{ | [S      | [MAY]{  | [SHOULD | [MUST   |
|         |         | .bcp14} | HOULD]{ | .bcp14} | NOT]{   | NOT]{   |
|         |         |         | .bcp14} |         | .bcp14} | .bcp14} |
+=========+=========+=========+=========+=========+=========+=========+
| PUSH    |         |         |         |         |         |         |
| flag    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ag      | MAY-16  |         |         | X       |         |         |
| gregate |         |         |         |         |         |         |
| or      |         |         |         |         |         |         |
| queue   |         |         |         |         |         |         |
| un      |         |         |         |         |         |         |
| -pushed |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Sender  | SHLD-27 |         | X       |         |         |         |
| c       |         |         |         |         |         |         |
| ollapse |         |         |         |         |         |         |
| suc     |         |         |         |         |         |         |
| cessive |         |         |         |         |         |         |
| PSH     |         |         |         |         |         |         |
| bits    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| SEND    | MAY-15  |         |         | X       |         |         |
| call    |         |         |         |         |         |         |
| can     |         |         |         |         |         |         |
| specify |         |         |         |         |         |         |
| PUSH    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [If | MUST-60 |         |         |         |         | X       |
|         |         |         |         |         |         |         |
| cannot: |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  sender |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  buffer |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  indefi |         |         |         |         |         |         |
| nitely[ |         |         |         |         |         |         |
| ¶](#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.5. |         |         |         |         |         |         |
| 1.1.1){ |         |         |         |         |         |         |
| .pilcro |         |         |         |         |         |         |
| w}]{#ap |         |         |         |         |         |         |
| pendix- |         |         |         |         |         |         |
| B-3.2.5 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [If | MUST-61 | X       |         |         |         |         |
|         |         |         |         |         |         |         |
| cannot: |         |         |         |         |         |         |
|     PSH |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    last |         |         |         |         |         |         |
|     s   |         |         |         |         |         |         |
| egment[ |         |         |         |         |         |         |
| ¶](#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.6. |         |         |         |         |         |         |
| 1.1.1){ |         |         |         |         |         |         |
| .pilcro |         |         |         |         |         |         |
| w}]{#ap |         |         |         |         |         |         |
| pendix- |         |         |         |         |         |         |
| B-3.2.6 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Notify  | MAY-17  |         |         | X       |         |         |
| re      |         |         |         |         |         |         |
| ceiving |         |         |         |         |         |         |
| ALP^1^  |         |         |         |         |         |         |
| of PSH  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Send    | SHLD-28 |         | X       |         |         |         |
| max     |         |         |         |         |         |         |
| size    |         |         |         |         |         |         |
| segment |         |         |         |         |         |         |
| when    |         |         |         |         |         |         |
| p       |         |         |         |         |         |         |
| ossible |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Window  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Treat   | MUST-1  | X       |         |         |         |         |
| as      |         |         |         |         |         |         |
| u       |         |         |         |         |         |         |
| nsigned |         |         |         |         |         |         |
| number  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Handle  | REC-1   |         | X       |         |         |         |
| as      |         |         |         |         |         |         |
| 32-bit  |         |         |         |         |         |         |
| number  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Shrink  | SHLD-14 |         |         |         | X       |         |
| window  |         |         |         |         |         |         |
| from    |         |         |         |         |         |         |
| right   |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-15 |         |         |         | X       |         |
|   [Send |         |         |         |         |         |         |
|     new |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    data |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    when |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  window |         |         |         |         |         |         |
|     shr |         |         |         |         |         |         |
| inks[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.13.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.13 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-16 |         | X       |         |         |         |
|    [Ret |         |         |         |         |         |         |
| ransmit |         |         |         |         |         |         |
|     old |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| unacked |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    data |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  within |         |         |         |         |         |         |
|     wi  |         |         |         |         |         |         |
| ndow[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.14.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.14 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-17 |         |         |         | X       |         |
|   [Time |         |         |         |         |         |         |
|     out |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    conn |         |         |         |         |         |         |
|     for |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    data |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    past |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   right |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| edge[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.15.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.15 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Robust  | MUST-34 | X       |         |         |         |         |
| against |         |         |         |         |         |         |
| sh      |         |         |         |         |         |         |
| rinking |         |         |         |         |         |         |
| window  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Rece    | MAY-8   |         |         | X       |         |         |
| iver\'s |         |         |         |         |         |         |
| window  |         |         |         |         |         |         |
| closed  |         |         |         |         |         |         |
| indef   |         |         |         |         |         |         |
| initely |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Use     | MUST-35 | X       |         |         |         |         |
| s       |         |         |         |         |         |         |
| tandard |         |         |         |         |         |         |
| probing |         |         |         |         |         |         |
| logic   |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Sender  | MUST-36 | X       |         |         |         |         |
| probe   |         |         |         |         |         |         |
| zero    |         |         |         |         |         |         |
| window  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-29 |         | X       |         |         |         |
|  [First |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   probe |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   after |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  RTO[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.20.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.20 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-30 |         | X       |         |         |         |
|   [Expo |         |         |         |         |         |         |
| nential |         |         |         |         |         |         |
|     bac |         |         |         |         |         |         |
| koff[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.21.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.21 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Allow   | MUST-37 | X       |         |         |         |         |
| window  |         |         |         |         |         |         |
| stay    |         |         |         |         |         |         |
| zero    |         |         |         |         |         |         |
| indef   |         |         |         |         |         |         |
| initely |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ret     | MAY-7   |         |         | X       |         |         |
| ransmit |         |         |         |         |         |         |
| old     |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
| beyond  |         |         |         |         |         |         |
| S       |         |         |         |         |         |         |
| ND.UNA+ |         |         |         |         |         |         |
| SND.WND |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Process | MUST-66 | X       |         |         |         |         |
| RST and |         |         |         |         |         |         |
| URG     |         |         |         |         |         |         |
| even    |         |         |         |         |         |         |
| with    |         |         |         |         |         |         |
| zero    |         |         |         |         |         |         |
| window  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Urgent  |         |         |         |         |         |         |
| Data    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Include | MUST-30 | X       |         |         |         |         |
| support |         |         |         |         |         |         |
| for     |         |         |         |         |         |         |
| urgent  |         |         |         |         |         |         |
| pointer |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Pointer | MUST-62 | X       |         |         |         |         |
| in      |         |         |         |         |         |         |
| dicates |         |         |         |         |         |         |
| first   |         |         |         |         |         |         |
| non     |         |         |         |         |         |         |
| -urgent |         |         |         |         |         |         |
| octet   |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ar      | MUST-31 | X       |         |         |         |         |
| bitrary |         |         |         |         |         |         |
| length  |         |         |         |         |         |         |
| urgent  |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
| s       |         |         |         |         |         |         |
| equence |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Inform  | MUST-32 | X       |         |         |         |         |
| ALP^1^  |         |         |         |         |         |         |
| asynchr |         |         |         |         |         |         |
| onously |         |         |         |         |         |         |
| of      |         |         |         |         |         |         |
| urgent  |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP^1^  | MUST-33 | X       |         |         |         |         |
| can     |         |         |         |         |         |         |
| learn   |         |         |         |         |         |         |
| if/how  |         |         |         |         |         |         |
| much    |         |         |         |         |         |         |
| urgent  |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
| Q\'d    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP     | SHLD-13 |         |         |         | X       |         |
| employ  |         |         |         |         |         |         |
| the     |         |         |         |         |         |         |
| urgent  |         |         |         |         |         |         |
| me      |         |         |         |         |         |         |
| chanism |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| TCP     |         |         |         |         |         |         |
| Options |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Support | MUST-4  | X       |         |         |         |         |
| the     |         |         |         |         |         |         |
| ma      |         |         |         |         |         |         |
| ndatory |         |         |         |         |         |         |
| option  |         |         |         |         |         |         |
| set     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Receive | MUST-5  | X       |         |         |         |         |
| TCP     |         |         |         |         |         |         |
| Option  |         |         |         |         |         |         |
| in any  |         |         |         |         |         |         |
| segment |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ignore  | MUST-6  | X       |         |         |         |         |
| unsu    |         |         |         |         |         |         |
| pported |         |         |         |         |         |         |
| options |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Include | MUST-68 | X       |         |         |         |         |
| length  |         |         |         |         |         |         |
| for all |         |         |         |         |         |         |
| options |         |         |         |         |         |         |
| except  |         |         |         |         |         |         |
| EOL+NOP |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Cope    | MUST-7  | X       |         |         |         |         |
| with    |         |         |         |         |         |         |
| illegal |         |         |         |         |         |         |
| option  |         |         |         |         |         |         |
| length  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Process | MUST-64 | X       |         |         |         |         |
| options |         |         |         |         |         |         |
| reg     |         |         |         |         |         |         |
| ardless |         |         |         |         |         |         |
| of word |         |         |         |         |         |         |
| al      |         |         |         |         |         |         |
| ignment |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Im      | MUST-14 | X       |         |         |         |         |
| plement |         |         |         |         |         |         |
| sending |         |         |         |         |         |         |
| &       |         |         |         |         |         |         |
| re      |         |         |         |         |         |         |
| ceiving |         |         |         |         |         |         |
| MSS     |         |         |         |         |         |         |
| Option  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| IPv4    | SHLD-5  |         | X       |         |         |         |
| Send    |         |         |         |         |         |         |
| MSS     |         |         |         |         |         |         |
| Option  |         |         |         |         |         |         |
| unless  |         |         |         |         |         |         |
| 536     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| IPv6    | SHLD-5  |         | X       |         |         |         |
| Send    |         |         |         |         |         |         |
| MSS     |         |         |         |         |         |         |
| Option  |         |         |         |         |         |         |
| unless  |         |         |         |         |         |         |
| 1220    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Send    | MAY-3   |         |         | X       |         |         |
| MSS     |         |         |         |         |         |         |
| Option  |         |         |         |         |         |         |
| always  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| IPv4    | MUST-15 | X       |         |         |         |         |
| S       |         |         |         |         |         |         |
| end-MSS |         |         |         |         |         |         |
| default |         |         |         |         |         |         |
| is 536  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| IPv6    | MUST-15 | X       |         |         |         |         |
| S       |         |         |         |         |         |         |
| end-MSS |         |         |         |         |         |         |
| default |         |         |         |         |         |         |
| is 1220 |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ca      | MUST-16 | X       |         |         |         |         |
| lculate |         |         |         |         |         |         |
| ef      |         |         |         |         |         |         |
| fective |         |         |         |         |         |         |
| send    |         |         |         |         |         |         |
| seg     |         |         |         |         |         |         |
| size    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| MSS     | SHLD-6  |         | X       |         |         |         |
| a       |         |         |         |         |         |         |
| ccounts |         |         |         |         |         |         |
| for     |         |         |         |         |         |         |
| varying |         |         |         |         |         |         |
| MTU     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| MSS not | MUST-65 |         |         |         |         | X       |
| sent on |         |         |         |         |         |         |
| non-SYN |         |         |         |         |         |         |
| s       |         |         |         |         |         |         |
| egments |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| MSS     | MUST-67 | X       |         |         |         |         |
| value   |         |         |         |         |         |         |
| based   |         |         |         |         |         |         |
| on      |         |         |         |         |         |         |
| MMS_R   |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Pad     | MUST-69 | X       |         |         |         |         |
| with    |         |         |         |         |         |         |
| zero    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| TCP     |         |         |         |         |         |         |
| Ch      |         |         |         |         |         |         |
| ecksums |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Sender  | MUST-2  | X       |         |         |         |         |
| compute |         |         |         |         |         |         |
| c       |         |         |         |         |         |         |
| hecksum |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| R       | MUST-3  | X       |         |         |         |         |
| eceiver |         |         |         |         |         |         |
| check   |         |         |         |         |         |         |
| c       |         |         |         |         |         |         |
| hecksum |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ISN     |         |         |         |         |         |         |
| Se      |         |         |         |         |         |         |
| lection |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Include | MUST-8  | X       |         |         |         |         |
| a       |         |         |         |         |         |         |
| clock   |         |         |         |         |         |         |
| -driven |         |         |         |         |         |         |
| ISN     |         |         |         |         |         |         |
| ge      |         |         |         |         |         |         |
| nerator |         |         |         |         |         |         |
| co      |         |         |         |         |         |         |
| mponent |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Secure  | SHLD-1  |         | X       |         |         |         |
| ISN     |         |         |         |         |         |         |
| ge      |         |         |         |         |         |         |
| nerator |         |         |         |         |         |         |
| with a  |         |         |         |         |         |         |
| PRF     |         |         |         |         |         |         |
| co      |         |         |         |         |         |         |
| mponent |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| PRF     | MUST-9  |         |         |         |         | X       |
| com     |         |         |         |         |         |         |
| putable |         |         |         |         |         |         |
| from    |         |         |         |         |         |         |
| outside |         |         |         |         |         |         |
| the     |         |         |         |         |         |         |
| host    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Opening |         |         |         |         |         |         |
| Conn    |         |         |         |         |         |         |
| ections |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Support | MUST-10 | X       |         |         |         |         |
| simul   |         |         |         |         |         |         |
| taneous |         |         |         |         |         |         |
| open    |         |         |         |         |         |         |
| a       |         |         |         |         |         |         |
| ttempts |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| SYN-R   | MUST-11 | X       |         |         |         |         |
| ECEIVED |         |         |         |         |         |         |
| re      |         |         |         |         |         |         |
| members |         |         |         |         |         |         |
| last    |         |         |         |         |         |         |
| state   |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Passive | MUST-41 |         |         |         |         | X       |
| OPEN    |         |         |         |         |         |         |
| call    |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| terfere |         |         |         |         |         |         |
| with    |         |         |         |         |         |         |
| others  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Fu      | MUST-42 | X       |         |         |         |         |
| nction: |         |         |         |         |         |         |
| simulta |         |         |         |         |         |         |
| neously |         |         |         |         |         |         |
| LISTENs |         |         |         |         |         |         |
| for     |         |         |         |         |         |         |
| same    |         |         |         |         |         |         |
| port    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ask IP  | MUST-44 | X       |         |         |         |         |
| for src |         |         |         |         |         |         |
| address |         |         |         |         |         |         |
| for SYN |         |         |         |         |         |         |
| if      |         |         |         |         |         |         |
| ne      |         |         |         |         |         |         |
| cessary |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-45 | X       |         |         |         |         |
|    [Oth |         |         |         |         |         |         |
| erwise, |         |         |         |         |         |         |
|     use |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   local |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    addr |         |         |         |         |         |         |
|     of  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  connec |         |         |         |         |         |         |
| tion[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.63.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.63 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| OPEN to | MUST-46 |         |         |         |         | X       |
| broad   |         |         |         |         |         |         |
| cast/mu |         |         |         |         |         |         |
| lticast |         |         |         |         |         |         |
| IP      |         |         |         |         |         |         |
| address |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| S       | MUST-57 | X       |         |         |         |         |
| ilently |         |         |         |         |         |         |
| discard |         |         |         |         |         |         |
| seg to  |         |         |         |         |         |         |
| bcas    |         |         |         |         |         |         |
| t/mcast |         |         |         |         |         |         |
| addr    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Closing |         |         |         |         |         |         |
| Conn    |         |         |         |         |         |         |
| ections |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| RST can | SHLD-2  |         | X       |         |         |         |
| contain |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Inform  | MUST-12 | X       |         |         |         |         |
| appl    |         |         |         |         |         |         |
| ication |         |         |         |         |         |         |
| of      |         |         |         |         |         |         |
| aborted |         |         |         |         |         |         |
| conn    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Half    | MAY-1   |         |         | X       |         |         |
| -duplex |         |         |         |         |         |         |
| close   |         |         |         |         |         |         |
| conn    |         |         |         |         |         |         |
| ections |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-3  |         | X       |         |         |         |
|   [Send |         |         |         |         |         |         |
|     RST |         |         |         |         |         |         |
|     to  |         |         |         |         |         |         |
|     i   |         |         |         |         |         |         |
| ndicate |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    data |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| lost[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.70.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.70 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| In      | MUST-13 | X       |         |         |         |         |
| TI      |         |         |         |         |         |         |
| ME-WAIT |         |         |         |         |         |         |
| state   |         |         |         |         |         |         |
| for     |         |         |         |         |         |         |
| 2MSL    |         |         |         |         |         |         |
| seconds |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MAY-2   |         |         | X       |         |         |
| [Accept |         |         |         |         |         |         |
|     SYN |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    from |         |         |         |         |         |         |
|     TI  |         |         |         |         |         |         |
| ME-WAIT |         |         |         |         |         |         |
|     s   |         |         |         |         |         |         |
| tate[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.72.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.72 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-4  |         | X       |         |         |         |
|    [Use |         |         |         |         |         |         |
|     Tim |         |         |         |         |         |         |
| estamps |         |         |         |         |         |         |
|     to  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  reduce |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   TIME- |         |         |         |         |         |         |
| WAIT[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.73.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.73 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| R       |         |         |         |         |         |         |
| etransm |         |         |         |         |         |         |
| issions |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Im      | MUST-19 | X       |         |         |         |         |
| plement |         |         |         |         |         |         |
| expo    |         |         |         |         |         |         |
| nential |         |         |         |         |         |         |
| b       |         |         |         |         |         |         |
| ackoff, |         |         |         |         |         |         |
| slow    |         |         |         |         |         |         |
| start,  |         |         |         |         |         |         |
| and     |         |         |         |         |         |         |
| con     |         |         |         |         |         |         |
| gestion |         |         |         |         |         |         |
| av      |         |         |         |         |         |         |
| oidance |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ret     | MAY-4   |         |         | X       |         |         |
| ransmit |         |         |         |         |         |         |
| with    |         |         |         |         |         |         |
| same IP |         |         |         |         |         |         |
| i       |         |         |         |         |         |         |
| dentity |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Karn\'s | MUST-18 | X       |         |         |         |         |
| al      |         |         |         |         |         |         |
| gorithm |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Gen     |         |         |         |         |         |         |
| erating |         |         |         |         |         |         |
| ACKs    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ag      | MUST-58 | X       |         |         |         |         |
| gregate |         |         |         |         |         |         |
| w       |         |         |         |         |         |         |
| henever |         |         |         |         |         |         |
| p       |         |         |         |         |         |         |
| ossible |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Queue   | SHLD-31 |         | X       |         |         |         |
| out-o   |         |         |         |         |         |         |
| f-order |         |         |         |         |         |         |
| s       |         |         |         |         |         |         |
| egments |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Process | MUST-59 | X       |         |         |         |         |
| all     |         |         |         |         |         |         |
| Q\'d    |         |         |         |         |         |         |
| before  |         |         |         |         |         |         |
| send    |         |         |         |         |         |         |
| ACK     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Send    | MAY-13  |         |         | X       |         |         |
| ACK for |         |         |         |         |         |         |
| out-o   |         |         |         |         |         |         |
| f-order |         |         |         |         |         |         |
| segment |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Delayed | SHLD-18 |         | X       |         |         |         |
| ACKs    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-40 | X       |         |         |         |         |
|  [Delay |         |         |         |         |         |         |
|     \<  |         |         |         |         |         |         |
|     0.5 |         |         |         |         |         |         |
|     sec |         |         |         |         |         |         |
| onds[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.84.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.84 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-19 |         | X       |         |         |         |
|  [Every |         |         |         |         |         |         |
|     2nd |         |         |         |         |         |         |
|     ful |         |         |         |         |         |         |
| l-sized |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| segment |         |         |         |         |         |         |
|     or  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| 2\*RMSS |         |         |         |         |         |         |
|     AC  |         |         |         |         |         |         |
| K\'d[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.85.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.85 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| R       | MUST-39 | X       |         |         |         |         |
| eceiver |         |         |         |         |         |         |
| SWS-Av  |         |         |         |         |         |         |
| oidance |         |         |         |         |         |         |
| Al      |         |         |         |         |         |         |
| gorithm |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Sending |         |         |         |         |         |         |
| Data    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Confi   | MUST-49 | X       |         |         |         |         |
| gurable |         |         |         |         |         |         |
| TTL     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Sender  | MUST-38 | X       |         |         |         |         |
| SWS-Av  |         |         |         |         |         |         |
| oidance |         |         |         |         |         |         |
| Al      |         |         |         |         |         |         |
| gorithm |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Nagle   | SHLD-7  |         | X       |         |         |         |
| al      |         |         |         |         |         |         |
| gorithm |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-17 | X       |         |         |         |         |
|   [Appl |         |         |         |         |         |         |
| ication |         |         |         |         |         |         |
|     can |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| disable |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   Nagle |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   algor |         |         |         |         |         |         |
| ithm[¶] |         |         |         |         |         |         |
| (#appen |         |         |         |         |         |         |
| dix-B-3 |         |         |         |         |         |         |
| .2.91.1 |         |         |         |         |         |         |
| .1.1){. |         |         |         |         |         |         |
| pilcrow |         |         |         |         |         |         |
| }]{#app |         |         |         |         |         |         |
| endix-B |         |         |         |         |         |         |
| -3.2.91 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Con     |         |         |         |         |         |         |
| nection |         |         |         |         |         |         |
| F       |         |         |         |         |         |         |
| ailures |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| N       | MUST-20 | X       |         |         |         |         |
| egative |         |         |         |         |         |         |
| advice  |         |         |         |         |         |         |
| to IP   |         |         |         |         |         |         |
| on R1   |         |         |         |         |         |         |
| r       |         |         |         |         |         |         |
| etransm |         |         |         |         |         |         |
| issions |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Close   | MUST-20 | X       |         |         |         |         |
| con     |         |         |         |         |         |         |
| nection |         |         |         |         |         |         |
| on R2   |         |         |         |         |         |         |
| r       |         |         |         |         |         |         |
| etransm |         |         |         |         |         |         |
| issions |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP^1^  | MUST-21 | X       |         |         |         |         |
| can set |         |         |         |         |         |         |
| R2      |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Inform  | SHLD-9  |         | X       |         |         |         |
| ALP of  |         |         |         |         |         |         |
| R1\<=re |         |         |         |         |         |         |
| txs\<R2 |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Reco    | SHLD-10 |         | X       |         |         |         |
| mmended |         |         |         |         |         |         |
| value   |         |         |         |         |         |         |
| for R1  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Reco    | SHLD-11 |         | X       |         |         |         |
| mmended |         |         |         |         |         |         |
| value   |         |         |         |         |         |         |
| for R2  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Same    | MUST-22 | X       |         |         |         |         |
| me      |         |         |         |         |         |         |
| chanism |         |         |         |         |         |         |
| for     |         |         |         |         |         |         |
| SYNs    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [R2 | MUST-23 | X       |         |         |         |         |
|     at  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   least |         |         |         |         |         |         |
|     3   |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| minutes |         |         |         |         |         |         |
|     for |         |         |         |         |         |         |
|     S   |         |         |         |         |         |         |
| YN[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .100.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.100 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Send    |         |         |         |         |         |         |
| Kee     |         |         |         |         |         |         |
| p-alive |         |         |         |         |         |         |
| Packets |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Send    | MAY-5   |         | X       |         |         |         |
| Kee     |         |         |         |         |         |         |
| p-alive |         |         |         |         |         |         |
| P       |         |         |         |         |         |         |
| ackets: |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-24 | X       |         |         |         |         |
|   [Appl |         |         |         |         |         |         |
| ication |         |         |         |         |         |         |
|     can |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   reque |         |         |         |         |         |         |
| st[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .103.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.103 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [   | MUST-25 | X       |         |         |         |         |
| Default |         |         |         |         |         |         |
|     is  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   \"off |         |         |         |         |         |         |
| \"[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .104.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.104 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-26 | X       |         |         |         |         |
|   [Only |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    send |         |         |         |         |         |         |
|     if  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    idle |         |         |         |         |         |         |
|     for |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  interv |         |         |         |         |         |         |
| al[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .105.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.105 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [I  | MUST-27 | X       |         |         |         |         |
| nterval |         |         |         |         |         |         |
|     con |         |         |         |         |         |         |
| figurab |         |         |         |         |         |         |
| le[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .106.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.106 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [   | MUST-28 | X       |         |         |         |         |
| Default |         |         |         |         |         |         |
|     at  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   least |         |         |         |         |         |         |
|     2   |         |         |         |         |         |         |
|     hr  |         |         |         |         |         |         |
| s.[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .107.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.107 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [T  | MUST-29 | X       |         |         |         |         |
| olerant |         |         |         |         |         |         |
|     of  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    lost |         |         |         |         |         |         |
|     AC  |         |         |         |         |         |         |
| Ks[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .108.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.108 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-12 |         | X       |         |         |         |
|   [Send |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    with |         |         |         |         |         |         |
|     no  |         |         |         |         |         |         |
|     da  |         |         |         |         |         |         |
| ta[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .109.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.109 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MAY-6   |         |         | X       |         |         |
|  [Confi |         |         |         |         |         |         |
| gurable |         |         |         |         |         |         |
|     to  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    send |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| garbage |         |         |         |         |         |         |
|     oct |         |         |         |         |         |         |
| et[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .110.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.110 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| IP      |         |         |         |         |         |         |
| Options |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ignore  | MUST-50 | X       |         |         |         |         |
| options |         |         |         |         |         |         |
| TCP     |         |         |         |         |         |         |
| d       |         |         |         |         |         |         |
| oesn\'t |         |         |         |         |         |         |
| und     |         |         |         |         |         |         |
| erstand |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Ti      | MAY-10  |         | X       |         |         |         |
| mestamp |         |         |         |         |         |         |
| support |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Record  | MAY-11  |         | X       |         |         |         |
| Route   |         |         |         |         |         |         |
| support |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Source  |         |         |         |         |         |         |
| Route:  |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-51 | X       |         |         |         |         |
| [ALP^1^ |         |         |         |         |         |         |
|     can |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   speci |         |         |         |         |         |         |
| fy[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .116.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.116 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -   [Ov | MUST-52 | X       |         |         |         |         |
| errides |         |         |         |         |         |         |
|     src |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   route |         |         |         |         |         |         |
|     in  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  datagr |         |         |         |         |         |         |
| am[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .117.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.117 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-53 | X       |         |         |         |         |
|  [Build |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  return |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   route |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    from |         |         |         |         |         |         |
|     src |         |         |         |         |         |         |
|     rou |         |         |         |         |         |         |
| te[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .118.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.118 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-24 |         | X       |         |         |         |
|  [Later |         |         |         |         |         |         |
|     src |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   route |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| overrid |         |         |         |         |         |         |
| es[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .119.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.119 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Re      |         |         |         |         |         |         |
| ceiving |         |         |         |         |         |         |
| ICMP    |         |         |         |         |         |         |
| M       |         |         |         |         |         |         |
| essages |         |         |         |         |         |         |
| from IP |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Re      | MUST-54 | X       |         |         |         |         |
| ceiving |         |         |         |         |         |         |
| ICMP    |         |         |         |         |         |         |
| m       |         |         |         |         |         |         |
| essages |         |         |         |         |         |         |
| from IP |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-25 | X       |         |         |         |         |
|   [Dest |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| Unreach |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| (0,1,5) |         |         |         |         |         |         |
|     =>  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  inform |         |         |         |         |         |         |
|     A   |         |         |         |         |         |         |
| LP[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .122.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.122 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-56 |         |         |         |         | X       |
|  [Abort |         |         |         |         |         |         |
|     on  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    Dest |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| Unreach |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   (0,1, |         |         |         |         |         |         |
| 5)[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .123.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.123 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-26 |         | X       |         |         |         |
|   [Dest |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| Unreach |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   (2-4) |         |         |         |         |         |         |
|     =>  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   abort |         |         |         |         |         |         |
|     co  |         |         |         |         |         |         |
| nn[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .124.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.124 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-55 | X       |         |         |         |         |
| [Source |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  Quench |         |         |         |         |         |         |
|     =>  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  silent |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   disca |         |         |         |         |         |         |
| rd[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .125.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.125 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-56 |         |         |         |         | X       |
|  [Abort |         |         |         |         |         |         |
|     on  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|    Time |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|  Exceed |         |         |         |         |         |         |
| ed[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .126.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.126 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | MUST-56 |         |         |         |         | X       |
|  [Abort |         |         |         |         |         |         |
|     on  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   Param |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
|   Probl |         |         |         |         |         |         |
| em[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .127.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.127 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Address |         |         |         |         |         |         |
| Val     |         |         |         |         |         |         |
| idation |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Reject  | MUST-46 | X       |         |         |         |         |
| OPEN    |         |         |         |         |         |         |
| call to |         |         |         |         |         |         |
| invalid |         |         |         |         |         |         |
| IP      |         |         |         |         |         |         |
| address |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Reject  | MUST-63 | X       |         |         |         |         |
| SYN     |         |         |         |         |         |         |
| from    |         |         |         |         |         |         |
| invalid |         |         |         |         |         |         |
| IP      |         |         |         |         |         |         |
| address |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| S       | MUST-57 | X       |         |         |         |         |
| ilently |         |         |         |         |         |         |
| discard |         |         |         |         |         |         |
| SYN to  |         |         |         |         |         |         |
| bcas    |         |         |         |         |         |         |
| t/mcast |         |         |         |         |         |         |
| addr    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| TCP/ALP |         |         |         |         |         |         |
| In      |         |         |         |         |         |         |
| terface |         |         |         |         |         |         |
| S       |         |         |         |         |         |         |
| ervices |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Error   | MUST-47 | X       |         |         |         |         |
| Report  |         |         |         |         |         |         |
| me      |         |         |         |         |         |         |
| chanism |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP can | SHLD-20 |         | X       |         |         |         |
| disable |         |         |         |         |         |         |
| Error   |         |         |         |         |         |         |
| Report  |         |         |         |         |         |         |
| Routine |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP can | MUST-48 | X       |         |         |         |         |
| specify |         |         |         |         |         |         |
| D       |         |         |         |         |         |         |
| iffserv |         |         |         |         |         |         |
| field   |         |         |         |         |         |         |
| for     |         |         |         |         |         |         |
| sending |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| -       | SHLD-22 |         | X       |         |         |         |
| [Passed |         |         |         |         |         |         |
|     un  |         |         |         |         |         |         |
| changed |         |         |         |         |         |         |
|     to  |         |         |         |         |         |         |
|         |         |         |         |         |         |         |
| IP[¶](# |         |         |         |         |         |         |
| appendi |         |         |         |         |         |         |
| x-B-3.2 |         |         |         |         |         |         |
| .136.1. |         |         |         |         |         |         |
| 1.1){.p |         |         |         |         |         |         |
| ilcrow} |         |         |         |         |         |         |
| ]{#appe |         |         |         |         |         |         |
| ndix-B- |         |         |         |         |         |         |
| 3.2.136 |         |         |         |         |         |         |
| .1.1.1} |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP can | SHLD-21 |         | X       |         |         |         |
| change  |         |         |         |         |         |         |
| D       |         |         |         |         |         |         |
| iffserv |         |         |         |         |         |         |
| field   |         |         |         |         |         |         |
| during  |         |         |         |         |         |         |
| con     |         |         |         |         |         |         |
| nection |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| ALP     | SHLD-23 |         |         |         | X       |         |
| ge      |         |         |         |         |         |         |
| nerally |         |         |         |         |         |         |
| c       |         |         |         |         |         |         |
| hanging |         |         |         |         |         |         |
| D       |         |         |         |         |         |         |
| iffserv |         |         |         |         |         |         |
| during  |         |         |         |         |         |         |
| conn.   |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Pass    | MAY-9   |         |         | X       |         |         |
| r       |         |         |         |         |         |         |
| eceived |         |         |         |         |         |         |
| D       |         |         |         |         |         |         |
| iffserv |         |         |         |         |         |         |
| field   |         |         |         |         |         |         |
| up to   |         |         |         |         |         |         |
| ALP     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| FLUSH   | MAY-14  |         |         | X       |         |         |
| call    |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| O       | MUST-43 | X       |         |         |         |         |
| ptional |         |         |         |         |         |         |
| local   |         |         |         |         |         |         |
| IP addr |         |         |         |         |         |         |
| param   |         |         |         |         |         |         |
| in OPEN |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| RFC     |         |         |         |         |         |         |
| 5961    |         |         |         |         |         |         |
| Support |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Im      | MAY-12  |         |         | X       |         |         |
| plement |         |         |         |         |         |         |
| data    |         |         |         |         |         |         |
| in      |         |         |         |         |         |         |
| jection |         |         |         |         |         |         |
| pro     |         |         |         |         |         |         |
| tection |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| E       |         |         |         |         |         |         |
| xplicit |         |         |         |         |         |         |
| Con     |         |         |         |         |         |         |
| gestion |         |         |         |         |         |         |
| Notif   |         |         |         |         |         |         |
| ication |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Support | SHLD-8  |         | X       |         |         |         |
| ECN     |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Alte    |         |         |         |         |         |         |
| rnative |         |         |         |         |         |         |
| Con     |         |         |         |         |         |         |
| gestion |         |         |         |         |         |         |
| Control |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+
| Im      | MAY-18  |         |         | X       |         |         |
| plement |         |         |         |         |         |         |
| alte    |         |         |         |         |         |         |
| rnative |         |         |         |         |         |         |
| con     |         |         |         |         |         |         |
| formant |         |         |         |         |         |         |
| algor   |         |         |         |         |         |         |
| ithm(s) |         |         |         |         |         |         |
+---------+---------+---------+---------+---------+---------+---------+

: [Table 8](#table-8){.selfRef}: [TCP Requirements
Summary](#name-tcp-requirements-summary){.selfRef}
:::

FOOTNOTES: (1) \"ALP\" means Application-Layer
Program.[¶](#appendix-B-4){.pilcrow}
:::
:::

::: {#appendix-C .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

This document is largely a revision of RFC 793, of which [Jon
Postel]{.contact-name} was the editor. Due to his excellent work, it was
able to last for three decades before we felt the need to revise
it.[¶](#appendix-C-1){.pilcrow}

[Andre Oppermann]{.contact-name} was a contributor and helped to edit
the first revision of this document.[¶](#appendix-C-2){.pilcrow}

We are thankful for the assistance of the IETF TCPM working group chairs
over the course of work on this document:[¶](#appendix-C-3){.pilcrow}

::: {.left dir="auto"}
[Michael Scharf]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Yoshifumi Nishida]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Pasi Sarolahti]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Michael Tüxen]{.fn .nameRole}
:::

During the discussions of this work on the TCPM mailing list, in working
group meetings, and via area reviews, helpful comments, critiques, and
reviews were received from (listed alphabetically by last name):
[Praveen Balasubramanian]{.contact-name}, [David Borman]{.contact-name},
[Mohamed Boucadair]{.contact-name}, [Bob Briscoe]{.contact-name}, [Neal
Cardwell]{.contact-name}, [Yuchung Cheng]{.contact-name}, [Martin
Duke]{.contact-name}, [Francis Dupont]{.contact-name}, [Ted
Faber]{.contact-name}, [Gorry Fairhurst]{.contact-name}, [Fernando
Gont]{.contact-name}, [Rodney Grimes]{.contact-name}, [Yi
Huang]{.contact-name}, [Rahul Jadhav]{.contact-name}, [Markku
Kojo]{.contact-name}, [Mike Kosek]{.contact-name}, [Juhamatti
Kuusisaari]{.contact-name}, [Kevin Lahey]{.contact-name}, [Kevin
Mason]{.contact-name}, [Matt Mathis]{.contact-name}, [Stephen
McQuistin]{.contact-name}, [Jonathan Morton]{.contact-name}, [Matt
Olson]{.contact-name}, [Tommy Pauly]{.contact-name}, [Tom
Petch]{.contact-name}, [Hagen Paul Pfeifer]{.contact-name}, [Kyle
Rose]{.contact-name}, [Anthony Sabatini]{.contact-name}, [Michael
Scharf]{.contact-name}, [Greg Skinner]{.contact-name}, [Joe
Touch]{.contact-name}, [Michael Tüxen]{.contact-name}, [Reji
Varghese]{.contact-name}, [Bernie Volz]{.contact-name}, [Tim
Wicinski]{.contact-name}, [Lloyd Wood]{.contact-name}, and [Alex
Zimmermann]{.contact-name}.[¶](#appendix-C-4){.pilcrow}

[Joe Touch]{.contact-name} provided additional help in clarifying the
description of segment size parameters and PMTUD/PLPMTUD
recommendations. Markku Kojo helped put together the text in the section
on TCP Congestion Control.[¶](#appendix-C-5){.pilcrow}

This document includes content from errata that were reported by (listed
chronologically): [Yin Shuming]{.contact-name}, [Bob
Braden]{.contact-name}, [Morris M. Keesan]{.contact-name}, [Pei-chun
Cheng]{.contact-name}, [Constantin Hagemeier]{.contact-name}, [Vishwas
Manral]{.contact-name}, [Mykyta Yevstifeyev]{.contact-name}, [EungJun
Yi]{.contact-name}, [Botong Huang]{.contact-name}, [Charles
Deng]{.contact-name}, [Merlin
Buge]{.contact-name}.[¶](#appendix-C-6){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Wesley M. Eddy ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[MTI Systems]{.org}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <wes@mti-systems.com>
:::
:::
:::
