  RFC 8932            DNS Privacy Service Recommendations   October 2020
  ------------------- ------------------------------------- --------------
  Dickinson, et al.   Best Current Practice                 \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8932](https://www.rfc-editor.org/rfc/rfc8932){.eref}

BCP:
:   232

Category:
:   Best Current Practice

Published:
:   October 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    S. Dickinson
    :::

    ::: org
    Sinodun IT
    :::
    :::

    ::: author
    ::: author-name
    B. Overeinder
    :::

    ::: org
    NLnet Labs
    :::
    :::

    ::: author
    ::: author-name
    R. van Rijswijk-Deij
    :::

    ::: org
    NLnet Labs
    :::
    :::

    ::: author
    ::: author-name
    A. Mankin
    :::

    ::: org
    Salesforce
    :::
    :::
:::

# RFC 8932 {#rfcnum}

# Recommendations for DNS Privacy Service Operators {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document presents operational, policy, and security considerations
for DNS recursive resolver operators who choose to offer DNS privacy
services. With these recommendations, the operator can make deliberate
decisions regarding which services to provide, as well as understanding
how those decisions and the alternatives impact the privacy of
users.[¶](#section-abstract-1){.pilcrow}

This document also presents a non-normative framework to assist writers
of a Recursive operator Privacy Statement, analogous to DNS Security
Extensions (DNSSEC) Policies and DNSSEC Practice Statements described in
RFC 6841.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This memo documents an Internet Best Current
Practice.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on BCPs
is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8932>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Scope](#name-scope){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Privacy-Related
    Documents](#name-privacy-related-documents){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Recommendations for DNS Privacy
    Services](#name-recommendations-for-dns-pri){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [On the Wire between Client and
        Server](#name-on-the-wire-between-client-){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.1.2.1}
            [5.1.1](#section-5.1.1){.xref}.  [Transport
            Recommendations](#name-transport-recommendations){.xref}[¶](#section-toc.1-1.5.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.2}
            [5.1.2](#section-5.1.2){.xref}.  [Authentication of DNS
            Privacy
            Services](#name-authentication-of-dns-priva){.xref}[¶](#section-toc.1-1.5.2.1.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.3}
            [5.1.3](#section-5.1.3){.xref}.  [Protocol
            Recommendations](#name-protocol-recommendations){.xref}[¶](#section-toc.1-1.5.2.1.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.4}
            [5.1.4](#section-5.1.4){.xref}.  [DNSSEC](#name-dnssec){.xref}[¶](#section-toc.1-1.5.2.1.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.5}
            [5.1.5](#section-5.1.5){.xref}.  [Availability](#name-availability){.xref}[¶](#section-toc.1-1.5.2.1.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.6}
            [5.1.6](#section-5.1.6){.xref}.  [Service
            Options](#name-service-options){.xref}[¶](#section-toc.1-1.5.2.1.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.7}
            [5.1.7](#section-5.1.7){.xref}.  [Impact of Encryption on
            Monitoring by DNS Privacy Service
            Operators](#name-impact-of-encryption-on-mon){.xref}[¶](#section-toc.1-1.5.2.1.2.7.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.8}
            [5.1.8](#section-5.1.8){.xref}.  [Limitations of Fronting a
            DNS Privacy Service with a Pure TLS
            Proxy](#name-limitations-of-fronting-a-d){.xref}[¶](#section-toc.1-1.5.2.1.2.8.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Data at Rest on the
        Server](#name-data-at-rest-on-the-server){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.2.2.1}
            [5.2.1](#section-5.2.1){.xref}.  [Data
            Handling](#name-data-handling){.xref}[¶](#section-toc.1-1.5.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.2}
            [5.2.2](#section-5.2.2){.xref}.  [Data Minimization of
            Network
            Traffic](#name-data-minimization-of-networ){.xref}[¶](#section-toc.1-1.5.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.3}
            [5.2.3](#section-5.2.3){.xref}.  [IP Address
            Pseudonymization and Anonymization
            Methods](#name-ip-address-pseudonymization){.xref}[¶](#section-toc.1-1.5.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.4}
            [5.2.4](#section-5.2.4){.xref}.  [Pseudonymization,
            Anonymization, or Discarding of Other Correlation
            Data](#name-pseudonymization-anonymizat){.xref}[¶](#section-toc.1-1.5.2.2.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.5}
            [5.2.5](#section-5.2.5){.xref}.  [Cache
            Snooping](#name-cache-snooping){.xref}[¶](#section-toc.1-1.5.2.2.2.5.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Data Sent Onwards from the
        Server](#name-data-sent-onwards-from-the-){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.3.2.1}
            [5.3.1](#section-5.3.1){.xref}.  [Protocol
            Recommendations](#name-protocol-recommendations-2){.xref}[¶](#section-toc.1-1.5.2.3.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.2}
            [5.3.2](#section-5.3.2){.xref}.  [Client Query
            Obfuscation](#name-client-query-obfuscation){.xref}[¶](#section-toc.1-1.5.2.3.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.3.2.3}
            [5.3.3](#section-5.3.3){.xref}.  [Data
            Sharing](#name-data-sharing){.xref}[¶](#section-toc.1-1.5.2.3.2.3.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Recursive Operator Privacy Statement
    (RPS)](#name-recursive-operator-privacy-){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Outline of an
        RPS](#name-outline-of-an-rps){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.6.2.1.2.1}
            [6.1.1](#section-6.1.1){.xref}.  [Policy](#name-policy){.xref}[¶](#section-toc.1-1.6.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.6.2.1.2.2}
            [6.1.2](#section-6.1.2){.xref}.  [Practice](#name-practice){.xref}[¶](#section-toc.1-1.6.2.1.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Enforcement/Accountability](#name-enforcement-accountability){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix
    A](#section-appendix.a){.xref}.  [Documents](#name-documents){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [A.1](#section-a.1){.xref}.  [Potential Increases in DNS
        Privacy](#name-potential-increases-in-dns-){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [A.2](#section-a.2){.xref}.  [Potential Decreases in DNS
        Privacy](#name-potential-decreases-in-dns-){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.3}
        [A.3](#section-a.3){.xref}.  [Related Operational
        Documents](#name-related-operational-documen){.xref}[¶](#section-toc.1-1.10.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix B](#section-appendix.b){.xref}.  [IP Address
    Techniques](#name-ip-address-techniques){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [B.1](#section-b.1){.xref}.  [Categorization of
        Techniques](#name-categorization-of-technique){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [B.2](#section-b.2){.xref}.  [Specific
        Techniques](#name-specific-techniques){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.11.2.2.2.1}
            [B.2.1](#section-b.2.1){.xref}.  [Google Analytics
            Non-Prefix
            Filtering](#name-google-analytics-non-prefix){.xref}[¶](#section-toc.1-1.11.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.2}
            [B.2.2](#section-b.2.2){.xref}.  [dnswasher](#name-dnswasher){.xref}[¶](#section-toc.1-1.11.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.3}
            [B.2.3](#section-b.2.3){.xref}.  [Prefix-Preserving
            Map](#name-prefix-preserving-map){.xref}[¶](#section-toc.1-1.11.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.4}
            [B.2.4](#section-b.2.4){.xref}.  [Cryptographic
            Prefix-Preserving
            Pseudonymization](#name-cryptographic-prefix-preser){.xref}[¶](#section-toc.1-1.11.2.2.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.5}
            [B.2.5](#section-b.2.5){.xref}.  [Top-Hash
            Subtree-Replicated
            Anonymization](#name-top-hash-subtree-replicated){.xref}[¶](#section-toc.1-1.11.2.2.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.6}
            [B.2.6](#section-b.2.6){.xref}.  [ipcipher](#name-ipcipher){.xref}[¶](#section-toc.1-1.11.2.2.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.7}
            [B.2.7](#section-b.2.7){.xref}.  [Bloom
            Filters](#name-bloom-filters){.xref}[¶](#section-toc.1-1.11.2.2.2.7.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix C](#section-appendix.c){.xref}.  [Current Policy and
    Privacy
    Statements](#name-current-policy-and-privacy-){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [Appendix D](#section-appendix.d){.xref}.  [Example
    RPS](#name-example-rps){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}

    -   ::: {#section-toc.1-1.13.2.1}
        [D.1](#section-d.1){.xref}.  [Policy](#name-policy-2){.xref}[¶](#section-toc.1-1.13.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.13.2.2}
        [D.2](#section-d.2){.xref}.  [Practice](#name-practice-2){.xref}[¶](#section-toc.1-1.13.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.e){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.15}
    [](#section-appendix.f){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.15.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.16}
    [](#section-appendix.g){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.16.1){.pilcrow}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Domain Name System (DNS) is at the core of the Internet; almost
every activity on the Internet starts with a DNS query (and often
several). However, the DNS was not originally designed with strong
security or privacy mechanisms. A number of developments have taken
place in recent years that aim to increase the privacy of the DNS, and
these are now seeing some deployment. This latest evolution of the DNS
presents new challenges to operators, and this document attempts to
provide an overview of considerations for privacy-focused DNS
services.[¶](#section-1-1){.pilcrow}

In recent years, there has also been an increase in the availability of
\"public resolvers\" \[[RFC8499](#RFC8499){.xref}\], which users may
prefer to use instead of the default network resolver, either because
they offer a specific feature (e.g., good reachability or encrypted
transport) or because the network resolver lacks a specific feature
(e.g., strong privacy policy or unfiltered responses). These public
resolvers have tended to be at the forefront of adoption of
privacy-related enhancements, but it is anticipated that operators of
other resolver services will follow.[¶](#section-1-2){.pilcrow}

Whilst protocols that encrypt DNS messages on the wire provide
protection against certain attacks, the resolver operator still has (in
principle) full visibility of the query data and transport identifiers
for each user. Therefore, a trust relationship (whether explicit or
implicit) is assumed to exist between each user and the operator of the
resolver(s) used by that user. The ability of the operator to provide a
transparent, well-documented, and secure privacy service will likely
serve as a major differentiating factor for privacy-conscious users if
they make an active selection of which resolver to
use.[¶](#section-1-3){.pilcrow}

It should also be noted that there are both advantages and disadvantages
to a user choosing to configure a single resolver (or a fixed set of
resolvers) and an encrypted transport to use in all network
environments. For example, the user has a clear expectation of which
resolvers have visibility of their query data. However, this
resolver/transport selection may provide an added mechanism for tracking
them as they move across network environments. Commitments from resolver
operators to minimize such tracking as users move between networks are
also likely to play a role in user selection of
resolvers.[¶](#section-1-4){.pilcrow}

More recently, the global legislative landscape with regard to personal
data collection, retention, and pseudonymization has seen significant
activity. Providing detailed practice advice about these areas to the
operator is out of scope, but [Section 5.3.3](#data-sharing){.xref}
describes some mitigations of data-sharing
risk.[¶](#section-1-5){.pilcrow}

This document has two main goals:[¶](#section-1-6){.pilcrow}

-   [To provide operational and policy guidance related to DNS over
    encrypted transports and to outline recommendations for data
    handling for operators of DNS privacy
    services.[¶](#section-1-7.1){.pilcrow}]{#section-1-7.1}
-   [To introduce the Recursive operator Privacy Statement (RPS) and
    present a framework to assist writers of an RPS. An RPS is a
    document that an operator should publish that outlines their
    operational practices and commitments with regard to privacy,
    thereby providing a means for clients to evaluate both the
    measurable and claimed privacy properties of a given DNS privacy
    service. The framework identifies a set of elements and specifies an
    outline order for them. This document does not, however, define a
    particular privacy statement, nor does it seek to provide legal
    advice as to the contents of an
    RPS.[¶](#section-1-7.2){.pilcrow}]{#section-1-7.2}

A desired operational impact is that all operators (both those providing
resolvers within networks and those operating large public services) can
demonstrate their commitment to user privacy, thereby driving all DNS
resolution services to a more equitable footing. Choices for users would
(in this ideal world) be driven by other factors \-- e.g., differing
security policies or minor differences in operator policy \-- rather
than gross disparities in privacy concerns.[¶](#section-1-8){.pilcrow}

Community insight (or judgment?) about operational practices can change
quickly, and experience shows that a Best Current Practice (BCP)
document about privacy and security is a point-in-time statement.
Readers are advised to seek out any updates that apply to this
document.[¶](#section-1-9){.pilcrow}
:::
:::

::: {#scope}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Scope](#name-scope){.section-name .selfRef} {#name-scope}

\"DNS Privacy Considerations\" \[[RFC7626](#RFC7626){.xref}\] describes
the general privacy issues and threats associated with the use of the
DNS by Internet users; much of the threat analysis here is lifted from
that document and \[[RFC6973](#RFC6973){.xref}\]. However, this document
is limited in scope to best-practice considerations for the provision of
DNS privacy services by servers (recursive resolvers) to clients (stub
resolvers or forwarders). Choices that are made exclusively by the end
user, or those for operators of authoritative nameservers, are out of
scope.[¶](#section-2-1){.pilcrow}

This document includes (but is not limited to) considerations in the
following areas:[¶](#section-2-2){.pilcrow}

1.  [Data \"on the wire\" between a client and a
    server.[¶](#section-2-3.1){.pilcrow}]{#section-2-3.1}
2.  [Data \"at rest\" on a server (e.g., in
    logs).[¶](#section-2-3.2){.pilcrow}]{#section-2-3.2}
3.  [Data \"sent onwards\" from the server (either on the wire or shared
    with a third party).[¶](#section-2-3.3){.pilcrow}]{#section-2-3.3}

Whilst the issues raised here are targeted at those operators who choose
to offer a DNS privacy service, considerations for areas 2 and 3 could
equally apply to operators who only offer DNS over unencrypted
transports but who would otherwise like to align with privacy best
practice.[¶](#section-2-4){.pilcrow}
:::
:::

::: {#privacyrelated-documents}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Privacy-Related Documents](#name-privacy-related-documents){.section-name .selfRef} {#name-privacy-related-documents}

There are various documents that describe protocol changes that have the
potential to either increase or decrease the privacy properties of the
DNS in various ways. Note that this does not imply that some documents
are good or bad, better or worse, just that (for example) some features
may bring functional benefits at the price of a reduction in privacy,
and conversely some features increase privacy with an accompanying
increase in complexity. A selection of the most relevant documents is
listed in [Appendix A](#documents){.xref} for
reference.[¶](#section-3-1){.pilcrow}
:::
:::

::: {#terminology}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-4-1){.pilcrow}

DNS terminology is as described in \[[RFC8499](#RFC8499){.xref}\],
except with regard to the definition of privacy-enabling DNS server in
[Section 6](https://www.rfc-editor.org/rfc/rfc8499#section-6){.relref}
of \[[RFC8499](#RFC8499){.xref}\]. In this document we use the full
definition of a DNS over (D)TLS privacy-enabling DNS server as given in
\[[RFC8310](#RFC8310){.xref}\], i.e., that such a server should also
offer at least one of the credentials described in [Section
8](https://www.rfc-editor.org/rfc/rfc8310#section-8){.relref} of
\[[RFC8310](#RFC8310){.xref}\] and implement the (D)TLS profile
described in [Section
9](https://www.rfc-editor.org/rfc/rfc8310#section-9){.relref} of
\[[RFC8310](#RFC8310){.xref}\].[¶](#section-4-2){.pilcrow}

Other Terms:[¶](#section-4-3){.pilcrow}

[]{.break}

RPS:
:   Recursive operator Privacy Statement; see [Section
    6](#recursive-operator-privacy-statement-rps){.xref}.[¶](#section-4-4.2){.pilcrow}
:   

DNS privacy service:
:   The service that is offered via a privacy-enabling DNS server and is
    documented either in an informal statement of policy and practice
    with regard to users privacy or a formal
    RPS.[¶](#section-4-4.4){.pilcrow}
:   
:::
:::

::: {#recommendations-for-dns-privacy-services}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Recommendations for DNS Privacy Services](#name-recommendations-for-dns-pri){.section-name .selfRef} {#name-recommendations-for-dns-pri}

In the following sections, we first outline the threats relevant to the
specific topic and then discuss the potential actions that can be taken
to mitigate them.[¶](#section-5-1){.pilcrow}

We describe two classes of threats:[¶](#section-5-2){.pilcrow}

-   ::: {#section-5-3.1}
    Threats described in \[[RFC6973](#RFC6973){.xref}\], \"Privacy
    Considerations for Internet
    Protocols\"[¶](#section-5-3.1.1){.pilcrow}

    -   [Privacy terminology, threats to privacy, and mitigations as
        described in Sections
        [3](https://www.rfc-editor.org/rfc/rfc6973#section-3){.relref},
        [5](https://www.rfc-editor.org/rfc/rfc6973#section-5){.relref},
        and
        [6](https://www.rfc-editor.org/rfc/rfc6973#section-6){.relref}
        of
        \[[RFC6973](#RFC6973){.xref}\].[¶](#section-5-3.1.2.1){.pilcrow}]{#section-5-3.1.2.1}
    :::

-   ::: {#section-5-3.2}
    DNS Privacy Threats[¶](#section-5-3.2.1){.pilcrow}

    -   [These are threats to the users and operators of DNS privacy
        services that are not directly covered by
        \[[RFC6973](#RFC6973){.xref}\]. These may be more operational in
        nature, such as certificate-management or service-availability
        issues.[¶](#section-5-3.2.2.1){.pilcrow}]{#section-5-3.2.2.1}
    :::

We describe three classes of actions that operators of DNS privacy
services can take:[¶](#section-5-4){.pilcrow}

-   [Threat mitigation for well-understood and documented privacy
    threats to the users of the service and, in some cases, the
    operators of the
    service.[¶](#section-5-5.1){.pilcrow}]{#section-5-5.1}
-   [Optimization of privacy services from an operational or management
    perspective.[¶](#section-5-5.2){.pilcrow}]{#section-5-5.2}
-   [Additional options that could further enhance the privacy and
    usability of the
    service.[¶](#section-5-5.3){.pilcrow}]{#section-5-5.3}

This document does not specify policy, only best practice. However, for
DNS privacy services to be considered compliant with these best-practice
guidelines, they [SHOULD]{.bcp14} implement (where appropriate)
all:[¶](#section-5-6){.pilcrow}

-   [Threat mitigations to be minimally
    compliant.[¶](#section-5-7.1){.pilcrow}]{#section-5-7.1}
-   [Optimizations to be moderately
    compliant.[¶](#section-5-7.2){.pilcrow}]{#section-5-7.2}
-   [Additional options to be maximally
    compliant.[¶](#section-5-7.3){.pilcrow}]{#section-5-7.3}

The rest of this document does not use normative language but instead
refers only to the three differing classes of action that correspond to
the three named levels of compliance stated above. However, compliance
(to the indicated level) remains a normative
requirement.[¶](#section-5-8){.pilcrow}

::: {#on-the-wire-between-client-and-server}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [On the Wire between Client and Server](#name-on-the-wire-between-client-){.section-name .selfRef} {#name-on-the-wire-between-client-}

In this section, we consider both data on the wire and the service
provided to the client.[¶](#section-5.1-1){.pilcrow}

::: {#transport-recommendations}
::: {#section-5.1.1 .section}
#### [5.1.1.](#section-5.1.1){.section-number .selfRef} [Transport Recommendations](#name-transport-recommendations){.section-name .selfRef} {#name-transport-recommendations}

[]{.break}

Threats described in \[[RFC6973](#RFC6973){.xref}\]:
:   []{.break}

    Surveillance:
    :   Passive surveillance of traffic on the
        wire.[¶](#section-5.1.1-1.2.1.2){.pilcrow}
    :   
:   

DNS Privacy Threats:
:   Active injection of spurious data or
    traffic.[¶](#section-5.1.1-1.4){.pilcrow}
:   

Mitigations:

:   A DNS privacy service can mitigate these threats by providing
    service over one or more of the following
    transports:[¶](#section-5.1.1-1.6.1){.pilcrow}

    -   [DNS over TLS (DoT) \[[RFC7858](#RFC7858){.xref}\]
        \[[RFC8310](#RFC8310){.xref}\].[¶](#section-5.1.1-1.6.2.1){.pilcrow}]{#section-5.1.1-1.6.2.1}
    -   [DNS over HTTPS (DoH)
        \[[RFC8484](#RFC8484){.xref}\].[¶](#section-5.1.1-1.6.2.2){.pilcrow}]{#section-5.1.1-1.6.2.2}

:   

It is noted that a DNS privacy service can also be provided over DNS
over DTLS \[[RFC8094](#RFC8094){.xref}\]; however, this is an
Experimental specification, and there are no known implementations at
the time of writing.[¶](#section-5.1.1-2){.pilcrow}

It is also noted that DNS privacy service might be provided over
DNSCrypt \[[DNSCrypt](#DNSCrypt){.xref}\], IPsec, or VPNs. However,
there are no specific RFCs that cover the use of these transports for
DNS, and any discussion of best practice for providing such a service is
out of scope for this document.[¶](#section-5.1.1-3){.pilcrow}

Whilst encryption of DNS traffic can protect against active injection on
the paths traversed by the encrypted connection, this does not diminish
the need for DNSSEC; see [Section
5.1.4](#dnssec){.xref}.[¶](#section-5.1.1-4){.pilcrow}
:::
:::

::: {#authentication-of-dns-privacy-services}
::: {#section-5.1.2 .section}
#### [5.1.2.](#section-5.1.2){.section-number .selfRef} [Authentication of DNS Privacy Services](#name-authentication-of-dns-priva){.section-name .selfRef} {#name-authentication-of-dns-priva}

[]{.break}

Threats described in \[[RFC6973](#RFC6973){.xref}\]:
:   []{.break}

    Surveillance:
    :   Active attacks on client resolver
        configuration.[¶](#section-5.1.2-1.2.1.2){.pilcrow}
    :   
:   

Mitigations:

:   DNS privacy services should ensure clients can authenticate the
    server. Note that this, in effect, commits the DNS privacy service
    to a public identity users will
    trust.[¶](#section-5.1.2-1.4.1){.pilcrow}

    When using DoT, clients that select a \"Strict Privacy\" usage
    profile \[[RFC8310](#RFC8310){.xref}\] (to mitigate the threat of
    active attack on the client) require the ability to authenticate the
    DNS server. To enable this, DNS privacy services that offer DoT need
    to provide credentials that will be accepted by the client\'s trust
    model, in the form of either X.509 certificates
    \[[RFC5280](#RFC5280){.xref}\] or Subject Public Key Info (SPKI) pin
    sets
    \[[RFC8310](#RFC8310){.xref}\].[¶](#section-5.1.2-1.4.2){.pilcrow}

    When offering DoH \[[RFC8484](#RFC8484){.xref}\], HTTPS requires
    authentication of the server as part of the
    protocol.[¶](#section-5.1.2-1.4.3){.pilcrow}

:   

::: {#certificate-management}
::: {#section-5.1.2.1 .section}
##### [5.1.2.1.](#section-5.1.2.1){.section-number .selfRef} [Certificate Management](#name-certificate-management){.section-name .selfRef} {#name-certificate-management}

Anecdotal evidence to date highlights the management of certificates as
one of the more challenging aspects for operators of traditional DNS
resolvers that choose to additionally provide a DNS privacy service, as
management of such credentials is new to those DNS
operators.[¶](#section-5.1.2.1-1){.pilcrow}

It is noted that SPKI pin set management is described in
\[[RFC7858](#RFC7858){.xref}\] but that key-pinning mechanisms in
general have fallen out of favor operationally for various reasons, such
as the logistical overhead of rolling
keys.[¶](#section-5.1.2.1-2){.pilcrow}

[]{.break}

DNS Privacy Threats:

:   -   [Invalid certificates, resulting in an unavailable service,
        which might force a user to fall back to
        cleartext.[¶](#section-5.1.2.1-3.2.1.1){.pilcrow}]{#section-5.1.2.1-3.2.1.1}
    -   [Misidentification of a server by a client \-- e.g., typos in
        DoH URL templates \[[RFC8484](#RFC8484){.xref}\] or
        authentication domain names \[[RFC8310](#RFC8310){.xref}\] that
        accidentally direct clients to attacker-controlled
        servers.[¶](#section-5.1.2.1-3.2.1.2){.pilcrow}]{#section-5.1.2.1-3.2.1.2}

:   

Mitigations:

:   It is recommended that
    operators:[¶](#section-5.1.2.1-3.4.1){.pilcrow}

    -   [Follow the guidance in [Section
        6.5](https://www.rfc-editor.org/rfc/rfc7525#section-6.5){.relref}
        of \[[RFC7525](#RFC7525){.xref}\] with regard to certificate
        revocation.[¶](#section-5.1.2.1-3.4.2.1){.pilcrow}]{#section-5.1.2.1-3.4.2.1}
    -   [Automate the generation, publication, and renewal of
        certificates. For example, Automatic Certificate Management
        Environment (ACME) \[[RFC8555](#RFC8555){.xref}\] provides a
        mechanism to actively manage certificates through automation and
        has been implemented by a number of certificate
        authorities.[¶](#section-5.1.2.1-3.4.2.2){.pilcrow}]{#section-5.1.2.1-3.4.2.2}
    -   [Monitor certificates to prevent accidental expiration of
        certificates.[¶](#section-5.1.2.1-3.4.2.3){.pilcrow}]{#section-5.1.2.1-3.4.2.3}
    -   [Choose a short, memorable authentication domain name for the
        service.[¶](#section-5.1.2.1-3.4.2.4){.pilcrow}]{#section-5.1.2.1-3.4.2.4}

:   
:::
:::
:::
:::

::: {#protocol-recommendations}
::: {#section-5.1.3 .section}
#### [5.1.3.](#section-5.1.3){.section-number .selfRef} [Protocol Recommendations](#name-protocol-recommendations){.section-name .selfRef} {#name-protocol-recommendations}

::: {#dot}
::: {#section-5.1.3.1 .section}
##### [5.1.3.1.](#section-5.1.3.1){.section-number .selfRef} [DoT](#name-dot){.section-name .selfRef} {#name-dot}

[]{.break}

DNS Privacy Threats:

:   -   [Known attacks on TLS, such as those described in
        \[[RFC7457](#RFC7457){.xref}\].[¶](#section-5.1.3.1-1.2.1.1){.pilcrow}]{#section-5.1.3.1-1.2.1.1}
    -   [Traffic analysis, for example:
        \[[Pitfalls-of-DNS-Encryption](#Pitfalls-of-DNS-Encryption){.xref}\]
        (focused on
        DoT).[¶](#section-5.1.3.1-1.2.1.2){.pilcrow}]{#section-5.1.3.1-1.2.1.2}
    -   [Potential for client tracking via transport
        identifiers.[¶](#section-5.1.3.1-1.2.1.3){.pilcrow}]{#section-5.1.3.1-1.2.1.3}
    -   [Blocking of well-known ports (e.g., 853 for
        DoT).[¶](#section-5.1.3.1-1.2.1.4){.pilcrow}]{#section-5.1.3.1-1.2.1.4}

:   

Mitigations:

:   In the case of DoT, TLS profiles from [Section
    9](https://www.rfc-editor.org/rfc/rfc8310#section-9){.relref} of
    \[[RFC8310](#RFC8310){.xref}\] and the \"Countermeasures to DNS
    Traffic Analysis\" from [Section
    11.1](https://www.rfc-editor.org/rfc/rfc8310#section-11.1){.relref}
    of \[[RFC8310](#RFC8310){.xref}\] provide strong mitigations. This
    includes but is not limited to:[¶](#section-5.1.3.1-1.4.1){.pilcrow}

    -   [Adhering to
        \[[RFC7525](#RFC7525){.xref}\].[¶](#section-5.1.3.1-1.4.2.1){.pilcrow}]{#section-5.1.3.1-1.4.2.1}
    -   [Implementing only (D)TLS 1.2 or later, as specified in
        \[[RFC8310](#RFC8310){.xref}\].[¶](#section-5.1.3.1-1.4.2.2){.pilcrow}]{#section-5.1.3.1-1.4.2.2}
    -   [Implementing Extension Mechanisms for DNS (EDNS(0)) Padding
        \[[RFC7830](#RFC7830){.xref}\] using the guidelines in
        \[[RFC8467](#RFC8467){.xref}\] or a successor
        specification.[¶](#section-5.1.3.1-1.4.2.3){.pilcrow}]{#section-5.1.3.1-1.4.2.3}
    -   [Servers should not degrade in any way the query service level
        provided to clients that do not use any form of session
        resumption mechanism, such as TLS session resumption
        \[[RFC5077](#RFC5077){.xref}\] with TLS 1.2 ([Section
        2.2](https://www.rfc-editor.org/rfc/rfc8446#section-2.2){.relref}
        of \[[RFC8446](#RFC8446){.xref}\]) or Domain Name System (DNS)
        Cookies
        \[[RFC7873](#RFC7873){.xref}\].[¶](#section-5.1.3.1-1.4.2.4){.pilcrow}]{#section-5.1.3.1-1.4.2.4}
    -   [A DoT privacy service on both port 853 and 443. If the operator
        deploys DoH on the same IP address, this requires the use of the
        \"dot\" Application-Layer Protocol Negotiation (ALPN) value
        \[[dot-ALPN](#dot-ALPN){.xref}\].[¶](#section-5.1.3.1-1.4.2.5){.pilcrow}]{#section-5.1.3.1-1.4.2.5}

:   

Optimizations:

:   -   [Concurrent processing of pipelined queries, returning responses
        as soon as available, potentially out of order, as specified in
        \[[RFC7766](#RFC7766){.xref}\]. This is often called \"OOOR\"
        \-- out-of-order responses (providing processing performance
        similar to HTTP
        multiplexing).[¶](#section-5.1.3.1-1.6.1.1){.pilcrow}]{#section-5.1.3.1-1.6.1.1}
    -   [Management of TLS connections to optimize performance for
        clients using \[[RFC7766](#RFC7766){.xref}\] and EDNS(0)
        Keepalive
        \[[RFC7828](#RFC7828){.xref}\][¶](#section-5.1.3.1-1.6.1.2){.pilcrow}]{#section-5.1.3.1-1.6.1.2}

:   

Additional Options:
:   Management of TLS connections to optimize performance for clients
    using DNS Stateful Operations
    \[[RFC8490](#RFC8490){.xref}\].[¶](#section-5.1.3.1-1.8){.pilcrow}
:   
:::
:::

::: {#doh}
::: {#section-5.1.3.2 .section}
##### [5.1.3.2.](#section-5.1.3.2){.section-number .selfRef} [DoH](#name-doh){.section-name .selfRef} {#name-doh}

[]{.break}

DNS Privacy Threats:

:   -   [Known attacks on TLS, such as those described in
        \[[RFC7457](#RFC7457){.xref}\].[¶](#section-5.1.3.2-1.2.1.1){.pilcrow}]{#section-5.1.3.2-1.2.1.1}
    -   [Traffic analysis, for example:
        \[[DNS-Privacy-not-so-private](#DNS-Privacy-not-so-private){.xref}\]
        (focused on
        DoH).[¶](#section-5.1.3.2-1.2.1.2){.pilcrow}]{#section-5.1.3.2-1.2.1.2}
    -   [Potential for client tracking via transport
        identifiers.[¶](#section-5.1.3.2-1.2.1.3){.pilcrow}]{#section-5.1.3.2-1.2.1.3}

:   

Mitigations:

:   -   [Clients must be able to forgo the use of HTTP cookies
        \[[RFC6265](#RFC6265){.xref}\] and still use the
        service.[¶](#section-5.1.3.2-1.4.1.1){.pilcrow}]{#section-5.1.3.2-1.4.1.1}
    -   [Use of HTTP/2 padding and/or EDNS(0) padding, as described in
        [Section
        9](https://www.rfc-editor.org/rfc/rfc8484#section-9){.relref} of
        \[[RFC8484](#RFC8484){.xref}\].[¶](#section-5.1.3.2-1.4.1.2){.pilcrow}]{#section-5.1.3.2-1.4.1.2}
    -   [Clients should not be required to include any headers beyond
        the absolute minimum to obtain service from a DoH server. (See
        [Section
        6.1](https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09#section-6.1){.relref}
        of
        \[[BUILD-W-HTTP](#I-D.ietf-httpbis-bcp56bis){.xref}\].)[¶](#section-5.1.3.2-1.4.1.3){.pilcrow}]{#section-5.1.3.2-1.4.1.3}

:   
:::
:::
:::
:::

::: {#dnssec}
::: {#section-5.1.4 .section}
#### [5.1.4.](#section-5.1.4){.section-number .selfRef} [DNSSEC](#name-dnssec){.section-name .selfRef} {#name-dnssec}

[]{.break}

DNS Privacy Threats:
:   Users may be directed to bogus IP addresses that, depending on the
    application, protocol, and authentication method, might lead users
    to reveal personal information to attackers. One example is a
    website that doesn\'t use TLS or whose TLS authentication can
    somehow be subverted.[¶](#section-5.1.4-1.2){.pilcrow}
:   

Mitigations:
:   All DNS privacy services must offer a DNS privacy service that
    performs Domain Name System Security Extensions (DNSSEC) validation.
    In addition, they must be able to provide the DNSSEC Resource
    Records (RRs) to the client so that it can perform its own
    validation.[¶](#section-5.1.4-1.4){.pilcrow}
:   

The addition of encryption to DNS does not remove the need for DNSSEC
\[[RFC4033](#RFC4033){.xref}\]; they are independent and fully
compatible protocols, each solving different problems. The use of one
does not diminish the need nor the usefulness of the
other.[¶](#section-5.1.4-2){.pilcrow}

While the use of an authenticated and encrypted transport protects
origin authentication and data integrity between a client and a DNS
privacy service, it provides no proof (for a nonvalidating client) that
the data provided by the DNS privacy service was actually DNSSEC
authenticated. As with cleartext DNS, the user is still solely trusting
the Authentic Data (AD) bit (if present) set by the
resolver.[¶](#section-5.1.4-3){.pilcrow}

It should also be noted that the use of an encrypted transport for DNS
actually solves many of the practical issues encountered by DNS
validating clients \-- e.g., interference by middleboxes with cleartext
DNS payloads is completely avoided. In this sense, a validating client
that uses a DNS privacy service that supports DNSSEC has a far simpler
task in terms of DNSSEC roadblock avoidance
\[[RFC8027](#RFC8027){.xref}\].[¶](#section-5.1.4-4){.pilcrow}
:::
:::

::: {#availability}
::: {#section-5.1.5 .section}
#### [5.1.5.](#section-5.1.5){.section-number .selfRef} [Availability](#name-availability){.section-name .selfRef} {#name-availability}

[]{.break}

DNS Privacy Threats:
:   A failing DNS privacy service could force the user to switch
    providers, fall back to cleartext, or accept no DNS service for the
    duration of the outage.[¶](#section-5.1.5-1.2){.pilcrow}
:   

Mitigations:

:   A DNS privacy service should strive to engineer encrypted services
    to the same availability level as any unencrypted services they
    provide. Particular care should to be taken to protect DNS privacy
    services against denial-of-service (DoS) attacks, as experience has
    shown that unavailability of DNS resolving because of attacks is a
    significant motivation for users to switch services. See, for
    example, Section IV-C of
    \[[Passive-Observations-of-a-Large-DNS](#Passive-Observations-of-a-Large-DNS){.xref}\].[¶](#section-5.1.5-1.4.1){.pilcrow}

    Techniques such as those described in [Section
    10](https://www.rfc-editor.org/rfc/rfc7766#section-10){.relref} of
    \[[RFC7766](#RFC7766){.xref}\] can be of use to operators to defend
    against such attacks.[¶](#section-5.1.5-1.4.2){.pilcrow}

:   
:::
:::

::: {#service-options}
::: {#section-5.1.6 .section}
#### [5.1.6.](#section-5.1.6){.section-number .selfRef} [Service Options](#name-service-options){.section-name .selfRef} {#name-service-options}

[]{.break}

DNS Privacy Threats:
:   Unfairly disadvantaging users of the privacy service with respect to
    the services available. This could force the user to switch
    providers, fall back to cleartext, or accept no DNS service for the
    duration of the outage.[¶](#section-5.1.6-1.2){.pilcrow}
:   

Mitigations:
:   A DNS privacy service should deliver the same level of service as
    offered on unencrypted channels in terms of options such as
    filtering (or lack thereof), DNSSEC validation,
    etc.[¶](#section-5.1.6-1.4){.pilcrow}
:   
:::
:::

::: {#impact-of-encryption-on-monitoring-by-dns-privacy-service-operators}
::: {#section-5.1.7 .section}
#### [5.1.7.](#section-5.1.7){.section-number .selfRef} [Impact of Encryption on Monitoring by DNS Privacy Service Operators](#name-impact-of-encryption-on-mon){.section-name .selfRef} {#name-impact-of-encryption-on-mon}

[]{.break}

DNS Privacy Threats:
:   Increased use of encryption can impact a DNS privacy service
    operator\'s ability to monitor traffic and therefore manage their
    DNS servers
    \[[RFC8404](#RFC8404){.xref}\].[¶](#section-5.1.7-1.2){.pilcrow}
:   

Many monitoring solutions for DNS traffic rely on the plaintext nature
of this traffic and work by intercepting traffic on the wire, either
using a separate view on the connection between clients and the
resolver, or as a separate process on the resolver system that inspects
network traffic. Such solutions will no longer function when traffic
between clients and resolvers is encrypted. Many DNS privacy service
operators still need to inspect DNS traffic \-- e.g., to monitor for
network security threats. Operators may therefore need to invest in an
alternative means of monitoring that relies on either the resolver
software directly, or exporting DNS traffic from the resolver using, for
example, \[[dnstap](#dnstap){.xref}\].[¶](#section-5.1.7-2){.pilcrow}

[]{.break}

Optimization:
:   When implementing alternative means for traffic monitoring,
    operators of a DNS privacy service should consider using
    privacy-conscious means to do so. See [Section
    5.2](#data-at-rest-on-the-server){.xref} for more details on data
    handling and the discussion on the use of Bloom Filters in [Appendix
    B](#ip-address-techniques){.xref}.[¶](#section-5.1.7-3.2){.pilcrow}
:   
:::
:::

::: {#limitations-of-fronting-a-dns-privacy-service-with-a-pure-tls-proxy}
::: {#section-5.1.8 .section}
#### [5.1.8.](#section-5.1.8){.section-number .selfRef} [Limitations of Fronting a DNS Privacy Service with a Pure TLS Proxy](#name-limitations-of-fronting-a-d){.section-name .selfRef} {#name-limitations-of-fronting-a-d}

[]{.break}

DNS Privacy Threats:

:   -   [Limited ability to manage or monitor incoming connections using
        DNS-specific
        techniques.[¶](#section-5.1.8-1.2.1.1){.pilcrow}]{#section-5.1.8-1.2.1.1}
    -   [Misconfiguration (e.g., of the target-server address in the
        proxy configuration) could lead to data leakage if the
        proxy-to-target-server path is not
        encrypted.[¶](#section-5.1.8-1.2.1.2){.pilcrow}]{#section-5.1.8-1.2.1.2}

:   

Optimization:

:   Some operators may choose to implement DoT using a TLS proxy (e.g.,
    \[[nginx](#nginx){.xref}\], \[[haproxy](#haproxy){.xref}\], or
    \[[stunnel](#stunnel){.xref}\]) in front of a DNS nameserver because
    of proven robustness and capacity when handling large numbers of
    client connections, load-balancing capabilities, and good tooling.
    Currently, however, because such proxies typically have no specific
    handling of DNS as a protocol over TLS or DTLS, using them can
    restrict traffic management at the proxy layer and the DNS server.
    For example, all traffic received by a nameserver behind such a
    proxy will appear to originate from the proxy, and DNS techniques
    such as Access Control Lists (ACLs), Response Rate Limiting (RRL),
    or DNS64 \[[RFC6147](#RFC6147){.xref}\] will be hard or impossible
    to implement in the nameserver.[¶](#section-5.1.8-1.4.1){.pilcrow}

    Operators may choose to use a DNS-aware proxy, such as
    \[[dnsdist](#dnsdist){.xref}\], that offers custom options (similar
    to those proposed in \[[DNS-XPF](#I-D.bellis-dnsop-xpf){.xref}\]) to
    add source information to packets to address this shortcoming. It
    should be noted that such options potentially significantly increase
    the leaked information in the event of a
    misconfiguration.[¶](#section-5.1.8-1.4.2){.pilcrow}

:   
:::
:::
:::
:::

::: {#data-at-rest-on-the-server}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Data at Rest on the Server](#name-data-at-rest-on-the-server){.section-name .selfRef} {#name-data-at-rest-on-the-server}

::: {#data-handling}
::: {#section-5.2.1 .section}
#### [5.2.1.](#section-5.2.1){.section-number .selfRef} [Data Handling](#name-data-handling){.section-name .selfRef} {#name-data-handling}

[]{.break}

Threats described in \[[RFC6973](#RFC6973){.xref}\]:

:   -   [Surveillance.[¶](#section-5.2.1-1.2.1.1){.pilcrow}]{#section-5.2.1-1.2.1.1}
    -   [Stored-data
        compromise.[¶](#section-5.2.1-1.2.1.2){.pilcrow}]{#section-5.2.1-1.2.1.2}
    -   [Correlation.[¶](#section-5.2.1-1.2.1.3){.pilcrow}]{#section-5.2.1-1.2.1.3}
    -   [Identification.[¶](#section-5.2.1-1.2.1.4){.pilcrow}]{#section-5.2.1-1.2.1.4}
    -   [Secondary
        use.[¶](#section-5.2.1-1.2.1.5){.pilcrow}]{#section-5.2.1-1.2.1.5}
    -   [Disclosure.[¶](#section-5.2.1-1.2.1.6){.pilcrow}]{#section-5.2.1-1.2.1.6}

:   

Other Threats

:   -   [Contravention of legal requirements not to process user
        data.[¶](#section-5.2.1-1.4.1.1){.pilcrow}]{#section-5.2.1-1.4.1.1}

:   

Mitigations:

:   The following are recommendations relating to common activities for
    DNS service operators; in all cases, data retention should be
    minimized or completely avoided if possible for DNS privacy
    services. If data is retained, it should be encrypted and either
    aggregated, pseudonymized, or anonymized whenever possible. In
    general, the principle of data minimization described in
    \[[RFC6973](#RFC6973){.xref}\] should be
    applied.[¶](#section-5.2.1-1.6.1){.pilcrow}

    -   [Transient data (e.g., data used for real-time monitoring and
        threat analysis, which might be held only in memory) should be
        retained for the shortest possible period deemed operationally
        feasible.[¶](#section-5.2.1-1.6.2.1){.pilcrow}]{#section-5.2.1-1.6.2.1}
    -   [The retention period of DNS traffic logs should be only as long
        as is required to sustain operation of the service and meet
        regulatory requirements, to the extent that they
        exist.[¶](#section-5.2.1-1.6.2.2){.pilcrow}]{#section-5.2.1-1.6.2.2}
    -   [DNS privacy services should not track users except for the
        particular purpose of detecting and remedying technically
        malicious (e.g., DoS) or anomalous use of the
        service.[¶](#section-5.2.1-1.6.2.3){.pilcrow}]{#section-5.2.1-1.6.2.3}
    -   [Data access should be minimized to only those personnel who
        require access to perform operational duties. It should also be
        limited to anonymized or pseudonymized data where operationally
        feasible, with access to full logs (if any are held) only
        permitted when
        necessary.[¶](#section-5.2.1-1.6.2.4){.pilcrow}]{#section-5.2.1-1.6.2.4}

:   

Optimizations:

:   -   [Consider use of full-disk encryption for logs and data-capture
        storage.[¶](#section-5.2.1-1.8.1.1){.pilcrow}]{#section-5.2.1-1.8.1.1}

:   
:::
:::

::: {#data-minimization-of-network-traffic}
::: {#section-5.2.2 .section}
#### [5.2.2.](#section-5.2.2){.section-number .selfRef} [Data Minimization of Network Traffic](#name-data-minimization-of-networ){.section-name .selfRef} {#name-data-minimization-of-networ}

Data minimization refers to collecting, using, disclosing, and storing
the minimal data necessary to perform a task, and this can be achieved
by removing or obfuscating privacy-sensitive information in network
traffic logs. This is typically personal data or data that can be used
to link a record to an individual, but it may also include other
confidential information \-- for example, on the structure of an
internal corporate network.[¶](#section-5.2.2-1){.pilcrow}

The problem of effectively ensuring that DNS traffic logs contain no or
minimal privacy-sensitive information is not one that currently has a
generally agreed solution or any standards to inform this discussion.
This section presents an overview of current techniques to simply
provide reference on the current status of this
work.[¶](#section-5.2.2-2){.pilcrow}

Research into data minimization techniques (and particularly IP address
pseudonymization/anonymization) was sparked in the late 1990s / early
2000s, partly driven by the desire to share significant corpuses of
traffic captures for research purposes. Several techniques reflecting
different requirements in this area and different performance/resource
trade-offs emerged over the course of the decade. Developments over the
last decade have been both a blessing and a curse; the large increase in
size between an IPv4 and an IPv6 address, for example, renders some
techniques impractical, but also makes available a much larger amount of
input entropy, the better to resist brute-force re-identification
attacks that have grown in practicality over the
period.[¶](#section-5.2.2-3){.pilcrow}

Techniques employed may be broadly categorized as either anonymization
or pseudonymization. The following discussion uses the definitions from
\[[RFC6973](#RFC6973){.xref}\], [Section
3](https://www.rfc-editor.org/rfc/rfc6973#section-3){.relref}, with
additional observations from
\[[van-Dijkhuizen-et-al](#van-Dijkhuizen-et-al){.xref}\].[¶](#section-5.2.2-4){.pilcrow}

-   [Anonymization. To enable anonymity of an individual, there must
    exist a set of individuals that appear to have the same attribute(s)
    as the individual. To the attacker or the observer, these
    individuals must appear indistinguishable from each
    other.[¶](#section-5.2.2-5.1){.pilcrow}]{#section-5.2.2-5.1}
-   [Pseudonymization. The true identity is deterministically replaced
    with an alternate identity (a pseudonym). When the pseudonymization
    schema is known, the process can be reversed, so the original
    identity becomes known
    again.[¶](#section-5.2.2-5.2){.pilcrow}]{#section-5.2.2-5.2}

In practice, there is a fine line between the two; for example, it is
difficult to categorize a deterministic algorithm for data minimization
of IP addresses that produces a group of pseudonyms for a single given
address.[¶](#section-5.2.2-6){.pilcrow}
:::
:::

::: {#ip-address-pseudonymization-and-anonymization-methods}
::: {#section-5.2.3 .section}
#### [5.2.3.](#section-5.2.3){.section-number .selfRef} [IP Address Pseudonymization and Anonymization Methods](#name-ip-address-pseudonymization){.section-name .selfRef} {#name-ip-address-pseudonymization}

A major privacy risk in DNS is connecting DNS queries to an individual,
and the major vector for this in DNS traffic is the client IP
address.[¶](#section-5.2.3-1){.pilcrow}

There is active discussion in the space of effective pseudonymization of
IP addresses in DNS traffic logs; however, there seems to be no single
solution that is widely recognized as suitable for all or most use
cases. There are also as yet no standards for this that are unencumbered
by patents.[¶](#section-5.2.3-2){.pilcrow}

[Appendix B](#ip-address-techniques){.xref} provides a more detailed
survey of various techniques employed or under development in
2020.[¶](#section-5.2.3-3){.pilcrow}
:::
:::

::: {#pseudonymization-anonymization-or-discarding-of-other-correlation-data}
::: {#section-5.2.4 .section}
#### [5.2.4.](#section-5.2.4){.section-number .selfRef} [Pseudonymization, Anonymization, or Discarding of Other Correlation Data](#name-pseudonymization-anonymizat){.section-name .selfRef} {#name-pseudonymization-anonymizat}

[]{.break}

DNS Privacy Threats:

:   -   [Fingerprinting of the client OS via various means, including:
        IP TTL/Hoplimit, TCP parameters (e.g., window size, Explicit
        Congestion Notification (ECN) support, selective acknowledgment
        (SACK)), OS-specific DNS query patterns (e.g., for network
        connectivity, captive portal detection, or OS-specific
        updates).[¶](#section-5.2.4-1.2.1.1){.pilcrow}]{#section-5.2.4-1.2.1.1}
    -   [Fingerprinting of the client application or TLS library by, for
        example, HTTP headers (e.g., User-Agent, Accept,
        Accept-Encoding), TLS version/Cipher-suite combinations, or
        other connection
        parameters.[¶](#section-5.2.4-1.2.1.2){.pilcrow}]{#section-5.2.4-1.2.1.2}
    -   [Correlation of queries on multiple TCP sessions originating
        from the same IP
        address.[¶](#section-5.2.4-1.2.1.3){.pilcrow}]{#section-5.2.4-1.2.1.3}
    -   [Correlating of queries on multiple TLS sessions originating
        from the same client, including via session-resumption
        mechanisms.[¶](#section-5.2.4-1.2.1.4){.pilcrow}]{#section-5.2.4-1.2.1.4}
    -   [Resolvers *might* receive client identifiers \-- e.g., Media
        Access Control (MAC) addresses in EDNS(0) options. Some customer
        premises equipment (CPE) devices are known to add them
        \[[MAC-address-EDNS](#MAC-address-EDNS){.xref}\].[¶](#section-5.2.4-1.2.1.5){.pilcrow}]{#section-5.2.4-1.2.1.5}

:   

Mitigations:

:   -   [Data minimization or discarding of such correlation
        data.[¶](#section-5.2.4-1.4.1.1){.pilcrow}]{#section-5.2.4-1.4.1.1}

:   
:::
:::

::: {#cache-snooping}
::: {#section-5.2.5 .section}
#### [5.2.5.](#section-5.2.5){.section-number .selfRef} [Cache Snooping](#name-cache-snooping){.section-name .selfRef} {#name-cache-snooping}

[]{.break}

Threats described in \[[RFC6973](#RFC6973){.xref}\]:
:   []{.break}

    Surveillance:
    :   Profiling of client queries by malicious third
        parties.[¶](#section-5.2.5-1.2.1.2){.pilcrow}
    :   
:   

Mitigations:
:   See
    \[[ISC-Knowledge-database-on-cache-snooping](#ISC-Knowledge-database-on-cache-snooping){.xref}\]
    for an example discussion on defending against cache snooping.
    Options proposed include limiting access to a server and limiting
    nonrecursive queries.[¶](#section-5.2.5-1.4){.pilcrow}
:   
:::
:::
:::
:::

::: {#data-sent-onwards-from-the-server}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Data Sent Onwards from the Server](#name-data-sent-onwards-from-the-){.section-name .selfRef} {#name-data-sent-onwards-from-the-}

In this section, we consider both data sent on the wire in upstream
queries and data shared with third parties.[¶](#section-5.3-1){.pilcrow}

::: {#protocol-recommendations-1}
::: {#section-5.3.1 .section}
#### [5.3.1.](#section-5.3.1){.section-number .selfRef} [Protocol Recommendations](#name-protocol-recommendations-2){.section-name .selfRef} {#name-protocol-recommendations-2}

[]{.break}

Threats described in \[[RFC6973](#RFC6973){.xref}\]:
:   []{.break}

    Surveillance:
    :   Transmission of identifying data
        upstream.[¶](#section-5.3.1-1.2.1.2){.pilcrow}
    :   
:   

Mitigations:

:   The server should:[¶](#section-5.3.1-1.4.1){.pilcrow}

    -   [implement QNAME minimization
        \[[RFC7816](#RFC7816){.xref}\].[¶](#section-5.3.1-1.4.2.1){.pilcrow}]{#section-5.3.1-1.4.2.1}
    -   [honor a SOURCE PREFIX-LENGTH set to 0 in a query containing the
        EDNS(0) Client Subnet (ECS) option
        (\[[RFC7871](#RFC7871){.xref}\], [Section
        7.1.2](https://www.rfc-editor.org/rfc/rfc7871#section-7.1.2){.relref}).
        This is as specified in \[[RFC8310](#RFC8310){.xref}\] for DoT
        but applicable to any DNS privacy
        service.[¶](#section-5.3.1-1.4.2.2){.pilcrow}]{#section-5.3.1-1.4.2.2}

:   

Optimizations:

:   As per [Section
    2](https://www.rfc-editor.org/rfc/rfc7871#section-2){.relref} of
    \[[RFC7871](#RFC7871){.xref}\], the server should
    either:[¶](#section-5.3.1-1.6.1){.pilcrow}

    -   [not use the ECS option in upstream queries at all,
        or[¶](#section-5.3.1-1.6.2.1){.pilcrow}]{#section-5.3.1-1.6.2.1}
    -   [offer alternative services, one that sends ECS and one that
        does
        not.[¶](#section-5.3.1-1.6.2.2){.pilcrow}]{#section-5.3.1-1.6.2.2}

:   

If operators do offer a service that sends the ECS options upstream,
they should use the shortest prefix that is operationally feasible and
ideally use a policy of allowlisting upstream servers to which to send
ECS in order to reduce data leakage. Operators should make clear in any
policy statement what prefix length they actually send and the specific
policy used.[¶](#section-5.3.1-2){.pilcrow}

Allowlisting has the benefit that not only does the operator know which
upstream servers can use ECS, but also the operator can decide which
upstream servers apply privacy policies that the operator is happy with.
However, some operators consider allowlisting to incur significant
operational overhead compared to dynamic detection of ECS support on
authoritative servers.[¶](#section-5.3.1-3){.pilcrow}

Additional options:[¶](#section-5.3.1-4){.pilcrow}

-   [\"Aggressive Use of DNSSEC-Validated Cache\"
    \[[RFC8198](#RFC8198){.xref}\] and \"NXDOMAIN: There Really Is
    Nothing Underneath\" \[[RFC8020](#RFC8020){.xref}\] to reduce the
    number of queries to authoritative servers to increase
    privacy.[¶](#section-5.3.1-5.1){.pilcrow}]{#section-5.3.1-5.1}
-   [Run a local copy of the root zone \[[RFC8806](#RFC8806){.xref}\] to
    avoid making queries to the root servers that might leak
    information.[¶](#section-5.3.1-5.2){.pilcrow}]{#section-5.3.1-5.2}
:::
:::

::: {#client-query-obfuscation}
::: {#section-5.3.2 .section}
#### [5.3.2.](#section-5.3.2){.section-number .selfRef} [Client Query Obfuscation](#name-client-query-obfuscation){.section-name .selfRef} {#name-client-query-obfuscation}

Additional options:[¶](#section-5.3.2-1){.pilcrow}

Since queries from recursive resolvers to authoritative servers are
performed using cleartext (at the time of writing), resolver services
need to consider the extent to which they may be directly leaking
information about their client community via these upstream queries and
what they can do to mitigate this further. Note that, even when all the
relevant techniques described above are employed, there may still be
attacks possible \-- e.g.,
\[[Pitfalls-of-DNS-Encryption](#Pitfalls-of-DNS-Encryption){.xref}\].
For example, a resolver with a very small community of users risks
exposing data in this way and ought to obfuscate this traffic by mixing
it with \"generated\" traffic to make client characterization harder.
The resolver could also employ aggressive prefetch techniques as a
further measure to counter traffic
analysis.[¶](#section-5.3.2-2){.pilcrow}

At the time of writing, there are no standardized or widely recognized
techniques to perform such obfuscation or bulk
prefetches.[¶](#section-5.3.2-3){.pilcrow}

Another technique that particularly small operators may consider is
forwarding local traffic to a larger resolver (with a privacy policy
that aligns with their own practices) over an encrypted protocol, so
that the upstream queries are obfuscated among those of the large
resolver.[¶](#section-5.3.2-4){.pilcrow}
:::
:::

::: {#data-sharing}
::: {#section-5.3.3 .section}
#### [5.3.3.](#section-5.3.3){.section-number .selfRef} [Data Sharing](#name-data-sharing){.section-name .selfRef} {#name-data-sharing}

[]{.break}

Threats described in \[[RFC6973](#RFC6973){.xref}\]:

:   -   [Surveillance.[¶](#section-5.3.3-1.2.1.1){.pilcrow}]{#section-5.3.3-1.2.1.1}
    -   [Stored-data
        compromise.[¶](#section-5.3.3-1.2.1.2){.pilcrow}]{#section-5.3.3-1.2.1.2}
    -   [Correlation.[¶](#section-5.3.3-1.2.1.3){.pilcrow}]{#section-5.3.3-1.2.1.3}
    -   [Identification.[¶](#section-5.3.3-1.2.1.4){.pilcrow}]{#section-5.3.3-1.2.1.4}
    -   [Secondary
        use.[¶](#section-5.3.3-1.2.1.5){.pilcrow}]{#section-5.3.3-1.2.1.5}
    -   [Disclosure.[¶](#section-5.3.3-1.2.1.6){.pilcrow}]{#section-5.3.3-1.2.1.6}

:   

DNS Privacy Threats:
:   Contravention of legal requirements not to process user
    data.[¶](#section-5.3.3-1.4){.pilcrow}
:   

Mitigations:

:   Operators should not share identifiable data with third
    parties.[¶](#section-5.3.3-1.6.1){.pilcrow}

    If operators choose to share identifiable data with third parties in
    specific circumstances, they should publish the terms under which
    data is shared.[¶](#section-5.3.3-1.6.2){.pilcrow}

    Operators should consider including specific guidelines for the
    collection of aggregated and/or anonymized data for research
    purposes, within or outside of their own organization. This can
    benefit not only the operator (through inclusion in novel research)
    but also the wider Internet community. See the policy published by
    SURFnet \[[SURFnet-policy](#SURFnet-policy){.xref}\] on data sharing
    for research as an example.[¶](#section-5.3.3-1.6.3){.pilcrow}

:   
:::
:::
:::
:::
:::
:::

::: {#recursive-operator-privacy-statement-rps}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Recursive Operator Privacy Statement (RPS)](#name-recursive-operator-privacy-){.section-name .selfRef} {#name-recursive-operator-privacy-}

To be compliant with this Best Current Practice document, a DNS
recursive operator [SHOULD]{.bcp14} publish a Recursive operator Privacy
Statement (RPS). Adopting the outline, and including the headings in the
order provided, is a benefit to persons comparing RPSs from multiple
operators.[¶](#section-6-1){.pilcrow}

[Appendix C](#current-policy-and-privacy-statements){.xref} provides a
comparison of some existing policy and privacy
statements.[¶](#section-6-2){.pilcrow}

::: {#outline-of-an-rps}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Outline of an RPS](#name-outline-of-an-rps){.section-name .selfRef} {#name-outline-of-an-rps}

The contents of Sections [6.1.1](#policy){.xref} and
[6.1.2](#practice){.xref} are non-normative, other than the order of the
headings. Material under each topic is present to assist the operator
developing their own RPS. This material:[¶](#section-6.1-1){.pilcrow}

-   [Relates *only* to matters around the technical operation of DNS
    privacy services, and no other
    matters.[¶](#section-6.1-2.1){.pilcrow}]{#section-6.1-2.1}
-   [Does not attempt to offer an exhaustive list for the contents of an
    RPS.[¶](#section-6.1-2.2){.pilcrow}]{#section-6.1-2.2}
-   [Is not intended to form the basis of any legal/compliance
    documentation.[¶](#section-6.1-2.3){.pilcrow}]{#section-6.1-2.3}

[Appendix D](#example-rps){.xref} provides an example (also
non-normative) of an RPS statement for a specific operator
scenario.[¶](#section-6.1-3){.pilcrow}

::: {#policy}
::: {#section-6.1.1 .section}
#### [6.1.1.](#section-6.1.1){.section-number .selfRef} [Policy](#name-policy){.section-name .selfRef} {#name-policy}

1.  [Treatment of IP addresses. Make an explicit statement that IP
    addresses are treated as personal
    data.[¶](#section-6.1.1-1.1){.pilcrow}]{#section-6.1.1-1.1}

2.  ::: {#section-6.1.1-1.2}
    Data collection and sharing. Specify clearly what data (including IP
    addresses) is:[¶](#section-6.1.1-1.2.1){.pilcrow}

    -   [Collected and retained by the operator, and for what period it
        is
        retained.[¶](#section-6.1.1-1.2.2.1){.pilcrow}]{#section-6.1.1-1.2.2.1}

    -   [Shared with
        partners.[¶](#section-6.1.1-1.2.2.2){.pilcrow}]{#section-6.1.1-1.2.2.2}

    -   ::: {#section-6.1.1-1.2.2.3}
        Shared, sold, or rented to third
        parties.[¶](#section-6.1.1-1.2.2.3.1){.pilcrow}
        :::

    In each case, specify whether data is aggregated, pseudonymized, or
    anonymized and the conditions of data transfer. Where possible
    provide details of the techniques used for the above data
    minimizations.[¶](#section-6.1.1-1.2.3){.pilcrow}
    :::

3.  [Exceptions. Specify any exceptions to the above \-- for example,
    technically malicious or anomalous
    behavior.[¶](#section-6.1.1-1.3){.pilcrow}]{#section-6.1.1-1.3}

4.  [Associated entities. Declare and explicitly enumerate any partners,
    third-party affiliations, or sources of
    funding.[¶](#section-6.1.1-1.4){.pilcrow}]{#section-6.1.1-1.4}

5.  [Correlation. Whether user DNS data is correlated or combined with
    any other personal information held by the
    operator.[¶](#section-6.1.1-1.5){.pilcrow}]{#section-6.1.1-1.5}

6.  ::: {#section-6.1.1-1.6}
    Result filtering. This section should explain whether the operator
    filters, edits, or alters in any way the replies that it receives
    from the authoritative servers for each DNS zone before forwarding
    them to the clients. For each category listed below, the operator
    should also specify how the filtering lists are created and managed,
    whether it employs any third-party sources for such lists, and which
    ones.[¶](#section-6.1.1-1.6.1){.pilcrow}

    -   [Specify if any replies are being filtered out or altered for
        network- and computer-security reasons (e.g., preventing
        connections to malware-spreading websites or botnet control
        servers).[¶](#section-6.1.1-1.6.2.1){.pilcrow}]{#section-6.1.1-1.6.2.1}
    -   [Specify if any replies are being filtered out or altered for
        mandatory legal reasons, due to applicable legislation or
        binding orders by courts and other public
        authorities.[¶](#section-6.1.1-1.6.2.2){.pilcrow}]{#section-6.1.1-1.6.2.2}
    -   [Specify if any replies are being filtered out or altered for
        voluntary legal reasons, due to an internal policy by the
        operator aiming at reducing potential legal
        risks.[¶](#section-6.1.1-1.6.2.3){.pilcrow}]{#section-6.1.1-1.6.2.3}
    -   [Specify if any replies are being filtered out or altered for
        any other reason, including commercial
        ones.[¶](#section-6.1.1-1.6.2.4){.pilcrow}]{#section-6.1.1-1.6.2.4}
    :::
:::
:::

::: {#practice}
::: {#section-6.1.2 .section}
#### [6.1.2.](#section-6.1.2){.section-number .selfRef} [Practice](#name-practice){.section-name .selfRef} {#name-practice}

Communicate the current operational practices of the
service.[¶](#section-6.1.2-1){.pilcrow}

1.  [Deviations. Specify any temporary or permanent deviations from the
    policy for operational
    reasons.[¶](#section-6.1.2-2.1){.pilcrow}]{#section-6.1.2-2.1}

2.  ::: {#section-6.1.2-2.2}
    Client-facing capabilities. With reference to each subsection of
    [Section 5.1](#on-the-wire-between-client-and-server){.xref},
    provide specific details of which capabilities (transport, DNSSEC,
    padding, etc.) are provided on which client-facing addresses/port
    combination or DoH URI template. For [Section
    5.1.2](#authentication-of-dns-privacy-services){.xref}, clearly
    specify which specific authentication mechanisms are supported for
    each endpoint that offers DoT:[¶](#section-6.1.2-2.2.1){.pilcrow}

    a.  [The authentication domain name to be used (if
        any).[¶](#section-6.1.2-2.2.2.1){.pilcrow}]{#section-6.1.2-2.2.2.1}

    b.  ::: {#section-6.1.2-2.2.2.2}
        The SPKI pin sets to be used (if any) and policy for rolling
        keys.[¶](#section-6.1.2-2.2.2.2.1){.pilcrow}
        :::
    :::

3.  [Upstream capabilities. With reference to [Section
    5.3](#data-sent-onwards-from-the-server){.xref}, provide specific
    details of which capabilities are provided upstream for data sent to
    authoritative
    servers.[¶](#section-6.1.2-2.3){.pilcrow}]{#section-6.1.2-2.3}

4.  [Support. Provide contact/support information for the
    service.[¶](#section-6.1.2-2.4){.pilcrow}]{#section-6.1.2-2.4}

5.  [Data Processing. This section can optionally communicate links to,
    and the high-level contents of, any separate statements the operator
    has published that cover applicable data-processing legislation or
    agreements with regard to the location(s) of service
    provision.[¶](#section-6.1.2-2.5){.pilcrow}]{#section-6.1.2-2.5}
:::
:::
:::
:::

::: {#enforcementaccountability}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Enforcement/Accountability](#name-enforcement-accountability){.section-name .selfRef} {#name-enforcement-accountability}

Transparency reports may help with building user trust that operators
adhere to their policies and practices.[¶](#section-6.2-1){.pilcrow}

Where possible, independent monitoring or analysis could be performed
of:[¶](#section-6.2-2){.pilcrow}

-   [ECS, QNAME minimization, EDNS(0) padding,
    etc.[¶](#section-6.2-3.1){.pilcrow}]{#section-6.2-3.1}
-   [Filtering.[¶](#section-6.2-3.2){.pilcrow}]{#section-6.2-3.2}
-   [Uptime.[¶](#section-6.2-3.3){.pilcrow}]{#section-6.2-3.3}

This is by analogy with several TLS or website-analysis tools that are
currently available \-- e.g., \[[SSL-Labs](#SSL-Labs){.xref}\] or
\[[Internet.nl](#Internet.nl){.xref}\].[¶](#section-6.2-4){.pilcrow}

Additionally, operators could choose to engage the services of a
third-party auditor to verify their compliance with their published
RPS.[¶](#section-6.2-5){.pilcrow}
:::
:::
:::
:::

::: {#iana-considerations}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-7-1){.pilcrow}
:::
:::

::: {#security-considerations}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

Security considerations for DNS over TCP are given in
\[[RFC7766](#RFC7766){.xref}\], many of which are generally applicable
to session-based DNS. Guidance on operational requirements for DNS over
TCP are also available in
\[[DNS-OVER-TCP](#I-D.ietf-dnsop-dns-tcp-requirements){.xref}\].
Security considerations for DoT are given in
\[[RFC7858](#RFC7858){.xref}\] and \[[RFC8310](#RFC8310){.xref}\], and
those for DoH in
\[[RFC8484](#RFC8484){.xref}\].[¶](#section-8-1){.pilcrow}

Security considerations for DNSSEC are given in
\[[RFC4033](#RFC4033){.xref}\], \[[RFC4034](#RFC4034){.xref}\], and
\[[RFC4035](#RFC4035){.xref}\].[¶](#section-8-2){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4033\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"DNS Security Introduction and
    Requirements\"]{.refTitle}, [RFC 4033]{.seriesInfo}, [DOI
    10.17487/RFC4033]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4033>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}[, Santesson, S.]{.refAuthor}[,
    Farrell, S.]{.refAuthor}[, Boeyen, S.]{.refAuthor}[,
    Housley, R.]{.refAuthor}[, and W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC6973\]
:   [Cooper, A.]{.refAuthor}[, Tschofenig, H.]{.refAuthor}[,
    Aboba, B.]{.refAuthor}[, Peterson, J.]{.refAuthor}[,
    Morris, J.]{.refAuthor}[, Hansen, M.]{.refAuthor}[, and R.
    Smith]{.refAuthor}, [\"Privacy Considerations for Internet
    Protocols\"]{.refTitle}, [RFC 6973]{.seriesInfo}, [DOI
    10.17487/RFC6973]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6973>\>.
:   

\[RFC7457\]
:   [Sheffer, Y.]{.refAuthor}[, Holz, R.]{.refAuthor}[, and P.
    Saint-Andre]{.refAuthor}, [\"Summarizing Known Attacks on Transport
    Layer Security (TLS) and Datagram TLS (DTLS)\"]{.refTitle}, [RFC
    7457]{.seriesInfo}, [DOI 10.17487/RFC7457]{.seriesInfo}, February
    2015, \<<https://www.rfc-editor.org/info/rfc7457>\>.
:   

\[RFC7525\]
:   [Sheffer, Y.]{.refAuthor}[, Holz, R.]{.refAuthor}[, and P.
    Saint-Andre]{.refAuthor}, [\"Recommendations for Secure Use of
    Transport Layer Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [BCP 195]{.seriesInfo}, [RFC
    7525]{.seriesInfo}, [DOI 10.17487/RFC7525]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7525>\>.
:   

\[RFC7766\]
:   [Dickinson, J.]{.refAuthor}[, Dickinson, S.]{.refAuthor}[,
    Bellis, R.]{.refAuthor}[, Mankin, A.]{.refAuthor}[, and D.
    Wessels]{.refAuthor}, [\"DNS Transport over TCP - Implementation
    Requirements\"]{.refTitle}, [RFC 7766]{.seriesInfo}, [DOI
    10.17487/RFC7766]{.seriesInfo}, March 2016,
    \<<https://www.rfc-editor.org/info/rfc7766>\>.
:   

\[RFC7816\]
:   [Bortzmeyer, S.]{.refAuthor}, [\"DNS Query Name Minimisation to
    Improve Privacy\"]{.refTitle}, [RFC 7816]{.seriesInfo}, [DOI
    10.17487/RFC7816]{.seriesInfo}, March 2016,
    \<<https://www.rfc-editor.org/info/rfc7816>\>.
:   

\[RFC7828\]
:   [Wouters, P.]{.refAuthor}[, Abley, J.]{.refAuthor}[,
    Dickinson, S.]{.refAuthor}[, and R. Bellis]{.refAuthor}, [\"The
    edns-tcp-keepalive EDNS0 Option\"]{.refTitle}, [RFC
    7828]{.seriesInfo}, [DOI 10.17487/RFC7828]{.seriesInfo}, April 2016,
    \<<https://www.rfc-editor.org/info/rfc7828>\>.
:   

\[RFC7830\]
:   [Mayrhofer, A.]{.refAuthor}, [\"The EDNS(0) Padding
    Option\"]{.refTitle}, [RFC 7830]{.seriesInfo}, [DOI
    10.17487/RFC7830]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7830>\>.
:   

\[RFC7858\]
:   [Hu, Z.]{.refAuthor}[, Zhu, L.]{.refAuthor}[,
    Heidemann, J.]{.refAuthor}[, Mankin, A.]{.refAuthor}[,
    Wessels, D.]{.refAuthor}[, and P. Hoffman]{.refAuthor},
    [\"Specification for DNS over Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 7858]{.seriesInfo}, [DOI
    10.17487/RFC7858]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7858>\>.
:   

\[RFC7871\]
:   [Contavalli, C.]{.refAuthor}[, van der Gaast, W.]{.refAuthor}[,
    Lawrence, D.]{.refAuthor}[, and W. Kumari]{.refAuthor}, [\"Client
    Subnet in DNS Queries\"]{.refTitle}, [RFC 7871]{.seriesInfo}, [DOI
    10.17487/RFC7871]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7871>\>.
:   

\[RFC8020\]
:   [Bortzmeyer, S.]{.refAuthor}[ and S. Huque]{.refAuthor},
    [\"NXDOMAIN: There Really Is Nothing Underneath\"]{.refTitle}, [RFC
    8020]{.seriesInfo}, [DOI 10.17487/RFC8020]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8020>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8198\]
:   [Fujiwara, K.]{.refAuthor}[, Kato, A.]{.refAuthor}[, and W.
    Kumari]{.refAuthor}, [\"Aggressive Use of DNSSEC-Validated
    Cache\"]{.refTitle}, [RFC 8198]{.seriesInfo}, [DOI
    10.17487/RFC8198]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8198>\>.
:   

\[RFC8310\]
:   [Dickinson, S.]{.refAuthor}[, Gillmor, D.]{.refAuthor}[, and T.
    Reddy]{.refAuthor}, [\"Usage Profiles for DNS over TLS and DNS over
    DTLS\"]{.refTitle}, [RFC 8310]{.seriesInfo}, [DOI
    10.17487/RFC8310]{.seriesInfo}, March 2018,
    \<<https://www.rfc-editor.org/info/rfc8310>\>.
:   

\[RFC8467\]
:   [Mayrhofer, A.]{.refAuthor}, [\"Padding Policies for Extension
    Mechanisms for DNS (EDNS(0))\"]{.refTitle}, [RFC 8467]{.seriesInfo},
    [DOI 10.17487/RFC8467]{.seriesInfo}, October 2018,
    \<<https://www.rfc-editor.org/info/rfc8467>\>.
:   

\[RFC8484\]
:   [Hoffman, P.]{.refAuthor}[ and P. McManus]{.refAuthor}, [\"DNS
    Queries over HTTPS (DoH)\"]{.refTitle}, [RFC 8484]{.seriesInfo},
    [DOI 10.17487/RFC8484]{.seriesInfo}, October 2018,
    \<<https://www.rfc-editor.org/info/rfc8484>\>.
:   

\[RFC8490\]
:   [Bellis, R.]{.refAuthor}[, Cheshire, S.]{.refAuthor}[,
    Dickinson, J.]{.refAuthor}[, Dickinson, S.]{.refAuthor}[,
    Lemon, T.]{.refAuthor}[, and T. Pusateri]{.refAuthor}, [\"DNS
    Stateful Operations\"]{.refTitle}, [RFC 8490]{.seriesInfo}, [DOI
    10.17487/RFC8490]{.seriesInfo}, March 2019,
    \<<https://www.rfc-editor.org/info/rfc8490>\>.
:   

\[RFC8499\]
:   [Hoffman, P.]{.refAuthor}[, Sullivan, A.]{.refAuthor}[, and K.
    Fujiwara]{.refAuthor}, [\"DNS Terminology\"]{.refTitle}, [BCP
    219]{.seriesInfo}, [RFC 8499]{.seriesInfo}, [DOI
    10.17487/RFC8499]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8499>\>.
:   

\[RFC8806\]
:   [Kumari, W.]{.refAuthor}[ and P. Hoffman]{.refAuthor}, [\"Running a
    Root Server Local to a Resolver\"]{.refTitle}, [RFC
    8806]{.seriesInfo}, [DOI 10.17487/RFC8806]{.seriesInfo}, June 2020,
    \<<https://www.rfc-editor.org/info/rfc8806>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[Bloom-filter\]
:   [van Rijswijk-Deij, R.]{.refAuthor}[, Rijnders, G.]{.refAuthor}[,
    Bomhoff, M.]{.refAuthor}[, and L. Allodi]{.refAuthor},
    [\"Privacy-Conscious Threat Intelligence Using
    DNSBLOOM\"]{.refTitle}, [IFIP/IEEE International Symposium on
    Integrated Network Management (IM2019)]{.refContent}, 2019,
    \<<http://dl.ifip.org/db/conf/im/im2019/189282.pdf>\>.
:   

\[Brekne-and-Arnes\]
:   [Brekne, T.]{.refAuthor}[ and A. Årnes]{.refAuthor},
    [\"Circumventing IP-address pseudonymization\"]{.refTitle},
    [Communications and Computer Networks]{.seriesInfo}, 2005,
    \<<https://pdfs.semanticscholar.org/7b34/12c951cebe71cd2cddac5fda164fb2138a44.pdf>\>.
:   

\[BUILD-W-HTTP\]
:   [Nottingham, M.]{.refAuthor}, [\"Building Protocols with
    HTTP\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-httpbis-bcp56bis-09]{.seriesInfo}, 1
    November 2019,
    \<<https://tools.ietf.org/html/draft-ietf-httpbis-bcp56bis-09>\>.
:   

\[Crypto-PAn\]
:   [CESNET]{.refAuthor}, [\"Crypto-PAn\"]{.refTitle}, [commit
    636b237]{.seriesInfo}, March 2015,
    \<<https://github.com/CESNET/ipfixcol/tree/master/base/src/intermediate/anonymization/Crypto-PAn>\>.
:   

\[DNS-OVER-TCP\]
:   [Kristoff, J.]{.refAuthor}[ and D. Wessels]{.refAuthor}, [\"DNS
    Transport over TCP - Operational Requirements\"]{.refTitle}, [Work
    in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-dnsop-dns-tcp-requirements-06]{.seriesInfo}, 6 May 2020,
    \<<https://tools.ietf.org/html/draft-ietf-dnsop-dns-tcp-requirements-06>\>.
:   

\[DNS-Privacy-not-so-private\]
:   [Silby, S.]{.refAuthor}[, Juarez, M.]{.refAuthor}[,
    Vallina-Rodriguez, N.]{.refAuthor}[, and C. Troncoso]{.refAuthor},
    [\"DNS Privacy not so private: the traffic analysis
    perspective.\"]{.refTitle}, [Privacy Enhancing Technologies
    Symposium]{.seriesInfo}, 2018,
    \<<https://petsymposium.org/2018/files/hotpets/4-siby.pdf>\>.
:   

\[DNS-XPF\]
:   [Bellis, R.]{.refAuthor}[, Dijk, P. V.]{.refAuthor}[, and R.
    Gacogne]{.refAuthor}, [\"DNS X-Proxied-For\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-bellis-dnsop-xpf-04]{.seriesInfo}, 5 March 2018,
    \<<https://tools.ietf.org/html/draft-bellis-dnsop-xpf-04>\>.
:   

\[DNSCrypt\]
:   [\"DNSCrypt - Official Project Home Page\"]{.refTitle},
    \<<https://www.dnscrypt.org>\>.
:   

\[dnsdist\]
:   [PowerDNS]{.refAuthor}, [\"dnsdist Overview\"]{.refTitle},
    \<<https://dnsdist.org>\>.
:   

\[dnstap\]
:   [\"dnstap\"]{.refTitle}, \<<https://dnstap.info>\>.
:   

\[DoH-resolver-policy\]
:   [Mozilla]{.refAuthor},
    [\"Security/DOH-resolver-policy\"]{.refTitle}, 2019,
    \<<https://wiki.mozilla.org/Security/DOH-resolver-policy>\>.
:   

\[dot-ALPN\]
:   [IANA]{.refAuthor}, [\"Transport Layer Security (TLS) Extensions:
    TLS Application-Layer Protocol Negotiation (ALPN) Protocol
    IDs\"]{.refTitle},
    \<<https://www.iana.org/assignments/tls-extensiontype-values>\>.
:   

\[Geolocation-Impact-Assessment\]
:   [Conversion Works]{.refAuthor}, [\"Anonymize IP Geolocation Accuracy
    Impact Assessment\"]{.refTitle}, 19 May 2017,
    \<<https://www.conversionworks.co.uk/blog/2017/05/19/anonymize-ip-geo-impact-test/>\>.
:   

\[haproxy\]
:   [\"HAProxy - The Reliable, High Performance TCP/HTTP Load
    Balancer\"]{.refTitle}, \<<https://www.haproxy.org/>\>.
:   

\[Harvan\]
:   [Harvan, M.]{.refAuthor}, [\"Prefix- and
    Lexicographical-order-preserving IP Address
    Anonymization\"]{.refTitle}, [IEEE/IFIP Network Operations and
    Management Symposium]{.refContent}, [DOI
    10.1109/NOMS.2006.1687580]{.seriesInfo}, 2006,
    \<<http://mharvan.net/talks/noms-ip_anon.pdf>\>.
:   

\[Internet.nl\]
:   [Internet.nl]{.refAuthor}, [\"Internet.nl Is Your Internet Up To
    Date?\"]{.refTitle}, 2019, \<<https://internet.nl>\>.
:   

\[IP-Anonymization-in-Analytics\]
:   [Google]{.refAuthor}, [\"IP Anonymization in
    Analytics\"]{.refTitle}, 2019,
    \<<https://support.google.com/analytics/answer/2763052?hl=en>\>.
:   

\[ipcipher1\]
:   [Hubert, B.]{.refAuthor}, [\"On IP address encryption: security
    analysis with respect for privacy\"]{.refTitle},
    [Medium]{.refContent}, 7 May 2017,
    \<<https://medium.com/@bert.hubert/on-ip-address-encryption-security-analysis-with-respect-for-privacy-dabe1201b476>\>.
:   

\[ipcipher2\]
:   [PowerDNS]{.refAuthor}, [\"ipcipher\"]{.refTitle}, [commit
    fd47abe]{.seriesInfo}, 13 February 2018,
    \<<https://github.com/PowerDNS/ipcipher>\>.
:   

\[ipcrypt\]
:   [veorq]{.refAuthor}, [\"ipcrypt: IP-format-preserving
    encryption\"]{.refTitle}, [commit 8cc12f9]{.seriesInfo}, 6 July
    2015, \<<https://github.com/veorq/ipcrypt>\>.
:   

\[ipcrypt-analysis\]
:   [Aumasson, J-P.]{.refAuthor}, [\"Subject: Re: \[Cfrg\] Analysis of
    ipcrypt?\"]{.refTitle}, [message to the Cfrg mailing
    list]{.refContent}, 22 February 2018,
    \<<https://mailarchive.ietf.org/arch/msg/cfrg/cFx5WJo48ZEN-a5cj_LlyrdN8-0/>\>.
:   

\[ISC-Knowledge-database-on-cache-snooping\]
:   [Goldlust, S.]{.refAuthor}[ and C. Almond]{.refAuthor}, [\"DNS Cache
    snooping - should I be concerned?\"]{.refTitle}, [ISC Knowledge
    Database]{.seriesInfo}, 15 October 2018,
    \<<https://kb.isc.org/docs/aa-00482>\>.
:   

\[MAC-address-EDNS\]
:   [Hubert, B.]{.refAuthor}, [\"Embedding MAC address in DNS requests
    for selective filtering\"]{.refTitle}, [DNS-OARC mailing
    list]{.seriesInfo}, 25 January 2016,
    \<<https://lists.dns-oarc.net/pipermail/dns-operations/2016-January/014143.html>\>.
:   

\[nginx\]
:   [nginx.org]{.refAuthor}, [\"nginx news\"]{.refTitle}, 2019,
    \<<https://nginx.org/>\>.
:   

\[Passive-Observations-of-a-Large-DNS\]
:   [de Vries, W. B.]{.refAuthor}[, van Rijswijk-Deij, R.]{.refAuthor}[,
    de Boer, P-T.]{.refAuthor}[, and A. Pras]{.refAuthor}, [\"Passive
    Observations of a Large DNS Service: 2.5 Years in the Life of
    Google\"]{.refTitle}, [DOI 10.23919/TMA.2018.8506536]{.seriesInfo},
    2018,
    \<<http://tma.ifip.org/2018/wp-content/uploads/sites/3/2018/06/tma2018_paper30.pdf>\>.
:   

\[pcap\]
:   [The Tcpdump Group]{.refAuthor}, [\"Tcpdump & Libpcap\"]{.refTitle},
    2020, \<<https://www.tcpdump.org/>\>.
:   

\[Pitfalls-of-DNS-Encryption\]
:   [Shulman, H.]{.refAuthor}, [\"Pretty Bad Privacy: Pitfalls of DNS
    Encryption\"]{.refTitle}, [Proceedings of the 13th Workshop on
    Privacy in the Electronic Society, pp. 191-200]{.refContent}, [DOI
    10.1145/2665943.2665959]{.seriesInfo}, November 2014,
    \<<https://dl.acm.org/citation.cfm?id=2665959>\>.
:   

\[policy-comparison\]
:   [Dickinson, S.]{.refAuthor}, [\"Comparison of policy and privacy
    statements 2019\"]{.refTitle}, [DNS Privacy Project]{.refContent},
    18 December 2019,
    \<<https://dnsprivacy.org/wiki/display/DP/Comparison+of+policy+and+privacy+statements+2019>\>.
:   

\[PowerDNS-dnswasher\]
:   [PowerDNS]{.refAuthor}, [\"dnswasher\"]{.refTitle}, [commit
    050e687]{.seriesInfo}, 24 April 2020,
    \<<https://github.com/PowerDNS/pdns/blob/master/pdns/dnswasher.cc>\>.
:   

\[Ramaswamy-and-Wolf\]
:   [Ramaswamy, R.]{.refAuthor}[ and T. Wolf]{.refAuthor}, [\"High-Speed
    Prefix-Preserving IP Address Anonymization for Passive Measurement
    Systems\"]{.refTitle}, [DOI 10.1109/TNET.2006.890128]{.seriesInfo},
    2007, \<<http://www.ecs.umass.edu/ece/wolf/pubs/ton2007.pdf>\>.
:   

\[RFC4034\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Resource Records for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4034]{.seriesInfo}, [DOI
    10.17487/RFC4034]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4034>\>.
:   

\[RFC4035\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Protocol Modifications for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4035]{.seriesInfo}, [DOI
    10.17487/RFC4035]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4035>\>.
:   

\[RFC5077\]
:   [Salowey, J.]{.refAuthor}[, Zhou, H.]{.refAuthor}[,
    Eronen, P.]{.refAuthor}[, and H. Tschofenig]{.refAuthor},
    [\"Transport Layer Security (TLS) Session Resumption without
    Server-Side State\"]{.refTitle}, [RFC 5077]{.seriesInfo}, [DOI
    10.17487/RFC5077]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5077>\>.
:   

\[RFC6147\]
:   [Bagnulo, M.]{.refAuthor}[, Sullivan, A.]{.refAuthor}[,
    Matthews, P.]{.refAuthor}[, and I. van Beijnum]{.refAuthor},
    [\"DNS64: DNS Extensions for Network Address Translation from IPv6
    Clients to IPv4 Servers\"]{.refTitle}, [RFC 6147]{.seriesInfo}, [DOI
    10.17487/RFC6147]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6147>\>.
:   

\[RFC6235\]
:   [Boschi, E.]{.refAuthor}[ and B. Trammell]{.refAuthor}, [\"IP Flow
    Anonymization Support\"]{.refTitle}, [RFC 6235]{.seriesInfo}, [DOI
    10.17487/RFC6235]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6235>\>.
:   

\[RFC6265\]
:   [Barth, A.]{.refAuthor}, [\"HTTP State Management
    Mechanism\"]{.refTitle}, [RFC 6265]{.seriesInfo}, [DOI
    10.17487/RFC6265]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6265>\>.
:   

\[RFC7626\]
:   [Bortzmeyer, S.]{.refAuthor}, [\"DNS Privacy
    Considerations\"]{.refTitle}, [RFC 7626]{.seriesInfo}, [DOI
    10.17487/RFC7626]{.seriesInfo}, August 2015,
    \<<https://www.rfc-editor.org/info/rfc7626>\>.
:   

\[RFC7873\]
:   [Eastlake 3rd, D.]{.refAuthor}[ and M. Andrews]{.refAuthor},
    [\"Domain Name System (DNS) Cookies\"]{.refTitle}, [RFC
    7873]{.seriesInfo}, [DOI 10.17487/RFC7873]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7873>\>.
:   

\[RFC8027\]
:   [Hardaker, W.]{.refAuthor}[, Gudmundsson, O.]{.refAuthor}[, and S.
    Krishnaswamy]{.refAuthor}, [\"DNSSEC Roadblock
    Avoidance\"]{.refTitle}, [BCP 207]{.seriesInfo}, [RFC
    8027]{.seriesInfo}, [DOI 10.17487/RFC8027]{.seriesInfo}, November
    2016, \<<https://www.rfc-editor.org/info/rfc8027>\>.
:   

\[RFC8094\]
:   [Reddy, T.]{.refAuthor}[, Wing, D.]{.refAuthor}[, and P.
    Patil]{.refAuthor}, [\"DNS over Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [RFC 8094]{.seriesInfo}, [DOI
    10.17487/RFC8094]{.seriesInfo}, February 2017,
    \<<https://www.rfc-editor.org/info/rfc8094>\>.
:   

\[RFC8404\]
:   [Moriarty, K., Ed.]{.refAuthor}[ and A. Morton, Ed.]{.refAuthor},
    [\"Effects of Pervasive Encryption on Operators\"]{.refTitle}, [RFC
    8404]{.seriesInfo}, [DOI 10.17487/RFC8404]{.seriesInfo}, July 2018,
    \<<https://www.rfc-editor.org/info/rfc8404>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   

\[RFC8555\]
:   [Barnes, R.]{.refAuthor}[, Hoffman-Andrews, J.]{.refAuthor}[,
    McCarney, D.]{.refAuthor}[, and J. Kasten]{.refAuthor}, [\"Automatic
    Certificate Management Environment (ACME)\"]{.refTitle}, [RFC
    8555]{.seriesInfo}, [DOI 10.17487/RFC8555]{.seriesInfo}, March 2019,
    \<<https://www.rfc-editor.org/info/rfc8555>\>.
:   

\[RFC8618\]
:   [Dickinson, J.]{.refAuthor}[, Hague, J.]{.refAuthor}[,
    Dickinson, S.]{.refAuthor}[, Manderson, T.]{.refAuthor}[, and J.
    Bond]{.refAuthor}, [\"Compacted-DNS (C-DNS): A Format for DNS Packet
    Capture\"]{.refTitle}, [RFC 8618]{.seriesInfo}, [DOI
    10.17487/RFC8618]{.seriesInfo}, September 2019,
    \<<https://www.rfc-editor.org/info/rfc8618>\>.
:   

\[SSL-Labs\]
:   [SSL Labs]{.refAuthor}, [\"SSL Server Test\"]{.refTitle}, 2019,
    \<<https://www.ssllabs.com/ssltest/>\>.
:   

\[stunnel\]
:   [Goldlust, S.]{.refAuthor}[, Almond, C.]{.refAuthor}[, and F.
    Dupont]{.refAuthor}, [\"DNS over TLS\"]{.refTitle}, [ISC Knowledge
    Database\"]{.refContent}, 1 November 2018,
    \<<https://kb.isc.org/article/AA-01386/0/DNS-over-TLS.html>\>.
:   

\[SURFnet-policy\]
:   [Baartmans, C.]{.refAuthor}[, van Wynsberghe, A.]{.refAuthor}[, van
    Rijswijk-Deij, R.]{.refAuthor}[, and F. Jorna]{.refAuthor},
    [\"SURFnet Data Sharing Policy\"]{.refTitle}, June 2016,
    \<<https://surf.nl/datasharing>\>.
:   

\[tcpdpriv\]
:   [Ipsilon Networks, Inc.]{.refAuthor}, [\"TCPDRIV - Program for
    Eliminating Confidential Information from Traces\"]{.refTitle},
    2004, \<<http://fly.isti.cnr.it/software/tcpdpriv/>\>.
:   

\[van-Dijkhuizen-et-al\]
:   [Van Dijkhuizen, N.]{.refAuthor}[ and J. Van Der Ham]{.refAuthor},
    [\"A Survey of Network Traffic Anonymisation Techniques and
    Implementations\"]{.refTitle}, [ACM Computing Surveys]{.refContent},
    [DOI 10.1145/3182660]{.seriesInfo}, May 2018,
    \<<https://doi.org/10.1145/3182660>\>.
:   

\[Xu-et-al\]
:   [Fan, J.]{.refAuthor}[, Xu, J.]{.refAuthor}[, Ammar,
    M.H.]{.refAuthor}[, and S.B. Moon]{.refAuthor}, [\"Prefix-preserving
    IP address anonymization: measurement-based security evaluation and
    a new cryptography-based scheme\"]{.refTitle}, [DOI
    10.1016/j.comnet.2004.03.033]{.seriesInfo}, 2004,
    \<<http://an.kaist.ac.kr/~sbmoon/paper/intl-journal/2004-cn-anon.pdf>\>.
:   
:::
:::

::: {#documents}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Documents](#name-documents){.section-name .selfRef} {#name-documents}

This section provides an overview of some DNS privacy-related documents.
However, this is neither an exhaustive list nor a definitive statement
on the characteristics of any document with regard to potential
increases or decreases in DNS
privacy.[¶](#section-appendix.a-1){.pilcrow}

::: {#potential-increases-in-dns-privacy}
::: {#section-a.1 .section}
## [A.1.](#section-a.1){.section-number .selfRef} [Potential Increases in DNS Privacy](#name-potential-increases-in-dns-){.section-name .selfRef} {#name-potential-increases-in-dns-}

These documents are limited in scope to communications between stub
clients and recursive resolvers:[¶](#section-a.1-1){.pilcrow}

-   [\"Specification for DNS over Transport Layer Security (TLS)\"
    \[[RFC7858](#RFC7858){.xref}\].[¶](#section-a.1-2.1){.pilcrow}]{#section-a.1-2.1}
-   [\"DNS over Datagram Transport Layer Security (DTLS)\"
    \[[RFC8094](#RFC8094){.xref}\]. Note that this document has the
    category of
    Experimental.[¶](#section-a.1-2.2){.pilcrow}]{#section-a.1-2.2}
-   [\"DNS Queries over HTTPS (DoH)\"
    \[[RFC8484](#RFC8484){.xref}\].[¶](#section-a.1-2.3){.pilcrow}]{#section-a.1-2.3}
-   [\"Usage Profiles for DNS over TLS and DNS over DTLS\"
    \[[RFC8310](#RFC8310){.xref}\].[¶](#section-a.1-2.4){.pilcrow}]{#section-a.1-2.4}
-   [\"The EDNS(0) Padding Option\" \[[RFC7830](#RFC7830){.xref}\] and
    \"Padding Policies for Extension Mechanisms for DNS (EDNS(0))\"
    \[[RFC8467](#RFC8467){.xref}\].[¶](#section-a.1-2.5){.pilcrow}]{#section-a.1-2.5}

These documents apply to recursive and authoritative DNS but are
relevant when considering the operation of a recursive
server:[¶](#section-a.1-3){.pilcrow}

-   [\"DNS Query Name Minimisation to Improve Privacy\"
    \[[RFC7816](#RFC7816){.xref}\].[¶](#section-a.1-4.1){.pilcrow}]{#section-a.1-4.1}
:::
:::

::: {#potential-decreases-in-dns-privacy}
::: {#section-a.2 .section}
## [A.2.](#section-a.2){.section-number .selfRef} [Potential Decreases in DNS Privacy](#name-potential-decreases-in-dns-){.section-name .selfRef} {#name-potential-decreases-in-dns-}

These documents relate to functionality that could provide increased
tracking of user activity as a side effect:[¶](#section-a.2-1){.pilcrow}

-   [\"Client Subnet in DNS Queries\"
    \[[RFC7871](#RFC7871){.xref}\].[¶](#section-a.2-2.1){.pilcrow}]{#section-a.2-2.1}
-   [\"Domain Name System (DNS) Cookies\"
    \[[RFC7873](#RFC7873){.xref}\]).[¶](#section-a.2-2.2){.pilcrow}]{#section-a.2-2.2}
-   [\"Transport Layer Security (TLS) Session Resumption without
    Server-Side State\" \[[RFC5077](#RFC5077){.xref}\], referred to here
    as simply TLS session
    resumption.[¶](#section-a.2-2.3){.pilcrow}]{#section-a.2-2.3}
-   [\[[RFC8446](#RFC8446){.xref}\], [Appendix
    C.4](https://www.rfc-editor.org/rfc/rfc8446#appendix-C.4){.relref}
    describes client tracking prevention in TLS
    1.3[¶](#section-a.2-2.4){.pilcrow}]{#section-a.2-2.4}
-   [\"Compacted-DNS (C-DNS): A Format for DNS Packet Capture\"
    \[[RFC8618](#RFC8618){.xref}\].[¶](#section-a.2-2.5){.pilcrow}]{#section-a.2-2.5}
-   [Passive DNS
    \[[RFC8499](#RFC8499){.xref}\].[¶](#section-a.2-2.6){.pilcrow}]{#section-a.2-2.6}
-   [[Section
    8](https://www.rfc-editor.org/rfc/rfc8484#section-8){.relref} of
    \[[RFC8484](#RFC8484){.xref}\] outlines the privacy considerations
    of DoH. Note that (while that document advises exposing the minimal
    set of data needed to achieve the desired feature set), depending on
    the specifics of a DoH implementation, there may be increased
    identification and tracking compared to other DNS
    transports.[¶](#section-a.2-2.7){.pilcrow}]{#section-a.2-2.7}
:::
:::

::: {#related-operational-documents}
::: {#section-a.3 .section}
## [A.3.](#section-a.3){.section-number .selfRef} [Related Operational Documents](#name-related-operational-documen){.section-name .selfRef} {#name-related-operational-documen}

-   [\"DNS Transport over TCP - Implementation Requirements\"
    \[[RFC7766](#RFC7766){.xref}\].[¶](#section-a.3-1.1){.pilcrow}]{#section-a.3-1.1}
-   [\"DNS Transport over TCP - Operational Requirements\"
    \[[DNS-OVER-TCP](#I-D.ietf-dnsop-dns-tcp-requirements){.xref}\].[¶](#section-a.3-1.2){.pilcrow}]{#section-a.3-1.2}
-   [\"The edns-tcp-keepalive EDNS0 Option\"
    \[[RFC7828](#RFC7828){.xref}\].[¶](#section-a.3-1.3){.pilcrow}]{#section-a.3-1.3}
-   [\"DNS Stateful Operations\"
    \[[RFC8490](#RFC8490){.xref}\].[¶](#section-a.3-1.4){.pilcrow}]{#section-a.3-1.4}
:::
:::
:::
:::

::: {#ip-address-techniques}
::: {#section-appendix.b .section}
## [Appendix B.](#section-appendix.b){.section-number .selfRef} [IP Address Techniques](#name-ip-address-techniques){.section-name .selfRef} {#name-ip-address-techniques}

The following table presents a high-level comparison of various
techniques employed or under development in 2019 and classifies them
according to categorization of technique and other properties. Both the
specific techniques and the categorizations are described in more detail
in the following sections. The list of techniques includes the main
techniques in current use but does not claim to be
comprehensive.[¶](#section-appendix.b-1){.pilcrow}

[]{#name-classification-of-technique}

  Categorization/Property     GA   d   TC   C   TS   i   B
  --------------------------- ---- --- ---- --- ---- --- ---
  Anonymization               X    X   X                 X
  Pseudonymization                          X   X    X   
  Format preserving           X    X   X    X   X    X   
  Prefix preserving                    X    X   X        
  Replacement                          X                 
  Filtering                   X                          
  Generalization                                         X
  Enumeration                      X                     
  Reordering/Shuffling                 X                 
  Random substitution                  X                 
  Cryptographic permutation                 X   X    X   
  IPv6 issues                                   X        
  CPU intensive                             X            
  Memory intensive                     X                 
  Security concerns                                  X   

  : [Table 1](#table-1){.selfRef}: [Classification of
  Techniques](#name-classification-of-technique){.selfRef}

Legend of techniques:[¶](#section-appendix.b-3){.pilcrow}

[]{.break}

GA
:   = Google Analytics[¶](#section-appendix.b-4.2){.pilcrow}
:   

d
:   = dnswasher[¶](#section-appendix.b-4.4){.pilcrow}
:   

TC
:   = TCPdpriv[¶](#section-appendix.b-4.6){.pilcrow}
:   

C
:   = CryptoPAn[¶](#section-appendix.b-4.8){.pilcrow}
:   

TS
:   = TSA[¶](#section-appendix.b-4.10){.pilcrow}
:   

i
:   = ipcipher[¶](#section-appendix.b-4.12){.pilcrow}
:   

B
:   = Bloom filter[¶](#section-appendix.b-4.14){.pilcrow}
:   

The choice of which method to use for a particular application will
depend on the requirements of that application and consideration of the
threat analysis of the particular
situation.[¶](#section-appendix.b-5){.pilcrow}

For example, a common goal is that distributed packet captures must be
in an existing data format, such as PCAP \[[pcap](#pcap){.xref}\] or
Compacted-DNS (C-DNS) \[[RFC8618](#RFC8618){.xref}\], that can be used
as input to existing analysis tools. In that case, use of a
format-preserving technique is essential. This, though, is not cost
free; several authors (e.g.,
\[[Brekne-and-Arnes](#Brekne-and-Arnes){.xref}\]) have observed that, as
the entropy in an IPv4 address is limited, if an attacker
can[¶](#section-appendix.b-6){.pilcrow}

-   [ensure packets are captured by the target
    and[¶](#section-appendix.b-7.1){.pilcrow}]{#section-appendix.b-7.1}
-   [send forged traffic with arbitrary source and destination addresses
    to that target
    and[¶](#section-appendix.b-7.2){.pilcrow}]{#section-appendix.b-7.2}
-   [obtain a de-identified log of said traffic from that
    target,[¶](#section-appendix.b-7.3){.pilcrow}]{#section-appendix.b-7.3}

any format-preserving pseudonymization is vulnerable to an attack along
the lines of a cryptographic chosen-plaintext
attack.[¶](#section-appendix.b-8){.pilcrow}

::: {#categorization-of-techniques}
::: {#section-b.1 .section}
## [B.1.](#section-b.1){.section-number .selfRef} [Categorization of Techniques](#name-categorization-of-technique){.section-name .selfRef} {#name-categorization-of-technique}

Data minimization methods may be categorized by the processing used and
the properties of their outputs. The following builds on the
categorization employed in
\[[RFC6235](#RFC6235){.xref}\]:[¶](#section-b.1-1){.pilcrow}

[]{.break}

Format-preserving.
:   Normally, when encrypting, the original data length and patterns in
    the data should be hidden from an attacker. Some applications of
    de-identification, such as network capture de-identification,
    require that the de-identified data is of the same form as the
    original data, to allow the data to be parsed in the same way as the
    original.[¶](#section-b.1-2.2){.pilcrow}
:   

Prefix preservation.
:   Values such as IP addresses and MAC addresses contain prefix
    information that can be valuable in analysis \-- e.g., manufacturer
    ID in MAC addresses, or subnet in IP addresses. Prefix preservation
    ensures that prefixes are de-identified consistently; for example,
    if two IP addresses are from the same subnet, a prefix preserving
    de-identification will ensure that their de-identified counterparts
    will also share a subnet. Prefix preservation may be fixed (i.e.,
    based on a user-selected prefix length identified in advance to be
    preserved ) or general.[¶](#section-b.1-2.4){.pilcrow}
:   

Replacement.
:   A one-to-one replacement of a field to a new value of the same type
    \-- for example, using a regular
    expression.[¶](#section-b.1-2.6){.pilcrow}
:   

Filtering.
:   Removing or replacing data in a field. Field data can be
    overwritten, often with zeros, either partially (truncation or
    reverse truncation) or completely (black-marker
    anonymization).[¶](#section-b.1-2.8){.pilcrow}
:   

Generalization.
:   Data is replaced by more general data with reduced specificity. One
    example would be to replace all TCP/UDP port numbers with one of two
    fixed values indicating whether the original port was ephemeral
    (>=1024) or nonephemeral (>1024). Another example, precision
    degradation, reduces the accuracy of, for example, a numeric value
    or a timestamp.[¶](#section-b.1-2.10){.pilcrow}
:   

Enumeration.
:   With data from a well-ordered set, replace the first data item\'s
    data using a random initial value and then allocate ordered values
    for subsequent data items. When used with timestamp data, this
    preserves ordering but loses precision and
    distance.[¶](#section-b.1-2.12){.pilcrow}
:   

Reordering/shuffling.
:   Preserving the original data, but rearranging its order, often in a
    random manner.[¶](#section-b.1-2.14){.pilcrow}
:   

Random substitution.
:   As replacement, but using randomly generated replacement
    values.[¶](#section-b.1-2.16){.pilcrow}
:   

Cryptographic permutation.
:   Using a permutation function, such as a hash function or
    cryptographic block cipher, to generate a replacement de-identified
    value.[¶](#section-b.1-2.18){.pilcrow}
:   
:::
:::

::: {#specific-techniques}
::: {#section-b.2 .section}
## [B.2.](#section-b.2){.section-number .selfRef} [Specific Techniques](#name-specific-techniques){.section-name .selfRef} {#name-specific-techniques}

::: {#google-analytics-nonprefix-filtering}
::: {#section-b.2.1 .section}
### [B.2.1.](#section-b.2.1){.section-number .selfRef} [Google Analytics Non-Prefix Filtering](#name-google-analytics-non-prefix){.section-name .selfRef} {#name-google-analytics-non-prefix}

Since May 2010, Google Analytics has provided a facility
\[[IP-Anonymization-in-Analytics](#IP-Anonymization-in-Analytics){.xref}\]
that allows website owners to request that all their users\' IP
addresses are anonymized within Google Analytics processing. This very
basic anonymization simply sets to zero the least significant 8 bits of
IPv4 addresses, and the least significant 80 bits of IPv6 addresses. The
level of anonymization this produces is perhaps questionable. There are
some analysis results
\[[Geolocation-Impact-Assessment](#Geolocation-Impact-Assessment){.xref}\]
that suggest that the impact of this on reducing the accuracy of
determining the user\'s location from their IP address is less than
might be hoped; the average discrepancy in identification of the user
city for UK users is no more than 17%.[¶](#section-b.2.1-1){.pilcrow}

[]{.break}

Anonymization:
:   Format-preserving, Filtering
    (truncation).[¶](#section-b.2.1-2.2){.pilcrow}
:   
:::
:::

::: {#dnswasher}
::: {#section-b.2.2 .section}
### [B.2.2.](#section-b.2.2){.section-number .selfRef} [dnswasher](#name-dnswasher){.section-name .selfRef} {#name-dnswasher}

Since 2006, PowerDNS has included a de-identification tool, dnswasher
\[[PowerDNS-dnswasher](#PowerDNS-dnswasher){.xref}\], with their
PowerDNS product. This is a PCAP filter that performs a one-to-one
mapping of end-user IP addresses with an anonymized address. A table of
user IP addresses and their de-identified counterparts is kept; the
first IPv4 user addresses is translated to 0.0.0.1, the second to
0.0.0.2, and so on. The de-identified address therefore depends on the
order that addresses arrive in the input, and when running over a large
amount of data, the address translation tables can grow to a significant
size.[¶](#section-b.2.2-1){.pilcrow}

[]{.break}

Anonymization:
:   Format-preserving, Enumeration.[¶](#section-b.2.2-2.2){.pilcrow}
:   
:::
:::

::: {#prefixpreserving-map}
::: {#section-b.2.3 .section}
### [B.2.3.](#section-b.2.3){.section-number .selfRef} [Prefix-Preserving Map](#name-prefix-preserving-map){.section-name .selfRef} {#name-prefix-preserving-map}

Used in \[[tcpdpriv](#tcpdpriv){.xref}\], this algorithm stores a set of
original and anonymized IP address pairs. When a new IP address arrives,
it is compared with previous addresses to determine the longest prefix
match. The new address is anonymized by using the same prefix, with the
remainder of the address anonymized with a random value. The use of a
random value means that TCPdpriv is not deterministic; different
anonymized values will be generated on each run. The need to store
previous addresses means that TCPdpriv has significant and unbounded
memory requirements. The need to allocate anonymized addresses
sequentially means that TCPdpriv cannot be used in parallel
processing.[¶](#section-b.2.3-1){.pilcrow}

[]{.break}

Anonymization:
:   Format-preserving, prefix preservation
    (general).[¶](#section-b.2.3-2.2){.pilcrow}
:   
:::
:::

::: {#cryptographic-prefixpreserving-pseudonymization}
::: {#section-b.2.4 .section}
### [B.2.4.](#section-b.2.4){.section-number .selfRef} [Cryptographic Prefix-Preserving Pseudonymization](#name-cryptographic-prefix-preser){.section-name .selfRef} {#name-cryptographic-prefix-preser}

Cryptographic prefix-preserving pseudonymization was originally proposed
as an improvement to the prefix-preserving map implemented in TCPdpriv,
described in \[[Xu-et-al](#Xu-et-al){.xref}\] and implemented in the
\[[Crypto-PAn](#Crypto-PAn){.xref}\] tool. Crypto-PAn is now frequently
used as an acronym for the algorithm. Initially, it was described for
IPv4 addresses only; extension for IPv6 addresses was proposed in
\[[Harvan](#Harvan){.xref}\]. This uses a cryptographic algorithm rather
than a random value, and thus pseudonymity is determined uniquely by the
encryption key, and is deterministic. It requires a separate AES
encryption for each output bit and so has a nontrivial calculation
overhead. This can be mitigated to some extent (for IPv4, at least) by
precalculating results for some number of prefix
bits.[¶](#section-b.2.4-1){.pilcrow}

[]{.break}

Pseudonymization:
:   Format-preserving, prefix preservation
    (general).[¶](#section-b.2.4-2.2){.pilcrow}
:   
:::
:::

::: {#tophash-subtreereplicated-anonymization}
::: {#section-b.2.5 .section}
### [B.2.5.](#section-b.2.5){.section-number .selfRef} [Top-Hash Subtree-Replicated Anonymization](#name-top-hash-subtree-replicated){.section-name .selfRef} {#name-top-hash-subtree-replicated}

Proposed in \[[Ramaswamy-and-Wolf](#Ramaswamy-and-Wolf){.xref}\],
Top-hash Subtree-replicated Anonymization (TSA) originated in response
to the requirement for faster processing than Crypto-PAn. It used
hashing for the most significant byte of an IPv4 address and a
precalculated binary-tree structure for the remainder of the address. To
save memory space, replication is used within the tree structure,
reducing the size of the precalculated structures to a few megabytes for
IPv4 addresses. Address pseudonymization is done via hash and table
lookup and so requires minimal computation. However, due to the
much-increased address space for IPv6, TSA is not memory efficient for
IPv6.[¶](#section-b.2.5-1){.pilcrow}

[]{.break}

Pseudonymization:
:   Format-preserving, prefix preservation
    (general).[¶](#section-b.2.5-2.2){.pilcrow}
:   
:::
:::

::: {#ipcipher}
::: {#section-b.2.6 .section}
### [B.2.6.](#section-b.2.6){.section-number .selfRef} [ipcipher](#name-ipcipher){.section-name .selfRef} {#name-ipcipher}

A recently released proposal from PowerDNS, ipcipher
\[[ipcipher1](#ipcipher1){.xref}\] \[[ipcipher2](#ipcipher2){.xref}\],
is a simple pseudonymization technique for IPv4 and IPv6 addresses. IPv6
addresses are encrypted directly with AES-128 using a key (which may be
derived from a passphrase). IPv4 addresses are similarly encrypted, but
using a recently proposed encryption \[[ipcrypt](#ipcrypt){.xref}\]
suitable for 32-bit block lengths. However, the author of ipcrypt has
since indicated \[[ipcrypt-analysis](#ipcrypt-analysis){.xref}\] that it
has low security, and further analysis has revealed it is vulnerable to
attack.[¶](#section-b.2.6-1){.pilcrow}

[]{.break}

Pseudonymization:
:   Format-preserving, cryptographic
    permutation.[¶](#section-b.2.6-2.2){.pilcrow}
:   
:::
:::

::: {#bloom-filters}
::: {#section-b.2.7 .section}
### [B.2.7.](#section-b.2.7){.section-number .selfRef} [Bloom Filters](#name-bloom-filters){.section-name .selfRef} {#name-bloom-filters}

van Rijswijk-Deij et al. have recently described work using Bloom
Filters \[[Bloom-filter](#Bloom-filter){.xref}\] to categorize query
traffic and record the traffic as the state of multiple filters. The
goal of this work is to allow operators to identify so-called Indicators
of Compromise (IOCs) originating from specific subnets without storing
information about, or being able to monitor, the DNS queries of an
individual user. By using a Bloom Filter, it is possible to determine
with a high probability if, for example, a particular query was made,
but the set of queries made cannot be recovered from the filter.
Similarly, by mixing queries from a sufficient number of users in a
single filter, it becomes practically impossible to determine if a
particular user performed a particular query. Large numbers of queries
can be tracked in a memory-efficient way. As filter status is stored,
this approach cannot be used to regenerate traffic and so cannot be used
with tools used to process live traffic.[¶](#section-b.2.7-1){.pilcrow}

[]{.break}

Anonymized:
:   Generalization.[¶](#section-b.2.7-2.2){.pilcrow}
:   
:::
:::
:::
:::
:::
:::

::: {#current-policy-and-privacy-statements}
::: {#section-appendix.c .section}
## [Appendix C.](#section-appendix.c){.section-number .selfRef} [Current Policy and Privacy Statements](#name-current-policy-and-privacy-){.section-name .selfRef} {#name-current-policy-and-privacy-}

A tabular comparison of policy and privacy statements from various DNS
privacy service operators based loosely on the proposed RPS structure
can be found at \[[policy-comparison](#policy-comparison){.xref}\]. The
analysis is based on the data available in December
2019.[¶](#section-appendix.c-1){.pilcrow}

We note that the existing policies vary widely in style, content, and
detail, and it is not uncommon for the full text for a given operator to
equate to more than 10 pages (A4 size) of text in a moderate-sized font.
It is a nontrivial task today for a user to extract a meaningful
overview of the different services on
offer.[¶](#section-appendix.c-2){.pilcrow}

It is also noted that Mozilla has published a DoH resolver policy
\[[DoH-resolver-policy](#DoH-resolver-policy){.xref}\] that describes
the minimum set of policy requirements that a party must satisfy to be
considered as a potential partner for Mozilla\'s Trusted Recursive
Resolver (TRR) program.[¶](#section-appendix.c-3){.pilcrow}
:::
:::

::: {#example-rps}
::: {#section-appendix.d .section}
## [Appendix D.](#section-appendix.d){.section-number .selfRef} [Example RPS](#name-example-rps){.section-name .selfRef} {#name-example-rps}

The following example RPS is very loosely based on some elements of
published privacy statements for some public resolvers, with additional
fields populated to illustrate what the full contents of an RPS might
look like. This should not be interpreted
as[¶](#section-appendix.d-1){.pilcrow}

-   [having been reviewed or approved by any operator in any
    way[¶](#section-appendix.d-2.1){.pilcrow}]{#section-appendix.d-2.1}
-   [having any legal standing or validity at
    all[¶](#section-appendix.d-2.2){.pilcrow}]{#section-appendix.d-2.2}
-   [being complete or
    exhaustive[¶](#section-appendix.d-2.3){.pilcrow}]{#section-appendix.d-2.3}

This is a purely hypothetical example of an RPS to outline example
contents \-- in this case, for a public resolver operator providing a
basic DNS Privacy service via one IP address and one DoH URI with
security-based filtering. It does aim to meet minimal compliance as
specified in [Section
5](#recommendations-for-dns-privacy-services){.xref}.[¶](#section-appendix.d-3){.pilcrow}

::: {#policy-1}
::: {#section-d.1 .section}
## [D.1.](#section-d.1){.section-number .selfRef} [Policy](#name-policy-2){.section-name .selfRef} {#name-policy-2}

1.  [Treatment of IP addresses. Many nations classify IP addresses as
    personal data, and we take a conservative approach in treating IP
    addresses as personal data in all jurisdictions in which our systems
    reside.[¶](#section-d.1-1.1){.pilcrow}]{#section-d.1-1.1}

2.  ::: {#section-d.1-1.2}
    Data collection and sharing.[¶](#section-d.1-1.2.1){.pilcrow}

    a.  [IP addresses. Our normal course of data management does not
        have any IP address information or other personal data logged to
        disk or transmitted out of the location in which the query was
        received. We may aggregate certain counters to larger network
        block levels for statistical collection purposes, but those
        counters do not maintain specific IP address data, nor is the
        format or model of data stored capable of being
        reverse-engineered to ascertain what specific IP addresses made
        what
        queries.[¶](#section-d.1-1.2.2.1){.pilcrow}]{#section-d.1-1.2.2.1}

    b.  ::: {#section-d.1-1.2.2.2}
        Data collected in logs. We do keep some generalized location
        information (at the city / metropolitan-area level) so that we
        can conduct debugging and analyze abuse phenomena. We also use
        the collected information for the creation and sharing of
        telemetry (timestamp, geolocation, number of hits, first seen,
        last seen) for contributors, public publishing of general
        statistics of system use (protections, threat types, counts,
        etc.). When you use our DNS services, here is the full list of
        items that are included in our
        logs:[¶](#section-d.1-1.2.2.2.1){.pilcrow}

        -   [Requested domain name \-- e.g.,
            example.net[¶](#section-d.1-1.2.2.2.2.1){.pilcrow}]{#section-d.1-1.2.2.2.2.1}

        -   [Record type of requested domain \-- e.g., A, AAAA, NS, MX,
            TXT,
            etc.[¶](#section-d.1-1.2.2.2.2.2){.pilcrow}]{#section-d.1-1.2.2.2.2.2}

        -   ::: {#section-d.1-1.2.2.2.2.3}
            Transport protocol on which the request arrived \-- i.e.,
            UDP, TCP, DoT, DoH[¶](#section-d.1-1.2.2.2.2.3.1){.pilcrow}
            :::

        -   [Origin IP general geolocation information \-- i.e.,
            geocode, region ID, city ID, and metro
            code[¶](#section-d.1-1.2.2.2.2.4){.pilcrow}]{#section-d.1-1.2.2.2.2.4}

        -   [IP protocol version \-- IPv4 or
            IPv6[¶](#section-d.1-1.2.2.2.2.5){.pilcrow}]{#section-d.1-1.2.2.2.2.5}

        -   [Response code sent \-- e.g., SUCCESS, SERVFAIL, NXDOMAIN,
            etc.[¶](#section-d.1-1.2.2.2.2.6){.pilcrow}]{#section-d.1-1.2.2.2.2.6}

        -   [Absolute arrival time using a precision in
            ms[¶](#section-d.1-1.2.2.2.2.7){.pilcrow}]{#section-d.1-1.2.2.2.2.7}

        -   [Name of the specific instance that processed this
            request[¶](#section-d.1-1.2.2.2.2.8){.pilcrow}]{#section-d.1-1.2.2.2.2.8}

        -   [IP address of the specific instance to which this request
            was addressed (no relation to the requestor\'s IP
            address)[¶](#section-d.1-1.2.2.2.2.9){.pilcrow}]{#section-d.1-1.2.2.2.2.9}

        We may keep the following data as summary information, including
        all the above EXCEPT for data about the DNS record
        requested:[¶](#section-d.1-1.2.2.2.3){.pilcrow}

        -   [Currently advertised BGP-summarized IP prefix/netmask of
            apparent client
            origin[¶](#section-d.1-1.2.2.2.4.1){.pilcrow}]{#section-d.1-1.2.2.2.4.1}
        -   [Autonomous system number (BGP ASN) of apparent client
            origin[¶](#section-d.1-1.2.2.2.4.2){.pilcrow}]{#section-d.1-1.2.2.2.4.2}

        All the above data may be kept in full or partial form in
        permanent archives.[¶](#section-d.1-1.2.2.2.5){.pilcrow}
        :::

    c.  [Sharing of data. Except as described in this document, we do
        not intentionally share, sell, or rent individual personal
        information associated with the requestor (i.e., source IP
        address or any other information that can positively identify
        the client using our infrastructure) with anyone without your
        consent. We generate and share high-level anonymized aggregate
        statistics, including threat metrics on threat type,
        geolocation, and if available, sector, as well as other vertical
        metrics, including performance metrics on our DNS Services
        (i.e., number of threats blocked, infrastructure uptime) when
        available with our Threat Intelligence (TI) partners, academic
        researchers, or the public. Our DNS services share anonymized
        data on specific domains queried (records such as domain,
        timestamp, geolocation, number of hits, first seen, last seen)
        with our Threat Intelligence partners. Our DNS service also
        builds, stores, and may share certain DNS data streams which
        store high level information about domain resolved, query types,
        result codes, and timestamp. These streams do not contain the IP
        address information of the requestor and cannot be correlated to
        IP address or other personal data. We do not and never will
        share any of the requestor\'s data with marketers, nor will we
        use this data for demographic
        analysis.[¶](#section-d.1-1.2.2.3){.pilcrow}]{#section-d.1-1.2.2.3}
    :::

3.  [Exceptions. There are exceptions to this storage model: In the
    event of actions or observed behaviors that we deem malicious or
    anomalous, we may utilize more detailed logging to collect more
    specific IP address data in the process of normal network defense
    and mitigation. This collection and transmission off-site will be
    limited to IP addresses that we determine are involved in the
    event.[¶](#section-d.1-1.3){.pilcrow}]{#section-d.1-1.3}

4.  [Associated entities. Details of our Threat Intelligence partners
    can be found at our website page (insert
    link).[¶](#section-d.1-1.4){.pilcrow}]{#section-d.1-1.4}

5.  [Correlation of Data. We do not correlate or combine information
    from our logs with any personal information that you have provided
    us for other services, or with your specific IP
    address.[¶](#section-d.1-1.5){.pilcrow}]{#section-d.1-1.5}

6.  ::: {#section-d.1-1.6}
    Result filtering.[¶](#section-d.1-1.6.1){.pilcrow}

    a.  ::: {#section-d.1-1.6.2.1}
        Filtering. We utilize cyber-threat intelligence about malicious
        domains from a variety of public and private sources and block
        access to those malicious domains when your system attempts to
        contact them. An NXDOMAIN is returned for blocked
        sites.[¶](#section-d.1-1.6.2.1.1){.pilcrow}

        i.  [Censorship. We will not provide a censoring component and
            will limit our actions solely to the blocking of malicious
            domains around phishing, malware, and exploit-kit
            domains.[¶](#section-d.1-1.6.2.1.2.1){.pilcrow}]{#section-d.1-1.6.2.1.2.1}
        ii. [Accidental blocking. We implement allowlisting algorithms
            to make sure legitimate domains are not blocked by accident.
            However, in the rare case of blocking a legitimate domain,
            we work with the users to quickly allowlist that domain.
            Please use our support form (insert link) if you believe we
            are blocking a domain in
            error.[¶](#section-d.1-1.6.2.1.2.2){.pilcrow}]{#section-d.1-1.6.2.1.2.2}
        :::
    :::
:::
:::

::: {#practice-1}
::: {#section-d.2 .section}
## [D.2.](#section-d.2){.section-number .selfRef} [Practice](#name-practice-2){.section-name .selfRef} {#name-practice-2}

1.  [Deviations from Policy. None in place since (insert
    date).[¶](#section-d.2-1.1){.pilcrow}]{#section-d.2-1.1}

2.  ::: {#section-d.2-1.2}
    Client-facing capabilities.[¶](#section-d.2-1.2.1){.pilcrow}

    a.  [We offer UDP and TCP DNS on port 53 on (insert IP
        address)[¶](#section-d.2-1.2.2.1){.pilcrow}]{#section-d.2-1.2.2.1}

    b.  ::: {#section-d.2-1.2.2.2}
        We offer DNS over TLS as specified in RFC 7858 on (insert IP
        address). It is available on port 853 and port 443. We also
        implement RFC 7766.[¶](#section-d.2-1.2.2.2.1){.pilcrow}

        i.  [The DoT authentication domain name used is (insert domain
            name).[¶](#section-d.2-1.2.2.2.2.1){.pilcrow}]{#section-d.2-1.2.2.2.2.1}
        ii. [We do not publish SPKI pin
            sets.[¶](#section-d.2-1.2.2.2.2.2){.pilcrow}]{#section-d.2-1.2.2.2.2.2}
        :::

    c.  [We offer DNS over HTTPS as specified in RFC 8484 on (insert URI
        template).[¶](#section-d.2-1.2.2.3){.pilcrow}]{#section-d.2-1.2.2.3}

    d.  [Both services offer TLS 1.2 and TLS
        1.3.[¶](#section-d.2-1.2.2.4){.pilcrow}]{#section-d.2-1.2.2.4}

    e.  [Both services pad DNS responses according to RFC
        8467.[¶](#section-d.2-1.2.2.5){.pilcrow}]{#section-d.2-1.2.2.5}

    f.  ::: {#section-d.2-1.2.2.6}
        Both services provide DNSSEC
        validation.[¶](#section-d.2-1.2.2.6.1){.pilcrow}
        :::
    :::

3.  ::: {#section-d.2-1.3}
    Upstream capabilities.[¶](#section-d.2-1.3.1){.pilcrow}

    a.  [Our servers implement QNAME
        minimization.[¶](#section-d.2-1.3.2.1){.pilcrow}]{#section-d.2-1.3.2.1}
    b.  [Our servers do not send ECS
        upstream.[¶](#section-d.2-1.3.2.2){.pilcrow}]{#section-d.2-1.3.2.2}
    :::

4.  [Support. Support information for this service is available at
    (insert link).[¶](#section-d.2-1.4){.pilcrow}]{#section-d.2-1.4}

5.  [Data Processing. We operate as the legal entity (insert entity)
    registered in (insert country); as such, we operate under (insert
    country/region) law. Our separate statement regarding the specifics
    of our data processing policy, practice, and agreements can be found
    here (insert
    link).[¶](#section-d.2-1.5){.pilcrow}]{#section-d.2-1.5}
:::
:::
:::
:::

::: {#acknowledgements}
::: {#section-appendix.e .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Many thanks to [Amelia Andersdotter]{.contact-name} for a very thorough
review of the first draft of this document and [Stephen
Farrell]{.contact-name} for a thorough review at Working Group Last Call
and for suggesting the inclusion of an example RPS. Thanks to [John
Todd]{.contact-name} for discussions on this topic, and to [Stéphane
Bortzmeyer]{.contact-name}, [Puneet Sood]{.contact-name}, and [Vittorio
Bertola]{.contact-name} for review. Thanks to [Daniel Kahn
Gillmor]{.contact-name}, [Barry Green]{.contact-name}, [Paul
Hoffman]{.contact-name}, [Dan York]{.contact-name}, [Jon
Reed]{.contact-name}, and [Lorenzo Colitti]{.contact-name} for comments
at the mic. Thanks to [Loganaden Velvindron]{.contact-name} for useful
updates to the text.[¶](#section-appendix.e-1){.pilcrow}

[Sara Dickinson]{.contact-name} thanks the Open Technology Fund for a
grant to support the work on this
document.[¶](#section-appendix.e-2){.pilcrow}
:::
:::

::: {#contributors}
::: {#section-appendix.f .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The below individuals contributed significantly to the
document:[¶](#section-appendix.f-1){.pilcrow}

::: {.left dir="auto"}
[John Dickinson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Sinodun IT]{.org}
:::

::: {.left dir="auto"}
[Magdalen Centre]{.extended-address}
:::

::: {.left dir="auto"}
[Oxford Science Park]{.street-address}
:::

::: {.left dir="auto"}
[Oxford]{.locality}
:::

::: {.left dir="auto"}
[OX4 4GA]{.postal-code}
:::

::: {.left dir="auto"}
[United Kingdom]{.country-name}
:::

::: {.left dir="auto"}
[Jim Hague]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Sinodun IT]{.org}
:::

::: {.left dir="auto"}
[Magdalen Centre]{.extended-address}
:::

::: {.left dir="auto"}
[Oxford Science Park]{.street-address}
:::

::: {.left dir="auto"}
[Oxford]{.locality}
:::

::: {.left dir="auto"}
[OX4 4GA]{.postal-code}
:::

::: {.left dir="auto"}
[United Kingdom]{.country-name}
:::
:::
:::

::: {#authors-addresses}
::: {#section-appendix.g .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Sara Dickinson]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Sinodun IT]{.org}
:::

::: {.left dir="auto"}
[Magdalen Centre]{.extended-address}
:::

::: {.left dir="auto"}
[Oxford Science Park]{.street-address}
:::

::: {.left dir="auto"}
[Oxford]{.locality}
:::

::: {.left dir="auto"}
[OX4 4GA]{.postal-code}
:::

::: {.left dir="auto"}
[United Kingdom]{.country-name}
:::

::: email
Email: <sara@sinodun.com>
:::

::: {.left dir="auto"}
[Benno J. Overeinder]{.fn .nameRole}
:::

::: {.left dir="auto"}
[NLnet Labs]{.org}
:::

::: {.left dir="auto"}
[Science Park 400]{.street-address}
:::

::: {.left dir="auto"}
[1098 XH]{.postal-code} [Amsterdam]{.locality}
:::

::: {.left dir="auto"}
[Netherlands]{.country-name}
:::

::: email
Email: <benno@nlnetLabs.nl>
:::

::: {.left dir="auto"}
[Roland M. van Rijswijk-Deij]{.fn .nameRole}
:::

::: {.left dir="auto"}
[NLnet Labs]{.org}
:::

::: {.left dir="auto"}
[Science Park 400]{.street-address}
:::

::: {.left dir="auto"}
[1098 XH]{.postal-code} [Amsterdam]{.locality}
:::

::: {.left dir="auto"}
[Netherlands]{.country-name}
:::

::: email
Email: <roland@nlnetLabs.nl>
:::

::: {.left dir="auto"}
[Allison Mankin]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Salesforce.com, Inc.]{.org}
:::

::: {.left dir="auto"}
[Salesforce Tower\
415 Mission Street, 3rd Floor]{.street-address}
:::

::: {.left dir="auto"}
[San Francisco]{.locality}, [CA]{.region} [94105]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <allison.mankin@gmail.com>
:::
:::
:::
