  RFC 8864        SDP-Based Data Channel Negotiation   January 2021
  --------------- ------------------------------------ --------------
  Drage, et al.   Standards Track                      \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8864](https://www.rfc-editor.org/rfc/rfc8864){.eref}

Category:
:   Standards Track

Published:
:   January 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    K. Drage
    :::

    ::: org
    Unaffiliated
    :::
    :::

    ::: author
    ::: author-name
    M. Makaraju
    :::

    ::: org
    Unaffiliated
    :::
    :::

    ::: author
    ::: author-name
    R. Ejzak
    :::

    ::: org
    Unaffiliated
    :::
    :::

    ::: author
    ::: author-name
    J. Marcon
    :::

    ::: org
    Unaffiliated
    :::
    :::

    ::: author
    ::: author-name
    R. Even, [Ed.]{.editor}
    :::
    :::
:::

# RFC 8864 {#rfcnum}

# Negotiation Data Channels Using the Session Description Protocol (SDP) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

Data channel setup can be done using either the in-band Data Channel
Establishment Protocol (DCEP) or some out-of-band non-DCEP protocol.
This document specifies how the SDP (Session Description Protocol)
offer/answer exchange can be used to achieve an out-of-band non-DCEP
negotiation for establishing a data
channel.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8864>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions](#name-conventions){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Applicability
    Statement](#name-applicability-statement){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [SDP Data Channel
    Attributes](#name-sdp-data-channel-attributes){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [SDP DCMAP
        Attribute](#name-sdp-dcmap-attribute){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.1.2.1}
            [5.1.1](#section-5.1.1){.xref}.  [DCMAP Attribute
            Syntax](#name-dcmap-attribute-syntax){.xref}[¶](#section-toc.1-1.5.2.1.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.2}
            [5.1.2](#section-5.1.2){.xref}.  [\'dcmap-stream-id\'
            Parameter](#name-dcmap-stream-id-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.3}
            [5.1.3](#section-5.1.3){.xref}.  [\'label\'
            Parameter](#name-label-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.4}
            [5.1.4](#section-5.1.4){.xref}.  [\'subprotocol\'
            Parameter](#name-subprotocol-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.5}
            [5.1.5](#section-5.1.5){.xref}.  [\'max-retr\'
            Parameter](#name-max-retr-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.5.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.6}
            [5.1.6](#section-5.1.6){.xref}.  [\'max-time\'
            Parameter](#name-max-time-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.6.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.7}
            [5.1.7](#section-5.1.7){.xref}.  [\'ordered\'
            Parameter](#name-ordered-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.7.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.8}
            [5.1.8](#section-5.1.8){.xref}.  [\'priority\'
            Parameter](#name-priority-parameter){.xref}[¶](#section-toc.1-1.5.2.1.2.8.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.1.2.9}
            [5.1.9](#section-5.1.9){.xref}.  [DCMAP Multiplexing
            Category](#name-dcmap-multiplexing-category){.xref}[¶](#section-toc.1-1.5.2.1.2.9.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [SDP DCSA
        Attribute](#name-sdp-dcsa-attribute){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.2.2.1}
            [5.2.1](#section-5.2.1){.xref}.  [DCSA Attribute
            Syntax](#name-dcsa-attribute-syntax){.xref}[¶](#section-toc.1-1.5.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.2.2.2}
            [5.2.2](#section-5.2.2){.xref}.  [DCSA Multiplexing
            Category](#name-dcsa-multiplexing-category){.xref}[¶](#section-toc.1-1.5.2.2.2.2.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [SDP Offer/Answer
    Procedures](#name-sdp-offer-answer-procedures){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Managing Stream
        Identifiers](#name-managing-stream-identifiers){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Negotiating Data Channel
        Parameters](#name-negotiating-data-channel-pa){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Generating the Initial Offer for a
        Data
        Channel](#name-generating-the-initial-offe){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [Generating the SDP
        Answer](#name-generating-the-sdp-answer){.xref}[¶](#section-toc.1-1.6.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [Offerer Processing of the SDP
        Answer](#name-offerer-processing-of-the-s){.xref}[¶](#section-toc.1-1.6.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.6}
        [6.6](#section-6.6){.xref}.  [Modifying the
        Session](#name-modifying-the-session){.xref}[¶](#section-toc.1-1.6.2.6.1){.pilcrow}

        -   ::: {#section-toc.1-1.6.2.6.2.1}
            [6.6.1](#section-6.6.1){.xref}.  [Closing a Data
            Channel](#name-closing-a-data-channel){.xref}[¶](#section-toc.1-1.6.2.6.2.1.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.7}
        [6.7](#section-6.7){.xref}.  [Various SDP Offer/Answer
        Considerations](#name-various-sdp-offer-answer-co){.xref}[¶](#section-toc.1-1.6.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Examples](#name-examples){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Subprotocol
        Identifiers](#name-subprotocol-identifiers){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [New SDP
        Attributes](#name-new-sdp-attributes){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.9.2.2.2.1}
            [9.2.1](#section-9.2.1){.xref}.  [dcmap](#name-dcmap){.xref}[¶](#section-toc.1-1.9.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.2.2.2}
            [9.2.2](#section-9.2.2){.xref}.  [dcsa](#name-dcsa){.xref}[¶](#section-toc.1-1.9.2.2.2.2.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [9.3](#section-9.3){.xref}.  [Registering Attributes for Use
        with Data
        Channels](#name-registering-attributes-for-){.xref}[¶](#section-toc.1-1.9.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix A](#section-appendix.a){.xref}.  [Generic Data Channel
    Negotiation Aspects when Not Using
    DCEP](#name-generic-data-channel-negoti){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [A.1](#section-a.1){.xref}.  [Stream Identifier
        Numbering](#name-stream-identifier-numbering){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [A.2](#section-a.2){.xref}.  [Generic Data Channel Negotiation
        Not Using
        DCEP](#name-generic-data-channel-negotia){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.11.2.2.2.1}
            [A.2.1](#section-a.2.1){.xref}.  [Overview](#name-overview){.xref}[¶](#section-toc.1-1.11.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.2}
            [A.2.2](#section-a.2.2){.xref}.  [Opening a Data
            Channel](#name-opening-a-data-channel){.xref}[¶](#section-toc.1-1.11.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.11.2.2.2.3}
            [A.2.3](#section-a.2.3){.xref}.  [Closing a Data
            Channel](#name-closing-a-data-channel-2){.xref}[¶](#section-toc.1-1.11.2.2.2.3.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.b){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.c){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.d){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The concept of establishing a bidirectional data channel running on top
of the Stream Control Transmission Protocol (SCTP) is discussed in
\[[RFC8831](#RFC8831){.xref}\], allowing applications to use data
channels. An in-band Data Channel Establishment Protocol (DCEP) is
described in \[[RFC8832](#RFC8832){.xref}\]; however, other in-band or
out-of-band protocols may be used for establishing data channels. Each
data channel consists of paired SCTP streams sharing the same SCTP
Stream Identifier. Data channels are created by endpoint applications
using (1) the WebRTC API (Application Programming Interface)
\[[WebRtcAPI](#WebRtcAPI){.xref}\] or (2)  other protocols (e.g.,
Controlling Multiple Streams for Telepresence (CLUE)
\[[RFC8850](#RFC8850){.xref}\]). The protocols can be signaled by the
data channel \'subprotocol\' parameter, conceptually similar to a
WebSocket subprotocol as described in \[[RFC6455](#RFC6455){.xref}\].
However, apart from the \"subprotocol\" value transmitted to the peer,
an endpoint application can agree on how to instantiate a given
subprotocol on a data channel, and whether it is signaled in-band using
DCEP or out-of-band using a non-DCEP protocol (or
both).[¶](#section-1-1){.pilcrow}

This document defines Session Description Protocol (SDP) offer/answer
procedures \[[RFC3264](#RFC3264){.xref}\] that enable out-of-band
negotiation for establishing data channels for transport of well-defined
subprotocols. These procedures are based on generic SDP offer/answer
negotiation rules for SCTP-based media transport as specified in
\[[RFC8841](#RFC8841){.xref}\] for the SDP \"m=\" line proto values
UDP/DTLS/SCTP and TCP/DTLS/SCTP.[¶](#section-1-2){.pilcrow}

This document uses MSRP (the Message Session Relay Protocol)
\[[RFC4975](#RFC4975){.xref}\] and BFCP (the Binary Floor Control
Protocol) \[[RFC8855](#RFC8855){.xref}\] in several examples. It does
not provide a complete specification of how to negotiate the use of a
data channel to transport MSRP. Procedures specific to each subprotocol
would have to be documented elsewhere. For MSRP, they are documented in
\[[RFC8873](#RFC8873){.xref}\]. The use of MSRP in some examples is only
to show how the generic procedures described herein might apply to a
specific subprotocol.[¶](#section-1-3){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions](#name-conventions){.section-name .selfRef} {#name-conventions}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::

::: {#terminology}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

This document uses the following terms:[¶](#section-3-1){.pilcrow}

[]{.break}

Data channel:
:   A WebRTC data channel as specified in
    \[[RFC8831](#RFC8831){.xref}\].[¶](#section-3-2.2){.pilcrow}
:   

Data channel stack:
:   An entity that, upon application request, runs the data channel
    protocol to keep track of states as well as the sending and
    receiving of data. If the application is a browser-based JavaScript
    application, then this stack resides in the browser. If the
    application is a native application, then this stack resides in the
    application and is accessible via some sort of API or
    APIs.[¶](#section-3-2.4){.pilcrow}
:   

Data channel properties:
:   Fixed properties assigned to a data channel at the time of its
    creation. Some of these properties determine the way the data
    channel stack transmits data on this channel (e.g., stream
    identifier, reliability, order of
    delivery).[¶](#section-3-2.6){.pilcrow}
:   

Data channel subprotocol:
:   The application protocol that is transported over a single data
    channel. Data channel subprotocol messages are sent as data channel
    payload over an established data channel. An SDP offer/answer
    exchange can be used as specified in this document to negotiate the
    establishment of data channels, corresponding data channel
    properties, associated data channel subprotocols, and data channel
    subprotocol properties. In this case, the data channel subprotocols
    may be identified by the values of the \'subprotocol\' parameters of
    the SDP \"a=dcmap:\" attribute as described in [Section
    5.1.4](#subprotocol-parameter){.xref}. Within this document, the
    term \"data channel subprotocol\" is often abbreviated as just
    \"subprotocol\".[¶](#section-3-2.8){.pilcrow}
:   

DCEP:
:   Data Channel Establishment Protocol, as defined in
    \[[RFC8832](#RFC8832){.xref}\].[¶](#section-3-2.10){.pilcrow}
:   

In-band:
:   Transmission through the peer-to-peer SCTP
    association.[¶](#section-3-2.12){.pilcrow}
:   

Out-of-band:
:   Transmission through the application signaling
    path.[¶](#section-3-2.14){.pilcrow}
:   

Peer:
:   From the perspective of one of the agents in a session, its peer is
    the other agent. Specifically, from the perspective of the SDP
    offerer, the peer is the SDP answerer. From the perspective of the
    SDP answerer, the peer is the SDP
    offerer.[¶](#section-3-2.16){.pilcrow}
:   

SCTP Stream Sequence Number (SSN):
:   The SCTP Stream Sequence Number, as specified in
    \[[RFC4960](#RFC4960){.xref}\].[¶](#section-3-2.18){.pilcrow}
:   

Stream identifier:
:   The identifier of the outbound and inbound SCTP streams composing a
    data channel.[¶](#section-3-2.20){.pilcrow}
:   
:::
:::

::: {#appl_statement}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Applicability Statement](#name-applicability-statement){.section-name .selfRef} {#name-applicability-statement}

The mechanism described in this document only applies to SDP
\[[RFC8866](#RFC8866){.xref}\] when used together with the SDP
offer/answer mechanism \[[RFC3264](#RFC3264){.xref}\]. Declarative usage
of SDP is out of scope for this document and is thus
undefined.[¶](#section-4-1){.pilcrow}
:::
:::

::: {#sdp_synt}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [SDP Data Channel Attributes](#name-sdp-data-channel-attributes){.section-name .selfRef} {#name-sdp-data-channel-attributes}

This section defines two new SDP media-level attributes that can be used
together with the SDP Offer/Answer mechanism to negotiate
data-channel-specific and subprotocol-specific parameters without the
usage of DCEP \[[RFC8832](#RFC8832){.xref}\]. The first attribute
([Section 5.1](#subsec-sdp-attr-for-dc-par-neg){.xref}) provides for
negotiation of channel-specific parameters. The second attribute
([Section 5.2](#prot_att){.xref}) provides for negotiation of
subprotocol-specific parameters.[¶](#section-5-1){.pilcrow}

Note: [Appendix A](#generic-out-of-band-aspects){.xref} provides
information regarding how data channels work in general. In particular,
it summarizes some key aspects that should be considered for the
negotiation of data channels if DCEP is not
used.[¶](#section-5-2.1){.pilcrow}

::: {#subsec-sdp-attr-for-dc-par-neg}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [SDP DCMAP Attribute](#name-sdp-dcmap-attribute){.section-name .selfRef} {#name-sdp-dcmap-attribute}

This section defines a new media-level attribute, \"a=dcmap:\", that
defines the data channel parameters for each data channel to be
negotiated.[¶](#section-5.1-1){.pilcrow}

This attribute is used to create bidirectional SCTP data channels having
the same set of attributes. The data channel properties (reliable /
partially reliable, ordered/unordered) need to be suitable per the
subprotocol transport requirements.[¶](#section-5.1-2){.pilcrow}

::: {#dcmap-attr-definition}
::: {#section-5.1.1 .section}
#### [5.1.1.](#section-5.1.1){.section-number .selfRef} [DCMAP Attribute Syntax](#name-dcmap-attribute-syntax){.section-name .selfRef} {#name-dcmap-attribute-syntax}

\"a=dcmap:\" is a media-level attribute having the following definition
and ABNF (Augmented Backus-Naur Form) syntax
\[[RFC5234](#RFC5234){.xref}\].[¶](#section-5.1.1-1){.pilcrow}

[]{#name-adcmap-attribute-definition}

::: {#dcmap-attrib}
  \"a=dcmap:\" Attribute   
  ------------------------ -------------
  Name                     dcmap
  Value                    dcmap-value
  Usage Level              media
  Charset Dependent        No

  : [Table 1](#table-1){.selfRef}: [\"a=dcmap:\" Attribute
  Definition](#name-adcmap-attribute-definition){.selfRef}
:::

Formal syntax:[¶](#section-5.1.1-3){.pilcrow}

::: {#section-5.1.1-4}
``` {.sourcecode .lang-abnf}
dcmap-value     = dcmap-stream-id
                  [ SP dcmap-opt *(";" dcmap-opt) ]
dcmap-opt       = ordering-opt / subprotocol-opt / label-opt
                  / maxretr-opt / maxtime-opt / priority-opt
                  ; maxretr-opt and maxtime-opt are
                  ; mutually exclusive

dcmap-stream-id = 1*5DIGIT
ordering-opt    = "ordered=" ordering-value
ordering-value  = "true" / "false"
subprotocol-opt = "subprotocol=" quoted-string
label-opt       = "label=" quoted-string
maxretr-opt     = "max-retr=" maxretr-value
maxretr-value   = "0" / integer
                  ; number of retransmissions,
                  ; less than 2^32,
                  ; derived from 'Reliability Parameter' [RFC8832]
maxtime-opt     = "max-time=" maxtime-value
maxtime-value   = "0" / integer
                  ; milliseconds,
                  ; less than 2^32,
                  ; derived from 'Reliability Parameter' [RFC8832]
priority-opt    = "priority=" priority-value
priority-value  = "0" / integer
                  ; unsigned integer value indicating the priority of
                  ; the data channel,
                  ; less than 2^16,
                  ; derived from 'Priority' [RFC8832]

quoted-string   = DQUOTE *(quoted-char / escaped-char) DQUOTE
quoted-char     = SP / quoted-visible
quoted-visible  = %x21 / %x23-24 / %x26-7E ; VCHAR without " or %
escaped-char    = "%" HEXDIG HEXDIG
DQUOTE          = <from RFC 5234>
integer         = <from RFC 8866>
```

[¶](#section-5.1.1-4){.pilcrow}
:::

Examples:[¶](#section-5.1.1-5){.pilcrow}

::: {#section-5.1.1-6}
``` {.sourcecode .lang-sdp}
a=dcmap:0
a=dcmap:1 subprotocol="bfcp";max-time=60000;priority=512
a=dcmap:2 subprotocol="msrp";ordered=true;label="msrp"
a=dcmap:3 label="Label 1";ordered=false;max-retr=5;priority=128
a=dcmap:4 label="foo%09bar";ordered=true;max-time=15000
```

[¶](#section-5.1.1-6){.pilcrow}
:::

Note: The last example (a=dcmap:4) shows a \'label\' parameter value
that contains one nonprintable \'escaped-char\' character (the tabulator
character).[¶](#section-5.1.1-7.1){.pilcrow}

Within an \"a=dcmap:\" attribute line\'s \'dcmap-opt\' value, only one
\'maxretr-opt\' parameter or one \'maxtime-opt\' parameter may be
present. Both parameters [MUST NOT]{.bcp14} be
present.[¶](#section-5.1.1-8){.pilcrow}
:::
:::

::: {#dcmap-stream-id-param-definition}
::: {#section-5.1.2 .section}
#### [5.1.2.](#section-5.1.2){.section-number .selfRef} [\'dcmap-stream-id\' Parameter](#name-dcmap-stream-id-parameter){.section-name .selfRef} {#name-dcmap-stream-id-parameter}

The \'dcmap-stream-id\' parameter indicates the SCTP stream identifier
within the SCTP association used to form the data
channel.[¶](#section-5.1.2-1){.pilcrow}
:::
:::

::: {#section-5.1.3 .section}
#### [5.1.3.](#section-5.1.3){.section-number .selfRef} [\'label\' Parameter](#name-label-parameter){.section-name .selfRef} {#name-label-parameter}

The \'label\' parameter indicates the name of the channel. It represents
a label that can be used to distinguish, in the context of the WebRTC
API \[[WebRtcAPI](#WebRtcAPI){.xref}\], an RTCDataChannel object from
other RTCDataChannel objects. This parameter maps to the \'Label\'
parameter defined in \[[RFC8832](#RFC8832){.xref}\]. The \'label\'
parameter is optional. If it is not present, then its value defaults to
the empty string.[¶](#section-5.1.3-1){.pilcrow}

In order to communicate with the WebRTC API, the \'label\' parameter
should[¶](#section-5.1.3-2){.pilcrow}

-   [Serialize the WebRTC label as a UTF-8 string
    \[[RFC3629](#RFC3629){.xref}\].[¶](#section-5.1.3-3.1){.pilcrow}]{#section-5.1.3-3.1}

-   [Treat the UTF-8 serialization as a series of
    bytes.[¶](#section-5.1.3-3.2){.pilcrow}]{#section-5.1.3-3.2}

-   ::: {#section-5.1.3-3.3}
    For each byte in the
    serialization,[¶](#section-5.1.3-3.3.1){.pilcrow}

    -   [If the byte can be expressed as a \'quoted-char\', do
        so.[¶](#section-5.1.3-3.3.2.1){.pilcrow}]{#section-5.1.3-3.3.2.1}
    -   [Otherwise, express the byte as an
        \'escaped-char\'.[¶](#section-5.1.3-3.3.2.2){.pilcrow}]{#section-5.1.3-3.3.2.2}
    :::

Note: The empty string can also be explicitly used as a \'label\' value,
such that \'label=\"\"\' is equivalent to the \'label\' parameter not
being present at all. \[[RFC8832](#RFC8832){.xref}\] allows the
DATA_CHANNEL_OPEN message\'s \'Label\' value to be an empty
string.[¶](#section-5.1.3-4.1){.pilcrow}
:::

::: {#subprotocol-parameter}
::: {#section-5.1.4 .section}
#### [5.1.4.](#section-5.1.4){.section-number .selfRef} [\'subprotocol\' Parameter](#name-subprotocol-parameter){.section-name .selfRef} {#name-subprotocol-parameter}

The \'subprotocol\' parameter indicates which protocol the client
expects to exchange via the channel. This parameter maps to the
\'Protocol\' parameter defined in \[[RFC8832](#RFC8832){.xref}\].
[Section 9.1](#IANA_subproto_ids){.xref} specifies how values for new
subprotocol parameters are registered. \'subprotocol\' is an optional
parameter. If the \'subprotocol\' parameter is not present, then its
value defaults to an empty string.[¶](#section-5.1.4-1){.pilcrow}

Note: The empty string can also be explicitly used as a \'subprotocol\'
value, such that \'subprotocol=\"\"\' is equivalent to the
\'subprotocol\' parameter not being present at all.
\[[RFC8832](#RFC8832){.xref}\] allows the DATA_CHANNEL_OPEN message\'s
\'Protocol\' value to be an empty
string.[¶](#section-5.1.4-2.1){.pilcrow}
:::
:::

::: {#max-retr-param-definition}
::: {#section-5.1.5 .section}
#### [5.1.5.](#section-5.1.5){.section-number .selfRef} [\'max-retr\' Parameter](#name-max-retr-parameter){.section-name .selfRef} {#name-max-retr-parameter}

This parameter indicates that the data channel is partially reliable.
The \'max-retr\' parameter indicates the maximal number of times a user
message will be retransmitted. The \'max-retr\' parameter is optional.
If the \'max-retr\' parameter and the \'max-time\' parameter are not
present, then reliable transmission is performed as specified in
\[[RFC4960](#RFC4960){.xref}\]. This parameter maps to the \'Number of
RTX\' parameter defined in
\[[RFC8832](#RFC8832){.xref}\].[¶](#section-5.1.5-1){.pilcrow}
:::
:::

::: {#section-5.1.6 .section}
#### [5.1.6.](#section-5.1.6){.section-number .selfRef} [\'max-time\' Parameter](#name-max-time-parameter){.section-name .selfRef} {#name-max-time-parameter}

This parameter indicates that the data channel is partially reliable. A
user message will no longer be transmitted or retransmitted after a
specified lifetime, given in milliseconds, in the \'max-time\'
parameter. The lifetime starts when providing the user message to the
protocol stack. The \'max-time\' parameter is optional. If the
\'max-retr\' parameter and the \'max-time\' parameter are not present,
then reliable transmission is performed as specified in
\[[RFC4960](#RFC4960){.xref}\]. This parameter maps to the \'Lifetime in
ms\' parameter defined in
\[[RFC8832](#RFC8832){.xref}\].[¶](#section-5.1.6-1){.pilcrow}
:::

::: {#ordered-param-description}
::: {#section-5.1.7 .section}
#### [5.1.7.](#section-5.1.7){.section-number .selfRef} [\'ordered\' Parameter](#name-ordered-parameter){.section-name .selfRef} {#name-ordered-parameter}

The \'ordered\' parameter with value \"true\" indicates that the
receiver will dispatch DATA chunks in the data channel to the upper
layer while preserving the order. The \'ordered\' parameter is optional
and takes two values \-- \"true\" for ordered delivery and \"false\" for
unordered delivery \-- with \"true\" as the default value. Any other
value is ignored, and the default \"ordered=true\" is assumed. In the
absence of this parameter, \"ordered=true\" is assumed. This parameter
maps to the ordered or unordered data channel types as defined in
\[[RFC8832](#RFC8832){.xref}\].[¶](#section-5.1.7-1){.pilcrow}
:::
:::

::: {#priority-param-description}
::: {#section-5.1.8 .section}
#### [5.1.8.](#section-5.1.8){.section-number .selfRef} [\'priority\' Parameter](#name-priority-parameter){.section-name .selfRef} {#name-priority-parameter}

The \'priority\' parameter indicates the data channel\'s priority
relative to the priorities of other data channels, which may
additionally exist over the same SCTP association. The \'priority\'
parameter maps to the \'Priority\' parameter defined in
\[[RFC8832](#RFC8832){.xref}\]. The \'priority\' parameter is optional.
In the absence of this parameter, \"priority=256\" is
assumed.[¶](#section-5.1.8-1){.pilcrow}
:::
:::

::: {#dcmap-mux-category}
::: {#section-5.1.9 .section}
#### [5.1.9.](#section-5.1.9){.section-number .selfRef} [DCMAP Multiplexing Category](#name-dcmap-multiplexing-category){.section-name .selfRef} {#name-dcmap-multiplexing-category}

The multiplexing category \[[RFC8859](#RFC8859){.xref}\] of the
\"a=dcmap:\" attribute is SPECIAL.[¶](#section-5.1.9-1){.pilcrow}

As the usage of multiple SCTP associations on top of a single DTLS
association is outside the scope of \[[RFC8841](#RFC8841){.xref}\], no
\"a=dcmap:\" attribute multiplexing rules are specified for the
UDP/DTLS/SCTP and TCP/DTLS/SCTP proto values. If future extensions of
\[[RFC8841](#RFC8841){.xref}\] define how to negotiate multiplexing of
multiple SCTP associations on top of a single DTLS association or how to
add multiple SCTP associations to one BUNDLE group, then multiplexing
rules for the \"a=dcmap:\" attribute need to be defined as well \-- for
instance, in an extension of this
specification.[¶](#section-5.1.9-2){.pilcrow}
:::
:::
:::
:::

::: {#prot_att}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [SDP DCSA Attribute](#name-sdp-dcsa-attribute){.section-name .selfRef} {#name-sdp-dcsa-attribute}

In the SDP media description, each data channel declaration
[MAY]{.bcp14} also be followed by other SDP attributes, which apply to
the corresponding data channel and its subprotocol. Each of these
attributes is represented by one new \"a=dcsa:\" attribute line that
references another SDP attribute defined for use with this data
channel\'s subprotocol. Instructions for registering attributes for use
with a data channel are given in [Section
9.3](#IANA-reg-data-channel-attribs){.xref}.[¶](#section-5.2-1){.pilcrow}

Each SDP attribute that is related to the subprotocol and that would
normally be used to negotiate the subprotocol using the SDP offer/answer
mechanism is replaced with an attribute of the form \"a=dcsa:stream-id
original‑attribute\", where \"dcsa\" stands for \"data channel
subprotocol attribute\", \"stream-id\" is the SCTP stream identifier
assigned to this subprotocol instance, and \"original-attribute\"
represents the contents of the subprotocol-related attribute to be
included.[¶](#section-5.2-2){.pilcrow}

The same syntax applies to any other SDP attribute required for
negotiation of this instance of the
subprotocol.[¶](#section-5.2-3){.pilcrow}

The detailed offer/answer procedures for the dcsa attribute are
dependent on the associated subprotocol. If no offer/answer procedures
exist for the subprotocol when used outside of the dcsa attribute, no
specification is needed for use with dcsa. The IANA (Internet Assigned
Numbers Authority) registration procedures for the \"WebSocket
Subprotocol Name Registry\" ([Section 9.1](#IANA_subproto_ids){.xref})
do not strictly require a specification of the offer/answer procedures
for the subprotocol when used with dcsa. If the subprotocol has defined
offer/answer procedures when used outside of dcsa, such a specification
is encouraged to ensure interoperability. If the subprotocol has defined
offer/answer procedures when used outside of dcsa but no specification
exists for the offer/answer procedures for the subprotocol when used
with dcsa, implementations [SHOULD]{.bcp14} assume the use of the
default values for all otherwise-negotiable and applicable subprotocol
parameters.[¶](#section-5.2-4){.pilcrow}

::: {#dcsa-attribute}
::: {#section-5.2.1 .section}
#### [5.2.1.](#section-5.2.1){.section-number .selfRef} [DCSA Attribute Syntax](#name-dcsa-attribute-syntax){.section-name .selfRef} {#name-dcsa-attribute-syntax}

\"a=dcsa:\" is a media-level attribute having the following definition
and ABNF (Augmented Backus-Naur Form) syntax
\[[RFC5234](#RFC5234){.xref}\].[¶](#section-5.2.1-1){.pilcrow}

[]{#name-adcsa-attribute-definition}

::: {#dcsa-attrib}
  \"a=dcsa:\" Attribute   
  ----------------------- ------------
  Name                    dcsa
  Value                   dcsa-value
  Usage Level             media
  Charset Dependent       No

  : [Table 2](#table-2){.selfRef}: [\"a=dcsa:\" Attribute
  Definition](#name-adcsa-attribute-definition){.selfRef}
:::

Formal syntax:[¶](#section-5.2.1-3){.pilcrow}

::: {#section-5.2.1-4}
``` {.sourcecode .lang-abnf}
dcsa-value      = stream-id SP attribute
stream-id       = 1*5DIGIT
attribute       = <from RFC 8866>
```

[¶](#section-5.2.1-4){.pilcrow}
:::

Example:[¶](#section-5.2.1-5){.pilcrow}

::: {#section-5.2.1-6}
``` {.sourcecode .lang-sdp}
a=dcmap:2 subprotocol="msrp";ordered=true;label="msrp"

a=dcsa:2 accept-types:text/plain
```

[¶](#section-5.2.1-6){.pilcrow}
:::

The reference to \[[RFC8866](#RFC8866){.xref}\] defines where the
attribute definition can be found; it does not provide any limitations
on support of attributes defined in other documents in accordance with
this attribute definition. However, not all SDP attributes are suitable
as an \"a=dcsa:\" parameter. The registry of IANA SDP parameters
contains the lists of IANA-registered session-level and media-level or
media-level-only SDP attributes.[¶](#section-5.2.1-7){.pilcrow}

Thus, in the example above, the original attribute line
\"a=accept‑types:text/plain\" is represented by the attribute line
\"a=dcsa:2 accept-types:text/plain\", which specifies that this instance
of the MSRP subprotocol being transported on the SCTP association using
the data channel with stream id 2 accepts plaintext
files.[¶](#section-5.2.1-8){.pilcrow}

As opposed to the data channel \"a=dcmap:\" attribute parameters, these
parameters are subject to offer/answer negotiation, following the
procedures defined in the subprotocol-specific
documents.[¶](#section-5.2.1-9){.pilcrow}

It is assumed that in general the usages of subprotocol-related
media-level attributes are independent from the subprotocol\'s transport
protocol. Such transport-protocol-independent subprotocol-related
attributes are used in the same way as defined in the original
subprotocol specification, also if the subprotocol is transported over a
data channel and if the attribute is correspondingly embedded in an
\"a=dcsa:\" attribute.[¶](#section-5.2.1-10){.pilcrow}

There may be cases where the usage of a subprotocol-related media-level
attribute depends on the subprotocol\'s transport protocol. In such
cases, the subprotocol-related usage of the attribute is expected to be
described for the data channel transport. A data-channel-specific usage
of a subprotocol attribute is expected to be specified in the same
document that registers the subprotocol\'s identifier for data channel
usage as described in [Section
9.1](#IANA_subproto_ids){.xref}.[¶](#section-5.2.1-11){.pilcrow}
:::
:::

::: {#dcsa-mux-category}
::: {#section-5.2.2 .section}
#### [5.2.2.](#section-5.2.2){.section-number .selfRef} [DCSA Multiplexing Category](#name-dcsa-multiplexing-category){.section-name .selfRef} {#name-dcsa-multiplexing-category}

The multiplexing category of the \"a=dcsa:\" attribute is
SPECIAL.[¶](#section-5.2.2-1){.pilcrow}

As the usage of multiple SCTP associations on top of a single DTLS
association is outside the scope of \[[RFC8841](#RFC8841){.xref}\], no
\"a=dcsa:\" attribute multiplexing rules are specified for the
UDP/DTLS/SCTP and TCP⁠/DTLS⁠/SCTP proto values. If future extensions of
\[[RFC8841](#RFC8841){.xref}\] define how to negotiate multiplexing of
multiple SCTP associations on top of a single DTLS association or how to
add multiple SCTP associations to one BUNDLE group, then multiplexing
rules for the \"a=dcsa:\" attribute need to be defined as well \-- for
instance, in an extension of this
specification.[¶](#section-5.2.2-2){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#section_procedures}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [SDP Offer/Answer Procedures](#name-sdp-offer-answer-procedures){.section-name .selfRef} {#name-sdp-offer-answer-procedures}

This section defines how data channels can be negotiated using the SDP
offer/answer mechanism. A given media description can describe multiple
data channels (each represented by a separate SDP dcmap attribute) that
can be created, modified, and closed using different offer/answer
exchanges. The procedures in this section apply for a given data
channel.[¶](#section-6-1){.pilcrow}

The generic offer/answer procedures for negotiating the SCTP association
used to realize data channels are defined in
\[[RFC8841](#RFC8841){.xref}\]. This section only defines the
data-channel-specific procedures.[¶](#section-6-2){.pilcrow}

\"Initial offer\" refers to the offer in which a data channel is opened.
It can be either the initial offer or a subsequent offer of the
associated SDP session.[¶](#section-6-3){.pilcrow}

The detailed offer/answer procedures for the dcsa attribute are
dependent on the associated subprotocol; see [Section
5.2](#prot_att){.xref}.[¶](#section-6-4){.pilcrow}

::: {#id_mgmt}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Managing Stream Identifiers](#name-managing-stream-identifiers){.section-name .selfRef} {#name-managing-stream-identifiers}

In order to avoid SCTP Stream identifier collisions, in alignment with
\[[RFC8832](#RFC8832){.xref}\], the endpoint acting as a DTLS client
(for the SCTP association used to realize data channels) [MUST]{.bcp14}
use even identifier values, and the endpoint acting as a DTLS server
[MUST]{.bcp14} use odd identifier values.[¶](#section-6.1-1){.pilcrow}

SCTP stream identifiers associated with data channels that have been
negotiated using DCEP [MUST NOT]{.bcp14} be included in SDP offers and
answers.[¶](#section-6.1-2){.pilcrow}
:::
:::

::: {#param_negotiation}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Negotiating Data Channel Parameters](#name-negotiating-data-channel-pa){.section-name .selfRef} {#name-negotiating-data-channel-pa}

The data channel types defined in \[[RFC8832](#RFC8832){.xref}\] are
mapped to the dcmap SDP attribute parameters in the following manner,
where \"ordered=true\" is the default and may be
omitted:[¶](#section-6.2-1){.pilcrow}

::: {#section-6.2-2}
``` {.sourcecode .lang-sdp}
DATA_CHANNEL_RELIABLE
   ordered=true

DATA_CHANNEL_RELIABLE_UNORDERED
   ordered=false

DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT
   ordered=true;max-retr=<number of retransmissions>

DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT_UNORDERED
   ordered=false;max-retr=<number of retransmissions>

DATA_CHANNEL_PARTIAL_RELIABLE_TIMED
   ordered=true;max-time=<lifetime in milliseconds>

DATA_CHANNEL_PARTIAL_RELIABLE_TIMED_UNORDERED
   ordered=false;max-time=<lifetime in milliseconds>
```

[¶](#section-6.2-2){.pilcrow}
:::

By definition, \'max-retr\' and \'max-time\' are mutually exclusive, so
both [MUST NOT]{.bcp14} be present in the \"a=dcmap:\" attribute line.
If an SDP offer contains both of these parameters, then the receiver of
such an SDP offer [MUST]{.bcp14} reject the SDP offer. If an SDP answer
contains both of these parameters, then the offerer [MUST]{.bcp14} treat
the associated SDP offer/answer as failed.[¶](#section-6.2-3){.pilcrow}
:::
:::

::: {#opendc}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Generating the Initial Offer for a Data Channel](#name-generating-the-initial-offe){.section-name .selfRef} {#name-generating-the-initial-offe}

When an offerer sends an initial offer, in order to negotiate an SCTP
stream for a data channel, the offerer[¶](#section-6.3-1){.pilcrow}

-   [[SHALL]{.bcp14} include an SDP dcmap attribute
    (Sections [5.1](#subsec-sdp-attr-for-dc-par-neg){.xref} and
    [6.2](#param_negotiation){.xref}) associated with the data channel
    in the \"m=\" section representing the SCTP association used to
    realize the data channel,
    and[¶](#section-6.3-2.1){.pilcrow}]{#section-6.3-2.1}
-   [[MAY]{.bcp14} include one or more SDP dcsa attributes ([Section
    5.2](#prot_att){.xref}) associated with the data channel. The value
    of the \'stream-id\' part of each attribute [SHALL]{.bcp14} match
    the \'dcmap-stream-id\' value of the dcmap
    attribute.[¶](#section-6.3-2.2){.pilcrow}]{#section-6.3-2.2}
:::
:::

::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [Generating the SDP Answer](#name-generating-the-sdp-answer){.section-name .selfRef} {#name-generating-the-sdp-answer}

When an answerer receives an offer that includes an \"m=\" section for
an SCTP association, the offer describes an SCTP stream for a data
channel, if the answerer accepts the data channel,
it[¶](#section-6.4-1){.pilcrow}

-   [[SHALL]{.bcp14} include an SDP dcmap attribute
    (Sections [5.1](#subsec-sdp-attr-for-dc-par-neg){.xref} and
    [6.2](#param_negotiation){.xref}) associated with the data channel
    in the \"m=\" section representing the SCTP association used to
    realize the data channel. The value of the \'dcmap-stream-id\',
    \'max-retr\', and \'max-time\' values of the dcmap attribute
    [SHALL]{.bcp14} be identical to the value used for the data channel
    in the offer, and[¶](#section-6.4-2.1){.pilcrow}]{#section-6.4-2.1}
-   [[MAY]{.bcp14} include one or more SDP dcsa attributes ([Section
    5.2](#prot_att){.xref}) associated with the data
    channel.[¶](#section-6.4-2.2){.pilcrow}]{#section-6.4-2.2}
:::

::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [Offerer Processing of the SDP Answer](#name-offerer-processing-of-the-s){.section-name .selfRef} {#name-offerer-processing-of-the-s}

An offerer receiving an SDP answer performs the
following:[¶](#section-6.5-1){.pilcrow}

-   [It [SHALL]{.bcp14} close any created data channels as described in
    [Section 6.6.1](#close-dc){.xref} for which the expected
    \"a=dcmap:\" attributes are not present in the SDP answer. If the
    SDP answer has no \"a=dcmap:\" attributes, either the peer does not
    support \"a=dcmap:\" attributes or it rejected all the data
    channels. In either case, the offerer closes all the data channels
    offered by SDP that were open at the time of the offer. The DTLS
    association and SCTP association will still be set up. At this
    point, the offerer may use DCEP negotiation
    \[[RFC8832](#RFC8832){.xref}\] to open data
    channels.[¶](#section-6.5-2.1){.pilcrow}]{#section-6.5-2.1}

Each agent application [MUST]{.bcp14} wait to send data until it has
confirmation that the data channel at the peer is instantiated. For
WebRTC, this is when both data channel stacks have channel parameters
instantiated and occurs as follows:[¶](#section-6.5-3){.pilcrow}

-   [At both peers when a data channel is created without a previously
    established SCTP association, as soon as the SCTP association is
    successfully
    established.[¶](#section-6.5-4.1){.pilcrow}]{#section-6.5-4.1}
-   [At the agent receiving an SDP offer for which there is an
    established SCTP association, as soon as it creates the negotiated
    data channel based on information signaled in the SDP
    offer.[¶](#section-6.5-4.2){.pilcrow}]{#section-6.5-4.2}
-   [At the agent sending an SDP offer to create a new data channel for
    which there is an established SCTP association, when it receives the
    SDP answer confirming acceptance of the data channel or when it
    begins to receive data on the data channel from the peer, whichever
    occurs first.[¶](#section-6.5-4.3){.pilcrow}]{#section-6.5-4.3}
:::

::: {#section-6.6 .section}
### [6.6.](#section-6.6){.section-number .selfRef} [Modifying the Session](#name-modifying-the-session){.section-name .selfRef} {#name-modifying-the-session}

When an offerer sends a subsequent offer that includes information for a
previously negotiated data channel, unless the offerer intends to close
the data channel ([Section 6.6.1](#close-dc){.xref}), the offerer
[SHALL]{.bcp14} include the previously negotiated SDP attributes and
attribute values associated with the data channel. The answerer may
reject the offer. The means for rejecting an offer are dependent on the
higher-layer protocol. The offer/answer exchange is atomic; if the
answer is rejected, the session reverts to the state prior to the offer
\[[RFC3264](#RFC3264){.xref}\].[¶](#section-6.6-1){.pilcrow}

::: {#close-dc}
::: {#section-6.6.1 .section}
#### [6.6.1.](#section-6.6.1){.section-number .selfRef} [Closing a Data Channel](#name-closing-a-data-channel){.section-name .selfRef} {#name-closing-a-data-channel}

In order to close a data channel, the endpoint that wants to close the
data channel [SHALL]{.bcp14} send an SCTP SSN Reset message
\[[RFC6525](#RFC6525){.xref}\], following the procedure in [Section
6.7](https://www.rfc-editor.org/rfc/rfc8831#section-6.7){.relref} of
\[[RFC8831](#RFC8831){.xref}\]. In addition, if the closed data channel
was negotiated using the offer/answer mechanism ([Section
6.3](#opendc){.xref}), the endpoint that closed the data channel
[SHALL]{.bcp14} send a subsequent offer in which it does one of the
following:[¶](#section-6.6.1-1){.pilcrow}

-   [Removes the SDP dcmap attribute and SDP dcsa attributes associated
    with the closed data channel. Once the endpoint receives a
    successful answer, the SCTP stream identifier value can later be
    used for a new data channel (negotiated using either SCTP or the
    offer/answer mechanism),
    or[¶](#section-6.6.1-2.1){.pilcrow}]{#section-6.6.1-2.1}
-   [After a reset has been performed, reuses the SCTP stream used for
    the closed data channel for a new data channel, following the
    procedure in [Section 6.3](#opendc){.xref}. The offerer
    [SHALL]{.bcp14} use a different SDP dcmap attribute value for the
    data channel using the same SCTP
    stream.[¶](#section-6.6.1-2.2){.pilcrow}]{#section-6.6.1-2.2}
:::
:::
:::

::: {#various_SDP_OA_considerations}
::: {#section-6.7 .section}
### [6.7.](#section-6.7){.section-number .selfRef} [Various SDP Offer/Answer Considerations](#name-various-sdp-offer-answer-co){.section-name .selfRef} {#name-various-sdp-offer-answer-co}

An SDP offer or answer has no \"a=dcmap:\" attributes but has
\"a=dcsa:\" attributes:[¶](#section-6.7-1){.pilcrow}

-   [This is considered an error case. In this case, the receiver of
    such an SDP offer or answer [MUST]{.bcp14} discard the \"a=dcsa:\"
    attributes.[¶](#section-6.7-2.1){.pilcrow}]{#section-6.7-2.1}

An SDP offer or answer has an \"a=dcsa:\" attribute whose subprotocol
attribute is unknown:[¶](#section-6.7-3){.pilcrow}

-   [The receiver of such an SDP offer or answer [SHOULD]{.bcp14} ignore
    this entire \"a=dcsa:\" attribute
    line.[¶](#section-6.7-4.1){.pilcrow}]{#section-6.7-4.1}

An SDP offer or answer has an \"a=dcsa:\" attribute whose subprotocol
attribute is known but whose subprotocol attribute semantic is not known
for the data channel transport case:[¶](#section-6.7-5){.pilcrow}

-   [The receiver of such an SDP offer or answer [SHOULD]{.bcp14} ignore
    this entire \"a=dcsa:\" attribute
    line.[¶](#section-6.7-6.1){.pilcrow}]{#section-6.7-6.1}
:::
:::
:::
:::

::: {#examples}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Examples](#name-examples){.section-name .selfRef} {#name-examples}

[Figure 1](#example1){.xref} shows an example of an SDP offer and answer
where the SDP answerer rejects the data channel with stream id 0 either
for explicit reasons or because it does not understand the \"a=dcmap:\"
attribute. As a result, the offerer will close the data channel created
with the SDP offer/answer negotiation option. The SCTP association will
still be set up over DTLS. At this point, the offerer or the answerer
may use DCEP negotiation to open data
channels.[¶](#section-7-1){.pilcrow}

[]{#name-example-1}

::: {#example1}
::: {#section-7-2.1}
``` {.sourcecode .lang-sdp}
  m=application 10001 UDP/DTLS/SCTP webrtc-datachannel
  c=IN IP6 2001:db8::3
  a=max-message-size:100000
  a=sctp-port:5000
  a=setup:actpass
  a=fingerprint:SHA-1 \
      4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
  a=tls-id:abc3de65cddef001be82
  a=dcmap:0 subprotocol="bfcp";label="bfcp"
```
:::

::: {#section-7-2.2}
``` {.sourcecode .lang-sdp}
  m=application 10002 UDP/DTLS/SCTP webrtc-datachannel
  c=IN IP6 2001:db8::1
  a=max-message-size:100000
  a=sctp-port:5002
  a=setup:passive
  a=fingerprint:SHA-1 \
      5B:AD:67:B1:3E:82:AC:3B:90:02:B1:DF:12:5D:CA:6B:3F:E5:54:FA
  a=tls-id:dcb3ae65cddef0532d42
```
:::

[Figure 1](#figure-1){.selfRef}: [Example 1](#name-example-1){.selfRef}
:::

[Figure 2](#example2){.xref} shows an example of an SDP offer and answer
where the SDP offer contains data channels for BFCP and MSRP
subprotocols. The SDP answer rejects BFCP and accepts MSRP. So, the
offerer closes the data channel for BFCP, and both the offerer and the
answerer may start using the MSRP data channel (after the SCTP
association is set up). The data channel with stream id 0 is free and
can be used for future DCEP or SDP offer/answer
negotiation.[¶](#section-7-3){.pilcrow}

[]{#name-example-2}

::: {#example2}
::: {#section-7-4.1}
``` {.sourcecode .lang-sdp}
  m=application 10001 UDP/DTLS/SCTP webrtc-datachannel
  c=IN IP4 192.0.2.1
  a=max-message-size:100000
  a=sctp-port:5000
  a=setup:actpass
  a=fingerprint:SHA-1 \
      4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
  a=tls-id:abc3de65cddef001be82
  a=dcmap:0 subprotocol="bfcp";label="bfcp"
  a=dcmap:2 subprotocol="msrp";label="msrp"
  a=dcsa:2 accept-types:message/cpim text/plain
  a=dcsa:2 path:msrp://alice.example.com:10001/2s93i93idj;dc
```
:::

::: {#section-7-4.2}
``` {.sourcecode .lang-sdp}
  m=application 10002 UDP/DTLS/SCTP webrtc-datachannel
  c=IN IP4 192.0.2.2
  a=max-message-size:100000
  a=sctp-port:5002
  a=setup:passive
  a=fingerprint:SHA-1 \
      5B:AD:67:B1:3E:82:AC:3B:90:02:B1:DF:12:5D:CA:6B:3F:E5:54:FA
  a=tls-id:dcb3ae65cddef0532d42
  a=dcmap:2 subprotocol="msrp";label="msrp"
  a=dcsa:2 accept-types:message/cpim text/plain
  a=dcsa:2 path:msrp://bob.example.com:10002/si438dsaodes;dc
```
:::

[Figure 2](#figure-2){.selfRef}: [Example 2](#name-example-2){.selfRef}
:::

The example in [Figure 3](#example3){.xref} is a continuation of the
example in [Figure 2](#example2){.xref}. The SDP offerer now removes the
MSRP data channel with stream id 2 but opens a new MSRP data channel
with stream id 4. The answerer accepts the entire offer. As a result,
the offerer closes the previously negotiated MSRP-related data channel,
and both the offerer and the answerer may start using the new
MSRP-related data channel.[¶](#section-7-5){.pilcrow}

[]{#name-example-3}

::: {#example3}
::: {#section-7-6.1}
``` {.sourcecode .lang-sdp}
  m=application 10001 UDP/DTLS/SCTP webrtc-datachannel
  c=IN IP4 192.0.2.1
  a=max-message-size:100000
  a=sctp-port:5000
  a=setup:actpass
  a=fingerprint:SHA-1 \
      4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
  a=tls-id:abc3de65cddef001be82
  a=dcmap:4 subprotocol="msrp";label="msrp"
  a=dcsa:4 accept-types:message/cpim text/plain
  a=dcsa:4 path:msrp://alice.example.com:10001/2s93i93idj;dc
```
:::

::: {#section-7-6.2}
``` {.sourcecode .lang-sdp}
  m=application 10002 UDP/DTLS/SCTP webrtc-datachannel
  c=IN IP4 192.0.2.2
  a=max-message-size:100000
  a=sctp-port:5002
  a=setup:passive
  a=fingerprint:SHA-1 \
      5B:AD:67:B1:3E:82:AC:3B:90:02:B1:DF:12:5D:CA:6B:3F:E5:54:FA
  a=tls-id:dcb3ae65cddef0532d42
  a=dcmap:4 subprotocol="msrp";label="msrp"
  a=dcsa:4 accept-types:message/cpim text/plain
  a=dcsa:4 path:msrp://bob.example.com:10002/si438dsaodes;dc
```
:::

[Figure 3](#figure-3){.selfRef}: [Example 3](#name-example-3){.selfRef}
:::
:::
:::

::: {#sec-cons}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document specifies new SDP attributes used in the negotiation of
data channel parameters.[¶](#section-8-1){.pilcrow}

These parameters are negotiated as part of opening an SCTP channel over
DTLS as specified in \[[RFC8841](#RFC8841){.xref}\]. Each subprotocol
may come with its own security considerations that need to be documented
as part of the subprotocol definition. Otherwise, this document does not
add any security considerations to those specified in
\[[RFC8841](#RFC8841){.xref}\].[¶](#section-8-2){.pilcrow}

Error cases such as the use of unknown parameter values or violations of
the odd/even rule ([Section 6.1](#id_mgmt){.xref}) [MUST]{.bcp14} be
handled by closing the corresponding data
channel.[¶](#section-8-3){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#IANA_subproto_ids}
::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Subprotocol Identifiers](#name-subprotocol-identifiers){.section-name .selfRef} {#name-subprotocol-identifiers}

Registration of new subprotocol identifiers is performed using the
existing IANA \"WebSocket Subprotocol Name Registry\"
table.[¶](#section-9.1-1){.pilcrow}

The following text has been added below the title of the
table.[¶](#section-9.1-2){.pilcrow}

\"This table also includes subprotocol identifiers specified for usage
within a WebRTC data channel.\"[¶](#section-9.1-3){.pilcrow}

This document (RFC 8864) has been added to the \"Reference\" list for
the registry.[¶](#section-9.1-4){.pilcrow}

This document assigns no new values to this
table.[¶](#section-9.1-5){.pilcrow}

A subprotocol may simultaneously be defined for data channel transport
and for WebSocket transport. In such a case, the \"Subprotocol
Definition\" and \"Reference\" cells in the subprotocol\'s row of the
IANA \"WebSocket Subprotocol Name Registry\" table should contain two
entries. One entry in each of these cells should refer to the
WebSocket-related subprotocol specification, and the other entry should
refer to the data-channel-related subprotocol
specification.[¶](#section-9.1-6){.pilcrow}
:::
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [New SDP Attributes](#name-new-sdp-attributes){.section-name .selfRef} {#name-new-sdp-attributes}

::: {#IANA-reg-dcmap}
::: {#section-9.2.1 .section}
#### [9.2.1.](#section-9.2.1){.section-number .selfRef} [dcmap](#name-dcmap){.section-name .selfRef} {#name-dcmap}

This document defines a new SDP media-level attribute, \"a=dcmap:\", as
follows:[¶](#section-9.2.1-1){.pilcrow}

[]{#name-new-adcmap-attribute}

::: {#dcmap-iana}
  \"a=dcmap:\"          
  --------------------- ----------------------------------------------------------------------------
  Contact name          IESG
  Contact email         iesg\@ietf.org
  Attribute name        dcmap
  Attribute syntax      As per [Section 5.1.1](#dcmap-attr-definition){.xref}
  Attribute semantics   As per [Section 5.1.1](#dcmap-attr-definition){.xref}
  Usage level           media
  Charset dependent     No
  Purpose               To define data-channel-specific parameters
  Appropriate values    As per [Section 5.1.1](#dcmap-attr-definition){.xref}
  O/A procedures        SDP offer/answer procedures as per [Section 6](#section_procedures){.xref}
  Mux category          SPECIAL. See [Section 5.1.9](#dcmap-mux-category){.xref}
  Reference             RFC 8864

  : [Table 3](#table-3){.selfRef}: [New \"a=dcmap:\"
  Attribute](#name-new-adcmap-attribute){.selfRef}
:::
:::
:::

::: {#IANA-reg-dcsa}
::: {#section-9.2.2 .section}
#### [9.2.2.](#section-9.2.2){.section-number .selfRef} [dcsa](#name-dcsa){.section-name .selfRef} {#name-dcsa}

This document defines a new SDP media-level attribute, \"a=dcsa:\", as
follows:[¶](#section-9.2.2-1){.pilcrow}

[]{#name-new-adcsa-attribute}

::: {#dcsa-iana}
  \"a=dcsa:\"           
  --------------------- ----------------------------------------------------------------------------
  Contact name          IESG
  Contact email         iesg\@ietf.org
  Attribute name        dcsa
  Attribute syntax      As per [Section 5.2.1](#dcsa-attribute){.xref}
  Attribute semantics   As per [Section 5.2.1](#dcsa-attribute){.xref}
  Usage level           media
  Charset dependent     No
  Purpose               To define attributes that are specific to data channel subprotocols
  Appropriate values    As per [Section 5.2.1](#dcsa-attribute){.xref}
  O/A procedures        SDP offer/answer procedures as per [Section 6](#section_procedures){.xref}
  Mux category          SPECIAL. See [Section 5.2.2](#dcsa-mux-category){.xref}
  Reference             RFC 8864

  : [Table 4](#table-4){.selfRef}: [New \"a=dcsa:\"
  Attribute](#name-new-adcsa-attribute){.selfRef}
:::
:::
:::
:::

::: {#IANA-reg-data-channel-attribs}
::: {#section-9.3 .section}
### [9.3.](#section-9.3){.section-number .selfRef} [Registering Attributes for Use with Data Channels](#name-registering-attributes-for-){.section-name .selfRef} {#name-registering-attributes-for-}

When a subprotocol is defined for use over data channels with the SDP
offer/answer mechanism, any SDP attributes that may be negotiated using
the \"a=dcsa:\" attribute [MUST]{.bcp14} be added to the IANA
\"attribute-name registry (formerly \"att-field\")\", as specified in
\[[RFC8866](#RFC8866){.xref}\], [Section
8.2.4](https://www.rfc-editor.org/rfc/rfc8866#section-8.2.4){.relref}.
This document specifies that new Usage Levels of the form \"dcsa (foo)\"
(where \"foo\" is a placeholder for the subprotocol name) should be
registered by documents that specify negotiation of particular
subprotocols.[¶](#section-9.3-1){.pilcrow}

IANA has updated the \"attribute-name (formerly \"att-field\")\"
registry to point to this document.[¶](#section-9.3-2){.pilcrow}
:::
:::
:::
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3264\]
:   [Rosenberg, J.]{.refAuthor}[ and H. Schulzrinne]{.refAuthor}, [\"An
    Offer/Answer Model with Session Description Protocol
    (SDP)\"]{.refTitle}, [RFC 3264]{.seriesInfo}, [DOI
    10.17487/RFC3264]{.seriesInfo}, June 2002,
    \<<https://www.rfc-editor.org/info/rfc3264>\>.
:   

\[RFC3629\]
:   [Yergeau, F.]{.refAuthor}, [\"UTF-8, a transformation format of ISO
    10646\"]{.refTitle}, [STD 63]{.seriesInfo}, [RFC 3629]{.seriesInfo},
    [DOI 10.17487/RFC3629]{.seriesInfo}, November 2003,
    \<<https://www.rfc-editor.org/info/rfc3629>\>.
:   

\[RFC4960\]
:   [Stewart, R., Ed.]{.refAuthor}, [\"Stream Control Transmission
    Protocol\"]{.refTitle}, [RFC 4960]{.seriesInfo}, [DOI
    10.17487/RFC4960]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4960>\>.
:   

\[RFC5234\]
:   [Crocker, D., Ed.]{.refAuthor}[ and P. Overell]{.refAuthor},
    [\"Augmented BNF for Syntax Specifications: ABNF\"]{.refTitle}, [STD
    68]{.seriesInfo}, [RFC 5234]{.seriesInfo}, [DOI
    10.17487/RFC5234]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5234>\>.
:   

\[RFC6525\]
:   [Stewart, R.]{.refAuthor}[, Tuexen, M.]{.refAuthor}[, and P.
    Lei]{.refAuthor}, [\"Stream Control Transmission Protocol (SCTP)
    Stream Reconfiguration\"]{.refTitle}, [RFC 6525]{.seriesInfo}, [DOI
    10.17487/RFC6525]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6525>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8831\]
:   [Jesup, R.]{.refAuthor}[, Loreto, S.]{.refAuthor}[, and M.
    Tüxen]{.refAuthor}, [\"WebRTC Data Channels\"]{.refTitle}, [RFC
    8831]{.seriesInfo}, [DOI 10.17487/RFC8831]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8831>\>.
:   

\[RFC8832\]
:   [Jesup, R.]{.refAuthor}[, Loreto, S.]{.refAuthor}[, and M.
    Tüxen]{.refAuthor}, [\"WebRTC Data Channel Establishment
    Protocol\"]{.refTitle}, [RFC 8832]{.seriesInfo}, [DOI
    10.17487/RFC8832]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8832>\>.
:   

\[RFC8841\]
:   [Holmberg, C.]{.refAuthor}[, Shpount, R.]{.refAuthor}[,
    Loreto, S.]{.refAuthor}[, and G. Camarillo]{.refAuthor}, [\"Session
    Description Protocol (SDP) Offer/Answer Procedures for Stream
    Control Transmission Protocol (SCTP) over Datagram Transport Layer
    Security (DTLS) Transport\"]{.refTitle}, [RFC 8841]{.seriesInfo},
    [DOI 10.17487/RFC8841]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8841>\>.
:   

\[RFC8859\]
:   [Nandakumar, S.]{.refAuthor}, [\"A Framework for Session Description
    Protocol (SDP) Attributes When Multiplexing\"]{.refTitle}, [RFC
    8859]{.seriesInfo}, [DOI 10.17487/RFC8859]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8859>\>.
:   

\[RFC8866\]
:   [Begen, A.]{.refAuthor}[, Kyzivat, P.]{.refAuthor}[,
    Perkins, C.]{.refAuthor}[, and M. Handley]{.refAuthor}, [\"SDP:
    Session Description Protocol\"]{.refTitle}, [RFC 8866]{.seriesInfo},
    [DOI 10.17487/RFC8866]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8866>\>.
:   
:::

::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC4975\]
:   [Campbell, B., Ed.]{.refAuthor}[, Mahy, R., Ed.]{.refAuthor}[,
    and C. Jennings, Ed.]{.refAuthor}, [\"The Message Session Relay
    Protocol (MSRP)\"]{.refTitle}, [RFC 4975]{.seriesInfo}, [DOI
    10.17487/RFC4975]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4975>\>.
:   

\[RFC6455\]
:   [Fette, I.]{.refAuthor}[ and A. Melnikov]{.refAuthor}, [\"The
    WebSocket Protocol\"]{.refTitle}, [RFC 6455]{.seriesInfo}, [DOI
    10.17487/RFC6455]{.seriesInfo}, December 2011,
    \<<https://www.rfc-editor.org/info/rfc6455>\>.
:   

\[RFC8850\]
:   [Holmberg, C.]{.refAuthor}, [\"Controlling Multiple Streams for
    Telepresence (CLUE) Protocol Data Channel\"]{.refTitle}, [RFC
    8850]{.seriesInfo}, [DOI 10.17487/RFC8850]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8850>\>.
:   

\[RFC8855\]
:   [Camarillo, G.]{.refAuthor}[, Drage, K.]{.refAuthor}[,
    Kristensen, T.]{.refAuthor}[, Ott, J.]{.refAuthor}[, and C.
    Eckel]{.refAuthor}, [\"The Binary Floor Control Protocol
    (BFCP)\"]{.refTitle}, [RFC 8855]{.seriesInfo}, [DOI
    10.17487/RFC8855]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8855>\>.
:   

\[RFC8873\]
:   [Recio, JM., Ed.]{.refAuthor}[ and C. Holmberg]{.refAuthor},
    [\"Message Session Relay Protocol (MSRP) over Data
    Channels\"]{.refTitle}, [RFC 8873]{.seriesInfo}, [DOI
    10.17487/RFC8873]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8873>\>.
:   

\[T38\]
:   [International Telecommunication Union]{.refAuthor}, [\"Procedures
    for real-time Group 3 facsimile communication over IP
    networks\"]{.refTitle}, [ITU-T Recommendation T.38]{.seriesInfo},
    November 2015, \<<https://www.itu.int/rec/T-REC-T.38-201511-I/en>\>.
:   

\[WebRtcAPI\]
:   [Jennings, C.]{.refAuthor}[, Boström, H.]{.refAuthor}[, and J-I.
    Bruaroey]{.refAuthor}, [\"WebRTC 1.0: Real-time Communication
    Between Browsers\"]{.refTitle}, [W3C Proposed
    Recommendation]{.refContent}, \<<https://www.w3.org/TR/webrtc/>\>.
:   
:::
:::

::: {#generic-out-of-band-aspects}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Generic Data Channel Negotiation Aspects when Not Using DCEP](#name-generic-data-channel-negoti){.section-name .selfRef} {#name-generic-data-channel-negoti}

This appendix summarizes how data channels work in general and discusses
some key aspects that should be considered for the out-of-band
negotiation of data channels if DCEP is not
used.[¶](#section-appendix.a-1){.pilcrow}

A WebRTC application creates a data channel by providing a number of
setup parameters (subprotocol, label, maximal number of retransmissions,
maximal retransmission time, order of delivery, priority). The
application also specifies whether it wants to make use of the
negotiation using DCEP \[[RFC8832](#RFC8832){.xref}\] or intends to
negotiate data channels using the SDP offer/answer
protocol.[¶](#section-appendix.a-2){.pilcrow}

In any case, the SDP offer generated by the application is per
\[[RFC8841](#RFC8841){.xref}\]. In brief, it contains one \"m=\" line
for the SCTP association on top of which the data channels will
run:[¶](#section-appendix.a-3){.pilcrow}

::: {#section-appendix.a-4}
``` {.sourcecode .lang-sdp}
m=application 54111 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 192.0.2.1
a=max-message-size:100000
a=sctp-port:5000
a=tls-id:abc3de65cddef001be82
a=setup:actpass
a=fingerprint:SHA-1 \
    4A:AD:B9:B1:3F:82:18:3B:54:02:12:DF:3E:5D:49:6B:19:E5:7C:AB
```

[¶](#section-appendix.a-4){.pilcrow}
:::

Note: A WebRTC application will only use the \"m=\" line format
\"webrtc-datachannel\" and will not use other formats in the \"m=\" line
for other protocols such as T.38 \[[T38](#T38){.xref}\].
\[[RFC8841](#RFC8841){.xref}\] supports only one SCTP association to be
established on top of a DTLS
association.[¶](#section-appendix.a-5.1){.pilcrow}

Note: The above SDP media description does not contain any
channel-specific information.[¶](#section-appendix.a-6.1){.pilcrow}

::: {#si_num}
::: {#section-a.1 .section}
## [A.1.](#section-a.1){.section-number .selfRef} [Stream Identifier Numbering](#name-stream-identifier-numbering){.section-name .selfRef} {#name-stream-identifier-numbering}

Independently from the requested type of negotiation, the application
creating a data channel can either (1) pass the stream identifier to the
data channel stack to assign to the data channel or (2) let the data
channel stack pick one identifier from the unused
ones.[¶](#section-a.1-1){.pilcrow}

Moreover, to avoid glare situations \[[RFC3264](#RFC3264){.xref}\], each
endpoint can own an exclusive set of stream identifiers, in which case
an endpoint can only create a data channel with a stream identifier it
owns.[¶](#section-a.1-2){.pilcrow}

Which set of stream identifiers is owned by which endpoint is determined
by convention or other means.[¶](#section-a.1-3){.pilcrow}

Note: For data channels negotiated with DCEP, one endpoint owns by
convention the even stream identifiers, whereas the other owns the odd
stream identifiers, as defined in
\[[RFC8832](#RFC8832){.xref}\].[¶](#section-a.1-4.1){.pilcrow}

Note: For data channels negotiated via a protocol other than DCEP, no
convention is defined by default.[¶](#section-a.1-5.1){.pilcrow}
:::
:::

::: {#sec-gen-ext-neg}
::: {#section-a.2 .section}
## [A.2.](#section-a.2){.section-number .selfRef} [Generic Data Channel Negotiation Not Using DCEP](#name-generic-data-channel-negotia){.section-name .selfRef} {#name-generic-data-channel-negotia}

::: {#section-a.2.1 .section}
### [A.2.1.](#section-a.2.1){.section-number .selfRef} [Overview](#name-overview){.section-name .selfRef} {#name-overview}

DCEP negotiation only provides for negotiation of data channel transport
parameters and does not provide for negotiation of subprotocol-specific
parameters. Non-DCEP data channel negotiation can be defined to allow
negotiation of parameters beyond those handled by DCEP, e.g., parameters
specific to the subprotocol instantiated on a particular data
channel.[¶](#section-a.2.1-1){.pilcrow}

The following procedures are common to all methods of data channel
negotiation not using DCEP, whether in-band (communicated using
proprietary means on an already-established data channel) or out-of-band
(using the SDP offer/answer mechanism or some other protocol associated
with the signaling channel).[¶](#section-a.2.1-2){.pilcrow}
:::

::: {#ext_open}
::: {#section-a.2.2 .section}
### [A.2.2.](#section-a.2.2){.section-number .selfRef} [Opening a Data Channel](#name-opening-a-data-channel){.section-name .selfRef} {#name-opening-a-data-channel}

In the case of non-DCEP negotiation, the endpoint application has the
option to fully control the stream identifier assignments. However,
these assignments have to coexist with the assignments controlled by the
data channel stack for data channels negotiated using DCEP (if any). It
is the responsibility of the application to ensure consistent assignment
of stream identifiers.[¶](#section-a.2.2-1){.pilcrow}

When the application requests that the creation of a new data channel be
set up via non-DCEP negotiation, the data channel stack creates the data
channel locally without sending any DATA_CHANNEL_OPEN messages in-band.
However, even if the ICE (Interactive Connectivity Establishment), DTLS,
and SCTP procedures were already successfully completed, the application
can\'t send data on this data channel until the negotiation with the
peer is complete. This is because the peer needs to be aware of and
accept the usage of this data channel. The peer, after accepting the
data channel offer, can start sending data immediately. This implies
that the offerer may receive data channel subprotocol messages before
the negotiation is complete, and the application should be ready to
handle it.[¶](#section-a.2.2-2){.pilcrow}

If the peer rejects the data channel part of the offer, then it doesn\'t
have to do anything, as the data channel was not created using the
stack. The offerer, on the other hand, needs to close the data channel
that was opened by invoking relevant data channel stack API
procedures.[¶](#section-a.2.2-3){.pilcrow}

It is also worth noting that a data channel stack implementation may not
provide any APIs to create and close data channels; instead, the data
channels may be used on the fly as needed, just by communicating via
non-DCEP means or even by having some local configuration/assumptions on
both of the peers.[¶](#section-a.2.2-4){.pilcrow}

The application then negotiates the data channel properties and
subprotocol properties with the peer\'s application using a mechanism
different from DCEP.[¶](#section-a.2.2-5){.pilcrow}

The peer then symmetrically creates a data channel with these negotiated
data channel properties. This is the only way for the peer\'s data
channel stack to know which properties to apply when transmitting data
on this channel. The data channel stack must allow data channel creation
with any nonconflicting stream identifier so that both peers can create
the data channel with the same stream
identifier.[¶](#section-a.2.2-6){.pilcrow}
:::
:::

::: {#section-a.2.3 .section}
### [A.2.3.](#section-a.2.3){.section-number .selfRef} [Closing a Data Channel](#name-closing-a-data-channel-2){.section-name .selfRef} {#name-closing-a-data-channel-2}

When the application requests the closing of a data channel negotiated
without DCEP, the data channel stack always performs an SCTP SSN Reset
for this channel.[¶](#section-a.2.3-1){.pilcrow}

Depending upon the method used for non-DCEP negotiation and the
subprotocol associated with the data channel, the closing of the data
channel might also be signaled to the peer via SDP offer/answer
negotiation.[¶](#section-a.2.3-2){.pilcrow}
:::
:::
:::
:::
:::

::: {#acknowledgements}
::: {#section-appendix.b .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The authors wish to acknowledge the borrowing of ideas from other draft
documents by [Salvatore Loreto]{.contact-name}, [Gonzalo
Camarillo]{.contact-name}, [Peter Dunkley]{.contact-name}, and [Gavin
Llewellyn]{.contact-name}. The authors also wish to thank [Flemming
Andreasen]{.contact-name}, [Christian Groves]{.contact-name}, [Gunnar
Hellström]{.contact-name}, [Paul Kyzivat]{.contact-name}, [Jonathan
Lennox]{.contact-name}, [Uwe Rauschenbach]{.contact-name}, and [Roman
Shpount]{.contact-name} for their invaluable
comments.[¶](#section-appendix.b-1){.pilcrow}

Special thanks to [Christer Holmberg]{.contact-name} for helping finish
the document and cleaning up [Section
6](#section_procedures){.xref}.[¶](#section-appendix.b-2){.pilcrow}
:::
:::

::: {#contributors}
::: {#section-appendix.c .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

[Juergen Stoetzer-Bradler]{.contact-name} made significant contributions
to this document and should be considered a
coauthor.[¶](#section-appendix.c-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.d .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Keith Drage]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Unaffiliated]{.org}
:::

::: email
Email: <drageke@ntlworld.com>
:::

::: {.left dir="auto"}
[Maridi R. Makaraju (Raju)]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Unaffiliated]{.org}
:::

::: email
Email: <mmraju@gmail.com>
:::

::: {.left dir="auto"}
[Richard Ejzak]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Unaffiliated]{.org}
:::

::: email
Email: <richard.ejzak@gmail.com>
:::

::: {.left dir="auto"}
[Jerome Marcon]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Unaffiliated]{.org}
:::

::: email
Email: <jeromee.marcon@free.fr>
:::

::: {.left dir="auto"}
[Roni Even ([editor]{.role})]{.fn .nameRole}
:::

::: email
Email: <ron.even.tlv@gmail.com>
:::
:::
:::
