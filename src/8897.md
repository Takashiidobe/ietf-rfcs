  RFC 8897    RPKI RP Requirements   September 2020
  ----------- ---------------------- ----------------
  Ma & Kent   Informational          \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8897](https://www.rfc-editor.org/rfc/rfc8897){.eref}

Category:
:   Informational

Published:
:   September 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    D. Ma
    :::

    ::: org
    ZDNS
    :::
    :::

    ::: author
    ::: author-name
    S. Kent
    :::

    ::: org
    Independent
    :::
    :::
:::

# RFC 8897 {#rfcnum}

# Requirements for Resource Public Key Infrastructure (RPKI) Relying Parties {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document provides a single reference point for requirements for
Relying Party (RP) software for use in the Resource Public Key
Infrastructure (RPKI). It cites requirements that appear in several RPKI
RFCs, making it easier for implementers to become aware of these
requirements. Over time, this RFC will be updated to reflect changes to
the requirements and guidance specified in the RFCs discussed
herein.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Not all documents approved
by the IESG are candidates for any level of Internet Standard; see
Section 2 of RFC 7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8897>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Fetching and Caching RPKI Repository
    Objects](#name-fetching-and-caching-rpki-r){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [TAL Configuration and
        Processing](#name-tal-configuration-and-proce){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Locating RPKI Objects Using
        Authority and Subject Information
        Extensions](#name-locating-rpki-objects-using){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Dealing with Key
        Rollover](#name-dealing-with-key-rollover){.xref}[¶](#section-toc.1-1.2.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.4}
        [2.4](#section-2.4){.xref}.  [Dealing with Algorithm
        Transition](#name-dealing-with-algorithm-tran){.xref}[¶](#section-toc.1-1.2.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.5}
        [2.5](#section-2.5){.xref}.  [Strategies for Efficient Cache
        Maintenance](#name-strategies-for-efficient-ca){.xref}[¶](#section-toc.1-1.2.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Certificate and CRL
    Processing](#name-certificate-and-crl-process){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Verifying Resource Certificate and
        Syntax](#name-verifying-resource-certific){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Certificate Path
        Validation](#name-certificate-path-validation){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [CRL
        Processing](#name-crl-processing){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Processing RPKI Repository Signed
    Objects](#name-processing-rpki-repository-){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Basic Signed Object Syntax
        Checks](#name-basic-signed-object-syntax-){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Syntax and Validation for Each
        Type of Signed
        Object](#name-syntax-and-validation-for-e){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [Manifest](#name-manifest){.xref}[¶](#section-toc.1-1.4.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.2}
            [4.2.2](#section-4.2.2){.xref}.  [ROA](#name-roa){.xref}[¶](#section-toc.1-1.4.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.3}
            [4.2.3](#section-4.2.3){.xref}.  [Ghostbusters](#name-ghostbusters){.xref}[¶](#section-toc.1-1.4.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.2.2.4}
            [4.2.4](#section-4.2.4){.xref}.  [Verifying BGPsec Router
            Certificate](#name-verifying-bgpsec-router-cer){.xref}[¶](#section-toc.1-1.4.2.2.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [How to Make Use of Manifest
        Data](#name-how-to-make-use-of-manifest){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [What To Do with Ghostbusters
        Information](#name-what-to-do-with-ghostbuster){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Distributing Validated
    Cache](#name-distributing-validated-cach){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Local
    Control](#name-local-control){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

RPKI Relying Party (RP) software is used by network operators and others
to acquire and verify Internet Number Resource (INR) data stored in the
RPKI repository system. RPKI data, when verified, allows an RP to verify
assertions about which Autonomous Systems (ASes) are authorized to
originate routes for IP address prefixes. RPKI data also establishes a
binding between public keys and BGP routers and indicates the AS numbers
that each router is authorized to represent.[¶](#section-1-1){.pilcrow}

The essential requirements imposed on RP software to support secure
Internet routing \[[RFC6480](#RFC6480){.xref}\] are scattered throughout
numerous protocol-specific RFCs and Best Current Practice RFCs. The
following RFCs define these requirements:[¶](#section-1-2){.pilcrow}

-   [[RFC 6481](#RFC6481){.xref} (Repository
    Structure)[¶](#section-1-3.1){.pilcrow}]{#section-1-3.1}
-   [[RFC 6482](#RFC6482){.xref} (ROA
    format)[¶](#section-1-3.2){.pilcrow}]{#section-1-3.2}
-   [[RFC 6486](#RFC6486){.xref}
    (Manifests)[¶](#section-1-3.3){.pilcrow}]{#section-1-3.3}
-   [[RFC 6487](#RFC6487){.xref} (Certificate and CRL
    profile)[¶](#section-1-3.4){.pilcrow}]{#section-1-3.4}
-   [[RFC 6488](#RFC6488){.xref} (RPKI Signed
    Objects)[¶](#section-1-3.5){.pilcrow}]{#section-1-3.5}
-   [[RFC 6489](#RFC6489){.xref} (Key
    Rollover)[¶](#section-1-3.6){.pilcrow}]{#section-1-3.6}
-   [[RFC 6810](#RFC6810){.xref} (RPKI to Router
    Protocol)[¶](#section-1-3.7){.pilcrow}]{#section-1-3.7}
-   [[RFC 6916](#RFC6916){.xref} (Algorithm
    Agility)[¶](#section-1-3.8){.pilcrow}]{#section-1-3.8}
-   [[RFC 7935](#RFC7935){.xref}
    (Algorithms)[¶](#section-1-3.9){.pilcrow}]{#section-1-3.9}
-   [[RFC 8209](#RFC8209){.xref} (Router
    Certificates)[¶](#section-1-3.10){.pilcrow}]{#section-1-3.10}
-   [[RFC 8210](#RFC8210){.xref} (RPKI to Router Protocol, Version
    1)[¶](#section-1-3.11){.pilcrow}]{#section-1-3.11}
-   [[RFC 8360](#RFC8360){.xref} (Certificate Validation
    Procedure)[¶](#section-1-3.12){.pilcrow}]{#section-1-3.12}
-   [[RFC 8630](#RFC8630){.xref} (Trust Anchor
    Locator)[¶](#section-1-3.13){.pilcrow}]{#section-1-3.13}

The distribution of RPKI RP requirements across these 13 documents makes
it hard for an implementer to be confident that he/she has addressed all
of these requirements. Additionally, good software engineering practice
may call for segmenting the RP system into components with orthogonal
functionalities so that those components may be distributed. A taxonomy
of the collected RP software requirements can help clarify the role of
the RP.[¶](#section-1-4){.pilcrow}

To consolidate RP software requirements in one document, with pointers
to all the relevant RFCs, this document outlines a set of baseline
requirements imposed on RPs and provides a single reference point for
requirements for RP software for use in the RPKI. The requirements are
organized into four groups:[¶](#section-1-5){.pilcrow}

-   [Fetching and Caching RPKI Repository
    Objects[¶](#section-1-6.1){.pilcrow}]{#section-1-6.1}
-   [Processing Certificates and Certificate Revocation Lists
    (CRLs)[¶](#section-1-6.2){.pilcrow}]{#section-1-6.2}
-   [Processing RPKI Repository Signed
    Objects[¶](#section-1-6.3){.pilcrow}]{#section-1-6.3}
-   [Distributing Validated Cache of the RPKI
    Data[¶](#section-1-6.4){.pilcrow}]{#section-1-6.4}

This document will be updated to reflect new or changed requirements as
these RFCs are updated or additional RFCs are
written.[¶](#section-1-7){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Fetching and Caching RPKI Repository Objects](#name-fetching-and-caching-rpki-r){.section-name .selfRef} {#name-fetching-and-caching-rpki-r}

RP software uses synchronization mechanisms supported by targeted
repositories (e.g., \[[rsync](#rsync){.xref}\] or RRDP
\[[RFC8182](#RFC8182){.xref}\]) to download RPKI signed objects from the
repository system in order to update a local cache. These mechanisms
download only those objects that have been added or replaced with new
versions since the time when the RP most recently checked the
repository. RP software validates the RPKI data and uses it to generate
authenticated data identifying which ASes are authorized to originate
routes for address prefixes and which routers are authorized to sign BGP
updates on behalf of specified ASes.[¶](#section-2-1){.pilcrow}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [TAL Configuration and Processing](#name-tal-configuration-and-proce){.section-name .selfRef} {#name-tal-configuration-and-proce}

In the RPKI, each RP chooses a set of trust anchors (TAs). Consistent
with the extant INR allocation hierarchy, the IANA and/or the five
Regional Internet Registries (RIRs) are obvious candidates to be default
TAs for the RP.[¶](#section-2.1-1){.pilcrow}

An RP does not retrieve TAs directly. A set of Trust Anchor Locators
(TALs) is used by RP software to retrieve and verify the authenticity of
each TA.[¶](#section-2.1-2){.pilcrow}

TAL configuration and processing are specified in [Section
3](https://www.rfc-editor.org/rfc/rfc8630#section-3){.relref} of
\[[RFC8630](#RFC8630){.xref}\].[¶](#section-2.1-3){.pilcrow}
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Locating RPKI Objects Using Authority and Subject Information Extensions](#name-locating-rpki-objects-using){.section-name .selfRef} {#name-locating-rpki-objects-using}

The RPKI repository system is a distributed one, consisting of multiple
repository instances. Each repository instance contains one or more
repository publication points. RP software discovers publication points
using the Subject Information Access (SIA) and the Authority Information
Access (AIA) extensions from (validated)
certificates.[¶](#section-2.2-1){.pilcrow}

[Section 5](https://www.rfc-editor.org/rfc/rfc6481#section-5){.relref}
of \[[RFC6481](#RFC6481){.xref}\] specifies how RP software locates all
RPKI objects by using the SIA and AIA extensions. Detailed
specifications of SIA and AIA extensions in a resource certificate are
described in Sections
[4.8.8](https://www.rfc-editor.org/rfc/rfc6487#section-4.8.8){.relref}
and
[4.8.7](https://www.rfc-editor.org/rfc/rfc6487#section-4.8.7){.relref}
of \[[RFC6487](#RFC6487){.xref}\],
respectively.[¶](#section-2.2-2){.pilcrow}
:::

::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Dealing with Key Rollover](#name-dealing-with-key-rollover){.section-name .selfRef} {#name-dealing-with-key-rollover}

RP software takes the key rollover period into account with regard to
its frequency of synchronization with the RPKI repository
system.[¶](#section-2.3-1){.pilcrow}

RP software requirements for dealing with key rollover are described in
[Section 3](https://www.rfc-editor.org/rfc/rfc6489#section-3){.relref}
of \[[RFC6489](#RFC6489){.xref}\] and [Section
3](https://www.rfc-editor.org/rfc/rfc8634#section-3){.relref} of
\[[RFC8634](#RFC8634){.xref}\].[¶](#section-2.3-2){.pilcrow}
:::

::: {#section-2.4 .section}
### [2.4.](#section-2.4){.section-number .selfRef} [Dealing with Algorithm Transition](#name-dealing-with-algorithm-tran){.section-name .selfRef} {#name-dealing-with-algorithm-tran}

The set of cryptographic algorithms used with the RPKI is expected to
change over time. Each RP is expected to be aware of the milestones
established for the algorithm transition and what actions are required
at every juncture.[¶](#section-2.4-1){.pilcrow}

RP software requirements for dealing with algorithm transition are
specified in [Section
4](https://www.rfc-editor.org/rfc/rfc6916#section-4){.relref} of
\[[RFC6916](#RFC6916){.xref}\].[¶](#section-2.4-2){.pilcrow}
:::

::: {#section-2.5 .section}
### [2.5.](#section-2.5){.section-number .selfRef} [Strategies for Efficient Cache Maintenance](#name-strategies-for-efficient-ca){.section-name .selfRef} {#name-strategies-for-efficient-ca}

Each RP is expected to maintain a local cache of RPKI objects. The cache
needs to be brought up to date and made consistent with the repository
publication point data as frequently as allowed by repository
publication points and by locally selected RP processing
constraints.[¶](#section-2.5-1){.pilcrow}

The last paragraph of [Section
5](https://www.rfc-editor.org/rfc/rfc6481#section-5){.relref} of
\[[RFC6481](#RFC6481){.xref}\] provides guidance for maintenance of a
local cache.[¶](#section-2.5-2){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Certificate and CRL Processing](#name-certificate-and-crl-process){.section-name .selfRef} {#name-certificate-and-crl-process}

The RPKI makes use of X.509 certificates and CRLs, but it profiles the
standard formats described in \[[RFC6487](#RFC6487){.xref}\]. The major
change to the profile established in \[[RFC5280](#RFC5280){.xref}\] is
the mandatory use of a new extension in RPKI certificates, defined in
\[[RFC3779](#RFC3779){.xref}\].[¶](#section-3-1){.pilcrow}

::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Verifying Resource Certificate and Syntax](#name-verifying-resource-certific){.section-name .selfRef} {#name-verifying-resource-certific}

Certificates in the RPKI are called resource certificates, and they are
required to conform to the profile described in
\[[RFC6487](#RFC6487){.xref}\]. An RP is required to verify that a
resource certificate adheres to the profile established by [Section
4](https://www.rfc-editor.org/rfc/rfc6487#section-4){.relref} of
\[[RFC6487](#RFC6487){.xref}\]. This means that all extensions mandated
by [Section
4.8](https://www.rfc-editor.org/rfc/rfc6487#section-4.8){.relref} of
\[[RFC6487](#RFC6487){.xref}\] must be present and the value of each
extension must be within the range specified by
\[[RFC6487](#RFC6487){.xref}\]. Moreover, any extension excluded by
[Section
4.8](https://www.rfc-editor.org/rfc/rfc6487#section-4.8){.relref} of
\[[RFC6487](#RFC6487){.xref}\] must be
omitted.[¶](#section-3.1-1){.pilcrow}

[Section
7.1](https://www.rfc-editor.org/rfc/rfc6487#section-7.1){.relref} of
\[[RFC6487](#RFC6487){.xref}\] specifies the procedure that RP software
follows when verifying extensions described in
\[[RFC3779](#RFC3779){.xref}\].[¶](#section-3.1-2){.pilcrow}
:::

::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Certificate Path Validation](#name-certificate-path-validation){.section-name .selfRef} {#name-certificate-path-validation}

Initially, the INRs in the issuer\'s certificate are required to
encompass the INRs in the subject\'s certificate. This is one of the
necessary principles of certificate path validation in addition to
cryptographic verification (i.e., verification of the signature on each
certificate using the public key of the parent
certificate).[¶](#section-3.2-1){.pilcrow}

[Section
7.2](https://www.rfc-editor.org/rfc/rfc6487#section-7.2){.relref} of
\[[RFC6487](#RFC6487){.xref}\] specifies the procedure that RP software
should follow to perform certificate path
validation.[¶](#section-3.2-2){.pilcrow}

Certification Authorities (CAs) that want to reduce aspects of
operational fragility will migrate to the new OIDs
\[[RFC8360](#RFC8360){.xref}\], informing RP software to use an
alternative RPKI validation algorithm. An RP is expected to support the
amended procedure to handle accidental overclaiming, which is described
in [Section
4](https://www.rfc-editor.org/rfc/rfc8360#section-4){.relref} of
\[[RFC8360](#RFC8360){.xref}\].[¶](#section-3.2-3){.pilcrow}
:::

::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [CRL Processing](#name-crl-processing){.section-name .selfRef} {#name-crl-processing}

The CRL processing requirements imposed on CAs and RPs are described in
[Section 5](https://www.rfc-editor.org/rfc/rfc6487#section-5){.relref}
of \[[RFC6487](#RFC6487){.xref}\]. CRLs in the RPKI are tightly
constrained; only the AuthorityKeyIdentifier ([Section
4.8.3](https://www.rfc-editor.org/rfc/rfc6487#section-4.8.3){.relref} of
\[[RFC6487](#RFC6487){.xref}\]) and CRLNumber ([Section
5.2.3](https://www.rfc-editor.org/rfc/rfc5280#section-5.2.3){.relref} of
\[[RFC5280](#RFC5280){.xref}\]) extensions are allowed, and they are
required to be present. No other CRL extensions are allowed, and no
CRLEntry extensions are permitted. RP software is required to verify
that these constraints have been met. Each CRL in the RPKI must be
verified using the public key from the certificate of the CA that issued
the CRL.[¶](#section-3.3-1){.pilcrow}

In the RPKI, RPs are expected to pay extra attention when dealing with a
CRL that is not consistent with the manifest associated with the
publication point associated with the CRL.[¶](#section-3.3-2){.pilcrow}

Processing of a CRL that is not consistent with a manifest is a matter
of local policy, as described in the fifth paragraph of [Section
6.6](https://www.rfc-editor.org/rfc/rfc6486#section-6.6){.relref} of
\[[RFC6486](#RFC6486){.xref}\].[¶](#section-3.3-3){.pilcrow}
:::
:::

::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Processing RPKI Repository Signed Objects](#name-processing-rpki-repository-){.section-name .selfRef} {#name-processing-rpki-repository-}

::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Basic Signed Object Syntax Checks](#name-basic-signed-object-syntax-){.section-name .selfRef} {#name-basic-signed-object-syntax-}

Before an RP can use a signed object from the RPKI repository, RP
software is required to check the signed-object
syntax.[¶](#section-4.1-1){.pilcrow}

[Section 3](https://www.rfc-editor.org/rfc/rfc6488#section-3){.relref}
of \[[RFC6488](#RFC6488){.xref}\] lists all the steps that RP software
is required to execute in order to validate the top-level syntax of a
repository signed object.[¶](#section-4.1-2){.pilcrow}

Note that these checks are necessary but not sufficient. Additional
validation checks must be performed based on the specific type of signed
object, as described in [Section
4.2](#syntax){.xref}.[¶](#section-4.1-3){.pilcrow}
:::

::: {#syntax}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Syntax and Validation for Each Type of Signed Object](#name-syntax-and-validation-for-e){.section-name .selfRef} {#name-syntax-and-validation-for-e}

::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [Manifest](#name-manifest){.section-name .selfRef} {#name-manifest}

To determine whether a manifest is valid, RP software is required to
perform manifest-specific checks in addition to the generic
signed-object checks specified in
\[[RFC6488](#RFC6488){.xref}\].[¶](#section-4.2.1-1){.pilcrow}

Specific checks for a manifest are described in [Section
4](https://www.rfc-editor.org/rfc/rfc6486#section-4){.relref} of
\[[RFC6486](#RFC6486){.xref}\]. If any of these checks fail, indicating
that the manifest is invalid, then the manifest will be discarded, and
RP software will act as though no manifest were
present.[¶](#section-4.2.1-2){.pilcrow}
:::

::: {#section-4.2.2 .section}
#### [4.2.2.](#section-4.2.2){.section-number .selfRef} [ROA](#name-roa){.section-name .selfRef} {#name-roa}

To validate a Route Origin Authorization (ROA), RP software is required
to perform all the checks specified in \[[RFC6488](#RFC6488){.xref}\] as
well as additional, ROA-specific validation steps. The IP Address
Delegation extension \[[RFC3779](#RFC3779){.xref}\] present in the
end-entity (EE) certificate (contained within the ROA) must encompass
each of the IP address prefix(es) in the
ROA.[¶](#section-4.2.2-1){.pilcrow}

More details for ROA validation are specified in [Section
4](https://www.rfc-editor.org/rfc/rfc6482#section-4){.relref} of
\[[RFC6482](#RFC6482){.xref}\].[¶](#section-4.2.2-2){.pilcrow}
:::

::: {#section-4.2.3 .section}
#### [4.2.3.](#section-4.2.3){.section-number .selfRef} [Ghostbusters](#name-ghostbusters){.section-name .selfRef} {#name-ghostbusters}

The Ghostbusters Record is optional; a publication point in the RPKI can
have zero or more associated Ghostbusters Records. If a CA has at least
one Ghostbusters Record, RP software is required to verify that this
Ghostbusters Record conforms to the syntax of signed objects defined in
\[[RFC6488](#RFC6488){.xref}\].[¶](#section-4.2.3-1){.pilcrow}

The payload of this signed object is a (severely) profiled vCard. RP
software is required to verify that the payload of Ghostbusters conforms
to format as profiled in
\[[RFC6493](#RFC6493){.xref}\].[¶](#section-4.2.3-2){.pilcrow}
:::

::: {#section-4.2.4 .section}
#### [4.2.4.](#section-4.2.4){.section-number .selfRef} [Verifying BGPsec Router Certificate](#name-verifying-bgpsec-router-cer){.section-name .selfRef} {#name-verifying-bgpsec-router-cer}

A BGPsec Router Certificate is a resource certificate, so it is required
to comply with \[[RFC6487](#RFC6487){.xref}\]. Additionally, the
certificate must contain an AS Identifier Delegation extension ([Section
4.8.11](https://www.rfc-editor.org/rfc/rfc6487#section-4.8.11){.relref}
of \[[RFC6487](#RFC6487){.xref}\]) and must not contain an IP Address
Delegation extension ([Section
4.8.10](https://www.rfc-editor.org/rfc/rfc6487#section-4.8.10){.relref}
of \[[RFC6487](#RFC6487){.xref}\]). The validation procedure used for
BGPsec Router Certificates is analogous to the validation procedure
described in [Section
7](https://www.rfc-editor.org/rfc/rfc6487#section-7){.relref} of
\[[RFC6487](#RFC6487){.xref}\], but it uses the constraints defined in
[Section 3](https://www.rfc-editor.org/rfc/rfc8209#section-3){.relref}
of \[[RFC8209](#RFC8209){.xref}\].[¶](#section-4.2.4-1){.pilcrow}

Note that the cryptographic algorithms used by BGPsec routers are found
in \[[RFC8608](#RFC8608){.xref}\]. Currently, the algorithms specified
in \[[RFC8608](#RFC8608){.xref}\] and \[[RFC7935](#RFC7935){.xref}\] are
different. BGPsec RP software will need to support algorithms that are
used to validate BGPsec signatures as well as the algorithms that are
needed to validate signatures on BGPsec certificates, RPKI CA
certificates, and RPKI CRLs.[¶](#section-4.2.4-2){.pilcrow}
:::
:::
:::

::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [How to Make Use of Manifest Data](#name-how-to-make-use-of-manifest){.section-name .selfRef} {#name-how-to-make-use-of-manifest}

For a given publication point, RP software ought to perform tests, as
specified in [Section
6.1](https://www.rfc-editor.org/rfc/rfc6486#section-6.1){.relref} of
\[[RFC6486](#RFC6486){.xref}\], to determine the state of the manifest
at the publication point. A manifest can be classified as either valid
or invalid, and a valid manifest is either current or stale. An RP
decides how to make use of a manifest based on its state, according to
local (RP) policy.[¶](#section-4.3-1){.pilcrow}

If there are valid objects in a publication point that are not present
on a manifest, \[[RFC6486](#RFC6486){.xref}\] does not mandate specific
RP behavior with respect to such objects.[¶](#section-4.3-2){.pilcrow}

In the absence of a manifest, an RP is expected to accept all valid
signed objects present in the publication point (see [Section
6.2](https://www.rfc-editor.org/rfc/rfc6486#section-6.2){.relref} of
\[[RFC6486](#RFC6486){.xref}\]). If a manifest is stale or invalid and
an RP has no way to acquire a more recent valid manifest, the RP is
expected to contact the repository manager via Ghostbusters Records and
thereafter make decisions according to local (RP) policy (see Sections
[6.3](https://www.rfc-editor.org/rfc/rfc6486#section-6.3){.relref} and
[6.4](https://www.rfc-editor.org/rfc/rfc6486#section-6.4){.relref} of
\[[RFC6486](#RFC6486){.xref}\]).[¶](#section-4.3-3){.pilcrow}
:::

::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [What To Do with Ghostbusters Information](#name-what-to-do-with-ghostbuster){.section-name .selfRef} {#name-what-to-do-with-ghostbuster}

RP software may encounter a stale manifest or CRL, or an expired CA
certificate or ROA at a publication point. An RP is expected to use the
information from the Ghostbusters Records to contact the maintainer of
the publication point where any stale/expired objects were encountered.
The intent here is to encourage the relevant CA and/or repository
manager to update the stale or expired
objects.[¶](#section-4.4-1){.pilcrow}
:::
:::

::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Distributing Validated Cache](#name-distributing-validated-cach){.section-name .selfRef} {#name-distributing-validated-cach}

On a periodic basis, BGP speakers within an AS request updated validated
origin AS data and router/ASN data from the (local) validated cache of
RPKI data. The RP may either transfer the validated data to the BGP
speakers directly, or it may transfer the validated data to a cache
server that is responsible for provisioning such data to BGP speakers.
The specifications of the protocol designed to deliver validated cache
data to a BGP Speaker are provided in \[[RFC6810](#RFC6810){.xref}\] and
\[[RFC8210](#RFC8210){.xref}\].[¶](#section-5-1){.pilcrow}
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Local Control](#name-local-control){.section-name .selfRef} {#name-local-control}

ISPs may want to establish a local view of exceptions to the RPKI data
in the form of local filters and additions. For instance, a network
operator might wish to make use of a local override capability to
protect routes from adverse actions \[[RFC8211](#RFC8211){.xref}\]. The
mechanisms developed to provide this capability to network operators are
called Simplified Local Internet Number Resource Management with the
RPKI (SLURM). If an ISP wants to implement SLURM, its RP system can
follow the instruction specified in
\[[RFC8416](#RFC8416){.xref}\].[¶](#section-6-1){.pilcrow}
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document does not introduce any new security considerations; it is
a resource for implementers. The RP links the RPKI provisioning side and
the routing system, establishing a verified, local view of global RPKI
data to BGP speakers. The security of the RP is critical for exchanging
BGP messages. Each RP implementation is expected to offer cache backup
management to facilitate recovery from outages. RP software should also
support secure transport (e.g., IPsec \[[RFC4301](#RFC4301){.xref}\])
that can protect validated cache delivery in an unsafe environment. This
document highlights many validation actions applied to RPKI signed
objects, an essential element of secure operation of RPKI
security.[¶](#section-7-1){.pilcrow}
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-8-1){.pilcrow}
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC3779\]
:   [Lynn, C.]{.refAuthor}[, Kent, S.]{.refAuthor}[, and K.
    Seo]{.refAuthor}, [\"X.509 Extensions for IP Addresses and AS
    Identifiers\"]{.refTitle}, [RFC 3779]{.seriesInfo}, [DOI
    10.17487/RFC3779]{.seriesInfo}, June 2004,
    \<<https://www.rfc-editor.org/info/rfc3779>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}[, Santesson, S.]{.refAuthor}[,
    Farrell, S.]{.refAuthor}[, Boeyen, S.]{.refAuthor}[,
    Housley, R.]{.refAuthor}[, and W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC6481\]
:   [Huston, G.]{.refAuthor}[, Loomans, R.]{.refAuthor}[, and G.
    Michaelson]{.refAuthor}, [\"A Profile for Resource Certificate
    Repository Structure\"]{.refTitle}, [RFC 6481]{.seriesInfo}, [DOI
    10.17487/RFC6481]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6481>\>.
:   

\[RFC6482\]
:   [Lepinski, M.]{.refAuthor}[, Kent, S.]{.refAuthor}[, and D.
    Kong]{.refAuthor}, [\"A Profile for Route Origin Authorizations
    (ROAs)\"]{.refTitle}, [RFC 6482]{.seriesInfo}, [DOI
    10.17487/RFC6482]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6482>\>.
:   

\[RFC6486\]
:   [Austein, R.]{.refAuthor}[, Huston, G.]{.refAuthor}[,
    Kent, S.]{.refAuthor}[, and M. Lepinski]{.refAuthor}, [\"Manifests
    for the Resource Public Key Infrastructure (RPKI)\"]{.refTitle},
    [RFC 6486]{.seriesInfo}, [DOI 10.17487/RFC6486]{.seriesInfo},
    February 2012, \<<https://www.rfc-editor.org/info/rfc6486>\>.
:   

\[RFC6487\]
:   [Huston, G.]{.refAuthor}[, Michaelson, G.]{.refAuthor}[, and R.
    Loomans]{.refAuthor}, [\"A Profile for X.509 PKIX Resource
    Certificates\"]{.refTitle}, [RFC 6487]{.seriesInfo}, [DOI
    10.17487/RFC6487]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6487>\>.
:   

\[RFC6488\]
:   [Lepinski, M.]{.refAuthor}[, Chi, A.]{.refAuthor}[, and S.
    Kent]{.refAuthor}, [\"Signed Object Template for the Resource Public
    Key Infrastructure (RPKI)\"]{.refTitle}, [RFC 6488]{.seriesInfo},
    [DOI 10.17487/RFC6488]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6488>\>.
:   

\[RFC6489\]
:   [Huston, G.]{.refAuthor}[, Michaelson, G.]{.refAuthor}[, and S.
    Kent]{.refAuthor}, [\"Certification Authority (CA) Key Rollover in
    the Resource Public Key Infrastructure (RPKI)\"]{.refTitle}, [BCP
    174]{.seriesInfo}, [RFC 6489]{.seriesInfo}, [DOI
    10.17487/RFC6489]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6489>\>.
:   

\[RFC6493\]
:   [Bush, R.]{.refAuthor}, [\"The Resource Public Key Infrastructure
    (RPKI) Ghostbusters Record\"]{.refTitle}, [RFC 6493]{.seriesInfo},
    [DOI 10.17487/RFC6493]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6493>\>.
:   

\[RFC6810\]
:   [Bush, R.]{.refAuthor}[ and R. Austein]{.refAuthor}, [\"The Resource
    Public Key Infrastructure (RPKI) to Router Protocol\"]{.refTitle},
    [RFC 6810]{.seriesInfo}, [DOI 10.17487/RFC6810]{.seriesInfo},
    January 2013, \<<https://www.rfc-editor.org/info/rfc6810>\>.
:   

\[RFC6916\]
:   [Gagliano, R.]{.refAuthor}[, Kent, S.]{.refAuthor}[, and S.
    Turner]{.refAuthor}, [\"Algorithm Agility Procedure for the Resource
    Public Key Infrastructure (RPKI)\"]{.refTitle}, [BCP
    182]{.seriesInfo}, [RFC 6916]{.seriesInfo}, [DOI
    10.17487/RFC6916]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6916>\>.
:   

\[RFC7935\]
:   [Huston, G.]{.refAuthor}[ and G. Michaelson, Ed.]{.refAuthor},
    [\"The Profile for Algorithms and Key Sizes for Use in the Resource
    Public Key Infrastructure\"]{.refTitle}, [RFC 7935]{.seriesInfo},
    [DOI 10.17487/RFC7935]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7935>\>.
:   

\[RFC8209\]
:   [Reynolds, M.]{.refAuthor}[, Turner, S.]{.refAuthor}[, and S.
    Kent]{.refAuthor}, [\"A Profile for BGPsec Router Certificates,
    Certificate Revocation Lists, and Certification
    Requests\"]{.refTitle}, [RFC 8209]{.seriesInfo}, [DOI
    10.17487/RFC8209]{.seriesInfo}, September 2017,
    \<<https://www.rfc-editor.org/info/rfc8209>\>.
:   

\[RFC8210\]
:   [Bush, R.]{.refAuthor}[ and R. Austein]{.refAuthor}, [\"The Resource
    Public Key Infrastructure (RPKI) to Router Protocol, Version
    1\"]{.refTitle}, [RFC 8210]{.seriesInfo}, [DOI
    10.17487/RFC8210]{.seriesInfo}, September 2017,
    \<<https://www.rfc-editor.org/info/rfc8210>\>.
:   

\[RFC8360\]
:   [Huston, G.]{.refAuthor}[, Michaelson, G.]{.refAuthor}[,
    Martinez, C.]{.refAuthor}[, Bruijnzeels, T.]{.refAuthor}[,
    Newton, A.]{.refAuthor}[, and D. Shaw]{.refAuthor}, [\"Resource
    Public Key Infrastructure (RPKI) Validation
    Reconsidered\"]{.refTitle}, [RFC 8360]{.seriesInfo}, [DOI
    10.17487/RFC8360]{.seriesInfo}, April 2018,
    \<<https://www.rfc-editor.org/info/rfc8360>\>.
:   

\[RFC8608\]
:   [Turner, S.]{.refAuthor}[ and O. Borchert]{.refAuthor}, [\"BGPsec
    Algorithms, Key Formats, and Signature Formats\"]{.refTitle}, [RFC
    8608]{.seriesInfo}, [DOI 10.17487/RFC8608]{.seriesInfo}, June 2019,
    \<<https://www.rfc-editor.org/info/rfc8608>\>.
:   

\[RFC8630\]
:   [Huston, G.]{.refAuthor}[, Weiler, S.]{.refAuthor}[,
    Michaelson, G.]{.refAuthor}[, Kent, S.]{.refAuthor}[, and T.
    Bruijnzeels]{.refAuthor}, [\"Resource Public Key Infrastructure
    (RPKI) Trust Anchor Locator\"]{.refTitle}, [RFC 8630]{.seriesInfo},
    [DOI 10.17487/RFC8630]{.seriesInfo}, August 2019,
    \<<https://www.rfc-editor.org/info/rfc8630>\>.
:   

\[RFC8634\]
:   [Weis, B.]{.refAuthor}[, Gagliano, R.]{.refAuthor}[, and K.
    Patel]{.refAuthor}, [\"BGPsec Router Certificate
    Rollover\"]{.refTitle}, [BCP 224]{.seriesInfo}, [RFC
    8634]{.seriesInfo}, [DOI 10.17487/RFC8634]{.seriesInfo}, August
    2019, \<<https://www.rfc-editor.org/info/rfc8634>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC4301\]
:   [Kent, S.]{.refAuthor}[ and K. Seo]{.refAuthor}, [\"Security
    Architecture for the Internet Protocol\"]{.refTitle}, [RFC
    4301]{.seriesInfo}, [DOI 10.17487/RFC4301]{.seriesInfo}, December
    2005, \<<https://www.rfc-editor.org/info/rfc4301>\>.
:   

\[RFC6480\]
:   [Lepinski, M.]{.refAuthor}[ and S. Kent]{.refAuthor}, [\"An
    Infrastructure to Support Secure Internet Routing\"]{.refTitle},
    [RFC 6480]{.seriesInfo}, [DOI 10.17487/RFC6480]{.seriesInfo},
    February 2012, \<<https://www.rfc-editor.org/info/rfc6480>\>.
:   

\[RFC8182\]
:   [Bruijnzeels, T.]{.refAuthor}[, Muravskiy, O.]{.refAuthor}[,
    Weber, B.]{.refAuthor}[, and R. Austein]{.refAuthor}, [\"The RPKI
    Repository Delta Protocol (RRDP)\"]{.refTitle}, [RFC
    8182]{.seriesInfo}, [DOI 10.17487/RFC8182]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8182>\>.
:   

\[RFC8211\]
:   [Kent, S.]{.refAuthor}[ and D. Ma]{.refAuthor}, [\"Adverse Actions
    by a Certification Authority (CA) or Repository Manager in the
    Resource Public Key Infrastructure (RPKI)\"]{.refTitle}, [RFC
    8211]{.seriesInfo}, [DOI 10.17487/RFC8211]{.seriesInfo}, September
    2017, \<<https://www.rfc-editor.org/info/rfc8211>\>.
:   

\[RFC8416\]
:   [Ma, D.]{.refAuthor}[, Mandelberg, D.]{.refAuthor}[, and T.
    Bruijnzeels]{.refAuthor}, [\"Simplified Local Internet Number
    Resource Management with the RPKI (SLURM)\"]{.refTitle}, [RFC
    8416]{.seriesInfo}, [DOI 10.17487/RFC8416]{.seriesInfo}, August
    2018, \<<https://www.rfc-editor.org/info/rfc8416>\>.
:   

\[rsync\]
:   [\"rsync\"]{.refTitle},
    \<[http://rsync.samba.org/](https://rsync.samba.org/)\>.
:   
:::
:::

::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The authors thank [David Mandelberg]{.contact-name}, [Wei
Wang]{.contact-name}, [Tim Bruijnzeels]{.contact-name}, [George
Michaelson]{.contact-name}, and [Oleg Muravskiy]{.contact-name} for
their review, feedback, and editorial assistance in preparing this
document.[¶](#section-appendix.a-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Di Ma]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ZDNS]{.org}
:::

::: {.left dir="auto"}
[4 South 4th St. Zhongguancun]{.street-address}
:::

::: {.left dir="auto"}
[Haidian]{.locality}
:::

::: {.left dir="auto"}
[Beijing]{.region}, [100190]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <madi@zdns.cn>
:::

::: {.left dir="auto"}
[Stephen Kent]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Independent]{.org}
:::

::: email
Email: <kent@alum.mit.edu>
:::
:::
:::
