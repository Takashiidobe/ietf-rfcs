  RFC 8830     MSID in SDP       January 2021
  ------------ ----------------- --------------
  Alvestrand   Standards Track   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8830](https://www.rfc-editor.org/rfc/rfc8830){.eref}

Category:
:   Standards Track

Published:
:   January 2021

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    H. Alvestrand
    :::

    ::: org
    Google
    :::
    :::
:::

# RFC 8830 {#rfcnum}

# WebRTC MediaStream Identification in the Session Description Protocol {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies a Session Description Protocol (SDP) grouping
mechanism for RTP media streams that can be used to specify relations
between media streams.[¶](#section-abstract-1){.pilcrow}

This mechanism is used to signal the association between the SDP concept
of \"media description\" and the Web Real-Time Communication (WebRTC)
concept of MediaStream/MediaStreamTrack using SDP
signaling.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8830>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.1.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Structure of This
        Document](#name-structure-of-this-document){.xref}[¶](#section-toc.1-1.1.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.3}
        [1.3](#section-1.3){.xref}.  [Why a New Mechanism Is
        Needed](#name-why-a-new-mechanism-is-need){.xref}[¶](#section-toc.1-1.1.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.1.2.4}
        [1.4](#section-1.4){.xref}.  [The WebRTC
        MediaStream](#name-the-webrtc-mediastream){.xref}[¶](#section-toc.1-1.1.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [The MSID
    Mechanism](#name-the-msid-mechanism){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Procedures](#name-procedures){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Handling of Nonsignaled
        Tracks](#name-handling-of-nonsignaled-tra){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Detailed Offer/Answer
        Procedures](#name-detailed-offer-answer-proce){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [Generating the Initial
            Offer](#name-generating-the-initial-offe){.xref}[¶](#section-toc.1-1.3.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.xref}.  [Answerer Processing of the
            Offer](#name-answerer-processing-of-the-){.xref}[¶](#section-toc.1-1.3.2.2.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.3}
            [3.2.3](#section-3.2.3){.xref}.  [Generating the
            Answer](#name-generating-the-answer){.xref}[¶](#section-toc.1-1.3.2.2.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.4}
            [3.2.4](#section-3.2.4){.xref}.  [Offerer Processing of the
            Answer](#name-offerer-processing-of-the-a){.xref}[¶](#section-toc.1-1.3.2.2.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.5}
            [3.2.5](#section-3.2.5){.xref}.  [Modifying the
            Session](#name-modifying-the-session){.xref}[¶](#section-toc.1-1.3.2.2.2.5.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Example SDP
        Description](#name-example-sdp-description){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Attribute Registration in Existing
        Registries](#name-attribute-registration-in-e){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [Appendix A](#section-appendix.a){.xref}.  [Design Considerations,
    Rejected
    Alternatives](#name-design-considerations-rejec){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.8}
    [](#section-appendix.b){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [](#section-appendix.c){.xref}[Author\'s
    Address](#name-authors-address){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

This document uses terminology from \[[RFC8825](#RFC8825){.xref}\]. In
addition, the following terms are used as described
below:[¶](#section-1.1-1){.pilcrow}

[]{.break}

RTP stream:
:   A stream of RTP packets containing media data
    \[[RFC7656](#RFC7656){.xref}\].[¶](#section-1.1-2.2){.pilcrow}
:   

MediaStream:
:   An assembly of MediaStreamTracks
    \[[W3C.CR-mediacapture-streams](#W3C.CR-mediacapture-streams){.xref}\].
    One MediaStream can contain multiple MediaStreamTracks, of the same
    or different types.[¶](#section-1.1-2.4){.pilcrow}
:   

MediaStreamTrack:
:   Defined in
    \[[W3C.CR-mediacapture-streams](#W3C.CR-mediacapture-streams){.xref}\]
    as a unidirectional flow of media data (either audio or video, but
    not both). Corresponds to the \[[RFC7656](#RFC7656){.xref}\] term
    \"source stream\". One MediaStreamTrack can be present in zero, one,
    or multiple MediaStreams.[¶](#section-1.1-2.6){.pilcrow}
:   

Media description:
:   Defined in \[[RFC4566](#RFC4566){.xref}\] as a set of fields
    starting with an \"m=\" field and terminated by either the next
    \"m=\" field or the end of the session
    description.[¶](#section-1.1-2.8){.pilcrow}
:   

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-3){.pilcrow}
:::

::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Structure of This Document](#name-structure-of-this-document){.section-name .selfRef} {#name-structure-of-this-document}

This document adds a new Session Description Protocol (SDP)
\[[RFC4566](#RFC4566){.xref}\] mechanism that can attach identifiers to
the RTP streams and attach identifiers to the groupings they form. It is
designed for use with WebRTC
\[[RFC8825](#RFC8825){.xref}\].[¶](#section-1.2-1){.pilcrow}

[Section 1.3](#sect-why){.xref} gives the background on why a new
mechanism is needed.[¶](#section-1.2-2){.pilcrow}

[Section 2](#sect-definition){.xref} gives the definition of the new
mechanism.[¶](#section-1.2-3){.pilcrow}

[Section 3](#sect-media-stream){.xref} gives the necessary semantic
information and procedures for using the \"msid\" attribute to signal
the association of MediaStreamTracks to MediaStreams in support of the
WebRTC API
\[[W3C-WebRTC](#W3C-WebRTC){.xref}\].[¶](#section-1.2-4){.pilcrow}
:::

::: {#sect-why}
::: {#section-1.3 .section}
### [1.3.](#section-1.3){.section-number .selfRef} [Why a New Mechanism Is Needed](#name-why-a-new-mechanism-is-need){.section-name .selfRef} {#name-why-a-new-mechanism-is-need}

When media is carried by RTP \[[RFC3550](#RFC3550){.xref}\], each RTP
stream is distinguished inside an RTP session by its Synchronization
Source (SSRC); each RTP session is distinguished from all other RTP
sessions by being on a different transport association (strictly
speaking, two transport associations, one used for RTP and one used for
the RTP Control Protocol (RTCP), unless RTP/RTCP multiplexing
\[[RFC5761](#RFC5761){.xref}\] is used).[¶](#section-1.3-1){.pilcrow}

SDP \[[RFC4566](#RFC4566){.xref}\] gives a format for describing an SDP
session that can contain multiple media descriptions. According to the
model used in \[[RFC8829](#RFC8829){.xref}\], each media description
describes exactly one media source. If multiple media sources are
carried in an RTP session, this is signaled using BUNDLE
\[[RFC8843](#RFC8843){.xref}\]; if BUNDLE is not used, each media source
is carried in its own RTP session.[¶](#section-1.3-2){.pilcrow}

The SDP Grouping Framework \[[RFC5888](#RFC5888){.xref}\] can be used to
group media descriptions. However, for the use case of WebRTC, there is
the need for an application to specify some application-level
information about the association between the media description and the
group. This is not possible using the SDP Grouping
Framework.[¶](#section-1.3-3){.pilcrow}
:::
:::

::: {#section-1.4 .section}
### [1.4.](#section-1.4){.section-number .selfRef} [The WebRTC MediaStream](#name-the-webrtc-mediastream){.section-name .selfRef} {#name-the-webrtc-mediastream}

The W3C WebRTC API specification \[[W3C-WebRTC](#W3C-WebRTC){.xref}\]
specifies that communication between WebRTC entities is done via
MediaStreams, which contain MediaStreamTracks. A MediaStreamTrack is
generally carried using a single SSRC in an RTP session, forming an RTP
stream. The collision of terminology is unfortunate. There might
possibly be additional SSRCs, possibly within additional RTP sessions,
in order to support functionality like forward error correction or
simulcast. These additional SSRCs are not affected by this
specification.[¶](#section-1.4-1){.pilcrow}

MediaStreamTracks are unidirectional; they carry media in one direction
only.[¶](#section-1.4-2){.pilcrow}

In the RTP specification, RTP streams are identified using the SSRC
field. Streams are grouped into RTP sessions and also carry a CNAME.
Neither CNAME nor RTP session corresponds to a MediaStream. Therefore,
the association of an RTP stream to MediaStreams need to be explicitly
signaled.[¶](#section-1.4-3){.pilcrow}

WebRTC defines a mapping (documented in \[[RFC8829](#RFC8829){.xref}\])
where one SDP media description is used to describe each
MediaStreamTrack, and the BUNDLE mechanism
\[[RFC8843](#RFC8843){.xref}\] is used to group MediaStreamTracks into
RTP sessions. Therefore, the need is to specify the identifier (ID) of
the MediaStreamTrack and its associated MediaStream for each media
description, which can be accomplished with a media-level SDP
attribute.[¶](#section-1.4-4){.pilcrow}

This usage is described in [Section
3](#sect-media-stream){.xref}.[¶](#section-1.4-5){.pilcrow}
:::
:::

::: {#sect-definition}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [The MSID Mechanism](#name-the-msid-mechanism){.section-name .selfRef} {#name-the-msid-mechanism}

This document defines a new SDP \[[RFC4566](#RFC4566){.xref}\]
media-level \"msid\" attribute. This new attribute allows endpoints to
associate RTP streams that are described in separate media descriptions
with the right MediaStreams, as defined in
\[[W3C-WebRTC](#W3C-WebRTC){.xref}\]. It also allows endpoints to carry
an identifier for each MediaStreamTrack in its \"appdata\"
field.[¶](#section-2-1){.pilcrow}

The value of the \"msid\" attribute consists of an identifier and an
optional \"appdata\" field.[¶](#section-2-2){.pilcrow}

The name of the attribute is \"msid\".[¶](#section-2-3){.pilcrow}

The value of the attribute is specified by the following ABNF
\[[RFC5234](#RFC5234){.xref}\] grammar:[¶](#section-2-4){.pilcrow}

::: {#section-2-5}
``` {.sourcecode .lang-abnf}
  msid-value = msid-id [ SP msid-appdata ]
  msid-id = 1*64token-char ; see RFC 4566
  msid-appdata = 1*64token-char  ; see RFC 4566
```

[¶](#section-2-5){.pilcrow}
:::

An example \"msid\" value for a group with the identifier \"examplefoo\"
and application data \"examplebar\" might look like
this:[¶](#section-2-6){.pilcrow}

::: {#section-2-7}
``` sourcecode
  msid:examplefoo examplebar
```

[¶](#section-2-7){.pilcrow}
:::

The identifier is a string of ASCII characters that are legal in a
\"token\", consisting of between 1 and 64
characters.[¶](#section-2-8){.pilcrow}

Application data (msid-appdata) is carried on the same line as the
identifier, separated from the identifier by a
space.[¶](#section-2-9){.pilcrow}

The identifier (\"msid-id\") uniquely identifies a group within the
scope of an SDP description.[¶](#section-2-10){.pilcrow}

There may be multiple \"msid\" attributes in a single media description.
This represents the case where a single MediaStreamTrack is present in
multiple MediaStreams; the value of \"msid-appdata\" [MUST]{.bcp14} be
identical for all occurrences.[¶](#section-2-11){.pilcrow}

Multiple media descriptions with the same value for \"msid-id\" and
\"msid‑appdata\" are not permitted.[¶](#section-2-12){.pilcrow}

Endpoints can update the associations between RTP streams as expressed
by \"msid\" attributes at any time.[¶](#section-2-13){.pilcrow}

The \"msid\" attributes depend on the association of RTP streams with
media descriptions but do not depend on the association of RTP streams
with RTP transports. Therefore, their Mux Category (as defined in
\[[RFC8859](#RFC8859){.xref}\]) is NORMAL; the process of deciding on
\"msid\" attributes doesn\'t have to take into consideration whether or
not the RTP streams are bundled.[¶](#section-2-14){.pilcrow}
:::
:::

::: {#sect-media-stream}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Procedures](#name-procedures){.section-name .selfRef} {#name-procedures}

This section describes the procedures for associating media descriptions
representing MediaStreamTracks within MediaStreams, as defined in
\[[W3C-WebRTC](#W3C-WebRTC){.xref}\].[¶](#section-3-1){.pilcrow}

In the Javascript API described in that specification, each MediaStream
and MediaStreamTrack has an \"id\" attribute, which is a
DOMString.[¶](#section-3-2){.pilcrow}

The value of the \"msid-id\" field in the MSID consists of the \"id\"
attribute of a MediaStream, as defined in the MediaStream\'s WebIDL
specification \[[WEBIDL](#WEBIDL){.xref}\]. The special value \"-\"
indicates \"no MediaStream\".[¶](#section-3-3){.pilcrow}

The value of the \"msid-appdata\" field in the MSID, if present,
consists of the \"id\" attribute of a MediaStreamTrack, as defined in
the MediaStreamTrack\'s WebIDL specification.[¶](#section-3-4){.pilcrow}

When an SDP session description is updated, a specific \"msid-id\" value
continues to refer to the same MediaStream, and a specific
\"msid-appdata\" to the same MediaStreamTrack. There is no memory apart
from the currently valid SDP descriptions; if an MSID \"identifier\"
value disappears from the SDP and appears in a later negotiation, it
will be taken to refer to a new MediaStream.[¶](#section-3-5){.pilcrow}

If the \"msid\" attribute does not conform to the ABNF given here, it
[SHOULD]{.bcp14} be ignored.[¶](#section-3-6){.pilcrow}

The following is a high-level description of the rules for handling SDP
updates. Detailed procedures are located in [Section
3.2](#s-detailed-procedures){.xref}.[¶](#section-3-7){.pilcrow}

-   [When a new MSID \"identifier\" value occurs in a session
    description, and it is not \"-\", the recipient can signal to its
    application that a new MediaStream has been
    added.[¶](#section-3-8.1){.pilcrow}]{#section-3-8.1}
-   [When a session description is updated to have media descriptions
    with an MSID \"identifier\" value, with one or more different
    \"appdata\" values, the recipient can signal to its application that
    new MediaStreamTracks have been added and note to which MediaStream
    they have been added. This is done for each different MSID
    \"identifier\" value, including the special value \"-\", which
    indicates that a MediaStreamTrack has been added with no
    corresponding
    MediaStream.[¶](#section-3-8.2){.pilcrow}]{#section-3-8.2}
-   [If an MSID \"identifier\" value with no \"appdata\" value appears,
    it means that the sender did not inform the recipient of the desired
    identifier of the MediaStreamTrack, and the recipient will assign
    the \"id\" value of the created MediaStreamTrack on its own. All
    MSIDs in a media section that do not have an \"appdata\" value are
    assumed to refer to the same
    MediaStreamTrack.[¶](#section-3-8.3){.pilcrow}]{#section-3-8.3}
-   [When a session description is updated to no longer list any
    \"msid\" attribute on a specific media description, the recipient
    can signal to its application that the corresponding
    MediaStreamTrack has
    ended.[¶](#section-3-8.4){.pilcrow}]{#section-3-8.4}

In addition to signaling that the track is ended when its \"msid\"
attribute disappears from the SDP, the track will also be signaled as
being ended when all associated SSRCs have disappeared by the rules of
\[[RFC3550](#RFC3550){.xref}\], Sections
[6.3.4](https://www.rfc-editor.org/rfc/rfc3550#section-6.3.4){.relref}
(BYE packet received) and
[6.3.5](https://www.rfc-editor.org/rfc/rfc3550#section-6.3.5){.relref}
(timeout), or when the corresponding media description is disabled by
setting the port number to zero. Changing the direction of the media
description (by setting \"sendonly\", \"recvonly\", or \"inactive\"
attributes) will not end the
MediaStreamTrack.[¶](#section-3-9){.pilcrow}

The association between SSRCs and media descriptions is specified in
\[[RFC8829](#RFC8829){.xref}\].[¶](#section-3-10){.pilcrow}

::: {#s-nonsignal}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Handling of Nonsignaled Tracks](#name-handling-of-nonsignaled-tra){.section-name .selfRef} {#name-handling-of-nonsignaled-tra}

Entities that do not use the mechanism described in this document will
not send the \"msid\" attribute and thus will not send information
allowing the mapping of RTP packets to MediaStreams. This means that
there will be some incoming RTP packets for which the recipient has no
predefined MediaStream ID value.[¶](#section-3.1-1){.pilcrow}

Note that the handling described below is triggered by incoming RTP
packets, not SDP negotiation.[¶](#section-3.1-2){.pilcrow}

When communicating with entities that use the MSID mechanism, the only
time incoming RTP packets can be received without an associated
MediaStream ID value is when, after the initial negotiation, a
negotiation is performed where the answerer adds a MediaStreamTrack to
an already established connection and starts sending data before the
answer is received by the offerer. For initial negotiation, packets
won\'t flow until the Interactive Connectivity Establishment (ICE)
candidates and fingerprints have been exchanged, so this is not an
issue.[¶](#section-3.1-3){.pilcrow}

The recipient of those packets will perform the following
steps:[¶](#section-3.1-4){.pilcrow}

-   [When RTP packets are initially received, it will create an
    appropriate MediaStreamTrack based on the type of the media (carried
    in PayloadType) and use the MID RTP header extension
    \[[RFC8843](#RFC8843){.xref}\] (if present) to associate the RTP
    packets with a specific media
    section.[¶](#section-3.1-5.1){.pilcrow}]{#section-3.1-5.1}
-   [If the connection is not in the RTCSignalingState \"stable\", it
    will wait at this
    point.[¶](#section-3.1-5.2){.pilcrow}]{#section-3.1-5.2}
-   [When the connection is in the RTCSignalingState \"stable\", it will
    assign ID values.[¶](#section-3.1-5.3){.pilcrow}]{#section-3.1-5.3}

The following steps are performed to assign ID
values:[¶](#section-3.1-6){.pilcrow}

-   [If there is an \"msid\" attribute, it will use that attribute to
    populate the \"id\" field of the MediaStreamTrack and associated
    MediaStreams, as described
    above.[¶](#section-3.1-7.1){.pilcrow}]{#section-3.1-7.1}
-   [If there is no \"msid\" attribute, the identifier of the
    MediaStreamTrack will be set to a randomly generated string, and it
    will be signaled as being part of a MediaStream with the WebIDL
    \"label\" attribute set to \"Non-WebRTC
    stream\".[¶](#section-3.1-7.2){.pilcrow}]{#section-3.1-7.2}
-   [After deciding on the \"id\" field to be applied to the
    MediaStreamTrack, the track will be signaled to the
    user.[¶](#section-3.1-7.3){.pilcrow}]{#section-3.1-7.3}

The process above may involve a considerable amount of buffering before
the \"stable\" state is entered. If the implementation wishes to limit
this buffering, it [MUST]{.bcp14} signal to the user that media has been
discarded.[¶](#section-3.1-8){.pilcrow}

It follows from the above that MediaStreamTracks in the \"default\"
MediaStream cannot be closed by removing the \"msid\" attribute; the
application must instead signal these as closed when the SSRC
disappears, either according to the rules of Sections
[6.3.4](https://www.rfc-editor.org/rfc/rfc3550#section-6.3.4){.relref}
and
[6.3.5](https://www.rfc-editor.org/rfc/rfc3550#section-6.3.5){.relref}
of \[[RFC3550](#RFC3550){.xref}\] or by disabling the media description
by setting its port to zero.[¶](#section-3.1-9){.pilcrow}
:::
:::

::: {#s-detailed-procedures}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Detailed Offer/Answer Procedures](#name-detailed-offer-answer-proce){.section-name .selfRef} {#name-detailed-offer-answer-proce}

These procedures are given in terms of sections recommended by
\[[RFC3264](#RFC3264){.xref}\]. They describe the actions to be taken in
terms of MediaStreams and MediaStreamTracks; they do not include event
signaling inside the application, which is described in the JavaScript
Session Establishment Protocol (JSEP)
\[[RFC8829](#RFC8829){.xref}\].[¶](#section-3.2-1){.pilcrow}

::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Generating the Initial Offer](#name-generating-the-initial-offe){.section-name .selfRef} {#name-generating-the-initial-offe}

For each media description in the offer, if there is an associated
outgoing MediaStreamTrack, the offerer adds one \"a=msid\" attribute to
the section for each MediaStream with which the MediaStreamTrack is
associated. The \"identifier\" field of the attribute is set to the
WebIDL \"id\" attribute of the MediaStream. If the sender wishes to
signal identifiers for the MediaStreamTracks, the \"appdata\" field is
set to the WebIDL \"id\" attribute of the MediaStreamTrack; otherwise,
it is omitted.[¶](#section-3.2.1-1){.pilcrow}
:::

::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [Answerer Processing of the Offer](#name-answerer-processing-of-the-){.section-name .selfRef} {#name-answerer-processing-of-the-}

For each media description in the offer and each \"a=msid\" attribute in
the media description, the receiver of the offer will perform the
following steps:[¶](#section-3.2.2-1){.pilcrow}

-   [Extract the \"appdata\" field of the \"a=msid\" attribute, if
    present.[¶](#section-3.2.2-2.1){.pilcrow}]{#section-3.2.2-2.1}
-   [If the \"appdata\" field exists: Check if a MediaStreamTrack with
    the same WebIDL \"id\" attribute as the \"appdata\" field already
    exists and is not in the \"ended\" state. If such a MediaStreamTrack
    is not found, create
    it.[¶](#section-3.2.2-2.2){.pilcrow}]{#section-3.2.2-2.2}
-   [If the \"appdata\" field does not exist, and a MediaStreamTrack is
    not associated with this media section, create a MediaStreamTrack
    and associate it with this media section for future
    use.[¶](#section-3.2.2-2.3){.pilcrow}]{#section-3.2.2-2.3}
-   [Extract the \"identifier\" field of the \"a=msid\"
    attribute.[¶](#section-3.2.2-2.4){.pilcrow}]{#section-3.2.2-2.4}
-   [Check if a MediaStream with the same WebIDL \"id\" attribute
    already exists. If not, create
    it.[¶](#section-3.2.2-2.5){.pilcrow}]{#section-3.2.2-2.5}
-   [Add the MediaStreamTrack to the
    MediaStream.[¶](#section-3.2.2-2.6){.pilcrow}]{#section-3.2.2-2.6}
-   [Signal to the user that a new MediaStreamTrack is
    available.[¶](#section-3.2.2-2.7){.pilcrow}]{#section-3.2.2-2.7}
:::

::: {#section-3.2.3 .section}
#### [3.2.3.](#section-3.2.3){.section-number .selfRef} [Generating the Answer](#name-generating-the-answer){.section-name .selfRef} {#name-generating-the-answer}

The answer is generated in exactly the same manner as the offer.
\"a=msid\" values in the offer do not influence the
answer.[¶](#section-3.2.3-1){.pilcrow}
:::

::: {#section-3.2.4 .section}
#### [3.2.4.](#section-3.2.4){.section-number .selfRef} [Offerer Processing of the Answer](#name-offerer-processing-of-the-a){.section-name .selfRef} {#name-offerer-processing-of-the-a}

The answer is processed in exactly the same manner as the
offer.[¶](#section-3.2.4-1){.pilcrow}
:::

::: {#section-3.2.5 .section}
#### [3.2.5.](#section-3.2.5){.section-number .selfRef} [Modifying the Session](#name-modifying-the-session){.section-name .selfRef} {#name-modifying-the-session}

On subsequent exchanges, precisely the same procedure as for the initial
offer/answer is followed, but with one additional step in the parsing of
the offer and answer:[¶](#section-3.2.5-1){.pilcrow}

-   [For each MediaStreamTrack that has been created as a result of
    previous offer/answer exchanges, and is not in the \"ended\" state,
    check to see if there is still an \"a=msid\" attribute in the
    present SDP whose \"appdata\" field is the same as the WebIDL \"id\"
    attribute of the
    track.[¶](#section-3.2.5-2.1){.pilcrow}]{#section-3.2.5-2.1}
-   [If no such attribute is found, stop the MediaStreamTrack. This will
    set its state to
    \"ended\".[¶](#section-3.2.5-2.2){.pilcrow}]{#section-3.2.5-2.2}
:::
:::
:::

::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Example SDP Description](#name-example-sdp-description){.section-name .selfRef} {#name-example-sdp-description}

The following SDP description shows the representation of a WebRTC
PeerConnection with two MediaStreams, each of which has one audio and
one video track. Only the parts relevant to the MSID are
shown.[¶](#section-3.3-1){.pilcrow}

Line wrapping, empty lines, and comments are added for clarity. They are
not part of the SDP.[¶](#section-3.3-2){.pilcrow}

::: {#section-3.3-3}
``` {.sourcecode .lang-sdp}
# First MediaStream - id is 4701...
m=audio 56500 UDP/TLS/RTP/SAVPF 96 0 8 97 98
a=msid:47017fee-b6c1-4162-929c-a25110252400
       f83006c5-a0ff-4e0a-9ed9-d3e6747be7d9

m=video 56502 UDP/TLS/RTP/SAVPF 100 101
a=msid:47017fee-b6c1-4162-929c-a25110252400
       b47bdb4a-5db8-49b5-bcdc-e0c9a23172e0

# Second MediaStream - id is 6131....
m=audio 56503 UDP/TLS/RTP/SAVPF 96 0 8 97 98
a=msid:61317484-2ed4-49d7-9eb7-1414322a7aae
       b94006c5-cade-4e0a-9ed9-d3e6747be7d9

m=video 56504 UDP/TLS/RTP/SAVPF 100 101
a=msid:61317484-2ed4-49d7-9eb7-1414322a7aae
       f30bdb4a-1497-49b5-3198-e0c9a23172e0
```

[¶](#section-3.3-3){.pilcrow}
:::
:::
:::
:::

::: {#IANA}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Attribute Registration in Existing Registries](#name-attribute-registration-in-e){.section-name .selfRef} {#name-attribute-registration-in-e}

IANA has registered the \"msid\" attribute in the \"att-field\" (media
level only) registry within the \"Session Description Protocol (SDP)
Parameters\" registry, according to the procedures of
\[[RFC4566](#RFC4566){.xref}\].[¶](#section-4.1-1){.pilcrow}

The \"msid\" registration information is as
follows:[¶](#section-4.1-2){.pilcrow}

[]{.break}

Contact name, email:
:   IETF, contacted via mmusic\@ietf.org, or a successor address
    designated by IESG[¶](#section-4.1-3.2){.pilcrow}
:   

Attribute name:
:   msid[¶](#section-4.1-3.4){.pilcrow}
:   

Attribute syntax:

:   \

    ::: {#section-4.1-3.6.2}
    ``` {.sourcecode .lang-abnf}
              msid-value = msid-id [ SP msid-appdata ]
              msid-id = 1*64token-char ; see RFC 4566
              msid-appdata = 1*64token-char  ; see RFC 4566
    ```

    [¶](#section-4.1-3.6.2){.pilcrow}
    :::

:   

Attribute semantics:
:   Described in RFC 8830[¶](#section-4.1-3.8){.pilcrow}
:   

Attribute value:
:   msid-value[¶](#section-4.1-3.10){.pilcrow}
:   

Long-form attribute name:
:   MediaStream Identifier[¶](#section-4.1-3.12){.pilcrow}
:   

Usage level:
:   media[¶](#section-4.1-3.14){.pilcrow}
:   

Subject to charset:
:   The attribute value contains only ASCII characters and is therefore
    not subject to the charset
    attribute.[¶](#section-4.1-3.16){.pilcrow}
:   

Purpose:
:   The attribute can be used to signal the relationship between a
    WebRTC MediaStream and a set of media
    descriptions.[¶](#section-4.1-3.18){.pilcrow}
:   

O/A Procedures:
:   Described in RFC 8830[¶](#section-4.1-3.20){.pilcrow}
:   

Appropriate values:
:   The details of appropriate values are given in RFC 8830 (this
    document).[¶](#section-4.1-3.22){.pilcrow}
:   

Mux Category:
:   NORMAL[¶](#section-4.1-3.24){.pilcrow}
:   

The Mux Category is defined in
\[[RFC8859](#RFC8859){.xref}\].[¶](#section-4.1-4){.pilcrow}
:::
:::
:::

::: {#Security}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

An adversary with the ability to modify SDP descriptions has the ability
to switch around tracks between MediaStreams. This is a special case of
the general security consideration that modification of SDP descriptions
needs to be confined to entities trusted by the
application.[¶](#section-5-1){.pilcrow}

If implementing buffering as mentioned in [Section
3.1](#s-nonsignal){.xref}, the amount of buffering should be limited to
avoid memory exhaustion attacks.[¶](#section-5-2){.pilcrow}

Careless generation of identifiers can leak privacy-sensitive
information.
\[[W3C.CR-mediacapture-streams](#W3C.CR-mediacapture-streams){.xref}\]
recommends that identifiers be generated using a Universally Unique
IDentifier (UUID) class 3 or 4 as a basis, which avoids such
leakage.[¶](#section-5-3){.pilcrow}

No other attacks have been identified that depend on this
mechanism.[¶](#section-5-4){.pilcrow}
:::
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3550\]
:   [Schulzrinne, H.]{.refAuthor}[, Casner, S.]{.refAuthor}[,
    Frederick, R.]{.refAuthor}[, and V. Jacobson]{.refAuthor}, [\"RTP: A
    Transport Protocol for Real-Time Applications\"]{.refTitle}, [STD
    64]{.seriesInfo}, [RFC 3550]{.seriesInfo}, [DOI
    10.17487/RFC3550]{.seriesInfo}, July 2003,
    \<<https://www.rfc-editor.org/info/rfc3550>\>.
:   

\[RFC4566\]
:   [Handley, M.]{.refAuthor}[, Jacobson, V.]{.refAuthor}[, and C.
    Perkins]{.refAuthor}, [\"SDP: Session Description
    Protocol\"]{.refTitle}, [RFC 4566]{.seriesInfo}, [DOI
    10.17487/RFC4566]{.seriesInfo}, July 2006,
    \<<https://www.rfc-editor.org/info/rfc4566>\>.
:   

\[RFC5234\]
:   [Crocker, D., Ed.]{.refAuthor}[ and P. Overell]{.refAuthor},
    [\"Augmented BNF for Syntax Specifications: ABNF\"]{.refTitle}, [STD
    68]{.seriesInfo}, [RFC 5234]{.seriesInfo}, [DOI
    10.17487/RFC5234]{.seriesInfo}, January 2008,
    \<<https://www.rfc-editor.org/info/rfc5234>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8829\]
:   [Uberti, J.]{.refAuthor}[, Jennings, C.]{.refAuthor}[, and E.
    Rescorla, Ed.]{.refAuthor}, [\"JavaScript Session Establishment
    Protocol (JSEP)\"]{.refTitle}, [RFC 8829]{.seriesInfo}, [DOI
    10.17487/RFC8829]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8829>\>.
:   

\[RFC8859\]
:   [Nandakumar, S.]{.refAuthor}, [\"A Framework for Session Description
    Protocol (SDP) Attributes When Multiplexing\"]{.refTitle}, [RFC
    8859]{.seriesInfo}, [DOI 10.17487/RFC8859]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8859>\>.
:   

\[W3C-WebRTC\]
:   [Jennings, C.]{.refAuthor}[, Boström, H.]{.refAuthor}[, and J-I.
    Bruaroey]{.refAuthor}, [\"WebRTC 1.0: Real-time Communication
    Between Browsers\"]{.refTitle}, [W3C Proposed
    Recommendation]{.refContent}, \<<https://www.w3.org/TR/webrtc/>\>.
:   

\[W3C.CR-mediacapture-streams\]
:   [Jennings, C.]{.refAuthor}[, Aboba, B.]{.refAuthor}[, Bruaroey,
    J.-I.]{.refAuthor}[, and H. Boström]{.refAuthor}, [\"Media Capture
    and Streams\"]{.refTitle}, [W3C Candidate
    Recommendation]{.refContent},
    \<<https://www.w3.org/TR/mediacapture-streams/>\>.
:   
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[RFC3264\]
:   [Rosenberg, J.]{.refAuthor}[ and H. Schulzrinne]{.refAuthor}, [\"An
    Offer/Answer Model with Session Description Protocol
    (SDP)\"]{.refTitle}, [RFC 3264]{.seriesInfo}, [DOI
    10.17487/RFC3264]{.seriesInfo}, June 2002,
    \<<https://www.rfc-editor.org/info/rfc3264>\>.
:   

\[RFC5761\]
:   [Perkins, C.]{.refAuthor}[ and M. Westerlund]{.refAuthor},
    [\"Multiplexing RTP Data and Control Packets on a Single
    Port\"]{.refTitle}, [RFC 5761]{.seriesInfo}, [DOI
    10.17487/RFC5761]{.seriesInfo}, April 2010,
    \<<https://www.rfc-editor.org/info/rfc5761>\>.
:   

\[RFC5888\]
:   [Camarillo, G.]{.refAuthor}[ and H. Schulzrinne]{.refAuthor}, [\"The
    Session Description Protocol (SDP) Grouping Framework\"]{.refTitle},
    [RFC 5888]{.seriesInfo}, [DOI 10.17487/RFC5888]{.seriesInfo}, June
    2010, \<<https://www.rfc-editor.org/info/rfc5888>\>.
:   

\[RFC7656\]
:   [Lennox, J.]{.refAuthor}[, Gross, K.]{.refAuthor}[,
    Nandakumar, S.]{.refAuthor}[, Salgueiro, G.]{.refAuthor}[, and B.
    Burman, Ed.]{.refAuthor}, [\"A Taxonomy of Semantics and Mechanisms
    for Real-Time Transport Protocol (RTP) Sources\"]{.refTitle}, [RFC
    7656]{.seriesInfo}, [DOI 10.17487/RFC7656]{.seriesInfo}, November
    2015, \<<https://www.rfc-editor.org/info/rfc7656>\>.
:   

\[RFC8825\]
:   [Alvestrand, H.]{.refAuthor}, [\"Overview: Real-Time Protocols for
    Browser-Based Applications\"]{.refTitle}, [RFC 8825]{.seriesInfo},
    [DOI 10.17487/RFC8825]{.seriesInfo}, January 2021,
    \<<https://www.rfc-editor.org/info/rfc8825>\>.
:   

\[RFC8843\]
:   [Holmberg, C.]{.refAuthor}[, Alvestrand, H.]{.refAuthor}[, and C.
    Jennings]{.refAuthor}, [\"Negotiating Media Multiplexing Using the
    Session Description Protocol (SDP)\"]{.refTitle}, [RFC
    8843]{.seriesInfo}, [DOI 10.17487/RFC8843]{.seriesInfo}, January
    2021, \<<https://www.rfc-editor.org/info/rfc8843>\>.
:   

\[WEBIDL\]
:   [Chen, E.]{.refAuthor}[ and T. Gu]{.refAuthor}, [\"Web
    IDL\"]{.refTitle}, [W3C Editor\'s Draft]{.refContent}, August 2020,
    \<<https://heycam.github.io/webidl/>\>.
:   
:::
:::

::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Design Considerations, Rejected Alternatives](#name-design-considerations-rejec){.section-name .selfRef} {#name-design-considerations-rejec}

One suggested mechanism has been to use CNAME instead of a new
attribute. This was abandoned because CNAME identifies a synchronization
context; one can imagine both wanting to have tracks from the same
synchronization context in multiple MediaStreams and wanting to have
tracks from multiple synchronization contexts within one MediaStream
(but the latter is impossible, since a MediaStream is defined to impose
synchronization on its members).[¶](#section-appendix.a-1){.pilcrow}

Another suggestion has been to put the \"msid\" value within an
attribute of RTCP SR (sender report) packets. This doesn\'t offer the
ability to know that you have seen all the tracks currently configured
for a MediaStream.[¶](#section-appendix.a-2){.pilcrow}

A suggestion that survived for a number of drafts of this document was
to define MSID as a generic mechanism, where the particular semantics of
this usage of the mechanism would be defined by an \"a=wms-semantic\"
attribute. This was removed in April
2015.[¶](#section-appendix.a-3){.pilcrow}
:::

::: {#Acknowledgements}
::: {#section-appendix.b .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

This note is based on sketches from, among others, [Justin
Uberti]{.contact-name} and [Cullen
Jennings]{.contact-name}.[¶](#section-appendix.b-1){.pilcrow}

Special thanks to [Flemming Andreasen]{.contact-name}, [Ben
Campbell]{.contact-name}, [Miguel Garcia]{.contact-name}, [Martin
Thomson]{.contact-name}, [Ted Hardie]{.contact-name}, [Adam
Roach]{.contact-name}, [Magnus Westerlund]{.contact-name}, [Alissa
Cooper]{.contact-name}, [Sue Hares]{.contact-name}, and [Paul
Kyzivat]{.contact-name} for their work in reviewing this document, with
many specific language suggestions.[¶](#section-appendix.b-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Harald Alvestrand]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Google]{.org}
:::

::: {.left dir="auto"}
[Kungsbron 2]{.street-address}
:::

::: {.left dir="auto"}
SE-[11122]{.postal-code} [Stockholm]{.locality}
:::

::: {.left dir="auto"}
[Sweden]{.country-name}
:::

::: email
Email: <harald@alvestrand.no>
:::
:::
:::
