  RFC 8747        Proof-of-Possession Key for CWTs   March 2020
  --------------- ---------------------------------- ------------
  Jones, et al.   Standards Track                    \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8747](https://www.rfc-editor.org/rfc/rfc8747){.eref}

Category:
:   Standards Track

Published:
:   March 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    M. Jones
    :::

    ::: org
    Microsoft
    :::
    :::

    ::: author
    ::: author-name
    L. Seitz
    :::

    ::: org
    Combitech
    :::
    :::

    ::: author
    ::: author-name
    G. Selander
    :::

    ::: org
    Ericsson AB
    :::
    :::

    ::: author
    ::: author-name
    S. Erdtman
    :::

    ::: org
    Spotify
    :::
    :::

    ::: author
    ::: author-name
    H. Tschofenig
    :::

    ::: org
    Arm Ltd.
    :::
    :::
:::

# RFC 8747 {#rfcnum}

# Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This specification describes how to declare in a CBOR Web Token (CWT)
(which is defined by RFC 8392) that the presenter of the CWT possesses a
particular proof-of-possession key. Being able to prove possession of a
key is also sometimes described as being the holder-of-key. This
specification provides equivalent functionality to \"Proof-of-Possession
Key Semantics for JSON Web Tokens (JWTs)\" (RFC 7800) but using Concise
Binary Object Representation (CBOR) and CWTs rather than JavaScript
Object Notation (JSON) and JSON Web Tokens
(JWTs).[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8747>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Representations for Proof-of-Possession
    Keys](#name-representations-for-proof-o){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Confirmation
        Claim](#name-confirmation-claim){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Representation of an Asymmetric
        Proof-of-Possession
        Key](#name-representation-of-an-asymme){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Representation of an Encrypted
        Symmetric Proof-of-Possession
        Key](#name-representation-of-an-encryp){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Representation of a Key ID for a
        Proof-of-Possession
        Key](#name-representation-of-a-key-id-){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Specifics Intentionally Not
        Specified](#name-specifics-intentionally-not){.xref}[¶](#section-toc.1-1.3.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Privacy
    Considerations](#name-privacy-considerations){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Operational
    Considerations](#name-operational-considerations){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [CBOR Web Token Claims
        Registration](#name-cbor-web-token-claims-regis){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.1.2.1}
            [7.1.1](#section-7.1.1){.xref}.  [Registry
            Contents](#name-registry-contents){.xref}[¶](#section-toc.1-1.7.2.1.2.1.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [CWT Confirmation Methods
        Registry](#name-cwt-confirmation-methods-re){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}

        -   ::: {#section-toc.1-1.7.2.2.2.1}
            [7.2.1](#section-7.2.1){.xref}.  [Registration
            Template](#name-registration-template){.xref}[¶](#section-toc.1-1.7.2.2.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.7.2.2.2.2}
            [7.2.2](#section-7.2.2){.xref}.  [Initial Registry
            Contents](#name-initial-registry-contents){.xref}[¶](#section-toc.1-1.7.2.2.2.2.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.8.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.8.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::
:::
:::

::: {#Introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This specification describes how a CBOR Web Token (CWT)
\[[RFC8392](#RFC8392){.xref}\] can declare that the presenter of the CWT
possesses a particular proof-of-possession (PoP) key. Proof of
possession of a key is also sometimes described as being the
holder-of-key. This specification provides equivalent functionality to
\"Proof-of-Possession Key Semantics for JSON Web Tokens (JWTs)\"
\[[RFC7800](#RFC7800){.xref}\] but using Concise Binary Object
Representation (CBOR) \[[RFC7049](#RFC7049){.xref}\] and CWTs
\[[RFC8392](#RFC8392){.xref}\] rather than JavaScript Object Notation
(JSON) \[[RFC8259](#RFC8259){.xref}\] and JSON Web Tokens (JWTs)
\[[JWT](#RFC7519){.xref}\].[¶](#section-1-1){.pilcrow}
:::
:::

::: {#Terminology}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

This specification uses terms defined in the CBOR Web Token (CWT)
\[[RFC8392](#RFC8392){.xref}\], CBOR Object Signing and Encryption
(COSE) \[[RFC8152](#RFC8152){.xref}\], and Concise Binary Object
Representation (CBOR) \[[RFC7049](#RFC7049){.xref}\]
specifications.[¶](#section-2-2){.pilcrow}

These terms are defined by this
specification:[¶](#section-2-3){.pilcrow}

Issuer
:   Party that creates the CWT and binds the claims about the subject to
    the proof-of-possession key.[¶](#section-2-4.2){.pilcrow}

Presenter

:   Party that proves possession of a private key (for asymmetric key
    cryptography) or secret key (for symmetric key cryptography) to a
    recipient of a CWT.[¶](#section-2-4.4.1){.pilcrow}

    In the context of OAuth, this party is also called the OAuth
    Client.[¶](#section-2-4.4.2){.pilcrow}

Recipient

:   Party that receives the CWT containing the proof-of-possession key
    information from the presenter.[¶](#section-2-4.6.1){.pilcrow}

    In the context of OAuth, this party is also called the OAuth
    Resource Server.[¶](#section-2-4.6.2){.pilcrow}

This specification provides examples in CBOR extended diagnostic
notation, as defined in [Appendix
G](https://www.rfc-editor.org/rfc/rfc8610#appendix-G){.relref} of
\[[RFC8610](#RFC8610){.xref}\]. The examples include line breaks for
readability.[¶](#section-2-5){.pilcrow}
:::
:::

::: {#PoP}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Representations for Proof-of-Possession Keys](#name-representations-for-proof-o){.section-name .selfRef} {#name-representations-for-proof-o}

By including a `cnf` (confirmation) claim in a CWT, the issuer of the
CWT declares that the presenter possesses a particular key and that the
recipient can cryptographically confirm that the presenter has
possession of that key. The value of the `cnf` claim is a CBOR map
(which is defined in [Section
2.1](https://www.rfc-editor.org/rfc/rfc7049#section-2.1){.relref} of
\[[RFC7049](#RFC7049){.xref}\]) and the members of that map identify the
proof-of-possession key.[¶](#section-3-1){.pilcrow}

The presenter can be identified in one of several ways by the CWT,
depending upon the application requirements. For instance, some
applications may use the CWT `sub` (subject) claim
\[[RFC8392](#RFC8392){.xref}\] to identify the presenter. Other
applications may use the `iss` (issuer) claim
\[[RFC8392](#RFC8392){.xref}\] to identify the presenter. In some
applications, the subject identifier might be relative to the issuer
identified by the `iss` claim. The actual mechanism used is dependent
upon the application. The case in which the presenter is the subject of
the CWT is analogous to Security Assertion Markup Language (SAML) 2.0
\[[OASIS.saml-core-2.0-os](#OASIS.saml-core-2.0-os){.xref}\]
SubjectConfirmation usage.[¶](#section-3-2){.pilcrow}

::: {#Confirmation}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Confirmation Claim](#name-confirmation-claim){.section-name .selfRef} {#name-confirmation-claim}

The `cnf` claim in the CWT is used to carry confirmation methods. Some
of them use proof-of-possession keys, while others do not. This design
is analogous to the SAML 2.0
\[[OASIS.saml-core-2.0-os](#OASIS.saml-core-2.0-os){.xref}\]
SubjectConfirmation element in which a number of different subject
confirmation methods can be included (including proof-of-possession key
information).[¶](#section-3.1-1){.pilcrow}

The set of confirmation members that a CWT must contain to be considered
valid is context dependent and is outside the scope of this
specification. Specific applications of CWTs will require
implementations to understand and process some confirmation members in
particular ways. However, in the absence of such requirements, all
confirmation members that are not understood by implementations
[MUST]{.bcp14} be ignored.[¶](#section-3.1-2){.pilcrow}

[Section 7.2](#CnfReg){.xref} establishes the IANA \"CWT Confirmation
Methods\" registry for CWT `cnf` member values and registers the members
defined by this specification. Other specifications can register other
members used for confirmation, including other members for conveying
proof-of-possession keys using different key
representations.[¶](#section-3.1-3){.pilcrow}

The `cnf` claim value [MUST]{.bcp14} represent only a single
proof-of-possession key. At most one of the `COSE_Key` and
`Encrypted_COSE_Key` confirmation values defined in [Table
1](#fig_cborMappings){.xref} may be present. Note that if an application
needs to represent multiple proof-of-possession keys in the same CWT,
one way for it to achieve this is to use other claim names (in addition
to `cnf`) to hold the additional proof-of-possession key information.
These claims could use the same syntax and semantics as the `cnf` claim.
Those claims would be defined by applications or other specifications
and could be registered in the IANA \"CBOR Web Token (CWT) Claims\"
registry
\[[IANA.CWT.Claims](#IANA.CWT.Claims){.xref}\].[¶](#section-3.1-4){.pilcrow}

[]{#name-summary-of-the-cnf-names-ke}

::: {#fig_cborMappings}
  Name                 Key   Value type
  -------------------- ----- -------------------------------
  COSE_Key             1     COSE_Key
  Encrypted_COSE_Key   2     COSE_Encrypt or COSE_Encrypt0
  kid                  3     binary string

  : [Table 1](#table-1){.selfRef}: [Summary of the `cnf` Names, Keys,
  and Value Types](#name-summary-of-the-cnf-names-ke){.selfRef}
:::
:::
:::

::: {#PrivatePoP}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Representation of an Asymmetric Proof-of-Possession Key](#name-representation-of-an-asymme){.section-name .selfRef} {#name-representation-of-an-asymme}

When the key held by the presenter is an asymmetric private key, the
`COSE_Key` member is a COSE_Key \[[RFC8152](#RFC8152){.xref}\]
representing the corresponding asymmetric public key. The following
example demonstrates such a declaration in the CWT Claims Set of a
CWT:[¶](#section-3.2-1){.pilcrow}

::: {#section-3.2-2}
``` {.sourcecode .lang-cbor}
 {
 /iss/ 1 : "coaps://server.example.com",
 /aud/ 3 : "coaps://client.example.org",
 /exp/ 4 : 1879067471,
 /cnf/ 8 :{
   /COSE_Key/ 1 :{
     /kty/ 1 : /EC2/ 2,
     /crv/ -1 : /P-256/ 1,
     /x/ -2 : h'd7cc072de2205bdc1537a543d53c60a6acb62eccd890c7fa27c9
                e354089bbe13',
     /y/ -3 : h'f95e1d4b851a2cc80fff87d8e23f22afb725d535e515d020731e
                79a3b4e47120'
    }
  }
}
```

[¶](#section-3.2-2){.pilcrow}
:::

The COSE_Key [MUST]{.bcp14} contain the required key members for a
COSE_Key of that key type and [MAY]{.bcp14} contain other COSE_Key
members, including the `kid` (Key ID)
member.[¶](#section-3.2-3){.pilcrow}

The `COSE_Key` member [MAY]{.bcp14} also be used for a COSE_Key
representing a symmetric key, provided that the CWT is encrypted so that
the key is not revealed to unintended parties. The means of encrypting a
CWT is explained in \[[RFC8392](#RFC8392){.xref}\]. If the CWT is not
encrypted, the symmetric key [MUST]{.bcp14} be encrypted as described in
[Section 3.3](#SymmetricPoP){.xref}. This procedure is equivalent to the
one defined in [Section
3.3](https://www.rfc-editor.org/rfc/rfc7800#section-3.3){.relref} of
\[[RFC7800](#RFC7800){.xref}\].[¶](#section-3.2-4){.pilcrow}
:::
:::

::: {#SymmetricPoP}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Representation of an Encrypted Symmetric Proof-of-Possession Key](#name-representation-of-an-encryp){.section-name .selfRef} {#name-representation-of-an-encryp}

When the key held by the presenter is a symmetric key, the
`Encrypted_COSE_Key` member is an encrypted COSE_Key
\[[RFC8152](#RFC8152){.xref}\] representing the symmetric key encrypted
to a key known to the recipient using COSE_Encrypt or
COSE_Encrypt0.[¶](#section-3.3-1){.pilcrow}

The following example illustrates a symmetric key that could
subsequently be encrypted for use in the `Encrypted_COSE_Key`
member:[¶](#section-3.3-2){.pilcrow}

::: {#section-3.3-3}
``` {.sourcecode .lang-cbor}
{
 /kty/ 1 : /Symmetric/ 4,
 /alg/ 3 : /HMAC 256-256/ 5,
 /k/ -1 : h'6684523ab17337f173500e5728c628547cb37df
            e68449c65f885d1b73b49eae1'
}
```

[¶](#section-3.3-3){.pilcrow}
:::

The COSE_Key representation is used as the plaintext when encrypting the
key.[¶](#section-3.3-4){.pilcrow}

The following example CWT Claims Set of a CWT illustrates the use of an
encrypted symmetric key as the `Encrypted_COSE_Key` member
value:[¶](#section-3.3-5){.pilcrow}

::: {#section-3.3-6}
``` {.sourcecode .lang-cbor}
{
 /iss/ 1 : "coaps://server.example.com",
 /sub/ 2 : "24400320",
 /aud/ 3: "s6BhdRkqt3",
 /exp/ 4 : 1311281970,
 /iat/ 5 : 1311280970,
 /cnf/ 8 : {
 /Encrypted_COSE_Key/ 2 : [
    /protected header/ h'A1010A' /{ \alg\ 1:10 \AES-CCM-16-64-128\}/,
    /unprotected header/ { / iv / 5: h'636898994FF0EC7BFCF6D3F95B'},
    /ciphertext/  h'0573318A3573EB983E55A7C2F06CADD0796C9E584F1D0E3E
                    A8C5B052592A8B2694BE9654F0431F38D5BBC8049FA7F13F'
   ]
  }
}
```

[¶](#section-3.3-6){.pilcrow}
:::

The example above was generated with the
key:[¶](#section-3.3-7){.pilcrow}

::: {#section-3.3-8 .artwork .art-text .alignLeft}
    h'6162630405060708090a0b0c0d0e0f10'

[¶](#section-3.3-8){.pilcrow}
:::
:::
:::

::: {#KidPoP}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Representation of a Key ID for a Proof-of-Possession Key](#name-representation-of-a-key-id-){.section-name .selfRef} {#name-representation-of-a-key-id-}

The proof-of-possession key can also be identified using a Key ID
instead of communicating the actual key, provided the recipient is able
to obtain the identified key using the Key ID. In this case, the issuer
of a CWT declares that the presenter possesses a particular key and that
the recipient can cryptographically confirm the presenter\'s proof of
possession of the key by including a `cnf` claim in the CWT whose value
is a CBOR map containing a `kid` member identifying the
key.[¶](#section-3.4-1){.pilcrow}

The following example demonstrates such a declaration in the CWT Claims
Set of a CWT:[¶](#section-3.4-2){.pilcrow}

::: {#section-3.4-3}
``` {.sourcecode .lang-cbor}
{
 /iss/ 1 : "coaps://as.example.com",
 /aud/ 3 : "coaps://resource.example.org",
 /exp/ 4 : 1361398824,
 /cnf/ 8 : {
   /kid/ 3 : h'dfd1aa976d8d4575a0fe34b96de2bfad'
  }
}
```

[¶](#section-3.4-3){.pilcrow}
:::

The content of the `kid` value is application specific. For instance,
some applications may choose to use a cryptographic hash of the public
key value as the `kid` value.[¶](#section-3.4-4){.pilcrow}

Note that the use of a Key ID to identify a proof-of-possession key
needs to be carefully circumscribed, as described below and in [Section
6](#Operational){.xref}. In cases where the Key ID is not a
cryptographic value derived from the key or where not all of the parties
involved are validating the cryptographic derivation, implementers
should expect collisions where different keys are assigned the same Key
ID. Recipients of a CWT with a PoP key linked through only a Key ID
should be prepared to handle such
situations.[¶](#section-3.4-5){.pilcrow}

In the world of constrained Internet of Things (IoT) devices, there is
frequently a restriction on the size of Key IDs, either because of table
constraints or a desire to keep message sizes
small.[¶](#section-3.4-6){.pilcrow}

Note that the value of a Key ID for a specific key is not necessarily
the same for different parties. When sending a COSE encrypted message
with a shared key, the Key ID may be different on both sides of the
conversation, with the appropriate one being included in the message
based on the recipient of the message.[¶](#section-3.4-7){.pilcrow}
:::
:::

::: {#NotSpecified}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Specifics Intentionally Not Specified](#name-specifics-intentionally-not){.section-name .selfRef} {#name-specifics-intentionally-not}

Proof of possession is often demonstrated by having the presenter sign a
value determined by the recipient using the key possessed by the
presenter. This value is sometimes called a \"nonce\" or a
\"challenge\". There are, however, also other means to demonstrate
freshness of the exchange and to link the proof-of-possession key to the
participating parties, as demonstrated by various authentication and key
exchange protocols.[¶](#section-3.5-1){.pilcrow}

The means of communicating the nonce and the nature of its contents are
intentionally not described in this specification, as different
protocols will communicate this information in different ways. Likewise,
the means of communicating the signed nonce is also not specified, as
this is also protocol specific.[¶](#section-3.5-2){.pilcrow}

Note that other means of proving possession of the key exist, which
could be used in conjunction with a CWT\'s confirmation key.
Applications making use of such alternate means are encouraged to
register them in the IANA \"CBOR Web Token (CWT) Confirmation Methods\"
registry established in [Section
7.2](#CnfReg){.xref}.[¶](#section-3.5-3){.pilcrow}
:::
:::
:::
:::

::: {#Security}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

All the security considerations that are discussed in
\[[RFC8392](#RFC8392){.xref}\] also apply here. In addition, proof of
possession introduces its own unique security issues. Possessing a key
is only valuable if it is kept secret. Appropriate means must be used to
ensure that unintended parties do not learn private key or symmetric key
values.[¶](#section-4-1){.pilcrow}

Applications utilizing proof of possession [SHOULD]{.bcp14} also utilize
audience restriction, as described in [Section
3.1.3](https://www.rfc-editor.org/rfc/rfc8392#section-3.1.3){.relref} of
\[[RFC8392](#RFC8392){.xref}\], because it provides additional
protections. Audience restriction can be used by recipients to reject
messages intended for different recipients. (Of course, applications not
using proof of possession can also benefit from using audience
restriction to reject messages intended for different
recipients.)[¶](#section-4-2){.pilcrow}

CBOR Web Tokens with proof-of-possession keys are used in context of an
architecture, such as the ACE OAuth Framework
\[[ACE-OAUTH](#I-D.ietf-ace-oauth-authz){.xref}\], in which protocols
are used by a presenter to request these tokens and to subsequently use
them with recipients. Proof of possession only provides the intended
security gains when the proof is known to be current and not subject to
replay attacks; security protocols using mechanisms such as nonces and
timestamps can be used to avoid the risk of replay when performing proof
of possession for a token. Note that a discussion of the architecture or
specific protocols that CWTs with proof-of-possession keys are used with
is beyond the scope of this specification.[¶](#section-4-3){.pilcrow}

As is the case with other information included in a CWT, it is necessary
to apply data origin authentication and integrity protection (via a
keyed message digest or a digital signature). Data origin authentication
ensures that the recipient of the CWT learns about the entity that
created the CWT, since this will be important for any policy decisions.
Integrity protection prevents an adversary from changing any elements
conveyed within the CWT payload. Special care has to be applied when
carrying symmetric keys inside the CWT since those not only require
integrity protection but also confidentiality
protection.[¶](#section-4-4){.pilcrow}

As described in Section
[6](https://www.rfc-editor.org/rfc/rfc7515#section-6){.relref} ([Key
Identification](https://www.rfc-editor.org/rfc/rfc7515#section-6){.relref})
and Appendix
[D](https://www.rfc-editor.org/rfc/rfc7515#appendix-D){.relref} ([Notes
on Key
Selection](https://www.rfc-editor.org/rfc/rfc7515#appendix-D){.relref})
of \[[JWS](#RFC7515){.xref}\], it is important to make explicit trust
decisions about the keys. Proof-of-possession signatures made with keys
not meeting the application\'s trust criteria [MUST NOT]{.bcp14} be
relied upon.[¶](#section-4-5){.pilcrow}
:::
:::

::: {#Privacy}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Privacy Considerations](#name-privacy-considerations){.section-name .selfRef} {#name-privacy-considerations}

A proof-of-possession key can be used as a correlation handle if the
same key is used on multiple occasions. Thus, for privacy reasons, it is
recommended that different proof-of-possession keys be used when
interacting with different parties.[¶](#section-5-1){.pilcrow}
:::
:::

::: {#Operational}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Operational Considerations](#name-operational-considerations){.section-name .selfRef} {#name-operational-considerations}

The use of CWTs with proof-of-possession keys requires additional
information to be shared between the involved parties in order to ensure
correct processing. The recipient needs to be able to use credentials to
verify the authenticity and integrity of the CWT. Furthermore, the
recipient may need to be able to decrypt either the whole CWT or the
encrypted parts thereof (see [Section 3.3](#SymmetricPoP){.xref}). This
requires the recipient to know information about the issuer. Likewise,
there needs to be agreement between the issuer and the recipient about
the claims being used (which is also true of CWTs in
general).[¶](#section-6-1){.pilcrow}

When an issuer creates a CWT containing a Key ID claim, it needs to make
sure that it does not issue another CWT with different claims containing
the same Key ID within the lifetime of the CWTs, unless intentionally
desired. Failure to do so may allow one party to impersonate another
party, with the potential to gain additional privileges. A case where
such reuse of a Key ID would be intentional is when a presenter obtains
a CWT with different claims (e.g., extended scope) for the same
recipient but wants to continue using an existing security association
(e.g., a DTLS session) bound to the key identified by the Key ID.
Likewise, if PoP keys are used for multiple different kinds of CWTs in
an application and the PoP keys are identified by Key IDs, care must be
taken to keep the keys for the different kinds of CWTs segregated so
that an attacker cannot cause the wrong PoP key to be used by using a
valid Key ID for the wrong kind of CWT. Using an audience restriction
for the CWT would be one strategy to mitigate this
risk.[¶](#section-6-2){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

The following registration procedure is used for all the registries
established by this specification.[¶](#section-7-1){.pilcrow}

Values are registered on a Specification Required
\[[RFC8126](#RFC8126){.xref}\] basis after a three-week review period on
the \<cwt-reg-review\@ietf.org> mailing list, on the advice of one or
more designated experts. However, to allow for the allocation of values
prior to publication, the designated experts may approve registration
once they are satisfied that such a specification will be
published.[¶](#section-7-2){.pilcrow}

Registration requests sent to the mailing list for review should use an
appropriate subject (e.g., \"Request to Register CWT Confirmation
Method: example\"). Registration requests that are undetermined for a
period longer than 21 days can be brought directly to IANA\'s attention
(using the iana\@iana.org mailing list) for
resolution.[¶](#section-7-3){.pilcrow}

Designated experts should determine whether a registration request
contains enough information for the registry to be populated with the
new values and whether the proposed new functionality already exists. In
the case of an incomplete registration or an attempt to register already
existing functionality, the designated experts should ask for
corrections or reject the registration.[¶](#section-7-4){.pilcrow}

It is suggested that multiple designated experts be appointed who are
able to represent the perspectives of different applications using this
specification in order to enable broadly informed review of registration
decisions. In cases where a registration decision could be perceived as
creating a conflict of interest for a particular expert, that expert
should defer to the judgment of the other
experts.[¶](#section-7-5){.pilcrow}

::: {#ClaimsRegistry}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [CBOR Web Token Claims Registration](#name-cbor-web-token-claims-regis){.section-name .selfRef} {#name-cbor-web-token-claims-regis}

This specification registers the `cnf` claim in the IANA \"CBOR Web
Token (CWT) Claims\" registry
\[[IANA.CWT.Claims](#IANA.CWT.Claims){.xref}\], established by
\[[RFC8392](#RFC8392){.xref}\].[¶](#section-7.1-1){.pilcrow}

::: {#ClaimsContents}
::: {#section-7.1.1 .section}
#### [7.1.1.](#section-7.1.1){.section-number .selfRef} [Registry Contents](#name-registry-contents){.section-name .selfRef} {#name-registry-contents}

-   [Claim Name:
    `cnf`[¶](#section-7.1.1-1.1){.pilcrow}]{#section-7.1.1-1.1}
-   [Claim Description:
    Confirmation[¶](#section-7.1.1-1.2){.pilcrow}]{#section-7.1.1-1.2}
-   [JWT Claim Name:
    `cnf`[¶](#section-7.1.1-1.3){.pilcrow}]{#section-7.1.1-1.3}
-   [Claim Key: 8[¶](#section-7.1.1-1.4){.pilcrow}]{#section-7.1.1-1.4}
-   [Claim Value Type(s):
    map[¶](#section-7.1.1-1.5){.pilcrow}]{#section-7.1.1-1.5}
-   [Change Controller:
    IESG[¶](#section-7.1.1-1.6){.pilcrow}]{#section-7.1.1-1.6}
-   [Specification Document(s): [Section 3.1](#Confirmation){.xref} of
    RFC 8747[¶](#section-7.1.1-1.7){.pilcrow}]{#section-7.1.1-1.7}
:::
:::
:::
:::

::: {#CnfReg}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [CWT Confirmation Methods Registry](#name-cwt-confirmation-methods-re){.section-name .selfRef} {#name-cwt-confirmation-methods-re}

This specification establishes the IANA \"CWT Confirmation Methods\"
registry for CWT `cnf` member values. The registry records the
confirmation method member and a reference to the specification that
defines it.[¶](#section-7.2-1){.pilcrow}

::: {#CnfTemplate}
::: {#section-7.2.1 .section}
#### [7.2.1.](#section-7.2.1){.section-number .selfRef} [Registration Template](#name-registration-template){.section-name .selfRef} {#name-registration-template}

Confirmation Method Name:
:   The human-readable name requested (e.g.,
    \"kid\").[¶](#section-7.2.1-1.2){.pilcrow}

Confirmation Method Description:
:   Brief description of the confirmation method (e.g., \"Key
    Identifier\").[¶](#section-7.2.1-1.4){.pilcrow}

JWT Confirmation Method Name:
:   Claim Name of the equivalent JWT confirmation method value, as
    registered in the \"JSON Web Token Claims\" subregistry in the
    \"JSON Web Token (JWT)\" registry \[[IANA.JWT](#IANA.JWT){.xref}\].
    CWT claims should normally have a corresponding JWT claim. If a
    corresponding JWT claim would not make sense, the designated experts
    can choose to accept registrations for which the JWT Claim Name is
    listed as \"N/A\".[¶](#section-7.2.1-1.6){.pilcrow}

Confirmation Key:
:   CBOR map key value for the confirmation
    method.[¶](#section-7.2.1-1.8){.pilcrow}

Confirmation Value Type(s):
:   CBOR types that can be used for the confirmation method
    value.[¶](#section-7.2.1-1.10){.pilcrow}

Change Controller:
:   For Standards Track RFCs, list the \"IESG\". For others, give the
    name of the responsible party.[¶](#section-7.2.1-1.12){.pilcrow}

Specification Document(s):
:   Reference to the document or documents that specify the parameter,
    preferably including URIs that can be used to retrieve copies of the
    documents. An indication of the relevant sections may also be
    included but is not required. Note that the designated experts and
    IANA must be able to obtain copies of the specification document(s)
    to perform their work.[¶](#section-7.2.1-1.14){.pilcrow}
:::
:::

::: {#CnfContents}
::: {#section-7.2.2 .section}
#### [7.2.2.](#section-7.2.2){.section-number .selfRef} [Initial Registry Contents](#name-initial-registry-contents){.section-name .selfRef} {#name-initial-registry-contents}

-   [Confirmation Method Name:
    `COSE_Key`[¶](#section-7.2.2-1.1){.pilcrow}]{#section-7.2.2-1.1}
-   [Confirmation Method Description: COSE_Key Representing Public
    Key[¶](#section-7.2.2-1.2){.pilcrow}]{#section-7.2.2-1.2}
-   [JWT Confirmation Method Name:
    `jwk`[¶](#section-7.2.2-1.3){.pilcrow}]{#section-7.2.2-1.3}
-   [Confirmation Key:
    1[¶](#section-7.2.2-1.4){.pilcrow}]{#section-7.2.2-1.4}
-   [Confirmation Value Type(s): COSE_Key
    structure[¶](#section-7.2.2-1.5){.pilcrow}]{#section-7.2.2-1.5}
-   [Change Controller:
    IESG[¶](#section-7.2.2-1.6){.pilcrow}]{#section-7.2.2-1.6}
-   [Specification Document(s): [Section 3.2](#PrivatePoP){.xref} of RFC
    8747[¶](#section-7.2.2-1.7){.pilcrow}]{#section-7.2.2-1.7}

```{=html}
<!-- -->
```
-   [Confirmation Method Name:
    `Encrypted_COSE_Key`[¶](#section-7.2.2-2.1){.pilcrow}]{#section-7.2.2-2.1}
-   [Confirmation Method Description: Encrypted
    COSE_Key[¶](#section-7.2.2-2.2){.pilcrow}]{#section-7.2.2-2.2}
-   [JWT Confirmation Method Name:
    `jwe`[¶](#section-7.2.2-2.3){.pilcrow}]{#section-7.2.2-2.3}
-   [Confirmation Key:
    2[¶](#section-7.2.2-2.4){.pilcrow}]{#section-7.2.2-2.4}
-   [Confirmation Value Type(s): COSE_Encrypt or COSE_Encrypt0 structure
    (with an optional corresponding COSE_Encrypt or COSE_Encrypt0
    tag)[¶](#section-7.2.2-2.5){.pilcrow}]{#section-7.2.2-2.5}
-   [Change Controller:
    IESG[¶](#section-7.2.2-2.6){.pilcrow}]{#section-7.2.2-2.6}
-   [Specification Document(s): [Section 3.3](#SymmetricPoP){.xref} of
    RFC 8747[¶](#section-7.2.2-2.7){.pilcrow}]{#section-7.2.2-2.7}

```{=html}
<!-- -->
```
-   [Confirmation Method Name:
    `kid`[¶](#section-7.2.2-3.1){.pilcrow}]{#section-7.2.2-3.1}
-   [Confirmation Method Description: Key
    Identifier[¶](#section-7.2.2-3.2){.pilcrow}]{#section-7.2.2-3.2}
-   [JWT Confirmation Method Name:
    `kid`[¶](#section-7.2.2-3.3){.pilcrow}]{#section-7.2.2-3.3}
-   [Confirmation Key:
    3[¶](#section-7.2.2-3.4){.pilcrow}]{#section-7.2.2-3.4}
-   [Confirmation Value Type(s): binary
    string[¶](#section-7.2.2-3.5){.pilcrow}]{#section-7.2.2-3.5}
-   [Change Controller:
    IESG[¶](#section-7.2.2-3.6){.pilcrow}]{#section-7.2.2-3.6}
-   [Specification Document(s): [Section 3.4](#KidPoP){.xref} of RFC
    8747[¶](#section-7.2.2-3.7){.pilcrow}]{#section-7.2.2-3.7}
:::
:::
:::
:::
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[IANA.CWT.Claims\]
:   [IANA]{.refAuthor}, [\"CBOR Web Token Claims\"]{.refTitle},
    \<<https://www.iana.org/assignments/cwt>\>.

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.

\[RFC7049\]
:   [Bormann, C.]{.refAuthor}[ and P. Hoffman]{.refAuthor}, [\"Concise
    Binary Object Representation (CBOR)\"]{.refTitle}, [RFC
    7049]{.seriesInfo}, [DOI 10.17487/RFC7049]{.seriesInfo}, October
    2013, \<<https://www.rfc-editor.org/info/rfc7049>\>.

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.

\[RFC8152\]
:   [Schaad, J.]{.refAuthor}, [\"CBOR Object Signing and Encryption
    (COSE)\"]{.refTitle}, [RFC 8152]{.seriesInfo}, [DOI
    10.17487/RFC8152]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8152>\>.

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.

\[RFC8392\]
:   [Jones, M.]{.refAuthor}[, Wahlstroem, E.]{.refAuthor}[,
    Erdtman, S.]{.refAuthor}[, and H. Tschofenig]{.refAuthor}, [\"CBOR
    Web Token (CWT)\"]{.refTitle}, [RFC 8392]{.seriesInfo}, [DOI
    10.17487/RFC8392]{.seriesInfo}, May 2018,
    \<<https://www.rfc-editor.org/info/rfc8392>\>.
:::

::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[ACE-OAUTH\]
:   [Seitz, L.]{.refAuthor}[, Selander, G.]{.refAuthor}[,
    Wahlstroem, E.]{.refAuthor}[, Erdtman, S.]{.refAuthor}[, and H.
    Tschofenig]{.refAuthor}, [\"Authentication and Authorization for
    Constrained Environments (ACE) using the OAuth 2.0 Framework
    (ACE-OAuth)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-ace-oauth-authz-21]{.seriesInfo}, 14
    February 2019,
    \<<https://tools.ietf.org/html/draft-ietf-ace-oauth-authz-21>\>.

\[IANA.JWT\]
:   [IANA]{.refAuthor}, [\"JSON Web Token (JWT)\"]{.refTitle},
    \<<https://www.iana.org/assignments/jwt>\>.

\[JWS\]
:   [Jones, M.]{.refAuthor}[, Bradley, J.]{.refAuthor}[, and N.
    Sakimura]{.refAuthor}, [\"JSON Web Signature (JWS)\"]{.refTitle},
    [RFC 7515]{.seriesInfo}, [DOI 10.17487/RFC7515]{.seriesInfo}, May
    2015, \<<https://www.rfc-editor.org/info/rfc7515>\>.

\[JWT\]
:   [Jones, M.]{.refAuthor}[, Bradley, J.]{.refAuthor}[, and N.
    Sakimura]{.refAuthor}, [\"JSON Web Token (JWT)\"]{.refTitle}, [RFC
    7519]{.seriesInfo}, [DOI 10.17487/RFC7519]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7519>\>.

\[OASIS.saml-core-2.0-os\]
:   [Cantor, S.]{.refAuthor}[, Kemp, J.]{.refAuthor}[,
    Philpott, R.]{.refAuthor}[, and E. Maler]{.refAuthor}, [\"Assertions
    and Protocol for the OASIS Security Assertion Markup Language (SAML)
    V2.0\"]{.refTitle}, [OASIS Standard saml-core-2.0-os]{.seriesInfo},
    March 2005,
    \<<https://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf>\>.

\[RFC7800\]
:   [Jones, M.]{.refAuthor}[, Bradley, J.]{.refAuthor}[, and H.
    Tschofenig]{.refAuthor}, [\"Proof-of-Possession Key Semantics for
    JSON Web Tokens (JWTs)\"]{.refTitle}, [RFC 7800]{.seriesInfo}, [DOI
    10.17487/RFC7800]{.seriesInfo}, April 2016,
    \<<https://www.rfc-editor.org/info/rfc7800>\>.

\[RFC8259\]
:   [Bray, T., Ed.]{.refAuthor}, [\"The JavaScript Object Notation
    (JSON) Data Interchange Format\"]{.refTitle}, [STD 90]{.seriesInfo},
    [RFC 8259]{.seriesInfo}, [DOI 10.17487/RFC8259]{.seriesInfo},
    December 2017, \<<https://www.rfc-editor.org/info/rfc8259>\>.

\[RFC8610\]
:   [Birkholz, H.]{.refAuthor}[, Vigano, C.]{.refAuthor}[, and C.
    Bormann]{.refAuthor}, [\"Concise Data Definition Language (CDDL): A
    Notational Convention to Express Concise Binary Object
    Representation (CBOR) and JSON Data Structures\"]{.refTitle}, [RFC
    8610]{.seriesInfo}, [DOI 10.17487/RFC8610]{.seriesInfo}, June 2019,
    \<<https://www.rfc-editor.org/info/rfc8610>\>.
:::
:::

::: {#Acknowledgements}
::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to the following people for their reviews of the specification:
[Roman Danyliw]{.contact-name}, [Christer Holmberg]{.contact-name},
[Benjamin Kaduk]{.contact-name}, [Mirja Kühlewind]{.contact-name}, [Yoav
Nir]{.contact-name}, [Michael Richardson]{.contact-name}, [Adam
Roach]{.contact-name}, [Éric Vyncke]{.contact-name}, and [Jim
Schaad]{.contact-name}.[¶](#section-appendix.a-1){.pilcrow}

[Ludwig Seitz]{.contact-name} and [Göran Selander]{.contact-name} worked
on this document as part of the CelticPlus projects CyberWI and
CRITISEC, with funding from Vinnova.[¶](#section-appendix.a-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Michael B. Jones]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Microsoft]{.org}
:::

::: email
Email: <mbj@microsoft.com>
:::

::: url
URI: <https://self-issued.info/>
:::

::: {.left dir="auto"}
[Ludwig Seitz]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Combitech]{.org}
:::

::: {.left dir="auto"}
[Djaeknegatan 31]{.street-address}
:::

::: {.left dir="auto"}
[211 35]{.postal-code} [Malmö]{.locality}
:::

::: {.left dir="auto"}
[Sweden]{.country-name}
:::

::: email
Email: <ludwig.seitz@combitech.se>
:::

::: {.left dir="auto"}
[Göran Selander]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson AB]{.org}
:::

::: {.left dir="auto"}
[164 80]{.postal-code} [Kista]{.locality}
:::

::: {.left dir="auto"}
[Sweden]{.country-name}
:::

::: email
Email: <goran.selander@ericsson.com>
:::

::: {.left dir="auto"}
[Samuel Erdtman]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Spotify]{.org}
:::

::: email
Email: <erdtman@spotify.com>
:::

::: {.left dir="auto"}
[Hannes Tschofenig]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Arm Ltd.]{.org}
:::

::: {.left dir="auto"}
[6060]{.postal-code} [Hall in Tirol]{.locality}
:::

::: {.left dir="auto"}
[Austria]{.country-name}
:::

::: email
Email: <Hannes.Tschofenig@arm.com>
:::
:::
:::
