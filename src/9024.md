  RFC 9024        TSN over DetNet MPLS   June 2021
  --------------- ---------------------- -----------
  Varga, et al.   Standards Track        \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9024](https://www.rfc-editor.org/rfc/rfc9024){.eref}

Category:
:   Standards Track

Published:
:   June 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    B. Varga, [Ed.]{.editor}
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    J. Farkas
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    A. Malis
    :::

    ::: org
    Malis Consulting
    :::
    :::

    ::: author
    ::: author-name
    S. Bryant
    :::

    ::: org
    Futurewei Technologies
    :::
    :::

    ::: author
    ::: author-name
    D. Fedyk
    :::

    ::: org
    LabN Consulting, L.L.C.
    :::
    :::
:::

# RFC 9024 {#rfcnum}

# Deterministic Networking (DetNet) Data Plane: IEEE 802.1 Time-Sensitive Networking over MPLS {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies the Deterministic Networking data plane when
Time-Sensitive Networking (TSN) networks are interconnected over a
DetNet MPLS network.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9024>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Terms Used in This
        Document](#name-terms-used-in-this-document){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Abbreviations](#name-abbreviations){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [IEEE 802.1 TSN over DetNet MPLS Data Plane
    Scenario](#name-ieee-8021-tsn-over-detnet-m){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [DetNet MPLS Data
    Plane](#name-detnet-mpls-data-plane){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Overview](#name-overview){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [TSN over DetNet MPLS
        Encapsulation](#name-tsn-over-detnet-mpls-encaps){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [TSN over MPLS Data Plane
    Procedures](#name-tsn-over-mpls-data-plane-pr){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Edge Node TSN
        Procedures](#name-edge-node-tsn-procedures){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Edge Node DetNet Service Proxy
        Procedures](#name-edge-node-detnet-service-pr){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Edge Node DetNet Service and
        Forwarding Sub-Layer
        Procedures](#name-edge-node-detnet-service-an){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Controller Plane (Management and Control)
    Considerations](#name-controller-plane-management){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#sec_intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Time-Sensitive Networking Task Group (TSN TG) within the IEEE 802.1
Working Group deals with deterministic services through IEEE 802
networks. Deterministic Networking (DetNet) defined by the IETF is a
service that can be offered by an L3 network to DetNet flows. General
background and concepts of DetNet can be found in
\[[RFC8655](#RFC8655){.xref}\].[¶](#section-1-1){.pilcrow}

This document specifies the use of a DetNet MPLS network to interconnect
TSN nodes/network segments. The DetNet MPLS data plane is defined in
\[[RFC8964](#RFC8964){.xref}\].[¶](#section-1-2){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Terms Used in This Document](#name-terms-used-in-this-document){.section-name .selfRef} {#name-terms-used-in-this-document}

This document uses the terminology and concepts established in the
DetNet architecture \[[RFC8655](#RFC8655){.xref}\]
\[[RFC8938](#RFC8938){.xref}\] \[[RFC8964](#RFC8964){.xref}\].
TSN-specific terms are defined in the TSN TG of the IEEE 802.1 Working
Group. The reader is assumed to be familiar with these documents and
their terminology.[¶](#section-2.1-1){.pilcrow}
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Abbreviations](#name-abbreviations){.section-name .selfRef} {#name-abbreviations}

The following abbreviations are used in this
document:[¶](#section-2.2-1){.pilcrow}

[]{.break}

AC
:   Attachment Circuit[¶](#section-2.2-2.2){.pilcrow}
:   

CE
:   Customer Edge equipment[¶](#section-2.2-2.4){.pilcrow}
:   

d-CW
:   DetNet Control Word[¶](#section-2.2-2.6){.pilcrow}
:   

DetNet
:   Deterministic Networking[¶](#section-2.2-2.8){.pilcrow}
:   

DF
:   DetNet Flow[¶](#section-2.2-2.10){.pilcrow}
:   

FRER
:   Frame Replication and Elimination for Redundancy (TSN
    function)[¶](#section-2.2-2.12){.pilcrow}
:   

L2
:   Layer 2[¶](#section-2.2-2.14){.pilcrow}
:   

L2VPN
:   Layer 2 Virtual Private Network[¶](#section-2.2-2.16){.pilcrow}
:   

L3
:   Layer 3[¶](#section-2.2-2.18){.pilcrow}
:   

LSP
:   Label Switched Path[¶](#section-2.2-2.20){.pilcrow}
:   

LSR
:   Label Switching Router[¶](#section-2.2-2.22){.pilcrow}
:   

MPLS
:   Multiprotocol Label Switching[¶](#section-2.2-2.24){.pilcrow}
:   

MPLS-TE
:   Multiprotocol Label Switching - Traffic
    Engineering[¶](#section-2.2-2.26){.pilcrow}
:   

NSP
:   Native Service Processing[¶](#section-2.2-2.28){.pilcrow}
:   

OAM
:   Operations, Administration, and
    Maintenance[¶](#section-2.2-2.30){.pilcrow}
:   

PE
:   Provider Edge[¶](#section-2.2-2.32){.pilcrow}
:   

PREOF
:   Packet Replication, Elimination and Ordering
    Functions[¶](#section-2.2-2.34){.pilcrow}
:   

PW
:   Pseudowire[¶](#section-2.2-2.36){.pilcrow}
:   

S-PE
:   Switching Provider Edge[¶](#section-2.2-2.38){.pilcrow}
:   

T-PE
:   Terminating Provider Edge[¶](#section-2.2-2.40){.pilcrow}
:   

TSN
:   Time-Sensitive Network[¶](#section-2.2-2.42){.pilcrow}
:   
:::

::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.3-1){.pilcrow}
:::
:::

::: {#sec_tsn_mpls_dt_dp_scen}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [IEEE 802.1 TSN over DetNet MPLS Data Plane Scenario](#name-ieee-8021-tsn-over-detnet-m){.section-name .selfRef} {#name-ieee-8021-tsn-over-detnet-m}

[Figure 1](#fig_tsn_mpls_detnet){.xref} shows IEEE 802.1 TSN end
stations operating over a TSN-aware DetNet service running over an MPLS
network. DetNet edge nodes sit at the boundary of a DetNet domain. They
are responsible for mapping non-DetNet-aware L2 traffic to DetNet
services. They also support the imposition and disposition of the
required DetNet encapsulation. These are functionally similar to PW T-PE
nodes, which use MPLS-TE LSPs. In this example, TSN Streams are simple
applications over DetNet flows. The specifics of this operation are
discussed later in this document.[¶](#section-3-1){.pilcrow}

[]{#name-a-tsn-over-detnet-mpls-enab}

::: {#fig_tsn_mpls_detnet}
::: {#section-3-2.1 .artwork .art-text .alignCenter}
       TSN           Edge          Transit         Edge          TSN
    End System       Node           Node           Node       End System
                    (T-PE)         (LSR)          (T-PE)

    +----------+                                             +----------+
    |   TSN    | <-------- End-to-End TSN Service ---------> |   TSN    |
    |  Applic. |                                             |  Applic. |
    +----------+  +.........+                   +.........+  +----------+
    |          |  | \S-Proxy:                   :S-Proxy/ |  |          |
    |   TSN    |  |   +.+---+<-- DetNet flow -->+---+ |   |  |   TSN    |
    |          |  |TSN| |Svc|                   |Svc| |TSN|  |          |
    +----------+  +---+ +---+    +----------+   +---+ +---+  +----------+
    |   L2     |  | L2| |Fwd|    |Forwarding|   |Fwd| |L2 |  |   L2     |
    +------.---+  +-.-+ +-.-+    +---.----.-+   +--.+ +-.-+  +---.------+
           :  Link  :     /  ,-----.  \   :  Link  :   /  ,-----. \
           +........+     +-[  Sub- ]-+   +........+   +-[  TSN  ]-+
                            [Network]                    [Network]
                             `-----'                      `-----'

                        |<------ DetNet MPLS ------>|
            |<---------------------- TSN   --------------------->|
:::

[Figure 1](#figure-1){.selfRef}: [A TSN over DetNet MPLS-Enabled
Network](#name-a-tsn-over-detnet-mpls-enab){.selfRef}
:::

In this example, edge nodes provide a service proxy function that
\"associates\" the DetNet flows and native flows (i.e., TSN Streams) at
the edge of the DetNet domain. TSN Streams are treated as App-flows for
DetNet. The whole DetNet domain behaves as a TSN relay node for the TSN
Streams. The service proxy behaves as a port of that TSN relay
node.[¶](#section-3-3){.pilcrow}

[Figure 2](#fig_8021_detnet){.xref} illustrates how DetNet can provide
services for IEEE 802.1 TSN end systems, CE1 and CE2, over a
DetNet-enabled MPLS network. Edge nodes E1 and E2 insert and remove the
required DetNet data plane encapsulation. The \'X\' in the edge nodes
and relay node, R1, represent a potential DetNet compound flow packet
replication and elimination point. This conceptually parallels L2VPN
services and could leverage existing related solutions as discussed
below.[¶](#section-3-4){.pilcrow}

[]{#name-ieee-8021tsn-over-detnet}

::: {#fig_8021_detnet}
::: {#section-3-5.1 .artwork .art-text .alignLeft}
         TSN    |<------- End-to-End DetNet Service ------>|  TSN
        Service |         Transit          Transit         | Service
    TSN  (AC)   |        |<-Tnl->|        |<-Tnl->|        |  (AC)  TSN
    End    |    V        V    1  V        V   2   V        V   |    End
    System |    +--------+       +--------+       +--------+   |  System
    +---+  |    |   E1   |=======|   R1   |=======|   E2   |   |   +---+
    |   |--|----|._X_....|..DF1..|.._ _...|..DF3..|...._X_.|---|---|   |
    |CE1|  |    |    \   |       |   X    |       |   /    |   |   |CE2|
    |   |       |     \_.|..DF2..|._/ \_..|..DF4..|._/     |       |   |
    +---+       |        |=======|        |=======|        |       +---+
        ^       +--------+       +--------+       +--------+       ^
        |        Edge Node       Relay Node        Edge Node       |
        |          (T-PE)           (S-PE)          (T-PE)         |
        |                                                          |
        |<- TSN -> <------- TSN over DetNet MPLS -------> <- TSN ->|
        |                                                          |
        |<-------- Time-Sensitive Networking (TSN) Service ------->|

        X   = Service protection
        DFx = DetNet member flow x over a TE LSP
            AC  = Attachment Circuit
            Tnl = Tunnel
:::

[Figure 2](#figure-2){.selfRef}: [IEEE 802.1TSN over
DetNet](#name-ieee-8021tsn-over-detnet){.selfRef}
:::
:::
:::

::: {#sec_dt_dp}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [DetNet MPLS Data Plane](#name-detnet-mpls-data-plane){.section-name .selfRef} {#name-detnet-mpls-data-plane}

::: {#sec_dt_dp_ov}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Overview](#name-overview){.section-name .selfRef} {#name-overview}

The basic approach defined in \[[RFC8964](#RFC8964){.xref}\] supports
the DetNet service sub-layer based on existing PW encapsulations and
mechanisms and supports the DetNet forwarding sub-layer based on
existing MPLS Traffic Engineering encapsulations and
mechanisms.[¶](#section-4.1-1){.pilcrow}

A node operating on a DetNet flow in the DetNet service sub-layer, i.e.,
a node processing a DetNet packet that has the S-Label as top of stack,
uses the local context associated with that S-Label. For example, a
received F-Label can be used to determine what local DetNet operation(s)
is applied to that packet. An S-Label may be unique when taken from the
platform label space \[[RFC3031](#RFC3031){.xref}\], which would enable
correct DetNet flow identification regardless of which input interface
or LSP the packet arrives on. The service sub-layer functions (i.e.,
PREOF) use a DetNet control word (d-CW).[¶](#section-4.1-2){.pilcrow}

The DetNet MPLS data plane builds on MPLS Traffic Engineering
encapsulations and mechanisms to provide a forwarding sub-layer that is
responsible for providing resource allocation and explicit routes. The
forwarding sub-layer is supported by one or more forwarding labels
(F-Labels).[¶](#section-4.1-3){.pilcrow}

DetNet edge/relay nodes are DetNet service sub-layer aware, understand
the particular needs of DetNet flows, and provide both DetNet service
and forwarding sub-layer functions. They add, remove, and process d-CWs,
S-Labels, and F-Labels as needed. MPLS DetNet nodes and transit nodes
include DetNet forwarding sub-layer functions \-- notably, support for
explicit routes and resource allocation to eliminate (or reduce)
congestion loss and jitter. Unlike other DetNet node types, transit
nodes provide no service sub-layer
processing.[¶](#section-4.1-4){.pilcrow}
:::
:::

::: {#tom-encap}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [TSN over DetNet MPLS Encapsulation](#name-tsn-over-detnet-mpls-encaps){.section-name .selfRef} {#name-tsn-over-detnet-mpls-encaps}

The basic encapsulation approach is to treat a TSN Stream as an App-flow
from the DetNet MPLS perspective. The corresponding example is shown in
[Figure 3](#fig_tsn_mpls_ex){.xref}. Note that three example flows are
shown in the figure.[¶](#section-4.2-1){.pilcrow}

[]{#name-examples-of-tsn-over-mpls-e}

::: {#fig_tsn_mpls_ex}
::: {#section-4.2-2.1 .artwork .art-text .alignCenter}

               /->     +------+  +------+  +------+   TSN      ^ ^
      MPLS     |       |  X   |  |  X   |  |  X   |<- Appli    : :
    App-Flow <-+       +------+  +------+  +------+   cation   : :(1)
               |       |TSN-L2|  |TSN-L2|  |TSN-L2|            : v
               \-> +---+======+--+======+--+======+-----+      :
                       | d-CW |  | d-CW |  | d-CW |            :
    DetNet-MPLS        +------+  +------+  +------+            :(2)
                       |Labels|  |Labels|  |Labels|            v
                   +---+======+--+======+--+======+-----+
    Link/Sub-Network   |  L2  |  | TSN  |  | UDP  |
                       +------+  +------+  +------+
                                           |  IP  |
                                           +------+
                                           |  L2  |
                                           +------+
        (1) TSN Stream
        (2) DetNet MPLS Flow
:::

[Figure 3](#figure-3){.selfRef}: [Examples of TSN over MPLS
Encapsulation Formats](#name-examples-of-tsn-over-mpls-e){.selfRef}
:::

In the figure, \"Application\" indicates the application payload carried
by the TSN network. \"MPLS App-Flow\" indicates that the TSN Stream is
the payload from the perspective of the DetNet MPLS data plane defined
in \[[RFC8964](#RFC8964){.xref}\]. A single DetNet MPLS flow can
aggregate multiple TSN Streams.[¶](#section-4.2-3){.pilcrow}

Note: Network fragmentation for DetNet is not supported and MUST be
avoided. The reason for this is that network fragmentation is not
consistent with the packet delivery times needed for DetNet. Therefore,
when IP is used as the sub-network, IPv6 fragmentation MUST NOT be used,
and IPv4 packets MUST be sent with the DF bit set. This means that the
network operator MUST ensure that all the DetNet encapsulation overhead
plus the maximum TSN App-flow frame size does not exceed the DetNet
network\'s MTU.[¶](#section-4.2-4.1){.pilcrow}
:::
:::
:::
:::

::: {#tom_proc}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [TSN over MPLS Data Plane Procedures](#name-tsn-over-mpls-data-plane-pr){.section-name .selfRef} {#name-tsn-over-mpls-data-plane-pr}

The description of edge node procedures and functions for TSN over
DetNet MPLS scenarios follows the concepts from
\[[RFC3985](#RFC3985){.xref}\] and covers the edge node components shown
in [Figure 1](#fig_tsn_mpls_detnet){.xref}. In this section, the
following procedures of DetNet edge nodes are
described:[¶](#section-5-1){.pilcrow}

-   [TSN related ([Section
    5.1](#tom_tsn_proc){.xref})[¶](#section-5-2.1){.pilcrow}]{#section-5-2.1}
-   [DetNet Service Proxy ([Section
    5.2](#tom_svc_prx_proc){.xref})[¶](#section-5-2.2){.pilcrow}]{#section-5-2.2}
-   [DetNet service and forwarding sub-layer ([Section
    5.3](#tom_dn_sub_proc){.xref})[¶](#section-5-2.3){.pilcrow}]{#section-5-2.3}

The subsections describe procedures for forwarding packets by DetNet
edge nodes, where such packets are received from either directly
connected CEs (TSN nodes) or some other DetNet edge
nodes.[¶](#section-5-3){.pilcrow}

::: {#tom_tsn_proc}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Edge Node TSN Procedures](#name-edge-node-tsn-procedures){.section-name .selfRef} {#name-edge-node-tsn-procedures}

The TSN TG of the IEEE 802.1 Working Group has defined (and is defining)
a number of amendments to \[[IEEE8021Q](#IEEE8021Q){.xref}\] that
provide zero congestion loss and bounded latency in bridged networks.
\[[IEEE8021CB](#IEEE8021CB){.xref}\] defines packet replication and
elimination functions for a TSN network.[¶](#section-5.1-1){.pilcrow}

The implementation of a TSN entity (i.e., TSN packet processing
functions) must be compliant with the relevant IEEE 802.1
standards.[¶](#section-5.1-2){.pilcrow}

TSN-specific functions are executed on the data received by the DetNet
edge node from the connected CE before being forwarded to connected
CE(s) or presented to the DetNet service proxy function for transmission
across the DetNet domain. TSN-specific functions are also executed on
the data received from a DetNet PW by a PE before the data is output on
the AC(s).[¶](#section-5.1-3){.pilcrow}

The TSN packet processing function(s) of edge nodes (T-PE) belongs to
the NSP \[[RFC3985](#RFC3985){.xref}\] block. This is similar to other
functionalities being defined by standards bodies other than the IETF
(for example, in the case of Ethernet, stripping, overwriting, or adding
VLAN tags, etc.). Depending on the TSN role of the edge node in the
end-to-end TSN service, selected TSN functions are
supported.[¶](#section-5.1-4){.pilcrow}

When a PE receives a packet from a CE on a given AC with DetNet service,
it first checks via Stream identification (see Clause 6 of
\[[IEEE8021CB](#IEEE8021CB){.xref}\] and
\[[IEEEP8021CBdb](#IEEEP8021CBdb){.xref}\]) whether the packet belongs
to a configured TSN Stream (i.e., App-flow from the DetNet perspective).
If no Stream ID is matched and no other (VPN) service is configured for
the AC, then the packet [MUST]{.bcp14} be dropped. If there is a
matching TSN Stream, then the Stream-ID-specific TSN functions are
executed (e.g., ingress policing, header field manipulation in the case
of active Stream identification, FRER, etc.). Source Media Access
Control (MAC) lookup may also be used for local MAC address
learning.[¶](#section-5.1-5){.pilcrow}

If the PE decides to forward the packet, the packet [MUST]{.bcp14} be
forwarded according to the TSN-Stream-specific configuration to
connected CE(s) (in case of local bridging) and/or to the DetNet service
proxy (in case of forwarding to remote CE(s)). If there are no
TSN-Stream-specific forwarding configurations, the PE [MUST]{.bcp14}
flood the packet to other locally attached CE(s) and to the DetNet
service proxy. If the administrative policy on the PE does not allow
flooding, the PE [MUST]{.bcp14} drop the
packet.[¶](#section-5.1-6){.pilcrow}

When a TSN entity of the PE receives a packet from the DetNet service
proxy, it first checks via Stream identification (see Clause 6 of
\[[IEEE8021CB](#IEEE8021CB){.xref}\] and
\[[IEEEP8021CBdb](#IEEEP8021CBdb){.xref}\]) whether the packet belongs
to a configured TSN Stream. If no Stream ID is matched, then the packet
is dropped. If there is a matching TSN Stream, then the
Stream-ID-specific TSN functions are executed (e.g., header field
manipulation in case of active Stream identification, FRER, etc.).
Source MAC lookup may also be used for local MAC address
learning.[¶](#section-5.1-7){.pilcrow}

If the PE decides to forward the packet, the packet is forwarded
according to the TSN-Stream-specific configuration to connected CE(s).
If there are no TSN-Stream-specific forwarding configurations, the PE
floods the packet to locally attached CE(s). If the administrative
policy on the PE does not allow flooding, the PE drops the
packet.[¶](#section-5.1-8){.pilcrow}

Implementations of this document [SHALL]{.bcp14} use management and
control information to ensure TSN-specific functions of the edge node
according to the expectations of the connected TSN
network.[¶](#section-5.1-9){.pilcrow}
:::
:::

::: {#tom_svc_prx_proc}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Edge Node DetNet Service Proxy Procedures](#name-edge-node-detnet-service-pr){.section-name .selfRef} {#name-edge-node-detnet-service-pr}

The service proxy function maps between App-flows and DetNet flows. The
DetNet edge node TSN entity [MUST]{.bcp14} support the TSN Stream
identification functions (as defined in Clause 6 of
\[[IEEE8021CB](#IEEE8021CB){.xref}\] and
\[[IEEEP8021CBdb](#IEEEP8021CBdb){.xref}\]) and the related managed
objects (as defined in Clause 9 of \[[IEEE8021CB](#IEEE8021CB){.xref}\]
and \[[IEEEP8021CBdb](#IEEEP8021CBdb){.xref}\]) to recognize the packets
related to App-flow. The service proxy presents TSN Streams as an
App-flow to a DetNet flow.[¶](#section-5.2-1){.pilcrow}

When a DetNet service proxy receives a packet from the TSN entity, it
[MUST]{.bcp14} check whether such an App-flow is present in its mapping
table. If present, it associates the internal DetNet flow ID to the
packet and [MUST]{.bcp14} forward it to the DetNet service and
forwarding sub-layers. If no match is found, it [MUST]{.bcp14} drop the
packet.[¶](#section-5.2-2){.pilcrow}

When a DetNet service proxy receives a packet from the DetNet service
and forwarding sub-layers, it [MUST]{.bcp14} be forwarded to the edge
node TSN entity.[¶](#section-5.2-3){.pilcrow}

Implementations of this document [SHALL]{.bcp14} use management and
control information to map a TSN Stream to a DetNet flow. N:1 mapping
(aggregating multiple TSN Streams in a single DetNet flow)
[SHALL]{.bcp14} be supported. The management or control function that
provisions flow mapping [SHALL]{.bcp14} ensure that adequate resources
are allocated and configured to fulfill the service requirements of the
mapped flows.[¶](#section-5.2-4){.pilcrow}

Due to the (intentional) similarities of the DetNet PREOF and TSN FRER
functions, service protection function interworking is possible between
the TSN and the DetNet domains. Such service protection interworking
scenarios might require copying of sequence number fields from TSN (L2)
to PW (MPLS) encapsulation. However, such interworking is out of scope
in this document and is left for further
study.[¶](#section-5.2-5){.pilcrow}
:::
:::

::: {#tom_dn_sub_proc}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Edge Node DetNet Service and Forwarding Sub-Layer Procedures](#name-edge-node-detnet-service-an){.section-name .selfRef} {#name-edge-node-detnet-service-an}

In the design presented in \[[RFC8964](#RFC8964){.xref}\], an MPLS
service label (the S-Label), similar to a PW label
\[[RFC3985](#RFC3985){.xref}\], is used to identify both the DetNet flow
identity and the MPLS payload type. The DetNet sequence number is
carried in the d-CW, which carries the Data/OAM discriminator as well.
In \[[RFC8964](#RFC8964){.xref}\], two sequence number sizes are
supported: a 16-bit sequence number and a 28-bit sequence
number.[¶](#section-5.3-1){.pilcrow}

PREOF functions and the provided service recovery are available only
within the DetNet domain as the DetNet flow ID and the DetNet sequence
number are not valid outside the DetNet network. MPLS (DetNet) edge
nodes terminate all related information elements encoded in the MPLS
labels.[¶](#section-5.3-2){.pilcrow}

When a PE receives a packet from the service proxy function, it
[MUST]{.bcp14} handle the packet as defined in
\[[RFC8964](#RFC8964){.xref}\].[¶](#section-5.3-3){.pilcrow}

When a PE receives an MPLS packet from a remote PE, then, after
processing the MPLS label stack, if the top MPLS label ends up being a
DetNet S-Label that was advertised by this node, then the PE
[MUST]{.bcp14} forward the packet according to the configured DetNet
service and forwarding sub-layer rules to other PE nodes or via the
DetNet service proxy function towards locally connected
CE(s).[¶](#section-5.3-4){.pilcrow}

For further details on DetNet service and forwarding sub-layers, see
\[[RFC8964](#RFC8964){.xref}\].[¶](#section-5.3-5){.pilcrow}
:::
:::
:::
:::

::: {#cp_considerations}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Controller Plane (Management and Control) Considerations](#name-controller-plane-management){.section-name .selfRef} {#name-controller-plane-management}

Information related to TSN Stream(s) to DetNet flow mapping is required
only for the service proxy function of MPLS (DetNet) edge nodes. From
the data plane perspective, there is no practical difference based on
the origin of flow-mapping-related information (management plane or
control plane).[¶](#section-6-1){.pilcrow}

The following summarizes the set of information that is needed to
configure TSN over DetNet MPLS:[¶](#section-6-2){.pilcrow}

-   [TSN-related configuration information according to the TSN role of
    the DetNet MPLS node, as per \[[IEEE8021Q](#IEEE8021Q){.xref}\],
    \[[IEEE8021CB](#IEEE8021CB){.xref}\], and
    \[[IEEEP8021CBdb](#IEEEP8021CBdb){.xref}\].[¶](#section-6-3.1){.pilcrow}]{#section-6-3.1}
-   [DetNet MPLS-related configuration information according to the
    DetNet role of the DetNet MPLS node, as per
    \[[RFC8964](#RFC8964){.xref}\].[¶](#section-6-3.2){.pilcrow}]{#section-6-3.2}
-   [App-flow identification information to map received TSN Stream(s)
    to the DetNet flow. Parameters of TSN Stream identification are
    defined in \[[IEEE8021CB](#IEEE8021CB){.xref}\] and
    \[[IEEEP8021CBdb](#IEEEP8021CBdb){.xref}\].[¶](#section-6-3.3){.pilcrow}]{#section-6-3.3}

This information [MUST]{.bcp14} be provisioned per DetNet
flow.[¶](#section-6-4){.pilcrow}

Mappings between DetNet and TSN management and control planes are out of
scope of the document. Some of the challenges are highlighted
below.[¶](#section-6-5){.pilcrow}

MPLS DetNet edge nodes are a member of both the DetNet domain and the
connected TSN network. From the TSN network perspective, the MPLS
(DetNet) edge node has a \"TSN relay node\" role, so TSN-specific
management and control plane functionalities must be implemented. There
are many similarities in the management plane techniques used in DetNet
and TSN, but that is not the case for the control plane protocols. For
example, RSVP-TE and MSRP behave differently. Therefore, management and
control plane design is an important aspect of scenarios where mapping
between DetNet and TSN is required.[¶](#section-6-6){.pilcrow}

Note that as the DetNet network is just a portion of the end-to-end TSN
path (i.e., single hop from the Ethernet perspective), some parameters
(e.g., delay) may differ significantly. Since there is no interworking
function, the bandwidth of the DetNet network is assumed to be set large
enough to handle all TSN flows it will support. At the egress of the
DetNet domain, the MPLS headers are stripped, and the TSN flow continues
on as a normal TSN flow.[¶](#section-6-7){.pilcrow}

In order to use a DetNet network to interconnect TSN segments,
TSN-specific information must be converted to DetNet-domain-specific
information. TSN Stream ID(s) and stream-related parameters/requirements
must be converted to a DetNet flow ID and flow-related
parameters/requirements.[¶](#section-6-8){.pilcrow}

In some cases, it may be challenging to determine some information
related to the egress-node. For example, it may be not trivial to locate
the egress point/interface of a TSN Stream with a multicast destination
MAC address. Such scenarios may require interaction between control and
management plane functions and between DetNet and TSN
domains.[¶](#section-6-9){.pilcrow}

Mapping between DetNet flow identifiers and TSN Stream identifiers, if
not provided explicitly, can be done by the service proxy function of an
MPLS (DetNet) edge node locally based on information provided for the
configuration of the TSN Stream identification functions (e.g.,
Mask-and-Match Stream identification).[¶](#section-6-10){.pilcrow}

Triggering the setup/modification of a DetNet flow in the DetNet network
is an example where management and/or control plane interactions are
required between the DetNet and the TSN
network.[¶](#section-6-11){.pilcrow}

Configuration of TSN-specific functions (e.g., FRER) inside the TSN
network is a TSN-domain-specific decision and may not be visible in the
DetNet domain. Service protection interworking scenarios are left for
further study.[¶](#section-6-12){.pilcrow}
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

Security considerations for DetNet are described in detail in
\[[DETNET-SEC](#I-D.ietf-detnet-security){.xref}\]. General security
considerations are described in
\[[RFC8655](#RFC8655){.xref}\].[¶](#section-7-1){.pilcrow}

Considerations specific to the DetNet MPLS data plane are summarized and
described in \[[RFC8964](#RFC8964){.xref}\], including any application
flow types. This document focuses on a scenario where TSN Streams are
the application flows for DetNet, which is already covered by those
DetNet MPLS data plane security
considerations.[¶](#section-7-2){.pilcrow}
:::

::: {#iana}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-8-1){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[IEEE8021CB\]
:   [IEEE]{.refAuthor}, [\"Standard for Local and metropolitan area
    networks \-- Frame Replication and Elimination for
    Reliability\"]{.refTitle}, [IEEE 802.1CB-2017]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2017.8091139]{.seriesInfo}, October 2017,
    \<<https://ieeexplore.ieee.org/document/8091139>\>.
:   

\[IEEEP8021CBdb\]
:   [IEEE]{.refAuthor}, [\"Draft Standard for Local and metropolitan
    area networks - Frame Replication and Elimination for Reliability -
    Amendment: Extended Stream Identification Functions\"]{.refTitle},
    [IEEE P802.1CBdb D1.3]{.seriesInfo}, April 2021,
    \<<https://1.ieee802.org/tsn/802-1cbdb>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3031\]
:   [Rosen, E.]{.refAuthor}, [Viswanathan, A.]{.refAuthor}, and [R.
    Callon]{.refAuthor}, [\"Multiprotocol Label Switching
    Architecture\"]{.refTitle}, [RFC 3031]{.seriesInfo}, [DOI
    10.17487/RFC3031]{.seriesInfo}, January 2001,
    \<<https://www.rfc-editor.org/info/rfc3031>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8655\]
:   [Finn, N.]{.refAuthor}, [Thubert, P.]{.refAuthor},
    [Varga, B.]{.refAuthor}, and [J. Farkas]{.refAuthor},
    [\"Deterministic Networking Architecture\"]{.refTitle}, [RFC
    8655]{.seriesInfo}, [DOI 10.17487/RFC8655]{.seriesInfo}, October
    2019, \<<https://www.rfc-editor.org/info/rfc8655>\>.
:   

\[RFC8938\]
:   [Varga, B., Ed.]{.refAuthor}, [Farkas, J.]{.refAuthor},
    [Berger, L.]{.refAuthor}, [Malis, A.]{.refAuthor}, and [S.
    Bryant]{.refAuthor}, [\"Deterministic Networking (DetNet) Data Plane
    Framework\"]{.refTitle}, [RFC 8938]{.seriesInfo}, [DOI
    10.17487/RFC8938]{.seriesInfo}, November 2020,
    \<<https://www.rfc-editor.org/info/rfc8938>\>.
:   

\[RFC8964\]
:   [Varga, B., Ed.]{.refAuthor}, [Farkas, J.]{.refAuthor},
    [Berger, L.]{.refAuthor}, [Malis, A.]{.refAuthor},
    [Bryant, S.]{.refAuthor}, and [J. Korhonen]{.refAuthor},
    [\"Deterministic Networking (DetNet) Data Plane: MPLS\"]{.refTitle},
    [RFC 8964]{.seriesInfo}, [DOI 10.17487/RFC8964]{.seriesInfo},
    January 2021, \<<https://www.rfc-editor.org/info/rfc8964>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[DETNET-SEC\]
:   [Grossman, E., Ed.]{.refAuthor}, [Mizrahi, T.]{.refAuthor}, and [A.
    Hacker]{.refAuthor}, [\"Deterministic Networking (DetNet) Security
    Considerations\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-detnet-security-16]{.seriesInfo}, 2
    March 2021,
    \<<https://tools.ietf.org/html/draft-ietf-detnet-security-16>\>.
:   

\[IEEE8021Q\]
:   [IEEE]{.refAuthor}, [\"Standard for Local and Metropolitan Area
    Networks\--Bridges and Bridged Networks\"]{.refTitle}, [IEEE Std.
    802.1Q-2018]{.seriesInfo}, [DOI
    10.1109/IEEESTD.2018.8403927]{.seriesInfo}, July 2018,
    \<<https://ieeexplore.ieee.org/document/8403927>\>.
:   

\[RFC3985\]
:   [Bryant, S., Ed.]{.refAuthor} and [P. Pate, Ed.]{.refAuthor},
    [\"Pseudo Wire Emulation Edge-to-Edge (PWE3)
    Architecture\"]{.refTitle}, [RFC 3985]{.seriesInfo}, [DOI
    10.17487/RFC3985]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc3985>\>.
:   
:::
:::

::: {#acks}
::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The authors wish to thank [Norman Finn]{.contact-name}, [Lou
Berger]{.contact-name}, [Craig Gunther]{.contact-name}, [Christophe
Mangin]{.contact-name}, and [Jouni Korhonen]{.contact-name} for their
various contributions to this work.[¶](#section-appendix.a-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Balázs Varga ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
[Budapest]{.locality}
:::

::: {.left dir="auto"}
[Magyar Tudosok krt. 11.]{.street-address}
:::

::: {.left dir="auto"}
[1117]{.postal-code}
:::

::: {.left dir="auto"}
[Hungary]{.country-name}
:::

::: email
Email: <balazs.a.varga@ericsson.com>
:::

::: {.left dir="auto"}
[János Farkas]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
[Budapest]{.locality}
:::

::: {.left dir="auto"}
[Magyar Tudosok krt. 11.]{.street-address}
:::

::: {.left dir="auto"}
[1117]{.postal-code}
:::

::: {.left dir="auto"}
[Hungary]{.country-name}
:::

::: email
Email: <janos.farkas@ericsson.com>
:::

::: {.left dir="auto"}
[Andrew G. Malis]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Malis Consulting]{.org}
:::

::: email
Email: <agmalis@gmail.com>
:::

::: {.left dir="auto"}
[Stewart Bryant]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Futurewei Technologies]{.org}
:::

::: email
Email: <sb@stewartbryant.com>
:::

::: {.left dir="auto"}
[Don Fedyk]{.fn .nameRole}
:::

::: {.left dir="auto"}
[LabN Consulting, L.L.C.]{.org}
:::

::: email
Email: <dfedyk@labn.net>
:::
:::
:::
