  RFC 9097         IP Capacity Metrics/Methods   November 2021
  ---------------- ----------------------------- ---------------
  Morton, et al.   Standards Track               \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9097](https://www.rfc-editor.org/rfc/rfc9097){.eref}

Category:
:   Standards Track

Published:
:   November 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    A. Morton
    :::

    ::: org
    AT&T Labs
    :::
    :::

    ::: author
    ::: author-name
    R. Geib
    :::

    ::: org
    Deutsche Telekom
    :::
    :::

    ::: author
    ::: author-name
    L. Ciavattone
    :::

    ::: org
    AT&T Labs
    :::
    :::
:::

# RFC 9097 {#rfcnum}

# Metrics and Methods for One-Way IP Capacity {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This memo revisits the problem of Network Capacity Metrics first
examined in RFC 5136. This memo specifies a more practical Maximum
IP-Layer Capacity Metric definition catering to measurement and outlines
the corresponding Methods of
Measurement.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9097>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Scope, Goals, and
    Applicability](#name-scope-goals-and-applicabili){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Motivation](#name-motivation){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [General Parameters and
    Definitions](#name-general-parameters-and-defi){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IP-Layer Capacity Singleton Metric
    Definitions](#name-ip-layer-capacity-singleton){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Formal
        Name](#name-formal-name){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Parameters](#name-parameters){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Metric
        Definitions](#name-metric-definitions){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Related Round-Trip Delay and
        One-Way Loss
        Definitions](#name-related-round-trip-delay-an){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Discussion](#name-discussion){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [Reporting the
        Metric](#name-reporting-the-metric){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Maximum IP-Layer Capacity Metric
    Definitions (Statistics)](#name-maximum-ip-layer-capacity-m){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Formal
        Name](#name-formal-name-2){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Parameters](#name-parameters-2){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Metric
        Definitions](#name-metric-definitions-2){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.4}
        [6.4](#section-6.4){.xref}.  [Related Round-Trip Delay and
        One-Way Loss
        Definitions](#name-related-round-trip-delay-and){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.5}
        [6.5](#section-6.5){.xref}.  [Discussion](#name-discussion-2){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.6}
        [6.6](#section-6.6){.xref}.  [Reporting the
        Metric](#name-reporting-the-metric-2){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IP-Layer Sender Bit Rate Singleton Metric
    Definitions](#name-ip-layer-sender-bit-rate-si){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Formal
        Name](#name-formal-name-3){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Parameters](#name-parameters-3){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Metric
        Definition](#name-metric-definition){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [Discussion](#name-discussion-3){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.5}
        [7.5](#section-7.5){.xref}.  [Reporting the
        Metric](#name-reporting-the-metric-3){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Method of
    Measurement](#name-method-of-measurement){.xref}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Load Rate Adjustment
        Algorithm](#name-load-rate-adjustment-algori){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Measurement Qualification or
        Verification](#name-measurement-qualification-o){.xref}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [Measurement
        Considerations](#name-measurement-considerations){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Reporting
    Formats](#name-reporting-formats){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Configuration and Reporting Data
        Formats](#name-configuration-and-reporting){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.12.2.1}
        [12.1](#section-12.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [12.2](#section-12.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [Appendix A](#appendix-A){.xref}.  [Load Rate Adjustment
    Pseudocode](#name-load-rate-adjustment-pseudo){.xref}
    :::

-   ::: {#section-toc.1-1.14}
    [Appendix B](#appendix-B){.xref}.  [RFC 8085 UDP Guidelines
    Check](#name-rfc-8085-udp-guidelines-che){.xref}

    -   ::: {#section-toc.1-1.14.2.1}
        [B.1](#appendix-B.1){.xref}.  [Assessment of Mandatory
        Requirements](#name-assessment-of-mandatory-req){.xref}
        :::

    -   ::: {#section-toc.1-1.14.2.2}
        [B.2](#appendix-B.2){.xref}.  [Assessment of
        Recommendations](#name-assessment-of-recommendatio){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.15}
    [](#appendix-C){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.16}
    [](#appendix-D){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The IETF\'s efforts to define Network Capacity and Bulk Transport
Capacity (BTC) have been chartered and progressed for over twenty years.
Over that time, the performance community has seen the development of
Informative definitions in \[[RFC3148](#RFC3148){.xref}\] for the
Framework for Bulk Transport Capacity, \[[RFC5136](#RFC5136){.xref}\]
for Network Capacity and Maximum IP-Layer Capacity, and the Experimental
metric definitions and methods in \"[Model-Based Metrics for Bulk
Transport Capacity](#RFC8337){.xref}\"
\[[RFC8337](#RFC8337){.xref}\].[¶](#section-1-1){.pilcrow}

This memo revisits the problem of Network Capacity Metrics examined
first in \[[RFC3148](#RFC3148){.xref}\] and later in
\[[RFC5136](#RFC5136){.xref}\]. Maximum IP-Layer Capacity and Bulk
Transfer Capacity \[[RFC3148](#RFC3148){.xref}\] (goodput) are different
metrics. Maximum IP-Layer Capacity is like the theoretical goal for
goodput. There are many metrics in \[[RFC5136](#RFC5136){.xref}\], such
as Available Capacity. Measurements depend on the network path under
test and the use case. Here, the main use case is to assess the Maximum
Capacity of one or more networks where the subscriber receives specific
performance assurances, sometimes referred to as Internet access, or
where a limit of the technology used on a path is being tested. For
example, when a user subscribes to a 1 Gbps service, then the user, the
Service Provider, and possibly other parties want to assure that the
specified performance level is delivered. When a test confirms the
subscribed performance level, a tester can seek the location of a
bottleneck elsewhere.[¶](#section-1-2){.pilcrow}

This memo recognizes the importance of a definition of a Maximum
IP-Layer Capacity Metric at a time when Internet subscription speeds
have increased dramatically \-- a definition that is both practical and
effective for the performance community\'s needs, including Internet
users. The metric definitions are intended to use Active Methods of
Measurement \[[RFC7799](#RFC7799){.xref}\], and a Method of Measurement
is included for each metric.[¶](#section-1-3){.pilcrow}

The most direct Active Measurement of IP-Layer Capacity would use IP
packets, but in practice a transport header is needed to traverse
address and port translators. UDP offers the most direct assessment
possibility, and in the measurement study to investigate whether UDP is
viable as a general Internet transport protocol
\[[copycat](#copycat){.xref}\], the authors found that a high percentage
of paths tested support UDP transport. A number of liaison statements
have been exchanged on this topic \[[LS-SG12-A](#LS-SG12-A){.xref}\]
\[[LS-SG12-B](#LS-SG12-B){.xref}\], discussing the laboratory and field
tests that support the UDP-based approach to IP-Layer Capacity
measurement.[¶](#section-1-4){.pilcrow}

This memo also recognizes the updates to the IP Performance Metrics
(IPPM) Framework \[[RFC2330](#RFC2330){.xref}\] that have been published
since 1998. In particular, it makes use of
\[[RFC7312](#RFC7312){.xref}\] for the Advanced Stream and Sampling
Framework and \[[RFC8468](#RFC8468){.xref}\] for its IPv4, IPv6, and
IPv4-IPv6 Coexistence Updates.[¶](#section-1-5){.pilcrow}

[Appendix A](#app-a-load-rate-adj-pseudocode){.xref} describes the load
rate adjustment algorithm, using pseudocode. [Appendix
B](#app-b-rfc8085-udp){.xref} discusses the algorithm\'s compliance with
\[[RFC8085](#RFC8085){.xref}\].[¶](#section-1-6){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-1.1-1){.pilcrow}
:::
:::

::: {#sec-2-scope}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Scope, Goals, and Applicability](#name-scope-goals-and-applicabili){.section-name .selfRef} {#name-scope-goals-and-applicabili}

The scope of this memo is to define Active Measurement metrics and
corresponding methods to unambiguously determine Maximum IP-Layer
Capacity and useful secondary metrics.[¶](#section-2-1){.pilcrow}

Another goal is to harmonize the specified Metric and Method across the
industry, and this memo is the vehicle that captures IETF consensus,
possibly resulting in changes to the specifications of other Standards
Development Organizations (SDOs) (through each SDO\'s normal
contribution process or through liaison
exchange).[¶](#section-2-2){.pilcrow}

Secondary goals are to add considerations for test procedures and to
provide interpretation of the Maximum IP-Layer Capacity results (to
identify cases where more testing is warranted, possibly with alternate
configurations). Fostering the development of protocol support for this
Metric and Method of Measurement is also a goal of this memo (all active
testing protocols currently defined by the IPPM WG are UDP based,
meeting a key requirement of these methods). The supporting protocol
development to measure this metric according to the specified method is
a key future contribution to Internet
measurement.[¶](#section-2-3){.pilcrow}

The load rate adjustment algorithm\'s scope is limited to helping
determine the Maximum IP-Layer Capacity in the context of an infrequent,
diagnostic, short-term measurement. It is [RECOMMENDED]{.bcp14} to
discontinue non-measurement traffic that shares a subscriber\'s
dedicated resources while testing: measurements may not be accurate, and
throughput of competing elastic traffic may be greatly
reduced.[¶](#section-2-4){.pilcrow}

The primary application of the Metrics and Methods of Measurement
described here is the same as what is described in [Section
2](https://www.rfc-editor.org/rfc/rfc7497#section-2){.relref} of
\[[RFC7497](#RFC7497){.xref}\], where:[¶](#section-2-5){.pilcrow}

> The access portion of the network is the focus of this problem
> statement. The user typically subscribes to a service with
> bidirectional \[Internet\] access partly described by rates in bits
> per second.[¶](#section-2-6){.pilcrow}

In addition, the use of the load rate adjustment algorithm described in
[Section 8.1](#load-rate-adj){.xref} has the following additional
applicability limitations:[¶](#section-2-7){.pilcrow}

-   [It [MUST]{.bcp14} only be used in the application of diagnostic and
    operations measurements as described in this
    memo.[¶](#section-2-8.1){.pilcrow}]{#section-2-8.1}
-   [It [MUST]{.bcp14} only be used in circumstances consistent with
    [Section 10](#sec-cons){.xref} (\"Security
    Considerations\").[¶](#section-2-8.2){.pilcrow}]{#section-2-8.2}
-   [If a network operator is certain of the IP-Layer Capacity to be
    validated, then testing [MAY]{.bcp14} start with a fixed-rate test
    at the IP-Layer Capacity and avoid activating the load adjustment
    algorithm. However, the stimulus for a diagnostic test (such as a
    subscriber request) strongly implies that there is no certainty, and
    the load adjustment algorithm is
    [RECOMMENDED]{.bcp14}.[¶](#section-2-8.3){.pilcrow}]{#section-2-8.3}

Further, the Metrics and Methods of Measurement are intended for use
where specific exact path information is unknown within a range of
possible values:[¶](#section-2-9){.pilcrow}

-   [The subscriber\'s exact Maximum IP-Layer Capacity is unknown (which
    is sometimes the case; service rates can be increased due to
    upgrades without a subscriber\'s request or increased to provide a
    surplus to compensate for possible underestimates of TCP-based
    testing).[¶](#section-2-10.1){.pilcrow}]{#section-2-10.1}
-   [The size of the bottleneck buffer is
    unknown.[¶](#section-2-10.2){.pilcrow}]{#section-2-10.2}

Finally, the measurement system\'s load rate adjustment algorithm [SHALL
NOT]{.bcp14} be provided with the exact capacity value to be validated
a priori. This restriction fosters a fair result and removes an
opportunity for nefarious operation enabled by knowledge of the correct
answer.[¶](#section-2-11){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Motivation](#name-motivation){.section-name .selfRef} {#name-motivation}

As with any problem that has been worked on for many years in various
SDOs without any special attempts at coordination, various solutions for
Metrics and Methods have emerged.[¶](#section-3-1){.pilcrow}

There are five factors that have changed (or began to change) in the
2013-2019 time frame, and the presence of any one of them on the path
requires features in the measurement design to account for the
changes:[¶](#section-3-2){.pilcrow}

1.  [Internet access is no longer the bottleneck for many users (but
    subscribers expect network providers to honor contracted
    performance).[¶](#section-3-3.1){.pilcrow}]{#section-3-3.1}
2.  [Both transfer rate and latency are important to a user\'s
    satisfaction.[¶](#section-3-3.2){.pilcrow}]{#section-3-3.2}
3.  [UDP\'s role in transport is growing in areas where TCP once
    dominated.[¶](#section-3-3.3){.pilcrow}]{#section-3-3.3}
4.  [Content and applications are moving physically closer to
    users.[¶](#section-3-3.4){.pilcrow}]{#section-3-3.4}
5.  [There is less emphasis on ISP gateway measurements, possibly due to
    less traffic crossing ISP gateways in the
    future.[¶](#section-3-3.5){.pilcrow}]{#section-3-3.5}
:::

::: {#gen-params-defs}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [General Parameters and Definitions](#name-general-parameters-and-defi){.section-name .selfRef} {#name-general-parameters-and-defi}

This section lists the [REQUIRED]{.bcp14} input factors to specify a
Sender or Receiver metric.[¶](#section-4-1){.pilcrow}

[]{.break}

Src:
:   One of the addresses of a host (such as a globally routable IP
    address).[¶](#section-4-2.2){.pilcrow}
:   

Dst:
:   One of the addresses of a host (such as a globally routable IP
    address).[¶](#section-4-2.4){.pilcrow}
:   

MaxHops:
:   The limit on the number of Hops a specific packet may visit as it
    traverses from the host at Src to the host at Dst (implemented in
    the TTL or Hop Limit).[¶](#section-4-2.6){.pilcrow}
:   

T0:
:   The time at the start of a measurement interval, when packets are
    first transmitted from the Source.[¶](#section-4-2.8){.pilcrow}
:   

I:
:   The nominal duration of a measurement interval at the Destination
    (default 10 sec).[¶](#section-4-2.10){.pilcrow}
:   

dt:
:   The nominal duration of m equal sub-intervals in I at the
    Destination (default 1 sec).[¶](#section-4-2.12){.pilcrow}
:   

dtn:
:   The beginning boundary of a specific sub-interval, n, one of m
    sub-intervals in I.[¶](#section-4-2.14){.pilcrow}
:   

FT:
:   The feedback time interval between status feedback messages
    communicating measurement results, sent from the Receiver to control
    the Sender. The results are evaluated throughout the test to
    determine how to adjust the current offered load rate at the Sender
    (default 50 msec).[¶](#section-4-2.16){.pilcrow}
:   

Tmax:
:   A maximum waiting time for test packets to arrive at the
    Destination, set sufficiently long to disambiguate packets with long
    delays from packets that are discarded (lost), such that the
    distribution of one-way delay is not
    truncated.[¶](#section-4-2.18){.pilcrow}
:   

F:
:   The number of different flows synthesized by the method (default one
    flow).[¶](#section-4-2.20){.pilcrow}
:   

Flow:
:   The stream of packets with the same n-tuple of designated header
    fields that (when held constant) result in identical treatment in a
    multipath decision (such as the decision taken in load balancing).
    Note: The IPv6 flow label [SHOULD]{.bcp14} be included in the flow
    definition when routers have complied with the guidelines provided
    in \[[RFC6438](#RFC6438){.xref}\].[¶](#section-4-2.22){.pilcrow}
:   

Type-P:
:   The complete description of the test packets for which this
    assessment applies (including the flow-defining fields). Note that
    the UDP transport layer is one requirement for test packets
    specified below. Type-P is a concept parallel to \"population of
    interest\" as defined in Clause 6.1.1 of
    \[[Y.1540](#Y.1540){.xref}\].[¶](#section-4-2.24){.pilcrow}
:   

Payload Content:
:   An aspect of the Type-P Parameter that can help to improve
    measurement determinism. Specifying packet payload content helps to
    ensure IPPM Framework-conforming Metrics and Methods. If there is
    payload compression in the path and tests intend to characterize a
    possible advantage due to compression, then payload content
    [SHOULD]{.bcp14} be supplied by a pseudorandom sequence generator,
    by using part of a compressed file, or by other means. See [Section
    3.1.2](https://www.rfc-editor.org/rfc/rfc7312#section-3.1.2){.relref}
    of \[[RFC7312](#RFC7312){.xref}\].[¶](#section-4-2.26){.pilcrow}
:   

PM:
:   A list of fundamental metrics, such as loss, delay, and reordering,
    and corresponding target performance threshold(s). At least one
    fundamental metric and target performance threshold [MUST]{.bcp14}
    be supplied (such as one-way IP packet loss
    \[[RFC7680](#RFC7680){.xref}\] equal to
    zero).[¶](#section-4-2.28){.pilcrow}
:   

A non-Parameter that is required for several metrics is defined
below:[¶](#section-4-3){.pilcrow}

[]{.break}

T:
:   The host time of the **first** test packet\'s **arrival** as
    measured at the Destination Measurement Point, or MP(Dst). There may
    be other packets sent between Source and Destination hosts that are
    excluded, so this is the time of arrival of the first packet used
    for measurement of the metric.[¶](#section-4-4.2){.pilcrow}
:   

Note that timestamp format and resolution, sequence numbers, etc. will
be established by the chosen test protocol standard or
implementation.[¶](#section-4-5){.pilcrow}
:::
:::

::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IP-Layer Capacity Singleton Metric Definitions](#name-ip-layer-capacity-singleton){.section-name .selfRef} {#name-ip-layer-capacity-singleton}

This section sets requirements for the Singleton metric that supports
the Maximum IP-Layer Capacity Metric definitions in [Section
6](#max-ip-metric-defs){.xref}.[¶](#section-5-1){.pilcrow}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Formal Name](#name-formal-name){.section-name .selfRef} {#name-formal-name}

\"Type-P-One-way-IP-Capacity\" is the formal name; it is informally
called \"IP-Layer Capacity\".[¶](#section-5.1-1){.pilcrow}

Note that Type-P depends on the chosen
method.[¶](#section-5.1-2){.pilcrow}
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Parameters](#name-parameters){.section-name .selfRef} {#name-parameters}

This section lists the [REQUIRED]{.bcp14} input factors to specify the
metric, beyond those listed in [Section
4](#gen-params-defs){.xref}.[¶](#section-5.2-1){.pilcrow}

No additional Parameters are needed.[¶](#section-5.2-2){.pilcrow}
:::

::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Metric Definitions](#name-metric-definitions){.section-name .selfRef} {#name-metric-definitions}

This section defines the [REQUIRED]{.bcp14} aspects of the measurable
IP-Layer Capacity Metric (unless otherwise indicated) for measurements
between specified Source and Destination
hosts:[¶](#section-5.3-1){.pilcrow}

Define the IP-Layer Capacity, C(T,dt,PM), to be the number of IP-Layer
bits (including header and data fields) in packets that can be
transmitted from the Src host and correctly received by the Dst host
during one contiguous sub-interval, dt in length. The IP-Layer Capacity
depends on the Src and Dst hosts, the host addresses, and the path
between the hosts.[¶](#section-5.3-2){.pilcrow}

The number of these IP-Layer bits is designated n0\[dtn,dtn+1\] for a
specific dt.[¶](#section-5.3-3){.pilcrow}

When the packet size is known and of fixed size, the packet count during
a single sub-interval dt multiplied by the total bits in IP header and
data fields is equal to n0\[dtn,dtn+1\].[¶](#section-5.3-4){.pilcrow}

Anticipating a Sample of Singletons, the number of sub-intervals with
duration dt [MUST]{.bcp14} be set to a natural number m, so that T+I = T
+ m\*dt with dtn+1 - dtn = dt for 1 \<= n \<=
m.[¶](#section-5.3-5){.pilcrow}

Parameter PM represents other performance metrics (see [Section
5.4](#sec5-4-rt-delay){.xref} below); their measurement results
[SHALL]{.bcp14} be collected during measurement of IP-Layer Capacity and
associated with the corresponding dtn for further evaluation and
reporting. Users [SHALL]{.bcp14} specify the Parameter Tmax as required
by each metric\'s reference definition.[¶](#section-5.3-6){.pilcrow}

Mathematically, this definition is represented as (for each
n):[¶](#section-5.3-7){.pilcrow}

[]{#name-equation-for-ip-layer-capac}

::: {#section-5.3-8.1 .alignCenter .art-ascii-art .art-text .artwork}
                     ( n0[dtn,dtn+1] )
     C(T,dt,PM) = -------------------------
                            dt
:::

[Figure 1](#figure-1){.selfRef}: [Equation for IP-Layer
Capacity](#name-equation-for-ip-layer-capac){.selfRef}

and:[¶](#section-5.3-9){.pilcrow}

-   [n0 is the total number of IP-Layer header and payload bits that can
    be transmitted in standard-formed packets
    \[[RFC8468](#RFC8468){.xref}\] from the Src host and correctly
    received by the Dst host during one contiguous sub-interval, dt in
    length, during the interval
    \[T,T+I\].[¶](#section-5.3-10.1){.pilcrow}]{#section-5.3-10.1}
-   [C(T,dt,PM), the IP-Layer Capacity, corresponds to the value of n0
    measured in any sub-interval beginning at dtn, divided by the length
    of the sub-interval,
    dt.[¶](#section-5.3-10.2){.pilcrow}]{#section-5.3-10.2}
-   [PM represents other performance metrics (see [Section
    5.4](#sec5-4-rt-delay){.xref} below); their measurement results
    [SHALL]{.bcp14} be collected during measurement of IP-Layer Capacity
    and associated with the corresponding dtn for further evaluation and
    reporting.[¶](#section-5.3-10.3){.pilcrow}]{#section-5.3-10.3}
-   [All sub-intervals [MUST]{.bcp14} be of equal duration. Choosing dt
    as non-overlapping consecutive time intervals allows for a simple
    implementation.[¶](#section-5.3-10.4){.pilcrow}]{#section-5.3-10.4}
-   [The bit rate of the physical interface of the measurement devices
    [MUST]{.bcp14} be higher than the smallest of the links on the path
    whose C(T,I,PM) is to be measured (the bottleneck
    link).[¶](#section-5.3-10.5){.pilcrow}]{#section-5.3-10.5}

Measurements according to this definition [SHALL]{.bcp14} use the UDP
transport layer. Standard-formed packets are specified in [Section
5](https://www.rfc-editor.org/rfc/rfc8468#section-5){.relref} of
\[[RFC8468](#RFC8468){.xref}\]. The measurement [SHOULD]{.bcp14} use a
randomized Source port or equivalent technique, and [SHOULD]{.bcp14}
send responses from the Source address matching the test packet
Destination address.[¶](#section-5.3-11){.pilcrow}

Some effects of compression on measurement are discussed in [Section
6](https://www.rfc-editor.org/rfc/rfc8468#section-6){.relref} of
\[[RFC8468](#RFC8468){.xref}\].[¶](#section-5.3-12){.pilcrow}
:::

::: {#sec5-4-rt-delay}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Related Round-Trip Delay and One-Way Loss Definitions](#name-related-round-trip-delay-an){.section-name .selfRef} {#name-related-round-trip-delay-an}

RTD\[dtn,dtn+1\] is defined as a Sample of the Round-Trip Delay
\[[RFC2681](#RFC2681){.xref}\] between the Src host and the Dst host
during the interval \[T,T+I\] (that contains equal non-overlapping
intervals of dt). The \"reasonable period of time\" mentioned in
\[[RFC2681](#RFC2681){.xref}\] is the Parameter Tmax in this memo. The
statistics used to summarize RTD\[dtn,dtn+1\] [MAY]{.bcp14} include the
minimum, maximum, median, mean, and the range = (maximum - minimum).
Some of these statistics are needed for load adjustment purposes
([Section 8.1](#load-rate-adj){.xref}), measurement qualification
([Section 8.2](#meas-qual-verif){.xref}), and reporting ([Section
9](#rpt-formats){.xref}).[¶](#section-5.4-1){.pilcrow}

OWL\[dtn,dtn+1\] is defined as a Sample of the One-Way Loss
\[[RFC7680](#RFC7680){.xref}\] between the Src host and the Dst host
during the interval \[T,T+I\] (that contains equal non-overlapping
intervals of dt). The statistics used to summarize OWL\[dtn,dtn+1\]
[MAY]{.bcp14} include the count of lost packets and the ratio of lost
packets.[¶](#section-5.4-2){.pilcrow}

Other metrics [MAY]{.bcp14} be measured: one-way reordering,
duplication, and delay variation.[¶](#section-5.4-3){.pilcrow}
:::
:::

::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Discussion](#name-discussion){.section-name .selfRef} {#name-discussion}

See the corresponding section for Maximum IP-Layer Capacity ([Section
6.5](#Maximum-IP-Layer-Capacity-Discussion){.xref}).[¶](#section-5.5-1){.pilcrow}
:::

::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [Reporting the Metric](#name-reporting-the-metric){.section-name .selfRef} {#name-reporting-the-metric}

The IP-Layer Capacity [SHOULD]{.bcp14} be reported with at least
single-Megabit resolution, in units of Megabits per second (Mbps)
(which, to avoid any confusion, is 1,000,000 bits per
second).[¶](#section-5.6-1){.pilcrow}

The related One-Way Loss metric and Round-Trip Delay measurements for
the same Singleton [SHALL]{.bcp14} be reported, also with meaningful
resolution for the values measured.[¶](#section-5.6-2){.pilcrow}

Individual Capacity measurements [MAY]{.bcp14} be reported in a manner
consistent with the Maximum IP-Layer Capacity; see [Section
9](#rpt-formats){.xref}.[¶](#section-5.6-3){.pilcrow}
:::
:::

::: {#max-ip-metric-defs}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Maximum IP-Layer Capacity Metric Definitions (Statistics)](#name-maximum-ip-layer-capacity-m){.section-name .selfRef} {#name-maximum-ip-layer-capacity-m}

This section sets requirements for the following components to support
the Maximum IP-Layer Capacity Metric.[¶](#section-6-1){.pilcrow}

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Formal Name](#name-formal-name-2){.section-name .selfRef} {#name-formal-name-2}

\"Type-P-One-way-Max-IP-Capacity\" is the formal name; it is informally
called \"Maximum IP-Layer Capacity\".[¶](#section-6.1-1){.pilcrow}

Note that Type-P depends on the chosen
method.[¶](#section-6.1-2){.pilcrow}
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Parameters](#name-parameters-2){.section-name .selfRef} {#name-parameters-2}

This section lists the [REQUIRED]{.bcp14} input factors to specify the
metric, beyond those listed in [Section
4](#gen-params-defs){.xref}.[¶](#section-6.2-1){.pilcrow}

No additional Parameters or definitions are
needed.[¶](#section-6.2-2){.pilcrow}
:::

::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Metric Definitions](#name-metric-definitions-2){.section-name .selfRef} {#name-metric-definitions-2}

This section defines the [REQUIRED]{.bcp14} aspects of the Maximum
IP-Layer Capacity Metric (unless otherwise indicated) for measurements
between specified Source and Destination
hosts:[¶](#section-6.3-1){.pilcrow}

Define the Maximum IP-Layer Capacity, Maximum_C(T,I,PM), to be the
maximum number of IP-Layer bits n0\[dtn,dtn+1\] divided by dt that can
be transmitted in packets from the Src host and correctly received by
the Dst host, over all dt-length intervals in \[T,T+I\] and meeting the
PM criteria. An equivalent definition would be the maximum of a Sample
of size m of Singletons C(T,I,PM) collected during the interval
\[T,T+I\] and meeting the PM criteria.[¶](#section-6.3-2){.pilcrow}

The number of sub-intervals with duration dt [MUST]{.bcp14} be set to a
natural number m, so that T+I = T + m\*dt with dtn+1 - dtn = dt for 1
\<= n \<= m.[¶](#section-6.3-3){.pilcrow}

Parameter PM represents the other performance metrics (see [Section
6.4](#sec6-4-rt-delay){.xref} below) and their measurement results for
the Maximum IP-Layer Capacity. At least one target performance threshold
(PM criterion) [MUST]{.bcp14} be defined. If more than one metric and
target performance threshold is defined, then the sub-interval with the
maximum number of bits transmitted [MUST]{.bcp14} meet all the target
performance thresholds. Users [SHALL]{.bcp14} specify the Parameter Tmax
as required by each metric\'s reference
definition.[¶](#section-6.3-4){.pilcrow}

Mathematically, this definition can be represented
as:[¶](#section-6.3-5){.pilcrow}

[]{#name-equation-for-maximum-capaci}

::: {#section-6.3-6.1 .alignCenter .art-ascii-art .art-text .artwork}
                            max  ( n0[dtn,dtn+1] )
                            [T,T+I]
      Maximum_C(T,I,PM) = -------------------------
                                     dt

      where:

        T                                      T+I
        _________________________________________
        |   |   |   |   |   |   |   |   |   |   |
    dtn=1   2   3   4   5   6   7   8   9  10  n+1
                                           n=m
:::

[Figure 2](#figure-2){.selfRef}: [Equation for Maximum
Capacity](#name-equation-for-maximum-capaci){.selfRef}

and:[¶](#section-6.3-7){.pilcrow}

-   [n0 is the total number of IP-Layer header and payload bits that can
    be transmitted in standard-formed packets from the Src host and
    correctly received by the Dst host during one contiguous
    sub-interval, dt in length, during the interval
    \[T,T+I\].[¶](#section-6.3-8.1){.pilcrow}]{#section-6.3-8.1}
-   [Maximum_C(T,I,PM), the Maximum IP-Layer Capacity, corresponds to
    the maximum value of n0 measured in any sub-interval beginning at
    dtn, divided by the constant length of all sub-intervals,
    dt.[¶](#section-6.3-8.2){.pilcrow}]{#section-6.3-8.2}
-   [PM represents the other performance metrics (see [Section
    6.4](#sec6-4-rt-delay){.xref}) and their measurement results for the
    Maximum IP-Layer Capacity. At least one target performance threshold
    (PM criterion) [MUST]{.bcp14} be
    defined.[¶](#section-6.3-8.3){.pilcrow}]{#section-6.3-8.3}
-   [All sub-intervals [MUST]{.bcp14} be of equal duration. Choosing dt
    as non-overlapping consecutive time intervals allows for a simple
    implementation.[¶](#section-6.3-8.4){.pilcrow}]{#section-6.3-8.4}
-   [The bit rate of the physical interface of the measurement systems
    [MUST]{.bcp14} be higher than the smallest of the links on the path
    whose Maximum_C(T,I,PM) is to be measured (the bottleneck
    link).[¶](#section-6.3-8.5){.pilcrow}]{#section-6.3-8.5}

In this definition, the m sub-intervals can be viewed as trials when the
Src host varies the transmitted packet rate, searching for the maximum
n0 that meets the PM criteria measured at the Dst host in a test of
duration I. When the transmitted packet rate is held constant at the Src
host, the m sub-intervals may also be viewed as trials to evaluate the
stability of n0 and metric(s) in the PM list over all dt-length
intervals in I.[¶](#section-6.3-9){.pilcrow}

Measurements according to these definitions [SHALL]{.bcp14} use the UDP
transport layer.[¶](#section-6.3-10){.pilcrow}
:::

::: {#sec6-4-rt-delay}
::: {#section-6.4 .section}
### [6.4.](#section-6.4){.section-number .selfRef} [Related Round-Trip Delay and One-Way Loss Definitions](#name-related-round-trip-delay-and){.section-name .selfRef} {#name-related-round-trip-delay-and}

RTD\[dtn,dtn+1\] and OWL\[dtn,dtn+1\] are defined in [Section
5.4](#sec5-4-rt-delay){.xref}. Here, the test intervals are increased to
match the capacity Samples, RTD\[T,I\] and
OWL\[T,I\].[¶](#section-6.4-1){.pilcrow}

The interval dtn,dtn+1 where Maximum_C(T,I,PM) occurs is the reporting
sub-interval for RTD\[dtn,dtn+1\] and OWL\[dtn,dtn+1\] within RTD\[T,I\]
and OWL\[T,I\].[¶](#section-6.4-2){.pilcrow}

Other metrics [MAY]{.bcp14} be measured: one-way reordering,
duplication, and delay variation.[¶](#section-6.4-3){.pilcrow}
:::
:::

::: {#Maximum-IP-Layer-Capacity-Discussion}
::: {#section-6.5 .section}
### [6.5.](#section-6.5){.section-number .selfRef} [Discussion](#name-discussion-2){.section-name .selfRef} {#name-discussion-2}

If traffic conditioning (e.g., shaping, policing) applies along a path
for which Maximum_C(T,I,PM) is to be determined, different values for dt
[SHOULD]{.bcp14} be picked and measurements executed during multiple
intervals \[T,T+I\]. Each duration dt [SHOULD]{.bcp14} be chosen so that
it is an integer multiple of increasing values k times serialization
delay of a Path MTU (PMTU) at the physical interface speed where traffic
conditioning is expected. This should avoid taking configured burst
tolerance Singletons as a valid Maximum_C(T,I,PM)
result.[¶](#section-6.5-1){.pilcrow}

A Maximum_C(T,I,PM) without any indication of bottleneck congestion, be
that increased latency, packet loss, or Explicit Congestion Notification
(ECN) marks during a measurement interval, I, is likely an underestimate
of Maximum_C(T,I,PM).[¶](#section-6.5-2){.pilcrow}
:::
:::

::: {#sec6-6-rpt-the-metric}
::: {#section-6.6 .section}
### [6.6.](#section-6.6){.section-number .selfRef} [Reporting the Metric](#name-reporting-the-metric-2){.section-name .selfRef} {#name-reporting-the-metric-2}

The IP-Layer Capacity [SHOULD]{.bcp14} be reported with at least
single-Megabit resolution, in units of Megabits per second (Mbps)
(which, to avoid any confusion, is 1,000,000 bits per
second).[¶](#section-6.6-1){.pilcrow}

The related One-Way Loss metric and Round-Trip Delay measurements for
the same Singleton [SHALL]{.bcp14} be reported, also with meaningful
resolution for the values measured.[¶](#section-6.6-2){.pilcrow}

When there are demonstrated and repeatable Capacity modes in the Sample,
the Maximum IP-Layer Capacity [SHALL]{.bcp14} be reported for each mode,
along with the relative time from the beginning of the stream that the
mode was observed to be present. Bimodal Maximum IP-Layer Capacities
have been observed with some services, sometimes called a \"turbo mode\"
intending to deliver short transfers more quickly or reduce the initial
buffering time for some video streams. Note that modes lasting less than
duration dt will not be detected.[¶](#section-6.6-3){.pilcrow}

Some transmission technologies have multiple methods of operation that
may be activated when channel conditions degrade or improve, and these
transmission methods may determine the Maximum IP-Layer Capacity.
Examples include line-of-sight microwave modulator constellations, or
cellular modem technologies where the changes may be initiated by a user
moving from one coverage area to another. Operation in the different
transmission methods may be observed over time, but the modes of Maximum
IP-Layer Capacity will not be activated deterministically as with the
\"turbo mode\" described in the paragraph
above.[¶](#section-6.6-4){.pilcrow}
:::
:::
:::
:::

::: {#ip-layer-sender-br}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IP-Layer Sender Bit Rate Singleton Metric Definitions](#name-ip-layer-sender-bit-rate-si){.section-name .selfRef} {#name-ip-layer-sender-bit-rate-si}

This section sets requirements for the following components to support
the IP-Layer Sender Bit Rate Metric. This metric helps to check that the
Sender actually generated the desired rates during a test, and
measurement takes place at the interface between the Src host and the
network path (or as close as practical within the Src host). It is not a
metric for path performance.[¶](#section-7-1){.pilcrow}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Formal Name](#name-formal-name-3){.section-name .selfRef} {#name-formal-name-3}

\"Type-P-IP-Sender-Bit-Rate\" is the formal name; it is informally
called the \"IP-Layer Sender Bit Rate\".[¶](#section-7.1-1){.pilcrow}

Note that Type-P depends on the chosen
method.[¶](#section-7.1-2){.pilcrow}
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Parameters](#name-parameters-3){.section-name .selfRef} {#name-parameters-3}

This section lists the [REQUIRED]{.bcp14} input factors to specify the
metric, beyond those listed in [Section
4](#gen-params-defs){.xref}.[¶](#section-7.2-1){.pilcrow}

[]{.break}

S:
:   The duration of the measurement interval at the
    Source.[¶](#section-7.2-2.2){.pilcrow}
:   

st:
:   The nominal duration of N sub-intervals in S (default st = 0.05
    seconds).[¶](#section-7.2-2.4){.pilcrow}
:   

stn:
:   The beginning boundary of a specific sub-interval, n, one of N
    sub-intervals in S.[¶](#section-7.2-2.6){.pilcrow}
:   

S [SHALL]{.bcp14} be longer than I, primarily to account for on-demand
activation of the path, or any preamble to testing required, and the
delay of the path.[¶](#section-7.2-3){.pilcrow}

st [SHOULD]{.bcp14} be much smaller than the sub-interval dt and on the
same order as FT; otherwise, the rate measurement will include many rate
adjustments and include more time smoothing, possibly smoothing the
interval that contains the Maximum IP-Layer Capacity (and therefore
losing relevance). The st Parameter does not have relevance when the
Source is transmitting at a fixed rate throughout
S.[¶](#section-7.2-4){.pilcrow}
:::

::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Metric Definition](#name-metric-definition){.section-name .selfRef} {#name-metric-definition}

This section defines the [REQUIRED]{.bcp14} aspects of the IP-Layer
Sender Bit Rate Metric (unless otherwise indicated) for measurements at
the specified Source on packets addressed for the intended Destination
host and matching the required Type-P:[¶](#section-7.3-1){.pilcrow}

Define the IP-Layer Sender Bit Rate, B(S,st), to be the number of
IP-Layer bits (including header and data fields) that are transmitted
from the Source with address pair Src and Dst during one contiguous
sub-interval, st, during the test interval S (where S [SHALL]{.bcp14} be
longer than I) and where the fixed-size packet count during that single
sub-interval st also provides the number of IP-Layer bits in any
interval, \[stn,stn+1\].[¶](#section-7.3-2){.pilcrow}

Measurements according to this definition [SHALL]{.bcp14} use the UDP
transport layer. Any feedback from the Dst host to the Src host received
by the Src host during an interval \[stn,stn+1\] [SHOULD NOT]{.bcp14}
result in an adaptation of the Src host traffic conditioning during this
interval (rate adjustment occurs on st interval
boundaries).[¶](#section-7.3-3){.pilcrow}
:::

::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [Discussion](#name-discussion-3){.section-name .selfRef} {#name-discussion-3}

Both the Sender and Receiver (or Source and Destination) bit rates
[SHOULD]{.bcp14} be assessed as part of an IP-Layer Capacity
measurement. Otherwise, an unexpected sending rate limitation could
produce an erroneous Maximum IP-Layer Capacity
measurement.[¶](#section-7.4-1){.pilcrow}
:::

::: {#section-7.5 .section}
### [7.5.](#section-7.5){.section-number .selfRef} [Reporting the Metric](#name-reporting-the-metric-3){.section-name .selfRef} {#name-reporting-the-metric-3}

The IP-Layer Sender Bit Rate [SHALL]{.bcp14} be reported with meaningful
resolution, in units of Megabits per second (which, to avoid any
confusion, is 1,000,000 bits per second).[¶](#section-7.5-1){.pilcrow}

Individual IP-Layer Sender Bit Rate measurements are discussed further
in [Section 9](#rpt-formats){.xref}.[¶](#section-7.5-2){.pilcrow}
:::
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Method of Measurement](#name-method-of-measurement){.section-name .selfRef} {#name-method-of-measurement}

It is [REQUIRED]{.bcp14} per the architecture of the method that two
cooperating hosts operate in the roles of Src (test packet Sender) and
Dst (Receiver) with a measured path and return path between
them.[¶](#section-8-1){.pilcrow}

The duration of a test, Parameter I, [MUST]{.bcp14} be constrained in a
production network, since this is an active test method and it will
likely cause congestion on the path from the Src host to the Dst host
during a test.[¶](#section-8-2){.pilcrow}

::: {#load-rate-adj}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Load Rate Adjustment Algorithm](#name-load-rate-adjustment-algori){.section-name .selfRef} {#name-load-rate-adjustment-algori}

The algorithm described in this section [MUST NOT]{.bcp14} be used as a
general Congestion Control Algorithm (CCA). As stated in [Section
2](#sec-2-scope){.xref} (\"Scope, Goals, and Applicability\"), the load
rate adjustment algorithm\'s goal is to help determine the Maximum
IP-Layer Capacity in the context of an infrequent, diagnostic,
short-term measurement. There is a trade-off between test duration (also
the test data volume) and algorithm aggressiveness (speed of ramp-up and
ramp-down to the Maximum IP-Layer Capacity). The Parameter values chosen
below strike a well-tested balance among these
factors.[¶](#section-8.1-1){.pilcrow}

A table [SHALL]{.bcp14} be pre-built (by the test administrator),
defining all the offered load rates that will be supported (R1 through
Rn, in ascending order, corresponding to indexed rows in the table). It
is [RECOMMENDED]{.bcp14} that rates begin with 0.5 Mbps at index zero,
use 1 Mbps at index one, and then continue in 1 Mbps increments to 1
Gbps. Above 1 Gbps, and up to 10 Gbps, it is [RECOMMENDED]{.bcp14} that
100 Mbps increments be used. Above 10 Gbps, increments of 1 Gbps are
[RECOMMENDED]{.bcp14}. A higher initial IP-Layer Sender Bit Rate might
be configured when the test operator is certain that the Maximum
IP-Layer Capacity is well above the initial IP-Layer Sender Bit Rate and
factors such as test duration and total test traffic play an important
role. The sending rate table [SHOULD]{.bcp14} bracket the Maximum
Capacity where it will make measurements, including constrained rates
less than 500 kbps if applicable.[¶](#section-8.1-2){.pilcrow}

Each rate is defined as datagrams of size ss, sent as a burst of count
cc, each time interval tt (the default for tt is 100 microsec, a likely
system tick interval). While it is advantageous to use datagrams of as
large a size as possible, it may be prudent to use a slightly smaller
maximum that allows for secondary protocol headers and/or tunneling
without resulting in IP-Layer fragmentation. Selection of a new rate is
indicated by a calculation on the current row, Rx. For
example:[¶](#section-8.1-3){.pilcrow}

[]{.break}

\"Rx+1\":
:   The Sender uses the next-higher rate in the
    table.[¶](#section-8.1-4.2){.pilcrow}
:   

\"Rx-10\":
:   The Sender uses the rate 10 rows lower in the
    table.[¶](#section-8.1-4.4){.pilcrow}
:   

At the beginning of a test, the Sender begins sending at rate R1 and the
Receiver starts a feedback timer of duration FT (while awaiting inbound
datagrams). As datagrams are received, they are checked for sequence
number anomalies (loss, out-of-order, duplication, etc.) and the delay
range is measured (one-way or round-trip). This information is
accumulated until the feedback timer FT expires and a status feedback
message is sent from the Receiver back to the Sender, to communicate
this information. The accumulated statistics are then reset by the
Receiver for the next feedback interval. As feedback messages are
received back at the Sender, they are evaluated to determine how to
adjust the current offered load rate (Rx).[¶](#section-8.1-5){.pilcrow}

If the feedback indicates that no sequence number anomalies were
detected AND the delay range was below the lower threshold, the offered
load rate is increased. If congestion has not been confirmed up to this
point (see below for the method for declaring congestion), the offered
load rate is increased by more than one rate setting (e.g., Rx+10). This
allows the offered load to quickly reach a near-maximum rate.
Conversely, if congestion has been previously confirmed, the offered
load rate is only increased by one (Rx+1). However, if a rate threshold
above a high sending rate (such as 1 Gbps) is exceeded, the offered load
rate is only increased by one (Rx+1) in any congestion
state.[¶](#section-8.1-6){.pilcrow}

If the feedback indicates that sequence number anomalies were detected
OR the delay range was above the upper threshold, the offered load rate
is decreased. The [RECOMMENDED]{.bcp14} threshold values are 10 for
sequence number gaps and 30 msec for lower and 90 msec for upper delay
thresholds, respectively. Also, if congestion is now confirmed for the
first time by the current feedback message being processed, then the
offered load rate is decreased by more than one rate setting (e.g.,
Rx-30). This one-time reduction is intended to compensate for the fast
initial ramp-up. In all other cases, the offered load rate is only
decreased by one (Rx-1).[¶](#section-8.1-7){.pilcrow}

If the feedback indicates that there were no sequence number anomalies
AND the delay range was above the lower threshold but below the upper
threshold, the offered load rate is not changed. This allows time for
recent changes in the offered load rate to stabilize and for the
feedback to represent current conditions more
accurately.[¶](#section-8.1-8){.pilcrow}

Lastly, the method for inferring congestion is that there were sequence
number anomalies AND/OR the delay range was above the upper threshold
for three consecutive feedback intervals. The algorithm described above
is also illustrated in Annex B of ITU-T Recommendation Y.1540, 2020
version \[[Y.1540](#Y.1540){.xref}\] and is implemented in [Appendix
A](#app-a-load-rate-adj-pseudocode){.xref} (\"Load Rate Adjustment
Pseudocode\") in this memo.[¶](#section-8.1-9){.pilcrow}

The load rate adjustment algorithm [MUST]{.bcp14} include timers that
stop the test when received packet streams cease unexpectedly. The
timeout thresholds are provided in [Table
1](#load-rate-adj-params){.xref}, along with values for all other
Parameters and variables described in this section. Operations of
non-obvious Parameters appear below:[¶](#section-8.1-10){.pilcrow}

[]{.break}

load packet timeout:
:   The load packet timeout [SHALL]{.bcp14} be reset to the configured
    value each time a load packet is received. If the timeout expires,
    the Receiver [SHALL]{.bcp14} be closed and no further feedback
    sent.[¶](#section-8.1-11.2){.pilcrow}
:   

feedback message timeout:
:   The feedback message timeout [SHALL]{.bcp14} be reset to the
    configured value each time a feedback message is received. If the
    timeout expires, the Sender [SHALL]{.bcp14} be closed and no further
    load packets sent.[¶](#section-8.1-11.4){.pilcrow}
:   

[]{#name-parameters-for-load-rate-ad}

::: {#load-rate-adj-params}
  Parameter                                     Default                               Tested Range or Values          Expected Safe Range (not entirely tested, other values [NOT RECOMMENDED]{.bcp14})
  --------------------------------------------- ------------------------------------- ------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------
  FT, feedback time interval                    50 msec                               20 msec, 50 msec, 100 msec      20 msec \<= FT \<= 250 msec; larger values may slow the rate increase and fail to find the max
  Feedback message timeout (stop test)          L\*FT, L=20 (1 sec with FT=50 msec)   L=100 with FT=50 msec (5 sec)   0.5 sec \<= L\*FT \<= 30 sec; upper limit for very unreliable test paths only
  Load packet timeout (stop test)               1 sec                                 5 sec                           0.250-30 sec; upper limit for very unreliable test paths only
  Table index 0                                 0.5 Mbps                              0.5 Mbps                        When testing \<= 10 Gbps
  Table index 1                                 1 Mbps                                1 Mbps                          When testing \<= 10 Gbps
  Table index (step) size                       1 Mbps                                1 Mbps \<= rate \<= 1 Gbps      Same as tested
  Table index (step) size, rate \> 1 Gbps       100 Mbps                              1 Gbps \<= rate \<= 10 Gbps     Same as tested
  Table index (step) size, rate \> 10 Gbps      1 Gbps                                Untested                        \>10 Gbps
  ss, UDP payload size, bytes                   None                                  \<=1222                         Recommend max at largest value that avoids fragmentation; using a payload size that is too small might result in unexpected Sender limitations
  cc, burst count                               None                                  1 \<= cc \<= 100                Same as tested. Vary cc as needed to create the desired maximum sending rate. Sender buffer size may limit cc in the implementation
  tt, burst interval                            100 microsec                          100 microsec, 1 msec            Available range of \"tick\" values (HZ param)
  Low delay range threshold                     30 msec                               5 msec, 30 msec                 Same as tested
  High delay range threshold                    90 msec                               10 msec, 90 msec                Same as tested
  Sequence error threshold                      10                                    0, 1, 5, 10, 100                Same as tested
  Consecutive errored status report threshold   3                                     2, 3, 4, 5                      Use values \>1 to avoid misinterpreting transient loss
  Fast mode increase, in table index steps      10                                    10                              2 \<= steps \<= 30
  Fast mode decrease, in table index steps      3 \* Fast mode increase               3 \* Fast mode increase         Same as tested

  : [Table 1](#table-1){.selfRef}: [Parameters for Load Rate Adjustment
  Algorithm](#name-parameters-for-load-rate-ad){.selfRef}
:::

As a consequence of default parameterization, the Number of table steps
in total for rates less than 10 Gbps is 1090 (excluding index
0).[¶](#section-8.1-13){.pilcrow}

A related Sender backoff response to network conditions occurs when one
or more status feedback messages fail to arrive at the
Sender.[¶](#section-8.1-14){.pilcrow}

If no status feedback messages arrive at the Sender for the interval
greater than the Lost Status Backoff
timeout:[¶](#section-8.1-15){.pilcrow}

::: {#section-8.1-16 .alignLeft .art-ascii-art .art-text .artwork}
               UDRT + (2+w)*FT = Lost Status Backoff timeout

       where:

       UDRT = upper delay range threshold (default 90 msec)
       FT   = feedback time interval (default 50 msec)
       w    = number of repeated timeouts (w=0 initially, w++ on each
              timeout, and reset to 0 when a message is received)

[¶](#section-8.1-16){.pilcrow}
:::

Beginning when the last message (of any type) was successfully received
at the Sender:[¶](#section-8.1-17){.pilcrow}

The offered load [SHALL]{.bcp14} then be decreased, following the same
process as when the feedback indicates the presence of one or more
sequence number anomalies OR the delay range was above the upper
threshold (as described above), with the same load rate adjustment
algorithm variables in their current state. This means that lost status
feedback messages OR sequence errors OR delay variation can result in
rate reduction and congestion
confirmation.[¶](#section-8.1-18){.pilcrow}

The [RECOMMENDED]{.bcp14} initial value for w is 0, taking a Round-Trip
Time (RTT) of less than FT into account. A test with an RTT longer than
FT is a valid reason to increase the initial value of w appropriately.
Variable w [SHALL]{.bcp14} be incremented by one whenever the Lost
Status Backoff timeout is exceeded. So, with FT = 50 msec and UDRT = 90
msec, a status feedback message loss would be declared at 190 msec
following a successful message, again at 50 msec after that (240 msec
total), and so on.[¶](#section-8.1-19){.pilcrow}

Also, if congestion is now confirmed for the first time by a Lost Status
Backoff timeout, then the offered load rate is decreased by more than
one rate setting (e.g., Rx-30). This one-time reduction is intended to
compensate for the fast initial ramp-up. In all other cases, the offered
load rate is only decreased by one (Rx-1).[¶](#section-8.1-20){.pilcrow}

[Appendix B](#app-b-rfc8085-udp){.xref} discusses compliance with the
applicable mandatory requirements of \[[RFC8085](#RFC8085){.xref}\],
consistent with the goals of the IP-Layer Capacity Metric and Method,
including the load rate adjustment algorithm described in this
section.[¶](#section-8.1-21){.pilcrow}
:::
:::

::: {#meas-qual-verif}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Measurement Qualification or Verification](#name-measurement-qualification-o){.section-name .selfRef} {#name-measurement-qualification-o}

It is of course necessary to calibrate the equipment performing the
IP-Layer Capacity measurement, to ensure that the expected capacity can
be measured accurately and that equipment choices (processing speed,
interface bandwidth, etc.) are suitably matched to the measurement
range.[¶](#section-8.2-1){.pilcrow}

When assessing a maximum rate as the metric specifies, artificially high
(optimistic) values might be measured until some buffer on the path is
filled. Other causes include bursts of back-to-back packets with idle
intervals delivered by a path, while the measurement interval (dt) is
small and aligned with the bursts. The artificial values might result in
an unsustainable Maximum Capacity observed when the Method of
Measurement is searching for the maximum, and that would not do. This
situation is different from the bimodal service rates (discussed in
\"[Reporting the Metric](#sec6-6-rpt-the-metric){.xref}\", [Section
6.6](#sec6-6-rpt-the-metric){.xref}), which are characterized by a
multi-second duration (much longer than the measured RTT) and repeatable
behavior.[¶](#section-8.2-2){.pilcrow}

There are many ways that the Method of Measurement could handle this
false-max issue. The default value for measurement of Singletons (dt = 1
second) has proven to be of practical value during tests of this method,
allows the bimodal service rates to be characterized, and has an obvious
alignment with the reporting units (Mbps).[¶](#section-8.2-3){.pilcrow}

Another approach comes from [Section
24](https://www.rfc-editor.org/rfc/rfc2544#section-24){.relref} of
\[[RFC2544](#RFC2544){.xref}\] and its discussion of trial duration,
where relatively short trials conducted as part of the search are
followed by longer trials to make the final determination. In the
production network, measurements of Singletons and Samples (the terms
for trials and tests of Lab Benchmarking) must be limited in duration
because they may affect service. But there is sufficient value in
repeating a Sample with a fixed sending rate determined by the previous
search for the Maximum IP-Layer Capacity, to qualify the result in terms
of the other performance metrics measured at the same
time.[¶](#section-8.2-4){.pilcrow}

A Qualification measurement for the search result is a subsequent
measurement, sending at a fixed 99.x percent of the Maximum IP-Layer
Capacity for I, or an indefinite period. The same Maximum Capacity
Metric is applied, and the Qualification for the result is a Sample
without supra-threshold packet losses or a growing minimum delay trend
in subsequent Singletons (or each dt of the measurement interval, I).
Samples exhibiting supra-threshold packet losses or increasing queue
occupation require a repeated search and/or test at a reduced fixed
Sender rate for Qualification.[¶](#section-8.2-5){.pilcrow}

Here, as with any Active Capacity test, the test duration must be kept
short. Ten-second tests for each direction of transmission are common
today. The default measurement interval specified here is I = 10
seconds. The combination of a fast and congestion-aware search method
and user-network coordination makes a unique contribution to production
testing. The Maximum IP Capacity Metric and Method for assessing
performance is very different from the classic Throughput Metric and
Methods provided in \[[RFC2544](#RFC2544){.xref}\]: it uses
near-real-time load adjustments that are sensitive to loss and delay,
similar to other congestion control algorithms used on the Internet
every day, along with limited duration. On the other hand, Throughput
measurements \[[RFC2544](#RFC2544){.xref}\] can produce sustained
overload conditions for extended periods of time. Individual trials in a
test governed by a binary search can last 60 seconds for each step, and
the final confirmation trial may be even longer. This is very different
from \"normal\" traffic levels, but overload conditions are not a
concern in the isolated test environment. The concerns raised in
\[[RFC6815](#RFC6815){.xref}\] were that the methods discussed in
\[[RFC2544](#RFC2544){.xref}\] would be let loose on production
networks, and instead the authors challenged the standards community to
develop Metrics and Methods like those described in this
memo.[¶](#section-8.2-6){.pilcrow}
:::
:::

::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [Measurement Considerations](#name-measurement-considerations){.section-name .selfRef} {#name-measurement-considerations}

In general, the widespread measurements that this memo encourages will
encounter widespread behaviors. The bimodal IP Capacity behaviors
already discussed in [Section 6.6](#sec6-6-rpt-the-metric){.xref} are
good examples.[¶](#section-8.3-1){.pilcrow}

In general, it is [RECOMMENDED]{.bcp14} to locate test endpoints as
close to the intended measured link(s) as practical (for reasons of
scale, this is not always possible; there is a limit on the number of
test endpoints coming from many perspectives \-- for example, management
and measurement traffic). The testing operator [MUST]{.bcp14} set a
value for the MaxHops Parameter, based on the expected path length. This
Parameter can keep measurement traffic from straying too far beyond the
intended path.[¶](#section-8.3-2){.pilcrow}

The measured path may be stateful based on many factors, and the
Parameter \"Time of day\" when a test starts may not be enough
information. Repeatable testing may require knowledge of the time from
the beginning of a measured flow \-- and how the flow is constructed,
including how much traffic has already been sent on that flow when a
state change is observed \-- because the state change may be based on
time, bytes sent, or both. Both load packets and status feedback
messages [MUST]{.bcp14} contain sequence numbers; this helps with
measurements based on those packets.[¶](#section-8.3-3){.pilcrow}

Many different types of traffic shapers and on-demand communications
access technologies may be encountered, as anticipated in
\[[RFC7312](#RFC7312){.xref}\], and play a key role in measurement
results. Methods [MUST]{.bcp14} be prepared to provide a short preamble
transmission to activate on-demand communications access and to discard
the preamble from subsequent test results.[¶](#section-8.3-4){.pilcrow}

The following conditions might be encountered during measurement, where
packet losses may occur independently of the measurement sending
rate:[¶](#section-8.3-5){.pilcrow}

1.  [Congestion of an interconnection or backbone interface may appear
    as packet losses distributed over time in the test stream, due to
    much-higher-rate interfaces in the
    backbone.[¶](#section-8.3-6.1){.pilcrow}]{#section-8.3-6.1}
2.  [Packet loss due to the use of Random Early Detection (RED) or other
    active queue management may or may not affect the measurement flow
    if competing background traffic (other flows) is simultaneously
    present.[¶](#section-8.3-6.2){.pilcrow}]{#section-8.3-6.2}
3.  [There may be only a small delay variation independent of the
    sending rate under these conditions as
    well.[¶](#section-8.3-6.3){.pilcrow}]{#section-8.3-6.3}
4.  [Persistent competing traffic on measurement paths that include
    shared transmission media may cause random packet losses in the test
    stream.[¶](#section-8.3-6.4){.pilcrow}]{#section-8.3-6.4}

It is possible to mitigate these conditions using the flexibility of the
load rate adjustment algorithm described in [Section
8.1](#load-rate-adj){.xref} above (tuning specific
Parameters).[¶](#section-8.3-7){.pilcrow}

If the measurement flow burst duration happens to be on the order of or
smaller than the burst size of a shaper or a policer in the path, then
the line rate might be measured rather than the bandwidth limit imposed
by the shaper or policer. If this condition is suspected, alternate
configurations [SHOULD]{.bcp14} be used.[¶](#section-8.3-8){.pilcrow}

In general, results depend on the sending stream\'s characteristics; the
measurement community has known this for a long time and needs to keep
it foremost in mind. Although the default is a single flow (F=1) for
testing, the use of multiple flows may be advantageous for the following
reasons:[¶](#section-8.3-9){.pilcrow}

1.  [The test hosts may be able to create a higher load than with a
    single flow, or parallel test hosts may be used to generate one flow
    each.[¶](#section-8.3-10.1){.pilcrow}]{#section-8.3-10.1}
2.  [Link aggregation may be present (flow-based load balancing), and
    multiple flows are needed to occupy each member of the
    aggregate.[¶](#section-8.3-10.2){.pilcrow}]{#section-8.3-10.2}
3.  [Internet access policies may limit the IP-Layer Capacity depending
    on the Type-P of the packets, possibly reserving capacity for
    various stream
    types.[¶](#section-8.3-10.3){.pilcrow}]{#section-8.3-10.3}

Each flow would be controlled using its own implementation of the load
rate adjustment (search) algorithm.[¶](#section-8.3-11){.pilcrow}

It is obviously counterproductive to run more than one independent and
concurrent test (regardless of the number of flows in the test stream)
attempting to measure the **maximum** capacity on a single path. The
number of concurrent, independent tests of a path [SHALL]{.bcp14} be
limited to one.[¶](#section-8.3-12){.pilcrow}

Tests of a v4-v6 transition mechanism might well be the intended subject
of a capacity test. As long as both IPv4 packets and IPv6 packets
sent/received are standard-formed, this should be allowed (and the
change in header size easily accounted for on a per-packet
basis).[¶](#section-8.3-13){.pilcrow}

As testing continues, implementers should expect the methods to evolve.
The ITU-T has published a supplement (Supplement 60) to the Y-series of
ITU-T Recommendations, \"Interpreting ITU-T Y.1540 maximum IP-layer
capacity measurements\" \[[Y.Sup60](#Y.Sup60){.xref}\], which is the
result of continued testing with the metric. Those results have improved
the methods described here.[¶](#section-8.3-14){.pilcrow}
:::
:::

::: {#rpt-formats}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Reporting Formats](#name-reporting-formats){.section-name .selfRef} {#name-reporting-formats}

The Singleton IP-Layer Capacity results [SHOULD]{.bcp14} be accompanied
by the context under which they were
measured.[¶](#section-9-1){.pilcrow}

-   [Timestamp (especially the time when the maximum was observed in
    dtn).[¶](#section-9-2.1){.pilcrow}]{#section-9-2.1}
-   [Source and Destination (by IP or other meaningful
    ID).[¶](#section-9-2.2){.pilcrow}]{#section-9-2.2}
-   [Other inner Parameters of the test case ([Section
    4](#gen-params-defs){.xref}).[¶](#section-9-2.3){.pilcrow}]{#section-9-2.3}
-   [Outer Parameters, such as \"test conducted in motion\" or other
    factors belonging to the context of the
    measurement.[¶](#section-9-2.4){.pilcrow}]{#section-9-2.4}
-   [Result validity (indicating cases where the process was somehow
    interrupted or the attempt
    failed).[¶](#section-9-2.5){.pilcrow}]{#section-9-2.5}
-   [A field where unusual circumstances could be documented, and
    another one for \"ignore / mask out\" purposes in further
    processing.[¶](#section-9-2.6){.pilcrow}]{#section-9-2.6}

The Maximum IP-Layer Capacity results [SHOULD]{.bcp14} be reported in
tabular format. There [SHOULD]{.bcp14} be a column that identifies the
test Phase. There [SHOULD]{.bcp14} be a column listing the number of
flows used in that Phase. The remaining columns [SHOULD]{.bcp14} report
the following results for the aggregate of all flows, including the
Maximum IP-Layer Capacity, the Loss Ratio, the RTT minimum, RTT maximum,
and other metrics tested having similar
relevance.[¶](#section-9-3){.pilcrow}

As mentioned in [Section 6.6](#sec6-6-rpt-the-metric){.xref}, bimodal
(or multi-modal) maxima [SHALL]{.bcp14} be reported for each mode
separately.[¶](#section-9-4){.pilcrow}

[]{#name-maximum-ip-layer-capacity-r}

  Phase    Number of Flows   Maximum IP-Layer Capacity (Mbps)   Loss Ratio   RTT min (msec)   RTT max (msec)
  -------- ----------------- ---------------------------------- ------------ ---------------- ----------------
  Search   1                 967.31                             0.0002       30               58
  Verify   1                 966.00                             0.0000       30               38

  : [Table 2](#table-2){.selfRef}: [Maximum IP-Layer Capacity
  Results](#name-maximum-ip-layer-capacity-r){.selfRef}

Static and configuration Parameters:[¶](#section-9-6){.pilcrow}

The sub-interval time, dt, [MUST]{.bcp14} accompany a report of Maximum
IP-Layer Capacity results, as well as the remaining Parameters from
[Section 4](#gen-params-defs){.xref} (\"General Parameters and
Definitions\").[¶](#section-9-7){.pilcrow}

The PM list metrics corresponding to the sub-interval where the Maximum
Capacity occurred [MUST]{.bcp14} accompany a report of Maximum IP-Layer
Capacity results, for each test Phase.[¶](#section-9-8){.pilcrow}

The IP-Layer Sender Bit Rate results [SHOULD]{.bcp14} be reported in
tabular format. There [SHOULD]{.bcp14} be a column that identifies the
test Phase. There [SHOULD]{.bcp14} be a column listing each individual
(numbered) flow used in that Phase, or the aggregate of flows in that
Phase. A corresponding column [SHOULD]{.bcp14} identify the specific
sending rate sub-interval, stn, for each flow and aggregate. A final
column [SHOULD]{.bcp14} report the IP-Layer Sender Bit Rate results for
each flow used, or the aggregate of all
flows.[¶](#section-9-9){.pilcrow}

[]{#name-ip-layer-sender-bit-rate-re}

  Phase    Flow Number or Aggregate   stn (sec)   Sender Bit Rate (Mbps)
  -------- -------------------------- ----------- ------------------------
  Search   1                          0.00        345
  Search   2                          0.00        289
  Search   Agg                        0.00        634
  Search   1                          0.05        499
  Search   \...                       0.05        \...

  : [Table 3](#table-3){.selfRef}: [IP-Layer Sender Bit Rate Results
  (Example with Two Flows and st = 0.05
  (sec))](#name-ip-layer-sender-bit-rate-re){.selfRef}

Static and configuration Parameters:[¶](#section-9-11){.pilcrow}

The sub-interval duration, st, [MUST]{.bcp14} accompany a report of
Sender IP-Layer Bit Rate results.[¶](#section-9-12){.pilcrow}

Also, the values of the remaining Parameters from [Section
4](#gen-params-defs){.xref} (\"General Parameters and Definitions\")
[MUST]{.bcp14} be reported.[¶](#section-9-13){.pilcrow}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Configuration and Reporting Data Formats](#name-configuration-and-reporting){.section-name .selfRef} {#name-configuration-and-reporting}

As a part of the multi-Standards Development Organization (SDO)
harmonization of this Metric and Method of Measurement, one of the areas
where the Broadband Forum (BBF) contributed its expertise was in the
definition of an information model and data model for configuration and
reporting. These models are consistent with the metric Parameters and
default values specified as lists in this memo.
\[[TR-471](#TR-471){.xref}\] provides the information model that was
used to prepare a full data model in related BBF work. The BBF has also
carefully considered topics within its purview, such as the placement of
measurement systems within the Internet access architecture. For
example, timestamp resolution requirements that influence the choice of
the test protocol are provided in Table 2 of
\[[TR-471](#TR-471){.xref}\].[¶](#section-9.1-1){.pilcrow}
:::
:::
:::

::: {#sec-cons}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

Active Metrics and Active Measurements have a long history of security
considerations. The security considerations that apply to any Active
Measurement of live paths are relevant here. See
\[[RFC4656](#RFC4656){.xref}\] and
\[[RFC5357](#RFC5357){.xref}\].[¶](#section-10-1){.pilcrow}

When considering the privacy of those involved in measurement or those
whose traffic is measured, the sensitive information available to
potential observers is greatly reduced when using active techniques that
are within this scope of work. Passive observations of user traffic for
measurement purposes raise many privacy issues. We refer the reader to
the privacy considerations described in the Large-scale Measurement of
Broadband Performance (LMAP) Framework \[[RFC7594](#RFC7594){.xref}\],
which covers active and passive techniques.[¶](#section-10-2){.pilcrow}

There are some new considerations for Capacity measurement as described
in this memo.[¶](#section-10-3){.pilcrow}

1.  [Cooperating Source and Destination hosts and agreements to test the
    path between the hosts are [REQUIRED]{.bcp14}. Hosts perform in
    either the Src role or the Dst
    role.[¶](#section-10-4.1){.pilcrow}]{#section-10-4.1}
2.  [It is [REQUIRED]{.bcp14} to have a user client-initiated setup
    handshake between cooperating hosts that allows firewalls to control
    inbound unsolicited UDP traffic that goes to either a control port
    (expected and with authentication) or ephemeral ports that are only
    created as needed. Firewalls protecting each host can both continue
    to do their job
    normally.[¶](#section-10-4.2){.pilcrow}]{#section-10-4.2}
3.  [Client-server authentication and integrity protection for feedback
    messages conveying measurements are
    [RECOMMENDED]{.bcp14}.[¶](#section-10-4.3){.pilcrow}]{#section-10-4.3}
4.  [Hosts [MUST]{.bcp14} limit the number of simultaneous tests to
    avoid resource exhaustion and inaccurate
    results.[¶](#section-10-4.4){.pilcrow}]{#section-10-4.4}
5.  [Senders [MUST]{.bcp14} be rate limited. This can be accomplished
    using a pre-built table defining all the offered load rates that
    will be supported ([Section 8.1](#load-rate-adj){.xref}). The
    recommended load control search algorithm results in \"ramp-up\"
    from the lowest rate in the
    table.[¶](#section-10-4.5){.pilcrow}]{#section-10-4.5}
6.  [Service subscribers with limited data volumes who conduct extensive
    capacity testing might experience the effects of Service Provider
    controls on their service. Testing with the Service Provider\'s
    measurement hosts [SHOULD]{.bcp14} be limited in frequency and/or
    overall volume of test traffic (for example, the range of duration
    values, I, [SHOULD]{.bcp14} be
    limited).[¶](#section-10-4.6){.pilcrow}]{#section-10-4.6}

The exact specification of these features is left for future protocol
development.[¶](#section-10-5){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-11-1){.pilcrow}
:::
:::

::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-12.1 .section}
### [12.1.](#section-12.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2330\]
:   [Paxson, V.]{.refAuthor}, [Almes, G.]{.refAuthor},
    [Mahdavi, J.]{.refAuthor}, and [M. Mathis]{.refAuthor}, [\"Framework
    for IP Performance Metrics\"]{.refTitle}, [RFC 2330]{.seriesInfo},
    [DOI 10.17487/RFC2330]{.seriesInfo}, May 1998,
    \<<https://www.rfc-editor.org/info/rfc2330>\>.
:   

\[RFC2681\]
:   [Almes, G.]{.refAuthor}, [Kalidindi, S.]{.refAuthor}, and [M.
    Zekauskas]{.refAuthor}, [\"A Round-trip Delay Metric for
    IPPM\"]{.refTitle}, [RFC 2681]{.seriesInfo}, [DOI
    10.17487/RFC2681]{.seriesInfo}, September 1999,
    \<<https://www.rfc-editor.org/info/rfc2681>\>.
:   

\[RFC4656\]
:   [Shalunov, S.]{.refAuthor}, [Teitelbaum, B.]{.refAuthor},
    [Karp, A.]{.refAuthor}, [Boote, J.]{.refAuthor}, and [M.
    Zekauskas]{.refAuthor}, [\"A One-way Active Measurement Protocol
    (OWAMP)\"]{.refTitle}, [RFC 4656]{.seriesInfo}, [DOI
    10.17487/RFC4656]{.seriesInfo}, September 2006,
    \<<https://www.rfc-editor.org/info/rfc4656>\>.
:   

\[RFC4737\]
:   [Morton, A.]{.refAuthor}, [Ciavattone, L.]{.refAuthor},
    [Ramachandran, G.]{.refAuthor}, [Shalunov, S.]{.refAuthor}, and [J.
    Perser]{.refAuthor}, [\"Packet Reordering Metrics\"]{.refTitle},
    [RFC 4737]{.seriesInfo}, [DOI 10.17487/RFC4737]{.seriesInfo},
    November 2006, \<<https://www.rfc-editor.org/info/rfc4737>\>.
:   

\[RFC5357\]
:   [Hedayat, K.]{.refAuthor}, [Krzanowski, R.]{.refAuthor},
    [Morton, A.]{.refAuthor}, [Yum, K.]{.refAuthor}, and [J.
    Babiarz]{.refAuthor}, [\"A Two-Way Active Measurement Protocol
    (TWAMP)\"]{.refTitle}, [RFC 5357]{.seriesInfo}, [DOI
    10.17487/RFC5357]{.seriesInfo}, October 2008,
    \<<https://www.rfc-editor.org/info/rfc5357>\>.
:   

\[RFC6438\]
:   [Carpenter, B.]{.refAuthor} and [S. Amante]{.refAuthor}, [\"Using
    the IPv6 Flow Label for Equal Cost Multipath Routing and Link
    Aggregation in Tunnels\"]{.refTitle}, [RFC 6438]{.seriesInfo}, [DOI
    10.17487/RFC6438]{.seriesInfo}, November 2011,
    \<<https://www.rfc-editor.org/info/rfc6438>\>.
:   

\[RFC7497\]
:   [Morton, A.]{.refAuthor}, [\"Rate Measurement Test Protocol Problem
    Statement and Requirements\"]{.refTitle}, [RFC 7497]{.seriesInfo},
    [DOI 10.17487/RFC7497]{.seriesInfo}, April 2015,
    \<<https://www.rfc-editor.org/info/rfc7497>\>.
:   

\[RFC7680\]
:   [Almes, G.]{.refAuthor}, [Kalidindi, S.]{.refAuthor},
    [Zekauskas, M.]{.refAuthor}, and [A. Morton, Ed.]{.refAuthor}, [\"A
    One-Way Loss Metric for IP Performance Metrics (IPPM)\"]{.refTitle},
    [STD 82]{.seriesInfo}, [RFC 7680]{.seriesInfo}, [DOI
    10.17487/RFC7680]{.seriesInfo}, January 2016,
    \<<https://www.rfc-editor.org/info/rfc7680>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8468\]
:   [Morton, A.]{.refAuthor}, [Fabini, J.]{.refAuthor},
    [Elkins, N.]{.refAuthor}, [Ackermann, M.]{.refAuthor}, and [V.
    Hegde]{.refAuthor}, [\"IPv4, IPv6, and IPv4-IPv6 Coexistence:
    Updates for the IP Performance Metrics (IPPM)
    Framework\"]{.refTitle}, [RFC 8468]{.seriesInfo}, [DOI
    10.17487/RFC8468]{.seriesInfo}, November 2018,
    \<<https://www.rfc-editor.org/info/rfc8468>\>.
:   
:::

::: {#section-12.2 .section}
### [12.2.](#section-12.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[copycat\]
:   [Edeline, K.]{.refAuthor}, [Kühlewind, M.]{.refAuthor},
    [Trammell, B.]{.refAuthor}, and [B. Donnet]{.refAuthor}, [\"copycat:
    Testing Differential Treatment of New Transport Protocols in the
    Wild\"]{.refTitle}, [ANRW \'17]{.refContent}, [DOI
    10.1145/3106328.3106330]{.seriesInfo}, July 2017,
    \<<https://irtf.org/anrw/2017/anrw17-final5.pdf>\>.
:   

\[LS-SG12-A\]
:   [\"Liaison statement: LS - Harmonization of IP Capacity and Latency
    Parameters: Revision of Draft Rec. Y.1540 on IP packet transfer
    performance parameters and New Annex A with Lab Evaluation
    Plan\"]{.refTitle}, [From ITU-T SG 12]{.refContent}, March 2019,
    \<<https://datatracker.ietf.org/liaison/1632/>\>.
:   

\[LS-SG12-B\]
:   [\"Liaison statement: LS on harmonization of IP Capacity and Latency
    Parameters: Consent of Draft Rec. Y.1540 on IP packet transfer
    performance parameters and New Annex A with Lab & Field Evaluation
    Plans\"]{.refTitle}, [From ITU-T-SG-12]{.refContent}, May 2019,
    \<<https://datatracker.ietf.org/liaison/1645/>\>.
:   

\[RFC2544\]
:   [Bradner, S.]{.refAuthor} and [J. McQuaid]{.refAuthor},
    [\"Benchmarking Methodology for Network Interconnect
    Devices\"]{.refTitle}, [RFC 2544]{.seriesInfo}, [DOI
    10.17487/RFC2544]{.seriesInfo}, March 1999,
    \<<https://www.rfc-editor.org/info/rfc2544>\>.
:   

\[RFC3148\]
:   [Mathis, M.]{.refAuthor} and [M. Allman]{.refAuthor}, [\"A Framework
    for Defining Empirical Bulk Transfer Capacity Metrics\"]{.refTitle},
    [RFC 3148]{.seriesInfo}, [DOI 10.17487/RFC3148]{.seriesInfo}, July
    2001, \<<https://www.rfc-editor.org/info/rfc3148>\>.
:   

\[RFC5136\]
:   [Chimento, P.]{.refAuthor} and [J. Ishac]{.refAuthor}, [\"Defining
    Network Capacity\"]{.refTitle}, [RFC 5136]{.seriesInfo}, [DOI
    10.17487/RFC5136]{.seriesInfo}, February 2008,
    \<<https://www.rfc-editor.org/info/rfc5136>\>.
:   

\[RFC6815\]
:   [Bradner, S.]{.refAuthor}, [Dubray, K.]{.refAuthor},
    [McQuaid, J.]{.refAuthor}, and [A. Morton]{.refAuthor},
    [\"Applicability Statement for RFC 2544: Use on Production Networks
    Considered Harmful\"]{.refTitle}, [RFC 6815]{.seriesInfo}, [DOI
    10.17487/RFC6815]{.seriesInfo}, November 2012,
    \<<https://www.rfc-editor.org/info/rfc6815>\>.
:   

\[RFC7312\]
:   [Fabini, J.]{.refAuthor} and [A. Morton]{.refAuthor}, [\"Advanced
    Stream and Sampling Framework for IP Performance Metrics
    (IPPM)\"]{.refTitle}, [RFC 7312]{.seriesInfo}, [DOI
    10.17487/RFC7312]{.seriesInfo}, August 2014,
    \<<https://www.rfc-editor.org/info/rfc7312>\>.
:   

\[RFC7594\]
:   [Eardley, P.]{.refAuthor}, [Morton, A.]{.refAuthor},
    [Bagnulo, M.]{.refAuthor}, [Burbridge, T.]{.refAuthor},
    [Aitken, P.]{.refAuthor}, and [A. Akhter]{.refAuthor}, [\"A
    Framework for Large-Scale Measurement of Broadband Performance
    (LMAP)\"]{.refTitle}, [RFC 7594]{.seriesInfo}, [DOI
    10.17487/RFC7594]{.seriesInfo}, September 2015,
    \<<https://www.rfc-editor.org/info/rfc7594>\>.
:   

\[RFC7799\]
:   [Morton, A.]{.refAuthor}, [\"Active and Passive Metrics and Methods
    (with Hybrid Types In-Between)\"]{.refTitle}, [RFC
    7799]{.seriesInfo}, [DOI 10.17487/RFC7799]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7799>\>.
:   

\[RFC8085\]
:   [Eggert, L.]{.refAuthor}, [Fairhurst, G.]{.refAuthor}, and [G.
    Shepherd]{.refAuthor}, [\"UDP Usage Guidelines\"]{.refTitle}, [BCP
    145]{.seriesInfo}, [RFC 8085]{.seriesInfo}, [DOI
    10.17487/RFC8085]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8085>\>.
:   

\[RFC8337\]
:   [Mathis, M.]{.refAuthor} and [A. Morton]{.refAuthor}, [\"Model-Based
    Metrics for Bulk Transport Capacity\"]{.refTitle}, [RFC
    8337]{.seriesInfo}, [DOI 10.17487/RFC8337]{.seriesInfo}, March 2018,
    \<<https://www.rfc-editor.org/info/rfc8337>\>.
:   

\[TR-471\]
:   [Morton, A.]{.refAuthor}, [\"Maximum IP-Layer Capacity Metric,
    Related Metrics, and Measurements\"]{.refTitle}, [Broadband Forum
    TR-471]{.refContent}, July 2020,
    \<<https://www.broadband-forum.org/technical/download/TR-471.pdf>\>.
:   

\[Y.1540\]
:   [ITU-T]{.refAuthor}, [\"Internet protocol data communication
    service - IP packet transfer and availability performance
    parameters\"]{.refTitle}, [ITU-T Recommendation
    Y.1540]{.refContent}, December 2019,
    \<<https://www.itu.int/rec/T-REC-Y.1540-201912-I/en>\>.
:   

\[Y.Sup60\]
:   [ITU-T]{.refAuthor}, [\"Interpreting ITU-T Y.1540 maximum IP-layer
    capacity measurements\"]{.refTitle}, [ITU-T Recommendation
    Y.Sup60]{.refContent}, October 2021,
    \<<https://www.itu.int/rec/T-REC-Y.Sup60/en>\>.
:   
:::
:::

::: {#app-a-load-rate-adj-pseudocode}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Load Rate Adjustment Pseudocode](#name-load-rate-adjustment-pseudo){.section-name .selfRef} {#name-load-rate-adjustment-pseudo}

This appendix provides a pseudocode implementation of the algorithm
described in [Section
8.1](#load-rate-adj){.xref}.[¶](#appendix-A-1){.pilcrow}

::: {#appendix-A-2}
``` {.lang-pseudocode .sourcecode}
Rx = 0              # The current sending rate (equivalent to a row
                    # of the table)

seqErr = 0          # Measured count that includes Loss or Reordering
                    # or Duplication impairments (all appear
                    # initially as errors in the packet sequence
                    # numbering)

seqErrThresh = 10   # Threshold on seqErr count that includes Loss or
                    # Reordering or Duplication impairments (all
                    # appear initially as errors in the packet
                    # sequence numbering)

delay = 0           # Measured Range of Round Trip Delay (RTD), msec

lowThresh = 30      # Low threshold on the Range of RTD, msec

upperThresh = 90    # Upper threshold on the Range of RTD, msec

hSpeedThresh = 1    # Threshold for transition between sending rate
                    # step sizes (such as 1 Mbps and 100 Mbps), Gbps

slowAdjCount = 0    # Measured Number of consecutive status reports
                    # indicating loss and/or delay variation above
                    # upperThresh

slowAdjThresh = 3   # Threshold on slowAdjCount used to infer
                    # congestion. Use values > 1 to avoid
                    # misinterpreting transient loss.

highSpeedDelta = 10 # The number of rows to move in a single
                    # adjustment when initially increasing offered
                    # load (to ramp up quickly)

maxLoadRates = 2000 # Maximum table index (rows)

if ( seqErr <= seqErrThresh && delay < lowThresh ) {
        if ( Rx < hSpeedThresh && slowAdjCount < slowAdjThresh ) {
                        Rx += highSpeedDelta;
                        slowAdjCount = 0;
        } else {
                        if ( Rx < maxLoadRates - 1 )
                                        Rx++;
        }
} else if ( seqErr > seqErrThresh || delay > upperThresh ) {
        slowAdjCount++;
        if ( Rx < hSpeedThresh && slowAdjCount == slowAdjThresh ) {
                        if ( Rx > highSpeedDelta * 3 )
                                        Rx -= highSpeedDelta * 3;
                        else
                                        Rx = 0;
        } else {
                        if ( Rx > 0 )
                                        Rx--;
        }
}
```

[¶](#appendix-A-2){.pilcrow}
:::
:::
:::

::: {#app-b-rfc8085-udp}
::: {#appendix-B .section}
## [Appendix B.](#appendix-B){.section-number .selfRef} [RFC 8085 UDP Guidelines Check](#name-rfc-8085-udp-guidelines-che){.section-name .selfRef} {#name-rfc-8085-udp-guidelines-che}

[Section
3.1](https://www.rfc-editor.org/rfc/rfc8085#section-3.1){.relref} of
\[[RFC8085](#RFC8085){.xref}\] (BCP 145), which provides UDP usage
guidelines, focuses primarily on congestion control. The guidelines
appear in mandatory ([MUST]{.bcp14}) and recommendation
([SHOULD]{.bcp14}) categories.[¶](#appendix-B-1){.pilcrow}

::: {#appendix-B.1 .section}
### [B.1.](#appendix-B.1){.section-number .selfRef} [Assessment of Mandatory Requirements](#name-assessment-of-mandatory-req){.section-name .selfRef} {#name-assessment-of-mandatory-req}

The mandatory requirements in [Section
3](https://www.rfc-editor.org/rfc/rfc8085#section-3){.relref} of
\[[RFC8085](#RFC8085){.xref}\] include the
following:[¶](#appendix-B.1-1){.pilcrow}

> Internet paths can have widely varying characteristics, \...
> Consequently, applications that may be used on the Internet [MUST
> NOT]{.bcp14} make assumptions about specific path characteristics.
> They [MUST]{.bcp14} instead use mechanisms that let them operate
> safely under very different path conditions. Typically, this requires
> conservatively probing the current conditions of the Internet path
> they communicate over to establish a transmission behavior that it can
> sustain and that is reasonably fair to other traffic sharing the
> path.[¶](#appendix-B.1-2){.pilcrow}

The purpose of the load rate adjustment algorithm described in [Section
8.1](#load-rate-adj){.xref} is to probe the network and enable Maximum
IP-Layer Capacity measurements with as few assumptions about the
measured path as possible and within the range of applications described
in [Section 2](#sec-2-scope){.xref}. There is tension between the goals
of probing conservatism and minimization of both the traffic dedicated
to testing (especially with Gigabit rate measurements) and the duration
of the test (which is one contributing factor to the overall algorithm
fairness).[¶](#appendix-B.1-3){.pilcrow}

The text of [Section
3](https://www.rfc-editor.org/rfc/rfc8085#section-3){.relref} of
\[[RFC8085](#RFC8085){.xref}\] goes on to recommend alternatives to UDP
to meet the mandatory requirements, but none are suitable for the scope
and purpose of the Metrics and Methods in this memo. In fact, ad hoc
TCP-based methods fail to achieve the measurement accuracy repeatedly
proven in comparison measurements with the running code
\[[LS-SG12-A](#LS-SG12-A){.xref}\] \[[LS-SG12-B](#LS-SG12-B){.xref}\]
\[[Y.Sup60](#Y.Sup60){.xref}\]. Also, the UDP aspect of these methods is
present primarily to support modern Internet transmission where a
transport protocol is required \[[copycat](#copycat){.xref}\]; the
metric is based on the IP Layer, and UDP allows simple correlation to
the IP Layer.[¶](#appendix-B.1-4){.pilcrow}

[Section
3.1.1](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.1){.relref} of
\[[RFC8085](#RFC8085){.xref}\] discusses protocol timer
guidelines:[¶](#appendix-B.1-5){.pilcrow}

> Latency samples [MUST NOT]{.bcp14} be derived from ambiguous
> transactions. The canonical example is in a protocol that retransmits
> data, but subsequently cannot determine which copy is being
> acknowledged.[¶](#appendix-B.1-6){.pilcrow}

Both load packets and status feedback messages [MUST]{.bcp14} contain
sequence numbers; this helps with measurements based on those packets,
and there are no retransmissions needed.[¶](#appendix-B.1-7){.pilcrow}

> When a latency estimate is used to arm a timer that provides loss
> detection \-- with or without retransmission \-- expiry of the timer
> [MUST]{.bcp14} be interpreted as an indication of congestion in the
> network, causing the sending rate to be adapted to a safe conservative
> rate \...[¶](#appendix-B.1-8){.pilcrow}

The methods described in this memo use timers for sending rate backoff
when status feedback messages are lost (Lost Status Backoff timeout) and
for stopping a test when connectivity is lost for a longer interval
(feedback message or load packet
timeouts).[¶](#appendix-B.1-9){.pilcrow}

This memo does not foresee any specific benefit of using Explicit
Congestion Notification (ECN).[¶](#appendix-B.1-10){.pilcrow}

[Section
3.2](https://www.rfc-editor.org/rfc/rfc8085#section-3.2){.relref} of
\[[RFC8085](#RFC8085){.xref}\] discusses message size
guidelines:[¶](#appendix-B.1-11){.pilcrow}

> To determine an appropriate UDP payload size, applications
> [MUST]{.bcp14} subtract the size of the IP header (which includes any
> IPv4 optional headers or IPv6 extension headers) as well as the length
> of the UDP header (8 bytes) from the PMTU
> size.[¶](#appendix-B.1-12){.pilcrow}

The method uses a sending rate table with a maximum UDP payload size
that anticipates significant header overhead and avoids
fragmentation.[¶](#appendix-B.1-13){.pilcrow}

[Section
3.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.3){.relref} of
\[[RFC8085](#RFC8085){.xref}\] provides reliability
guidelines:[¶](#appendix-B.1-14){.pilcrow}

> Applications that do require reliable message delivery [MUST]{.bcp14}
> implement an appropriate mechanism
> themselves.[¶](#appendix-B.1-15){.pilcrow}

The IP-Layer Capacity Metrics and Methods do not require reliable
delivery.[¶](#appendix-B.1-16){.pilcrow}

> Applications that require ordered delivery [MUST]{.bcp14} reestablish
> datagram ordering themselves.[¶](#appendix-B.1-17){.pilcrow}

The IP-Layer Capacity Metrics and Methods do not need to reestablish
packet order; it is preferable to measure packet reordering if it occurs
\[[RFC4737](#RFC4737){.xref}\].[¶](#appendix-B.1-18){.pilcrow}
:::

::: {#appendix-B.2 .section}
### [B.2.](#appendix-B.2){.section-number .selfRef} [Assessment of Recommendations](#name-assessment-of-recommendatio){.section-name .selfRef} {#name-assessment-of-recommendatio}

The load rate adjustment algorithm\'s goal is to determine the Maximum
IP-Layer Capacity in the context of an infrequent, diagnostic,
short-term measurement. This goal is a global exception to many
[SHOULD]{.bcp14}-level requirements as listed in
\[[RFC8085](#RFC8085){.xref}\], of which many are intended for
long-lived flows that must coexist with other traffic in a more or less
fair way. However, the algorithm (as specified in [Section
8.1](#load-rate-adj){.xref} and [Appendix
A](#app-a-load-rate-adj-pseudocode){.xref} above) reacts to indications
of congestion in clearly defined ways.[¶](#appendix-B.2-1){.pilcrow}

A specific recommendation is provided as an example. [Section
3.1.5](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.5){.relref} of
\[[RFC8085](#RFC8085){.xref}\] (regarding the implications of RTT and
loss measurements on congestion control)
says:[¶](#appendix-B.2-2){.pilcrow}

> A congestion control \[algorithm\] designed for UDP [SHOULD]{.bcp14}
> respond as quickly as possible when it experiences congestion, and it
> [SHOULD]{.bcp14} take into account both the loss rate and the response
> time when choosing a new rate.[¶](#appendix-B.2-3){.pilcrow}

The load rate adjustment algorithm responds to loss and RTT measurements
with a clear and concise rate reduction when warranted, and the response
makes use of direct measurements (more exact than can be inferred from
TCP ACKs).[¶](#appendix-B.2-4){.pilcrow}

[Section
3.1.5](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.5){.relref} of
\[[RFC8085](#RFC8085){.xref}\] goes on to specify the
following:[¶](#appendix-B.2-5){.pilcrow}

> The implemented congestion control scheme [SHOULD]{.bcp14} result in
> bandwidth (capacity) use that is comparable to that of TCP within an
> order of magnitude, so that it does not starve other flows sharing a
> common bottleneck.[¶](#appendix-B.2-6){.pilcrow}

This is a requirement for coexistent streams, and not for diagnostic and
infrequent measurements using short durations. The rate oscillations
during short tests allow other packets to pass and don\'t starve other
flows.[¶](#appendix-B.2-7){.pilcrow}

Ironically, ad hoc TCP-based measurements of \"Internet Speed\" are also
designed to work around this [SHOULD]{.bcp14}-level requirement, by
launching many flows (9, for example) to increase the outstanding data
dedicated to testing.[¶](#appendix-B.2-8){.pilcrow}

The load rate adjustment algorithm cannot become a TCP-like congestion
control, or it will have the same weaknesses of TCP when trying to make
a Maximum IP-Layer Capacity measurement and will not achieve the goal.
The results of the referenced testing \[[LS-SG12-A](#LS-SG12-A){.xref}\]
\[[LS-SG12-B](#LS-SG12-B){.xref}\] \[[Y.Sup60](#Y.Sup60){.xref}\]
supported this statement hundreds of times, with comparisons to
multi-connection TCP-based measurements.[¶](#appendix-B.2-9){.pilcrow}

A brief review of requirements from \[[RFC8085](#RFC8085){.xref}\]
follows (marked \"Yes\" when this memo is compliant, or \"NA\" (Not
Applicable)):[¶](#appendix-B.2-10){.pilcrow}

[]{#name-summary-of-key-guidelines-f}

::: {#recs-rfc8085}
  Yes?   Recommendation in RFC 8085                                                                                                                                                         Section
  ------ ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------------------------------------------
  Yes    [MUST]{.bcp14} tolerate a wide range of Internet path conditions                                                                                                                   [3](https://www.rfc-editor.org/rfc/rfc8085#section-3){.relref}
  NA     [SHOULD]{.bcp14} use a full-featured transport (e.g., TCP)                                                                                                                         
                                                                                                                                                                                            
  Yes    [SHOULD]{.bcp14} control rate of transmission                                                                                                                                      [3.1](https://www.rfc-editor.org/rfc/rfc8085#section-3.1){.relref}
  NA     [SHOULD]{.bcp14} perform congestion control over all traffic                                                                                                                       
                                                                                                                                                                                            
         For bulk transfers,                                                                                                                                                                [3.1.2](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.2){.relref}
  NA     [SHOULD]{.bcp14} consider implementing TFRC                                                                                                                                        
  NA     else, [SHOULD]{.bcp14} in other ways use bandwidth similar to TCP                                                                                                                  
                                                                                                                                                                                            
         For non-bulk transfers,                                                                                                                                                            [3.1.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.3){.relref}
  NA     [SHOULD]{.bcp14} measure RTT and transmit max. 1 datagram/RTT                                                                                                                      [3.1.1](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.1){.relref}
  NA     else, [SHOULD]{.bcp14} send at most 1 datagram every 3 seconds                                                                                                                     
  NA     [SHOULD]{.bcp14} back-off retransmission timers following loss                                                                                                                     
                                                                                                                                                                                            
  Yes    [SHOULD]{.bcp14} provide mechanisms to regulate the bursts of transmission                                                                                                         [3.1.6](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.6){.relref}
                                                                                                                                                                                            
  NA     [MAY]{.bcp14} implement ECN; a specific set of application mechanisms are [REQUIRED]{.bcp14} if ECN is used                                                                        [3.1.7](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.7){.relref}
                                                                                                                                                                                            
  Yes    For DiffServ, [SHOULD NOT]{.bcp14} rely on implementation of PHBs                                                                                                                  [3.1.8](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.8){.relref}
                                                                                                                                                                                            
  Yes    For QoS-enabled paths, [MAY]{.bcp14} choose not to use CC                                                                                                                          [3.1.9](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.9){.relref}
                                                                                                                                                                                            
  Yes    [SHOULD NOT]{.bcp14} rely solely on QoS for their capacity                                                                                                                         [3.1.10](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.10){.relref}
  NA     non-CC controlled flows [SHOULD]{.bcp14} implement a transport circuit breaker                                                                                                     
  Yes    [MAY]{.bcp14} implement a circuit breaker for other applications                                                                                                                   
                                                                                                                                                                                            
         For tunnels carrying IP traffic,                                                                                                                                                   [3.1.11](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.11){.relref}
  NA     [SHOULD NOT]{.bcp14} perform congestion control                                                                                                                                    
  NA     [MUST]{.bcp14} correctly process the IP ECN field                                                                                                                                  
                                                                                                                                                                                            
         For non-IP tunnels or rate not determined by traffic,                                                                                                                              [3.1.11](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.11){.relref}
  NA     [SHOULD]{.bcp14} perform CC or use circuit breaker                                                                                                                                 
  NA     [SHOULD]{.bcp14} restrict types of traffic transported by the tunnel                                                                                                               
                                                                                                                                                                                            
  Yes    [SHOULD NOT]{.bcp14} send datagrams that exceed the PMTU, i.e.,                                                                                                                    [3.2](https://www.rfc-editor.org/rfc/rfc8085#section-3.2){.relref}
  Yes    [SHOULD]{.bcp14} discover PMTU or send datagrams \< minimum PMTU                                                                                                                   
  NA     Specific application mechanisms are [REQUIRED]{.bcp14} if PLPMTUD is used                                                                                                          
                                                                                                                                                                                            
  Yes    [SHOULD]{.bcp14} handle datagram loss, duplication, reordering                                                                                                                     [3.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.3){.relref}
  NA     [SHOULD]{.bcp14} be robust to delivery delays up to 2 minutes                                                                                                                      
                                                                                                                                                                                            
  Yes    [SHOULD]{.bcp14} enable IPv4 UDP checksum                                                                                                                                          [3.4](https://www.rfc-editor.org/rfc/rfc8085#section-3.4){.relref}
  Yes    [SHOULD]{.bcp14} enable IPv6 UDP checksum; specific application mechanisms are [REQUIRED]{.bcp14} if a zero IPv6 UDP checksum is used                                              [3.4.1](https://www.rfc-editor.org/rfc/rfc8085#section-3.4.1){.relref}
                                                                                                                                                                                            
  NA     [SHOULD]{.bcp14} provide protection from off-path attacks                                                                                                                          [5.1](https://www.rfc-editor.org/rfc/rfc8085#section-5.1){.relref}
         else, [MAY]{.bcp14} use UDP-Lite with suitable checksum coverage                                                                                                                   [3.4.2](https://www.rfc-editor.org/rfc/rfc8085#section-3.4.2){.relref}
                                                                                                                                                                                            
  NA     [SHOULD NOT]{.bcp14} always send middlebox keep-alive messages                                                                                                                     [3.5](https://www.rfc-editor.org/rfc/rfc8085#section-3.5){.relref}
  NA     [MAY]{.bcp14} use keep-alives when needed (min. interval 15 sec)                                                                                                                   
                                                                                                                                                                                            
  Yes    Applications specified for use in limited use (or controlled environments) [SHOULD]{.bcp14} identify equivalent mechanisms and describe their use case                             [3.6](https://www.rfc-editor.org/rfc/rfc8085#section-3.6){.relref}
                                                                                                                                                                                            
  NA     Bulk-multicast apps [SHOULD]{.bcp14} implement congestion control                                                                                                                  [4.1.1](https://www.rfc-editor.org/rfc/rfc8085#section-4.1.1){.relref}
                                                                                                                                                                                            
  NA     Low volume multicast apps [SHOULD]{.bcp14} implement congestion control                                                                                                            [4.1.2](https://www.rfc-editor.org/rfc/rfc8085#section-4.1.2){.relref}
                                                                                                                                                                                            
  NA     Multicast apps [SHOULD]{.bcp14} use a safe PMTU                                                                                                                                    [4.2](https://www.rfc-editor.org/rfc/rfc8085#section-4.2){.relref}
                                                                                                                                                                                            
  Yes    [SHOULD]{.bcp14} avoid using multiple ports                                                                                                                                        [5.1.2](https://www.rfc-editor.org/rfc/rfc8085#section-5.1.2){.relref}
  Yes    [MUST]{.bcp14} check received IP source address                                                                                                                                    
                                                                                                                                                                                            
  NA     [SHOULD]{.bcp14} validate payload in ICMP messages                                                                                                                                 [5.2](https://www.rfc-editor.org/rfc/rfc8085#section-5.2){.relref}
                                                                                                                                                                                            
  Yes    [SHOULD]{.bcp14} use a randomized Source port or equivalent technique, and, for client/server applications, [SHOULD]{.bcp14} send responses from source address matching request   [6](https://www.rfc-editor.org/rfc/rfc8085#section-6){.relref}
  NA     [SHOULD]{.bcp14} use standard IETF security protocols when needed                                                                                                                  [6](https://www.rfc-editor.org/rfc/rfc8085#section-6){.relref}

  : [Table 4](#table-4){.selfRef}: [Summary of Key Guidelines from RFC
  8085](#name-summary-of-key-guidelines-f){.selfRef}
:::
:::
:::
:::

::: {#appendix-C .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

Thanks to [Joachim Fabini]{.contact-name}, [Matt Mathis]{.contact-name},
[J. Ignacio Alvarez-Hamelin]{.contact-name}, [Wolfgang
Balzer]{.contact-name}, [Frank Brockners]{.contact-name}, [Greg
Mirsky]{.contact-name}, [Martin Duke]{.contact-name}, [Murray
Kucherawy]{.contact-name}, and [Benjamin Kaduk]{.contact-name} for their
extensive comments on this memo and related topics. In a second round of
reviews, we acknowledge [Magnus Westerlund]{.contact-name}, [Lars
Eggert]{.contact-name}, and [Zaheduzzaman
Sarker]{.contact-name}.[¶](#appendix-C-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Al Morton]{.fn .nameRole}
:::

::: {.left dir="auto"}
[AT&T Labs]{.org}
:::

::: {.left dir="auto"}
[200 Laurel Avenue South]{.street-address}
:::

::: {.left dir="auto"}
[Middletown]{.locality}, [NJ]{.region} [07748]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 732 420 1571](tel:+1%20732%20420%201571){.tel}
:::

::: email
Email: <acm@research.att.com>
:::

::: {.left dir="auto"}
[Rüdiger Geib]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Deutsche Telekom]{.org}
:::

::: {.left dir="auto"}
[Heinrich Hertz Str. 3-7]{.street-address}
:::

::: {.left dir="auto"}
[64295]{.postal-code} [Darmstadt]{.locality}
:::

::: {.left dir="auto"}
[Germany]{.country-name}
:::

::: tel
Phone: [+49 6151 5812747](tel:+49%206151%205812747){.tel}
:::

::: email
Email: <Ruediger.Geib@telekom.de>
:::

::: {.left dir="auto"}
[Len Ciavattone]{.fn .nameRole}
:::

::: {.left dir="auto"}
[AT&T Labs]{.org}
:::

::: {.left dir="auto"}
[200 Laurel Avenue South]{.street-address}
:::

::: {.left dir="auto"}
[Middletown]{.locality}, [NJ]{.region} [07748]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1 732 420 1239](tel:+1%20732%20420%201239){.tel}
:::

::: email
Email: <lencia@att.com>
:::
:::
:::
