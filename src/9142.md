  RFC 9142   KEX Method Updates for SSH   January 2022
  ---------- ---------------------------- --------------
  Baushke    Standards Track              \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9142](https://www.rfc-editor.org/rfc/rfc9142){.eref}

Updates:
:   [4250](https://www.rfc-editor.org/rfc/rfc4250){.eref},
    [4253](https://www.rfc-editor.org/rfc/rfc4253){.eref},
    [4432](https://www.rfc-editor.org/rfc/rfc4432){.eref},
    [4462](https://www.rfc-editor.org/rfc/rfc4462){.eref}

Category:
:   Standards Track

Published:
:   January 2022

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    M. Baushke
    :::
    :::
:::

# RFC 9142 {#rfcnum}

# Key Exchange (KEX) Method Updates and Recommendations for Secure Shell (SSH) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document updates the recommended set of key exchange methods for
use in the Secure Shell (SSH) protocol to meet evolving needs for
stronger security. It updates RFCs 4250, 4253, 4432, and
4462.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9142>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Overview and
    Rationale](#name-overview-and-rationale){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [Selecting an Appropriate Hashing
        Algorithm](#name-selecting-an-appropriate-ha){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Selecting an Appropriate Public
        Key Algorithm](#name-selecting-an-appropriate-pu){.xref}

        -   ::: {#section-toc.1-1.1.2.2.2.1}
            [1.2.1](#section-1.2.1){.xref}.  [Elliptic Curve
            Cryptography
            (ECC)](#name-elliptic-curve-cryptography){.xref}
            :::

        -   ::: {#section-toc.1-1.1.2.2.2.2}
            [1.2.2](#section-1.2.2){.xref}.  [Finite Field Cryptography
            (FFC)](#name-finite-field-cryptography-f){.xref}
            :::

        -   ::: {#section-toc.1-1.1.2.2.2.3}
            [1.2.3](#section-1.2.3){.xref}.  [Integer Factorization
            Cryptography
            (IFC)](#name-integer-factorization-crypt){.xref}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Requirements
    Language](#name-requirements-language){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Key Exchange
    Methods](#name-key-exchange-methods){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Elliptic Curve Cryptography
        (ECC)](#name-elliptic-curve-cryptography-){.xref}

        -   ::: {#section-toc.1-1.3.2.1.2.1}
            [3.1.1](#section-3.1.1){.xref}.  [curve25519-sha256 and
            gss-curve25519-sha256-\*](#name-curve25519-sha256-and-gss-c){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.1.2.2}
            [3.1.2](#section-3.1.2){.xref}.  [curve448-sha512 and
            gss-curve448-sha512-\*](#name-curve448-sha512-and-gss-cur){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.1.2.3}
            [3.1.3](#section-3.1.3){.xref}.  [ecdh-\*, ecmqv-sha2, and
            gss-nistp\*](#name-ecdh-ecmqv-sha2-and-gss-nis){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Finite Field Cryptography
        (FFC)](#name-finite-field-cryptography-ff){.xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [FFC Diffie-Hellman Using
            Generated MODP
            Groups](#name-ffc-diffie-hellman-using-ge){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.xref}.  [FFC Diffie-Hellman Using
            Named MODP Groups](#name-ffc-diffie-hellman-using-na){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Integer Factorization Cryptography
        (IFC)](#name-integer-factorization-crypto){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [KDFs and Integrity
        Hashing](#name-kdfs-and-integrity-hashing){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Secure Shell Extension
        Negotiation](#name-secure-shell-extension-nego){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Summary Guidance for Implementation of Key
    Exchange Method Names](#name-summary-guidance-for-implem){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [](#appendix-A){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [](#appendix-B){.xref}[Author\'s
    Address](#name-authors-address){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Overview and Rationale](#name-overview-and-rationale){.section-name .selfRef} {#name-overview-and-rationale}

Secure Shell (SSH) is a common protocol for secure communication on the
Internet. In \[[RFC4253](#RFC4253){.xref}\], SSH originally defined two
Key Exchange (KEX) Method Names that [MUST]{.bcp14} be implemented. Over
time, what was once considered secure is no longer considered secure.
The purpose of this RFC is to recommend that some published key
exchanges be deprecated or disallowed as well as to recommend some that
[SHOULD]{.bcp14} and one that [MUST]{.bcp14} be
adopted.[¶](#section-1-1){.pilcrow}

This document updates \[[RFC4250](#RFC4250){.xref}\],
\[[RFC4253](#RFC4253){.xref}\], \[[RFC4432](#RFC4432){.xref}\], and
\[[RFC4462](#RFC4462){.xref}\] by changing the requirement level
(\"[MUST]{.bcp14}\" moving to \"[SHOULD]{.bcp14}\", \"[MAY]{.bcp14}\",
or \"[SHOULD NOT]{.bcp14}\", and \"[MAY]{.bcp14}\" moving to
\"[MUST]{.bcp14}\", \"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\", or
\"[MUST NOT]{.bcp14}\") of various key exchange mechanisms. Some
recommendations will be unchanged but are included for
completeness.[¶](#section-1-2){.pilcrow}

[Section
7.2](https://www.rfc-editor.org/rfc/rfc4253#section-7.2){.relref} of
\[[RFC4253](#RFC4253){.xref}\] says the
following:[¶](#section-1-3){.pilcrow}

> The key exchange produces two values: a shared secret K, and an
> exchange hash H. Encryption and authentication keys are derived from
> these. The exchange hash H from the first key exchange is additionally
> used as the session identifier, which is a unique identifier for this
> connection. It is used by authentication methods as a part of the data
> that is signed as a proof of possession of a private key. Once
> computed, the session identifier is not changed, even if keys are
> later re-exchanged.[¶](#section-1-4){.pilcrow}

The security strength of the public key exchange algorithm and the hash
used in the Key Derivation Function (KDF) both impact the security of
the shared secret K being used.[¶](#section-1-5){.pilcrow}

The hashing algorithms used by key exchange methods described in this
document are: sha1, sha256, sha384, and sha512. In many cases, the hash
name is explicitly appended to the public key exchange algorithm name.
However, some of them are implicit and defined in the RFC that defines
the key exchange algorithm name.[¶](#section-1-6){.pilcrow}

Various RFCs use different spellings and capitalizations for the hashing
function and encryption function names. For the purpose of this
document, the following are equivalent names: sha1, SHA1, and SHA-1;
sha256, SHA256, SHA-256, and SHA2-256; sha384, SHA384, SHA-384, and
SHA2-384; and sha512, SHA512, SHA-512, and
SHA2-512.[¶](#section-1-7){.pilcrow}

For the purpose of this document, the following are equivalent: aes128,
AES128, AES-128; aes192, AES192, and AES-192; and aes256, AES256, and
AES-256.[¶](#section-1-8){.pilcrow}

It is good to try to match the security strength of the public key
exchange algorithm with the security strength of the symmetric
cipher.[¶](#section-1-9){.pilcrow}

There are many possible symmetric ciphers available with multiple modes.
The list in [Table 1](#sym_ci_sec){.xref} is intended as a
representative sample of those that appear to be present in most SSH
implementations. The security strength estimates are generally available
in \[[RFC4086](#RFC4086){.xref}\] for triple-DES and AES, as well as
Section 5.6.1.1 of
\[[NIST.SP.800-57pt1r5](#NIST.SP.800-57pt1r5){.xref}\].[¶](#section-1-10){.pilcrow}

[]{#name-symmetric-cipher-security-s}

::: {#sym_ci_sec}
  Cipher Name (modes)      Estimated Security Strength
  ------------------------ -----------------------------
  3des (cbc)               112 bits
  aes128 (cbc, ctr, gcm)   128 bits
  aes192 (cbc, ctr, gcm)   192 bits
  aes256 (cbc, ctr, gcm)   256 bits

  : [Table 1](#table-1){.selfRef}: [Symmetric Cipher Security
  Strengths](#name-symmetric-cipher-security-s){.selfRef}
:::

The following subsections describe how to select each component of the
key exchange.[¶](#section-1-12){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Selecting an Appropriate Hashing Algorithm](#name-selecting-an-appropriate-ha){.section-name .selfRef} {#name-selecting-an-appropriate-ha}

The SHA-1 hash is in the process of being deprecated for many
reasons.[¶](#section-1.1-1){.pilcrow}

There have been attacks against SHA-1, and it is no longer strong enough
for SSH security requirements. Therefore, it is desirable to move away
from using it before attacks become more
serious.[¶](#section-1.1-2){.pilcrow}

The SHA-1 hash provides for approximately 80 bits of security strength.
This means that the shared key being used has at most 80 bits of
security strength, which may not be sufficient for most
users.[¶](#section-1.1-3){.pilcrow}

For purposes of key exchange methods, attacks against SHA-1 are
collision attacks that usually rely on human help rather than a
pre-image attack. The SHA-1 hash resistance against a second pre-image
is still at 160 bits, but SSH does not depend on second pre-image
resistance but rather on chosen-prefix collision
resistance.[¶](#section-1.1-4){.pilcrow}

Transcript Collision attacks are documented in
\[[TRANSCRIPTION](#TRANSCRIPTION){.xref}\]. This paper shows that an
on-path attacker does not tamper with the Diffie-Hellman values and does
not know the connection keys. The attack could be used to tamper with
both I_C and I_S (as defined in [Section
7.3](https://www.rfc-editor.org/rfc/rfc4253#section-7.3){.relref} of
\[[RFC4253](#RFC4253){.xref}\]) and might potentially be able to
downgrade the negotiated ciphersuite to a weak cryptographic algorithm
that the attacker knows how to break.[¶](#section-1.1-5){.pilcrow}

These attacks are still computationally very difficult to perform, but
it is desirable that any key exchange using SHA-1 be phased out as soon
as possible.[¶](#section-1.1-6){.pilcrow}

If there is a need for using SHA-1 in a key exchange for compatibility,
it would be desirable to list it last in the preference list of key
exchanges.[¶](#section-1.1-7){.pilcrow}

Use of the SHA-2 family of hashes found in
\[[RFC6234](#RFC6234){.xref}\] rather than the SHA-1 hash is strongly
advised.[¶](#section-1.1-8){.pilcrow}

When it comes to the SHA-2 family of secure hashing functions, SHA2-256
has 128 bits of security strength; SHA2-384 has 192 bits of security
strength; and SHA2-512 has 256 bits of security strength. It is
suggested that the minimum secure hashing function used for key exchange
methods should be SHA2-256 with 128 bits of security strength. Other
hashing functions may also have the same number of bits of security
strength, but none are as yet defined in any RFC for use in a KEX for
SSH.[¶](#section-1.1-9){.pilcrow}

To avoid combinatorial explosion of key exchange names, newer key
exchanges are generally restricted to \*-sha256 and \*-sha512. The
exceptions are ecdh-sha2-nistp384 and gss-nistp384-sha384-\*, which are
defined to use SHA2-384 (also known as SHA-384) defined in
\[[RFC6234](#RFC6234){.xref}\] for the hash
algorithm.[¶](#section-1.1-10){.pilcrow}

[Table 2](#sec_strength){.xref} provides a summary of security strength
for hashing functions for collision resistance. You may consult
\[[NIST.SP.800-107r1](#NIST.SP.800-107r1){.xref}\] for more information
on hash algorithm security strength.[¶](#section-1.1-11){.pilcrow}

[]{#name-hashing-function-security-s}

::: {#sec_strength}
  Hash Name   Estimated Security Strength
  ----------- -----------------------------
  sha1        80 bits (before attacks)
  sha256      128 bits
  sha384      192 bits
  sha512      256 bits

  : [Table 2](#table-2){.selfRef}: [Hashing Function Security
  Strengths](#name-hashing-function-security-s){.selfRef}
:::
:::

::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Selecting an Appropriate Public Key Algorithm](#name-selecting-an-appropriate-pu){.section-name .selfRef} {#name-selecting-an-appropriate-pu}

SSH uses mathematically hard problems for doing key
exchanges:[¶](#section-1.2-1){.pilcrow}

-   [Elliptic Curve Cryptography (ECC) has families of curves for key
    exchange methods for SSH. NIST prime curves with names and other
    curves are available using an object identifier (OID) with Elliptic
    Curve Diffie-Hellman (ECDH) via \[[RFC5656](#RFC5656){.xref}\].
    Curve25519 and curve448 key exchanges are used with ECDH via
    \[[RFC8731](#RFC8731){.xref}\].[¶](#section-1.2-2.1){.pilcrow}]{#section-1.2-2.1}
-   [Finite Field Cryptography (FFC) is used for Diffie-Hellman (DH) key
    exchange with \"safe primes\" either from a specified list found in
    \[[RFC3526](#RFC3526){.xref}\] or generated dynamically via
    \[[RFC4419](#RFC4419){.xref}\] as updated by
    \[[RFC8270](#RFC8270){.xref}\].[¶](#section-1.2-2.2){.pilcrow}]{#section-1.2-2.2}
-   [Integer Factorization Cryptography (IFC) using the RSA algorithm is
    provided for in
    \[[RFC4432](#RFC4432){.xref}\].[¶](#section-1.2-2.3){.pilcrow}]{#section-1.2-2.3}

It is desirable that the security strength of the key exchange be chosen
to be comparable with the security strength of the other elements of the
SSH handshake. Attackers can target the weakest element of the SSH
handshake.[¶](#section-1.2-3){.pilcrow}

It is desirable that a minimum of 112 bits of security strength be
selected to match the weakest of the symmetric cipher (3des-cbc)
available. Based on implementer security needs, a stronger minimum may
be desired.[¶](#section-1.2-4){.pilcrow}

The larger the Modular Exponentiation (MODP) group, the ECC curve size,
or the RSA key length, the more computation power will be required to
perform the key exchange.[¶](#section-1.2-5){.pilcrow}

::: {#section-1.2.1 .section}
#### [1.2.1.](#section-1.2.1){.section-number .selfRef} [Elliptic Curve Cryptography (ECC)](#name-elliptic-curve-cryptography){.section-name .selfRef} {#name-elliptic-curve-cryptography}

For ECC, across all of the named curves, the minimum security strength
is approximately 128 bits. The \[[RFC5656](#RFC5656){.xref}\] key
exchanges for the named curves use a hashing function with a matching
security strength. Likewise, the \[[RFC8731](#RFC8731){.xref}\] key
exchanges use a hashing function that has more security strength than
the curves. The minimum strength will be the security strength of the
curve. [Table 3](#ecc_sec_strengths){.xref} contains a breakdown of just
the ECC security strength by curve name; it does include the hashing
algorithm used. The curve25519 and curve488 security-level numbers are
in \[[RFC7748](#RFC7748){.xref}\]. The nistp256, nistp384, and nistp521
(NIST prime curves) are provided in \[[RFC5656](#RFC5656){.xref}\]. The
hashing algorithm designated for use with the individual curves have
approximately the same number of bits of security as the named
curve.[¶](#section-1.2.1-1){.pilcrow}

[]{#name-ecc-security-strengths}

::: {#ecc_sec_strengths}
  Curve Name   Estimated Security Strength
  ------------ -----------------------------
  nistp256     128 bits
  nistp384     192 bits
  nistp521     512 bits
  curve25519   128 bits
  curve448     224 bits

  : [Table 3](#table-3){.selfRef}: [ECC Security
  Strengths](#name-ecc-security-strengths){.selfRef}
:::
:::

::: {#section-1.2.2 .section}
#### [1.2.2.](#section-1.2.2){.section-number .selfRef} [Finite Field Cryptography (FFC)](#name-finite-field-cryptography-f){.section-name .selfRef} {#name-finite-field-cryptography-f}

For FFC, it is recommended to use a modulus with a minimum of 2048 bits
(approximately 112 bits of security strength) with a hash that has at
least as many bits of security as the FFC. The security strength of the
FFC and the hash together will be the minimum of those two values. This
is sufficient to provide a consistent security strength for the 3des-cbc
cipher. [Section
1](https://www.rfc-editor.org/rfc/rfc3526#section-1){.relref} of
\[[RFC3526](#RFC3526){.xref}\] notes that the Advanced Encryption
Standard (AES) cipher, which has more strength, needs stronger groups.
For the 128-bit AES, we need about a 3200-bit group. The 192- and
256-bit keys would need groups that are about 8000 and 15400 bits,
respectively. [Table 4](#fcc_modp_sec){.xref} provides the security
strength of the MODP group. When paired with a hashing algorithm, the
security strength will be the minimum of the two
algorithms.[¶](#section-1.2.2-1){.pilcrow}

[]{#name-ffc-modp-security-strengths}

::: {#fcc_modp_sec}
  Prime Field Size   Estimated Security Strength   Example MODP Group
  ------------------ ----------------------------- --------------------
  2048-bit           112 bits                      group14
  3072-bit           128 bits                      group15
  4096-bit           152 bits                      group16
  6144-bit           176 bits                      group17
  8192-bit           200 bits                      group18

  : [Table 4](#table-4){.selfRef}: [FFC MODP Security
  Strengths](#name-ffc-modp-security-strengths){.selfRef}
:::

The minimum MODP group is the 2048-bit MODP group14. When used with a
SHA-1 hash, this group provides approximately 80 bits of security. When
used with a SHA2-256 hash, this group provides approximately 112 bits of
security. The 3des-cbc cipher itself provides at most 112 bits of
security, so the group14-sha256 key exchanges is sufficient to keep all
of the 3des-cbc key, for 112 bits of
security.[¶](#section-1.2.2-3){.pilcrow}

A 3072-bit MODP group when used with a SHA2-256 hash will provide
approximately 128 bits of security. This is desirable when using a
cipher such as aes128 or chacha20-poly1305 that provides approximately
128 bits of security.[¶](#section-1.2.2-4){.pilcrow}

The 8192-bit group18 MODP group when used with sha512 provides
approximately 200 bits of security, which is sufficient to protect
aes192 with 192 bits of security.[¶](#section-1.2.2-5){.pilcrow}
:::

::: {#section-1.2.3 .section}
#### [1.2.3.](#section-1.2.3){.section-number .selfRef} [Integer Factorization Cryptography (IFC)](#name-integer-factorization-crypt){.section-name .selfRef} {#name-integer-factorization-crypt}

The only IFC algorithm for key exchange is the RSA algorithm specified
in \[[RFC4432](#RFC4432){.xref}\]. RSA 1024-bit keys have approximately
80 bits of security strength. RSA 2048-bit keys have approximately 112
bits of security strength. It is worth noting that the IFC types of key
exchange do not provide Forward Secrecy, which both FFC and ECC do
provide.[¶](#section-1.2.3-1){.pilcrow}

In order to match the 112 bits of security strength needed for 3des-cbc,
an RSA 2048-bit key matches the security strength. The use of a SHA-2
family hash with RSA 2048-bit keys has sufficient security to match the
3des-cbc symmetric cipher. The rsa1024-sha1 key exchange has
approximately 80 bits of security strength and is not
desirable.[¶](#section-1.2.3-2){.pilcrow}

[Table 5](#ifc_sec){.xref} summarizes the security strengths of these
key exchanges without including the hashing algorithm strength. Guidance
for these strengths can be found in Section 5.6.1.1 of
\[[NIST.SP.800-57pt1r5](#NIST.SP.800-57pt1r5){.xref}\].[¶](#section-1.2.3-3){.pilcrow}

[]{#name-ifc-security-strengths}

::: {#ifc_sec}
  Key Exchange Method   Estimated Security Strength
  --------------------- -----------------------------
  rsa1024-sha1          80 bits
  rsa2048-sha256        112 bits

  : [Table 5](#table-5){.selfRef}: [IFC Security
  Strengths](#name-ifc-security-strengths){.selfRef}
:::
:::
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Key Exchange Methods](#name-key-exchange-methods){.section-name .selfRef} {#name-key-exchange-methods}

This document adopts the style and conventions of
\[[RFC4253](#RFC4253){.xref}\] in specifying how the use of data key
exchange is indicated in SSH.[¶](#section-3-1){.pilcrow}

This RFC also collects key exchange method names in various existing
RFCs (\[[RFC4253](#RFC4253){.xref}\], \[[RFC4419](#RFC4419){.xref}\],
\[[RFC4432](#RFC4432){.xref}\], \[[RFC4462](#RFC4462){.xref}\],
\[[RFC5656](#RFC5656){.xref}\], \[[RFC8268](#RFC8268){.xref}\],
\[[RFC8308](#RFC8308){.xref}\], \[[RFC8731](#RFC8731){.xref}\], and
\[[RFC8732](#RFC8732){.xref}\]) and provides a suggested suitability for
implementation of [MUST]{.bcp14}, [SHOULD]{.bcp14}, [MAY]{.bcp14},
[SHOULD NOT]{.bcp14}, and [MUST NOT]{.bcp14}. Any method not explicitly
listed [MAY]{.bcp14} be implemented.[¶](#section-3-2){.pilcrow}

[Section
7.2](https://www.rfc-editor.org/rfc/rfc4253#section-7.2){.relref} of
\[[RFC4253](#RFC4253){.xref}\] defines the generation of a shared secret
K (really the output of the KDF) and an exchange key hash H. Each key
exchange method uses a specified HASH function, which must be the same
for both key exchange and Key Derivation. H is used for key exchange
integrity across the SSH session as it is computed only once. It is
noted at the end of [Section
7.2](https://www.rfc-editor.org/rfc/rfc4253#section-7.2){.relref} of
\[[RFC4253](#RFC4253){.xref}\] that:[¶](#section-3-3){.pilcrow}

> This process will lose entropy if the amount of entropy in K is larger
> than the internal state size of HASH.[¶](#section-3-4){.pilcrow}

So, care must be taken that the hashing algorithm used is well chosen
(\"reasonable\") for the key exchange algorithms being
used.[¶](#section-3-5){.pilcrow}

This document provides guidance as to what key exchange algorithms are
to be considered for new or updated SSH
implementations.[¶](#section-3-6){.pilcrow}

In general, key exchange methods that are considered \"weak\" are being
moved to either deprecated (\"[SHOULD NOT]{.bcp14}\") or disallowed
(\"[MUST NOT]{.bcp14}\"). Methods that are newer or considered to be
stronger usually require more device resources than many administrators
and/or developers need are to be allowed (\"[MAY]{.bcp14}\").
(Eventually, some of these methods could be moved by consensus to
\"[SHOULD]{.bcp14}\" to increase interoperability and security.) Methods
that are not \"weak\" and have implementation consensus are encouraged
(\"[SHOULD]{.bcp14}\"). There needs to be at least one consensus method
promoted to a status of mandatory to implement (MTI). This should help
to provide continued interoperability even with the loss of one of the
now disallowed MTI methods.[¶](#section-3-7){.pilcrow}

For this document, 112 bits of security strength is the minimum. Use of
either or both of SHA-1 and RSA 1024 bits at an approximate 80 bits of
security fall below this minimum and should be deprecated and moved to
disallowed as quickly as possible in configured deployments of SSH. It
seems plausible that this minimum may be increased over time, so authors
and administrators may wish to prepare for a switch to algorithms that
provide more security strength.[¶](#section-3-8){.pilcrow}

::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Elliptic Curve Cryptography (ECC)](#name-elliptic-curve-cryptography-){.section-name .selfRef} {#name-elliptic-curve-cryptography-}

The Elliptic Curve (EC) key exchange algorithms used with SSH include
the ECDH and EC Menezes-Qu-Vanstone
(ECMQV).[¶](#section-3.1-1){.pilcrow}

The ECC curves defined for the key exchange algorithms above include the
following: curve25519, curve448, the NIST prime curves (nistp256,
nistp384, and nistp521), as well as other curves allowed for by [Section
6](https://www.rfc-editor.org/rfc/rfc5656#section-6){.relref} of
\[[RFC5656](#RFC5656){.xref}\]. There are key exchange mechanisms based
on the Generic Security Service Application Program Interface (GSS-API)
that use these curves as well that have a \"gss-\"
prefix.[¶](#section-3.1-2){.pilcrow}

::: {#section-3.1.1 .section}
#### [3.1.1.](#section-3.1.1){.section-number .selfRef} [curve25519-sha256 and gss-curve25519-sha256-\*](#name-curve25519-sha256-and-gss-c){.section-name .selfRef} {#name-curve25519-sha256-and-gss-c}

Curve25519 is efficient on a wide range of architectures with properties
that allow higher-performance implementations compared to the patented
elliptic curve parameters purchased by NIST for the general public to
use as described in \[[RFC5656](#RFC5656){.xref}\]. The corresponding
key exchange methods use SHA2-256 (also known as SHA-256) defined in
\[[RFC6234](#RFC6234){.xref}\]. SHA2-256 is a reasonable hash for use in
both the KDF and session integrity. It is reasonable for both gss and
non-gss uses of curve25519 key exchange methods. These key exchange
methods are described in \[[RFC8731](#RFC8731){.xref}\] and
\[[RFC8732](#RFC8732){.xref}\] and are similar to the IKEv2 key
agreement described in \[[RFC8031](#RFC8031){.xref}\]. The
curve25519-sha256 key exchange method has multiple implementations and
[SHOULD]{.bcp14} be implemented. The gss-curve25519-sha256-\* key
exchange method [SHOULD]{.bcp14} also be implemented because it shares
the same performance and security characteristics as
curve25519-sha256.[¶](#section-3.1.1-1){.pilcrow}

[Table 6](#curve25519){.xref} contains a summary of the recommendations
for curve25519-based key exchanges.[¶](#section-3.1.1-2){.pilcrow}

[]{#name-curve25519-implementation-g}

::: {#curve25519}
  Key Exchange Method Name   Guidance
  -------------------------- ------------------
  curve25519-sha256          [SHOULD]{.bcp14}
  gss-curve25519-sha256-\*   [SHOULD]{.bcp14}

  : [Table 6](#table-6){.selfRef}: [Curve25519 Implementation
  Guidance](#name-curve25519-implementation-g){.selfRef}
:::
:::

::: {#section-3.1.2 .section}
#### [3.1.2.](#section-3.1.2){.section-number .selfRef} [curve448-sha512 and gss-curve448-sha512-\*](#name-curve448-sha512-and-gss-cur){.section-name .selfRef} {#name-curve448-sha512-and-gss-cur}

Curve448 provides more security strength than curve25519 at a higher
computational and bandwidth cost. The corresponding key exchange methods
use SHA2-512 (also known as SHA-512) defined in
\[[RFC6234](#RFC6234){.xref}\]. SHA2-512 is a reasonable hash for use in
both the KDF and session integrity. It is reasonable for both gss and
non-gss uses of curve448 key exchange methods. These key exchange
methods are described in \[[RFC8731](#RFC8731){.xref}\] and
\[[RFC8732](#RFC8732){.xref}\] and are similar to the IKEv2 key
agreement described in \[[RFC8031](#RFC8031){.xref}\]. The
curve448-sha512 key exchange method [MAY]{.bcp14} be implemented. The
gss-curve448-sha512-\* key exchange method [MAY]{.bcp14} also be
implemented because it shares the same performance and security
characteristics as curve448-sha512.[¶](#section-3.1.2-1){.pilcrow}

[Table 7](#curve448){.xref} contains a summary of the recommendations
for curve448-based key exchanges.[¶](#section-3.1.2-2){.pilcrow}

[]{#name-curve448-implementation-gui}

::: {#curve448}
  Key Exchange Method Name   Guidance
  -------------------------- ---------------
  curve448-sha512            [MAY]{.bcp14}
  gss-curve448-sha512-\*     [MAY]{.bcp14}

  : [Table 7](#table-7){.selfRef}: [Curve448 Implementation
  Guidance](#name-curve448-implementation-gui){.selfRef}
:::
:::

::: {#section-3.1.3 .section}
#### [3.1.3.](#section-3.1.3){.section-number .selfRef} [ecdh-\*, ecmqv-sha2, and gss-nistp\*](#name-ecdh-ecmqv-sha2-and-gss-nis){.section-name .selfRef} {#name-ecdh-ecmqv-sha2-and-gss-nis}

The ecdh-sha2-\* namespace allows for both the named NIST prime curves
(nistp256, nistp384, and nistp521) as well as other curves to be defined
for the ECDH key exchange. At the time of this writing, there are three
named curves in this namespace that [SHOULD]{.bcp14} be supported. They
appear in [Section
10.1](https://www.rfc-editor.org/rfc/rfc5656#section-10.1){.relref} of
\[[RFC5656](#RFC5656){.xref}\]. If implemented, the named curves
[SHOULD]{.bcp14} always be enabled unless specifically disabled by local
security policy. In [Section
6.1](https://www.rfc-editor.org/rfc/rfc5656#section-6.1){.relref} of
\[[RFC5656](#RFC5656){.xref}\], the method to name other ECDH curves
using OIDs is specified. These other curves [MAY]{.bcp14} be
implemented.[¶](#section-3.1.3-1){.pilcrow}

The GSS-API namespace with gss-nistp\*-sha\* mirrors the algorithms used
by ecdh-sha2-\* names. They are described in
\[[RFC8732](#RFC8732){.xref}\].[¶](#section-3.1.3-2){.pilcrow}

ECDH reduces bandwidth of key exchanges compared to FFC DH at a similar
security strength.[¶](#section-3.1.3-3){.pilcrow}

[Table 8](#ecdh_guidance){.xref} lists algorithms as
\"[SHOULD]{.bcp14}\" where implementations may be more efficient or
widely deployed. The items listed as \"[MAY]{.bcp14}\" in [Table
8](#ecdh_guidance){.xref} are potentially less
efficient.[¶](#section-3.1.3-4){.pilcrow}

[]{#name-ecdh-implementation-guidanc}

::: {#ecdh_guidance}
  Key Exchange Method Name   Guidance
  -------------------------- ------------------
  ecdh-sha2-\*               [MAY]{.bcp14}
  ecdh-sha2-nistp256         [SHOULD]{.bcp14}
  gss-nistp256-sha256-\*     [SHOULD]{.bcp14}
  ecdh-sha2-nistp384         [SHOULD]{.bcp14}
  gss-nistp384-sha384-\*     [SHOULD]{.bcp14}
  ecdh-sha2-nistp521         [SHOULD]{.bcp14}
  gss-nistp521-sha512-\*     [SHOULD]{.bcp14}
  ecmqv-sha2                 [MAY]{.bcp14}

  : [Table 8](#table-8){.selfRef}: [ECDH Implementation
  Guidance](#name-ecdh-implementation-guidanc){.selfRef}
:::

It is advisable to match the Elliptic Curve Digital Signature Algorithm
(ECDSA) and ECDH algorithm to use the same curve for both to maintain
the same security strength in the
connection.[¶](#section-3.1.3-6){.pilcrow}
:::
:::

::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Finite Field Cryptography (FFC)](#name-finite-field-cryptography-ff){.section-name .selfRef} {#name-finite-field-cryptography-ff}

::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [FFC Diffie-Hellman Using Generated MODP Groups](#name-ffc-diffie-hellman-using-ge){.section-name .selfRef} {#name-ffc-diffie-hellman-using-ge}

\[[RFC4419](#RFC4419){.xref}\] defines two key exchange methods that use
a random selection from a set of pre-generated moduli for key exchange:
the diffie-hellman-group-exchange-sha1 method and the
diffie-hellman-group-exchange-sha256 method. Per
\[[RFC8270](#RFC8270){.xref}\], implementations [SHOULD]{.bcp14} use a
MODP group whose modulus size is equal to or greater than 2048 bits.
MODP groups with a modulus size less than 2048 bits are weak and [MUST
NOT]{.bcp14} be used.[¶](#section-3.2.1-1){.pilcrow}

The diffie-hellman-group-exchange-sha1 key exchange method [SHOULD
NOT]{.bcp14} be used. This method uses SHA-1, which is being
deprecated.[¶](#section-3.2.1-2){.pilcrow}

The diffie-hellman-group-exchange-sha256 key exchange method
[MAY]{.bcp14} be used. This method uses SHA2-256, which is reasonable
for MODP groups less than 4096 bits.[¶](#section-3.2.1-3){.pilcrow}

Care should be taken in the pre-generation of the moduli P and generator
G such that the generator provides a Q-ordered subgroup of P. Otherwise,
the parameter set may leak one bit of the shared
secret.[¶](#section-3.2.1-4){.pilcrow}

[Table 9](#ffc_modp){.xref} provides a summary of the guidance for these
exchanges.[¶](#section-3.2.1-5){.pilcrow}

[]{#name-ffc-generated-modp-group-im}

::: {#ffc_modp}
  Key Exchange Method Name               Guidance
  -------------------------------------- ----------------------
  diffie-hellman-group-exchange-sha1     [SHOULD NOT]{.bcp14}
  diffie-hellman-group-exchange-sha256   [MAY]{.bcp14}

  : [Table 9](#table-9){.selfRef}: [FFC Generated MODP Group
  Implementation Guidance](#name-ffc-generated-modp-group-im){.selfRef}
:::
:::

::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [FFC Diffie-Hellman Using Named MODP Groups](#name-ffc-diffie-hellman-using-na){.section-name .selfRef} {#name-ffc-diffie-hellman-using-na}

The diffie-hellman-group14-sha256 key exchange method is defined in
\[[RFC8268](#RFC8268){.xref}\] and represents a key exchange that has
approximately 112 bits of security strength that matches 3des-cbc
symmetric cipher security strength. It is a reasonably simple transition
from SHA-1 to SHA-2, and given that diffie-hellman-group14-sha1 and
diffie-hellman-group14-sha256 share a MODP group and only differ in the
hash function used for the KDF and integrity, it is a correspondingly
simple transition from implementing diffie-hellman-group14-sha1 to
implementing diffie-hellman-group14-sha256. Given that
diffie-hellman-group14-sha1 is being removed from mandatory to implement
(MTI) status, the diffie-hellman-group14-sha256 method [MUST]{.bcp14} be
implemented. The rest of the FFC MODP group from
\[[RFC8268](#RFC8268){.xref}\] have a larger number of security bits and
are suitable for symmetric ciphers that also have a similar number of
security bits.[¶](#section-3.2.2-1){.pilcrow}

[Table 10](#ffc_named_group){.xref} provides explicit guidance by
name.[¶](#section-3.2.2-2){.pilcrow}

[]{#name-ffc-named-group-implementat}

::: {#ffc_named_group}
  Key Exchange Method Name        Guidance
  ------------------------------- ------------------
  diffie-hellman-group14-sha256   [MUST]{.bcp14}
  gss-group14-sha256-\*           [SHOULD]{.bcp14}
  diffie-hellman-group15-sha512   [MAY]{.bcp14}
  gss-group15-sha512-\*           [MAY]{.bcp14}
  diffie-hellman-group16-sha512   [SHOULD]{.bcp14}
  gss-group16-sha512-\*           [MAY]{.bcp14}
  diffie-hellman-group17-sha512   [MAY]{.bcp14}
  gss-group17-sha512-\*           [MAY]{.bcp14}
  diffie-hellman-group18-sha512   [MAY]{.bcp14}
  gss-group18-sha512-\*           [MAY]{.bcp14}

  : [Table 10](#table-10){.selfRef}: [FFC Named Group Implementation
  Guidance](#name-ffc-named-group-implementat){.selfRef}
:::
:::
:::

::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Integer Factorization Cryptography (IFC)](#name-integer-factorization-crypto){.section-name .selfRef} {#name-integer-factorization-crypto}

The rsa1024-sha1 key exchange method is defined in
\[[RFC4432](#RFC4432){.xref}\] and uses an RSA 1024-bit modulus with a
SHA-1 hash. This key exchange does NOT meet security requirements. This
method [MUST NOT]{.bcp14} be implemented.[¶](#section-3.3-1){.pilcrow}

The rsa2048-sha256 key exchange method is defined in
\[[RFC4432](#RFC4432){.xref}\] and uses an RSA 2048-bit modulus with a
SHA2-256 hash. This key exchange meets 112-bit minimum security
strength. This method [MAY]{.bcp14} be
implemented.[¶](#section-3.3-2){.pilcrow}

[Table 11](#ifc_guidance){.xref} provides a summary of the guidance for
IFC key exchanges.[¶](#section-3.3-3){.pilcrow}

[]{#name-ifc-implementation-guidance}

::: {#ifc_guidance}
  Key Exchange Method Name   Guidance
  -------------------------- --------------------
  rsa1024-sha1               [MUST NOT]{.bcp14}
  rsa2048-sha256             [MAY]{.bcp14}

  : [Table 11](#table-11){.selfRef}: [IFC Implementation
  Guidance](#name-ifc-implementation-guidance){.selfRef}
:::
:::

::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [KDFs and Integrity Hashing](#name-kdfs-and-integrity-hashing){.section-name .selfRef} {#name-kdfs-and-integrity-hashing}

The SHA-1 and SHA-2 family of hashing algorithms are combined with the
FFC, ECC, and IFC algorithms to comprise a key exchange method
name.[¶](#section-3.4-1){.pilcrow}

The selected hash algorithm is used both in the KDF as well as for the
integrity of the response.[¶](#section-3.4-2){.pilcrow}

All of the key exchange methods using the SHA-1 hashing algorithm should
be deprecated and phased out due to security concerns for SHA-1, as
documented in
\[[RFC6194](#RFC6194){.xref}\].[¶](#section-3.4-3){.pilcrow}

Unconditionally deprecating and/or disallowing SHA-1 everywhere will
hasten the day when it may be simply removed from implementations
completely. Leaving partially broken algorithms lying around is not a
good thing to do.[¶](#section-3.4-4){.pilcrow}

The SHA-2 family of hashes \[[RFC6234](#RFC6234){.xref}\] is more secure
than SHA-1. They have been standardized for use in SSH with many of the
currently defined key exchanges.[¶](#section-3.4-5){.pilcrow}

Please note that at the present time, there is no key exchange method
for Secure Shell that uses the SHA-3 family of secure hashing functions
or the Extendable-Output Functions
\[[NIST.FIPS.202](#NIST.FIPS.202){.xref}\].[¶](#section-3.4-6){.pilcrow}

Prior to the changes made by this document, diffie-hellman-group1-sha1
and diffie-hellman-group14-sha1 were MTI. diffie-hellman-group14-sha1 is
the stronger of the two. Group14 (a 2048-bit MODP group) is defined in
[Section 3](https://www.rfc-editor.org/rfc/rfc3526#section-3){.relref}
of \[[RFC3526](#RFC3526){.xref}\]. The SSH group1 is defined in [Section
8.1](https://www.rfc-editor.org/rfc/rfc4253#section-8.1){.relref} of
\[[RFC4253](#RFC4253){.xref}\] as using the Oakley Group 2 provided in
[Section
6.2](https://www.rfc-editor.org/rfc/rfc2409#section-6.2){.relref} of
\[[RFC2409](#RFC2409){.xref}\] (a 1024-bit MODP group). This group1 MODP
group with approximately 80 bits of security is too weak to be retained.
However, rather than jumping from the MTI status to making it
disallowed, many implementers suggested that it should transition to
deprecated first and be disallowed at a later time. The group14 MODP
group using a SHA-1 hash for the KDF is not as weak as the group1 MODP
group. There are some legacy situations where it will still provide
administrators with value, such as small hardware Internet of Things
(IOT) devices that have insufficient compute and memory resources to use
larger MODP groups before a timeout of the session occurs. There was
consensus to transition from MTI to a requirement status that provides
for continued use with the expectation that it would be deprecated or
disallowed in the future. Therefore, it is considered reasonable to
retain the diffie-hellman-group14-sha1 exchange for interoperability
with legacy implementations. The diffie-hellman-group14-sha1 key
exchange [MAY]{.bcp14} be implemented, but should be put at the end of
the list of negotiated key exchanges.[¶](#section-3.4-7){.pilcrow}

The diffie-hellman-group1-sha1 and diffie-hellman-group-exchange-sha1
[SHOULD NOT]{.bcp14} be implemented. The gss-group1-sha1-\*,
gss-group14-sha1-\*, and gss-gex-sha1-\* key exchanges are already
specified as [SHOULD NOT]{.bcp14} be implemented by
\[[RFC8732](#RFC8732){.xref}\].[¶](#section-3.4-8){.pilcrow}
:::

::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Secure Shell Extension Negotiation](#name-secure-shell-extension-nego){.section-name .selfRef} {#name-secure-shell-extension-nego}

There are two methods, ext-info-c and ext-info-s, defined in
\[[RFC8308](#RFC8308){.xref}\]. They provide a mechanism to support
other Secure Shell negotiations. Being able to extend functionality is
desirable. Both ext-info-c and ext-info-s [SHOULD]{.bcp14} be
implemented.[¶](#section-3.5-1){.pilcrow}
:::
:::

::: {#key_ex_method}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Summary Guidance for Implementation of Key Exchange Method Names](#name-summary-guidance-for-implem){.section-name .selfRef} {#name-summary-guidance-for-implem}

[Table 12](#iana_key_exchange){.xref} provides the existing key exchange
method names listed alphabetically. The Implement column contains the
current recommendations of this RFC.[¶](#section-4-1){.pilcrow}

[]{#name-iana-guidance-for-implement}

::: {#iana_key_exchange}
  Key Exchange Method Name               Reference                                                        Previous Recommendation   RFC 9142 Implement
  -------------------------------------- ---------------------------------------------------------------- ------------------------- ----------------------
  curve25519-sha256                      \[[RFC8731](#RFC8731){.xref}\]                                   none                      [SHOULD]{.bcp14}
  curve448-sha512                        \[[RFC8731](#RFC8731){.xref}\]                                   none                      [MAY]{.bcp14}
  diffie-hellman-group-exchange-sha1     \[[RFC4419](#RFC4419){.xref}\], \[[RFC8270](#RFC8270){.xref}\]   none                      [SHOULD NOT]{.bcp14}
  diffie-hellman-group-exchange-sha256   \[[RFC4419](#RFC4419){.xref}\], \[[RFC8270](#RFC8270){.xref}\]   none                      [MAY]{.bcp14}
  diffie-hellman-group1-sha1             \[[RFC4253](#RFC4253){.xref}\]                                   [MUST]{.bcp14}            [SHOULD NOT]{.bcp14}
  diffie-hellman-group14-sha1            \[[RFC4253](#RFC4253){.xref}\]                                   [MUST]{.bcp14}            [MAY]{.bcp14}
  diffie-hellman-group14-sha256          \[[RFC8268](#RFC8268){.xref}\]                                   none                      [MUST]{.bcp14}
  diffie-hellman-group15-sha512          \[[RFC8268](#RFC8268){.xref}\]                                   none                      [MAY]{.bcp14}
  diffie-hellman-group16-sha512          \[[RFC8268](#RFC8268){.xref}\]                                   none                      [SHOULD]{.bcp14}
  diffie-hellman-group17-sha512          \[[RFC8268](#RFC8268){.xref}\]                                   none                      [MAY]{.bcp14}
  diffie-hellman-group18-sha512          \[[RFC8268](#RFC8268){.xref}\]                                   none                      [MAY]{.bcp14}
  ecdh-sha2-\*                           \[[RFC5656](#RFC5656){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}
  ecdh-sha2-nistp256                     \[[RFC5656](#RFC5656){.xref}\]                                   [MUST]{.bcp14}            [SHOULD]{.bcp14}
  ecdh-sha2-nistp384                     \[[RFC5656](#RFC5656){.xref}\]                                   [MUST]{.bcp14}            [SHOULD]{.bcp14}
  ecdh-sha2-nistp521                     \[[RFC5656](#RFC5656){.xref}\]                                   [MUST]{.bcp14}            [SHOULD]{.bcp14}
  ecmqv-sha2                             \[[RFC5656](#RFC5656){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}
  ext-info-c                             \[[RFC8308](#RFC8308){.xref}\]                                   [SHOULD]{.bcp14}          [SHOULD]{.bcp14}
  ext-info-s                             \[[RFC8308](#RFC8308){.xref}\]                                   [SHOULD]{.bcp14}          [SHOULD]{.bcp14}
  gss-                                   \[[RFC4462](#RFC4462){.xref}\]                                   reserved                  reserved
  gss-curve25519-sha256-\*               \[[RFC8732](#RFC8732){.xref}\]                                   [SHOULD]{.bcp14}          [SHOULD]{.bcp14}
  gss-curve448-sha512-\*                 \[[RFC8732](#RFC8732){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}
  gss-gex-sha1-\*                        \[[RFC4462](#RFC4462){.xref}\], \[[RFC8732](#RFC8732){.xref}\]   [SHOULD NOT]{.bcp14}      [SHOULD NOT]{.bcp14}
  gss-group1-sha1-\*                     \[[RFC4462](#RFC4462){.xref}\], \[[RFC8732](#RFC8732){.xref}\]   [SHOULD NOT]{.bcp14}      [SHOULD NOT]{.bcp14}
  gss-group14-sha1-\*                    \[[RFC4462](#RFC4462){.xref}\], \[[RFC8732](#RFC8732){.xref}\]   [SHOULD NOT]{.bcp14}      [SHOULD NOT]{.bcp14}
  gss-group14-sha256-\*                  \[[RFC8732](#RFC8732){.xref}\]                                   [SHOULD]{.bcp14}          [SHOULD]{.bcp14}
  gss-group15-sha512-\*                  \[[RFC8732](#RFC8732){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}
  gss-group16-sha512-\*                  \[[RFC8732](#RFC8732){.xref}\]                                   [SHOULD]{.bcp14}          [MAY]{.bcp14}
  gss-group17-sha512-\*                  \[[RFC8732](#RFC8732){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}
  gss-group18-sha512-\*                  \[[RFC8732](#RFC8732){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}
  gss-nistp256-sha256-\*                 \[[RFC8732](#RFC8732){.xref}\]                                   [SHOULD]{.bcp14}          [SHOULD]{.bcp14}
  gss-nistp384-sha384-\*                 \[[RFC8732](#RFC8732){.xref}\]                                   [MAY]{.bcp14}             [SHOULD]{.bcp14}
  gss-nistp521-sha512-\*                 \[[RFC8732](#RFC8732){.xref}\]                                   [MAY]{.bcp14}             [SHOULD]{.bcp14}
  rsa1024-sha1                           \[[RFC4432](#RFC4432){.xref}\]                                   [MAY]{.bcp14}             [MUST NOT]{.bcp14}
  rsa2048-sha256                         \[[RFC4432](#RFC4432){.xref}\]                                   [MAY]{.bcp14}             [MAY]{.bcp14}

  : [Table 12](#table-12){.selfRef}: [IANA Guidance for Implementation
  of Key Exchange Method
  Names](#name-iana-guidance-for-implement){.selfRef}
:::

The full set of official \[[IANA-SSH](#IANA-SSH){.xref}\] \"Key Exchange
Method Names\" not otherwise mentioned in this document [MAY]{.bcp14} be
implemented.[¶](#section-4-3){.pilcrow}
:::
:::

::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This SSH protocol provides a secure encrypted channel over an insecure
network. It performs server host authentication, key exchange,
encryption, and integrity checks. It also derives a unique session ID
that may be used by higher-level protocols. The key exchange itself
generates a shared secret and uses the hash function for both the KDF
and integrity.[¶](#section-5-1){.pilcrow}

Full security considerations for this protocol are provided in
\[[RFC4251](#RFC4251){.xref}\] and continue to apply. In addition, the
security considerations provided in \[[RFC4432](#RFC4432){.xref}\]
apply. Note that Forward Secrecy is NOT available with the rsa1024-sha1
or rsa2048-sha256 key exchanges.[¶](#section-5-2){.pilcrow}

It is desirable to deprecate or disallow key exchange methods that are
considered weak so they are not still actively in operation when they
are broken.[¶](#section-5-3){.pilcrow}

A key exchange method is considered weak when the security strength is
insufficient to match the symmetric cipher or the algorithm has been
broken.[¶](#section-5-4){.pilcrow}

The 1024-bit MODP group used by diffie-hellman-group1-sha1 is too small
for the symmetric ciphers used in SSH.[¶](#section-5-5){.pilcrow}

MODP groups with a modulus size less than 2048 bits are too small for
the symmetric ciphers used in SSH. If the
diffie-hellman-group-exchange-sha256 or
diffie-hellman-group-exchange-sha1 key exchange method is used, the
modulus size of the MODP group used needs to be at least 2048
bits.[¶](#section-5-6){.pilcrow}

At this time, the rsa1024-sha1 key exchange is too small for the
symmetric ciphers used in SSH.[¶](#section-5-7){.pilcrow}

The use of SHA-1 for use with any key exchange may not yet be completely
broken, but it is time to retire all uses of this algorithm as soon as
possible.[¶](#section-5-8){.pilcrow}

The diffie-hellman-group14-sha1 algorithm is not yet completely
deprecated. This is to provide a practical transition from the MTI
algorithms to a new one. However, it would be best to only be used as a
last resort in key exchange negotiations. All key exchange methods using
the SHA-1 hash are to be considered as
deprecated.[¶](#section-5-9){.pilcrow}
:::

::: {#iana-considerations}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

IANA has added a new column to the \"Key Exchange Method Names\"
registry \[[IANA-SSH](#IANA-SSH){.xref}\] with the heading \"OK to
Implement\" and annotated entries therein with the implementation
guidance provided in [Section 4](#key_ex_method){.xref}, \"Summary
Guidance for Implementation of Key Exchange Method Names\", in this
document. IANA also added entries for ecdh-sha2-nistp256,
ecdh-sha2-nistp384, and ecdh-sha2-nistp521, and added references to
\[[RFC4462](#RFC4462){.xref}\] and \[[RFC8732](#RFC8732){.xref}\] for
gss-gex-sha1-\*, gss-group1-sha1-\*, gss-group14-sha1-\*,
diffie-hellman-group-exchange-sha1, and
diffie-hellman-group-exchange-sha256. A summary may be found in [Table
12](#iana_key_exchange){.xref} in [Section 4](#key_ex_method){.xref}.
IANA has also included this document as an additional registry reference
for the suggested implementation guidance provided in [Section
4](#key_ex_method){.xref} of this document and added a note indicating
the following:[¶](#section-6-1){.pilcrow}

> OK to Implement guidance entries for registrations that pre-date
> \[RFC9142\] are found in Table 12 in Section 4 of
> \[RFC9142\].[¶](#section-6-2){.pilcrow}

Registry entries annotated with \"[MUST NOT]{.bcp14}\" are considered
disallowed. Registry entries annotated with \"[SHOULD NOT]{.bcp14}\" are
deprecated and may be disallowed in the
future.[¶](#section-6-3){.pilcrow}
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4250\]
:   [Lehtinen, S.]{.refAuthor} and [C. Lonvick, Ed.]{.refAuthor}, [\"The
    Secure Shell (SSH) Protocol Assigned Numbers\"]{.refTitle}, [RFC
    4250]{.seriesInfo}, [DOI 10.17487/RFC4250]{.seriesInfo}, January
    2006, \<<https://www.rfc-editor.org/info/rfc4250>\>.
:   

\[RFC4253\]
:   [Ylonen, T.]{.refAuthor} and [C. Lonvick, Ed.]{.refAuthor}, [\"The
    Secure Shell (SSH) Transport Layer Protocol\"]{.refTitle}, [RFC
    4253]{.seriesInfo}, [DOI 10.17487/RFC4253]{.seriesInfo}, January
    2006, \<<https://www.rfc-editor.org/info/rfc4253>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8268\]
:   [Baushke, M.]{.refAuthor}, [\"More Modular Exponentiation (MODP)
    Diffie-Hellman (DH) Key Exchange (KEX) Groups for Secure Shell
    (SSH)\"]{.refTitle}, [RFC 8268]{.seriesInfo}, [DOI
    10.17487/RFC8268]{.seriesInfo}, December 2017,
    \<<https://www.rfc-editor.org/info/rfc8268>\>.
:   

\[RFC8270\]
:   [Velvindron, L.]{.refAuthor} and [M. Baushke]{.refAuthor},
    [\"Increase the Secure Shell Minimum Recommended Diffie-Hellman
    Modulus Size to 2048 Bits\"]{.refTitle}, [RFC 8270]{.seriesInfo},
    [DOI 10.17487/RFC8270]{.seriesInfo}, December 2017,
    \<<https://www.rfc-editor.org/info/rfc8270>\>.
:   

\[RFC8308\]
:   [Bider, D.]{.refAuthor}, [\"Extension Negotiation in the Secure
    Shell (SSH) Protocol\"]{.refTitle}, [RFC 8308]{.seriesInfo}, [DOI
    10.17487/RFC8308]{.seriesInfo}, March 2018,
    \<<https://www.rfc-editor.org/info/rfc8308>\>.
:   

\[RFC8731\]
:   [Adamantiadis, A.]{.refAuthor}, [Josefsson, S.]{.refAuthor}, and [M.
    Baushke]{.refAuthor}, [\"Secure Shell (SSH) Key Exchange Method
    Using Curve25519 and Curve448\"]{.refTitle}, [RFC
    8731]{.seriesInfo}, [DOI 10.17487/RFC8731]{.seriesInfo}, February
    2020, \<<https://www.rfc-editor.org/info/rfc8731>\>.
:   
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[IANA-SSH\]
:   [IANA]{.refAuthor}, [\"Secure Shell (SSH) Protocol
    Parameters\"]{.refTitle},
    \<<https://www.iana.org/assignments/ssh-parameters/>\>.
:   

\[NIST.FIPS.202\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"SHA-3 Standard: Permutation-Based Hash and Extendable-Output
    Functions\"]{.refTitle}, [FIPS PUB 202]{.refContent}, [DOI
    10.6028/NIST.FIPS.202]{.seriesInfo}, August 2015,
    \<<https://doi.org/10.6028/NIST.FIPS.202>\>.
:   

\[NIST.SP.800-107r1\]
:   [Dang, Q.]{.refAuthor}, [\"Recommendation for applications using
    approved hash algorithms\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-107r1]{.seriesInfo}, August 2012,
    \<<https://doi.org/10.6028/NIST.SP.800-107r1>\>.
:   

\[NIST.SP.800-57pt1r5\]
:   [Barker, E.]{.refAuthor}, [\"Recommendation for Key Management: Part
    1 - General\"]{.refTitle}, [DOI
    10.6028/NIST.SP.800-57pt1r5]{.seriesInfo}, May 2020,
    \<<https://doi.org/10.6028/NIST.SP.800-57pt1r5>\>.
:   

\[RFC2409\]
:   [Harkins, D.]{.refAuthor} and [D. Carrel]{.refAuthor}, [\"The
    Internet Key Exchange (IKE)\"]{.refTitle}, [RFC 2409]{.seriesInfo},
    [DOI 10.17487/RFC2409]{.seriesInfo}, November 1998,
    \<<https://www.rfc-editor.org/info/rfc2409>\>.
:   

\[RFC3526\]
:   [Kivinen, T.]{.refAuthor} and [M. Kojo]{.refAuthor}, [\"More Modular
    Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange
    (IKE)\"]{.refTitle}, [RFC 3526]{.seriesInfo}, [DOI
    10.17487/RFC3526]{.seriesInfo}, May 2003,
    \<<https://www.rfc-editor.org/info/rfc3526>\>.
:   

\[RFC4086\]
:   [Eastlake 3rd, D.]{.refAuthor}, [Schiller, J.]{.refAuthor}, and [S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.
:   

\[RFC4251\]
:   [Ylonen, T.]{.refAuthor} and [C. Lonvick, Ed.]{.refAuthor}, [\"The
    Secure Shell (SSH) Protocol Architecture\"]{.refTitle}, [RFC
    4251]{.seriesInfo}, [DOI 10.17487/RFC4251]{.seriesInfo}, January
    2006, \<<https://www.rfc-editor.org/info/rfc4251>\>.
:   

\[RFC4419\]
:   [Friedl, M.]{.refAuthor}, [Provos, N.]{.refAuthor}, and [W.
    Simpson]{.refAuthor}, [\"Diffie-Hellman Group Exchange for the
    Secure Shell (SSH) Transport Layer Protocol\"]{.refTitle}, [RFC
    4419]{.seriesInfo}, [DOI 10.17487/RFC4419]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4419>\>.
:   

\[RFC4432\]
:   [Harris, B.]{.refAuthor}, [\"RSA Key Exchange for the Secure Shell
    (SSH) Transport Layer Protocol\"]{.refTitle}, [RFC
    4432]{.seriesInfo}, [DOI 10.17487/RFC4432]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4432>\>.
:   

\[RFC4462\]
:   [Hutzelman, J.]{.refAuthor}, [Salowey, J.]{.refAuthor},
    [Galbraith, J.]{.refAuthor}, and [V. Welch]{.refAuthor}, [\"Generic
    Security Service Application Program Interface (GSS-API)
    Authentication and Key Exchange for the Secure Shell (SSH)
    Protocol\"]{.refTitle}, [RFC 4462]{.seriesInfo}, [DOI
    10.17487/RFC4462]{.seriesInfo}, May 2006,
    \<<https://www.rfc-editor.org/info/rfc4462>\>.
:   

\[RFC5656\]
:   [Stebila, D.]{.refAuthor} and [J. Green]{.refAuthor}, [\"Elliptic
    Curve Algorithm Integration in the Secure Shell Transport
    Layer\"]{.refTitle}, [RFC 5656]{.seriesInfo}, [DOI
    10.17487/RFC5656]{.seriesInfo}, December 2009,
    \<<https://www.rfc-editor.org/info/rfc5656>\>.
:   

\[RFC6194\]
:   [Polk, T.]{.refAuthor}, [Chen, L.]{.refAuthor},
    [Turner, S.]{.refAuthor}, and [P. Hoffman]{.refAuthor}, [\"Security
    Considerations for the SHA-0 and SHA-1 Message-Digest
    Algorithms\"]{.refTitle}, [RFC 6194]{.seriesInfo}, [DOI
    10.17487/RFC6194]{.seriesInfo}, March 2011,
    \<<https://www.rfc-editor.org/info/rfc6194>\>.
:   

\[RFC6234\]
:   [Eastlake 3rd, D.]{.refAuthor} and [T. Hansen]{.refAuthor}, [\"US
    Secure Hash Algorithms (SHA and SHA-based HMAC and
    HKDF)\"]{.refTitle}, [RFC 6234]{.seriesInfo}, [DOI
    10.17487/RFC6234]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6234>\>.
:   

\[RFC7748\]
:   [Langley, A.]{.refAuthor}, [Hamburg, M.]{.refAuthor}, and [S.
    Turner]{.refAuthor}, [\"Elliptic Curves for Security\"]{.refTitle},
    [RFC 7748]{.seriesInfo}, [DOI 10.17487/RFC7748]{.seriesInfo},
    January 2016, \<<https://www.rfc-editor.org/info/rfc7748>\>.
:   

\[RFC8031\]
:   [Nir, Y.]{.refAuthor} and [S. Josefsson]{.refAuthor}, [\"Curve25519
    and Curve448 for the Internet Key Exchange Protocol Version 2
    (IKEv2) Key Agreement\"]{.refTitle}, [RFC 8031]{.seriesInfo}, [DOI
    10.17487/RFC8031]{.seriesInfo}, December 2016,
    \<<https://www.rfc-editor.org/info/rfc8031>\>.
:   

\[RFC8732\]
:   [Sorce, S.]{.refAuthor} and [H. Kario]{.refAuthor}, [\"Generic
    Security Service Application Program Interface (GSS-API) Key
    Exchange with SHA-2\"]{.refTitle}, [RFC 8732]{.seriesInfo}, [DOI
    10.17487/RFC8732]{.seriesInfo}, February 2020,
    \<<https://www.rfc-editor.org/info/rfc8732>\>.
:   

\[TRANSCRIPTION\]
:   [Bhargavan, K.]{.refAuthor} and [G. Leurent]{.refAuthor},
    [\"Transcript Collision Attacks: Breaking Authentication in TLS,
    IKE, and SSH\"]{.refTitle}, [Network and Distributed System Security
    Symposium (NDSS)]{.refContent}, [DOI
    10.14722/ndss.2016.23418]{.seriesInfo}, February 2016,
    \<<https://doi.org/10.14722/ndss.2016.23418>\>.
:   
:::
:::

::: {#appendix-A .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to the following people for review and comments: [Denis
Bider]{.contact-name}, [Peter Gutmann]{.contact-name}, [Damien
Miller]{.contact-name}, [Niels Moeller]{.contact-name}, [Matt
Johnston]{.contact-name}, [Iwamoto Kouichi]{.contact-name}, [Simon
Josefsson]{.contact-name}, [Dave Dugal]{.contact-name}, [Daniel
Migault]{.contact-name}, [Anna Johnston]{.contact-name}, [Tero
Kivinen]{.contact-name}, and [Travis
Finkenauer]{.contact-name}.[¶](#appendix-A-1){.pilcrow}

Thanks to the following people for code to implement interoperable
exchanges using some of these groups as found in this document: [Darren
Tucker]{.contact-name} for OpenSSH and [Matt Johnston]{.contact-name}
for Dropbear. And thanks to [Iwamoto Kouichi]{.contact-name} for
information about RLogin, Tera Term (ttssh), and Poderosa
implementations also adopting new Diffie-Hellman groups based on this
document.[¶](#appendix-A-2){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Mark D. Baushke]{.fn .nameRole}
:::

::: email
Email: <mbaushke.ietf@gmail.com>
:::
:::
:::
