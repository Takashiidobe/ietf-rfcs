  RFC 8928          Address Protection ND for LLN   November 2020
  ----------------- ------------------------------- ---------------
  Thubert, et al.   Standards Track                 \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8928](https://www.rfc-editor.org/rfc/rfc8928){.eref}

Updates:
:   [8505](https://www.rfc-editor.org/rfc/rfc8505){.eref}

Category:
:   Standards Track

Published:
:   November 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    P. Thubert, [Ed.]{.editor}
    :::

    ::: org
    Cisco
    :::
    :::

    ::: author
    ::: author-name
    B. Sarikaya
    :::
    :::

    ::: author
    ::: author-name
    M. Sethi
    :::

    ::: org
    Ericsson
    :::
    :::

    ::: author
    ::: author-name
    R. Struik
    :::

    ::: org
    Struik Security Consultancy
    :::
    :::
:::

# RFC 8928 {#rfcnum}

# Address-Protected Neighbor Discovery for Low-Power and Lossy Networks {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document updates the IPv6 over Low-Power Wireless Personal Area
Network (6LoWPAN) Neighbor Discovery (ND) protocol defined in RFCs 6775
and 8505. The new extension is called Address-Protected Neighbor
Discovery (AP-ND), and it protects the owner of an address against
address theft and impersonation attacks in a Low-Power and Lossy Network
(LLN). Nodes supporting this extension compute a cryptographic
identifier (Crypto-ID), and use it with one or more of their Registered
Addresses. The Crypto-ID identifies the owner of the Registered Address
and can be used to provide proof of ownership of the Registered
Addresses. Once an address is registered with the Crypto-ID and a proof
of ownership is provided, only the owner of that address can modify the
registration information, thereby enforcing Source Address
Validation.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8928>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}[¶](#section-toc.1-1.2.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Background](#name-background){.xref}[¶](#section-toc.1-1.2.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.2.2.3}
        [2.3](#section-2.3){.xref}.  [Abbreviations](#name-abbreviations){.xref}[¶](#section-toc.1-1.2.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Updating RFC
    8505](#name-updating-rfc-8505){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [New Fields and
    Options](#name-new-fields-and-options){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [New
        Crypto-ID](#name-new-crypto-id){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Updated
        EARO](#name-updated-earo){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Crypto-ID Parameters
        Option](#name-crypto-id-parameters-option){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [NDP Signature
        Option](#name-ndp-signature-option){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [Extensions to the Capability
        Indication
        Option](#name-extensions-to-the-capabilit){.xref}[¶](#section-toc.1-1.4.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Protocol
    Scope](#name-protocol-scope){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Protocol
    Flows](#name-protocol-flows){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [First Exchange with a
        6LR](#name-first-exchange-with-a-6lr){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [NDPSO Generation and
        Verification](#name-ndpso-generation-and-verifi){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Multi-Hop
        Operation](#name-multi-hop-operation){.xref}[¶](#section-toc.1-1.6.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Brown
        Field](#name-brown-field){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Threats Identified in RFC
        3971](#name-threats-identified-in-rfc-3){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [Related to 6LoWPAN
        ND](#name-related-to-6lowpan-nd){.xref}[¶](#section-toc.1-1.7.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.4}
        [7.4](#section-7.4){.xref}.  [Compromised
        6LR](#name-compromised-6lr){.xref}[¶](#section-toc.1-1.7.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.5}
        [7.5](#section-7.5){.xref}.  [ROVR
        Collisions](#name-rovr-collisions){.xref}[¶](#section-toc.1-1.7.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.6}
        [7.6](#section-7.6){.xref}.  [Implementation
        Attacks](#name-implementation-attacks){.xref}[¶](#section-toc.1-1.7.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.7}
        [7.7](#section-7.7){.xref}.  [Cross-Algorithm and Cross-Protocol
        Attacks](#name-cross-algorithm-and-cross-p){.xref}[¶](#section-toc.1-1.7.2.7.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.8}
        [7.8](#section-7.8){.xref}.  [Public Key
        Validation](#name-public-key-validation){.xref}[¶](#section-toc.1-1.7.2.8.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.9}
        [7.9](#section-7.9){.xref}.  [Correlating
        Registrations](#name-correlating-registrations){.xref}[¶](#section-toc.1-1.7.2.9.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [CGA Message
        Type](#name-cga-message-type){.xref}[¶](#section-toc.1-1.8.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Crypto-Type
        Subregistry](#name-crypto-type-subregistry){.xref}[¶](#section-toc.1-1.8.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [IPv6 ND Option
        Types](#name-ipv6-nd-option-types){.xref}[¶](#section-toc.1-1.8.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.4}
        [8.4](#section-8.4){.xref}.  [New 6LoWPAN Capability
        Bit](#name-new-6lowpan-capability-bit){.xref}[¶](#section-toc.1-1.8.2.4.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [Appendix A](#section-appendix.a){.xref}.  [Requirements Addressed
    in This
    Document](#name-requirements-addressed-in-t){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix B](#section-appendix.b){.xref}.  [Representation
    Conventions](#name-representation-conventions){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [B.1](#section-b.1){.xref}.  [Signature
        Schemes](#name-signature-schemes){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [B.2](#section-b.2){.xref}.  [Representation of ECDSA
        Signatures](#name-representation-of-ecdsa-sig){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.3}
        [B.3](#section-b.3){.xref}.  [Representation of Public Keys Used
        with
        ECDSA](#name-representation-of-public-ke){.xref}[¶](#section-toc.1-1.11.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.4}
        [B.4](#section-b.4){.xref}.  [Alternative Representations of
        Curve25519](#name-alternative-representations){.xref}[¶](#section-toc.1-1.11.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.5}
        [](#section-b.5){.xref}[Acknowledgments](#name-acknowledgments){.xref}[¶](#section-toc.1-1.11.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.c){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

Neighbor Discovery optimizations for 6LoWPAN networks (aka 6LoWPAN ND)
\[[RFC6775](#RFC6775){.xref}\] adapts the original IPv6 Neighbor
Discovery protocols defined in \[[RFC4861](#RFC4861){.xref}\] and
\[[RFC4862](#RFC4862){.xref}\] for constrained Low-Power and Lossy
Networks (LLNs). In particular, 6LoWPAN ND introduces a unicast host
Address Registration mechanism that reduces the use of multicast
compared to the Duplicate Address Detection (DAD) mechanism defined in
IPv6 ND. 6LoWPAN ND defines a new Address Registration Option (ARO) that
is carried in the unicast Neighbor Solicitation (NS) and Neighbor
Advertisement (NA) messages exchanged between a 6LoWPAN Node (6LN) and a
6LoWPAN Router (6LR). It also defines the Duplicate Address Request
(DAR) and Duplicate Address Confirmation (DAC) messages between the 6LR
and the 6LoWPAN Border Router (6LBR). In LLNs, the 6LBR is the central
repository of all the Registered Addresses in its
domain.[¶](#section-1-1){.pilcrow}

The registration mechanism in \"Neighbor Discovery Optimization for IPv6
over Low-Power Wireless Personal Area Networks (6LoWPANs)\"
\[[RFC6775](#RFC6775){.xref}\] prevents the use of an address if that
address is already registered in the subnet (first come, first served).
In order to validate address ownership, \"Registration Extensions for
IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor
Discovery\" \[[RFC8505](#RFC8505){.xref}\] defines a Registration
Ownership Verifier (ROVR) field. \[[RFC8505](#RFC8505){.xref}\] enables
a 6LR and 6LBR to validate the association between the Registered
Address of a node and its ROVR. The ROVR can be derived from the
link-layer address of the device (using the 64-bit Extended Unique
Identifier (EUI-64) address format specified by IEEE). However, the
EUI-64 can be spoofed; therefore, any node connected to the subnet and
aware of a registered-address-to-ROVR mapping could effectively fake the
ROVR. This would allow an attacker to steal the address and redirect
traffic for that address. \[[RFC8505](#RFC8505){.xref}\] defines an
Extended Address Registration Option (EARO) that transports alternate
forms of ROVRs and is a prerequisite for this
specification.[¶](#section-1-2){.pilcrow}

In this specification, a 6LN generates a cryptographic identifier
(Crypto-ID) and places it in the ROVR field during the registration of
one (or more) of its addresses with the 6LR(s). Proof of ownership of
the Crypto-ID is passed with the first registration exchange to a new
6LR and enforced at the 6LR. The 6LR validates ownership of the
Crypto-ID before it creates any new registration state or changes
existing information.[¶](#section-1-3){.pilcrow}

The protected address registration protocol proposed in this document
provides the same conceptual benefit as Source Address Validation
Improvement (SAVI) \[[RFC7039](#RFC7039){.xref}\] in that only the owner
of an IPv6 address may source packets with that address. As opposed to
\[[RFC7039](#RFC7039){.xref}\], which relies on snooping protocols, the
protection provided by this document is based on a state that is
installed and maintained in the network by the owner of the address.
With this specification, a 6LN may use a 6LR for forwarding an IPv6
packet if and only if it has registered the address used as the source
of the packet with that 6LR.[¶](#section-1-4){.pilcrow}

With the 6LoWPAN adaptation layer in \[[RFC4944](#RFC4944){.xref}\] and
\[[RFC6282](#RFC6282){.xref}\], a 6LN can obtain better compression for
an IPv6 address with an Interface ID (IID) that is derived from a Layer
2 (L2) address. Such compression is incompatible with \"SEcure Neighbor
Discovery (SEND\") \[[RFC3971](#RFC3971){.xref}\] and
\"Cryptographically Generated Addresses (CGAs)\"
\[[RFC3972](#RFC3972){.xref}\], since they derive the IID from
cryptographic keys. This specification, on the other hand, separates the
IID generation from cryptographic computations and can enable better
compression.[¶](#section-1-5){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

::: {#bcp}
::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.1-1){.pilcrow}
:::
:::

::: {#lo}
::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Background](#name-background){.section-name .selfRef} {#name-background}

The reader may get additional context for this specification from the
following references:[¶](#section-2.2-1){.pilcrow}

-   [\"SEcure Neighbor Discovery (SEND)\"
    \[[RFC3971](#RFC3971){.xref}\],[¶](#section-2.2-2.1){.pilcrow}]{#section-2.2-2.1}
-   [\"Cryptographically Generated Addresses (CGA)\"
    \[[RFC3972](#RFC3972){.xref}\],[¶](#section-2.2-2.2){.pilcrow}]{#section-2.2-2.2}
-   [\"Neighbor Discovery for IP version 6 (IPv6)\"
    \[[RFC4861](#RFC4861){.xref}\]
    ,[¶](#section-2.2-2.3){.pilcrow}]{#section-2.2-2.3}
-   [\"IPv6 Stateless Address Autoconfiguration\"
    \[[RFC4862](#RFC4862){.xref}\],
    and[¶](#section-2.2-2.4){.pilcrow}]{#section-2.2-2.4}
-   [\"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs):
    Overview, Assumptions, Problem Statement, and Goals\"
    \[[RFC4919](#RFC4919){.xref}\].[¶](#section-2.2-2.5){.pilcrow}]{#section-2.2-2.5}
:::
:::

::: {#acronyms}
::: {#section-2.3 .section}
### [2.3.](#section-2.3){.section-number .selfRef} [Abbreviations](#name-abbreviations){.section-name .selfRef} {#name-abbreviations}

This document uses the following
abbreviations:[¶](#section-2.3-1){.pilcrow}

[]{.break}

6BBR:
:   6LoWPAN Backbone Router[¶](#section-2.3-2.2){.pilcrow}
:   

6LBR:
:   6LoWPAN Border Router[¶](#section-2.3-2.4){.pilcrow}
:   

6LN:
:   6LoWPAN Node[¶](#section-2.3-2.6){.pilcrow}
:   

6LR:
:   6LoWPAN Router[¶](#section-2.3-2.8){.pilcrow}
:   

AP-ND:
:   Address-Protected Neighbor Discovery[¶](#section-2.3-2.10){.pilcrow}
:   

CGA:
:   Cryptographically Generated Address[¶](#section-2.3-2.12){.pilcrow}
:   

DAD:
:   Duplicate Address Detection[¶](#section-2.3-2.14){.pilcrow}
:   

EARO:
:   Extended Address Registration Option[¶](#section-2.3-2.16){.pilcrow}
:   

ECC:
:   Elliptic Curve Cryptography[¶](#section-2.3-2.18){.pilcrow}
:   

ECDH:
:   Elliptic Curve Diffie-Hellman[¶](#section-2.3-2.20){.pilcrow}
:   

ECDSA:
:   Elliptic Curve Digital Signature
    Algorithm[¶](#section-2.3-2.22){.pilcrow}
:   

EDAC:
:   Extended Duplicate Address
    Confirmation[¶](#section-2.3-2.24){.pilcrow}
:   

EDAR:
:   Extended Duplicate Address Request[¶](#section-2.3-2.26){.pilcrow}
:   

CIPO:
:   Crypto-ID Parameters Option[¶](#section-2.3-2.28){.pilcrow}
:   

LLN:
:   Low-Power and Lossy Network[¶](#section-2.3-2.30){.pilcrow}
:   

NA:
:   Neighbor Advertisement[¶](#section-2.3-2.32){.pilcrow}
:   

ND:
:   Neighbor Discovery[¶](#section-2.3-2.34){.pilcrow}
:   

NDP:
:   Neighbor Discovery Protocol[¶](#section-2.3-2.36){.pilcrow}
:   

NDPSO:
:   Neighbor Discovery Protocol Signature
    Option[¶](#section-2.3-2.38){.pilcrow}
:   

NS:
:   Neighbor Solicitation[¶](#section-2.3-2.40){.pilcrow}
:   

ROVR:
:   Registration Ownership Verifier[¶](#section-2.3-2.42){.pilcrow}
:   

RA:
:   Router Advertisement[¶](#section-2.3-2.44){.pilcrow}
:   

RS:
:   Router Solicitation[¶](#section-2.3-2.46){.pilcrow}
:   

RSAO:
:   RSA Signature Option[¶](#section-2.3-2.48){.pilcrow}
:   

SHA:
:   Secure Hash Algorithm[¶](#section-2.3-2.50){.pilcrow}
:   

SLAAC:
:   Stateless Address Autoconfiguration[¶](#section-2.3-2.52){.pilcrow}
:   

TID:
:   Transaction ID[¶](#section-2.3-2.54){.pilcrow}
:   
:::
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Updating RFC 8505](#name-updating-rfc-8505){.section-name .selfRef} {#name-updating-rfc-8505}

[Section
5.3](https://www.rfc-editor.org/rfc/rfc8505#section-5.3){.relref} of
\[[RFC8505](#RFC8505){.xref}\] introduces the ROVR that is used to
detect and reject duplicate registrations in the DAD process. The ROVR
is a generic object that is designed for both backward compatibility and
the capability to introduce new computation methods in the future. Using
a Crypto-ID per this specification is the [RECOMMENDED]{.bcp14} method.
[Section 7.5](#sec-col){.xref} discusses collisions when heterogeneous
methods to compute the ROVR field coexist inside a
network.[¶](#section-3-1){.pilcrow}

This specification introduces a new identifier called a Crypto-ID that
is transported in the ROVR field and used to indirectly prove the
ownership of an address that is being registered by means of
\[[RFC8505](#RFC8505){.xref}\]. The Crypto-ID is derived from a
cryptographic public key and additional
parameters.[¶](#section-3-2){.pilcrow}

The overall mechanism requires the support of Elliptic Curve
Cryptography (ECC) and a hash function as detailed in [Section
6.2](#ndpso-generation){.xref}. To enable the verification of the proof,
the Registering Node needs to supply certain parameters including a
nonce and a signature that will demonstrate that the node possesses the
private key corresponding to the public key used to build the
Crypto-ID.[¶](#section-3-3){.pilcrow}

The elliptic curves and the hash functions listed in [Table
1](#cryptotypetable){.xref} in [Section 8.2](#cryptotypereg){.xref} can
be used with this specification; more may be added in the future to the
corresponding IANA registry. The cryptographic algorithms used
(including the curve and the representation conventions) are signaled by
the Crypto-Type field in a new IPv6 ND Crypto-ID Parameters Option
(CIPO) (see [Section 4.3](#cryptoidopt){.xref}) that contains the
parameters that are necessary for address validation. A new NDP
Signature Option ([Section 4.4](#ndpso){.xref}) is also specified in
this document to carry the resulting signature. A Nonce Option
\[[RFC3971](#RFC3971){.xref}\] is added in the NA(EARO) that is used to
request the validation, and all three options are needed in the NS(EARO)
that provides the validation.[¶](#section-3-4){.pilcrow}
:::

::: {#cryptoifldg}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [New Fields and Options](#name-new-fields-and-options){.section-name .selfRef} {#name-new-fields-and-options}

::: {#cryptoidalg}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [New Crypto-ID](#name-new-crypto-id){.section-name .selfRef} {#name-new-crypto-id}

The Crypto-ID is transported in the ROVR field of the EARO and the
Extended Duplicate Address Request (EDAR) message and is associated with
the Registered Address at the 6LR and the 6LBR. The ownership of a
Crypto-ID can be demonstrated by cryptographic mechanisms, and by
association, the ownership of the Registered Address can be
ascertained.[¶](#section-4.1-1){.pilcrow}

A node in possession of the necessary cryptographic primitives
[SHOULD]{.bcp14} use Crypto-ID by default as ROVR in its registrations.
Whether a ROVR is a Crypto-ID is indicated by a new \"C\" flag in the
EARO of the NS(EARO) message.[¶](#section-4.1-2){.pilcrow}

The Crypto-ID is derived from the public key and a modifier as
follows:[¶](#section-4.1-3){.pilcrow}

1.  [The hash function used internally by the signature scheme and
    indicated by the Crypto-Type (see [Table 1](#cryptotypetable){.xref}
    in [Section 8.2](#cryptotypereg){.xref}) is applied to the CIPO.
    Note that all the reserved and padding bits [MUST]{.bcp14} be set to
    zero.[¶](#section-4.1-4.1){.pilcrow}]{#section-4.1-4.1}
2.  [The leftmost bits of the resulting hash, up to the desired size,
    are used as the
    Crypto-ID.[¶](#section-4.1-4.2){.pilcrow}]{#section-4.1-4.2}

At the time of this writing, a minimal size for the Crypto-ID of 128
bits is [RECOMMENDED]{.bcp14} unless backward compatibility is needed
\[[RFC8505](#RFC8505){.xref}\] (in which case it is at least 64 bits).
The size of the Crypto-ID is likely to increase in the
future.[¶](#section-4.1-5){.pilcrow}
:::
:::

::: {#cryptoEARO}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Updated EARO](#name-updated-earo){.section-name .selfRef} {#name-updated-earo}

This specification updates the EARO to enable the use of the ROVR field
to transport the Crypto-ID. The resulting format is as
follows:[¶](#section-4.2-1){.pilcrow}

[]{#name-enhanced-address-registrati}

::: {#crypto-fig}
::: {#section-4.2-2.1 .artwork .art-text .alignLeft}
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |     Type      |     Length    |    Status     |    Opaque     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |Rsvd |C| I |R|T|     TID       |     Registration Lifetime     |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                                                               |
     ...            Registration Ownership Verifier (ROVR)           ...
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 1](#figure-1){.selfRef}: [Enhanced Address Registration
Option](#name-enhanced-address-registrati){.selfRef}
:::

[]{.break}

Type:
:   33[¶](#section-4.2-3.2){.pilcrow}
:   

Length:
:   Defined in \[[RFC8505](#RFC8505){.xref}\] and copied in the \"EARO
    Length\" field in the associated
    CIPO.[¶](#section-4.2-3.4){.pilcrow}
:   

Status:
:   Defined in
    \[[RFC8505](#RFC8505){.xref}\].[¶](#section-4.2-3.6){.pilcrow}
:   

Opaque:
:   Defined in
    \[[RFC8505](#RFC8505){.xref}\].[¶](#section-4.2-3.8){.pilcrow}
:   

Rsvd (Reserved):
:   3-bit unsigned integer. It [MUST]{.bcp14} be set to zero by the
    sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.2-3.10){.pilcrow}
:   

C:
:   This \"C\" flag is set to indicate that the ROVR field contains a
    Crypto-ID and that the 6LN [MAY]{.bcp14} be challenged for ownership
    as specified in this document.[¶](#section-4.2-3.12){.pilcrow}
:   

I, R, T:
:   Defined in
    \[[RFC8505](#RFC8505){.xref}\].[¶](#section-4.2-3.14){.pilcrow}
:   

TID and Registration Lifetime:
:   Defined in
    \[[RFC8505](#RFC8505){.xref}\].[¶](#section-4.2-3.16){.pilcrow}
:   

Registration Ownership Verifier (ROVR):
:   When the \"C\" flag is set, this field contains a
    Crypto-ID.[¶](#section-4.2-3.18){.pilcrow}
:   

This specification uses the status codes \"Validation Requested\" and
\"Validation Failed\", which are defined in
\[[RFC8505](#RFC8505){.xref}\].[¶](#section-4.2-4){.pilcrow}

This specification does not define any new status
codes.[¶](#section-4.2-5){.pilcrow}
:::
:::

::: {#cryptoidopt}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Crypto-ID Parameters Option](#name-crypto-id-parameters-option){.section-name .selfRef} {#name-crypto-id-parameters-option}

This specification defines the CIPO. The CIPO carries the parameters
used to form a Crypto-ID.[¶](#section-4.3-1){.pilcrow}

In order to provide cryptographic agility \[[BCP201](#RFC7696){.xref}\],
this specification supports different elliptic-curve-based signature
schemes, indicated by a Crypto-Type field:[¶](#section-4.3-2){.pilcrow}

-   [The ECDSA256 signature scheme, which uses ECDSA with the NIST P-256
    curve \[[FIPS186-4](#FIPS186-4){.xref}\] and the hash function
    SHA-256 \[[RFC6234](#RFC6234){.xref}\] internally, [MUST]{.bcp14} be
    supported by all
    implementations.[¶](#section-4.3-3.1){.pilcrow}]{#section-4.3-3.1}
-   [The Ed25519 signature scheme, which uses the Pure Edwards-Curve
    Digital Signature Algorithm (PureEdDSA)
    \[[RFC8032](#RFC8032){.xref}\] with the twisted Edwards curve
    Edwards25519 \[[RFC7748](#RFC7748){.xref}\] and the hash function
    SHA-512 \[[RFC6234](#RFC6234){.xref}\] internally, [MAY]{.bcp14} be
    supported as an
    alternative.[¶](#section-4.3-3.2){.pilcrow}]{#section-4.3-3.2}
-   [The ECDSA25519 signature scheme, which uses ECDSA
    \[[FIPS186-4](#FIPS186-4){.xref}\] with the Weierstrass curve
    Wei25519 (see [Appendix B.4](#curves){.xref}) and the hash function
    SHA-256 \[[RFC6234](#RFC6234){.xref}\] internally, [MAY]{.bcp14}
    also be supported.[¶](#section-4.3-3.3){.pilcrow}]{#section-4.3-3.3}

This specification uses signature schemes that target similar
cryptographic strength but rely on different curves, hash functions,
signature algorithms, and/or representation conventions. Future
specification may extend this to different cryptographic algorithms and
key sizes, e.g., to provide better security properties or a simpler
implementation.[¶](#section-4.3-4){.pilcrow}

[]{#name-crypto-id-parameters-option-2}

::: {#cgapar-fig}
::: {#section-4.3-5.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Type      |    Length     |Reserved1|  Public Key Length  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Crypto-Type  | Modifier      |  EARO Length  |               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
       |                                                               |
       .                                                               .
       .                  Public Key (variable length)                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                           Padding                             .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 2](#figure-2){.selfRef}: [Crypto-ID Parameters
Option](#name-crypto-id-parameters-option-2){.selfRef}
:::

[]{.break}

Type:
:   8-bit unsigned integer. IANA has assigned value 39; see [Table
    2](#nexndopt){.xref}.[¶](#section-4.3-6.2){.pilcrow}
:   

Length:
:   8-bit unsigned integer. The length of the option in units of 8
    octets.[¶](#section-4.3-6.4){.pilcrow}
:   

Reserved1:
:   5-bit unsigned integer. It [MUST]{.bcp14} be set to zero by the
    sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.3-6.6){.pilcrow}
:   

Public Key Length:
:   11-bit unsigned integer. The length of the Public Key field in
    bytes. The actual length depends on the Crypto-Type value and how
    the public key is represented. The valid values with this document
    are provided in [Table
    1](#cryptotypetable){.xref}.[¶](#section-4.3-6.8){.pilcrow}
:   

Crypto-Type:
:   8-bit unsigned integer. The type of cryptographic algorithm used in
    calculation of the Crypto-ID indexed by IANA in the \"Crypto-Types\"
    subregistry in the \"Internet Control Message Protocol version 6
    (ICMPv6) Parameters\" registry (see [Section
    8.2](#cryptotypereg){.xref}).[¶](#section-4.3-6.10){.pilcrow}
:   

Modifier:
:   8-bit unsigned integer. Set to an arbitrary value by the creator of
    the Crypto-ID. The role of the modifier is to enable the formation
    of multiple Crypto-IDs from the same key pair. This reduces the
    traceability and, thus, improves the privacy of a constrained node
    without requiring many key pairs.[¶](#section-4.3-6.12){.pilcrow}
:   

EARO Length:
:   8-bit unsigned integer. The option length of the EARO that contains
    the Crypto-ID associated with the
    CIPO.[¶](#section-4.3-6.14){.pilcrow}
:   

Public Key:
:   A variable-length field; the size is indicated in the Public Key
    Length field.[¶](#section-4.3-6.16){.pilcrow}
:   

Padding:
:   A variable-length field that completes the Public Key field to align
    to the next 8-byte boundary. It [MUST]{.bcp14} be set to zero by the
    sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.3-6.18){.pilcrow}
:   

The implementation of multiple hash functions in a constrained device
may consume excessive amounts of program memory. This specification
enables the use of the same hash function SHA-256
\[[RFC6234](#RFC6234){.xref}\] for two of the three supported ECC-based
signature schemes. Some code factorization is also possible for the ECC
computation itself.[¶](#section-4.3-7){.pilcrow}

\[[CURVE-REPR](#I-D.ietf-lwig-curve-representations){.xref}\] provides
information on how to represent Montgomery curves and (twisted) Edwards
curves as curves in short-Weierstrass form, and it illustrates how this
can be used to implement elliptic curve computations using existing
implementations that already provide, e.g., ECDSA and ECDH using NIST
\[[FIPS186-4](#FIPS186-4){.xref}\] prime curves. For more details on
representation conventions, refer to [Appendix
B](#reprconv){.xref}.[¶](#section-4.3-8){.pilcrow}
:::
:::

::: {#ndpso}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [NDP Signature Option](#name-ndp-signature-option){.section-name .selfRef} {#name-ndp-signature-option}

This specification defines the NDP Signature Option (NDPSO). The NDPSO
carries the signature that proves the ownership of the Crypto-ID and
validates the address being registered. The format of the NDPSO is
illustrated in [Figure
3](#ndpso-fig){.xref}.[¶](#section-4.4-1){.pilcrow}

As opposed to the RSA Signature Option (RSAO) defined in [Section
5.2](https://www.rfc-editor.org/rfc/rfc3971#section-5.2){.relref} of
SEND \[[RFC3971](#RFC3971){.xref}\], the NDPSO does not have a key hash
field. Instead, the leftmost 128 bits of the ROVR field in the EARO are
used as hash to retrieve the CIPO that contains the key material used
for signature verification, left-padded if
needed.[¶](#section-4.4-2){.pilcrow}

Another difference is that the NDPSO signs a fixed set of fields as
opposed to all options that appear prior to it in the ND message that
bears the signature. This allows a CIPO that the 6LR already received to
be omitted, at the expense of the capability to add arbitrary options
that would be signed with an RSAO.[¶](#section-4.4-3){.pilcrow}

An ND message that carries an NDPSO [MUST]{.bcp14} have one and only one
EARO. The EARO [MUST]{.bcp14} contain a Crypto-ID in the ROVR field, and
the Crypto-ID [MUST]{.bcp14} be associated with the key pair used for
the digital signature in the NDPSO.[¶](#section-4.4-4){.pilcrow}

The CIPO may be present in the same message as the NDPSO. If it is not
present, it can be found in an abstract table that was created by a
previous message and indexed by the hash.[¶](#section-4.4-5){.pilcrow}

[]{#name-ndp-signature-option-2}

::: {#ndpso-fig}
::: {#section-4.4-6.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Type      |    Length     |Reserved1|  Signature Length   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Reserved2                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                                                               .
       .          Digital Signature  (variable length)                 .
       .                                                               .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       .                           Padding                             .
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 3](#figure-3){.selfRef}: [NDP Signature
Option](#name-ndp-signature-option-2){.selfRef}
:::

[]{.break}

Type:
:   IANA has assigned value 40; see [Table
    2](#nexndopt){.xref}.[¶](#section-4.4-7.2){.pilcrow}
:   

Length:
:   8-bit unsigned integer. The length of the option in units of 8
    octets.[¶](#section-4.4-7.4){.pilcrow}
:   

Reserved1:
:   5-bit unsigned integer. It [MUST]{.bcp14} be set to zero by the
    sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.4-7.6){.pilcrow}
:   

Digital Signature Length:
:   11-bit unsigned integer. The length of the Digital Signature field
    in bytes.[¶](#section-4.4-7.8){.pilcrow}
:   

Reserved2:
:   32-bit unsigned integer. It [MUST]{.bcp14} be set to zero by the
    sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.4-7.10){.pilcrow}
:   

Digital Signature:
:   A variable-length field containing the digital signature. The length
    and computation of the digital signature both depend on the
    Crypto-Type, which is found in the associated CIPO; see [Appendix
    B](#reprconv){.xref}. For the values of the Crypto-Type defined in
    this specification, and for future values of the Crypto-Type unless
    specified otherwise, the signature is computed as detailed in
    [Section
    6.2](#ndpso-generation){.xref}.[¶](#section-4.4-7.12){.pilcrow}
:   

Padding:
:   A variable-length field completing the Digital Signature field to
    align to the next 8-byte boundary. It [MUST]{.bcp14} be set to zero
    by the sender and [MUST]{.bcp14} be ignored by the
    receiver.[¶](#section-4.4-7.14){.pilcrow}
:   
:::
:::

::: {#CIO}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [Extensions to the Capability Indication Option](#name-extensions-to-the-capabilit){.section-name .selfRef} {#name-extensions-to-the-capabilit}

This specification defines one new capability bit in the 6LoWPAN
Capability Indication Option (6CIO), as defined by
\[[RFC7400](#RFC7400){.xref}\], for use by the 6LR and 6LBR in IPv6 ND
RA messages.[¶](#section-4.5-1){.pilcrow}

[]{#name-new-capability-bit-in-the-6}

::: {#fig6CIO}
::: {#section-4.5-2.1 .artwork .art-text .alignLeft}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     Type      |   Length = 1  |   Reserved      |A|D|L|B|P|E|G|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Reserved                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 4](#figure-4){.selfRef}: [New Capability Bit in the
6CIO](#name-new-capability-bit-in-the-6){.selfRef}
:::

New Option Field:[¶](#section-4.5-3){.pilcrow}

[]{.break}

A:
:   1-bit flag. Set to indicate that AP-ND is globally activated in the
    network.[¶](#section-4.5-4.2){.pilcrow}
:   

The \"A\" flag is set by the 6LBR that serves the network and is
propagated by the 6LRs. It is typically turned on when all 6LRs are
migrated to this specification.[¶](#section-4.5-5){.pilcrow}
:::
:::
:::
:::

::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Protocol Scope](#name-protocol-scope){.section-name .selfRef} {#name-protocol-scope}

The scope of the protocol specified here is a 6LoWPAN LLN, typically a
stub network connected to a larger IP network via a border router called
a 6LBR per \[[RFC6775](#RFC6775){.xref}\]. A 6LBR has sufficient
capability to satisfy the needs of DAD.[¶](#section-5-1){.pilcrow}

The 6LBR maintains registration state for all devices in its attached
LLN. Together with the first-hop router (the 6LR), the 6LBR assures
uniqueness and grants ownership of an IPv6 address before it can be used
in the LLN. This is in contrast to a traditional network that relies on
IPv6 address autoconfiguration \[[RFC4862](#RFC4862){.xref}\], where
there is no guarantee of ownership from the network, and each IPv6
Neighbor Discovery packet must be individually secured
\[[RFC3971](#RFC3971){.xref}\].[¶](#section-5-2){.pilcrow}

[]{#name-basic-configuration}

::: {#figco}
::: {#section-5-3.1 .artwork .art-text .alignLeft}
                  ---+-------- ............
                     |      External Network
                     |
                  +-----+
                  |     | 6LBR
                  +-----+
                o    o   o
         o     o   o     o
            o   o LLN   o    o     o
               o     o
          o       o    o(6LR)
                       ^
        o      o       | LLN link
             o     o   v
                       o(6LN)
               o
:::

[Figure 5](#figure-5){.selfRef}: [Basic
Configuration](#name-basic-configuration){.selfRef}
:::

In a mesh network, the 6LR is directly connected to the host device.
This specification mandates that the peer-wise L2 security is deployed
so that all the packets from a particular host are protected. The 6LR
may be multiple hops away from the 6LBR. Packets are routed between the
6LR and the 6LBR via other 6LRs.[¶](#section-5-4){.pilcrow}

This specification mandates that all the LLN links between the 6LR and
the 6LBR are protected so that a packet that was validated by the first
6LR can be safely routed by other on-path 6LRs to the
6LBR.[¶](#section-5-5){.pilcrow}
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Protocol Flows](#name-protocol-flows){.section-name .selfRef} {#name-protocol-flows}

The 6LR/6LBR ensures first come, first served by storing the ROVR
associated to the address being registered upon the first registration
and rejecting a registration with a different ROVR value. A 6LN can
claim any address as long as it is the first to make that claim. After a
successful registration, the 6LN becomes the owner of the Registered
Address, and the address is bound to the ROVR value in the 6LR/6LBR
registry.[¶](#section-6-1){.pilcrow}

This specification protects the ownership of the address at the first
hop (the edge). Its use in a network is signaled by the \"A\" flag in
the 6CIO. The flag is set by the 6LBR and propagated unchanged by the
6LRs. Once every node in the network is upgraded to support this
specification, the \"A\" flag can be set to turn the protection on
globally.[¶](#section-6-2){.pilcrow}

The 6LN places a cryptographic identifier, the Crypto-ID, in the ROVR
that is associated with the address at the first registration, enabling
the 6LR to later challenge it to verify that it is the original
Registering Node. The challenge may happen at any time at the discretion
of the 6LR and the 6LBR. A valid registration in the 6LR or the 6LBR
[MUST NOT]{.bcp14} be altered until the challenge is
complete.[¶](#section-6-3){.pilcrow}

When the \"A\" flag in a subnet is set, the 6LR [MUST]{.bcp14} challenge
the 6LN before it creates a Binding with the \"C\" flag set in the EARO.
The 6LR [MUST]{.bcp14} also challenge the 6LN when a new registration
attempts to change a parameter of an already validated Binding for that
6LN, for instance, its Source link-layer address. Such verification
protects against an attacker that attempts to steal the address of an
honest node.[¶](#section-6-4){.pilcrow}

The 6LR [MUST]{.bcp14} indicate to the 6LBR that it performed a
successful validation by setting a status code of 5 (\"Validation
Requested\") in the EDAR. Upon a subsequent EDAR from a new 6LR with a
status code that is not 5 for a validated Binding, the 6LBR
[MUST]{.bcp14} indicate to the new 6LR that it needs to challenge the
6LN using a status code of 5 in the Extended Duplicate Address
Confirmation (EDAC).[¶](#section-6-5){.pilcrow}

The 6LR [MUST]{.bcp14} challenge the 6LN when the 6LBR signals to do so,
which is done with an EDAC message with a status code of 5. The EDAC is
echoed by the 6LR in the NA(EARO) back to the Registering Node. The 6LR
[SHOULD]{.bcp14} also challenge all its attached 6LNs at the time the
6LBR turns the \"A\" flag on in the 6CIO in orders to detect an issue
immediately.[¶](#section-6-6){.pilcrow}

If the 6LR does not support the Crypto-Type, it [MUST]{.bcp14} reply
with an EARO status code of 10 \"Validation Failed\" without a
challenge. In that case, the 6LN may try another Crypto-Type until it
falls back to Crypto-Type 0, which [MUST]{.bcp14} be supported by all
6LRs.[¶](#section-6-7){.pilcrow}

A node may use more than one IPv6 address at the same time. The
separation of the address and the cryptographic material avoids the need
for the constrained device to compute multiple keys for multiple
addresses. The 6LN [MAY]{.bcp14} use the same Crypto-ID to prove the
ownership of multiple IPv6 addresses. The 6LN [MAY]{.bcp14} also derive
multiple Crypto-IDs from the same key pair by changing the
modifier.[¶](#section-6-8){.pilcrow}

::: {#first}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [First Exchange with a 6LR](#name-first-exchange-with-a-6lr){.section-name .selfRef} {#name-first-exchange-with-a-6lr}

A 6LN registers to a 6LR that is one hop away from it with the \"C\"
flag set in the EARO, indicating that the ROVR field contains a
Crypto-ID. The Target Address in the NS message indicates the IPv6
address that the 6LN is trying to register
\[[RFC8505](#RFC8505){.xref}\]. The on-link (local) protocol
interactions are shown in [Figure 6](#Dynamic-fig){.xref}. If the 6LR
does not have a state with the 6LN that is consistent with the NS(EARO),
then it replies with a challenge NA(EARO, status=Validation Requested)
that contains a Nonce Option (shown as NonceLR in [Figure
6](#Dynamic-fig){.xref}).[¶](#section-6.1-1){.pilcrow}

[]{#name-on-link-protocol-operation}

::: {#Dynamic-fig}
::: {#section-6.1-2.1 .artwork .art-text .alignLeft}
        6LN                                                     6LR
         |                                                       |
         |<------------------------- RA -------------------------|
         |                                                       | ^
         |---------------- NS with EARO (Crypto-ID) ------------>| |
         |                                                       | option
         |<- NA with EARO(status=Validation Requested), NonceLR  | |
         |                                                       | v
         |------- NS with EARO, CIPO, NonceLN and NDPSO -------->|
         |                                                       |
         |<------------------- NA with EARO ---------------------|
         |                                                       |
                                   ...
         |                                                       |
         |--------------- NS with EARO (Crypto-ID) ------------->|
         |                                                       |
         |<------------------- NA with EARO ---------------------|
         |                                                       |
                                   ...
         |                                                       |
         |--------------- NS with EARO (Crypto-ID) ------------->|
         |                                                       |
         |<------------------- NA with EARO ---------------------|
         |                                                       |
:::

[Figure 6](#figure-6){.selfRef}: [On-Link Protocol
Operation](#name-on-link-protocol-operation){.selfRef}
:::

The Nonce Option contains a nonce value that, to the extent possible for
the implementation, was never used before. This specification inherits
the idea from \[[RFC3971](#RFC3971){.xref}\] that the nonce is a random
value. Ideally, an implementation uses an unpredictable
cryptographically random value \[[BCP106](#RFC4086){.xref}\]. But that
may be impractical in some LLN scenarios with resource-constrained
devices.[¶](#section-6.1-3){.pilcrow}

Alternatively, the device may use an always-incrementing value saved in
the same stable storage as the key, so they are lost together, and start
at a best-effort random value as either the nonce value or a component
to its computation.[¶](#section-6.1-4){.pilcrow}

The 6LN replies to the challenge with an NS(EARO) that includes the
Nonce Option (shown as NonceLN in [Figure 6](#Dynamic-fig){.xref}), the
CIPO ([Section 4.3](#cryptoidopt){.xref}), and the NDPSO containing the
signature. Both nonces are included in the signed material. This
provides a \"contributory behavior\" that results in better security
even when the nonces of one party are not generated as
specified.[¶](#section-6.1-5){.pilcrow}

The 6LR [MUST]{.bcp14} store the information associated with a Crypto-ID
on the first NS exchange where it appears in a fashion that the CIPO
parameters can be retrieved from the Crypto-ID
alone.[¶](#section-6.1-6){.pilcrow}

The steps for the registration to the 6LR are as
follows:[¶](#section-6.1-7){.pilcrow}

Upon the first exchange with a 6LR, a 6LN will be challenged to prove
ownership of the Crypto-ID and the Target Address being registered in
the Neighbor Solicitation message. When a 6LR receives an NS(EARO)
registration with a new Crypto-ID as a ROVR, and unless the registration
is rejected for another reason, it [MUST]{.bcp14} challenge by
responding with an NA(EARO) with a status code of \"Validation
Requested\".[¶](#section-6.1-8){.pilcrow}

Upon receiving a first NA(EARO) with a status code of \"Validation
Requested\" from a 6LR, the Registering Node [SHOULD]{.bcp14} retry its
registration with a CIPO ([Section 4.3](#cryptoidopt){.xref}) that
contains all the necessary material for building the Crypto-ID, the
NonceLN that it generated, and the NDP Signature Option ([Section
4.4](#ndpso){.xref}) that proves its ownership of the Crypto-ID and
intent of registering the Target Address. In subsequent revalidation
with the same 6LR, the 6LN [MAY]{.bcp14} try to omit the CIPO to save
bandwidth, with the expectation that the 6LR saved it. If the validation
fails and it gets challenged again, then it [SHOULD]{.bcp14} add the
CIPO again.[¶](#section-6.1-9){.pilcrow}

In order to validate the ownership, the 6LR performs the same steps as
the 6LN and rebuilds the Crypto-ID based on the parameters in the CIPO.
If the rebuilt Crypto-ID matches the ROVR, the 6LN also verifies the
signature contained in the NDPSO. At that point, if the signature in the
NDPSO can be verified, then the validation succeeds. Otherwise, the
validation fails.[¶](#section-6.1-10){.pilcrow}

If the 6LR fails to validate the signed NS(EARO), it responds with a
status code of \"Validation Failed\". After receiving an NA(EARO) with a
status code of \"Validation Failed\", the Registering Node
[SHOULD]{.bcp14} try an alternate Crypto-Type; even if Crypto-Type 0
fails, it may try to register a different address in the NS
message.[¶](#section-6.1-11){.pilcrow}
:::
:::

::: {#ndpso-generation}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [NDPSO Generation and Verification](#name-ndpso-generation-and-verifi){.section-name .selfRef} {#name-ndpso-generation-and-verifi}

The signature generated by the 6LN to provide proof of ownership of the
private key is carried in the NDPSO. It is generated by the 6LN in a
fashion that depends on the Crypto-Type (see [Table
1](#cryptotypetable){.xref} in [Section 8.2](#cryptotypereg){.xref})
chosen by the 6LN as follows:[¶](#section-6.2-1){.pilcrow}

-   ::: {#section-6.2-2.1}
    Form the message to be signed, by concatenating the following
    byte-strings in the order listed:[¶](#section-6.2-2.1.1){.pilcrow}

    1.  [The 128-bit Message Type tag \[[RFC3972](#RFC3972){.xref}\] (in
        network byte order). For this specification, the tag is given in
        [Section 8.1](#cgam){.xref}. (The tag value has been generated
        by the editor of this specification on
        \<<https://www.random.org>\>.)[¶](#section-6.2-2.1.2.1){.pilcrow}]{#section-6.2-2.1.2.1}
    2.  [The
        CIPO.[¶](#section-6.2-2.1.2.2){.pilcrow}]{#section-6.2-2.1.2.2}
    3.  [The 16-byte Target Address (in network byte order) sent in the
        NS message. It is the address that the 6LN is registering with
        the 6LR and
        6LBR.[¶](#section-6.2-2.1.2.3){.pilcrow}]{#section-6.2-2.1.2.3}
    4.  [The NonceLR received from the 6LR (in network byte order) in
        the NA message. The nonce is at least 6 bytes long as defined in
        \[[RFC3971](#RFC3971){.xref}\].[¶](#section-6.2-2.1.2.4){.pilcrow}]{#section-6.2-2.1.2.4}
    5.  [The NonceLN sent from the 6LN (in network byte order). The
        nonce is at least 6 bytes long as defined in
        \[[RFC3971](#RFC3971){.xref}\].[¶](#section-6.2-2.1.2.5){.pilcrow}]{#section-6.2-2.1.2.5}
    6.  [The 1-byte option length of the EARO containing the
        Crypto-ID.[¶](#section-6.2-2.1.2.6){.pilcrow}]{#section-6.2-2.1.2.6}
    :::

-   [Apply the signature algorithm specified by the Crypto-Type using
    the private key.[¶](#section-6.2-2.2){.pilcrow}]{#section-6.2-2.2}

Upon receiving the NDPSO and CIPO options, the 6LR first checks that the
EARO Length in the CIPO matches the length of the EARO. If so, it
regenerates the Crypto-ID based on the CIPO to make sure that the
leftmost bits up to the size of the ROVR
match.[¶](#section-6.2-3){.pilcrow}

If, and only if, the check is successful, it tries to verify the
signature in the NDPSO using the following
steps:[¶](#section-6.2-4){.pilcrow}

-   ::: {#section-6.2-5.1}
    Form the message to be verified, by concatenating the following
    byte-strings in the order listed:[¶](#section-6.2-5.1.1){.pilcrow}

    1.  [The 128-bit Message Type tag given in [Section
        8.1](#cgam){.xref} (in network byte
        order).[¶](#section-6.2-5.1.2.1){.pilcrow}]{#section-6.2-5.1.2.1}
    2.  [The
        CIPO.[¶](#section-6.2-5.1.2.2){.pilcrow}]{#section-6.2-5.1.2.2}
    3.  [The 16-byte Target Address (in network byte order) received in
        the NS message. It is the address that the 6LN is registering
        with the 6LR and
        6LBR.[¶](#section-6.2-5.1.2.3){.pilcrow}]{#section-6.2-5.1.2.3}
    4.  [The NonceLR sent in the NA message. The nonce is at least 6
        bytes long as defined in
        \[[RFC3971](#RFC3971){.xref}\].[¶](#section-6.2-5.1.2.4){.pilcrow}]{#section-6.2-5.1.2.4}
    5.  [The NonceLN received from the 6LN (in network byte order) in
        the NS message. The nonce is at least 6 bytes long as defined in
        \[[RFC3971](#RFC3971){.xref}\].[¶](#section-6.2-5.1.2.5){.pilcrow}]{#section-6.2-5.1.2.5}
    6.  [The 1-byte EARO Length received in the
        CIPO.[¶](#section-6.2-5.1.2.6){.pilcrow}]{#section-6.2-5.1.2.6}
    :::

-   [Verify the signature on this message with the public key in the
    CIPO and the locally computed values using the signature algorithm
    specified by the Crypto-Type. If the verification succeeds, the 6LR
    propagates the information to the 6LBR using an EDAR/EDAC
    flow.[¶](#section-6.2-5.2){.pilcrow}]{#section-6.2-5.2}

-   [Due to the first-come, first-served nature of the registration, if
    the address is not registered to the 6LBR, then flow succeeds and
    both the 6LR and 6LBR add the state information about the Crypto-ID
    and Target Address being registered to their respective abstract
    databases.[¶](#section-6.2-5.3){.pilcrow}]{#section-6.2-5.3}
:::
:::

::: {#mhopo}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Multi-Hop Operation](#name-multi-hop-operation){.section-name .selfRef} {#name-multi-hop-operation}

A new 6LN that joins the network autoconfigures an address and performs
an initial registration to a neighboring 6LR with an NS message that
carries an EARO
\[[RFC8505](#RFC8505){.xref}\].[¶](#section-6.3-1){.pilcrow}

In a multi-hop 6LoWPAN, the registration with Crypto-ID is propagated to
6LBR as shown in [Figure 7](#figReg){.xref}, which illustrates the
registration flow all the way to a 6LoWPAN Backbone Router (6BBR)
\[[RFC8929](#RFC8929){.xref}\].[¶](#section-6.3-2){.pilcrow}

[]{#name-re-registration-flow}

::: {#figReg}
::: {#section-6.3-3.1 .artwork .art-text .alignLeft}
         6LN              6LR             6LBR            6BBR
          |                |               |                |
          |   NS(EARO)     |               |                |
          |--------------->|               |                |
          |                | Extended DAR  |                |
          |                |-------------->|                |
          |                |               | proxy NS(EARO) |
          |                |               |--------------->|
          |                |               |                | NS(DAD)
          |                |               |                | ------>
          |                |               |                |
          |                |               |                | <wait>
          |                |               |                |
          |                |               | proxy NA(EARO) |
          |                |               |<---------------|
          |                | Extended DAC  |                |
          |                |<--------------|                |
          |   NA(EARO)     |               |                |
          |<---------------|               |                |
          |                |               |                |
:::

[Figure 7](#figure-7){.selfRef}: [(Re-)Registration
Flow](#name-re-registration-flow){.selfRef}
:::

The 6LR and the 6LBR communicate using ICMPv6 EDAR and EDAC messages
\[[RFC8505](#RFC8505){.xref}\] as shown in [Figure 7](#figReg){.xref}.
This specification extends EDAR/EDAC messages to carry cryptographically
generated ROVR.[¶](#section-6.3-4){.pilcrow}

The assumption is that the 6LR and the 6LBR maintain a security
association to authenticate and protect the integrity of the EDAR and
EDAC messages, so there is no need to propagate the proof of ownership
to the 6LBR. The 6LBR implicitly trusts that the 6LR performs the
verification when the 6LBR requires it, and if there is no further
exchange from the 6LR to remove the state, the verification
succeeded.[¶](#section-6.3-5){.pilcrow}
:::
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Brown Field](#name-brown-field){.section-name .selfRef} {#name-brown-field}

Only 6LRs that are upgraded to this specification are capable of
challenging a registration and avoiding an attack. In a brown (mixed)
network, an attacker may attach to a legacy 6LR and fool the 6LBR. So
even if the \"A\" flag could be set at any time to test the protocol
operation, the security will only be effective when all the 6LRs are
upgraded.[¶](#section-7.1-1){.pilcrow}
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Threats Identified in RFC 3971](#name-threats-identified-in-rfc-3){.section-name .selfRef} {#name-threats-identified-in-rfc-3}

Observations regarding the following threats to the local network in
\[[RFC3971](#RFC3971){.xref}\] also apply to this
specification.[¶](#section-7.2-1){.pilcrow}

[]{.break}

Neighbor Solicitation/Advertisement Spoofing:
:   Threats in [Section
    9.2.1](https://www.rfc-editor.org/rfc/rfc3971#section-9.2.1){.relref}
    of \[[RFC3971](#RFC3971){.xref}\] apply. AP-ND counters the threats
    on NS(EARO) messages by requiring that the NDPSO and CIPO be present
    in these solicitations.[¶](#section-7.2-2.2){.pilcrow}
:   

Duplicate Address Detection DoS Attack:
:   Inside the LLN, duplicate addresses are sorted out using the ROVR. A
    different ROVR for the same Registered Address entails a rejection
    of the second registration \[[RFC8505](#RFC8505){.xref}\]. DADs
    coming from the backbone network are not forwarded over the LLN to
    provide some protection against DoS attacks inside the
    resource-constrained part of the network. However, the EARO is
    present in the NS/NA messages exchanged over the backbone network.
    This protects against misinterpreting node movement as a duplication
    and enables the Backbone Routers to determine which subnet has the
    most recent registration \[[RFC8505](#RFC8505){.xref}\] and is thus
    the best candidate to validate the registration
    \[[RFC8929](#RFC8929){.xref}\].[¶](#section-7.2-2.4){.pilcrow}
:   

Router Solicitation and Advertisement Attacks:
:   This specification does not change the protection of RS and RA,
    which can still be protected by SEND.[¶](#section-7.2-2.6){.pilcrow}
:   

Replay Attacks:
:   Nonces should never repeat but they do not need to be unpredictable
    for secure operation. Using nonces (NonceLR and NonceLN) generated
    by both the 6LR and 6LN ensures a contributory behavior that
    provides an efficient protection against replay attacks of the
    challenge/response flow. The quality of the protection by a random
    nonce depends on the random number
    generator.[¶](#section-7.2-2.8){.pilcrow}
:   

Neighbor Discovery DoS Attack:
:   A rogue node that can access the L2 network may form many addresses
    and register them using AP-ND. The perimeter of the attack is all
    the 6LRs in range of the attacker. The 6LR [MUST]{.bcp14} protect
    itself against overflows and reject excessive registration with a
    status code of 2 \"Neighbor Cache Full\". This effectively blocks
    another (honest) 6LN from registering to the same 6LR, but the 6LN
    may register to other 6LRs that are in its range but not in that of
    the attacker.[¶](#section-7.2-2.10){.pilcrow}
:   
:::

::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [Related to 6LoWPAN ND](#name-related-to-6lowpan-nd){.section-name .selfRef} {#name-related-to-6lowpan-nd}

The threats and mitigations discussed in 6LoWPAN ND
\[[RFC6775](#RFC6775){.xref}\] \[[RFC8505](#RFC8505){.xref}\] also apply
here, in particular, denial-of-service (DoS) attacks against the
registry at the 6LR or 6LBR.[¶](#section-7.3-1){.pilcrow}

Secure ND \[[RFC3971](#RFC3971){.xref}\] forces the IPv6 address to be
cryptographic since it integrates the CGA as the IID in the IPv6
address. In contrast, this specification saves about 1 KB in every NS/NA
message. Also, this specification separates the cryptographic identifier
from the registered IPv6 address so that a node can have more than one
IPv6 address protected by the same cryptographic
identifier.[¶](#section-7.3-2){.pilcrow}

With this specification, the 6LN can freely form its IPv6 address(es) in
any fashion, thereby enabling either 6LoWPAN compression for IPv6
addresses that are derived from L2 addresses or temporary addresses that
cannot be compressed, e.g., formed pseudorandomly and released in
relatively short cycles for privacy reasons
\[[RFC8064](#RFC8064){.xref}\]\[[RFC8065](#RFC8065){.xref}\].[¶](#section-7.3-3){.pilcrow}

This specification provides added protection for addresses that are
obtained following due procedure \[[RFC8505](#RFC8505){.xref}\] but does
not constrain the way the addresses are formed or the number of
addresses that are used in parallel by a same entity. An attacker may
still perform a DoS attack against the registry at the 6LR or 6LBR or
attempt to deplete the pool of available addresses at L2 or
L3.[¶](#section-7.3-4){.pilcrow}
:::

::: {#section-7.4 .section}
### [7.4.](#section-7.4){.section-number .selfRef} [Compromised 6LR](#name-compromised-6lr){.section-name .selfRef} {#name-compromised-6lr}

This specification distributes the challenge and its validation at the
edge of the network, between the 6LN and its 6LR. This protects against
DoS attacks targeted at that central 6LBR. This also saves
back-and-forth exchanges across a potentially large and constrained
network.[¶](#section-7.4-1){.pilcrow}

The downside is that the 6LBR needs to trust the 6LR to perform the
checking adequately, and the communication between the 6LR and the 6LBR
must be protected to avoid tampering with the result of the
validation.[¶](#section-7.4-2){.pilcrow}

If a 6LR is compromised, and provided that it knows the ROVR field used
by the real owner of the address, the 6LR may pretend that the owner has
moved, is now attached to it, and has successfully passed the Crypto-ID
validation. The 6LR may then attract and inject traffic at will on
behalf of that address, or let an attacker take ownership of the
address.[¶](#section-7.4-3){.pilcrow}
:::

::: {#sec-col}
::: {#section-7.5 .section}
### [7.5.](#section-7.5){.section-number .selfRef} [ROVR Collisions](#name-rovr-collisions){.section-name .selfRef} {#name-rovr-collisions}

A collision of ROVRs (i.e., the Crypto-ID in this specification) is
possible, but it is a rare event. Assuming that the hash used for
calculating the Crypto-ID is a well-behaved cryptographic hash, and,
thus, random collisions are the only ones possible, if n = 2^k^ is the
maximum number of hash values (i.e., a k-bit hash) and p is the number
of nodes, then (assuming one Crypto-ID per node) the formula 1 -
e^-p^2^/(2n)^ provides an approximation of the probability that there is
at least one collision (birthday paradox).[¶](#section-7.5-1){.pilcrow}

If the Crypto-ID is 64 bits (the least possible size allowed), the
chance of a collision is 0.01% for a network of 66 million nodes.
Moreover, the collision is only relevant when this happens within one
stub network (6LBR). In the case of such a collision, an honest node
might accidentally claim the Registered Address of another legitimate
node (with the same Crypto-ID). To prevent such rare events, it is
[RECOMMENDED]{.bcp14} that nodes do not derive the address being
registered from the ROVR.[¶](#section-7.5-2){.pilcrow}
:::
:::

::: {#section-7.6 .section}
### [7.6.](#section-7.6){.section-number .selfRef} [Implementation Attacks](#name-implementation-attacks){.section-name .selfRef} {#name-implementation-attacks}

The signature schemes referenced in this specification comply with NIST
\[[FIPS186-4](#FIPS186-4){.xref}\] or Crypto Forum Research Group (CFRG)
standards \[[RFC8032](#RFC8032){.xref}\] and offer strong algorithmic
security at roughly a 128-bit security level. These signature schemes
use elliptic curves that either were specifically designed with
exception-free and constant-time arithmetic in mind
\[[RFC7748](#RFC7748){.xref}\] or have extensive implementation
experience of resistance to timing attacks
\[[FIPS186-4](#FIPS186-4){.xref}\].[¶](#section-7.6-1){.pilcrow}

However, careless implementations of the signing operations could
nevertheless leak information on private keys. For example, there are
micro-architectural side channel attacks that implementors should be
aware of \[[breaking-ed25519](#breaking-ed25519){.xref}\]. Implementors
should be particularly aware that a secure implementation of Ed25519
requires a protected implementation of the hash function SHA-512,
whereas this is not required with implementations of the hash function
SHA-256 used with ECDSA256 and ECDSA25519.[¶](#section-7.6-2){.pilcrow}
:::

::: {#section-7.7 .section}
### [7.7.](#section-7.7){.section-number .selfRef} [Cross-Algorithm and Cross-Protocol Attacks](#name-cross-algorithm-and-cross-p){.section-name .selfRef} {#name-cross-algorithm-and-cross-p}

The key pair used in this specification can be self-generated, and the
public key does not need to be exchanged, e.g., through certificates,
with a third party before it is used.[¶](#section-7.7-1){.pilcrow}

New key pairs can be formed for new registrations if the node desires.
However, the same private key [MUST NOT]{.bcp14} be reused with more
than one instantiation of the signature scheme in this specification.
Also, the same private key [MUST NOT]{.bcp14} be used for anything other
than computing NDPSO signatures per this
specification.[¶](#section-7.7-2){.pilcrow}

ECDSA shall be used strictly as specified in
\[[FIPS186-4](#FIPS186-4){.xref}\]. In particular, each signing
operation of ECDSA [MUST]{.bcp14} use randomly generated ephemeral
private keys and [MUST NOT]{.bcp14} reuse the ephemeral private key k
across signing operations. This precludes the use of deterministic ECDSA
without a random input for the determination of k, which is deemed
dangerous for the intended applications this document aims to
serve.[¶](#section-7.7-3){.pilcrow}
:::

::: {#section-7.8 .section}
### [7.8.](#section-7.8){.section-number .selfRef} [Public Key Validation](#name-public-key-validation){.section-name .selfRef} {#name-public-key-validation}

Public keys contained in the CIPO field (which are used for signature
verification) shall be verified to be correctly formed, by checking that
this public key is indeed a point of the elliptic curve indicated by the
Crypto-Type and that this point does have the proper
order.[¶](#section-7.8-1){.pilcrow}

For points used with the signature scheme Ed25519, one [MUST]{.bcp14}
check that this point is not in the small subgroup (see [Appendix
B.1](https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1){.relref}
of \[[CURVE-REPR](#I-D.ietf-lwig-curve-representations){.xref}\]); for
points used with the signature scheme ECDSA (i.e., both ECDSA256 and
ECDSA25519), one [MUST]{.bcp14} check that the point has the same order
as the base point of the curve in question. This is commonly called
\"full public key validation\" (again, see [Appendix
B.1](https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1){.relref}
of
\[[CURVE-REPR](#I-D.ietf-lwig-curve-representations){.xref}\]).[¶](#section-7.8-2){.pilcrow}
:::

::: {#section-7.9 .section}
### [7.9.](#section-7.9){.section-number .selfRef} [Correlating Registrations](#name-correlating-registrations){.section-name .selfRef} {#name-correlating-registrations}

The ROVR field in the EARO introduced in \[[RFC8505](#RFC8505){.xref}\]
extends the EUI-64 field of the ARO defined in
\[[RFC6775](#RFC6775){.xref}\]. One of the drawbacks of using an EUI-64
as ROVR is that an attacker that is aware of the registrations can
correlate traffic for the same 6LN across multiple addresses. [Section
3](https://www.rfc-editor.org/rfc/rfc8505#section-3){.relref} of
\[[RFC8505](#RFC8505){.xref}\] indicates that the ROVR and the address
being registered are decoupled. A 6LN may use the same ROVR for multiple
registrations or a different ROVR per registration, and the IID must not
be derived from the ROVR. In theory, different 6LNs could use the same
ROVR as long as they do not attempt to register the same
address.[¶](#section-7.9-1){.pilcrow}

The modifier used in the computation of the Crypto-ID enables a 6LN to
build different Crypto-IDs for different addresses with the same key
pair. Using that facility improves the privacy of the 6LN at the expense
of storage in the 6LR, which will need to store multiple CIPOs that
contain the same public key. Note that if an attacker gains access to
the 6LR, then the modifier alone does not provide protection, and the
6LN would need to generate different key pairs and link-layer addresses
in an attempt to obfuscate its multiple
ownership.[¶](#section-7.9-2){.pilcrow}
:::
:::

::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#cgam}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [CGA Message Type](#name-cga-message-type){.section-name .selfRef} {#name-cga-message-type}

This document defines a new 128-bit CGA Extension Type Tag under the
\"CGA Extension Type Tags\" subregistry of the Cryptographically
Generated Addresses (CGA) Message Type Name Space created by
\[[RFC3972](#RFC3972){.xref}\].[¶](#section-8.1-1){.pilcrow}

Tag: 0x8701 55c8 0cca dd32 6ab7 e415 f148
84d0.[¶](#section-8.1-2){.pilcrow}
:::
:::

::: {#cryptotypereg}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Crypto-Type Subregistry](#name-crypto-type-subregistry){.section-name .selfRef} {#name-crypto-type-subregistry}

IANA has created the \"Crypto-Types\" subregistry in the \"Internet
Control Message Protocol version 6 (ICMPv6) Parameters\" registry. The
registry is indexed by an integer in the interval 0..255 and contains an
elliptic curve, a hash function, a signature algorithm, representation
conventions, public key size, and signature size, as shown in [Table
1](#cryptotypetable){.xref}, which together specify a signature scheme.
Detailed explanations are provided in [Appendix
B](#reprconv){.xref}.[¶](#section-8.2-1){.pilcrow}

The following Crypto-Type values are defined in this
document:[¶](#section-8.2-2){.pilcrow}

[]{#name-crypto-types}

::: {#cryptotypetable}
  Crypto-Type Value            0 (ECDSA256)                                                           1 (Ed25519)                                                          2 (ECDSA25519)
  ---------------------------- ---------------------------------------------------------------------- -------------------------------------------------------------------- -----------------------------------------------------------------------------------------------------------
  Elliptic Curve               NIST P-256 \[[FIPS186-4](#FIPS186-4){.xref}\]                          Curve25519 \[[RFC7748](#RFC7748){.xref}\]                            Curve25519 \[[RFC7748](#RFC7748){.xref}\]
  Hash Function                SHA-256 \[[RFC6234](#RFC6234){.xref}\]                                 SHA-512 \[[RFC6234](#RFC6234){.xref}\]                               SHA-256 \[[RFC6234](#RFC6234){.xref}\]
  Signature Algorithm          ECDSA \[[FIPS186-4](#FIPS186-4){.xref}\]                               Ed25519 \[[RFC8032](#RFC8032){.xref}\]                               ECDSA \[[FIPS186-4](#FIPS186-4){.xref}\]
  Representation Conventions   Weierstrass, (un)compressed, MSB/msb-order, \[[SEC1](#SEC1){.xref}\]   Edwards, compressed, LSB/lsb-order, \[[RFC8032](#RFC8032){.xref}\]   Weierstrass, (un)compressed, MSB/msb-order, \[[CURVE-REPR](#I-D.ietf-lwig-curve-representations){.xref}\]
  Public Key Size              33/65 bytes (compressed/uncompressed)                                  32 bytes (compressed)                                                33/65 bytes (compressed/uncompressed)
  Signature Size               64 bytes                                                               64 bytes                                                             64 bytes
  Reference                    RFC 8928                                                               RFC 8928                                                             RFC 8928

  : [Table 1](#table-1){.selfRef}:
  [Crypto-Types](#name-crypto-types){.selfRef}
:::

New Crypto-Type values providing similar or better security may be
defined in the future.[¶](#section-8.2-4){.pilcrow}

Assignment of values for new Crypto-Type [MUST]{.bcp14} be done through
IANA with either \"Specification Required\" or \"IESG Approval\" as
defined in [BCP 26](#RFC8126){.xref}
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-8.2-5){.pilcrow}
:::
:::

::: {#ndopt}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [IPv6 ND Option Types](#name-ipv6-nd-option-types){.section-name .selfRef} {#name-ipv6-nd-option-types}

This document registers two new ND option types under the subregistry
\"IPv6 Neighbor Discovery Option Formats\":[¶](#section-8.3-1){.pilcrow}

[]{#name-new-nd-options}

::: {#nexndopt}
  Description                          Type   Reference
  ------------------------------------ ------ -----------
  Crypto-ID Parameters Option (CIPO)   39     RFC 8928
  NDP Signature Option (NDPSO)         40     RFC 8928

  : [Table 2](#table-2){.selfRef}: [New ND
  Options](#name-new-nd-options){.selfRef}
:::
:::
:::

::: {#section-8.4 .section}
### [8.4.](#section-8.4){.section-number .selfRef} [New 6LoWPAN Capability Bit](#name-new-6lowpan-capability-bit){.section-name .selfRef} {#name-new-6lowpan-capability-bit}

IANA has made an addition to the subregistry for \"6LoWPAN Capability
Bits\" created for \[[RFC7400](#RFC7400){.xref}\] as
follows:[¶](#section-8.4-1){.pilcrow}

[]{#name-new-6lowpan-capability-bit-2}

::: {#CIOdat}
  Bit   Description             Reference
  ----- ----------------------- -----------
  9     AP-ND Enabled (1 bit)   RFC 8928

  : [Table 3](#table-3){.selfRef}: [New 6LoWPAN Capability
  Bit](#name-new-6lowpan-capability-bit-2){.selfRef}
:::
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[FIPS186-4\]
:   [National Institute of Standards and Technology]{.refAuthor},
    [\"Digital Signature Standard (DSS)\"]{.refTitle}, [FIPS
    186-4]{.seriesInfo}, [DOI 10.6028/NIST.FIPS.186-4]{.seriesInfo},
    July 2013,
    \<<https://nvlpubs.nist.gov/nistpubs/fips/nist.fips.186-4.pdf>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3971\]
:   [Arkko, J., Ed.]{.refAuthor}[, Kempf, J.]{.refAuthor}[,
    Zill, B.]{.refAuthor}[, and P. Nikander]{.refAuthor}, [\"SEcure
    Neighbor Discovery (SEND)\"]{.refTitle}, [RFC 3971]{.seriesInfo},
    [DOI 10.17487/RFC3971]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc3971>\>.
:   

\[RFC6234\]
:   [Eastlake 3rd, D.]{.refAuthor}[ and T. Hansen]{.refAuthor}, [\"US
    Secure Hash Algorithms (SHA and SHA-based HMAC and
    HKDF)\"]{.refTitle}, [RFC 6234]{.seriesInfo}, [DOI
    10.17487/RFC6234]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6234>\>.
:   

\[RFC6775\]
:   [Shelby, Z., Ed.]{.refAuthor}[, Chakrabarti, S.]{.refAuthor}[,
    Nordmark, E.]{.refAuthor}[, and C. Bormann]{.refAuthor}, [\"Neighbor
    Discovery Optimization for IPv6 over Low-Power Wireless Personal
    Area Networks (6LoWPANs)\"]{.refTitle}, [RFC 6775]{.seriesInfo},
    [DOI 10.17487/RFC6775]{.seriesInfo}, November 2012,
    \<<https://www.rfc-editor.org/info/rfc6775>\>.
:   

\[RFC7400\]
:   [Bormann, C.]{.refAuthor}, [\"6LoWPAN-GHC: Generic Header
    Compression for IPv6 over Low-Power Wireless Personal Area Networks
    (6LoWPANs)\"]{.refTitle}, [RFC 7400]{.seriesInfo}, [DOI
    10.17487/RFC7400]{.seriesInfo}, November 2014,
    \<<https://www.rfc-editor.org/info/rfc7400>\>.
:   

\[RFC7748\]
:   [Langley, A.]{.refAuthor}[, Hamburg, M.]{.refAuthor}[, and S.
    Turner]{.refAuthor}, [\"Elliptic Curves for Security\"]{.refTitle},
    [RFC 7748]{.seriesInfo}, [DOI 10.17487/RFC7748]{.seriesInfo},
    January 2016, \<<https://www.rfc-editor.org/info/rfc7748>\>.
:   

\[RFC8032\]
:   [Josefsson, S.]{.refAuthor}[ and I. Liusvaara]{.refAuthor},
    [\"Edwards-Curve Digital Signature Algorithm (EdDSA)\"]{.refTitle},
    [RFC 8032]{.seriesInfo}, [DOI 10.17487/RFC8032]{.seriesInfo},
    January 2017, \<<https://www.rfc-editor.org/info/rfc8032>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8505\]
:   [Thubert, P., Ed.]{.refAuthor}[, Nordmark, E.]{.refAuthor}[,
    Chakrabarti, S.]{.refAuthor}[, and C. Perkins]{.refAuthor},
    [\"Registration Extensions for IPv6 over Low-Power Wireless Personal
    Area Network (6LoWPAN) Neighbor Discovery\"]{.refTitle}, [RFC
    8505]{.seriesInfo}, [DOI 10.17487/RFC8505]{.seriesInfo}, November
    2018, \<<https://www.rfc-editor.org/info/rfc8505>\>.
:   

\[SEC1\]
:   [Standards for Efficient Cryptography]{.refAuthor}, [\"SEC 1:
    Elliptic Curve Cryptography\"]{.refTitle}, [Version 2]{.refContent},
    May 2009, \<<https://www.secg.org/sec1-v2.pdf>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[BCP106\]
:   [Eastlake 3rd, D.]{.refAuthor}[, Schiller, J.]{.refAuthor}[, and S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.
:   

\[BCP201\]
:   [Housley, R.]{.refAuthor}, [\"Guidelines for Cryptographic Algorithm
    Agility and Selecting Mandatory-to-Implement
    Algorithms\"]{.refTitle}, [BCP 201]{.seriesInfo}, [RFC
    7696]{.seriesInfo}, [DOI 10.17487/RFC7696]{.seriesInfo}, November
    2015, \<<https://www.rfc-editor.org/info/rfc7696>\>.
:   

\[breaking-ed25519\]
:   [Samwel, N.]{.refAuthor}[, Batina, L.]{.refAuthor}[,
    Bertoni, G.]{.refAuthor}[, Daemen, J.]{.refAuthor}[, and R.
    Susella]{.refAuthor}, [\"Breaking Ed25519 in WolfSSL\"]{.refTitle},
    [Topics in Cryptology - CT-RSA, pp. 1-20]{.refContent}, March 2018,
    \<<https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1>\>.
:   

\[CURVE-REPR\]
:   [Struik, R.]{.refAuthor}, [\"Alternative Elliptic Curve
    Representations\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-ietf-lwig-curve-representations-14]{.seriesInfo}, 15 November
    2020,
    \<<https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14>\>.
:   

\[RFC3972\]
:   [Aura, T.]{.refAuthor}, [\"Cryptographically Generated Addresses
    (CGA)\"]{.refTitle}, [RFC 3972]{.seriesInfo}, [DOI
    10.17487/RFC3972]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc3972>\>.
:   

\[RFC4861\]
:   [Narten, T.]{.refAuthor}[, Nordmark, E.]{.refAuthor}[,
    Simpson, W.]{.refAuthor}[, and H. Soliman]{.refAuthor}, [\"Neighbor
    Discovery for IP version 6 (IPv6)\"]{.refTitle}, [RFC
    4861]{.seriesInfo}, [DOI 10.17487/RFC4861]{.seriesInfo}, September
    2007, \<<https://www.rfc-editor.org/info/rfc4861>\>.
:   

\[RFC4862\]
:   [Thomson, S.]{.refAuthor}[, Narten, T.]{.refAuthor}[, and T.
    Jinmei]{.refAuthor}, [\"IPv6 Stateless Address
    Autoconfiguration\"]{.refTitle}, [RFC 4862]{.seriesInfo}, [DOI
    10.17487/RFC4862]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4862>\>.
:   

\[RFC4919\]
:   [Kushalnagar, N.]{.refAuthor}[, Montenegro, G.]{.refAuthor}[, and C.
    Schumacher]{.refAuthor}, [\"IPv6 over Low-Power Wireless Personal
    Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement,
    and Goals\"]{.refTitle}, [RFC 4919]{.seriesInfo}, [DOI
    10.17487/RFC4919]{.seriesInfo}, August 2007,
    \<<https://www.rfc-editor.org/info/rfc4919>\>.
:   

\[RFC4944\]
:   [Montenegro, G.]{.refAuthor}[, Kushalnagar, N.]{.refAuthor}[,
    Hui, J.]{.refAuthor}[, and D. Culler]{.refAuthor}, [\"Transmission
    of IPv6 Packets over IEEE 802.15.4 Networks\"]{.refTitle}, [RFC
    4944]{.seriesInfo}, [DOI 10.17487/RFC4944]{.seriesInfo}, September
    2007, \<<https://www.rfc-editor.org/info/rfc4944>\>.
:   

\[RFC6282\]
:   [Hui, J., Ed.]{.refAuthor}[ and P. Thubert]{.refAuthor},
    [\"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based
    Networks\"]{.refTitle}, [RFC 6282]{.seriesInfo}, [DOI
    10.17487/RFC6282]{.seriesInfo}, September 2011,
    \<<https://www.rfc-editor.org/info/rfc6282>\>.
:   

\[RFC7039\]
:   [Wu, J.]{.refAuthor}[, Bi, J.]{.refAuthor}[,
    Bagnulo, M.]{.refAuthor}[, Baker, F.]{.refAuthor}[, and C. Vogt,
    Ed.]{.refAuthor}, [\"Source Address Validation Improvement (SAVI)
    Framework\"]{.refTitle}, [RFC 7039]{.seriesInfo}, [DOI
    10.17487/RFC7039]{.seriesInfo}, October 2013,
    \<<https://www.rfc-editor.org/info/rfc7039>\>.
:   

\[RFC7217\]
:   [Gont, F.]{.refAuthor}, [\"A Method for Generating Semantically
    Opaque Interface Identifiers with IPv6 Stateless Address
    Autoconfiguration (SLAAC)\"]{.refTitle}, [RFC 7217]{.seriesInfo},
    [DOI 10.17487/RFC7217]{.seriesInfo}, April 2014,
    \<<https://www.rfc-editor.org/info/rfc7217>\>.
:   

\[RFC8064\]
:   [Gont, F.]{.refAuthor}[, Cooper, A.]{.refAuthor}[,
    Thaler, D.]{.refAuthor}[, and W. Liu]{.refAuthor}, [\"Recommendation
    on Stable IPv6 Interface Identifiers\"]{.refTitle}, [RFC
    8064]{.seriesInfo}, [DOI 10.17487/RFC8064]{.seriesInfo}, February
    2017, \<<https://www.rfc-editor.org/info/rfc8064>\>.
:   

\[RFC8065\]
:   [Thaler, D.]{.refAuthor}, [\"Privacy Considerations for IPv6
    Adaptation-Layer Mechanisms\"]{.refTitle}, [RFC 8065]{.seriesInfo},
    [DOI 10.17487/RFC8065]{.seriesInfo}, February 2017,
    \<<https://www.rfc-editor.org/info/rfc8065>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8929\]
:   [Thubert, P., Ed.]{.refAuthor}[, Perkins, C.E.]{.refAuthor}[, and E.
    Levy-Abegnoli]{.refAuthor}, [\"IPv6 Backbone Router\"]{.refTitle},
    [RFC 8929]{.seriesInfo}, [DOI 10.17487/RFC8929]{.seriesInfo},
    November 2020, \<<https://www.rfc-editor.org/info/rfc8929>\>.
:   
:::
:::

::: {#ps}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Requirements Addressed in This Document](#name-requirements-addressed-in-t){.section-name .selfRef} {#name-requirements-addressed-in-t}

In this section, the requirements of a secure Neighbor Discovery
protocol for LLNs are stated.[¶](#section-appendix.a-1){.pilcrow}

-   [The protocol [MUST]{.bcp14} be based on the Neighbor Discovery
    Optimization for the LLN protocol defined in
    \[[RFC6775](#RFC6775){.xref}\]. RFC 6775 utilizes optimizations such
    as host-initiated interactions for sleeping resource-constrained
    hosts and the elimination of multicast address
    resolution.[¶](#section-appendix.a-2.1){.pilcrow}]{#section-appendix.a-2.1}
-   [New options to be added to Neighbor Solicitation messages
    [MUST]{.bcp14} lead to small packet sizes, especially compared with
    existing protocols such as SEND. Smaller packet sizes facilitate
    low-power transmission by resource-constrained nodes on lossy
    links.[¶](#section-appendix.a-2.2){.pilcrow}]{#section-appendix.a-2.2}
-   [The registration mechanism [SHOULD]{.bcp14} be extensible to other
    LLN links and not be limited to IEEE 802.15.4 only. LLN links for
    which a 6lo \"IPv6 over foo\" specification exist, as well as
    low-power Wi-Fi, [SHOULD]{.bcp14} be
    supported.[¶](#section-appendix.a-2.3){.pilcrow}]{#section-appendix.a-2.3}
-   [As part of this protocol, a mechanism to compute a unique
    identifier should be provided with the capability to form a Link
    Local Address that [SHOULD]{.bcp14} be unique at least within the
    LLN connected to a
    6LBR.[¶](#section-appendix.a-2.4){.pilcrow}]{#section-appendix.a-2.4}
-   [The Address Registration Option used in the ND registration
    [SHOULD]{.bcp14} be extended to carry the relevant forms of the
    unique
    identifier.[¶](#section-appendix.a-2.5){.pilcrow}]{#section-appendix.a-2.5}
-   [The Neighbor Discovery should specify the formation of a site-local
    address that follows the security recommendations from
    \[[RFC7217](#RFC7217){.xref}\].[¶](#section-appendix.a-2.6){.pilcrow}]{#section-appendix.a-2.6}
:::
:::

::: {#reprconv}
::: {#section-appendix.b .section}
## [Appendix B.](#section-appendix.b){.section-number .selfRef} [Representation Conventions](#name-representation-conventions){.section-name .selfRef} {#name-representation-conventions}

::: {#section-b.1 .section}
## [B.1.](#section-b.1){.section-number .selfRef} [Signature Schemes](#name-signature-schemes){.section-name .selfRef} {#name-signature-schemes}

The signature scheme ECDSA256 corresponding to Crypto-Type 0 is ECDSA,
as specified in \[[FIPS186-4](#FIPS186-4){.xref}\], instantiated with
the NIST prime curve P-256, as specified in Appendix D.1.2 of
\[[FIPS186-4](#FIPS186-4){.xref}\], and the hash function SHA-256, as
specified in \[[RFC6234](#RFC6234){.xref}\], where points of this NIST
curve are represented as points of a short-Weierstrass curve (see
\[[FIPS186-4](#FIPS186-4){.xref}\]) and are encoded as octet strings in
most-significant-bit first (msb) and most-significant-byte first (MSB)
order. The signature itself consists of two integers (r and s), which
are each encoded as fixed-size octet strings in MSB and msb order. For
further details, see \[[FIPS186-4](#FIPS186-4){.xref}\] for ECDSA, see
[Appendix B.3](#weirepr){.xref} for the encoding of public keys, and see
[Appendix B.2](#bitrepr){.xref} for signature
encoding.[¶](#section-b.1-1){.pilcrow}

The signature scheme Ed25519 corresponding to Crypto-Type 1 is EdDSA, as
specified in \[[RFC8032](#RFC8032){.xref}\], instantiated with the
Montgomery curve Curve25519, as specified in
\[[RFC7748](#RFC7748){.xref}\], and the hash function SHA-512, as
specified in \[[RFC6234](#RFC6234){.xref}\], where points of this
Montgomery curve are represented as points of the corresponding twisted
Edwards curve Edwards25519 (see [Appendix B.4](#curves){.xref}) and are
encoded as octet strings in least-significant-bit first (lsb) and
least-significant-byte first (LSB) order. The signature itself consists
of a bit string that encodes a point of this twisted Edwards curve, in
compressed format, and an integer encoded in LSB and lsb order. For
details on EdDSA and the encoding of public keys and signatures, see the
specification of pure Ed25519 in
\[[RFC8032](#RFC8032){.xref}\].[¶](#section-b.1-2){.pilcrow}

The signature scheme ECDSA25519 corresponding to Crypto-Type 2 is ECDSA,
as specified in \[[FIPS186-4](#FIPS186-4){.xref}\], instantiated with
the Montgomery curve Curve25519, as specified in
\[[RFC7748](#RFC7748){.xref}\], and the hash function SHA-256, as
specified in \[[RFC6234](#RFC6234){.xref}\], where points of this
Montgomery curve are represented as points of the corresponding
short-Weierstrass curve Wei25519 (see [Appendix B.4](#curves){.xref})
and are encoded as octet strings in MSB and msb order. The signature
itself consists of a bit string that encodes two integers (r and s),
which are each encoded as fixed-size octet strings in MSB and msb order.
For further details, see \[[FIPS186-4](#FIPS186-4){.xref}\] for ECDSA,
see [Appendix B.3](#weirepr){.xref} for the encoding of public keys, and
see [Appendix B.2](#bitrepr){.xref} for signature
encoding.[¶](#section-b.1-3){.pilcrow}
:::

::: {#bitrepr}
::: {#section-b.2 .section}
## [B.2.](#section-b.2){.section-number .selfRef} [Representation of ECDSA Signatures](#name-representation-of-ecdsa-sig){.section-name .selfRef} {#name-representation-of-ecdsa-sig}

With ECDSA, each signature is an ordered pair (r, s) of integers
\[[FIPS186-4](#FIPS186-4){.xref}\], where each integer is represented as
a 32-octet string according to the FieldElement-to-OctetString
conversion rules in \[[SEC1](#SEC1){.xref}\] and where the ordered pair
of integers is represented as the right concatenation of these
representation values (thereby resulting in a 64-octet string). The
inverse operation checks that the signature is a 64-octet string and
represents the left-side and right-side halves of this string (each a
32-octet string) as the integers r and s, respectively, using the
OctetString-to-FieldElement conversion rules in
\[[SEC1](#SEC1){.xref}\]. In both cases, the field with these conversion
rules is the set of integers modulo n, where n is the (prime) order of
the base point of the curve in question. (For elliptic curve
nomenclature, see [Appendix
B.1](https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1){.relref}
of
\[[CURVE-REPR](#I-D.ietf-lwig-curve-representations){.xref}\].)[¶](#section-b.2-1){.pilcrow}
:::
:::

::: {#weirepr}
::: {#section-b.3 .section}
## [B.3.](#section-b.3){.section-number .selfRef} [Representation of Public Keys Used with ECDSA](#name-representation-of-public-ke){.section-name .selfRef} {#name-representation-of-public-ke}

ECDSA is specified to be used with elliptic curves in short-Weierstrass
form. Each point of such a curve is represented as an octet string using
the Elliptic-Curve-Point-to-Octet-String conversion rules in
\[[SEC1](#SEC1){.xref}\], where point compression may be enabled (which
is indicated by the leftmost octet of this representation). The inverse
operation converts an octet string to a point of this curve using the
Octet-String-to-Elliptic-Curve-Point conversion rules in
\[[SEC1](#SEC1){.xref}\], whereby the point is rejected if this is the
so-called point at infinity. (This is the case if the input to this
inverse operation is an octet string of length
1.)[¶](#section-b.3-1){.pilcrow}
:::
:::

::: {#curves}
::: {#section-b.4 .section}
## [B.4.](#section-b.4){.section-number .selfRef} [Alternative Representations of Curve25519](#name-alternative-representations){.section-name .selfRef} {#name-alternative-representations}

The elliptic curve Curve25519, as specified in
\[[RFC7748](#RFC7748){.xref}\], is a so-called Montgomery curve. Each
point of this curve can also be represented as a point of a twisted
Edwards curve or as a point of an elliptic curve in short-Weierstrass
form, via a coordinate transformation (a so-called isomorphic mapping).
The parameters of the Montgomery curve and the corresponding isomorphic
curves in twisted Edwards curve and short-Weierstrass form are as
indicated below. Here, the domain parameters of the Montgomery curve
Curve25519 and of the twisted Edwards curve Edwards25519 are as
specified in \[[RFC7748](#RFC7748){.xref}\]; the domain parameters of
the elliptic curve Wei25519 in short-Weierstrass form comply with
Section 6.1.1 of \[[FIPS186-4](#FIPS186-4){.xref}\]. For further details
on these curves and on the coordinate transformations referenced above,
see
\[[CURVE-REPR](#I-D.ietf-lwig-curve-representations){.xref}\].[¶](#section-b.4-1){.pilcrow}

General parameters (for all curve models):[¶](#section-b.4-2){.pilcrow}

::: {#section-b.4-3}
``` sourcecode
p  2^{255}-19
   (=0x7fffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff
   ffffffed)
h  8
n
   723700557733226221397318656304299424085711635937990760600195093828
   5454250989
   (=2^{252} +  0x14def9de a2f79cd6 5812631a 5cf5d3ed)
```

[¶](#section-b.4-3){.pilcrow}
:::

Montgomery curve-specific parameters (for
Curve25519):[¶](#section-b.4-4){.pilcrow}

::: {#section-b.4-5}
``` sourcecode
A  486662
B  1
Gu 9 (=0x9)
Gv
   147816194475895447910205935684099868872646061346164752889648818377
   55586237401
   (=0x20ae19a1 b8a086b4 e01edd2c 7748d14c 923d4d7e 6d7c61b2 29e9c5a2
   7eced3d9)
```

[¶](#section-b.4-5){.pilcrow}
:::

Twisted Edwards curve-specific parameters (for
Edwards25519):[¶](#section-b.4-6){.pilcrow}

::: {#section-b.4-7}
``` sourcecode
a  -1 (-0x01)
d  -121665/121666
   (=3709570593466943934313808350875456518954211387984321901638878553
   3085940283555)
   (=0x52036cee 2b6ffe73 8cc74079 7779e898 00700a4d 4141d8ab 75eb4dca
   135978a3)
Gx
   151122213495354007725011514095885315114540126930418572060461132839
   49847762202
   (=0x216936d3 cd6e53fe c0a4e231 fdd6dc5c 692cc760 9525a7b2 c9562d60
   8f25d51a)
Gy  4/5
   (=4631683569492647816942839400347516314130799386625622561578303360
   3165251855960)
   (=0x66666666 66666666 66666666 66666666 66666666 66666666 66666666
   66666658)
```

[¶](#section-b.4-7){.pilcrow}
:::

Weierstrass curve-specific parameters (for
Wei25519):[¶](#section-b.4-8){.pilcrow}

::: {#section-b.4-9}
``` sourcecode
a
   192986815395526992372618308347813179755449974442734273399095973345
   73241639236
   (=0x2aaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaa98
   4914a144)
b
   557517466698189089076452890782571408182411037279010123152944008379
   56729358436
   (=0x7b425ed0 97b425ed 097b425e d097b425 ed097b42 5ed097b4 260b5e9c
   7710c864)
GX
   192986815395526992372618308347813179755449974442734273399095973346
   52188435546
   (=0x2aaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa aaaaaaaa
   aaad245a)
GY
   147816194475895447910205935684099868872646061346164752889648818377
   55586237401
   (=0x20ae19a1 b8a086b4 e01edd2c 7748d14c 923d4d7e 6d7c61b2 29e9c5a2
   7eced3d9)
```

[¶](#section-b.4-9){.pilcrow}
:::
:::
:::

::: {#section-b.5 .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

Many thanks to [Charlie Perkins]{.contact-name} for his in-depth review
and constructive suggestions. The authors are also especially grateful
to [Robert Moskowitz]{.contact-name} and [Benjamin Kaduk]{.contact-name}
for their comments and discussions that led to many improvements. The
authors wish to also thank [Shwetha Bhandari]{.contact-name} for
actively shepherding this document and [Roman Danyliw]{.contact-name},
[Alissa Cooper]{.contact-name}, [Mirja Kühlewind]{.contact-name}, [Éric
Vyncke]{.contact-name}, [Vijay Gurbani]{.contact-name}, [Al
Morton]{.contact-name}, and [Adam Montville]{.contact-name} for their
constructive reviews during the IESG process. Finally, many thanks to
our INT area ADs, [Suresh Krishnan]{.contact-name} and [Erik
Kline]{.contact-name}, who supported us along the whole
process.[¶](#section-b.5-1){.pilcrow}
:::
:::
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Pascal Thubert ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc.]{.org}
:::

::: {.left dir="auto"}
[Building D\
45 Allee des Ormes - BP1200]{.street-address}
:::

::: {.left dir="auto"}
[06254]{.postal-code} [MOUGINS - Sophia Antipolis]{.locality}
:::

::: {.left dir="auto"}
[France]{.country-name}
:::

::: tel
Phone: [+33 497 23 26 34](tel:+33%20497%2023%2026%2034){.tel}
:::

::: email
Email: <pthubert@cisco.com>
:::

::: {.left dir="auto"}
[Behcet Sarikaya]{.fn .nameRole}
:::

::: email
Email: <sarikaya@ieee.org>
:::

::: {.left dir="auto"}
[Mohit Sethi]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Ericsson]{.org}
:::

::: {.left dir="auto"}
FI-[02420]{.postal-code} [Jorvas]{.locality}
:::

::: {.left dir="auto"}
[Finland]{.country-name}
:::

::: email
Email: <mohit@piuha.net>
:::

::: {.left dir="auto"}
[Rene Struik]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Struik Security Consultancy]{.org}
:::

::: email
Email: <rstruik.ext@gmail.com>
:::
:::
:::
