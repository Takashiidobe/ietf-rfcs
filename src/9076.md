  RFC 9076   DNS Privacy Considerations   July 2021
  ---------- ---------------------------- -----------
  Wicinski   Informational                \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9076](https://www.rfc-editor.org/rfc/rfc9076){.eref}

Obsoletes:
:   [7626](https://www.rfc-editor.org/rfc/rfc7626){.eref}

Category:
:   Informational

Published:
:   July 2021

ISSN:
:   2070-1721

Author:

:   ::: author
    ::: author-name
    T. Wicinski, [Ed.]{.editor}
    :::
    :::
:::

# RFC 9076 {#rfcnum}

# DNS Privacy Considerations {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes the privacy issues associated with the use of
the DNS by Internet users. It provides general observations about
typical current privacy practices. It is intended to be an analysis of
the present situation and does not prescribe solutions. This document
obsoletes RFC 7626.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Not all documents approved
by the IESG are candidates for any level of Internet Standard; see
Section 2 of RFC 7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9076>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Scope](#name-scope){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Risks](#name-risks){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Risks in the DNS
    Data](#name-risks-in-the-dns-data){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [The Public Nature of DNS
        Data](#name-the-public-nature-of-dns-da){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Data in the DNS
        Request](#name-data-in-the-dns-request){.xref}

        -   ::: {#section-toc.1-1.4.2.2.2.1}
            [4.2.1](#section-4.2.1){.xref}.  [Data in the DNS
            Payload](#name-data-in-the-dns-payload){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Cache
        Snooping](#name-cache-snooping){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Risks on the
    Wire](#name-risks-on-the-wire){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Unencrypted
        Transports](#name-unencrypted-transports){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Encrypted
        Transports](#name-encrypted-transports){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Risks in the
    Servers](#name-risks-in-the-servers){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [In the Recursive
        Resolvers](#name-in-the-recursive-resolvers){.xref}

        -   ::: {#section-toc.1-1.6.2.1.2.1}
            [6.1.1](#section-6.1.1){.xref}.  [Resolver
            Selection](#name-resolver-selection){.xref}
            :::

        -   ::: {#section-toc.1-1.6.2.1.2.2}
            [6.1.2](#section-6.1.2){.xref}.  [Active Attacks on Resolver
            Configuration](#name-active-attacks-on-resolver-){.xref}
            :::

        -   ::: {#section-toc.1-1.6.2.1.2.3}
            [6.1.3](#section-6.1.3){.xref}.  [Blocking of DNS Resolution
            Services](#name-blocking-of-dns-resolution-){.xref}
            :::

        -   ::: {#section-toc.1-1.6.2.1.2.4}
            [6.1.4](#section-6.1.4){.xref}.  [Encrypted Transports and
            Recursive
            Resolvers](#name-encrypted-transports-and-re){.xref}
            :::
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [In the Authoritative Name
        Servers](#name-in-the-authoritative-name-s){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Other Risks](#name-other-risks){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Re-identification and Other
        Inferences](#name-re-identification-and-other){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [More
        Information](#name-more-information){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Actual
    \"Attacks\"](#name-actual-attacks){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Legalities](#name-legalities){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.12.2.1}
        [12.1](#section-12.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [12.2](#section-12.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [Appendix A](#appendix-A){.xref}.  [Updates since RFC
    7626](#name-updates-since-rfc-7626){.xref}
    :::

-   ::: {#section-toc.1-1.14}
    [](#appendix-B){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.15}
    [](#appendix-C){.xref}[Contributions](#name-contributions){.xref}
    :::

-   ::: {#section-toc.1-1.16}
    [](#appendix-D){.xref}[Author\'s
    Address](#name-authors-address){.xref}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document is an analysis of the DNS privacy issues, in the spirit of
[Section 8](https://www.rfc-editor.org/rfc/rfc6973#section-8){.relref}
of \[[RFC6973](#RFC6973){.xref}\].[¶](#section-1-1){.pilcrow}

The Domain Name System (DNS) is specified in
\[[RFC1034](#RFC1034){.xref}\], \[[RFC1035](#RFC1035){.xref}\], and many
later RFCs, which have never been consolidated. It is one of the most
important infrastructure components of the Internet and is often ignored
or misunderstood by Internet users (and even by many professionals).
Almost every activity on the Internet starts with a DNS query (and often
several). Its use has many privacy implications, and this document is an
attempt at a comprehensive and accurate list.[¶](#section-1-2){.pilcrow}

Let us begin with a simplified reminder of how the DNS works (see also
\[[RFC8499](#RFC8499){.xref}\]). A client, the stub resolver, issues a
DNS query to a server called the recursive resolver (also called caching
resolver, full resolver, or recursive name server). Let\'s use the query
\"What are the AAAA records for www.example.com?\" as an example. AAAA
is the QTYPE (Query Type), and www.example.com is the QNAME (Query
Name). (The description that follows assumes a cold cache, for instance,
because the server just started.) The recursive resolver will first
query the root name servers. In most cases, the root name servers will
send a referral. In this example, the referral will be to the .com name
servers. The resolver repeats the query to one of the .com name servers.
The .com name servers, in turn, will refer to the example.com name
servers. The example.com name servers will then return the answers. The
root name servers, the name servers of .com, and the name servers of
example.com are called authoritative name servers. It is important, when
analyzing the privacy issues, to remember that the question asked to all
these name servers is always the original question, not a derived
question. The question sent to the root name servers is \"What are the
AAAA records for www.example.com?\", not \"What are the name servers of
.com?\". By repeating the full question, instead of just the relevant
part of the question to the next in line, the DNS provides more
information than necessary to the name server. In this simplified
description, recursive resolvers do not implement QNAME minimization as
described in \[[RFC7816](#RFC7816){.xref}\], which will only send the
relevant part of the question to the upstream name
server.[¶](#section-1-3){.pilcrow}

DNS relies heavily on caching, so the algorithm described above is
actually a bit more complicated, and not all questions are sent to the
authoritative name servers. If the stub resolver asks the recursive
resolver a few seconds later, \"What are the SRV records of
\_xmpp-server.\_tcp.example.com?\", the recursive resolver will remember
that it knows the name servers of example.com and will just query them,
bypassing the root and .com. Because there is typically no caching in
the stub resolver, the recursive resolver, unlike the authoritative
servers, sees all the DNS traffic. (Applications, like web browsers, may
have some form of caching that does not follow DNS rules, for instance,
because it may ignore the TTL. So, the recursive resolver does not see
all the name resolution activity.)[¶](#section-1-4){.pilcrow}

It should be noted that DNS recursive resolvers sometimes forward
requests to other recursive resolvers, typically bigger machines, with a
larger and more shared cache (and the query hierarchy can be even
deeper, with more than two levels of recursive resolvers). From the
point of view of privacy, these forwarders are like resolvers except
that they do not see all of the requests being made (due to caching in
the first resolver).[¶](#section-1-5){.pilcrow}

At the time of writing, almost all this DNS traffic is currently sent
unencrypted. However, there is increasing deployment of DNS over TLS
(DoT) \[[RFC7858](#RFC7858){.xref}\] and DNS over HTTPS (DoH)
\[[RFC8484](#RFC8484){.xref}\], particularly in mobile devices,
browsers, and by providers of anycast recursive DNS resolution services.
There are a few cases where there is some alternative channel
encryption, for instance, in an IPsec VPN tunnel, at least between the
stub resolver and the resolver. Some recent analysis on the service
quality of encrypted DNS traffic can be found in
\[[dns-over-encryption](#dns-over-encryption){.xref}\].[¶](#section-1-6){.pilcrow}

Today, almost all DNS queries are sent over UDP
\[[thomas-ditl-tcp](#thomas-ditl-tcp){.xref}\]. This has practical
consequences when considering encryption of the traffic as a possible
privacy technique. Some encryption solutions are only designed for TCP,
not UDP, although new solutions are still emerging
\[[RFC9000](#RFC9000){.xref}\]
\[[DPRIVE-DNSOQUIC](#I-D.ietf-dprive-dnsoquic){.xref}\].[¶](#section-1-7){.pilcrow}

Another important point to keep in mind when analyzing the privacy
issues of DNS is the fact that DNS requests received by a server are
triggered for different reasons. Let\'s assume an eavesdropper wants to
know which web page is viewed by a user. For a typical web page, there
are three sorts of DNS requests being issued:[¶](#section-1-8){.pilcrow}

[]{.break}

Primary request:
:   This is the domain name in the URL that the user typed, selected
    from a bookmark, or chose by clicking on a hyperlink. Presumably,
    this is what is of interest for the
    eavesdropper.[¶](#section-1-9.2){.pilcrow}
:   

Secondary requests:
:   These are the additional requests performed by the user agent (here,
    the web browser) without any direct involvement or knowledge of the
    user. For the Web, they are triggered by embedded content, Cascading
    Style Sheets (CSS), JavaScript code, embedded images, etc. In some
    cases, there can be dozens of domain names in different contexts on
    a single web page.[¶](#section-1-9.4){.pilcrow}
:   

Tertiary requests:
:   These are the additional requests performed by the DNS service
    itself. For instance, if the answer to a query is a referral to a
    set of name servers and the glue records are not returned, the
    resolver will have to send additional requests to turn the name
    servers\' names into IP addresses. Similarly, even if glue records
    are returned, a careful recursive server will send tertiary requests
    to verify the IP addresses of those
    records.[¶](#section-1-9.6){.pilcrow}
:   

It can also be noted that, in the case of a typical web browser, more
DNS requests than strictly necessary are sent, for instance, to prefetch
resources that the user may query later or when autocompleting the URL
in the address bar. Both are a significant privacy concern since they
may leak information even about non-explicit actions. For instance, just
reading a local HTML page, even without selecting the hyperlinks, may
trigger DNS requests.[¶](#section-1-10){.pilcrow}

Privacy-related terminology is from \[[RFC6973](#RFC6973){.xref}\]. This
document obsoletes
\[[RFC7626](#RFC7626){.xref}\].[¶](#section-1-11){.pilcrow}
:::
:::

::: {#scope}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Scope](#name-scope){.section-name .selfRef} {#name-scope}

This document focuses mostly on the study of privacy risks for the end
user (the one performing DNS requests). The risks of pervasive
surveillance \[[RFC7258](#RFC7258){.xref}\] are considered as well as
risks coming from a more focused surveillance. In this document, the
term \"end user\" is used as defined in
\[[RFC8890](#RFC8890){.xref}\].[¶](#section-2-1){.pilcrow}

This document does not attempt a comparison of specific privacy
protections provided by individual networks or organizations; it makes
only general observations about typical current
practices.[¶](#section-2-2){.pilcrow}

Privacy risks for the holder of a zone (the risk that someone gets the
data) are discussed in \[[RFC5155](#RFC5155){.xref}\] and
\[[RFC5936](#RFC5936){.xref}\].[¶](#section-2-3){.pilcrow}

Privacy risks for recursive operators (including access providers and
operators in enterprise networks) such as leakage of private namespaces
or blocklists are out of scope for this
document.[¶](#section-2-4){.pilcrow}

Non-privacy risks (e.g., security-related considerations such as cache
poisoning) are also out of scope.[¶](#section-2-5){.pilcrow}

The privacy risks associated with the use of other protocols that make
use of DNS information are not considered
here.[¶](#section-2-6){.pilcrow}
:::
:::

::: {#risks}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Risks](#name-risks){.section-name .selfRef} {#name-risks}

The following four sections outline the privacy considerations
associated with different aspects of the DNS for the end user. When
reading these sections, it needs to be kept in mind that many of the
considerations (for example, recursive resolver and transport protocol)
can be specific to the network context that a device is using at a given
point in time. A user may have many devices, and each device might
utilize many different networks (e.g., home, work, public, or cellular)
over a period of time or even concurrently. An exhaustive analysis of
the privacy considerations for an individual user would need to take
into account the set of devices used and the multiple dynamic contexts
of each device. This document does not attempt such a complex analysis;
instead, it presents an overview of the various considerations that
could form the basis of such an analysis.[¶](#section-3-1){.pilcrow}
:::
:::

::: {#risks-in-the-dns-data}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Risks in the DNS Data](#name-risks-in-the-dns-data){.section-name .selfRef} {#name-risks-in-the-dns-data}

::: {#the-public-nature-of-dns-data}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [The Public Nature of DNS Data](#name-the-public-nature-of-dns-da){.section-name .selfRef} {#name-the-public-nature-of-dns-da}

It has been stated that \"the data in the DNS is public\". This sentence
makes sense for an Internet-wide lookup system, and there are multiple
facets to the data and metadata involved that deserve a more detailed
look. First, access control lists (ACLs) and private namespaces
notwithstanding, the DNS operates under the assumption that
public-facing authoritative name servers will respond to \"usual\" DNS
queries for any zone they are authoritative for, without further
authentication or authorization of the client (resolver). Due to the
lack of search capabilities, only a given QNAME will reveal the resource
records associated with that name (or that name\'s nonexistence). In
other words: one needs to know what to ask for in order to receive a
response. There are many ways in which supposedly \"private\" resources
currently leak. A few examples are DNSSEC NSEC zone walking
\[[RFC4470](#RFC4470){.xref}\], passive DNS services
\[[passive-dns](#passive-dns){.xref}\], etc. The zone transfer QTYPE
\[[RFC5936](#RFC5936){.xref}\] is often blocked or restricted to
authenticated/authorized access to enforce this difference (and maybe
for other reasons).[¶](#section-4.1-1){.pilcrow}

Another difference between the DNS data and a particular DNS transaction
(i.e., a DNS name lookup): DNS data and the results of a DNS query are
public, within the boundaries described above, and may not have any
confidentiality requirements. However, the same is not true of a single
transaction or a sequence of transactions; those transactions are not /
should not be public. A single transaction reveals both the originator
of the query and the query contents; this potentially leaks sensitive
information about a specific user. A typical example from outside the
DNS world is that the website of Alcoholics Anonymous is public but the
fact that you visit it should not be. Furthermore, the ability to link
queries reveals information about individual use
patterns.[¶](#section-4.1-2){.pilcrow}
:::
:::

::: {#data-in-the-dns-request}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Data in the DNS Request](#name-data-in-the-dns-request){.section-name .selfRef} {#name-data-in-the-dns-request}

The DNS request includes many fields, but two of them seem particularly
relevant for the privacy issues: the QNAME and the source IP address.
\"Source IP address\" is used in a loose sense of \"source IP address +
maybe source port number\", because the port number is also in the
request and can be used to differentiate between several users sharing
an IP address (behind a Carrier-Grade NAT (CGN), for instance
\[[RFC6269](#RFC6269){.xref}\]).[¶](#section-4.2-1){.pilcrow}

The QNAME is the full name sent by the user. It gives information about
what the user does (\"What are the MX records of example.net?\" means
they probably want to send email to someone at example.net, which may be
a domain used by only a few persons and is therefore very revealing
about communication relationships). Some QNAMEs are more sensitive than
others. For instance, querying the A record of a well-known web
statistics domain reveals very little (everybody visits websites that
use this analytics service), but querying the A record of
www.verybad.example where verybad.example is the domain of an
organization that some people find offensive or objectionable may create
more problems for the user. Also, sometimes, the QNAME embeds the
software one uses, which could be a privacy issue (for instance,
\_ldap.\_tcp.Default-First-Site-Name.\_sites.gc.\_msdcs.example.org.
There are also some BitTorrent clients that query an SRV record for
\_bittorrent-tracker.\_tcp.domain.example.[¶](#section-4.2-2){.pilcrow}

Another important thing about the privacy of the QNAME is future usages.
Today, the lack of privacy is an obstacle to putting potentially
sensitive or personally identifiable data in the DNS. At the moment,
your DNS traffic might reveal that you are exchanging emails but not
with whom. If your Mail User Agent (MUA) starts looking up Pretty Good
Privacy (PGP) keys in the DNS \[[RFC7929](#RFC7929){.xref}\], then
privacy becomes a lot more important. And email is just an example;
there would be other really interesting uses for a more privacy-friendly
DNS.[¶](#section-4.2-3){.pilcrow}

For the communication between the stub resolver and the recursive
resolver, the source IP address is the address of the user\'s machine.
Therefore, all the issues and warnings about collection of IP addresses
apply here. For the communication between the recursive resolver and the
authoritative name servers, the source IP address has a different
meaning; it does not have the same status as the source address in an
HTTP connection. It is typically the IP address of the recursive
resolver that, in a way, \"hides\" the real user. However, hiding does
not always work. The edns-client-subnet (ECS) EDNS0 option
\[[RFC7871](#RFC7871){.xref}\] is sometimes used (see one privacy
analysis in
\[[denis-edns-client-subnet](#denis-edns-client-subnet){.xref}\]).
Sometimes the end user has a personal recursive resolver on their
machine. In both cases, the IP address originating queries to the
authoritative server is as sensitive as it is for HTTP
\[[sidn-entrada](#sidn-entrada){.xref}\].[¶](#section-4.2-4){.pilcrow}

A note about IP addresses: there is currently no IETF document that
describes in detail all the privacy issues around IP addressing in
general, although \[[RFC7721](#RFC7721){.xref}\] does discuss privacy
considerations for IPv6 address generation mechanisms. In the meantime,
the discussion here is intended to include both IPv4 and IPv6 source
addresses. For a number of reasons, their assignment and utilization
characteristics are different, which may have implications for details
of information leakage associated with the collection of source
addresses. (For example, a specific IPv6 source address seen on the
public Internet is less likely than an IPv4 address to originate behind
an address-sharing scheme.) However, for both IPv4 and IPv6 addresses,
it is important to note that source addresses are propagated with
queries via the ECS option and comprise metadata about the host, user,
or application that originated them.[¶](#section-4.2-5){.pilcrow}

::: {#data-in-the-dns-payload}
::: {#section-4.2.1 .section}
#### [4.2.1.](#section-4.2.1){.section-number .selfRef} [Data in the DNS Payload](#name-data-in-the-dns-payload){.section-name .selfRef} {#name-data-in-the-dns-payload}

At the time of writing, there are no standardized client identifiers
contained in the DNS payload itself (ECS, as described in
\[[RFC7871](#RFC7871){.xref}\], is widely used; however,
\[[RFC7871](#RFC7871){.xref}\] is only an Informational
RFC).[¶](#section-4.2.1-1){.pilcrow}

DNS Cookies \[[RFC7873](#RFC7873){.xref}\] are a lightweight DNS
transaction security mechanism that provides limited protection against
a variety of increasingly common denial-of-service and
amplification/forgery or cache poisoning attacks by off-path attackers.
It is noted, however, that they are designed to just verify IP addresses
(and should change once a client\'s IP address changes), but they are
not designed to actively track users (like HTTP
cookies).[¶](#section-4.2.1-2){.pilcrow}

There are anecdotal accounts of [Media Access Control (MAC)
addresses](https://lists.dns-oarc.net/pipermail/dns-operations/2016-January/014143.html)
and even user names being inserted in nonstandard EDNS(0) options
\[[RFC6891](#RFC6891){.xref}\] for stub-to-resolver communications to
support proprietary functionality implemented at the resolver (e.g.,
parental filtering).[¶](#section-4.2.1-3){.pilcrow}
:::
:::
:::
:::

::: {#cache-snooping}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Cache Snooping](#name-cache-snooping){.section-name .selfRef} {#name-cache-snooping}

The content of recursive resolvers\' caches can reveal data about the
clients using it (the privacy risks depend on the number of clients).
This information can sometimes be examined by sending DNS queries with
RD=0 to inspect cache content, particularly looking at the DNS TTLs
\[[grangeia.snooping](#grangeia.snooping){.xref}\]. Since this also is a
reconnaissance technique for subsequent cache poisoning attacks, some
countermeasures have already been developed and deployed
\[[cache-snooping-defence](#cache-snooping-defence){.xref}\].[¶](#section-4.3-1){.pilcrow}
:::
:::
:::
:::

::: {#risks-on-the-wire}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Risks on the Wire](#name-risks-on-the-wire){.section-name .selfRef} {#name-risks-on-the-wire}

::: {#unencrypted-transports}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Unencrypted Transports](#name-unencrypted-transports){.section-name .selfRef} {#name-unencrypted-transports}

For unencrypted transports, DNS traffic can be seen by an eavesdropper
like any other traffic. (DNSSEC, specified in
\[[RFC4033](#RFC4033){.xref}\], explicitly excludes confidentiality from
its goals.) So, if an initiator starts an HTTPS communication with a
recipient, the HTTP traffic will be encrypted, but the DNS exchange
prior to it will not be. When other protocols become more and more
privacy aware and secured against surveillance (e.g.,
\[[RFC8446](#RFC8446){.xref}\], \[[RFC9000](#RFC9000){.xref}\]), the use
of unencrypted transports for DNS may become \"the weakest link\" in
privacy. It is noted that, at the time of writing, there is ongoing work
attempting to encrypt the Server Name Identification (SNI) in the TLS
handshake \[[RFC8744](#RFC8744){.xref}\], which is one of the last
remaining non-DNS cleartext identifiers of a connection
target.[¶](#section-5.1-1){.pilcrow}

An important specificity of the DNS traffic is that it may take a
different path than the communication between the initiator and the
recipient. For instance, an eavesdropper may be unable to tap the wire
between the initiator and the recipient but may have access to the wire
going to the recursive resolver or to the authoritative name
servers.[¶](#section-5.1-2){.pilcrow}

The best place to tap, from an eavesdropper\'s point of view, is clearly
between the stub resolvers and the recursive resolvers, because traffic
is not limited by DNS caching.[¶](#section-5.1-3){.pilcrow}

The attack surface between the stub resolver and the rest of the world
can vary widely depending upon how the end user\'s device is configured.
By order of increasing attack surface:[¶](#section-5.1-4){.pilcrow}

-   [The recursive resolver can be on the end user\'s device. In
    (currently) a small number of cases, individuals may choose to
    operate their own DNS resolver on their local machine. In this case,
    the attack surface for the connection between the stub resolver and
    the caching resolver is limited to that single machine. The
    recursive resolver will expose data to authoritative resolvers as
    discussed in [Section
    6.2](#in-the-authoritative-name-servers){.xref}.[¶](#section-5.1-5.1){.pilcrow}]{#section-5.1-5.1}
-   [The recursive resolver may be at the local network edge. For
    many/most enterprise networks and for some residential networks, the
    caching resolver may exist on a server at the edge of the local
    network. In this case, the attack surface is the local network. Note
    that in large enterprise networks, the DNS resolver may not be
    located at the edge of the local network but rather at the edge of
    the overall enterprise network. In this case, the enterprise network
    could be thought of as similar to the Internet Access Provider (IAP)
    network referenced
    below.[¶](#section-5.1-5.2){.pilcrow}]{#section-5.1-5.2}
-   [The recursive resolver can be in the IAP network. For most
    residential networks and potentially other networks, the typical
    case is for the user\'s device to be configured (typically
    automatically through DHCP or relay agent options) with the
    addresses of the DNS proxy in the Customer Premises Equipment (CPE),
    which in turn points to the DNS recursive resolvers at the IAP. The
    attack surface for on-the-wire attacks is therefore from the end
    user system across the local network and across the IAP network to
    the IAP\'s recursive
    resolvers.[¶](#section-5.1-5.3){.pilcrow}]{#section-5.1-5.3}
-   [The recursive resolver can be a public DNS service (or a privately
    run DNS resolver hosted on the public Internet). Some machines may
    be configured to use public DNS resolvers such as those operated by
    Google Public DNS or OpenDNS. The user may have configured their
    machine to use these DNS recursive resolvers themselves \-- or their
    IAP may have chosen to use the public DNS resolvers rather than
    operating their own resolvers. In this case, the attack surface is
    the entire public Internet between the user\'s connection and the
    public DNS service. It can be noted that if the user selects a
    single resolver with a small client population (even when using an
    encrypted transport), it can actually serve to aid tracking of that
    user as they move across network
    environments.[¶](#section-5.1-5.4){.pilcrow}]{#section-5.1-5.4}

It is also noted that, typically, a device connected *only* to a modern
cellular network is[¶](#section-5.1-6){.pilcrow}

-   [directly configured with only the recursive resolvers of the IAP
    and[¶](#section-5.1-7.1){.pilcrow}]{#section-5.1-7.1}

-   ::: {#section-5.1-7.2}
    afforded some level of protection against some types of
    eavesdropping for all traffic (including DNS traffic) due to the
    cellular network link-layer
    encryption.[¶](#section-5.1-7.2.1){.pilcrow}
    :::

The attack surface for this specific scenario is not considered
here.[¶](#section-5.1-8){.pilcrow}
:::
:::

::: {#encrypted-transports}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Encrypted Transports](#name-encrypted-transports){.section-name .selfRef} {#name-encrypted-transports}

The use of encrypted transports directly mitigates passive surveillance
of the DNS payload; however, some privacy attacks are still possible.
This section enumerates the residual privacy risks to an end user when
an attacker can passively monitor encrypted DNS traffic flows on the
wire.[¶](#section-5.2-1){.pilcrow}

These are cases where user identification, fingerprinting, or
correlations may be possible due to the use of certain transport layers
or cleartext/observable features. These issues are not specific to DNS,
but DNS traffic is susceptible to these attacks when using specific
transports.[¶](#section-5.2-2){.pilcrow}

Some general examples exist; for example, certain studies highlight that
the [OS fingerprint values](http://netres.ec/?b=11B99BD) of IPv4 TTL,
IPv6 Hop Limit, or TCP Window size can be used to fingerprint client
OSes or that various techniques can be used to de-NAT DNS queries
\[[dns-de-nat](#dns-de-nat){.xref}\].[¶](#section-5.2-3){.pilcrow}

Note that even when using encrypted transports, the use of cleartext
transport options to decrease latency can provide correlation of a
user\'s connections, e.g., using TCP Fast Open
\[[RFC7413](#RFC7413){.xref}\].[¶](#section-5.2-4){.pilcrow}

Implementations that support encrypted transports also commonly reuse
connections for multiple DNS queries to optimize performance (e.g., via
DNS pipelining or HTTPS multiplexing). Default configuration options for
encrypted transports could, in principle, fingerprint a specific client
application. For example:[¶](#section-5.2-5){.pilcrow}

-   [TLS version or cipher suite
    selection[¶](#section-5.2-6.1){.pilcrow}]{#section-5.2-6.1}
-   [session
    resumption[¶](#section-5.2-6.2){.pilcrow}]{#section-5.2-6.2}
-   [the maximum number of messages to send
    and[¶](#section-5.2-6.3){.pilcrow}]{#section-5.2-6.3}
-   [a maximum connection time before closing a connections and
    reopening.[¶](#section-5.2-6.4){.pilcrow}]{#section-5.2-6.4}

If libraries or applications offer user configuration of such options
(e.g., \[[getdns](#getdns){.xref}\]), then they could, in principle,
help to identify a specific user. Users may want to use only the
defaults to avoid this issue.[¶](#section-5.2-7){.pilcrow}

While there are known attacks on older versions of TLS, the most recent
recommendations \[[RFC7525](#RFC7525){.xref}\] and the development of
TLS 1.3 \[[RFC8446](#RFC8446){.xref}\] largely mitigate
those.[¶](#section-5.2-8){.pilcrow}

Traffic analysis of unpadded encrypted traffic is also possible
\[[pitfalls-of-dns-encryption](#pitfalls-of-dns-encryption){.xref}\]
because the sizes and timing of encrypted DNS requests and responses can
be correlated to unencrypted DNS requests upstream of a recursive
resolver.[¶](#section-5.2-9){.pilcrow}
:::
:::
:::
:::

::: {#risks-in-the-servers}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Risks in the Servers](#name-risks-in-the-servers){.section-name .selfRef} {#name-risks-in-the-servers}

Using the terminology of \[[RFC6973](#RFC6973){.xref}\], the DNS servers
(recursive resolvers and authoritative servers) are enablers: \"they
facilitate communication between an initiator and a recipient without
being directly in the communications path\". As a result, they are often
forgotten in risk analysis. But, to quote \[[RFC6973](#RFC6973){.xref}\]
again, \"Although \[\...\] enablers may not generally be considered as
attackers, they may all pose privacy threats (depending on the context)
because they are able to observe, collect, process, and transfer
privacy-relevant data\". In \[[RFC6973](#RFC6973){.xref}\] parlance,
enablers become observers when they start collecting
data.[¶](#section-6-1){.pilcrow}

Many programs exist to collect and analyze DNS data at the servers \--
from the \"query log\" of some programs like BIND to tcpdump and more
sophisticated programs like PacketQ \[[packetq](#packetq){.xref}\] and
DNSmezzo \[[dnsmezzo](#dnsmezzo){.xref}\]. The organization managing the
DNS server can use this data itself, or it can be part of a surveillance
program like PRISM \[[prism](#prism){.xref}\] and pass data to an
outside observer.[¶](#section-6-2){.pilcrow}

Sometimes this data is kept for a long time and/or distributed to third
parties for research purposes \[[ditl](#ditl){.xref}\]
\[[day-at-root](#day-at-root){.xref}\], security analysis, or
surveillance tasks. These uses are sometimes under some sort of
contract, with various limitations, for instance, on redistribution,
given the sensitive nature of the data. Also, there are observation
points in the network that gather DNS data and then make it accessible
to third parties for research or security purposes (\"passive DNS\"
\[[passive-dns](#passive-dns){.xref}\]).[¶](#section-6-3){.pilcrow}

::: {#in-the-recursive-resolvers}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [In the Recursive Resolvers](#name-in-the-recursive-resolvers){.section-name .selfRef} {#name-in-the-recursive-resolvers}

Recursive resolvers see all the traffic since there is typically no
caching before them. To summarize: your recursive resolver knows a lot
about you. The resolver of a large IAP, or a large public resolver, can
collect data from many users.[¶](#section-6.1-1){.pilcrow}

::: {#resolver-selection}
::: {#section-6.1.1 .section}
#### [6.1.1.](#section-6.1.1){.section-number .selfRef} [Resolver Selection](#name-resolver-selection){.section-name .selfRef} {#name-resolver-selection}

Given all the above considerations, the choice of recursive resolver has
direct privacy considerations for end users. Historically, end user
devices have used the DHCP-provided local network recursive resolver.
The choice by a user to join a particular network (e.g., by physically
plugging in a cable or selecting a network in an OS dialogue) typically
updates a number of system resources \-- these can include IP addresses,
the availability of IPv4/IPv6, DHCP server, and DNS resolver. These
individual changes, including the change in DNS resolver, are not
normally communicated directly to the user by the OS when the network is
joined. The choice of network has historically determined the default
system DNS resolver selection; the two are directly coupled in this
model.[¶](#section-6.1.1-1){.pilcrow}

The vast majority of users do not change their default system DNS
settings and so implicitly accept the network settings for the DNS. The
network resolvers have therefore historically been the sole destination
for all of the DNS queries from a device. These resolvers may have
varied privacy policies depending on the network. Privacy policies for
these servers may or may not be available, and users need to be aware
that privacy guarantees will vary with the
network.[¶](#section-6.1.1-2){.pilcrow}

All major OSes expose the system DNS settings and allow users to
manually override them if desired.[¶](#section-6.1.1-3){.pilcrow}

More recently, some networks and users have actively chosen to use a
large public resolver, e.g., [Google Public
DNS](https://developers.google.com/speed/public-dns),
[Cloudflare](https://developers.cloudflare.com/1.1.1.1/setting-up-1.1.1.1/),
or [Quad9](https://www.quad9.net). There can be many reasons: cost
considerations for network operators, better reliability, or
anti-censorship considerations are just a few. Such services typically
do provide a privacy policy, and the user can get an idea of the data
collected by such operators by reading one, e.g., [Google Public DNS -
Your
Privacy](https://developers.google.com/speed/public-dns/privacy).[¶](#section-6.1.1-4){.pilcrow}

In general, as with many other protocols, issues around centralization
also arise with DNS. The picture is fluid with several competing factors
contributing, where these factors can also vary by geographic region.
These include:[¶](#section-6.1.1-5){.pilcrow}

-   [ISP outsourcing, including to third-party and public
    resolvers[¶](#section-6.1.1-6.1){.pilcrow}]{#section-6.1.1-6.1}
-   [regional market domination by one or only a few
    ISPs[¶](#section-6.1.1-6.2){.pilcrow}]{#section-6.1.1-6.2}
-   [applications directing DNS traffic by default to a limited subset
    of resolvers (see [Section
    6.1.1.2](#applicationspecific-resolver-selection){.xref})[¶](#section-6.1.1-6.3){.pilcrow}]{#section-6.1.1-6.3}

An increased proportion of the global DNS resolution traffic being
served by only a few entities means that the privacy considerations for
users are highly dependent on the privacy policies and practices of
those entities. Many of the issues around centralization are discussed
in
\[[centralisation-and-data-sovereignty](#centralisation-and-data-sovereignty){.xref}\].[¶](#section-6.1.1-7){.pilcrow}

::: {#dynamic-discovery-of-doh-and-strict-dot}
::: {#section-6.1.1.1 .section}
##### [6.1.1.1.](#section-6.1.1.1){.section-number .selfRef} [Dynamic Discovery of DoH and Strict DoT](#name-dynamic-discovery-of-doh-an){.section-name .selfRef} {#name-dynamic-discovery-of-doh-an}

While support for opportunistic DoT can be determined by probing a
resolver on port 853, there is currently no standardized discovery
mechanism for DoH and Strict DoT
servers.[¶](#section-6.1.1.1-1){.pilcrow}

This means that clients that might want to dynamically discover such
encrypted services, and where users are willing to trust such services,
are not able to do so. At the time of writing, efforts to provide
standardized signaling mechanisms to discover the services offered by
local resolvers are in progress
\[[DNSOP-RESOLVER](#I-D.ietf-dnsop-resolver-information){.xref}\]. Note
that an increasing number of ISPs are deploying encrypted DNS; for
example, see the Encrypted DNS Deployment Initiative
\[[EDDI](#EDDI){.xref}\].[¶](#section-6.1.1.1-2){.pilcrow}
:::
:::

::: {#applicationspecific-resolver-selection}
::: {#section-6.1.1.2 .section}
##### [6.1.1.2.](#section-6.1.1.2){.section-number .selfRef} [Application-Specific Resolver Selection](#name-application-specific-resolv){.section-name .selfRef} {#name-application-specific-resolv}

An increasing number of applications are offering application-specific
encrypted DNS resolution settings, rather than defaulting to using only
the system resolver. A variety of heuristics and resolvers are available
in different applications, including hard-coded lists of recognized
DoH/DoT servers.[¶](#section-6.1.1.2-1){.pilcrow}

Generally, users are not aware of application-specific DNS settings and
may not have control over those settings. To address these limitations,
users will only be aware of and have the ability to control such
settings if applications provide the following
functions:[¶](#section-6.1.1.2-2){.pilcrow}

-   [communicate the change clearly to users when the default
    application resolver changes away from the system
    resolver[¶](#section-6.1.1.2-3.1){.pilcrow}]{#section-6.1.1.2-3.1}
-   [provide configuration options to change the default application
    resolver, including a choice to always use the system
    resolver[¶](#section-6.1.1.2-3.2){.pilcrow}]{#section-6.1.1.2-3.2}
-   [provide mechanisms for users to locally inspect, selectively
    forward, and filter queries (either via the application itself or
    use of the system
    resolver)[¶](#section-6.1.1.2-3.3){.pilcrow}]{#section-6.1.1.2-3.3}

Application-specific changes to default destinations for users\' DNS
queries might increase or decrease user privacy; it is highly dependent
on the network context and the application-specific default. This is an
area of active debate, and the IETF is working on a number of issues
related to application-specific DNS
settings.[¶](#section-6.1.1.2-4){.pilcrow}
:::
:::
:::
:::

::: {#active-attacks-on-resolver-configuration}
::: {#section-6.1.2 .section}
#### [6.1.2.](#section-6.1.2){.section-number .selfRef} [Active Attacks on Resolver Configuration](#name-active-attacks-on-resolver-){.section-name .selfRef} {#name-active-attacks-on-resolver-}

The previous section discussed DNS privacy, assuming that all the
traffic was directed to the intended servers (i.e., those that would be
used in the absence of an active attack) and that the potential attacker
was purely passive. But, in reality, there can be active attackers in
the network.[¶](#section-6.1.2-1){.pilcrow}

The Internet Threat model, as described in
\[[RFC3552](#RFC3552){.xref}\], assumes that the attacker controls the
network. Such an attacker can completely control any insecure DNS
resolution, both passively monitoring the queries and responses and
substituting their own responses. Even if encrypted DNS such as DoH or
DoT is used, unless the client has been configured in a secure way with
the server identity, an active attacker can impersonate the server. This
implies that opportunistic modes of DoH/DoT as well as modes where the
client learns of the DoH/DoT server via in-network mechanisms such as
DHCP are vulnerable to attack. In addition, if the client is
compromised, the attacker can replace the DNS configuration with one of
its own choosing.[¶](#section-6.1.2-2){.pilcrow}
:::
:::

::: {#blocking-of-dns-resolution-services}
::: {#section-6.1.3 .section}
#### [6.1.3.](#section-6.1.3){.section-number .selfRef} [Blocking of DNS Resolution Services](#name-blocking-of-dns-resolution-){.section-name .selfRef} {#name-blocking-of-dns-resolution-}

User privacy can also be at risk if there is blocking of access to
remote recursive servers that offer encrypted transports, e.g., when the
local resolver does not offer encryption and/or has very poor privacy
policies. For example, active blocking of port 853 for DoT or blocking
of specific IP addresses could restrict the resolvers available to the
user. The extent of the risk to user privacy is highly dependent on the
specific network and user context; a user on a network that is known to
perform surveillance would be compromised if they could not access such
services, whereas a user on a trusted network might have no privacy
motivation to do so.[¶](#section-6.1.3-1){.pilcrow}

As a matter of policy, some recursive resolvers use their position in
the query path to selectively block access to certain DNS records. This
is a form of rendezvous-based blocking as described in [Section
4.3](https://www.rfc-editor.org/rfc/rfc7754#section-4.3){.relref} of
\[[RFC7754](#RFC7754){.xref}\]. Such blocklists often include servers
known to be used for malware, bots, or other security risks. In order to
prevent circumvention of their blocking policies, some networks also
block access to resolvers with incompatible
policies.[¶](#section-6.1.3-2){.pilcrow}

It is also noted that attacks on remote resolver services, e.g., DDoS,
could force users to switch to other services that do not offer
encrypted transports for DNS.[¶](#section-6.1.3-3){.pilcrow}
:::
:::

::: {#encrypted-transports-and-recursive-resolvers}
::: {#section-6.1.4 .section}
#### [6.1.4.](#section-6.1.4){.section-number .selfRef} [Encrypted Transports and Recursive Resolvers](#name-encrypted-transports-and-re){.section-name .selfRef} {#name-encrypted-transports-and-re}

::: {#dot-and-doh}
::: {#section-6.1.4.1 .section}
##### [6.1.4.1.](#section-6.1.4.1){.section-number .selfRef} [DoT and DoH](#name-dot-and-doh){.section-name .selfRef} {#name-dot-and-doh}

Use of encrypted transports does not reduce the data available in the
recursive resolver and ironically can actually expose more information
about users to operators. As described in [Section
5.2](#encrypted-transports){.xref}, use of session-based encrypted
transports (TCP/TLS) can expose correlation data about
users.[¶](#section-6.1.4.1-1){.pilcrow}
:::
:::

::: {#doh-specific-considerations}
::: {#section-6.1.4.2 .section}
##### [6.1.4.2.](#section-6.1.4.2){.section-number .selfRef} [DoH-Specific Considerations](#name-doh-specific-considerations){.section-name .selfRef} {#name-doh-specific-considerations}

DoH inherits the full privacy properties of the HTTPS stack and as a
consequence introduces new privacy considerations when compared with DNS
over UDP, TCP, or TLS \[[RFC7858](#RFC7858){.xref}\]. [Section
8.2](https://www.rfc-editor.org/rfc/rfc8484#section-8.2){.relref} of
\[[RFC8484](#RFC8484){.xref}\] describes the privacy considerations in
the server of the DoH protocol.[¶](#section-6.1.4.2-1){.pilcrow}

A brief summary of some of the issues includes the
following:[¶](#section-6.1.4.2-2){.pilcrow}

-   [HTTPS presents new considerations for correlation, such as explicit
    HTTP cookies and implicit fingerprinting of the unique set and
    ordering of HTTP request header
    fields.[¶](#section-6.1.4.2-3.1){.pilcrow}]{#section-6.1.4.2-3.1}
-   [The User-Agent and Accept-Language request header fields often
    convey specific information about the client version or
    locale.[¶](#section-6.1.4.2-3.2){.pilcrow}]{#section-6.1.4.2-3.2}
-   [Utilizing the full set of HTTP features enables DoH to be more than
    an HTTP tunnel, but it is at the cost of opening up implementations
    to the full set of privacy considerations of
    HTTP.[¶](#section-6.1.4.2-3.3){.pilcrow}]{#section-6.1.4.2-3.3}
-   [Implementations are advised to expose the minimal set of data
    needed to achieve the desired feature
    set.[¶](#section-6.1.4.2-3.4){.pilcrow}]{#section-6.1.4.2-3.4}

\[[RFC8484](#RFC8484){.xref}\] specifically makes selection of HTTPS
functionality vs. privacy an implementation choice. At the extremes,
there may be implementations that attempt to achieve parity with DoT
from a privacy perspective at the cost of using no identifiable HTTP
headers, and there might be others that provide feature-rich data flows
where the low-level origin of the DNS query is easily identifiable. Some
implementations have, in fact, chosen to restrict the use of the
User-Agent header so that resolver operators cannot identify the
specific application that is originating the DNS
queries.[¶](#section-6.1.4.2-4){.pilcrow}

Privacy-focused users should be aware of the potential for additional
client identifiers in DoH compared to DoT and may want to only use DoH
client implementations that provide clear guidance on what identifiers
they add.[¶](#section-6.1.4.2-5){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#in-the-authoritative-name-servers}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [In the Authoritative Name Servers](#name-in-the-authoritative-name-s){.section-name .selfRef} {#name-in-the-authoritative-name-s}

Unlike what happens for recursive resolvers, the observation
capabilities of authoritative name servers are limited by caching; they
see only the requests for which the answer was not in the cache. For
aggregated statistics (\"What is the percentage of LOC queries?\"), this
is sufficient, but it prevents an observer from seeing everything.
Similarly, the increasing deployment of QNAME minimization
\[[ripe-qname-measurements](#ripe-qname-measurements){.xref}\] reduces
the data visible at the authoritative name server. Still, the
authoritative name servers see a part of the traffic, and this subset
may be sufficient to violate some privacy
expectations.[¶](#section-6.2-1){.pilcrow}

Also, the user often has some legal/contractual link with the recursive
resolver (they have chosen the IAP, or they have chosen to use a given
public resolver) while having no control and perhaps no awareness of the
role of the authoritative name servers and their observation
abilities.[¶](#section-6.2-2){.pilcrow}

As noted before, using a local resolver or a resolver close to the
machine decreases the attack surface for an on-the-wire eavesdropper.
But it may decrease privacy against an observer located on an
authoritative name server. This authoritative name server will see the
IP address of the end client instead of the address of a big recursive
resolver shared by many users.[¶](#section-6.2-3){.pilcrow}

This \"protection\", when using a large resolver with many clients, is
no longer present if ECS \[[RFC7871](#RFC7871){.xref}\] is used because,
in this case, the authoritative name server sees the original IP address
(or prefix, depending on the setup).[¶](#section-6.2-4){.pilcrow}

As of today, all the instances of one root name server, L-root, receive
together around 50,000 queries per second. While most of it is \"junk\"
(errors on the Top-Level Domain (TLD) name), it gives an idea of the
amount of big data that pours into name servers. (And even \"junk\" can
leak information; for instance, if there is a typing error in the TLD,
the user will send data to a TLD that is not the usual
one.)[¶](#section-6.2-5){.pilcrow}

Many domains, including TLDs, are partially hosted by third-party
servers, sometimes in a different country. The contracts between the
domain manager and these servers may or may not take privacy into
account. Whatever the contract, the third-party hoster may or may not be
honest; in any case, it will have to follow its local laws. For example,
requests to a given ccTLD may go to servers managed by organizations
outside of the ccTLD\'s country. Users may not anticipate that when
doing a security analysis.[¶](#section-6.2-6){.pilcrow}

Also, it seems (see the survey described in
\[[aeris-dns](#aeris-dns){.xref}\]) that there is a strong concentration
of authoritative name servers among \"popular\" domains (such as the
Alexa Top N list). For instance, among the [Alexa Top
100K](https://www.alexa.com/topsites), one DNS provider hosts 10% of the
domains today. The ten most important DNS providers together host
one-third of all domains. With the control (or the ability to sniff the
traffic) of a few name servers, you can gather a lot of
information.[¶](#section-6.2-7){.pilcrow}
:::
:::
:::
:::

::: {#other-risks}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Other Risks](#name-other-risks){.section-name .selfRef} {#name-other-risks}

::: {#reidentification-and-other-inferences}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Re-identification and Other Inferences](#name-re-identification-and-other){.section-name .selfRef} {#name-re-identification-and-other}

An observer has access not only to the data they directly collect but
also to the results of various inferences about this data. The term
\"observer\" here is used very generally; for example, the observer
might passively observe cleartext DNS traffic or be in the network that
is actively attacking the user by redirecting DNS resolution, or it
might be a local or remote resolver
operator.[¶](#section-7.1-1){.pilcrow}

For instance, a user can be re-identified via DNS queries. If the
adversary knows a user\'s identity and can watch their DNS queries for a
period, then that same adversary may be able to re-identify the user
solely based on their pattern of DNS queries later on regardless of the
location from which the user makes those queries. For example, one study
\[[herrmann-reidentification](#herrmann-reidentification){.xref}\] found
that such re-identification is possible so that \"73.1% of all
day-to-day links were correctly established, i.e. user u was either
re-identified unambiguously (1) or the classifier correctly reported
that u was not present on day t + 1 any more (2)\". While that study
related to web browsing behavior, equally characteristic patterns may be
produced even in machine-to-machine communications or without a user
taking specific actions, e.g., at reboot time if a characteristic set of
services are accessed by the device.[¶](#section-7.1-2){.pilcrow}

For instance, one could imagine that an intelligence agency identifies
people going to a site by putting in a very long DNS name and looking
for queries of a specific length. Such traffic analysis could weaken
some privacy solutions.[¶](#section-7.1-3){.pilcrow}

The IAB Privacy and Security Program also has a document
\[[RFC7624](#RFC7624){.xref}\] that considers such inference-based
attacks in a more general framework.[¶](#section-7.1-4){.pilcrow}
:::
:::

::: {#more-information}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [More Information](#name-more-information){.section-name .selfRef} {#name-more-information}

Useful background information can also be found in
\[[tor-leak](#tor-leak){.xref}\] (regarding the risk of privacy leaks
through DNS) and in a few academic papers:
\[[yanbin-tsudik](#yanbin-tsudik){.xref}\],
\[[castillo-garcia](#castillo-garcia){.xref}\],
\[[fangming-hori-sakurai](#fangming-hori-sakurai){.xref}\], and
\[[federrath-fuchs-herrmann-piosecny](#federrath-fuchs-herrmann-piosecny){.xref}\].[¶](#section-7.2-1){.pilcrow}
:::
:::
:::
:::

::: {#actual-attacks}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Actual \"Attacks\"](#name-actual-attacks){.section-name .selfRef} {#name-actual-attacks}

A very quick examination of DNS traffic may lead to the false conclusion
that extracting the needle from the haystack is difficult.
\"Interesting\" primary DNS requests are mixed with useless (for the
eavesdropper) secondary and tertiary requests (see the terminology in
[Section 1](#introduction){.xref}). But, in this time of \"big data\"
processing, powerful techniques now exist to get from the raw data to
what the eavesdropper is actually interested
in.[¶](#section-8-1){.pilcrow}

Many research papers about malware detection use DNS traffic to detect
\"abnormal\" behavior that can be traced back to the activity of malware
on infected machines. Yes, this research was done for the greater good,
but technically it is a privacy attack and it demonstrates the power of
the observation of DNS traffic. See
\[[dns-footprint](#dns-footprint){.xref}\],
\[[dagon-malware](#dagon-malware){.xref}\], and
\[[darkreading-dns](#darkreading-dns){.xref}\].[¶](#section-8-2){.pilcrow}

Passive DNS services \[[passive-dns](#passive-dns){.xref}\] allow
reconstruction of the data of sometimes an entire zone. Well-known
passive DNS services keep only the DNS responses and not the source IP
address of the client, precisely for privacy reasons. Other passive DNS
services may not be so careful. And there are still potential problems
with revealing QNAMEs.[¶](#section-8-3){.pilcrow}

The revelations from the Edward Snowden documents, which were leaked
from the National Security Agency (NSA), provide evidence of the use of
the DNS in mass surveillance operations
\[[morecowbell](#morecowbell){.xref}\]. For example, the MORECOWBELL
surveillance program uses a dedicated covert monitoring infrastructure
to actively query DNS servers and perform HTTP requests to obtain
meta-information about services and to check their availability. Also,
the
[QUANTUMTHEORY](https://theintercept.com/document/2014/03/12/nsa-gchqs-quantumtheory-hacking-tactics/)
project, which includes detecting lookups for certain addresses and
injecting bogus replies, is another good example showing that the lack
of privacy protections in the DNS is actively
exploited.[¶](#section-8-4){.pilcrow}
:::
:::

::: {#legalities}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Legalities](#name-legalities){.section-name .selfRef} {#name-legalities}

To our knowledge, there are no specific privacy laws for DNS data in any
country. Interpreting general privacy laws, like the European Union\'s
\[[data-protection-directive](#data-protection-directive){.xref}\] or
[GDPR](https://gdpr.eu/tag/gdpr/), in the context of DNS traffic data is
not an easy task, and there is no known court precedent. See an
interesting analysis in
\[[sidn-entrada](#sidn-entrada){.xref}\].[¶](#section-9-1){.pilcrow}
:::
:::

::: {#security-considerations}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document is entirely about security \-- more precisely, privacy. It
just lays out the problem; it does not try to set requirements (with the
choices and compromises they imply), much less define solutions.
Possible solutions to the issues described here are discussed in other
documents (currently too many to all be mentioned); see, for instance,
\"Recommendations for DNS Privacy Operators\"
\[[RFC8932](#RFC8932){.xref}\].[¶](#section-10-1){.pilcrow}
:::
:::

::: {#iana-considerations}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-11-1){.pilcrow}
:::
:::

::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-12.1 .section}
### [12.1.](#section-12.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC1034\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - concepts and
    facilities\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1034]{.seriesInfo}, [DOI 10.17487/RFC1034]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1034>\>.
:   

\[RFC1035\]
:   [Mockapetris, P.]{.refAuthor}, [\"Domain names - implementation and
    specification\"]{.refTitle}, [STD 13]{.seriesInfo}, [RFC
    1035]{.seriesInfo}, [DOI 10.17487/RFC1035]{.seriesInfo}, November
    1987, \<<https://www.rfc-editor.org/info/rfc1035>\>.
:   

\[RFC6973\]
:   [Cooper, A.]{.refAuthor}, [Tschofenig, H.]{.refAuthor},
    [Aboba, B.]{.refAuthor}, [Peterson, J.]{.refAuthor},
    [Morris, J.]{.refAuthor}, [Hansen, M.]{.refAuthor}, and [R.
    Smith]{.refAuthor}, [\"Privacy Considerations for Internet
    Protocols\"]{.refTitle}, [RFC 6973]{.seriesInfo}, [DOI
    10.17487/RFC6973]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6973>\>.
:   

\[RFC7258\]
:   [Farrell, S.]{.refAuthor} and [H. Tschofenig]{.refAuthor},
    [\"Pervasive Monitoring Is an Attack\"]{.refTitle}, [BCP
    188]{.seriesInfo}, [RFC 7258]{.seriesInfo}, [DOI
    10.17487/RFC7258]{.seriesInfo}, May 2014,
    \<<https://www.rfc-editor.org/info/rfc7258>\>.
:   
:::

::: {#section-12.2 .section}
### [12.2.](#section-12.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[aeris-dns\]
:   [Vinot, N.]{.refAuthor}, [\"Vie privée: et le DNS alors? \[Privacy:
    what about DNS?\]\"]{.refTitle}, February 2015,
    \<<https://blog.imirhil.fr/vie-privee-et-le-dns-alors.html>\>.
:   

\[cache-snooping-defence\]
:   [ISC]{.refAuthor}, [\"DNS Cache snooping - should I be
    concerned?\"]{.refTitle}, October 2018,
    \<<https://kb.isc.org/docs/aa-00482>\>.
:   

\[castillo-garcia\]
:   [Castillo-Perez, S.]{.refAuthor} and [J. Garcia-Alfaro]{.refAuthor},
    [\"Anonymous Resolution of DNS Queries\"]{.refTitle}, [Lecture Notes
    in Computer Science, Vol. 5332]{.refContent}, [DOI
    10.1007/978-3-540-88873-4_5]{.seriesInfo}, 2008,
    \<<https://dl.acm.org/doi/10.1007/978-3-540-88873-4_5>\>.
:   

\[centralisation-and-data-sovereignty\]
:   [De Filippi, P.]{.refAuthor} and [S. McCarthy]{.refAuthor}, [\"Cloud
    Computing: Centralization and Data Sovereignty\"]{.refTitle},
    [European Journal of Law and Technology, Vol. 3, No.
    2]{.refContent}, October 2012,
    \<<https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2167372>\>.
:   

\[dagon-malware\]
:   [Dagon, D.]{.refAuthor}, [\"Corrupted DNS Resolution Paths: The Rise
    of a Malicious Resolution Authority\"]{.refTitle}, [ISC/OARC
    Workshop]{.refContent}, 2007,
    \<<https://www.dns-oarc.net/files/workshop-2007/Dagon-Resolution-corruption.pdf>\>.
:   

\[darkreading-dns\]
:   [Lemos, R.]{.refAuthor}, [\"Got Malware? Three Signs Revealed In DNS
    Traffic\"]{.refTitle}, May 2013,
    \<<https://www.darkreading.com/analytics/security-monitoring/got-malware-three-signs-revealed-in-dns-traffic/d/d-id/1139680>\>.
:   

\[data-protection-directive\]
:   [European Parliament]{.refAuthor}, [\"Directive 95/46/EC of the
    European Parliament and of the Council of 24 October 1995 on the
    protection of individuals with regard to the processing of personal
    data and on the free movement of such data\"]{.refTitle}, [Official
    Journal L 281, pp. 31-50]{.refContent}, November 1995,
    \<<https://eur-lex.europa.eu/LexUriServ/LexUriServ.do?uri=CELEX:31995L0046:EN:HTML>\>.
:   

\[day-at-root\]
:   [Castro, S.]{.refAuthor}, [Wessels, D.]{.refAuthor},
    [Fomenkov, M.]{.refAuthor}, and [K. Claffy]{.refAuthor}, [\"A Day at
    the Root of the Internet\"]{.refTitle}, [ACM SIGCOMM Computer
    Communication Review, Vol. 38, No. 5]{.refContent}, [DOI
    10.1145/1452335.1452341]{.seriesInfo}, October 2008,
    \<<https://www.sigcomm.org/sites/default/files/ccr/papers/2008/October/1452335-1452341.pdf>\>.
:   

\[denis-edns-client-subnet\]
:   [Denis, F.]{.refAuthor}, [\"Security and privacy issues of
    edns-client-subnet\"]{.refTitle}, August 2013,
    \<<https://00f.net/2013/08/07/edns-client-subnet/>\>.
:   

\[ditl\]
:   [CAIDA]{.refAuthor}, [\"A Day in the Life of the Internet
    (DITL)\"]{.refTitle}, \<<https://www.caida.org/projects/ditl/>\>.
:   

\[dns-de-nat\]
:   [Orevi, L.]{.refAuthor}, [Herzberg, A.]{.refAuthor},
    [Zlatokrilov, H.]{.refAuthor}, and [D. Sigron]{.refAuthor},
    [\"DNS-DNS: DNS-based De-NAT Scheme\"]{.refTitle}, January 2017,
    \<<https://www.researchgate.net/publication/320322146_DNS-DNS_DNS-based_De-NAT_Scheme>\>.
:   

\[dns-footprint\]
:   [Stoner, E.]{.refAuthor}, [\"DNS Footprint of Malware\"]{.refTitle},
    [OARC Workshop]{.refContent}, October 2010,
    \<<https://www.dns-oarc.net/files/workshop-201010/OARC-ers-20101012.pdf>\>.
:   

\[dns-over-encryption\]
:   [Lu, C.]{.refAuthor}, [Liu, B.]{.refAuthor}, [Li, Z.]{.refAuthor},
    [Hao, S.]{.refAuthor}, [Duan, H.]{.refAuthor},
    [Zhang, M.]{.refAuthor}, [Leng, C.]{.refAuthor},
    [Liu, Y.]{.refAuthor}, [Zhang, Z.]{.refAuthor}, and [J.
    Wu]{.refAuthor}, [\"An End-to-End, Large-Scale Measurement of
    DNS-over-Encryption: How Far Have We Come?\"]{.refTitle}, [IMC \'19:
    Proceedings of the Internet Measurement Conference, pp.
    22-35]{.refContent}, [DOI 10.1145/3355369.3355580]{.seriesInfo},
    October 2019,
    \<<https://dl.acm.org/citation.cfm?id=3355369.3355580>\>.
:   

\[dnsmezzo\]
:   [Bortzmeyer, S.]{.refAuthor}, [\"DNSmezzo\"]{.refTitle},
    \<<http://www.dnsmezzo.net/>\>.
:   

\[DNSOP-RESOLVER\]
:   [Sood, P.]{.refAuthor}, [Arends, R.]{.refAuthor}, and [P.
    Hoffman]{.refAuthor}, [\"DNS Resolver Information
    Self-publication\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft,
    draft-ietf-dnsop-resolver-information-01]{.seriesInfo}, 11 February
    2020,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-dnsop-resolver-information-01>\>.
:   

\[DPRIVE-DNSOQUIC\]
:   [Huitema, C.]{.refAuthor}, [Dickinson, S.]{.refAuthor}, and [A.
    Mankin]{.refAuthor}, [\"Specification of DNS over Dedicated QUIC
    Connections\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-dprive-dnsoquic-03]{.seriesInfo}, 12
    July 2021,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-dprive-dnsoquic-03>\>.
:   

\[EDDI\]
:   [EDDI]{.refAuthor}, [\"Encrypted DNS Deployment
    Initiative\"]{.refTitle}, \<<https://www.encrypted-dns.org>\>.
:   

\[fangming-hori-sakurai\]
:   [Zhao, F.]{.refAuthor}, [Hori, Y.]{.refAuthor}, and [K.
    Sakurai]{.refAuthor}, [\"Analysis of Privacy Disclosure in DNS
    Query\"]{.refTitle}, [MUE \'07: Proceedings of the 2007
    International Conference on Multimedia and Ubiquitous
    Engineering]{.refContent}, [pp. 952-957]{.refContent}, [DOI
    10.1109/MUE.2007.84]{.seriesInfo}, [ISBN
    0-7695-2777-9]{.seriesInfo}, April 2007,
    \<<https://dl.acm.org/citation.cfm?id=1262690.1262986>\>.
:   

\[federrath-fuchs-herrmann-piosecny\]
:   [Federrath, H.]{.refAuthor}, [Fuchs, K.-P.]{.refAuthor},
    [Herrmann, D.]{.refAuthor}, and [C. Piosecny]{.refAuthor},
    [\"Privacy-Preserving DNS: Analysis of Broadcast, Range Queries and
    Mix-based Protection Methods\"]{.refTitle}, [ESORICS 2011, pp.
    665-683]{.refContent}, [DOI
    10.1007/978-3-642-23822-2_36]{.seriesInfo}, [ISBN
    978-3-642-23822-2]{.seriesInfo}, 2011,
    \<<https://svs.informatik.uni-hamburg.de/publications/2011/2011-09-14_FFHP_PrivacyPreservingDNS_ESORICS2011.pdf>\>.
:   

\[getdns\]
:   [\"getdns\"]{.refTitle}, \<<https://getdnsapi.net>\>.
:   

\[grangeia.snooping\]
:   [Grangeia, L.]{.refAuthor}, [\"Cache Snooping or Snooping the Cache
    for Fun and Profit\"]{.refTitle}, 2005,
    \<<https://www.semanticscholar.org/paper/Cache-Snooping-or-Snooping-the-Cache-for-Fun-and-1-Grangeia/9b22f606e10b3609eafbdcbfc9090b63be8778c3>\>.
:   

\[herrmann-reidentification\]
:   [Herrmann, D.]{.refAuthor}, [Gerber, C.]{.refAuthor},
    [Banse, C.]{.refAuthor}, and [H. Federrath]{.refAuthor},
    [\"Analyzing Characteristic Host Access Patterns for
    Re-Identification of Web User Sessions\"]{.refTitle}, [Lecture Notes
    in Computer Science, Vol. 7127]{.refContent}, [DOI
    10.1007/978-3-642-27937-9_10]{.seriesInfo}, 2012,
    \<<https://epub.uni-regensburg.de/21103/1/Paper_PUL_nordsec_published.pdf>\>.
:   

\[morecowbell\]
:   [Grothoff, C.]{.refAuthor}, [Wachs, M.]{.refAuthor},
    [Ermert, M.]{.refAuthor}, and [J. Appelbaum]{.refAuthor}, [\"NSA\'s
    MORECOWBELL: Knell for DNS\"]{.refTitle}, January 2015,
    \<<https://pdfs.semanticscholar.org/2610/2b99bdd6a258a98740af8217ba8da8a1e4fa.pdf>\>.
:   

\[packetq\]
:   [DNS-OARC]{.refAuthor}, [\"A tool that provides a basic SQL-frontend
    to PCAP-files\"]{.refTitle}, [Release 1.4.3]{.refContent}, [commit
    29a8288]{.refContent}, October 2020,
    \<<https://github.com/DNS-OARC/PacketQ>\>.
:   

\[passive-dns\]
:   [Weimer, F.]{.refAuthor}, [\"Passive DNS Replication\"]{.refTitle},
    [17th Annual FIRST Conference]{.refContent}, April 2005,
    \<<https://www.first.org/conference/2005/papers/florian-weimer-slides-1.pdf>\>.
:   

\[pitfalls-of-dns-encryption\]
:   [Shulman, H.]{.refAuthor}, [\"Pretty Bad Privacy: Pitfalls of DNS
    Encryption\"]{.refTitle}, [WPES \'14: Proceedings of the 13th
    Workshop on Privacy in the Electronic Society, pp.
    191-200]{.refContent}, [DOI 10.1145/2665943.2665959]{.seriesInfo},
    November 2014, \<<https://dl.acm.org/citation.cfm?id=2665959>\>.
:   

\[prism\]
:   [Wikipedia]{.refAuthor}, [\"PRISM (surveillance
    program)\"]{.refTitle}, July 2015,
    \<<https://en.wikipedia.org/w/index.php?title=PRISM_(surveillance_program)&oldid=673789455>\>.
:   

\[RFC3552\]
:   [Rescorla, E.]{.refAuthor} and [B. Korver]{.refAuthor},
    [\"Guidelines for Writing RFC Text on Security
    Considerations\"]{.refTitle}, [BCP 72]{.seriesInfo}, [RFC
    3552]{.seriesInfo}, [DOI 10.17487/RFC3552]{.seriesInfo}, July 2003,
    \<<https://www.rfc-editor.org/info/rfc3552>\>.
:   

\[RFC4033\]
:   [Arends, R.]{.refAuthor}, [Austein, R.]{.refAuthor},
    [Larson, M.]{.refAuthor}, [Massey, D.]{.refAuthor}, and [S.
    Rose]{.refAuthor}, [\"DNS Security Introduction and
    Requirements\"]{.refTitle}, [RFC 4033]{.seriesInfo}, [DOI
    10.17487/RFC4033]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4033>\>.
:   

\[RFC4470\]
:   [Weiler, S.]{.refAuthor} and [J. Ihren]{.refAuthor}, [\"Minimally
    Covering NSEC Records and DNSSEC On-line Signing\"]{.refTitle}, [RFC
    4470]{.seriesInfo}, [DOI 10.17487/RFC4470]{.seriesInfo}, April 2006,
    \<<https://www.rfc-editor.org/info/rfc4470>\>.
:   

\[RFC5155\]
:   [Laurie, B.]{.refAuthor}, [Sisson, G.]{.refAuthor},
    [Arends, R.]{.refAuthor}, and [D. Blacka]{.refAuthor}, [\"DNS
    Security (DNSSEC) Hashed Authenticated Denial of
    Existence\"]{.refTitle}, [RFC 5155]{.seriesInfo}, [DOI
    10.17487/RFC5155]{.seriesInfo}, March 2008,
    \<<https://www.rfc-editor.org/info/rfc5155>\>.
:   

\[RFC5936\]
:   [Lewis, E.]{.refAuthor} and [A. Hoenes, Ed.]{.refAuthor}, [\"DNS
    Zone Transfer Protocol (AXFR)\"]{.refTitle}, [RFC
    5936]{.seriesInfo}, [DOI 10.17487/RFC5936]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5936>\>.
:   

\[RFC6269\]
:   [Ford, M., Ed.]{.refAuthor}, [Boucadair, M.]{.refAuthor},
    [Durand, A.]{.refAuthor}, [Levis, P.]{.refAuthor}, and [P.
    Roberts]{.refAuthor}, [\"Issues with IP Address
    Sharing\"]{.refTitle}, [RFC 6269]{.seriesInfo}, [DOI
    10.17487/RFC6269]{.seriesInfo}, June 2011,
    \<<https://www.rfc-editor.org/info/rfc6269>\>.
:   

\[RFC6891\]
:   [Damas, J.]{.refAuthor}, [Graff, M.]{.refAuthor}, and [P.
    Vixie]{.refAuthor}, [\"Extension Mechanisms for DNS
    (EDNS(0))\"]{.refTitle}, [STD 75]{.seriesInfo}, [RFC
    6891]{.seriesInfo}, [DOI 10.17487/RFC6891]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6891>\>.
:   

\[RFC7413\]
:   [Cheng, Y.]{.refAuthor}, [Chu, J.]{.refAuthor},
    [Radhakrishnan, S.]{.refAuthor}, and [A. Jain]{.refAuthor}, [\"TCP
    Fast Open\"]{.refTitle}, [RFC 7413]{.seriesInfo}, [DOI
    10.17487/RFC7413]{.seriesInfo}, December 2014,
    \<<https://www.rfc-editor.org/info/rfc7413>\>.
:   

\[RFC7525\]
:   [Sheffer, Y.]{.refAuthor}, [Holz, R.]{.refAuthor}, and [P.
    Saint-Andre]{.refAuthor}, [\"Recommendations for Secure Use of
    Transport Layer Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [BCP 195]{.seriesInfo}, [RFC
    7525]{.seriesInfo}, [DOI 10.17487/RFC7525]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7525>\>.
:   

\[RFC7624\]
:   [Barnes, R.]{.refAuthor}, [Schneier, B.]{.refAuthor},
    [Jennings, C.]{.refAuthor}, [Hardie, T.]{.refAuthor},
    [Trammell, B.]{.refAuthor}, [Huitema, C.]{.refAuthor}, and [D.
    Borkmann]{.refAuthor}, [\"Confidentiality in the Face of Pervasive
    Surveillance: A Threat Model and Problem Statement\"]{.refTitle},
    [RFC 7624]{.seriesInfo}, [DOI 10.17487/RFC7624]{.seriesInfo}, August
    2015, \<<https://www.rfc-editor.org/info/rfc7624>\>.
:   

\[RFC7626\]
:   [Bortzmeyer, S.]{.refAuthor}, [\"DNS Privacy
    Considerations\"]{.refTitle}, [RFC 7626]{.seriesInfo}, [DOI
    10.17487/RFC7626]{.seriesInfo}, August 2015,
    \<<https://www.rfc-editor.org/info/rfc7626>\>.
:   

\[RFC7721\]
:   [Cooper, A.]{.refAuthor}, [Gont, F.]{.refAuthor}, and [D.
    Thaler]{.refAuthor}, [\"Security and Privacy Considerations for IPv6
    Address Generation Mechanisms\"]{.refTitle}, [RFC
    7721]{.seriesInfo}, [DOI 10.17487/RFC7721]{.seriesInfo}, March 2016,
    \<<https://www.rfc-editor.org/info/rfc7721>\>.
:   

\[RFC7754\]
:   [Barnes, R.]{.refAuthor}, [Cooper, A.]{.refAuthor},
    [Kolkman, O.]{.refAuthor}, [Thaler, D.]{.refAuthor}, and [E.
    Nordmark]{.refAuthor}, [\"Technical Considerations for Internet
    Service Blocking and Filtering\"]{.refTitle}, [RFC
    7754]{.seriesInfo}, [DOI 10.17487/RFC7754]{.seriesInfo}, March 2016,
    \<<https://www.rfc-editor.org/info/rfc7754>\>.
:   

\[RFC7816\]
:   [Bortzmeyer, S.]{.refAuthor}, [\"DNS Query Name Minimisation to
    Improve Privacy\"]{.refTitle}, [RFC 7816]{.seriesInfo}, [DOI
    10.17487/RFC7816]{.seriesInfo}, March 2016,
    \<<https://www.rfc-editor.org/info/rfc7816>\>.
:   

\[RFC7858\]
:   [Hu, Z.]{.refAuthor}, [Zhu, L.]{.refAuthor},
    [Heidemann, J.]{.refAuthor}, [Mankin, A.]{.refAuthor},
    [Wessels, D.]{.refAuthor}, and [P. Hoffman]{.refAuthor},
    [\"Specification for DNS over Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 7858]{.seriesInfo}, [DOI
    10.17487/RFC7858]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7858>\>.
:   

\[RFC7871\]
:   [Contavalli, C.]{.refAuthor}, [van der Gaast, W.]{.refAuthor},
    [Lawrence, D.]{.refAuthor}, and [W. Kumari]{.refAuthor}, [\"Client
    Subnet in DNS Queries\"]{.refTitle}, [RFC 7871]{.seriesInfo}, [DOI
    10.17487/RFC7871]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7871>\>.
:   

\[RFC7873\]
:   [Eastlake 3rd, D.]{.refAuthor} and [M. Andrews]{.refAuthor},
    [\"Domain Name System (DNS) Cookies\"]{.refTitle}, [RFC
    7873]{.seriesInfo}, [DOI 10.17487/RFC7873]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7873>\>.
:   

\[RFC7929\]
:   [Wouters, P.]{.refAuthor}, [\"DNS-Based Authentication of Named
    Entities (DANE) Bindings for OpenPGP\"]{.refTitle}, [RFC
    7929]{.seriesInfo}, [DOI 10.17487/RFC7929]{.seriesInfo}, August
    2016, \<<https://www.rfc-editor.org/info/rfc7929>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   

\[RFC8484\]
:   [Hoffman, P.]{.refAuthor} and [P. McManus]{.refAuthor}, [\"DNS
    Queries over HTTPS (DoH)\"]{.refTitle}, [RFC 8484]{.seriesInfo},
    [DOI 10.17487/RFC8484]{.seriesInfo}, October 2018,
    \<<https://www.rfc-editor.org/info/rfc8484>\>.
:   

\[RFC8499\]
:   [Hoffman, P.]{.refAuthor}, [Sullivan, A.]{.refAuthor}, and [K.
    Fujiwara]{.refAuthor}, [\"DNS Terminology\"]{.refTitle}, [BCP
    219]{.seriesInfo}, [RFC 8499]{.seriesInfo}, [DOI
    10.17487/RFC8499]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8499>\>.
:   

\[RFC8744\]
:   [Huitema, C.]{.refAuthor}, [\"Issues and Requirements for Server
    Name Identification (SNI) Encryption in TLS\"]{.refTitle}, [RFC
    8744]{.seriesInfo}, [DOI 10.17487/RFC8744]{.seriesInfo}, July 2020,
    \<<https://www.rfc-editor.org/info/rfc8744>\>.
:   

\[RFC8890\]
:   [Nottingham, M.]{.refAuthor}, [\"The Internet is for End
    Users\"]{.refTitle}, [RFC 8890]{.seriesInfo}, [DOI
    10.17487/RFC8890]{.seriesInfo}, August 2020,
    \<<https://www.rfc-editor.org/info/rfc8890>\>.
:   

\[RFC8932\]
:   [Dickinson, S.]{.refAuthor}, [Overeinder, B.]{.refAuthor}, [van
    Rijswijk-Deij, R.]{.refAuthor}, and [A. Mankin]{.refAuthor},
    [\"Recommendations for DNS Privacy Service Operators\"]{.refTitle},
    [BCP 232]{.seriesInfo}, [RFC 8932]{.seriesInfo}, [DOI
    10.17487/RFC8932]{.seriesInfo}, October 2020,
    \<<https://www.rfc-editor.org/info/rfc8932>\>.
:   

\[RFC9000\]
:   [Iyengar, J., Ed.]{.refAuthor} and [M. Thomson, Ed.]{.refAuthor},
    [\"QUIC: A UDP-Based Multiplexed and Secure Transport\"]{.refTitle},
    [RFC 9000]{.seriesInfo}, [DOI 10.17487/RFC9000]{.seriesInfo}, May
    2021, \<<https://www.rfc-editor.org/info/rfc9000>\>.
:   

\[ripe-qname-measurements\]
:   [de Vries, W.]{.refAuthor}, [\"Making the DNS More Private with
    QNAME Minimisation\"]{.refTitle}, April 2019,
    \<<https://labs.ripe.net/Members/wouter_de_vries/make-dns-a-bit-more-private-with-qname-minimisation>\>.
:   

\[sidn-entrada\]
:   [Hesselman, C.]{.refAuthor}, [Jansen, J.]{.refAuthor},
    [Wullink, M.]{.refAuthor}, [Vink, K.]{.refAuthor}, and [M.
    Simon]{.refAuthor}, [\"A privacy framework for \'DNS big data\'
    applications\"]{.refTitle}, November 2014,
    \<<https://www.sidnlabs.nl/downloads/yBW6hBoaSZe4m6GJc_0b7w/2211058ab6330c7f3788141ea19d3db7/SIDN_Labs_Privacyraamwerk_Position_Paper_V1.4_ENG.pdf>\>.
:   

\[thomas-ditl-tcp\]
:   [Thomas, M.]{.refAuthor} and [D. Wessels]{.refAuthor}, [\"An
    Analysis of TCP Traffic in Root Server DITL Data\"]{.refTitle},
    [DNS-OARC 2014 Fall Workshop]{.refContent}, October 2014,
    \<<https://indico.dns-oarc.net/event/20/session/2/contribution/15/material/slides/1.pdf>\>.
:   

\[tor-leak\]
:   [Tor]{.refAuthor}, [\"Tor FAQs: I keep seeing these warnings about
    SOCKS and DNS information leaks. Should I worry?\"]{.refTitle},
    \<<https://www.torproject.org/docs/faq.html.en#WarningsAboutSOCKSandDNSInformationLeaks>\>.
:   

\[yanbin-tsudik\]
:   [Yanbin, L.]{.refAuthor} and [G. Tsudik]{.refAuthor}, [\"Towards
    Plugging Privacy Leaks in Domain Name System\"]{.refTitle}, June
    2010, \<<https://arxiv.org/abs/0910.2472>\>.
:   
:::
:::

::: {#updates-since-rfc7626}
::: {#appendix-A .section}
## [Appendix A.](#appendix-A){.section-number .selfRef} [Updates since RFC 7626](#name-updates-since-rfc-7626){.section-name .selfRef} {#name-updates-since-rfc-7626}

Many references were updated. Discussions of encrypted transports,
including DoT and DoH, and sections on DNS payload, authentication of
servers, and blocking of services were added. With the publishing of
\[[RFC7816](#RFC7816){.xref}\] on QNAME minimization, text, references,
and initial attempts to measure deployment were added to reflect this.
The text and references on the Snowden revelations were
updated.[¶](#appendix-A-1){.pilcrow}

The \"Risks Overview\" section was changed to \"Scope\" to help clarify
the risks being considered. Text on cellular network DNS, blocking, and
security was added. Considerations for recursive resolvers were
collected and placed together. A discussion on resolver selection was
added.[¶](#appendix-A-2){.pilcrow}
:::
:::

::: {#acknowledgments}
::: {#appendix-B .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

Thanks to [Nathalie Boulvard]{.contact-name} and to the CENTR members
for the original work that led to this document. Thanks to [Ondrej
Sury]{.contact-name} for the interesting discussions. Thanks to [Mohsen
Souissi]{.contact-name} and [John Heidemann]{.contact-name} for
proofreading and to [Paul Hoffman]{.contact-name}, [Matthijs
Mekking]{.contact-name}, [Marcos Sanz]{.contact-name}, [Francis
Dupont]{.contact-name}, [Allison Mankin]{.contact-name}, and [Warren
Kumari]{.contact-name} for proofreading, providing technical remarks,
and making many readability improvements. Thanks to [Dan
York]{.contact-name}, [Suzanne Woolf]{.contact-name}, [Tony
Finch]{.contact-name}, [Stephen Farrell]{.contact-name}, [Peter
Koch]{.contact-name}, [Simon Josefsson]{.contact-name}, and [Frank
Denis]{.contact-name} for good written contributions. Thanks to
[Vittorio Bertola]{.contact-name} and [Mohamed Boucadair]{.contact-name}
for a detailed review of the -bis. And thanks to the IESG members for
the last remarks.[¶](#appendix-B-1){.pilcrow}
:::
:::

::: {#contributions}
::: {#appendix-C .section}
## [Contributions](#name-contributions){.section-name .selfRef} {#name-contributions}

[Sara Dickinson]{.contact-name} and [Stephane Bortzmeyer]{.contact-name}
were the original authors of the document, and their contribution to the
initial draft of this document is greatly
appreciated.[¶](#appendix-C-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-D .section}
## [Author\'s Address](#name-authors-address){.section-name .selfRef} {#name-authors-address}

::: {.left dir="auto"}
[Tim Wicinski ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Elkins]{.locality}, [WV]{.region} [26241]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <tjw.ietf@gmail.com>
:::
:::
:::
