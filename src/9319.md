  RFC 9319        RPKI maxLength          October 2022
  --------------- ----------------------- --------------
  Gilad, et al.   Best Current Practice   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9319](https://www.rfc-editor.org/rfc/rfc9319){.eref}

BCP:
:   185

Category:
:   Best Current Practice

Published:
:   October 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    Y. Gilad
    :::

    ::: org
    Hebrew University of Jerusalem
    :::
    :::

    ::: author
    ::: author-name
    S. Goldberg
    :::

    ::: org
    Boston University
    :::
    :::

    ::: author
    ::: author-name
    K. Sriram
    :::

    ::: org
    USA NIST
    :::
    :::

    ::: author
    ::: author-name
    J. Snijders
    :::

    ::: org
    Fastly
    :::
    :::

    ::: author
    ::: author-name
    B. Maddison
    :::

    ::: org
    Workonline Communications
    :::
    :::
:::

# RFC 9319 {#rfcnum}

# The Use of maxLength in the Resource Public Key Infrastructure (RPKI) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document recommends ways to reduce the forged-origin hijack attack
surface by prudently limiting the set of IP prefixes that are included
in a Route Origin Authorization (ROA). One recommendation is to avoid
using the maxLength attribute in ROAs except in some specific cases. The
recommendations complement and extend those in RFC 7115. This document
also discusses the creation of ROAs for facilitating the use of
Distributed Denial of Service (DDoS) mitigation services. Considerations
related to ROAs and RPKI-based Route Origin Validation (RPKI-ROV) in the
context of destination-based Remotely Triggered Discard Route (RTDR)
(elsewhere referred to as \"Remotely Triggered Black Hole\") filtering
are also highlighted.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This memo documents an Internet Best Current
Practice.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on BCPs
is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9319>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.auto .internal
    .xref}.  [Introduction](#name-introduction){.internal .xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.auto .internal
        .xref}.  [Requirements](#name-requirements){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.auto .internal .xref}.  [Documentation
        Prefixes](#name-documentation-prefixes){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.auto .internal .xref}.  [Suggested
    Reading](#name-suggested-reading){.internal .xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.auto .internal .xref}.  [Forged-Origin Sub-Prefix
    Hijack](#name-forged-origin-sub-prefix-hi){.internal .xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.auto .internal .xref}.  [Measurements of the
    RPKI](#name-measurements-of-the-rpki){.internal .xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.auto .internal .xref}.  [Recommendations about
    Minimal ROAs and
    maxLength](#name-recommendations-about-minim){.internal .xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.auto .internal .xref}.  [Facilitating Ad
        Hoc Routing Changes and DDoS
        Mitigation](#name-facilitating-ad-hoc-routing){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.auto .internal .xref}.  [Defensive
        De-aggregation in Response to Prefix
        Hijacks](#name-defensive-de-aggregation-in){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.auto .internal .xref}.  [Considerations for RTDR
    Filtering Scenarios](#name-considerations-for-rtdr-fil){.internal
    .xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.auto .internal .xref}.  [User Interface Design
    Recommendations](#name-user-interface-design-recom){.internal .xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.auto .internal .xref}.  [Operational
    Considerations](#name-operational-considerations){.internal .xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.auto .internal .xref}.  [Security
    Considerations](#name-security-considerations){.internal .xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.auto .internal .xref}. [IANA
    Considerations](#name-iana-considerations){.internal .xref}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.auto .internal
    .xref}. [References](#name-references){.internal .xref}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.auto .internal .xref}.  [Normative
        References](#name-normative-references){.internal .xref}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.auto .internal .xref}.  [Informative
        References](#name-informative-references){.internal .xref}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [](#appendix-A){.auto .internal
    .xref}[Acknowledgments](#name-acknowledgments){.internal .xref}
    :::

-   ::: {#section-toc.1-1.13}
    [](#appendix-B){.auto .internal .xref}[Authors\'
    Addresses](#name-authors-addresses){.internal .xref}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Resource Public Key Infrastructure (RPKI)
\[[RFC6480](#RFC6480){.cite .xref}\] uses Route Origin Authorizations
(ROAs) to create a cryptographically verifiable mapping from an IP
prefix to a set of Autonomous Systems (ASes) that are authorized to
originate that prefix. Each ROA contains a set of IP prefixes and the AS
number of one of the ASes authorized to originate all the IP prefixes in
the set \[[RFC6482](#RFC6482){.cite .xref}\]. The ROA is
cryptographically signed by the party that holds a certificate for the
set of IP prefixes.[¶](#section-1-1){.pilcrow}

The ROA format also supports a maxLength attribute. According to
\[[RFC6482](#RFC6482){.cite .xref}\], \"When present, the maxLength
specifies the maximum length of the IP address prefix that the AS is
authorized to advertise.\" Thus, rather than requiring the ROA to list
each prefix that the AS is authorized to originate, the maxLength
attribute provides a shorthand that authorizes an AS to originate a set
of IP prefixes.[¶](#section-1-2){.pilcrow}

However, measurements of RPKI deployments have found that the use of the
maxLength attribute in ROAs tends to lead to security problems. In
particular, measurements taken in June 2017 showed that of the prefixes
specified in ROAs that use the maxLength attribute, 84% were vulnerable
to a forged-origin sub-prefix hijack \[[GSG17](#GSG17){.cite .xref}\].
The forged-origin prefix or sub-prefix hijack involves inserting the
legitimate AS as specified in the ROA as the origin AS in the AS_PATH;
the hijack can be launched against any IP prefix/sub-prefix that has a
ROA. Consider a prefix/sub-prefix that has a ROA that is unused (i.e.,
not announced in BGP by a legitimate AS). A forged-origin hijack
involving such a prefix/sub-prefix can propagate widely throughout the
Internet. On the other hand, if the prefix/sub-prefix were announced by
the legitimate AS, then the propagation of the forged-origin hijack is
somewhat limited because of its increased AS_PATH length relative to the
legitimate announcement. Of course, forged-origin hijacks are harmful in
both cases, but the extent of harm is greater for unannounced prefixes.
See [Section 3](#hijack){.auto .internal .xref} for detailed
discussion.[¶](#section-1-3){.pilcrow}

For this reason, this document recommends that, whenever possible,
operators [SHOULD]{.bcp14} use \"minimal ROAs\" that authorize only
those IP prefixes that are actually originated in BGP, and no other
prefixes. Further, it recommends ways to reduce the forged-origin attack
surface by prudently limiting the address space that is included in
ROAs. One recommendation is to avoid using the maxLength attribute in
ROAs except in some specific cases. The recommendations complement and
extend those in \[[RFC7115](#RFC7115){.cite .xref}\]. The document also
discusses the creation of ROAs for facilitating the use of DDoS
mitigation services. Considerations related to ROAs and RPKI-ROV in the
context of destination-based Remotely Triggered Discard Route (RTDR)
(elsewhere referred to as \"Remotely Triggered Black Hole\") filtering
are also highlighted.[¶](#section-1-4){.pilcrow}

Please note that the term \"RPKI-based Route Origin Validation\" and the
corresponding acronym \"RPKI-ROV\" that are used in this document mean
the same as the term \"Prefix Origin Validation\" used in
\[[RFC6811](#RFC6811){.cite .xref}\].[¶](#section-1-5){.pilcrow}

One ideal place to implement the ROA-related recommendations is in the
user interfaces for configuring ROAs. Recommendations for implementors
of such user interfaces are provided in [Section 7](#ui){.auto .internal
.xref}.[¶](#section-1-6){.pilcrow}

The practices described in this document require no changes to the RPKI
specifications and will not increase the number of signed ROAs in the
RPKI because ROAs already support lists of IP prefixes
\[[RFC6482](#RFC6482){.cite .xref}\].[¶](#section-1-7){.pilcrow}

::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [Requirements](#name-requirements){.section-name .selfRef} {#name-requirements}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.cite .xref}\]
\[[RFC8174](#RFC8174){.cite .xref}\] when, and only when, they appear in
all capitals, as shown here.[¶](#section-1.1-1){.pilcrow}
:::

::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Documentation Prefixes](#name-documentation-prefixes){.section-name .selfRef} {#name-documentation-prefixes}

The documentation prefixes recommended in \[[RFC5737](#RFC5737){.cite
.xref}\] are insufficient for use as example prefixes in this document.
Therefore, this document uses the address space defined in
\[[RFC1918](#RFC1918){.cite .xref}\] for constructing example
prefixes.[¶](#section-1.2-1){.pilcrow}

Note that although the examples in this document are presented using
IPv4 prefixes, all the analysis thereof and the recommendations made are
equally valid for the equivalent IPv6
cases.[¶](#section-1.2-2){.pilcrow}
:::
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Suggested Reading](#name-suggested-reading){.section-name .selfRef} {#name-suggested-reading}

It is assumed that the reader understands BGP
\[[RFC4271](#RFC4271){.cite .xref}\], RPKI \[[RFC6480](#RFC6480){.cite
.xref}\], ROAs \[[RFC6482](#RFC6482){.cite .xref}\], RPKI-ROV
\[[RFC6811](#RFC6811){.cite .xref}\], and BGPsec
\[[RFC8205](#RFC8205){.cite .xref}\].[¶](#section-2-1){.pilcrow}
:::

::: {#hijack}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Forged-Origin Sub-Prefix Hijack](#name-forged-origin-sub-prefix-hi){.section-name .selfRef} {#name-forged-origin-sub-prefix-hi}

A detailed description and discussion of forged-origin sub-prefix
hijacks are presented here, especially considering the case when the
sub-prefix is not announced in BGP. The forged-origin sub-prefix hijack
is relevant to a scenario in which:[¶](#section-3-1){.pilcrow}

[]{.break}

\(1\)
:   the RPKI \[[RFC6480](#RFC6480){.cite .xref}\] is deployed,
    and[¶](#section-3-2.1){.pilcrow}
:   

\(2\)
:   routers use RPKI-ROV to drop invalid routes
    \[[RFC6811](#RFC6811){.cite .xref}\],
    but[¶](#section-3-2.2){.pilcrow}
:   

\(3\)
:   BGPsec \[[RFC8205](#RFC8205){.cite .xref}\] (or any similar method
    to validate the truthfulness of the BGP AS_PATH attribute) is not
    deployed.[¶](#section-3-2.3){.pilcrow}
:   

Note that this set of assumptions accurately describes a substantial and
growing number of large Internet networks at the time of
writing.[¶](#section-3-3){.pilcrow}

The forged-origin sub-prefix hijack \[[RFC7115](#RFC7115){.cite .xref}\]
\[[GCHSS](#GCHSS){.cite .xref}\] is described here using a running
example.[¶](#section-3-4){.pilcrow}

Consider the IP prefix 192.168.0.0/16, which is allocated to an
organization that also operates AS 64496. In BGP, AS 64496 originates
the IP prefix 192.168.0.0/16 as well as its sub-prefix 192.168.225.0/24.
Therefore, the RPKI should contain a ROA authorizing AS 64496 to
originate these two IP prefixes.[¶](#section-3-5){.pilcrow}

Suppose, however, the organization issues and publishes a ROA including
a maxLength value of 24:[¶](#section-3-6){.pilcrow}

ROA:(192.168.0.0/16-24, AS 64496)[¶](#section-3-7){.pilcrow}

We refer to the above as a \"loose ROA\" since it authorizes AS 64496 to
originate any sub-prefix of 192.168.0.0/16 up to and including length
/24, rather than only those prefixes that are intended to be announced
in BGP.[¶](#section-3-8){.pilcrow}

Because AS 64496 only originates two prefixes in BGP (192.168.0.0/16 and
192.168.225.0/24), all other prefixes authorized by the loose ROA (for
instance, 192.168.0.0/24) are vulnerable to the following forged-origin
sub-prefix hijack \[[RFC7115](#RFC7115){.cite .xref}\]
\[[GCHSS](#GCHSS){.cite .xref}\]:[¶](#section-3-9){.pilcrow}

The hijacker AS 64511 sends a BGP announcement \"192.168.0.0/24: AS
64511, AS 64496\", falsely claiming that AS 64511 is a neighbor of AS
64496 and that AS 64496 originates the IP prefix 192.168.0.0/24. In
fact, the IP prefix 192.168.0.0/24 is not originated by AS
64496.[¶](#section-3-10){.pilcrow}

The hijacker\'s BGP announcement is valid according to the RPKI since
the ROA (192.168.0.0/16-24, AS 64496) authorizes AS 64496 to originate
BGP routes for 192.168.0.0/24.[¶](#section-3-11){.pilcrow}

Because AS 64496 does not actually originate a route for 192.168.0.0/24,
the hijacker\'s route is the only route for 192.168.0.0/24.
Longest-prefix-match routing ensures that the hijacker\'s route to the
sub-prefix 192.168.0.0/24 is always preferred over the legitimate route
to 192.168.0.0/16 originated by AS 64496.[¶](#section-3-12){.pilcrow}

Thus, the hijacker\'s route propagates through the Internet, and traffic
destined for IP addresses in 192.168.0.0/24 will be delivered to the
hijacker.[¶](#section-3-13){.pilcrow}

The forged-origin sub-prefix hijack would have failed if a minimal ROA
as described in [Section 5](#recommendations){.auto .internal .xref} was
used instead of the loose ROA. In this example, a minimal ROA would
be:[¶](#section-3-14){.pilcrow}

ROA:(192.168.0.0/16, 192.168.225.0/24, AS
64496)[¶](#section-3-15){.pilcrow}

This ROA is \"minimal\" because it includes only those IP prefixes that
AS 64496 originates in BGP, but no other IP prefixes
\[[RFC6907](#RFC6907){.cite .xref}\].[¶](#section-3-16){.pilcrow}

The minimal ROA renders AS 64511\'s BGP announcement invalid
because:[¶](#section-3-17){.pilcrow}

[]{.break}

\(1\)
:   this ROA \"covers\" the attacker\'s announcement (since
    192.168.0.0/24 is a sub-prefix of 192.168.0.0/16),
    and[¶](#section-3-18.1){.pilcrow}
:   

\(2\)
:   there is no ROA \"matching\" the attacker\'s announcement (there is
    no ROA for AS 64511 and IP prefix 192.168.0.0/24)
    \[[RFC6811](#RFC6811){.cite .xref}\].[¶](#section-3-18.2){.pilcrow}
:   

If routers ignore invalid BGP announcements, the minimal ROA above
ensures that the sub-prefix hijack will
fail.[¶](#section-3-19){.pilcrow}

Thus, if a minimal ROA had been used, the attacker would be forced to
launch a forged-origin prefix hijack in order to attract traffic as
follows:[¶](#section-3-20){.pilcrow}

The hijacker AS 64511 sends a BGP announcement \"192.168.0.0/16: AS
64511, AS 64496\", falsely claiming that AS 64511 is a neighbor of AS
64496.[¶](#section-3-21){.pilcrow}

This forged-origin prefix hijack is significantly less damaging than the
forged-origin sub-prefix hijack:[¶](#section-3-22){.pilcrow}

AS 64496 legitimately originates 192.168.0.0/16 in BGP, so the hijacker
AS 64511 is not presenting the only route to
192.168.0.0/16.[¶](#section-3-23){.pilcrow}

Moreover, the path originated by AS 64511 is one hop longer than the
path originated by the legitimate origin AS
64496.[¶](#section-3-24){.pilcrow}

As discussed in \[[LSG16](#LSG16){.cite .xref}\], this means that the
hijacker will attract less traffic than it would have in the
forged-origin sub-prefix hijack where the hijacker presents the only
route to the hijacked sub-prefix.[¶](#section-3-25){.pilcrow}

In summary, a forged-origin sub-prefix hijack has the same impact as a
regular sub-prefix hijack, despite the increased AS_PATH length of the
illegitimate route. A forged-origin sub-prefix hijack is also more
damaging than the forged-origin prefix
hijack.[¶](#section-3-26){.pilcrow}
:::
:::

::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Measurements of the RPKI](#name-measurements-of-the-rpki){.section-name .selfRef} {#name-measurements-of-the-rpki}

Network measurements taken in June 2017 showed that 12% of the IP
prefixes authorized in ROAs have a maxLength value longer than their
prefix length. Of these, the vast majority (84%) were non-minimal, as
they included sub-prefixes that are not announced in BGP by the
legitimate AS and were thus vulnerable to forged-origin sub-prefix
hijacks. See \[[GSG17](#GSG17){.cite .xref}\] for
details.[¶](#section-4-1){.pilcrow}

These measurements suggest that operators commonly misconfigure the
maxLength attribute and unwittingly open themselves up to forged-origin
sub-prefix hijacks. That is, they are exposing a much larger attack
surface for forged-origin hijacks than
necessary.[¶](#section-4-2){.pilcrow}
:::

::: {#recommendations}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Recommendations about Minimal ROAs and maxLength](#name-recommendations-about-minim){.section-name .selfRef} {#name-recommendations-about-minim}

Operators [SHOULD]{.bcp14} use minimal ROAs whenever possible. A minimal
ROA contains only those IP prefixes that are actually originated by an
AS in BGP and no other IP prefixes. See [Section 3](#hijack){.auto
.internal .xref} for an example.[¶](#section-5-1){.pilcrow}

In general, operators [SHOULD]{.bcp14} avoid using the maxLength
attribute in their ROAs, since its inclusion will usually make the ROA
non-minimal.[¶](#section-5-2){.pilcrow}

One such exception may be when all more specific prefixes permitted by
the maxLength value are actually announced by the AS in the ROA. Another
exception is where: (a) the maxLength value is substantially larger
compared to the specified prefix length in the ROA, and (b) a large
number of more specific prefixes in that range are announced by the AS
in the ROA. In practice, this case should occur rarely (if at all).
Operator discretion is necessary in this
case.[¶](#section-5-3){.pilcrow}

This practice requires no changes to the RPKI specifications and need
not increase the number of signed ROAs in the RPKI because ROAs already
support lists of IP prefixes \[[RFC6482](#RFC6482){.cite .xref}\]. See
\[[GSG17](#GSG17){.cite .xref}\] for further discussion of why this
practice will have minimal impact on the performance of the RPKI
ecosystem.[¶](#section-5-4){.pilcrow}

Operators that implement these recommendations and have existing ROAs
published in the RPKI system [MUST]{.bcp14} perform a review of such
objects, especially where they make use of the maxLength attribute, to
ensure that the set of included prefixes is \"minimal\" with respect to
the current BGP origination and routing policies. Published ROAs
[MUST]{.bcp14} be replaced as necessary. Such an exercise [MUST]{.bcp14}
be repeated whenever the operator makes changes to either
policy.[¶](#section-5-5){.pilcrow}

::: {#nominimal}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Facilitating Ad Hoc Routing Changes and DDoS Mitigation](#name-facilitating-ad-hoc-routing){.section-name .selfRef} {#name-facilitating-ad-hoc-routing}

Operational requirements may require that a route for an IP prefix be
originated on an ad hoc basis, with little or no prior warning. An
example of such a situation arises when an operator wishes to make use
of DDoS mitigation services that use BGP to redirect traffic via a
\"scrubbing center\".[¶](#section-5.1-1){.pilcrow}

In order to ensure that such ad hoc routing changes are effective, a ROA
validating the new route should exist. However, a difficulty arises due
to the fact that newly created objects in the RPKI are made visible to
relying parties considerably more slowly than routing updates in
BGP.[¶](#section-5.1-2){.pilcrow}

Ideally, it would not be necessary to pre-create the ROA, which
validates the ad hoc route, and instead create it \"on the fly\" as
required. However, this is practical only if the latency imposed by the
propagation of RPKI data is guaranteed to be within acceptable limits in
the circumstances. For time-critical interventions such as responding to
a DDoS attack, this is unlikely to be the
case.[¶](#section-5.1-3){.pilcrow}

Thus, the ROA in question will usually need to be created well in
advance of the routing intervention, but such a ROA will be non-minimal,
since it includes an IP prefix that is sometimes (but not always)
originated in BGP.[¶](#section-5.1-4){.pilcrow}

In this case, the ROA [SHOULD]{.bcp14} only
include:[¶](#section-5.1-5){.pilcrow}

[]{.break}

\(1\)
:   the set of IP prefixes that are always originated in BGP,
    and[¶](#section-5.1-6.1){.pilcrow}
:   

\(2\)
:   the set of IP prefixes that are sometimes, but not always,
    originated in BGP.[¶](#section-5.1-6.2){.pilcrow}
:   

The ROA [SHOULD NOT]{.bcp14} include any IP prefixes that the operator
knows will not be originated in BGP. In general, the ROA [SHOULD
NOT]{.bcp14} make use of the maxLength attribute unless doing so has no
impact on the set of included prefixes.[¶](#section-5.1-7){.pilcrow}

The running example is now extended to illustrate one situation where it
is not possible to issue a minimal ROA.[¶](#section-5.1-8){.pilcrow}

Consider the following scenario prior to the deployment of RPKI. Suppose
AS 64496 announced 192.168.0.0/16 and has a contract with a DDoS
mitigation service provider that holds AS 64500. Further, assume that
the DDoS mitigation service contract applies to all IP addresses covered
by 192.168.0.0/22. When a DDoS attack is detected and reported by AS
64496, AS 64500 immediately originates 192.168.0.0/22, thus attracting
all the DDoS traffic to itself. The traffic is scrubbed at AS 64500 and
then sent back to AS 64496 over a backhaul link. Notice that, during a
DDoS attack, the DDoS mitigation service provider AS 64500 originates a
/22 prefix that is longer than AS 64496\'s /16 prefix, so all the
traffic (destined to addresses in 192.168.0.0/22) that normally goes to
AS 64496 goes to AS 64500 instead. In some deployments, the origination
of the /22 route is performed by AS 64496 and announced only to AS
64500, which then announces transit for that prefix. This variation does
not change the properties considered here.[¶](#section-5.1-9){.pilcrow}

First, suppose the RPKI only had the minimal ROA for AS 64496, as
described in [Section 3](#hijack){.auto .internal .xref}. However, if
there is no ROA authorizing AS 64500 to announce the /22 prefix, then
the DDoS mitigation (and traffic scrubbing) scheme would not work. That
is, if AS 64500 originates the /22 prefix in BGP during DDoS attacks,
the announcement would be invalid \[[RFC6811](#RFC6811){.cite
.xref}\].[¶](#section-5.1-10){.pilcrow}

Therefore, the RPKI should have two ROAs: one for AS 64496 and one for
AS 64500.[¶](#section-5.1-11){.pilcrow}

ROA:(192.168.0.0/16, 192.168.225.0/24, AS
64496)[¶](#section-5.1-12){.pilcrow}

ROA:(192.168.0.0/22, AS 64500)[¶](#section-5.1-13){.pilcrow}

Neither ROA uses the maxLength attribute, but the second ROA is not
\"minimal\" because it contains a /22 prefix that is not originated by
anyone in BGP during normal operations. The /22 prefix is only
originated by AS 64500 as part of its DDoS mitigation service during a
DDoS attack.[¶](#section-5.1-14){.pilcrow}

Notice, however, that this scheme does not come without risks. Namely,
all IP addresses in 192.168.0.0/22 are vulnerable to a forged-origin
sub-prefix hijack during normal operations when the /22 prefix is not
originated. (The hijacker AS 64511 would send the BGP announcement
\"192.168.0.0/22: AS 64511, AS 64500\", falsely claiming that AS 64511
is a neighbor of AS 64500 and falsely claiming that AS 64500 originates
192.168.0.0/22.)[¶](#section-5.1-15){.pilcrow}

In some situations, the DDoS mitigation service at AS 64500 might want
to limit the amount of DDoS traffic that it attracts and scrubs. Suppose
that a DDoS attack only targets IP addresses in 192.168.0.0/24. Then,
the DDoS mitigation service at AS 64500 only wants to attract the
traffic designated for the /24 prefix that is under attack, but not the
entire /22 prefix. To allow for this, the RPKI should have two ROAs: one
for AS 64496 and one for AS 64500.[¶](#section-5.1-16){.pilcrow}

ROA:(192.168.0.0/16, 192.168.225.0/24, AS
64496)[¶](#section-5.1-17){.pilcrow}

ROA:(192.168.0.0/22-24, AS 64500)[¶](#section-5.1-18){.pilcrow}

The second ROA uses the maxLength attribute because it is designed to
explicitly enable AS 64500 to originate any /24 sub-prefix of
192.168.0.0/22.[¶](#section-5.1-19){.pilcrow}

As before, the second ROA is not \"minimal\" because it contains
prefixes that are not originated by anyone in BGP during normal
operations. Also, all IP addresses in 192.168.0.0/22 are vulnerable to a
forged-origin sub-prefix hijack during normal operations when the /22
prefix is not originated.[¶](#section-5.1-20){.pilcrow}

The use of the maxLength attribute in this second ROA also comes with
additional risk. While it permits the DDoS mitigation service at AS
64500 to originate prefix 192.168.0.0/24 during a DDoS attack in that
space, it also makes the other /24 prefixes covered by the /22 prefix
(i.e., 192.168.1.0/24, 192.168.2.0/24, and 192.168.3.0/24) vulnerable to
forged-origin sub-prefix attacks.[¶](#section-5.1-21){.pilcrow}
:::
:::

::: {#deaggr}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Defensive De-aggregation in Response to Prefix Hijacks](#name-defensive-de-aggregation-in){.section-name .selfRef} {#name-defensive-de-aggregation-in}

When responding to certain classes of prefix hijack (in particular, the
forged-origin sub-prefix hijack described above), it may be desirable
for the victim to perform \"defensive de-aggregation\", i.e., to begin
originating more-specific prefixes in order to compete with the hijack
routes for selection as the best path in networks that are not
performing RPKI-ROV \[[RFC6811](#RFC6811){.cite
.xref}\].[¶](#section-5.2-1){.pilcrow}

In topologies where at least one AS on every path between the victim and
hijacker filters RPKI-ROV invalid prefixes, it may be the case that the
existence of a minimal ROA issued by the victim prevents the defensive
more-specific prefixes from being propagated to the networks
topologically close to the attacker, thus hampering the effectiveness of
this response.[¶](#section-5.2-2){.pilcrow}

Nevertheless, this document recommends that, where possible, network
operators publish minimal ROAs even in the face of this risk. This is
because:[¶](#section-5.2-3){.pilcrow}

-   [Minimal ROAs offer the best possible protection against the
    immediate impact of such an attack, rendering the need for such a
    response less
    likely;[¶](#section-5.2-4.1){.pilcrow}]{#section-5.2-4.1}
-   [Increasing RPKI-ROV adoption by network operators will, over time,
    decrease the size of the neighborhoods in which this risk exists;
    and[¶](#section-5.2-4.2){.pilcrow}]{#section-5.2-4.2}
-   [Other methods for reducing the size of such neighborhoods are
    available to potential victims, such as establishing direct External
    BGP (EBGP) adjacencies with networks from whom the defensive routes
    would otherwise be
    hidden.[¶](#section-5.2-4.3){.pilcrow}]{#section-5.2-4.3}
:::
:::
:::
:::

::: {#rtdr}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Considerations for RTDR Filtering Scenarios](#name-considerations-for-rtdr-fil){.section-name .selfRef} {#name-considerations-for-rtdr-fil}

Considerations related to ROAs and RPKI-ROV \[[RFC6811](#RFC6811){.cite
.xref}\] for the case of destination-based RTDR (elsewhere referred to
as \"Remotely Triggered Black Hole\") filtering are addressed here. In
RTDR filtering, highly specific prefixes (greater than /24 in IPv4 and
greater than /48 in IPv6, or possibly even /32 in IPv4 and /128 in IPv6)
are announced in BGP. These announcements are tagged with the well-known
BGP community defined by \[[RFC7999](#RFC7999){.cite .xref}\]. For the
reasons set out above, it is obviously not desirable to use a large
maxLength value or include any such highly specific prefixes in the ROAs
to accommodate destination-based RTDR
filtering.[¶](#section-6-1){.pilcrow}

As a result, RPKI-ROV \[[RFC6811](#RFC6811){.cite .xref}\] is a poor fit
for the validation of RTDR routes. Specification of new procedures to
address this use case through the use of the RPKI is outside the scope
of this document.[¶](#section-6-2){.pilcrow}

Therefore:[¶](#section-6-3){.pilcrow}

-   [Operators [SHOULD NOT]{.bcp14} create non-minimal ROAs (by either
    creating additional ROAs or using the maxLength attribute) for the
    purpose of advertising RTDR routes;
    and[¶](#section-6-4.1){.pilcrow}]{#section-6-4.1}
-   [Operators providing a means for operators of neighboring autonomous
    systems to advertise RTDR routes via BGP [MUST NOT]{.bcp14} make the
    creation of non-minimal ROAs a pre-requisite for its
    use.[¶](#section-6-4.2){.pilcrow}]{#section-6-4.2}
:::
:::

::: {#ui}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [User Interface Design Recommendations](#name-user-interface-design-recom){.section-name .selfRef} {#name-user-interface-design-recom}

Most operator interaction with the RPKI system when creating or
modifying ROAs will occur via a user interface that abstracts the
underlying encoding, signing, and publishing
operations.[¶](#section-7-1){.pilcrow}

This document recommends that designers and/or providers of such user
interfaces [SHOULD]{.bcp14} provide warnings to draw the user\'s
attention to the risks of creating non-minimal ROAs in general and using
the maxLength attribute in particular.[¶](#section-7-2){.pilcrow}

Warnings provided by such a system may vary in nature from generic
warnings based purely on the inclusion of the maxLength attribute to
customised guidance based on the observable BGP routing policy of the
operator in question. The choices made in this respect are expected to
be dependent on the target user audience of the
implementation.[¶](#section-7-3){.pilcrow}
:::
:::

::: {#operational-considerations}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Operational Considerations](#name-operational-considerations){.section-name .selfRef} {#name-operational-considerations}

The recommendations specified in this document (in particular, those in
[Section 5](#recommendations){.auto .internal .xref}) involve trade-offs
between operational agility and security.[¶](#section-8-1){.pilcrow}

Operators adopting the recommended practice of issuing minimal ROAs
will, by definition, need to make changes to their existing set of
issued ROAs in order to effect changes to the set of prefixes that are
originated in BGP.[¶](#section-8-2){.pilcrow}

Even in the case of routing changes that are planned in advance,
existing procedures may need to be updated to incorporate changes to
issued ROAs and may require additional time allowed for those changes to
propagate.[¶](#section-8-3){.pilcrow}

Operators are encouraged to carefully review the issues highlighted
(especially those in Sections [5.1](#nominimal){.auto .internal .xref}
and [5.2](#deaggr){.auto .internal .xref}) in light of their specific
operational requirements. Failure to do so could, in the worst case,
result in a self-inflicted denial of service.[¶](#section-8-4){.pilcrow}

The recommendations made in [Section 5](#recommendations){.auto
.internal .xref} are likely to be more onerous for operators utilising
large IP address space allocations from which many more-specific
advertisements are made in BGP. Operators of such networks are
encouraged to seek opportunities to automate the required procedures in
order to minimise manual operational burden.[¶](#section-8-5){.pilcrow}
:::
:::

::: {#security-considerations}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

This document makes recommendations regarding the use of RPKI-ROV as
defined in \[[RFC6811](#RFC6811){.cite .xref}\] and, as such, introduces
no additional security considerations beyond those specified
therein.[¶](#section-9-1){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-10-1){.pilcrow}
:::
:::

::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC1918\]
:   [Rekhter, Y.]{.refAuthor}, [Moskowitz, B.]{.refAuthor},
    [Karrenberg, D.]{.refAuthor}, [de Groot, G. J.]{.refAuthor}, and [E.
    Lear]{.refAuthor}, [\"Address Allocation for Private
    Internets\"]{.refTitle}, [BCP 5]{.seriesInfo}, [RFC
    1918]{.seriesInfo}, [DOI 10.17487/RFC1918]{.seriesInfo}, February
    1996, \<<https://www.rfc-editor.org/info/rfc1918>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4271\]
:   [Rekhter, Y., Ed.]{.refAuthor}, [Li, T., Ed.]{.refAuthor}, and [S.
    Hares, Ed.]{.refAuthor}, [\"A Border Gateway Protocol 4
    (BGP-4)\"]{.refTitle}, [RFC 4271]{.seriesInfo}, [DOI
    10.17487/RFC4271]{.seriesInfo}, January 2006,
    \<<https://www.rfc-editor.org/info/rfc4271>\>.
:   

\[RFC6480\]
:   [Lepinski, M.]{.refAuthor} and [S. Kent]{.refAuthor}, [\"An
    Infrastructure to Support Secure Internet Routing\"]{.refTitle},
    [RFC 6480]{.seriesInfo}, [DOI 10.17487/RFC6480]{.seriesInfo},
    February 2012, \<<https://www.rfc-editor.org/info/rfc6480>\>.
:   

\[RFC6482\]
:   [Lepinski, M.]{.refAuthor}, [Kent, S.]{.refAuthor}, and [D.
    Kong]{.refAuthor}, [\"A Profile for Route Origin Authorizations
    (ROAs)\"]{.refTitle}, [RFC 6482]{.seriesInfo}, [DOI
    10.17487/RFC6482]{.seriesInfo}, February 2012,
    \<<https://www.rfc-editor.org/info/rfc6482>\>.
:   

\[RFC6811\]
:   [Mohapatra, P.]{.refAuthor}, [Scudder, J.]{.refAuthor},
    [Ward, D.]{.refAuthor}, [Bush, R.]{.refAuthor}, and [R.
    Austein]{.refAuthor}, [\"BGP Prefix Origin Validation\"]{.refTitle},
    [RFC 6811]{.seriesInfo}, [DOI 10.17487/RFC6811]{.seriesInfo},
    January 2013, \<<https://www.rfc-editor.org/info/rfc6811>\>.
:   

\[RFC7115\]
:   [Bush, R.]{.refAuthor}, [\"Origin Validation Operation Based on the
    Resource Public Key Infrastructure (RPKI)\"]{.refTitle}, [BCP
    185]{.seriesInfo}, [RFC 7115]{.seriesInfo}, [DOI
    10.17487/RFC7115]{.seriesInfo}, January 2014,
    \<<https://www.rfc-editor.org/info/rfc7115>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[GCHSS\]
:   [Gilad, Y.]{.refAuthor}, [Cohen, A.]{.refAuthor},
    [Herzberg, A.]{.refAuthor}, [Schapira, M.]{.refAuthor}, and [H.
    Shulman]{.refAuthor}, [\"Are We There Yet? On RPKI\'s Deployment and
    Security\"]{.refTitle}, [NDSS 2017]{.refContent}, February 2017,
    \<<https://eprint.iacr.org/2016/1010.pdf>\>.
:   

\[GSG17\]
:   [Gilad, Y.]{.refAuthor}, [Sagga, O.]{.refAuthor}, and [S.
    Goldberg]{.refAuthor}, [\"MaxLength Considered Harmful to the
    RPKI\"]{.refTitle}, [CoNEXT \'17]{.refContent}, [DOI
    10.1145/3143361.3143363]{.seriesInfo}, December 2017,
    \<<https://eprint.iacr.org/2016/1015.pdf>\>.
:   

\[LSG16\]
:   [Lychev, R.]{.refAuthor}, [Shapira, M.]{.refAuthor}, and [S.
    Goldberg]{.refAuthor}, [\"Rethinking security for internet
    routing\"]{.refTitle}, [Communications of the ACM]{.refContent},
    [DOI 10.1145/2896817]{.seriesInfo}, October 2016,
    \<[http://cacm.acm.org/magazines/2016/10/207763-rethinking-security-for-internet-routing/](https://cacm.acm.org/magazines/2016/10/207763-rethinking-security-for-internet-routing/)\>.
:   

\[RFC5737\]
:   [Arkko, J.]{.refAuthor}, [Cotton, M.]{.refAuthor}, and [L.
    Vegoda]{.refAuthor}, [\"IPv4 Address Blocks Reserved for
    Documentation\"]{.refTitle}, [RFC 5737]{.seriesInfo}, [DOI
    10.17487/RFC5737]{.seriesInfo}, January 2010,
    \<<https://www.rfc-editor.org/info/rfc5737>\>.
:   

\[RFC6907\]
:   [Manderson, T.]{.refAuthor}, [Sriram, K.]{.refAuthor}, and [R.
    White]{.refAuthor}, [\"Use Cases and Interpretations of Resource
    Public Key Infrastructure (RPKI) Objects for Issuers and Relying
    Parties\"]{.refTitle}, [RFC 6907]{.seriesInfo}, [DOI
    10.17487/RFC6907]{.seriesInfo}, March 2013,
    \<<https://www.rfc-editor.org/info/rfc6907>\>.
:   

\[RFC7999\]
:   [King, T.]{.refAuthor}, [Dietzel, C.]{.refAuthor},
    [Snijders, J.]{.refAuthor}, [Doering, G.]{.refAuthor}, and [G.
    Hankins]{.refAuthor}, [\"BLACKHOLE Community\"]{.refTitle}, [RFC
    7999]{.seriesInfo}, [DOI 10.17487/RFC7999]{.seriesInfo}, October
    2016, \<<https://www.rfc-editor.org/info/rfc7999>\>.
:   

\[RFC8205\]
:   [Lepinski, M., Ed.]{.refAuthor} and [K. Sriram, Ed.]{.refAuthor},
    [\"BGPsec Protocol Specification\"]{.refTitle}, [RFC
    8205]{.seriesInfo}, [DOI 10.17487/RFC8205]{.seriesInfo}, September
    2017, \<<https://www.rfc-editor.org/info/rfc8205>\>.
:   
:::
:::

::: {#Acknowledgments}
::: {#appendix-A .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors would like to thank the following people for their review
and contributions to this document: [Omar Sagga]{.contact-name} and
[Aris Lambrianidis]{.contact-name}. Thanks are also due to [Matthias
Waehlisch]{.contact-name}, [Ties de Kock]{.contact-name}, [Amreesh
Phokeer]{.contact-name}, [Éric Vyncke]{.contact-name}, [Alvaro
Retana]{.contact-name}, [John Scudder]{.contact-name}, [Roman
Danyliw]{.contact-name}, [Andrew Alston]{.contact-name}, and [Murray
Kucherawy]{.contact-name} for comments and suggestions, to [Roni
Even]{.contact-name} for the Gen-ART review, to [Jean
Mahoney]{.contact-name} for the ART-ART review, to [Acee
Lindem]{.contact-name} for the Routing Area Directorate review, and to
[Sean Turner]{.contact-name} for the Security Area Directorate
review.[¶](#appendix-A-1){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Yossi Gilad]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Hebrew University of Jerusalem]{.org}
:::

::: {.left dir="auto"}
[Rothburg Family Buildings]{.extended-address}
:::

::: {.left dir="auto"}
[Edmond J. Safra Campus]{.street-address}
:::

::: {.left dir="auto"}
[Jerusalem]{.locality} [9190416]{.postal-code}
:::

::: {.left dir="auto"}
[Israel]{.country-name}
:::

::: email
Email: <yossigi@cs.huji.ac.il>
:::

::: {.left dir="auto"}
[Sharon Goldberg]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Boston University]{.org}
:::

::: {.left dir="auto"}
[111 Cummington St, MCS135]{.street-address}
:::

::: {.left dir="auto"}
[Boston]{.locality}, [MA]{.region} [02215]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <goldbe@cs.bu.edu>
:::

::: {.left dir="auto"}
[Kotikalapudi Sriram]{.fn .nameRole}
:::

::: {.left dir="auto"}
[USA National Institute of Standards and Technology]{.org}
:::

::: {.left dir="auto"}
[100 Bureau Drive]{.street-address}
:::

::: {.left dir="auto"}
[Gaithersburg]{.locality}, [MD]{.region} [20899]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <kotikalapudi.sriram@nist.gov>
:::

::: {.left dir="auto"}
[Job Snijders]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Fastly]{.org}
:::

::: {.left dir="auto"}
[Amsterdam]{.locality}
:::

::: {.left dir="auto"}
[Netherlands]{.country-name}
:::

::: email
Email: <job@fastly.com>
:::

::: {.left dir="auto"}
[Ben Maddison]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Workonline Communications]{.org}
:::

::: {.left dir="auto"}
[114 West St]{.street-address}
:::

::: {.left dir="auto"}
[Johannesburg]{.locality}
:::

::: {.left dir="auto"}
[2196]{.postal-code}
:::

::: {.left dir="auto"}
[South Africa]{.country-name}
:::

::: email
Email: <benm@workonline.africa>
:::
:::
:::
