  RFC 9133            DOTS Signal Filter Control   September 2021
  ------------------- ---------------------------- ----------------
  Nishizuka, et al.   Standards Track              \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9133](https://www.rfc-editor.org/rfc/rfc9133){.eref}

Category:
:   Standards Track

Published:
:   September 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    K. Nishizuka
    :::

    ::: org
    NTT Communications
    :::
    :::

    ::: author
    ::: author-name
    M. Boucadair
    :::

    ::: org
    Orange
    :::
    :::

    ::: author
    ::: author-name
    T. Reddy.K
    :::

    ::: org
    Akamai
    :::
    :::

    ::: author
    ::: author-name
    T. Nagata
    :::

    ::: org
    Lepidum
    :::
    :::
:::

# RFC 9133 {#rfcnum}

# Controlling Filtering Rules Using Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies an extension to the Distributed
Denial-of-Service Open Threat Signaling (DOTS) signal channel protocol
so that DOTS clients can control their filtering rules when an attack
mitigation is active.[¶](#section-abstract-1){.pilcrow}

Particularly, this extension allows a DOTS client to activate or
deactivate existing filtering rules during a Distributed
Denial-of-Service (DDoS) attack. The characterization of these filtering
rules is conveyed by a DOTS client during an \'idle\' time (i.e., no
mitigation is active) by means of the DOTS data channel
protocol.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9133>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}

    -   ::: {#section-toc.1-1.1.2.1}
        [1.1](#section-1.1){.xref}.  [The
        Problem](#name-the-problem){.xref}
        :::

    -   ::: {#section-toc.1-1.1.2.2}
        [1.2](#section-1.2){.xref}.  [Controlling Filtering Rules Using
        DOTS Signal Channel](#name-controlling-filtering-rules){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Controlling Filtering Rules of a DOTS
    Client](#name-controlling-filtering-rules-){.xref}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Binding DOTS Data and Signal
        Channels](#name-binding-dots-data-and-signa){.xref}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [DOTS Signal Channel
        Extension](#name-dots-signal-channel-extensi){.xref}

        -   ::: {#section-toc.1-1.3.2.2.2.1}
            [3.2.1](#section-3.2.1){.xref}.  [Parameters and
            Behaviors](#name-parameters-and-behaviors){.xref}
            :::

        -   ::: {#section-toc.1-1.3.2.2.2.2}
            [3.2.2](#section-3.2.2){.xref}.  [DOTS Signal Filtering
            Control Module](#name-dots-signal-filtering-contr){.xref}

            -   ::: {#section-toc.1-1.3.2.2.2.2.2.1}
                [3.2.2.1](#section-3.2.2.1){.xref}.  [Tree
                Structure](#name-tree-structure){.xref}
                :::

            -   ::: {#section-toc.1-1.3.2.2.2.2.2.2}
                [3.2.2.2](#section-3.2.2.2){.xref}.  [YANG
                Module](#name-yang-module){.xref}
                :::
            :::
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Some Examples](#name-some-examples){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Conflict
        Handling](#name-conflict-handling){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [On-Demand Activation of an
        Accept-List Filter](#name-on-demand-activation-of-an-){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [DOTS Servers/Mitigators Lacking
        Capacity](#name-dots-servers-mitigators-lac){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [DOTS Signal Channel CBOR Key
        Values Subregistry](#name-dots-signal-channel-cbor-ke){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [A New YANG
        Module](#name-a-new-yang-module){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [](#appendix-A){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [](#appendix-B){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

::: {#problem}
::: {#section-1.1 .section}
### [1.1.](#section-1.1){.section-number .selfRef} [The Problem](#name-the-problem){.section-name .selfRef} {#name-the-problem}

In the Distributed Denial-of-Service Open Threat Signaling (DOTS)
architecture \[[RFC8811](#RFC8811){.xref}\], DOTS clients and servers
communicate using both a signal channel protocol
\[[RFC9132](#RFC9132){.xref}\] and a data channel protocol
\[[RFC8783](#RFC8783){.xref}\].[¶](#section-1.1-1){.pilcrow}

The DOTS data channel protocol \[[RFC8783](#RFC8783){.xref}\] is used
for bulk data exchange between DOTS agents to improve the coordination
of parties involved in the response to a Distributed Denial-of-Service
(DDoS) attack. Filter management, which is one of the tasks of the DOTS
data channel protocol, enables a DOTS client to retrieve the filtering
capabilities of a DOTS server and to manage filtering rules. Typically,
these filtering rules are used for dropping or rate-limiting unwanted
traffic, and permitting accept-listed
traffic.[¶](#section-1.1-2){.pilcrow}

The DOTS signal channel protocol \[[RFC9132](#RFC9132){.xref}\] is
designed to be resilient under extremely hostile network conditions and
provides continued contact between DOTS agents even as DDoS attack
traffic saturates the link. The DOTS signal channel can be established
between two DOTS agents prior to or during an attack. At any time, the
DOTS client may send mitigation requests (as per [Section
4.4](https://www.rfc-editor.org/rfc/rfc9132#section-4.4){.relref} of
\[[RFC9132](#RFC9132){.xref}\]) to a DOTS server over the active signal
channel. While mitigation is active, the DOTS server periodically sends
status messages to the DOTS client, including basic mitigation feedback
details. In case of a massive DDoS attack that saturates the incoming
link(s) to the DOTS client, all traffic from the DOTS server to the DOTS
client will likely be dropped. However, the DOTS server may still
receive DOTS messages sent from the DOTS client over the signaling
channel thanks to the heartbeat requests keeping the channel active (as
described in [Section
4.7](https://www.rfc-editor.org/rfc/rfc9132#section-4.7){.relref} of
\[[RFC9132](#RFC9132){.xref}\]).[¶](#section-1.1-3){.pilcrow}

Unlike the DOTS signal channel protocol, the DOTS data channel protocol
is not expected to deal with attack conditions. As such, an issue that
might be encountered in some deployments is when filters installed by
means of the DOTS data channel protocol may not function as expected
during DDoS attacks or, worse, exacerbate an ongoing DDoS attack. In
such conditions, the DOTS data channel protocol cannot be used to change
these filters, which may complicate DDoS mitigation operations
\[[INTEROP](#INTEROP){.xref}\].[¶](#section-1.1-4){.pilcrow}

A typical case is a conflict between filtering rules installed by a DOTS
client and the mitigation actions of a DDoS mitigator. Consider, for
instance, a DOTS client that configures during \'idle\' time (i.e., no
mitigation is active) some filtering rules using the DOTS data channel
protocol to permit traffic from accept-listed sources. However, during a
volumetric DDoS attack, the DDoS mitigator identifies the source
addresses/prefixes in the accept-listed filtering rules are attacking
the target. For example, an attacker can spoof the IP addresses of
accept-listed sources to generate attack traffic, or the attacker can
compromise the accept-listed sources and program them to launch a DDoS
attack.[¶](#section-1.1-5){.pilcrow}

\[[RFC9132](#RFC9132){.xref}\] is designed so that the DDoS server
notifies the above conflict to the DOTS client (that is, the
\'conflict-cause\' parameter is set to 2 (conflict-with-acceptlist)),
but the DOTS client may not be able to withdraw the accept-list rules
during the attack period due to the high-volume attack traffic
saturating the inbound link to the DOTS client domain. In other words,
the DOTS client cannot use the DOTS data channel protocol to withdraw
the accept-list filters when a DDoS attack is in
progress.[¶](#section-1.1-6){.pilcrow}
:::
:::

::: {#sol}
::: {#section-1.2 .section}
### [1.2.](#section-1.2){.section-number .selfRef} [Controlling Filtering Rules Using DOTS Signal Channel](#name-controlling-filtering-rules){.section-name .selfRef} {#name-controlling-filtering-rules}

This specification addresses the problems discussed in [Section
1.1](#problem){.xref} by adding a capability for managing filtering
rules using the DOTS signal channel protocol, which enables a DOTS
client to request the activation (or deactivation) of filtering rules
during a DDoS attack. Note that creating these filtering rules is still
the responsibility of the DOTS data channel
\[[RFC8783](#RFC8783){.xref}\].[¶](#section-1.2-1){.pilcrow}

The DOTS signal channel protocol is designed to enable a DOTS client to
contact a DOTS server for help even under severe network congestion
conditions. Therefore, extending the DOTS signal channel protocol to
manage the filtering rules during an attack will enhance the protection
capability offered by DOTS protocols.[¶](#section-1.2-2){.pilcrow}

Note: The experiment at the IETF 103 hackathon
\[[INTEROP](#INTEROP){.xref}\] showed that even when the inbound link is
saturated by DDoS attack traffic, the DOTS client can signal mitigation
requests using the DOTS signal channel over the saturated
link.[¶](#section-1.2-3.1){.pilcrow}

Conflicts that are induced by filters installed by other DOTS clients of
the same domain are not discussed in this
specification.[¶](#section-1.2-4){.pilcrow}

An augmentation to the DOTS signal channel YANG module is defined in
[Section 3.2.2](#YANG){.xref}.[¶](#section-1.2-5){.pilcrow}

Sample examples are provided in [Section 4](#sample){.xref}, in
particular:[¶](#section-1.2-6){.pilcrow}

-   [[Section 4.1](#sample1){.xref} illustrates how the filter control
    extension is used when conflicts with Access Control Lists (ACLs)
    are detected and reported by a DOTS
    server.[¶](#section-1.2-7.1){.pilcrow}]{#section-1.2-7.1}
-   [[Section 4.2](#sample2){.xref} shows how a DOTS client can instruct
    a DOTS server to safely forward some specific traffic in \'attack\'
    time.[¶](#section-1.2-7.2){.pilcrow}]{#section-1.2-7.2}
-   [[Section 4.3](#sample3){.xref} shows how a DOTS client can react if
    the DDoS traffic is still being forwarded to the DOTS client domain
    even if mitigation requests were sent to a DOTS
    server.[¶](#section-1.2-7.3){.pilcrow}]{#section-1.2-7.3}

The JavaScript Object Notation (JSON) encoding of YANG-modeled data
\[[RFC7951](#RFC7951){.xref}\] is used to illustrate the
examples.[¶](#section-1.2-8){.pilcrow}
:::
:::
:::
:::

::: {#notation}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

The reader should be familiar with the terms defined in
\[[RFC8612](#RFC8612){.xref}\].[¶](#section-2-2){.pilcrow}

The terminology for describing YANG modules is defined in
\[[RFC7950](#RFC7950){.xref}\]. The meaning of the symbols in the tree
diagram is defined in \[[RFC8340](#RFC8340){.xref}\] and
\[[RFC8791](#RFC8791){.xref}\].[¶](#section-2-3){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Controlling Filtering Rules of a DOTS Client](#name-controlling-filtering-rules-){.section-name .selfRef} {#name-controlling-filtering-rules-}

::: {#bind}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Binding DOTS Data and Signal Channels](#name-binding-dots-data-and-signa){.section-name .selfRef} {#name-binding-dots-data-and-signa}

The filtering rules eventually managed using the DOTS signal channel
protocol are created a priori by the same DOTS client using the DOTS
data channel protocol. Managing conflicts with filters installed by
other DOTS clients of the same domain is out of
scope.[¶](#section-3.1-1){.pilcrow}

As discussed in [Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\], a DOTS client must use the same \'cuid\'
for both the DOTS signal and data channels. This requirement is meant to
facilitate binding DOTS channels used by the same DOTS
client.[¶](#section-3.1-2){.pilcrow}

The DOTS signal and data channels from a DOTS client may or may not use
the same DOTS server. Nevertheless, the scope of the mitigation request,
alias, and filtering rules are not restricted to the DOTS server but to
the DOTS server domain. To that aim, DOTS servers within a domain are
assumed to have a mechanism to coordinate the mitigation requests,
aliases, and filtering rules to coordinate their decisions for better
mitigation operation efficiency. The exact details about such a
mechanism is out of the scope of this
document.[¶](#section-3.1-3){.pilcrow}

A filtering rule controlled by the DOTS signal channel is identified by
its ACL name ([Section
4.3](https://www.rfc-editor.org/rfc/rfc8783#section-4.3){.relref} of
\[[RFC8783](#RFC8783){.xref}\]). Note that an ACL name unambiguously
identifies an ACL bound to a DOTS client, but the same name may be used
by distinct DOTS clients.[¶](#section-3.1-4){.pilcrow}

The activation or deactivation of an ACL by the DOTS signal channel
overrides the \'activation-type\' (defined in [Section
4.3](https://www.rfc-editor.org/rfc/rfc8783#section-4.3){.relref} of
\[[RFC8783](#RFC8783){.xref}\]) a priori conveyed with the filtering
rules using the DOTS data channel protocol.[¶](#section-3.1-5){.pilcrow}

Once the attack is mitigated, the DOTS client may use the data channel
to control the \'activation-type\' (e.g., revert to a default value) of
some of the filtering rules controlled by the DOTS signal channel or
delete some of these filters. This behavior is deployment
specific.[¶](#section-3.1-6){.pilcrow}
:::
:::

::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [DOTS Signal Channel Extension](#name-dots-signal-channel-extensi){.section-name .selfRef} {#name-dots-signal-channel-extensi}

::: {#filtering}
::: {#section-3.2.1 .section}
#### [3.2.1.](#section-3.2.1){.section-number .selfRef} [Parameters and Behaviors](#name-parameters-and-behaviors){.section-name .selfRef} {#name-parameters-and-behaviors}

This specification extends the mitigation request defined in [Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\] to convey the intended control of
configured filtering rules. Concretely, the DOTS client conveys the
\'acl-list\' attribute with the following sub-attributes in the Concise
Binary Object Representation (CBOR) body of a mitigation request (see
the YANG structure in [Section
3.2.2.1](#tree){.xref}):[¶](#section-3.2.1-1){.pilcrow}

[]{.break}

acl-name:

:   A name of an access list defined using the DOTS data channel
    ([Section
    4.3](https://www.rfc-editor.org/rfc/rfc8783#section-4.3){.relref} of
    \[[RFC8783](#RFC8783){.xref}\]) that is associated with the DOTS
    client.[¶](#section-3.2.1-2.2.1){.pilcrow}

    As a reminder, an ACL is an ordered list of Access Control Entries
    (ACEs). Each ACE has a list of match criteria and a list of actions
    \[[RFC8783](#RFC8783){.xref}\]. The list of configured ACLs can be
    retrieved using the DOTS data channel during \'idle\'
    time.[¶](#section-3.2.1-2.2.2){.pilcrow}

    This is a mandatory attribute when \'acl-list\' is
    included.[¶](#section-3.2.1-2.2.3){.pilcrow}

:   

activation-type:

:   An attribute indicating the activation type of an ACL overriding the
    existing \'activation-type\' installed by the DOTS client using the
    DOTS data channel.[¶](#section-3.2.1-2.4.1){.pilcrow}

    As a reminder, this attribute can be set to \'deactivate\',
    \'immediate\', or \'activate-when-mitigating\' as defined in
    \[[RFC8783](#RFC8783){.xref}\].[¶](#section-3.2.1-2.4.2){.pilcrow}

    Note that both \'immediate\' and \'activate-when-mitigating\' have
    an immediate effect when a mitigation request is being processed by
    the DOTS server.[¶](#section-3.2.1-2.4.3){.pilcrow}

    This is an optional attribute.[¶](#section-3.2.1-2.4.4){.pilcrow}

:   

By default, ACL-related operations are achieved using the DOTS data
channel protocol when no attack is ongoing. DOTS clients [MUST
NOT]{.bcp14} use the filtering control over the DOTS signal channel in
\'idle\' time; such requests [MUST]{.bcp14} be discarded by DOTS servers
with 4.00 (Bad Request).[¶](#section-3.2.1-3){.pilcrow}

During an attack time, DOTS clients may include \'acl-list\',
\'acl-name\', and \'activation-type\' attributes in a mitigation
request. This request may be the initial mitigation request for a given
mitigation scope or a new one overriding an existing request. In both
cases, a new \'mid\' [MUST]{.bcp14} be used. Nevertheless, it is [NOT
RECOMMENDED]{.bcp14} to include ACL attributes in an initial mitigation
request for a given mitigation scope or in a mitigation request
adjusting the mitigation scope. This recommendation is meant to avoid
delaying attack mitigations because of failures to process ACL
attributes.[¶](#section-3.2.1-4){.pilcrow}

As the attack evolves, DOTS clients can adjust the \'activation-type\'
of an ACL conveyed in a mitigation request or control other filters as
necessary. This can be achieved by sending a PUT request with a new
\'mid\' value.[¶](#section-3.2.1-5){.pilcrow}

It is [RECOMMENDED]{.bcp14} for a DOTS client to subscribe to
asynchronous notifications of the attack mitigation, as detailed in
[Section
4.4.2.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2.1){.relref}
of \[[RFC9132](#RFC9132){.xref}\]. If not, the polling mechanism in
[Section
4.4.2.2](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2.2){.relref}
of \[[RFC9132](#RFC9132){.xref}\] has to be followed by the DOTS
client.[¶](#section-3.2.1-6){.pilcrow}

A DOTS client relies on the information received from the DOTS server
and/or local information to the DOTS client domain to trigger a filter
control request. Only filters that are pertinent for an ongoing
mitigation should be controlled by a DOTS client using the DOTS signal
channel.[¶](#section-3.2.1-7){.pilcrow}

\'acl-list\', \'acl-name\', and \'activation-type\' are defined as
comprehension-required parameters. Following the rules in [Section
6](https://www.rfc-editor.org/rfc/rfc9132#section-6){.relref} of
\[[RFC9132](#RFC9132){.xref}\], if the DOTS server does not understand
the \'acl-list\', \'acl-name\', or \'activation-type\' attributes, it
responds with a 4.00 (Bad Request) error response
code.[¶](#section-3.2.1-8){.pilcrow}

If the DOTS server does not find the ACL name (\'acl-name\') conveyed in
the mitigation request for this DOTS client, it [MUST]{.bcp14} respond
with a 4.04 (Not Found) error response
code.[¶](#section-3.2.1-9){.pilcrow}

If the DOTS server finds the ACL name for this DOTS client, and assuming
the request passed the validation checks in [Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\], the DOTS server [MUST]{.bcp14} proceed
with the \'activation-type\' update. The update is immediately enforced
by the DOTS server and will be maintained as the new activation type for
the ACL name even after the termination of the mitigation request. In
addition, the DOTS server [MUST]{.bcp14} update the lifetime of the
corresponding ACL similar to the update when a refresh request is
received using the DOTS data channel ([Section
7.2](https://www.rfc-editor.org/rfc/rfc8783#section-7.2){.relref} of
\[[RFC8783](#RFC8783){.xref}\]). If, for some reason, the DOTS server
fails to apply the filter update, it [MUST]{.bcp14} respond with a 5.03
(Service Unavailable) error response code and include the failed ACL
update in the diagnostic payload of the response (an example is shown in
[Figure 1](#diag){.xref}). Else, the DOTS server replies with the
appropriate response code defined in [Section
4.4.1](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.1){.relref} of
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-3.2.1-10){.pilcrow}

[]{#name-example-of-a-diagnostic-pay}

::: {#diag}
::: {#section-3.2.1-11.1}
``` sourcecode
{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "mid": 123,
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "an-accept-list",
            "activation-type": "deactivate"
          }
        ]
      }
    ]
  }
}
```
:::

[Figure 1](#figure-1){.selfRef}: [Example of a Diagnostic Payload
Including Failed ACL
Update](#name-example-of-a-diagnostic-pay){.selfRef}
:::

The JSON/YANG mappings for DOTS filter control attributes are shown in
[Table 1](#table1){.xref}. As a reminder, the mapping for \'acl-name\'
is defined in Table 5 of
\[[RFC9132](#RFC9132){.xref}\].[¶](#section-3.2.1-12){.pilcrow}

[]{#name-json-yang-mapping-to-cbor-f}

::: {#table1}
  Parameter Name                      YANG Type     CBOR Key   CBOR Major Type & Information   JSON Type
  ----------------------------------- ------------- ---------- ------------------------------- -----------
  activation-type                     enumeration   52         0 unsigned                      String
  ietf-dots-signal-control:acl-list   list          53         4 array                         Array
  acl-name                            leafref       23         3 text string                   String

  : [Table 1](#table-1){.selfRef}: [JSON/YANG Mapping to CBOR for Filter
  Control Attributes](#name-json-yang-mapping-to-cbor-f){.selfRef}
:::

If the DOTS client receives a 5.03 (Service Unavailable) with a
diagnostic payload indicating a failed ACL update as a response to an
initial mitigation or a mitigation with adjusted scope, the DOTS client
[MUST]{.bcp14} immediately send a new request that repeats all the
parameters as sent in the failed mitigation request but without
including the ACL attributes. After the expiry of Max-Age returned in
the 5.03 (Service Unavailable) response, the DOTS client retries with a
new mitigation request (i.e., a new \'mid\') that repeats all the
parameters as sent in the failed mitigation request (i.e., the one
including the ACL attributes).[¶](#section-3.2.1-14){.pilcrow}

If, during an active mitigation, the \'activation-type\' is changed at
the DOTS server (e.g., as a result of an external action) for an ACL
bound to a DOTS client, the DOTS server notifies that DOTS client of the
change by including the corresponding ACL parameters in an asynchronous
notification (the DOTS client is observing the active mitigation) or in
a response to a polling request ([Section
4.4.2.2](https://www.rfc-editor.org/rfc/rfc9132#section-4.4.2.2){.relref}
of \[[RFC9132](#RFC9132){.xref}\]).[¶](#section-3.2.1-15){.pilcrow}

If the DOTS signal and data channels of a DOTS client are not
established with the same DOTS server of a DOTS server domain, the above
request processing operations are undertaken using the coordination
mechanism discussed in [Section
3.1](#bind){.xref}.[¶](#section-3.2.1-16){.pilcrow}

This specification does not require any modification to the efficacy
update and the withdrawal procedures defined in
\[[RFC9132](#RFC9132){.xref}\]. In particular, ACL-related clauses are
not included in a PUT request used to send an efficacy update and DELETE
requests.[¶](#section-3.2.1-17){.pilcrow}
:::
:::

::: {#YANG}
::: {#section-3.2.2 .section}
#### [3.2.2.](#section-3.2.2){.section-number .selfRef} [DOTS Signal Filtering Control Module](#name-dots-signal-filtering-contr){.section-name .selfRef} {#name-dots-signal-filtering-contr}

::: {#tree}
::: {#section-3.2.2.1 .section}
##### [3.2.2.1.](#section-3.2.2.1){.section-number .selfRef} [Tree Structure](#name-tree-structure){.section-name .selfRef} {#name-tree-structure}

This document augments the \"ietf-dots-signal-channel\" YANG module
defined in \[[RFC9132](#RFC9132){.xref}\] for managing filtering
rules.[¶](#section-3.2.2.1-1){.pilcrow}

This document defines the YANG module \"ietf-dots-signal-control\",
which has the following tree structure:[¶](#section-3.2.2.1-2){.pilcrow}

::: {#section-3.2.2.1-3}
``` {.sourcecode .lang-yangtree}
module: ietf-dots-signal-control
 augment-structure /dots-signal:dots-signal/dots-signal:message-type
                   /dots-signal:mitigation-scope/dots-signal:scope:
   +-- acl-list* [acl-name]
      +-- acl-name
      |       -> /data-channel:dots-data/dots-client/acls/acl/name
      +-- activation-type?   data-channel:activation-type
```

[¶](#section-3.2.2.1-3){.pilcrow}
:::
:::
:::

::: {#section-3.2.2.2 .section}
##### [3.2.2.2.](#section-3.2.2.2){.section-number .selfRef} [YANG Module](#name-yang-module){.section-name .selfRef} {#name-yang-module}

This YANG module is not intended to be used via NETCONF/RESTCONF for
DOTS server management purposes; such a module is out of the scope of
this document. It serves only to provide a data model and encoding, but
not a management data model.[¶](#section-3.2.2.2-1){.pilcrow}

This module uses types defined in
\[[RFC8783](#RFC8783){.xref}\].[¶](#section-3.2.2.2-2){.pilcrow}

::: {#section-3.2.2.2-3}
``` {.sourcecode .lang-yang}
<CODE BEGINS> file "ietf-dots-signal-control@2021-09-02.yang"

module ietf-dots-signal-control {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-dots-signal-control";
  prefix dots-control;

  import ietf-dots-signal-channel {
    prefix dots-signal;
    reference
      "RFC 9132: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }


  import ietf-yang-structure-ext {
    prefix sx;
    reference
      "RFC 8791: YANG Data Structure Extensions";
  }

  import ietf-dots-data-channel {
    prefix data-channel;
    reference
      "RFC 8783: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Data Channel Specification";
  }

  organization
    "IETF DDoS Open Threat Signaling (DOTS) Working Group";
  contact
    "WG Web:   <https://datatracker.ietf.org/wg/dots/>
     WG List:  <mailto:dots@ietf.org>

     Author:  Kaname Nishizuka
              <mailto:kaname@nttv6.jp>

     Author:  Mohamed Boucadair
              <mailto:mohamed.boucadair@orange.com>

     Author:  Tirumaleswar Reddy.K
              <mailto:kondtir@gmail.com>

     Author:  Takahiko Nagata
              <mailto:nagata@lepidum.co.jp>";

  description
    "This module contains YANG definition for the signaling
     messages exchanged between a DOTS client and a DOTS server
     to control, by means of the DOTS signal channel, filtering
     rules configured using the DOTS data channel.

     Copyright (c) 2021 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (https://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 9133; see
     the RFC itself for full legal notices.";

  revision 2021-09-02 {
    description
      "Initial revision.";
    reference
      "RFC 9133: Controlling Filtering Rules Using Distributed
                 Denial-of-Service Open Threat Signaling (DOTS)
                 Signal Channel";
  }

  sx:augment-structure "/dots-signal:dots-signal"
                     + "/dots-signal:message-type"
                     + "/dots-signal:mitigation-scope"
                     + "/dots-signal:scope" {

    description
      "ACL name and activation type.";

    list acl-list {
      key "acl-name";
      description
        "List of ACLs as defined using the DOTS data
         channel. ACLs bound to a DOTS client are uniquely
         identified by a name.";
      leaf acl-name {
        type leafref {
          path "/data-channel:dots-data/data-channel:dots-client"
             + "/data-channel:acls/data-channel:acl"
             + "/data-channel:name";
        }
        description
          "Reference to the ACL name bound to a DOTS client.";
      }
      leaf activation-type {
        type data-channel:activation-type;
        default "activate-when-mitigating";
        description
          "Sets the activation type of an ACL.";
      }
    }
  }
}

<CODE ENDS>
```

[¶](#section-3.2.2.2-3){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#sample}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Some Examples](#name-some-examples){.section-name .selfRef} {#name-some-examples}

This section provides some examples to illustrate the behavior specified
in [Section 3.2.1](#filtering){.xref}. These examples are provided for
illustration purposes; they should not be considered as deployment
recommendations.[¶](#section-4-1){.pilcrow}

::: {#sample1}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Conflict Handling](#name-conflict-handling){.section-name .selfRef} {#name-conflict-handling}

Let\'s consider a DOTS client that contacts its DOTS server during
\'idle\' time to install an accept-list allowing for UDP traffic issued
from 2001:db8:1234::/48 with a destination port number 443 to be
forwarded to 2001:db8:6401::2/127. It does so by sending, for example, a
PUT request as shown in [Figure
2](#PUT){.xref}.[¶](#section-4.1-1){.pilcrow}

[]{#name-dots-data-channel-request-t}

::: {#PUT}
::: {#section-4.1-2.1}
``` sourcecode
PUT /restconf/data/ietf-dots-data-channel:dots-data\
    /dots-client=paL8p4Zqo4SLv64TLPXrxA/acls\
    /acl=an-accept-list HTTP/1.1
Host: example.com
Content-Type: application/yang-data+json

{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "an-accept-list",
        "type": "ipv6-acl-type",
        "activation-type": "activate-when-mitigating",
        "aces": {
          "ace": [
            {
              "name": "test-ace-ipv6-udp",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:6401::2/127",
                  "source-ipv6-network": "2001:db8:1234::/48"
                },
                "udp": {
                  "destination-port-range-or-operator": {
                    "operator": "eq",
                    "port": 443
                  }
                }
              },
              "actions": {
                "forwarding": "accept"
              }
            }
          ]
        }
      }
    ]
  }
}
```
:::

[Figure 2](#figure-2){.selfRef}: [DOTS Data Channel Request to Create a
Filter](#name-dots-data-channel-request-t){.selfRef}
:::

Sometime later, consider that a DDoS attack is detected by the DOTS
client on 2001:db8:6401::2/127. Consequently, the DOTS client sends a
mitigation request to its DOTS server as shown in [Figure
3](#mitigate){.xref}.[¶](#section-4.1-3){.pilcrow}

[]{#name-dots-signal-channel-mitigat}

::: {#mitigate}
::: {#section-4.1-4.1}
``` sourcecode
Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=paL8p4Zqo4SLv64TLPXrxA"
Uri-Path: "mid=123"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:6401::2/127"
        ],
        "target-protocol": [
          17
        ],
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 3](#figure-3){.selfRef}: [DOTS Signal Channel Mitigation
Request](#name-dots-signal-channel-mitigat){.selfRef}
:::

The DOTS server immediately accepts the request by replying with 2.01
(Created) ([Figure 4](#response){.xref} depicts the message body of the
response).[¶](#section-4.1-5){.pilcrow}

[]{#name-status-response-message-bod}

::: {#response}
::: {#section-4.1-6.1}
``` sourcecode
{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "mid": 123,
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 4](#figure-4){.selfRef}: [Status Response (Message
Body)](#name-status-response-message-bod){.selfRef}
:::

Assuming the DOTS client subscribed to asynchronous notifications, when
the DOTS server concludes that some of the attack sources belong to
2001:db8:1234::/48, it sends a notification message with \'status\' code
set to 1 (attack-mitigation-in-progress) and \'conflict-cause\' set to 2
(conflict-with-acceptlist) to the DOTS client to indicate that this
mitigation request is in progress, but a conflict is
detected.[¶](#section-4.1-7){.pilcrow}

Upon receipt of the notification message from the DOTS server, the DOTS
client sends a PUT request to deactivate the \"an-accept-list\" ACL as
shown in [Figure 5](#control){.xref}.[¶](#section-4.1-8){.pilcrow}

The DOTS client can also decide to send a PUT request to deactivate the
\"an-accept-list\" ACL if suspect traffic is received from an
accept-listed source (2001:db8:1234::/48). The structure of that PUT is
the same as the one shown in [Figure
5](#control){.xref}.[¶](#section-4.1-9){.pilcrow}

[]{#name-put-for-deactivating-a-conf}

::: {#control}
::: {#section-4.1-10.1}
``` sourcecode
Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=paL8p4Zqo4SLv64TLPXrxA"
Uri-Path: "mid=124"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:6401::2/127"
        ],
        "target-protocol": [
          17
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "an-accept-list",
            "activation-type": "deactivate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 5](#figure-5){.selfRef}: [PUT for Deactivating a Conflicting
Filter](#name-put-for-deactivating-a-conf){.selfRef}
:::

Then, the DOTS server deactivates the \"an-accept-list\" ACL and replies
with a 2.04 (Changed) response to the DOTS client to confirm the
successful operation. The message body is similar to the one depicted in
[Figure 4](#response){.xref}.[¶](#section-4.1-11){.pilcrow}

Once the attack is mitigated, the DOTS client may use the data channel
to retrieve its ACLs maintained by the DOTS server. As shown in [Figure
6](#GET-2){.xref}, the activation type is set to \'deactivate\' as set
by the DOTS signal channel ([Figure 5](#control){.xref}) instead of the
type initially set using the DOTS data channel ([Figure
2](#PUT){.xref}).[¶](#section-4.1-12){.pilcrow}

[]{#name-dots-data-channel-get-respo}

::: {#GET-2}
::: {#section-4.1-13.1}
``` sourcecode
{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "an-accept-list",
        "type": "ipv6-acl-type",
        "activation-type": "deactivate",
        "pending-lifetime": 10021,
        "aces": {
          "ace": [
            {
              "name": "test-ace-ipv6-udp",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:6401::2/127",
                  "source-ipv6-network": "2001:db8:1234::/48"
                },
                "udp": {
                  "destination-port-range-or-operator": {
                    "operator": "eq",
                    "port": 443
                  }
                }
              },
              "actions": {
                "forwarding": "accept"
              }
            }
          ]
        }
      }
    ]
  }
}
```
:::

[Figure 6](#figure-6){.selfRef}: [DOTS Data Channel GET Response after
Mitigation (Message Body)](#name-dots-data-channel-get-respo){.selfRef}
:::
:::
:::

::: {#sample2}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [On-Demand Activation of an Accept-List Filter](#name-on-demand-activation-of-an-){.section-name .selfRef} {#name-on-demand-activation-of-an-}

Let\'s consider a DOTS client that contacts its DOTS server during
\'idle\' time to install an accept-list allowing for UDP traffic issued
from 2001:db8:1234::/48 to be forwarded to 2001:db8:6401::2/127. It does
so by sending, for example, a PUT request shown in [Figure
7](#PUT1){.xref}. The DOTS server installs this filter with a
\"deactivated\" state.[¶](#section-4.2-1){.pilcrow}

[]{#name-dots-data-channel-request-to}

::: {#PUT1}
::: {#section-4.2-2.1}
``` sourcecode
PUT /restconf/data/ietf-dots-data-channel:dots-data\
    /dots-client=ioiuLoZqo4SLv64TLPXrxA/acls\
    /acl=my-accept-list HTTP/1.1
Host: example.com
Content-Type: application/yang-data+json

{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "my-accept-list",
        "type": "ipv6-acl-type",
        "activation-type": "deactivate",
        "aces": {
          "ace": [
            {
              "name": "an-ace",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:6401::2/127",
                  "source-ipv6-network": "2001:db8:1234::/48",
                  "protocol": 17
                }
              },
              "actions": {
                "forwarding": "accept"
              }
            }
          ]
        }
      }
    ]
  }
}
```
:::

[Figure 7](#figure-7){.selfRef}: [DOTS Data Channel Request to Create an
Accept-List Filter](#name-dots-data-channel-request-to){.selfRef}
:::

Sometime later, consider that a UDP DDoS attack is detected by the DOTS
client on 2001:db8:6401::2/127 but the DOTS client wants to let the
traffic from 2001:db8:1234::/48 be accept-listed to the DOTS client
domain. Consequently, the DOTS client sends a mitigation request to its
DOTS server as shown in [Figure
8](#mitigate1){.xref}.[¶](#section-4.2-3){.pilcrow}

[]{#name-dots-signal-channel-mitigati}

::: {#mitigate1}
::: {#section-4.2-4.1}
``` sourcecode
Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=ioiuLoZqo4SLv64TLPXrxA"
Uri-Path: "mid=4879"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:6401::2/127"
        ],
        "target-protocol": [
          17
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "my-accept-list",
            "activation-type": "immediate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 8](#figure-8){.selfRef}: [DOTS Signal Channel Mitigation Request
with a Filter Control](#name-dots-signal-channel-mitigati){.selfRef}
:::

The DOTS server activates the \"my-accept-list\" ACL and replies with a
2.01 (Created) response to the DOTS client to confirm the successful
operation.[¶](#section-4.2-5){.pilcrow}
:::
:::

::: {#sample3}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [DOTS Servers/Mitigators Lacking Capacity](#name-dots-servers-mitigators-lac){.section-name .selfRef} {#name-dots-servers-mitigators-lac}

This section describes a scenario in which a DOTS client activates a
drop-list or a rate-limit filter during an
attack.[¶](#section-4.3-1){.pilcrow}

Consider a DOTS client that contacts its DOTS server during \'idle\'
time to install an accept-list that rate-limits all (or a part thereof)
traffic to be forwarded to 2001:db8:123::/48 as a last resort
countermeasure whenever required. Installing the accept-list can be done
by sending, for example, the PUT request shown in [Figure
9](#rate){.xref}. The DOTS server installs this filter with a
\"deactivated\" state.[¶](#section-4.3-2){.pilcrow}

[]{#name-dots-data-channel-request-to-}

::: {#rate}
::: {#section-4.3-3.1}
``` sourcecode
PUT /restconf/data/ietf-dots-data-channel:dots-data\
    /dots-client=OopPisZqo4SLv64TLPXrxA/acls\
    /acl=my-ratelimit-list HTTP/1.1
Host: example.com
Content-Type: application/yang-data+json

{
  "ietf-dots-data-channel:acls": {
    "acl": [
      {
        "name": "my-ratelimit-list",
        "type": "ipv6-acl-type",
        "activation-type": "deactivate",
        "aces": {
          "ace": [
            {
              "name": "my-ace",
              "matches": {
                "ipv6": {
                  "destination-ipv6-network": "2001:db8:123::/48"
                }
              },
              "actions": {
                "forwarding": "accept",
                "rate-limit": "20000.00"
              }
            }
          ]
        }
      }
    ]
  }
}
```
:::

[Figure 9](#figure-9){.selfRef}: [DOTS Data Channel Request to Create a
Rate-Limit Filter](#name-dots-data-channel-request-to-){.selfRef}
:::

Consider now that a DDoS attack is detected by the DOTS client on
2001:db8:123::/48. Consequently, the DOTS client sends a mitigation
request to its DOTS server ([Figure
10](#ratel){.xref}).[¶](#section-4.3-4){.pilcrow}

[]{#name-dots-signal-channel-mitigatio}

::: {#ratel}
::: {#section-4.3-5.1}
``` sourcecode
Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=OopPisZqo4SLv64TLPXrxA"
Uri-Path: "mid=85"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:123::/48"
        ],
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 10](#figure-10){.selfRef}: [DOTS Signal Channel Mitigation
Request](#name-dots-signal-channel-mitigatio){.selfRef}
:::

For some reason (e.g., the DOTS server, or the mitigator, is lacking a
capability or capacity), the DOTS client is still receiving attack
traffic, which saturates available links. To soften the problem, the
DOTS client decides to activate the filter that rate-limits the traffic
destined to the DOTS client domain. To that aim, the DOTS client sends
the mitigation request to its DOTS server shown in [Figure
11](#rateres){.xref}.[¶](#section-4.3-6){.pilcrow}

[]{#name-dots-signal-channel-mitigation}

::: {#rateres}
::: {#section-4.3-7.1}
``` sourcecode
Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=OopPisZqo4SLv64TLPXrxA"
Uri-Path: "mid=86"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:123::/48"
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "my-ratelimit-list",
            "activation-type": "immediate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 11](#figure-11){.selfRef}: [DOTS Signal Channel Mitigation
Request to Activate a Rate-Limit
Filter](#name-dots-signal-channel-mitigation){.selfRef}
:::

Then, the DOTS server activates the \"my-ratelimit-list\" ACL and
replies with a 2.04 (Changed) response to the DOTS client to confirm the
successful operation.[¶](#section-4.3-8){.pilcrow}

As the attack mitigation evolves, the DOTS client may decide to
deactivate the rate-limit policy (e.g., upon receipt of a notification
status change from \'attack-exceeded-capability\' to
\'attack-mitigation-in-progress\'). Based on the mitigation status
conveyed by the DOTS server, the DOTS client can deactivate the
rate-limit action. It does so by sending the request shown in [Figure
12](#rateres2){.xref}.[¶](#section-4.3-9){.pilcrow}

[]{#name-dots-signal-channel-mitigation-}

::: {#rateres2}
::: {#section-4.3-10.1}
``` {.sourcecode .lang-cbor}
Header: PUT (Code=0.03)
Uri-Path: ".well-known"
Uri-Path: "dots"
Uri-Path: "mitigate"
Uri-Path: "cuid=OopPisZqo4SLv64TLPXrxA"
Uri-Path: "mid=87"
Content-Format: "application/dots+cbor"

{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "target-prefix": [
          "2001:db8:123::/48"
        ],
        "ietf-dots-signal-control:acl-list": [
          {
            "acl-name": "my-ratelimit-list",
            "activation-type": "deactivate"
          }
        ],
        "lifetime": 3600
      }
    ]
  }
}
```
:::

[Figure 12](#figure-12){.selfRef}: [DOTS Signal Channel Mitigation
Request to Deactivate a Rate-Limit
Filter](#name-dots-signal-channel-mitigation-){.selfRef}
:::
:::
:::
:::
:::

::: {#IANA}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#map}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [DOTS Signal Channel CBOR Key Values Subregistry](#name-dots-signal-channel-cbor-ke){.section-name .selfRef} {#name-dots-signal-channel-cbor-ke}

Per this specification, IANA has registered the following parameters in
the \"DOTS Signal Channel CBOR Key Values\" subregistry within the
\"Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal
Channel\" registry
\[[Key-Map](#Key-Map){.xref}\].[¶](#section-5.1-1){.pilcrow}

::: {#table2}
  Parameter Name                      CBOR Key Value   CBOR Major Type   Change Controller   Specification Document(s)
  ----------------------------------- ---------------- ----------------- ------------------- ---------------------------
  activation-type                     52               0                 IESG                RFC 9133
  ietf-dots-signal-control:acl-list   53               4                 IESG                RFC 9133

  : [Table 2](#table-2){.selfRef}
:::
:::
:::

::: {#yang-iana}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [A New YANG Module](#name-a-new-yang-module){.section-name .selfRef} {#name-a-new-yang-module}

IANA has registered the following URI in the \"ns\" subregistry within
the \"IETF XML Registry\"
\[[RFC3688](#RFC3688){.xref}\]:[¶](#section-5.2-1){.pilcrow}

[]{.break}

URI:
:   urn:ietf:params:xml:ns:yang:ietf-dots-signal-control[¶](#section-5.2-2.2){.pilcrow}
:   

Registrant Contact:
:   The IESG.[¶](#section-5.2-2.4){.pilcrow}
:   

XML:
:   N/A; the requested URI is an XML
    namespace.[¶](#section-5.2-2.6){.pilcrow}
:   

IANA has registered the following YANG module in the \"YANG Module
Names\" subregistry \[[RFC6020](#RFC6020){.xref}\] within the \"YANG
Parameters\" registry.[¶](#section-5.2-3){.pilcrow}

[]{.break}

Name:
:   ietf-dots-signal-control[¶](#section-5.2-4.2){.pilcrow}
:   

Namespace:
:   urn:ietf:params:xml:ns:yang:ietf-dots-signal-control[¶](#section-5.2-4.4){.pilcrow}
:   

Maintained by IANA:
:   N[¶](#section-5.2-4.6){.pilcrow}
:   

Prefix:
:   dots-control[¶](#section-5.2-4.8){.pilcrow}
:   

Reference:
:   RFC 9133[¶](#section-5.2-4.10){.pilcrow}
:   
:::
:::
:::
:::

::: {#security}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations for the DOTS signal channel protocol are
discussed in [Section
11](https://www.rfc-editor.org/rfc/rfc9132#section-11){.relref} of
\[[RFC9132](#RFC9132){.xref}\], while those for the DOTS data channel
protocol are discussed in [Section
10](https://www.rfc-editor.org/rfc/rfc8783#section-10){.relref} of
\[[RFC8783](#RFC8783){.xref}\]. The following discusses the security
considerations that are specific to the DOTS signal channel extension
defined in this document.[¶](#section-6-1){.pilcrow}

This specification does not allow the creation of new filtering rules,
which is the responsibility of the DOTS data channel. DOTS client
domains should be adequately prepared prior to an attack, e.g., by
creating filters that will be activated on demand when an attack is
detected.[¶](#section-6-2){.pilcrow}

A DOTS client is entitled to access only the resources it creates. In
particular, a DOTS client can not tweak filtering rules created by other
DOTS clients of the same DOTS client domain. As a reminder, DOTS servers
must associate filtering rules with the DOTS client that created these
resources. Failure to ensure such association by a DOTS server will have
severe impact on DOTS client domains.[¶](#section-6-3){.pilcrow}

A compromised DOTS client can use the filtering control capability to
exacerbate an ongoing attack. Likewise, such a compromised DOTS client
may abstain from reacting to an ACL conflict notification received from
the DOTS server during attacks. These are not new attack vectors, but
variations of threats discussed in \[[RFC9132](#RFC9132){.xref}\] and
\[[RFC8783](#RFC8783){.xref}\]. DOTS operators should carefully monitor
and audit DOTS agents to detect misbehaviors and deter
misuses.[¶](#section-6-4){.pilcrow}
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3688\]
:   [Mealling, M.]{.refAuthor}, [\"The IETF XML Registry\"]{.refTitle},
    [BCP 81]{.seriesInfo}, [RFC 3688]{.seriesInfo}, [DOI
    10.17487/RFC3688]{.seriesInfo}, January 2004,
    \<<https://www.rfc-editor.org/info/rfc3688>\>.
:   

\[RFC6020\]
:   [Bjorklund, M., Ed.]{.refAuthor}, [\"YANG - A Data Modeling Language
    for the Network Configuration Protocol (NETCONF)\"]{.refTitle}, [RFC
    6020]{.seriesInfo}, [DOI 10.17487/RFC6020]{.seriesInfo}, October
    2010, \<<https://www.rfc-editor.org/info/rfc6020>\>.
:   

\[RFC7950\]
:   [Bjorklund, M., Ed.]{.refAuthor}, [\"The YANG 1.1 Data Modeling
    Language\"]{.refTitle}, [RFC 7950]{.seriesInfo}, [DOI
    10.17487/RFC7950]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7950>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8783\]
:   [Boucadair, M., Ed.]{.refAuthor} and [T. Reddy.K, Ed.]{.refAuthor},
    [\"Distributed Denial-of-Service Open Threat Signaling (DOTS) Data
    Channel Specification\"]{.refTitle}, [RFC 8783]{.seriesInfo}, [DOI
    10.17487/RFC8783]{.seriesInfo}, May 2020,
    \<<https://www.rfc-editor.org/info/rfc8783>\>.
:   

\[RFC8791\]
:   [Bierman, A.]{.refAuthor}, [Björklund, M.]{.refAuthor}, and [K.
    Watsen]{.refAuthor}, [\"YANG Data Structure
    Extensions\"]{.refTitle}, [RFC 8791]{.seriesInfo}, [DOI
    10.17487/RFC8791]{.seriesInfo}, June 2020,
    \<<https://www.rfc-editor.org/info/rfc8791>\>.
:   

\[RFC9132\]
:   [Boucadair, M., Ed.]{.refAuthor}, [Shallow, J.]{.refAuthor}, and [T.
    Reddy.K]{.refAuthor}, [\"Distributed Denial-of-Service Open Threat
    Signaling (DOTS) Signal Channel Specification\"]{.refTitle}, [RFC
    9132]{.seriesInfo}, [DOI 10.17487/RFC9132]{.seriesInfo}, September
    2021, \<<https://www.rfc-editor.org/info/rfc9132>\>.
:   
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[INTEROP\]
:   [Nishizuka, K.]{.refAuthor}, [Shallow, J.]{.refAuthor}, and [L.
    Xia]{.refAuthor}, [\"DOTS Interop test report, IETF 103
    Hackathon\"]{.refTitle}, November 2018,
    \<<https://datatracker.ietf.org/meeting/103/materials/slides-103-dots-interop-report-from-ietf-103-hackathon-00>\>.
:   

\[Key-Map\]
:   [IANA]{.refAuthor}, [\"Distributed Denial-of-Service Open Threat
    Signaling (DOTS) Signal Channel\"]{.refTitle},
    \<<https://www.iana.org/assignments/dots>\>.
:   

\[RFC7951\]
:   [Lhotka, L.]{.refAuthor}, [\"JSON Encoding of Data Modeled with
    YANG\"]{.refTitle}, [RFC 7951]{.seriesInfo}, [DOI
    10.17487/RFC7951]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7951>\>.
:   

\[RFC8340\]
:   [Bjorklund, M.]{.refAuthor} and [L. Berger, Ed.]{.refAuthor},
    [\"YANG Tree Diagrams\"]{.refTitle}, [BCP 215]{.seriesInfo}, [RFC
    8340]{.seriesInfo}, [DOI 10.17487/RFC8340]{.seriesInfo}, March 2018,
    \<<https://www.rfc-editor.org/info/rfc8340>\>.
:   

\[RFC8612\]
:   [Mortensen, A.]{.refAuthor}, [Reddy, T.]{.refAuthor}, and [R.
    Moskowitz]{.refAuthor}, [\"DDoS Open Threat Signaling (DOTS)
    Requirements\"]{.refTitle}, [RFC 8612]{.seriesInfo}, [DOI
    10.17487/RFC8612]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8612>\>.
:   

\[RFC8811\]
:   [Mortensen, A., Ed.]{.refAuthor}, [Reddy.K, T., Ed.]{.refAuthor},
    [Andreasen, F.]{.refAuthor}, [Teague, N.]{.refAuthor}, and [R.
    Compton]{.refAuthor}, [\"DDoS Open Threat Signaling (DOTS)
    Architecture\"]{.refTitle}, [RFC 8811]{.seriesInfo}, [DOI
    10.17487/RFC8811]{.seriesInfo}, August 2020,
    \<<https://www.rfc-editor.org/info/rfc8811>\>.
:   
:::
:::

::: {#ack}
::: {#appendix-A .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Many thanks to [Wei Pan]{.contact-name}, [Xia Liang]{.contact-name},
[Jon Shallow]{.contact-name}, [Dan Wing]{.contact-name}, [Christer
Holmberg]{.contact-name}, [Shawn Emery]{.contact-name}, [Tim
Chown]{.contact-name}, [Murray Kucherawy]{.contact-name}, [Roman
Danyliw]{.contact-name}, [Erik Kline]{.contact-name}, and [Éric
Vyncke]{.contact-name} for the comments.[¶](#appendix-A-1){.pilcrow}

Thanks to [Benjamin Kaduk]{.contact-name} for the AD
review.[¶](#appendix-A-2){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Kaname Nishizuka]{.fn .nameRole}
:::

::: {.left dir="auto"}
[NTT Communications]{.org}
:::

::: {.left dir="auto"}
[GranPark 16F 3-4-1 Shibaura, Minato-ku]{.street-address},
[Tokyo]{.region}
:::

::: {.left dir="auto"}
[108-8118]{.postal-code}
:::

::: {.left dir="auto"}
[Japan]{.country-name}
:::

::: email
Email: <kaname@nttv6.jp>
:::

::: {.left dir="auto"}
[Mohamed Boucadair]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Orange]{.org}
:::

::: {.left dir="auto"}
[35000]{.postal-code} [Rennes]{.locality}
:::

::: {.left dir="auto"}
[France]{.country-name}
:::

::: email
Email: <mohamed.boucadair@orange.com>
:::

::: {.left dir="auto"}
[Tirumaleswar Reddy.K]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Akamai]{.org}
:::

::: {.left dir="auto"}
[Embassy Golf Link Business Park]{.street-address}
:::

::: {.left dir="auto"}
[Bangalore]{.locality} [560071]{.postal-code}
:::

::: {.left dir="auto"}
[Karnataka]{.region}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <kondtir@gmail.com>
:::

::: {.left dir="auto"}
[Takahiko Nagata]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Lepidum]{.org}
:::

::: {.left dir="auto"}
[Japan]{.country-name}
:::

::: email
Email: <nagata@lepidum.co.jp>
:::
:::
:::
