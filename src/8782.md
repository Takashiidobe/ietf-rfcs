  RFC 8782          DOTS Signal Channel Protocol   May 2020
  ----------------- ------------------------------ ----------
  Reddy.K, et al.   Standards Track                \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8782](https://www.rfc-editor.org/rfc/rfc8782){.eref}

Category:
:   Standards Track

Published:
:   May 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    T. Reddy.K, [Ed.]{.editor}
    :::

    ::: org
    McAfee
    :::
    :::

    ::: author
    ::: author-name
    M. Boucadair, [Ed.]{.editor}
    :::

    ::: org
    Orange
    :::
    :::

    ::: author
    ::: author-name
    P. Patil
    :::

    ::: org
    Cisco
    :::
    :::

    ::: author
    ::: author-name
    A. Mortensen
    :::

    ::: org
    Arbor Networks, Inc.
    :::
    :::

    ::: author
    ::: author-name
    N. Teague
    :::

    ::: org
    Iron Mountain Data Centers
    :::
    :::
:::

# RFC 8782 {#rfcnum}

# Distributed Denial-of-Service Open Threat Signaling (DOTS) Signal Channel Specification {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies the Distributed Denial-of-Service Open Threat
Signaling (DOTS) signal channel, a protocol for signaling the need for
protection against Distributed Denial-of-Service (DDoS) attacks to a
server capable of enabling network traffic mitigation on behalf of the
requesting client.[¶](#section-abstract-1){.pilcrow}

A companion document defines the DOTS data channel, a separate reliable
communication layer for DOTS management and configuration
purposes.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8782>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Design
    Overview](#name-design-overview){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [DOTS Signal Channel: Messages &
    Behaviors](#name-dots-signal-channel-message){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [DOTS Server(s)
        Discovery](#name-dots-servers-discovery){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [CoAP
        URIs](#name-coap-uris){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Happy Eyeballs for DOTS Signal
        Channel](#name-happy-eyeballs-for-dots-sig){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [DOTS Mitigation
        Methods](#name-dots-mitigation-methods){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.4.2.1}
            [4.4.1](#section-4.4.1){.xref}.  [Request
            Mitigation](#name-request-mitigation){.xref}[¶](#section-toc.1-1.4.2.4.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.2}
            [4.4.2](#section-4.4.2){.xref}.  [Retrieve Information
            Related to a
            Mitigation](#name-retrieve-information-relate){.xref}[¶](#section-toc.1-1.4.2.4.2.2.1){.pilcrow}

            -   ::: {#section-toc.1-1.4.2.4.2.2.2.1}
                [4.4.2.1](#section-4.4.2.1){.xref}.  [DOTS Servers
                Sending Mitigation
                Status](#name-dots-servers-sending-mitiga){.xref}[¶](#section-toc.1-1.4.2.4.2.2.2.1.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.4.2.4.2.2.2.2}
                [4.4.2.2](#section-4.4.2.2){.xref}.  [DOTS Clients
                Polling for Mitigation
                Status](#name-dots-clients-polling-for-mi){.xref}[¶](#section-toc.1-1.4.2.4.2.2.2.2.1){.pilcrow}
                :::
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.3}
            [4.4.3](#section-4.4.3){.xref}.  [Efficacy Update from DOTS
            Clients](#name-efficacy-update-from-dots-c){.xref}[¶](#section-toc.1-1.4.2.4.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.4.2.4}
            [4.4.4](#section-4.4.4){.xref}.  [Withdraw a
            Mitigation](#name-withdraw-a-mitigation){.xref}[¶](#section-toc.1-1.4.2.4.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [DOTS Signal Channel Session
        Configuration](#name-dots-signal-channel-session){.xref}[¶](#section-toc.1-1.4.2.5.1){.pilcrow}

        -   ::: {#section-toc.1-1.4.2.5.2.1}
            [4.5.1](#section-4.5.1){.xref}.  [Discover Configuration
            Parameters](#name-discover-configuration-para){.xref}[¶](#section-toc.1-1.4.2.5.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.5.2.2}
            [4.5.2](#section-4.5.2){.xref}.  [Convey DOTS Signal Channel
            Session
            Configuration](#name-convey-dots-signal-channel-){.xref}[¶](#section-toc.1-1.4.2.5.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.5.2.3}
            [4.5.3](#section-4.5.3){.xref}.  [Configuration Freshness
            and
            Notifications](#name-configuration-freshness-and){.xref}[¶](#section-toc.1-1.4.2.5.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.4.2.5.2.4}
            [4.5.4](#section-4.5.4){.xref}.  [Delete DOTS Signal Channel
            Session
            Configuration](#name-delete-dots-signal-channel-){.xref}[¶](#section-toc.1-1.4.2.5.2.4.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.4.2.6}
        [4.6](#section-4.6){.xref}.  [Redirected
        Signaling](#name-redirected-signaling){.xref}[¶](#section-toc.1-1.4.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.7}
        [4.7](#section-4.7){.xref}.  [Heartbeat
        Mechanism](#name-heartbeat-mechanism){.xref}[¶](#section-toc.1-1.4.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [DOTS Signal Channel YANG
    Modules](#name-dots-signal-channel-yang-mo){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Tree
        Structure](#name-tree-structure){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [IANA DOTS Signal Channel YANG
        Module](#name-iana-dots-signal-channel-ya){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [IETF DOTS Signal Channel YANG
        Module](#name-ietf-dots-signal-channel-ya){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [YANG/JSON Mapping Parameters to
    CBOR](#name-yang-json-mapping-parameter){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [(D)TLS Protocol Profile and Performance
    Considerations](#name-dtls-protocol-profile-and-p){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [(D)TLS Protocol
        Profile](#name-dtls-protocol-profile){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [(D)TLS 1.3
        Considerations](#name-dtls-13-considerations){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.3}
        [7.3](#section-7.3){.xref}.  [DTLS MTU and
        Fragmentation](#name-dtls-mtu-and-fragmentation){.xref}[¶](#section-toc.1-1.7.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Mutual Authentication of DOTS Agents &
    Authorization of DOTS
    Clients](#name-mutual-authentication-of-do){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [DOTS Signal Channel UDP and TCP
        Port
        Number](#name-dots-signal-channel-udp-and){.xref}[¶](#section-toc.1-1.9.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Well-Known \'dots\'
        URI](#name-well-known-dots-uri){.xref}[¶](#section-toc.1-1.9.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.3}
        [9.3](#section-9.3){.xref}.  [Media Type
        Registration](#name-media-type-registration){.xref}[¶](#section-toc.1-1.9.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.4}
        [9.4](#section-9.4){.xref}.  [CoAP Content-Formats
        Registration](#name-coap-content-formats-regist){.xref}[¶](#section-toc.1-1.9.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.5}
        [9.5](#section-9.5){.xref}.  [CBOR Tag
        Registration](#name-cbor-tag-registration){.xref}[¶](#section-toc.1-1.9.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.9.2.6}
        [9.6](#section-9.6){.xref}.  [DOTS Signal Channel Protocol
        Registry](#name-dots-signal-channel-protoco){.xref}[¶](#section-toc.1-1.9.2.6.1){.pilcrow}

        -   ::: {#section-toc.1-1.9.2.6.2.1}
            [9.6.1](#section-9.6.1){.xref}.  [DOTS Signal Channel CBOR
            Key Values
            Subregistry](#name-dots-signal-channel-cbor-ke){.xref}[¶](#section-toc.1-1.9.2.6.2.1.1){.pilcrow}

            -   ::: {#section-toc.1-1.9.2.6.2.1.2.1}
                [9.6.1.1](#section-9.6.1.1){.xref}.  [Registration
                Template](#name-registration-template){.xref}[¶](#section-toc.1-1.9.2.6.2.1.2.1.1){.pilcrow}
                :::

            -   ::: {#section-toc.1-1.9.2.6.2.1.2.2}
                [9.6.1.2](#section-9.6.1.2){.xref}.  [Initial
                Subregistry
                Content](#name-initial-subregistry-content){.xref}[¶](#section-toc.1-1.9.2.6.2.1.2.2.1){.pilcrow}
                :::
            :::

        -   ::: {#section-toc.1-1.9.2.6.2.2}
            [9.6.2](#section-9.6.2){.xref}.  [Status Codes
            Subregistry](#name-status-codes-subregistry){.xref}[¶](#section-toc.1-1.9.2.6.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.6.2.3}
            [9.6.3](#section-9.6.3){.xref}.  [Conflict Status Codes
            Subregistry](#name-conflict-status-codes-subre){.xref}[¶](#section-toc.1-1.9.2.6.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.6.2.4}
            [9.6.4](#section-9.6.4){.xref}.  [Conflict Cause Codes
            Subregistry](#name-conflict-cause-codes-subreg){.xref}[¶](#section-toc.1-1.9.2.6.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.9.2.6.2.5}
            [9.6.5](#section-9.6.5){.xref}.  [Attack Status Codes
            Subregistry](#name-attack-status-codes-subregi){.xref}[¶](#section-toc.1-1.9.2.6.2.5.1){.pilcrow}
            :::
        :::

    -   ::: {#section-toc.1-1.9.2.7}
        [9.7](#section-9.7){.xref}.  [DOTS Signal Channel YANG
        Modules](#name-dots-signal-channel-yang-mod){.xref}[¶](#section-toc.1-1.9.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}

    -   ::: {#section-toc.1-1.11.2.1}
        [11.1](#section-11.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.11.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.11.2.2}
        [11.2](#section-11.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.11.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.12}
    [Appendix A](#section-appendix.a){.xref}.  [CUID
    Generation](#name-cuid-generation){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.b){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.c){.xref}[Contributors](#name-contributors){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.15}
    [](#section-appendix.d){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.15.1){.pilcrow}
    :::
:::
:::

::: {#introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

A Distributed Denial-of-Service (DDoS) attack is a distributed attempt
to make machines or network resources unavailable to their intended
users. In most cases, sufficient scale for an effective attack can be
achieved by compromising enough end hosts and using those infected hosts
to perpetrate and amplify the attack. The victim in this attack can be
an application server, a host, a router, a firewall, or an entire
network.[¶](#section-1-1){.pilcrow}

Network applications have finite resources like CPU cycles, the number
of processes or threads they can create and use, the maximum number of
simultaneous connections they can handle, the resources assigned to the
control plane, etc. When processing network traffic, such applications
are supposed to use these resources to provide the intended
functionality in the most efficient manner. However, a DDoS attacker may
be able to prevent an application from performing its intended task by
making the application exhaust its finite
resources.[¶](#section-1-2){.pilcrow}

A TCP DDoS SYN flood \[[RFC4987](#RFC4987){.xref}\], for example, is a
memory-exhausting attack while an ACK flood is a CPU-exhausting attack.
Attacks on the link are carried out by sending enough traffic so that
the link becomes congested, thereby likely causing packet loss for
legitimate traffic. Stateful firewalls can also be attacked by sending
traffic that causes the firewall to maintain an excessive number of
states that may jeopardize the firewall\'s operation overall, in
addition to likely performance impacts. The firewall then runs out of
memory, and it can no longer instantiate the states required to process
legitimate flows. Other possible DDoS attacks are discussed in
\[[RFC4732](#RFC4732){.xref}\].[¶](#section-1-3){.pilcrow}

In many cases, it may not be possible for network administrators to
determine the cause(s) of an attack. They may instead just realize that
certain resources seem to be under attack. This document defines a
lightweight protocol that allows a DOTS client to request mitigation
from one or more DOTS servers for protection against detected,
suspected, or anticipated attacks. This protocol enables cooperation
between DOTS agents to permit a highly automated network defense that is
robust, reliable, and secure. Note that \"secure\" means the support of
the features defined in [Section
2.4](https://www.rfc-editor.org/rfc/rfc8612#section-2.4){.relref} of
\[[RFC8612](#RFC8612){.xref}\].[¶](#section-1-4){.pilcrow}

An example of a network diagram that illustrates a deployment of DOTS
agents is shown in [Figure 1](#fig1){.xref}. In this example, a DOTS
server is operating on the access network. A DOTS client is located on
the LAN (Local Area Network), while a DOTS gateway is embedded in the
CPE (Customer Premises Equipment).[¶](#section-1-5){.pilcrow}

[]{#name-sample-dots-deployment-1}

::: {#fig1}
::: {#section-1-6.1 .artwork .art-text .alignCenter}
      Network
      Resource         CPE Router        Access Network     __________
    +-----------+   +--------------+    +-------------+    /          \
    |           |___|              |____|             |___ | Internet |
    |DOTS Client|   | DOTS Gateway |    | DOTS Server |    |          |
    |           |   |              |    |             |    |          |
    +-----------+   +--------------+    +-------------+    \__________/
:::

[Figure 1](#figure-1){.selfRef}: [Sample DOTS Deployment
(1)](#name-sample-dots-deployment-1){.selfRef}
:::

DOTS servers can also be reachable over the Internet, as depicted in
[Figure 2](#fig_blah){.xref}.[¶](#section-1-7){.pilcrow}

[]{#name-sample-dots-deployment-2}

::: {#fig_blah}
::: {#section-1-8.1 .artwork .art-text .alignCenter}
      Network                                           DDoS Mitigation
      Resource         CPE Router        __________         Service
    +-----------+   +--------------+    /          \    +-------------+
    |           |___|              |____|          |___ |             |
    |DOTS Client|   | DOTS Gateway |    | Internet |    | DOTS Server |
    |           |   |              |    |          |    |             |
    +-----------+   +--------------+    \__________/    +-------------+
:::

[Figure 2](#figure-2){.selfRef}: [Sample DOTS Deployment
(2)](#name-sample-dots-deployment-2){.selfRef}
:::

In typical deployments, the DOTS client belongs to a different
administrative domain than the DOTS server. For example, the DOTS client
is embedded in a firewall protecting services owned and operated by a
customer, while the DOTS server is owned and operated by a different
administrative entity (service provider, typically) providing DDoS
mitigation services. The latter might or might not provide connectivity
services to the network hosting the DOTS
client.[¶](#section-1-9){.pilcrow}

The DOTS server may (not) be co-located with the DOTS mitigator. In
typical deployments, the DOTS server belongs to the same administrative
domain as the mitigator. The DOTS client can communicate directly with a
DOTS server or indirectly via a DOTS
gateway.[¶](#section-1-10){.pilcrow}

This document adheres to the DOTS architecture
\[[DOTS-ARCH](#I-D.ietf-dots-architecture){.xref}\]. The requirements
for DOTS signal channel protocol are documented in
\[[RFC8612](#RFC8612){.xref}\]. This document satisfies all the use
cases discussed in
\[[DOTS-USE-CASES](#I-D.ietf-dots-use-cases){.xref}\].[¶](#section-1-11){.pilcrow}

This document focuses on the DOTS signal channel. This is a companion
document of the DOTS data channel specification
\[[RFC8783](#RFC8783){.xref}\] that defines a configuration and a bulk
data exchange mechanism supporting the DOTS signal
channel.[¶](#section-1-12){.pilcrow}
:::
:::

::: {#notation}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14
\[[RFC2119](#RFC2119){.xref}\]\[[RFC8174](#RFC8174){.xref}\] when, and
only when, they appear in all capitals, as shown
here.[¶](#section-2-1){.pilcrow}

(D)TLS is used for statements that apply to both Transport Layer
Security \[[RFC5246](#RFC5246){.xref}\] \[[RFC8446](#RFC8446){.xref}\]
and Datagram Transport Layer Security \[[RFC6347](#RFC6347){.xref}\].
Specific terms are used for any statement that applies to either
protocol alone.[¶](#section-2-2){.pilcrow}

The reader should be familiar with the terms defined in
\[[RFC8612](#RFC8612){.xref}\].[¶](#section-2-3){.pilcrow}

The meaning of the symbols in YANG tree diagrams is defined in
\[[RFC8340](#RFC8340){.xref}\].[¶](#section-2-4){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Design Overview](#name-design-overview){.section-name .selfRef} {#name-design-overview}

The DOTS signal channel is built on top of the Constrained Application
Protocol (CoAP) \[[RFC7252](#RFC7252){.xref}\], a lightweight protocol
originally designed for constrained devices and networks. The many
features of CoAP (expectation of packet loss, support for asynchronous
Non-confirmable messaging, congestion control, small message overhead
limiting the need for fragmentation, use of minimal resources, and
support for (D)TLS) make it a good candidate upon which to build the
DOTS signaling mechanism.[¶](#section-3-1){.pilcrow}

DOTS clients and servers behave as CoAP endpoints. By default, a DOTS
client (or server) behaves as a CoAP client (or server). Nevertheless, a
DOTS client (or server) behaves as a CoAP server (or client) for
specific operations such as DOTS heartbeat operations ([Section
4.7](#hb){.xref}).[¶](#section-3-2){.pilcrow}

The DOTS signal channel is layered on existing standards (see [Figure
3](#fig_dots){.xref}).[¶](#section-3-3){.pilcrow}

[]{#name-abstract-layering-of-dots-s}

::: {#fig_dots}
::: {#section-3-4.1 .artwork .art-text .alignCenter}
    +---------------------+
    | DOTS Signal Channel |
    +---------------------+
    |         CoAP        |
    +----------+----------+
    |   TLS    |   DTLS   |
    +----------+----------+
    |   TCP    |   UDP    |
    +----------+----------+
    |          IP         |
    +---------------------+
:::

[Figure 3](#figure-3){.selfRef}: [Abstract Layering of DOTS Signal
Channel over CoAP over
(D)TLS](#name-abstract-layering-of-dots-s){.selfRef}
:::

In some cases, a DOTS client and server may have a mutual agreement to
use a specific port number, such as by explicit configuration or dynamic
discovery
\[[DOTS-SERVER-DISC](#I-D.ietf-dots-server-discovery){.xref}\]. Absent
such mutual agreement, the DOTS signal channel [MUST]{.bcp14} run over
port number 4646 as defined in [Section 9.1](#port){.xref}, for both UDP
and TCP. In order to use a distinct port number (as opposed to 4646),
DOTS clients and servers [SHOULD]{.bcp14} support a configurable
parameter to supply the port number to use.[¶](#section-3-5){.pilcrow}

Note: The rationale for not using the default port number 5684 ((D)TLS
CoAP) is to avoid the discovery of services and resources discussed in
\[[RFC7252](#RFC7252){.xref}\] and allow for differentiated behaviors in
environments where both a DOTS gateway and an Internet of Things (IoT)
gateway (e.g., Figure 3 of \[[RFC7452](#RFC7452){.xref}\]) are
co-located.[¶](#section-3-6.1){.pilcrow}

Particularly, the use of a default port number is meant to simplify DOTS
deployment in scenarios where no explicit IP address configuration is
required. For example, the use of the default router as the DOTS server
aims to ease DOTS deployment within LANs (in which CPEs embed a DOTS
gateway as illustrated in Figures [1](#fig1){.xref} and
[2](#fig_blah){.xref}) without requiring a sophisticated discovery
method and configuration tasks within the LAN. It is also possible to
use anycast addresses for DOTS servers to simplify DOTS client
configuration, including service discovery. In such an anycast-based
scenario, a DOTS client initiating a DOTS session to the DOTS server
anycast address may, for example, be (1) redirected to the DOTS server
unicast address to be used by the DOTS client following the procedure
discussed in [Section 4.6](#redirect){.xref} or (2) relayed to a unicast
DOTS server.[¶](#section-3-6.2){.pilcrow}

The signal channel uses the \"coaps\" URI scheme defined in [Section
6](https://www.rfc-editor.org/rfc/rfc7252#section-6){.relref} of
\[[RFC7252](#RFC7252){.xref}\] and the \"coaps+tcp\" URI scheme defined
in [Section
8.2](https://www.rfc-editor.org/rfc/rfc8323#section-8.2){.relref} of
\[[RFC8323](#RFC8323){.xref}\] to identify DOTS server resources that
are accessible using CoAP over UDP secured with DTLS and CoAP over TCP
secured with TLS, respectively.[¶](#section-3-7){.pilcrow}

The DOTS signal channel can be established between two DOTS agents prior
to or during an attack. The DOTS signal channel is initiated by the DOTS
client. The DOTS client can then negotiate, configure, and retrieve the
DOTS signal channel session behavior with its DOTS peer ([Section
4.5](#sigconfig){.xref}). Once the signal channel is established, the
DOTS agents may periodically send heartbeats to keep the channel active
([Section 4.7](#hb){.xref}). At any time, the DOTS client may send a
mitigation request message ([Section 4.4](#m_req){.xref}) to a DOTS
server over the active signal channel. While mitigation is active
(because of the higher likelihood of packet loss during a DDoS attack),
the DOTS server periodically sends status messages to the client,
including basic mitigation feedback details. Mitigation remains active
until the DOTS client explicitly terminates mitigation or the mitigation
lifetime expires. Also, the DOTS server may rely on the signal channel
session loss to trigger mitigation for preconfigured mitigation requests
(if any).[¶](#section-3-8){.pilcrow}

DOTS signaling can happen with DTLS over UDP and TLS over TCP. Likewise,
DOTS requests may be sent using IPv4 or IPv6 transfer capabilities. A
Happy Eyeballs procedure for the DOTS signal channel is specified in
[Section 4.3](#HE){.xref}.[¶](#section-3-9){.pilcrow}

A DOTS client is entitled to access only the resources it creates. In
particular, a DOTS client cannot retrieve data related to mitigation
requests created by other DOTS clients of the same DOTS client
domain.[¶](#section-3-10){.pilcrow}

Messages exchanged between DOTS agents are serialized using Concise
Binary Object Representation (CBOR) \[[RFC7049](#RFC7049){.xref}\], a
binary encoding scheme designed for small code and message size.
CBOR-encoded payloads are used to carry signal channel-specific payload
messages that convey request parameters and response information such as
errors. In order to allow the reusing of data models across protocols,
\[[RFC7951](#RFC7951){.xref}\] specifies the JavaScript Object Notation
(JSON) encoding of YANG-modeled data. A similar effort for CBOR is
defined in
\[[CORE-YANG-CBOR](#I-D.ietf-core-yang-cbor){.xref}\].[¶](#section-3-11){.pilcrow}

DOTS agents determine that a CBOR data structure is a DOTS signal
channel object from the application context, such as from the port
number assigned to the DOTS signal channel. The other method DOTS agents
use to indicate that a CBOR data structure is a DOTS signal channel
object is the use of the \"application/dots+cbor\" content type
([Section 9.3](#MediaReg){.xref}).[¶](#section-3-12){.pilcrow}

This document specifies a YANG module for representing DOTS mitigation
scopes, DOTS signal channel session configuration data, and DOTS
redirected signaling ([Section 5](#YANG){.xref}). All parameters in the
payload of the DOTS signal channel are mapped to CBOR types as specified
in [Table 5](#cbor-key-values){.xref} ([Section
6](#mapping){.xref}).[¶](#section-3-13){.pilcrow}

In order to prevent fragmentation, DOTS agents must follow the
recommendations documented in [Section
4.6](https://www.rfc-editor.org/rfc/rfc7252#section-4.6){.relref} of
\[[RFC7252](#RFC7252){.xref}\]. Refer to [Section 7.3](#mtu){.xref} for
more details.[¶](#section-3-14){.pilcrow}

DOTS agents [MUST]{.bcp14} support GET, PUT, and DELETE CoAP methods.
The payload included in CoAP responses with 2.xx Response Codes
[MUST]{.bcp14} be of content type \"application/dots+cbor\". CoAP
responses with 4.xx and 5.xx error Response Codes [MUST]{.bcp14} include
a diagnostic payload ([Section
5.5.2](https://www.rfc-editor.org/rfc/rfc7252#section-5.5.2){.relref} of
\[[RFC7252](#RFC7252){.xref}\]). The diagnostic payload may contain
additional information to aid
troubleshooting.[¶](#section-3-15){.pilcrow}

In deployments where multiple DOTS clients are enabled in a network
(owned and operated by the same entity), the DOTS server may detect
conflicting mitigation requests from these clients. This document does
not aim to specify a comprehensive list of conditions under which a DOTS
server will characterize two mitigation requests from distinct DOTS
clients as conflicting, nor does it recommend a DOTS server behavior for
processing conflicting mitigation requests. Those considerations are
implementation and deployment specific. Nevertheless, this document
specifies the mechanisms to notify DOTS clients when conflicts occur,
including the conflict cause ([Section
4.4](#m_req){.xref}).[¶](#section-3-16){.pilcrow}

In deployments where one or more translators (e.g., Traditional NAT
\[[RFC3022](#RFC3022){.xref}\], CGN \[[RFC6888](#RFC6888){.xref}\],
NAT64 \[[RFC6146](#RFC6146){.xref}\], NPTv6
\[[RFC6296](#RFC6296){.xref}\]) are enabled between the client\'s
network and the DOTS server, any DOTS signal channel messages forwarded
to a DOTS server [MUST NOT]{.bcp14} include internal IP
addresses/prefixes and/or port numbers; instead, external
addresses/prefixes and/or port numbers as assigned by the translator
[MUST]{.bcp14} be used. This document does not make any recommendations
about possible translator discovery mechanisms. The following are some
(non-exhaustive) deployment examples that may be
considered:[¶](#section-3-17){.pilcrow}

-   [Port Control Protocol (PCP) \[[RFC6887](#RFC6887){.xref}\] or
    Session Traversal Utilities for NAT (STUN)
    \[[RFC8489](#RFC8489){.xref}\] may be used to retrieve the external
    addresses/prefixes and/or port numbers. Information retrieved by
    means of PCP or STUN will be used to feed the DOTS signal channel
    messages that will be sent to a DOTS
    server.[¶](#section-3-18.1){.pilcrow}]{#section-3-18.1}
-   [A DOTS gateway may be co-located with the translator. The DOTS
    gateway will need to update the DOTS messages based upon the local
    translator\'s binding
    table.[¶](#section-3-18.2){.pilcrow}]{#section-3-18.2}
:::

::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [DOTS Signal Channel: Messages & Behaviors](#name-dots-signal-channel-message){.section-name .selfRef} {#name-dots-signal-channel-message}

::: {#discover}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [DOTS Server(s) Discovery](#name-dots-servers-discovery){.section-name .selfRef} {#name-dots-servers-discovery}

This document assumes that DOTS clients are provisioned with the
reachability information of their DOTS server(s) using any of a variety
of means (e.g., local configuration or dynamic means such as DHCP
\[[DOTS-SERVER-DISC](#I-D.ietf-dots-server-discovery){.xref}\]). The
description of such means is out of scope of this
document.[¶](#section-4.1-1){.pilcrow}

Likewise, it is out of the scope of this document to specify the
behavior to be followed by a DOTS client in order to send DOTS requests
when multiple DOTS servers are provisioned (e.g., contact all DOTS
servers, select one DOTS server among the list). Such behavior is
specified in other documents (e.g.,
\[[DOTS-MH](#I-D.ietf-dots-multihoming){.xref}\]).[¶](#section-4.1-2){.pilcrow}
:::
:::

::: {#uri-path}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [CoAP URIs](#name-coap-uris){.section-name .selfRef} {#name-coap-uris}

The DOTS server [MUST]{.bcp14} support the use of the path prefix of
\"/.well-known/\" as defined in \[[RFC8615](#RFC8615){.xref}\] and the
registered name of \"dots\". Each DOTS operation is denoted by a path
suffix that indicates the intended operation. The operation path ([Table
1](#uris){.xref}) is appended to the path prefix to form the URI used
with a CoAP request to perform the desired DOTS
operation.[¶](#section-4.2-1){.pilcrow}

[]{#name-operations-and-correspondin}

::: {#uris}
  Operation               Operation Path   Details
  ----------------------- ---------------- ----------------------------------
  Mitigation              /mitigate        [Section 4.4](#m_req){.xref}
  Session configuration   /config          [Section 4.5](#sigconfig){.xref}
  Heartbeat               /hb              [Section 4.7](#hb){.xref}

  : [Table 1](#table-1){.selfRef}: [Operations and Corresponding
  URIs](#name-operations-and-correspondin){.selfRef}
:::
:::
:::

::: {#HE}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Happy Eyeballs for DOTS Signal Channel](#name-happy-eyeballs-for-dots-sig){.section-name .selfRef} {#name-happy-eyeballs-for-dots-sig}

\[[RFC8612](#RFC8612){.xref}\] mentions that DOTS agents will have to
support both connectionless and connection-oriented protocols. As such,
the DOTS signal channel is designed to operate with DTLS over UDP and
TLS over TCP. Further, a DOTS client may acquire a list of IPv4 and IPv6
addresses ([Section 4.1](#discover){.xref}), each of which can be used
to contact the DOTS server using UDP and TCP. If no list of IPv4 and
IPv6 addresses to contact the DOTS server is configured (or discovered),
the DOTS client adds the IPv4/IPv6 addresses of its default router to
the candidate list to contact the DOTS
server.[¶](#section-4.3-1){.pilcrow}

The following specifies the procedure to follow to select the address
family and the transport protocol for sending DOTS signal channel
messages.[¶](#section-4.3-2){.pilcrow}

Such a procedure is needed to avoid experiencing long connection delays.
For example, if an IPv4 path to a DOTS server is functional, but the
DOTS server\'s IPv6 path is nonfunctional, a dual-stack DOTS client may
experience a significant connection delay compared to an IPv4-only DOTS
client in the same network conditions. The other problem is that if a
middlebox between the DOTS client and DOTS server is configured to block
UDP traffic, the DOTS client will fail to establish a DTLS association
with the DOTS server; consequently, it will have to fall back to TLS
over TCP, thereby incurring significant connection
delays.[¶](#section-4.3-3){.pilcrow}

To overcome these connection setup problems, the DOTS client attempts to
connect to its DOTS server(s) using both IPv6 and IPv4, and it tries
both DTLS over UDP and TLS over TCP following a DOTS Happy Eyeballs
approach. To some extent, this approach is similar to the Happy Eyeballs
mechanism defined in \[[RFC8305](#RFC8305){.xref}\]. The connection
attempts are performed by the DOTS client when it initializes or, in
general, when it has to select an address family and transport to
contact its DOTS server. The results of the Happy Eyeballs procedure are
used by the DOTS client for sending its subsequent messages to the DOTS
server. The differences in behavior with respect to the Happy Eyeballs
mechanism \[[RFC8305](#RFC8305){.xref}\] are listed
below:[¶](#section-4.3-4){.pilcrow}

-   [The order of preference of the DOTS signal channel address family
    and transport protocol (most preferred first) is the following: UDP
    over IPv6, UDP over IPv4, TCP over IPv6, and finally TCP over IPv4.
    This order adheres to the address preference order specified in
    \[[RFC6724](#RFC6724){.xref}\] and the DOTS signal channel
    preference that promotes the use of UDP over TCP (to avoid TCP\'s
    head of line
    blocking).[¶](#section-4.3-5.1){.pilcrow}]{#section-4.3-5.1}
-   [After successfully establishing a connection, the DOTS client
    [MUST]{.bcp14} cache information regarding the outcome of each
    connection attempt for a specific time period; it uses that
    information to avoid thrashing the network with subsequent attempts.
    The cached information is flushed when its age exceeds a specific
    time period on the order of few minutes (e.g., 10 min). Typically,
    if the DOTS client has to reestablish the connection with the same
    DOTS server within a few seconds after the Happy Eyeballs mechanism
    is completed, caching avoids thrashing the network especially in the
    presence of DDoS attack
    traffic.[¶](#section-4.3-5.2){.pilcrow}]{#section-4.3-5.2}
-   [If a DOTS signal channel session is established with TLS (but DTLS
    failed), the DOTS client periodically repeats the mechanism to
    discover whether DOTS signal channel messages with DTLS over UDP
    become available from the DOTS server; this is so the DOTS client
    can migrate the DOTS signal channel from TCP to UDP. Such probing
    [SHOULD NOT]{.bcp14} be done more frequently than every 24 hours and
    [MUST NOT]{.bcp14} be done more frequently than every 5
    minutes.[¶](#section-4.3-5.3){.pilcrow}]{#section-4.3-5.3}

When connection attempts are made during an attack, the DOTS client
[SHOULD]{.bcp14} use a \"Connection Attempt Delay\"
\[[RFC8305](#RFC8305){.xref}\] set to 100
ms.[¶](#section-4.3-6){.pilcrow}

In [Figure 4](#fig_happy_eyeballs){.xref}, the DOTS client proceeds with
the connection attempts following the rules in
\[[RFC8305](#RFC8305){.xref}\]. In this example, it is assumed that the
IPv6 path is broken and UDP traffic is dropped by a middlebox, but this
has little impact on the DOTS client because there is not a long delay
before using IPv4 and TCP.[¶](#section-4.3-7){.pilcrow}

[]{#name-dots-happy-eyeballs-sample-}

::: {#fig_happy_eyeballs}
::: {#section-4.3-8.1 .artwork .art-text .alignCenter}
     +-----------+                                         +-----------+
     |DOTS Client|                                         |DOTS Server|
     +-----------+                                         +-----------+
           |                                                     |
        T0 |--DTLS ClientHello, IPv6 ---->X                      |
        T1 |--DTLS ClientHello, IPv4 ---->X                      |
        T2 |--TCP SYN, IPv6-------------->X                      |
        T3 |--TCP SYN, IPv4------------------------------------->|
           |<-TCP SYNACK-----------------------------------------|
           |--TCP ACK------------------------------------------->|
           |<------------Establish TLS Session------------------>|
           |----------------DOTS signal------------------------->|
           |                                                     |

      Note:
       * Retransmission messages are not shown.
       * T1-T0=T2-T1=T3-T2= Connection Attempt Delay.
:::

[Figure 4](#figure-4){.selfRef}: [DOTS Happy Eyeballs (Sample
Flow)](#name-dots-happy-eyeballs-sample-){.selfRef}
:::

A single DOTS signal channel between DOTS agents can be used to exchange
multiple DOTS signal messages. To reduce DOTS client and DOTS server
workload, DOTS clients [SHOULD]{.bcp14} reuse the (D)TLS
session.[¶](#section-4.3-9){.pilcrow}
:::
:::

::: {#m_req}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [DOTS Mitigation Methods](#name-dots-mitigation-methods){.section-name .selfRef} {#name-dots-mitigation-methods}

The following methods are used by a DOTS client to request, withdraw, or
retrieve the status of mitigation requests:[¶](#section-4.4-1){.pilcrow}

PUT:
:   DOTS clients use the PUT method to request mitigation from a DOTS
    server ([Section 4.4.1](#post){.xref}). During active mitigation,
    DOTS clients may use PUT requests to carry mitigation efficacy
    updates to the DOTS server ([Section
    4.4.3](#put){.xref}).[¶](#section-4.4-2.2){.pilcrow}
:   

GET:
:   DOTS clients may use the GET method to subscribe to DOTS server
    status messages or to retrieve the list of its mitigations
    maintained by a DOTS server ([Section
    4.4.2](#get){.xref}).[¶](#section-4.4-2.4){.pilcrow}
:   

DELETE:
:   DOTS clients use the DELETE method to withdraw a request for
    mitigation from a DOTS server ([Section
    4.4.4](#del){.xref}).[¶](#section-4.4-2.6){.pilcrow}
:   

Mitigation request and response messages are marked as Non-confirmable
messages ([Section
2.2](https://www.rfc-editor.org/rfc/rfc7252#section-2.2){.relref} of
\[[RFC7252](#RFC7252){.xref}\]).[¶](#section-4.4-3){.pilcrow}

DOTS agents [MUST NOT]{.bcp14} send more than one UDP datagram per
round-trip time (RTT) to the peer DOTS agent on average following the
data transmission guidelines discussed in [Section
3.1.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.3){.relref} of
\[[RFC8085](#RFC8085){.xref}\].[¶](#section-4.4-4){.pilcrow}

Requests marked by the DOTS client as Non-confirmable messages are sent
at regular intervals until a response is received from the DOTS server.
If the DOTS client cannot maintain an RTT estimate, it [MUST
NOT]{.bcp14} send more than one Non-confirmable request every 3 seconds,
and [SHOULD]{.bcp14} use an even less aggressive rate whenever possible
(case 2 in [Section
3.1.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.3){.relref} of
\[[RFC8085](#RFC8085){.xref}\]). Mitigation requests [MUST NOT]{.bcp14}
be delayed because of checks on probing rate ([Section
4.7](https://www.rfc-editor.org/rfc/rfc7252#section-4.7){.relref} of
\[[RFC7252](#RFC7252){.xref}\]).[¶](#section-4.4-5){.pilcrow}

JSON encoding of YANG modeled data \[[RFC7951](#RFC7951){.xref}\] is
used to illustrate the various methods defined in the following
subsections. Also, the examples use the Labels defined in Sections
[9.6.2](#sc){.xref}, [9.6.3](#cs){.xref}, [9.6.4](#cc){.xref}, and
[9.6.5](#as){.xref}.[¶](#section-4.4-6){.pilcrow}

::: {#post}
::: {#section-4.4.1 .section}
#### [4.4.1.](#section-4.4.1){.section-number .selfRef} [Request Mitigation](#name-request-mitigation){.section-name .selfRef} {#name-request-mitigation}

When a DOTS client requires mitigation for some reason, the DOTS client
uses the CoAP PUT method to send a mitigation request to its DOTS
server(s) (Figures [5](#Figure1){.xref} and
[6](#Figure1c){.xref}).[¶](#section-4.4.1-1){.pilcrow}

If a DOTS client is entitled to solicit the DOTS service, the DOTS
server enables mitigation on behalf of the DOTS client by communicating
the DOTS client\'s request to a mitigator (which may be co-located with
the DOTS server) and relaying the feedback of the thus-selected
mitigator to the requesting DOTS client.[¶](#section-4.4.1-2){.pilcrow}

[]{#name-put-to-convey-dots-mitigati}

::: {#Figure1}
::: {#section-4.4.1-3.1}
``` sourcecode
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
  Content-Format: "application/dots+cbor"

  {
    ...
  }
```
:::

[Figure 5](#figure-5){.selfRef}: [PUT to Convey DOTS Mitigation
Requests](#name-put-to-convey-dots-mitigati){.selfRef}
:::

The order of the Uri-Path options is important as it defines the CoAP
resource. In particular, \'mid\' [MUST]{.bcp14} follow
\'cuid\'.[¶](#section-4.4.1-4){.pilcrow}

The additional Uri-Path parameters to those defined in [Section
4.2](#uri-path){.xref} are as follows:[¶](#section-4.4.1-5){.pilcrow}

cuid:

:   Stands for Client Unique Identifier. A globally unique identifier
    that is meant to prevent collisions among DOTS clients, especially
    those from the same domain. It [MUST]{.bcp14} be generated by DOTS
    clients.[¶](#section-4.4.1-6.2.1){.pilcrow}

    For the reasons discussed in [Appendix A](#motiv){.xref},
    implementations [SHOULD]{.bcp14} set \'cuid\' using the following
    procedure: first, the DOTS client inputs one of the following into
    the SHA-256 \[[RFC6234](#RFC6234){.xref}\] cryptographic hash: the
    DER-encoded ASN.1 representation of the Subject Public Key Info
    (SPKI) of its X.509 certificate \[[RFC5280](#RFC5280){.xref}\], its
    raw public key \[[RFC7250](#RFC7250){.xref}\], the \"Pre-Shared Key
    (PSK) identity\" it uses in the TLS 1.2 ClientKeyExchange message,
    or the \"identity\" it uses in the \"pre_shared_key\" TLS 1.3
    extension. Then, the output of the cryptographic hash algorithm is
    truncated to 16 bytes; truncation is done by stripping off the final
    16 bytes. The truncated output is base64url encoded ([Section
    5](https://www.rfc-editor.org/rfc/rfc4648#section-5){.relref} of
    \[[RFC4648](#RFC4648){.xref}\]) with the trailing \"=\" removed from
    the encoding, and the resulting value used as the
    \'cuid\'.[¶](#section-4.4.1-6.2.2){.pilcrow}

    The \'cuid\' is intended to be stable when communicating with a
    given DOTS server, i.e., the \'cuid\' used by a DOTS client [SHOULD
    NOT]{.bcp14} change over time. Distinct \'cuid\' values
    [MAY]{.bcp14} be used by a single DOTS client per DOTS
    server.[¶](#section-4.4.1-6.2.3){.pilcrow}

    If a DOTS client has to change its \'cuid\' for some reason, it
    [MUST NOT]{.bcp14} do so when mitigations are still active for the
    old \'cuid\'. The \'cuid\' [SHOULD]{.bcp14} be 22 characters to
    avoid DOTS signal message fragmentation over UDP. Furthermore, if
    that DOTS client created aliases and filtering entries at the DOTS
    server by means of the DOTS data channel, it [MUST]{.bcp14} delete
    all the entries bound to the old \'cuid\' and reinstall them using
    the new \'cuid\'.[¶](#section-4.4.1-6.2.4){.pilcrow}

    DOTS servers [MUST]{.bcp14} return 4.09 (Conflict) error code to a
    DOTS peer to notify that the \'cuid\' is already in use by another
    DOTS client. Upon receipt of that error code, a new \'cuid\'
    [MUST]{.bcp14} be generated by the DOTS peer (e.g., using
    \[[RFC4122](#RFC4122){.xref}\]).[¶](#section-4.4.1-6.2.5){.pilcrow}

    Client-domain DOTS gateways [MUST]{.bcp14} handle \'cuid\' collision
    directly and it is [RECOMMENDED]{.bcp14} that \'cuid\' collision is
    handled directly by server-domain DOTS
    gateways.[¶](#section-4.4.1-6.2.6){.pilcrow}

    DOTS gateways [MAY]{.bcp14} rewrite the \'cuid\' used by peer DOTS
    clients. Triggers for such rewriting are out of
    scope.[¶](#section-4.4.1-6.2.7){.pilcrow}

    This is a mandatory Uri-Path
    parameter.[¶](#section-4.4.1-6.2.8){.pilcrow}

:   

mid:

:   Identifier for the mitigation request represented with an integer.
    This identifier [MUST]{.bcp14} be unique for each mitigation request
    bound to the DOTS client, i.e., the \'mid\' parameter value in the
    mitigation request needs to be unique (per \'cuid\' and DOTS server)
    relative to the \'mid\' parameter values of active mitigation
    requests conveyed from the DOTS client to the DOTS
    server.[¶](#section-4.4.1-6.4.1){.pilcrow}

    In order to handle out-of-order delivery of mitigation requests,
    \'mid\' values [MUST]{.bcp14} increase
    monotonically.[¶](#section-4.4.1-6.4.2){.pilcrow}

    If the \'mid\' value has reached 3/4 of (2^32^ - 1)
    (i.e., 3221225471) and no attack is detected, the DOTS client
    [MUST]{.bcp14} reset \'mid\' to 0 to handle \'mid\' rollover. If the
    DOTS client maintains mitigation requests with preconfigured scopes,
    it [MUST]{.bcp14} recreate them with the \'mid\' restarting at
    0.[¶](#section-4.4.1-6.4.3){.pilcrow}

    This identifier [MUST]{.bcp14} be generated by the DOTS
    client.[¶](#section-4.4.1-6.4.4){.pilcrow}

    This is a mandatory Uri-Path
    parameter.[¶](#section-4.4.1-6.4.5){.pilcrow}

:   

\'cuid\' and \'mid\' [MUST NOT]{.bcp14} appear in the PUT request
message body ([Figure 6](#Figure1c){.xref}). The schema in [Figure
6](#Figure1c){.xref} uses the types defined in [Section
6](#mapping){.xref}. Note that this figure (and other similar figures
depicting a schema) are non-normative sketches of the structure of the
message.[¶](#section-4.4.1-7){.pilcrow}

[]{#name-put-to-convey-dots-mitigatio}

::: {#Figure1c}
::: {#section-4.4.1-8.1}
``` sourcecode
  {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "string"
           ],
          "target-port-range": [
             {
               "lower-port": number,
               "upper-port": number
             }
           ],
           "target-protocol": [
             number
           ],
           "target-fqdn": [
             "string"
           ],
           "target-uri": [
             "string"
           ],
           "alias-name": [
             "string"
           ],
          "lifetime": number,
          "trigger-mitigation": true|false
        }
      ]
    }
  }
```
:::

[Figure 6](#figure-6){.selfRef}: [PUT to Convey DOTS Mitigation Requests
(Message Body Schema)](#name-put-to-convey-dots-mitigatio){.selfRef}
:::

The parameters in the CBOR body ([Figure 6](#Figure1c){.xref}) of the
PUT request are described below:[¶](#section-4.4.1-9){.pilcrow}

target-prefix:

:   A list of prefixes identifying resources under attack. Prefixes are
    represented using Classless Inter-Domain Routing (CIDR) notation
    \[[RFC4632](#RFC4632){.xref}\].[¶](#section-4.4.1-10.2.1){.pilcrow}

    As a reminder, the prefix length must be less than or equal to 32
    (or 128) for IPv4 (or IPv6).[¶](#section-4.4.1-10.2.2){.pilcrow}

    The prefix list [MUST NOT]{.bcp14} include broadcast, loopback, or
    multicast addresses. These addresses are considered to be invalid
    values. In addition, the DOTS server [MUST]{.bcp14} validate that
    target prefixes are within the scope of the DOTS client domain.
    Other validation checks may be supported by DOTS
    servers.[¶](#section-4.4.1-10.2.3){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.1-10.2.4){.pilcrow}

:   

target-port-range:

:   A list of port numbers bound to resources under
    attack.[¶](#section-4.4.1-10.4.1){.pilcrow}

    A port range is defined by two bounds, a lower port number
    (\'lower-port\') and an upper port number (\'upper-port\'). When
    only \'lower-port\' is present, it represents a single port
    number.[¶](#section-4.4.1-10.4.2){.pilcrow}

    For TCP, UDP, Stream Control Transmission Protocol (SCTP)
    \[[RFC4960](#RFC4960){.xref}\], or Datagram Congestion Control
    Protocol (DCCP) \[[RFC4340](#RFC4340){.xref}\], a range of ports can
    be, for example, 0-1023, 1024-65535, or
    1024-49151.[¶](#section-4.4.1-10.4.3){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.1-10.4.4){.pilcrow}

:   

target-protocol:

:   A list of protocols involved in an attack. Values are taken from the
    IANA protocol registry
    \[[IANA-Proto](#IANA-Proto){.xref}\].[¶](#section-4.4.1-10.6.1){.pilcrow}

    If \'target-protocol\' is not specified, then the request applies to
    any protocol.[¶](#section-4.4.1-10.6.2){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.1-10.6.3){.pilcrow}

:   

target-fqdn:

:   A list of Fully Qualified Domain Names (FQDNs) identifying resources
    under attack
    \[[RFC8499](#RFC8499){.xref}\].[¶](#section-4.4.1-10.8.1){.pilcrow}

    How a name is passed to an underlying name resolution library is
    implementation and deployment specific. Nevertheless, once the name
    is resolved into one or multiple IP addresses, DOTS servers
    [MUST]{.bcp14} apply the same validation checks as those for
    \'target-prefix\'.[¶](#section-4.4.1-10.8.2){.pilcrow}

    The use of FQDNs may be suboptimal
    because:[¶](#section-4.4.1-10.8.3){.pilcrow}

    -   [It induces both an extra load and increased delays on the DOTS
        server to handle and manage DNS resolution
        requests.[¶](#section-4.4.1-10.8.4.1){.pilcrow}]{#section-4.4.1-10.8.4.1}
    -   [It does not guarantee that the DOTS server will resolve a name
        to the same IP addresses that the DOTS client
        does.[¶](#section-4.4.1-10.8.4.2){.pilcrow}]{#section-4.4.1-10.8.4.2}

    This is an optional attribute.[¶](#section-4.4.1-10.8.5){.pilcrow}

:   

target-uri:

:   A list of URIs \[[RFC3986](#RFC3986){.xref}\] identifying resources
    under attack.[¶](#section-4.4.1-10.10.1){.pilcrow}

    The same validation checks used for \'target-fqdn\' [MUST]{.bcp14}
    be followed by DOTS servers to validate a target
    URI.[¶](#section-4.4.1-10.10.2){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.1-10.10.3){.pilcrow}

:   

alias-name:

:   A list of aliases of resources for which the mitigation is
    requested. Aliases can be created using the DOTS data channel
    ([Section
    6.1](https://www.rfc-editor.org/rfc/rfc8783#section-6.1){.relref} of
    \[[RFC8783](#RFC8783){.xref}\]), direct configuration, or other
    means.[¶](#section-4.4.1-10.12.1){.pilcrow}

    An alias is used in subsequent signal channel exchanges to refer
    more efficiently to the resources under
    attack.[¶](#section-4.4.1-10.12.2){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.1-10.12.3){.pilcrow}

:   

lifetime:

:   Lifetime of the mitigation request in seconds. The
    [RECOMMENDED]{.bcp14} lifetime of a mitigation request is 3600
    seconds: this value was chosen to be long enough so that refreshing
    is not typically a burden on the DOTS client, while still making the
    request expire in a timely manner when the client has unexpectedly
    quit. DOTS clients [MUST]{.bcp14} include this parameter in their
    mitigation requests. Upon the expiry of this lifetime, and if the
    request is not refreshed, the mitigation request is removed. The
    request can be refreshed by sending the same request
    again.[¶](#section-4.4.1-10.14.1){.pilcrow}

    A lifetime of \'0\' in a mitigation request is an invalid
    value.[¶](#section-4.4.1-10.14.2){.pilcrow}

    A lifetime of negative one (-1) indicates indefinite lifetime for
    the mitigation request. The DOTS server [MAY]{.bcp14} refuse an
    indefinite lifetime, for policy reasons; the granted lifetime value
    is returned in the response. DOTS clients [MUST]{.bcp14} be prepared
    to not be granted mitigations with indefinite
    lifetimes.[¶](#section-4.4.1-10.14.3){.pilcrow}

    The DOTS server [MUST]{.bcp14} always indicate the actual lifetime
    in the response and the remaining lifetime in status messages sent
    to the DOTS client.[¶](#section-4.4.1-10.14.4){.pilcrow}

    This is a mandatory attribute.[¶](#section-4.4.1-10.14.5){.pilcrow}

:   

trigger-mitigation:

:   If the parameter value is set to \'false\', DDoS mitigation will not
    be triggered for the mitigation request unless the DOTS signal
    channel session is lost.[¶](#section-4.4.1-10.16.1){.pilcrow}

    If the DOTS client ceases to respond to heartbeat messages, the DOTS
    server can detect that the DOTS signal channel session is lost. More
    details are discussed in [Section
    4.7](#hb){.xref}.[¶](#section-4.4.1-10.16.2){.pilcrow}

    The default value of the parameter is \'true\' (that is, the
    mitigation starts immediately). If \'trigger-mitigation\' is not
    present in a request, this is equivalent to receiving a request with
    \'trigger-mitigation\' set to
    \'true\'.[¶](#section-4.4.1-10.16.3){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.1-10.16.4){.pilcrow}

:   

In deployments where server-domain DOTS gateways are enabled, identity
information about the origin source client domain (\'cdid\')
[SHOULD]{.bcp14} be propagated to the DOTS server. That information is
meant to assist the DOTS server in enforcing some policies such as
grouping DOTS clients that belong to the same DOTS domain, limiting the
number of DOTS requests, and identifying the mitigation scope. These
policies can be enforced per client, per client domain, or both. Also,
the identity information may be used for auditing and debugging
purposes.[¶](#section-4.4.1-11){.pilcrow}

[Figure 7](#Figure1a){.xref} shows an example of a request relayed by a
server-domain DOTS gateway.[¶](#section-4.4.1-12){.pilcrow}

[]{#name-put-for-dots-mitigation-req}

::: {#Figure1a}
::: {#section-4.4.1-13.1}
``` sourcecode
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cdid=7eeaf349529eb55ed50113"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
  Content-Format: "application/dots+cbor"

  {
    ...
  }
```
:::

[Figure 7](#figure-7){.selfRef}: [PUT for DOTS Mitigation Request as
Relayed by a DOTS Gateway](#name-put-for-dots-mitigation-req){.selfRef}
:::

A server-domain DOTS gateway [SHOULD]{.bcp14} add the following Uri-Path
parameter:[¶](#section-4.4.1-14){.pilcrow}

cdid:

:   Stands for Client Domain Identifier. The \'cdid\' is conveyed by a
    server-domain DOTS gateway to propagate the source domain identity
    from the gateway\'s client-facing side to the gateway\'s
    server-facing side, and from the gateway\'s server-facing side to
    the DOTS server. \'cdid\' may be used by the final DOTS server for
    policy enforcement purposes (e.g., enforce a quota on filtering
    rules). These policies are deployment
    specific.[¶](#section-4.4.1-15.2.1){.pilcrow}

    Server-domain DOTS gateways [SHOULD]{.bcp14} support a configuration
    option to instruct whether \'cdid\' parameter is to be
    inserted.[¶](#section-4.4.1-15.2.2){.pilcrow}

    In order to accommodate deployments that require enforcing
    per-client policies, per-client domain policies, or a combination
    thereof, server-domain DOTS gateways instructed to insert the
    \'cdid\' parameter [MUST]{.bcp14} supply the SPKI hash of the DOTS
    client X.509 certificate, the DOTS client raw public key, or the
    hash of the \"PSK identity\" in the \'cdid\', following the same
    rules for generating the hash conveyed in \'cuid\', which is then
    used by the ultimate DOTS server to determine the corresponding
    client\'s domain. The \'cdid\' generated by a server-domain gateway
    is likely to be the same as the \'cuid\' except the case in which
    the DOTS message was relayed by a client-domain DOTS gateway or the
    \'cuid\' was generated from a rogue DOTS
    client.[¶](#section-4.4.1-15.2.3){.pilcrow}

    If a DOTS client is provisioned, for example, with distinct
    certificates as a function of the peer server-domain DOTS gateway,
    distinct \'cdid\' values may be supplied by a server-domain DOTS
    gateway. The ultimate DOTS server [MUST]{.bcp14} treat those
    \'cdid\' values as equivalent.[¶](#section-4.4.1-15.2.4){.pilcrow}

    The \'cdid\' attribute [MUST NOT]{.bcp14} be generated and included
    by DOTS clients.[¶](#section-4.4.1-15.2.5){.pilcrow}

    DOTS servers [MUST]{.bcp14} ignore \'cdid\' attributes that are
    directly supplied by source DOTS clients or client-domain DOTS
    gateways. This implies that first server-domain DOTS gateways
    [MUST]{.bcp14} strip \'cdid\' attributes supplied by DOTS clients.
    DOTS servers [SHOULD]{.bcp14} support a configuration parameter to
    identify DOTS gateways that are trusted to supply \'cdid\'
    attributes.[¶](#section-4.4.1-15.2.6){.pilcrow}

    Only single-valued \'cdid\' are defined in this document. That is,
    only the first on-path server-domain DOTS gateway can insert a
    \'cdid\' value. This specification does not allow multiple
    server-domain DOTS gateways, whenever involved in the path, to
    insert a \'cdid\' value for each server-domain
    gateway.[¶](#section-4.4.1-15.2.7){.pilcrow}

    This is an optional Uri-Path. When present, \'cdid\' [MUST]{.bcp14}
    be positioned before \'cuid\'.[¶](#section-4.4.1-15.2.8){.pilcrow}

:   

A DOTS gateway [SHOULD]{.bcp14} add the CoAP Hop-Limit option
\[[RFC8768](#RFC8768){.xref}\].[¶](#section-4.4.1-16){.pilcrow}

Because of the complexity of handling partial failure cases, this
specification does not allow the inclusion of multiple mitigation
requests in the same PUT request. Concretely, a DOTS client [MUST
NOT]{.bcp14} include multiple entries in the \'scope\' array of the same
PUT request.[¶](#section-4.4.1-17){.pilcrow}

FQDN and URI mitigation scopes may be thought of as a form of scope
alias, in which the addresses associated with the domain name or URI (as
resolved by the DOTS server) represent the scope of the mitigation.
Particularly, the IP addresses to which the host subcomponent of
authority component of a URI resolves represent the \'target-prefix\',
the URI scheme represents the \'target-protocol\', the port subcomponent
of authority component of a URI represents the \'target-port-range\'. If
the optional port information is not present in the authority component,
the default port defined for the URI scheme represents the
\'target-port\'.[¶](#section-4.4.1-18){.pilcrow}

In the PUT request, at least one of the attributes \'target-prefix\',
\'target-fqdn\',\'target-uri\', or \'alias-name\' [MUST]{.bcp14} be
present.[¶](#section-4.4.1-19){.pilcrow}

Attributes and Uri-Path parameters with empty values [MUST NOT]{.bcp14}
be present in a request as an empty value will render the entire request
invalid.[¶](#section-4.4.1-20){.pilcrow}

[Figure 8](#Figure2){.xref} shows a PUT request example to signal that
servers 2001:db8:6401::1 and 2001:db8:6401::2 are receiving attack
traffic on TCP port numbers 80, 8080, and 443. The presence of \'cdid\'
indicates that a server-domain DOTS gateway has modified the initial PUT
request sent by the DOTS client. Note that \'cdid\' [MUST NOT]{.bcp14}
appear in the PUT request message body.[¶](#section-4.4.1-21){.pilcrow}

[]{#name-put-for-dots-mitigation-requ}

::: {#Figure2}
::: {#section-4.4.1-22.1}
``` sourcecode
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cdid=7eeaf349529eb55ed50113"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
  Content-Format: "application/dots+cbor"

  {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
           ],
          "target-port-range": [
            {
              "lower-port": 80
            },
            {
              "lower-port": 443
            },
            {
               "lower-port": 8080
            }
           ],
           "target-protocol": [
             6
           ],
          "lifetime": 3600
        }
      ]
    }
  }
```
:::

[Figure 8](#figure-8){.selfRef}: [PUT for DOTS Mitigation Request (An
Example)](#name-put-for-dots-mitigation-requ){.selfRef}
:::

The corresponding CBOR encoding format for the payload is shown in
[Figure 9](#Figure2a){.xref}.[¶](#section-4.4.1-23){.pilcrow}

[]{#name-put-for-dots-mitigation-reque}

::: {#Figure2a}
::: {#section-4.4.1-24.1}
``` sourcecode
   A1                                      # map(1)
      01                                   # unsigned(1)
      A1                                   # map(1)
         02                                # unsigned(2)
         81                                # array(1)
            A4                             # map(4)
               06                          # unsigned(6)
               82                          # array(2)
                  74                       # text(20)
                     323030313A6462383A363430313A3A312F313238
                  74                       # text(20)
                     323030313A6462383A363430313A3A322F313238
               07                          # unsigned(7)
               83                          # array(3)
                  A1                       # map(1)
                     08                    # unsigned(8)
                     18 50                 # unsigned(80)
                  A1                       # map(1)
                     08                    # unsigned(8)
                     19 01BB               # unsigned(443)
                  A1                       # map(1)
                     08                    # unsigned(8)
                     19 1F90               # unsigned(8080)
               0A                          # unsigned(10)
               81                          # array(1)
                  06                       # unsigned(6)
               0E                          # unsigned(14)
               19 0E10                     # unsigned(3600)
```
:::

[Figure 9](#figure-9){.selfRef}: [PUT for DOTS Mitigation Request
(CBOR)](#name-put-for-dots-mitigation-reque){.selfRef}
:::

In both DOTS signal and data channel sessions, the DOTS client
[MUST]{.bcp14} authenticate itself to the DOTS server ([Section
8](#mutauth){.xref}). The DOTS server [MAY]{.bcp14} use the algorithm
presented in [Section
7](https://www.rfc-editor.org/rfc/rfc7589#section-7){.relref} of
\[[RFC7589](#RFC7589){.xref}\] to derive the DOTS client identity or
username from the client certificate. The DOTS client identity allows
the DOTS server to accept mitigation requests with scopes that the DOTS
client is authorized to manage.[¶](#section-4.4.1-25){.pilcrow}

The DOTS server couples the DOTS signal and data channel sessions using
the DOTS client identity and optionally the \'cdid\' parameter value, so
the DOTS server can validate whether the aliases conveyed in the
mitigation request were indeed created by the same DOTS client using the
DOTS data channel session. If the aliases were not created by the DOTS
client, the DOTS server [MUST]{.bcp14} return 4.00 (Bad Request) in the
response.[¶](#section-4.4.1-26){.pilcrow}

The DOTS server couples the DOTS signal channel sessions using the DOTS
client identity and optionally the \'cdid\' parameter value, and the
DOTS server uses \'mid\' and \'cuid\' Uri-Path parameter values to
detect duplicate mitigation requests. If the mitigation request contains
the \'alias-name\' and other parameters identifying the target resources
(such as \'target-prefix\', \'target-port-range\', \'target-fqdn\', or
\'target-uri\'), the DOTS server appends the parameter values in
\'alias-name\' with the corresponding parameter values in
\'target-prefix\', \'target-port-range\', \'target-fqdn\', or
\'target-uri\'.[¶](#section-4.4.1-27){.pilcrow}

The DOTS server indicates the result of processing the PUT request using
CoAP Response Codes. CoAP 2.xx codes are success. CoAP 4.xx codes are
some sort of invalid requests (client errors). COAP 5.xx codes are
returned if the DOTS server is in an error state or is currently
unavailable to provide mitigation in response to the mitigation request
from the DOTS client.[¶](#section-4.4.1-28){.pilcrow}

[Figure 10](#put_response){.xref} shows an example response to a PUT
request that is successfully processed by a DOTS server (i.e., CoAP 2.xx
Response Codes). This version of the specification forbids \'cuid\' and
\'cdid\' (if used) to be returned in a response message
body.[¶](#section-4.4.1-29){.pilcrow}

[]{#name-2xx-response-body}

::: {#put_response}
::: {#section-4.4.1-30.1}
``` sourcecode
{
  "ietf-dots-signal-channel:mitigation-scope": {
     "scope": [
        {
          "mid": 123,
          "lifetime": 3600
        }
      ]
   }
}
```
:::

[Figure 10](#figure-10){.selfRef}: [2.xx Response
Body](#name-2xx-response-body){.selfRef}
:::

If the request is missing a mandatory attribute, does not include
\'cuid\' or \'mid\' Uri-Path options, includes multiple \'scope\'
parameters, or contains invalid or unknown parameters, the DOTS server
[MUST]{.bcp14} reply with 4.00 (Bad Request). DOTS agents can safely
ignore comprehension-optional parameters they don\'t understand
([Section 9.6.1.1](#format){.xref}).[¶](#section-4.4.1-31){.pilcrow}

A DOTS server that receives a mitigation request with a \'lifetime\' set
to \'0\' [MUST]{.bcp14} reply with a 4.00 (Bad
Request).[¶](#section-4.4.1-32){.pilcrow}

If the DOTS server does not find the \'mid\' parameter value conveyed in
the PUT request in its configuration data, it [MAY]{.bcp14} accept the
mitigation request by sending back a 2.01 (Created) response to the DOTS
client; the DOTS server will consequently try to mitigate the attack. A
DOTS server could reject mitigation requests when it is near capacity or
needs to rate-limit a particular client, for
example.[¶](#section-4.4.1-33){.pilcrow}

The relative order of two mitigation requests with the same
\'trigger-mitigation\' type from a DOTS client is determined by
comparing their respective \'mid\' values. If two mitigation requests
with the same \'trigger-mitigation\' type have overlapping mitigation
scopes, the mitigation request with the highest numeric \'mid\' value
will override the other mitigation request. Two mitigation requests from
a DOTS client have overlapping scopes if there is a common IP address,
IP prefix, FQDN, URI, or alias. To avoid maintaining a long list of
overlapping mitigation requests (i.e., requests with the same
\'trigger-mitigation\' type and overlapping scopes) from a DOTS client
and to avoid error-prone provisioning of mitigation requests from a DOTS
client, the overlapped lower numeric \'mid\' [MUST]{.bcp14} be
automatically deleted and no longer available at the DOTS server. For
example, if the DOTS server receives a mitigation request that overlaps
with an existing mitigation with a higher numeric \'mid\', the DOTS
server rejects the request by returning 4.09 (Conflict) to the DOTS
client. The response includes enough information for a DOTS client to
recognize the source of the conflict as described below in the
\'conflict-information\' subtree with only the relevant nodes
listed:[¶](#section-4.4.1-34){.pilcrow}

conflict-information:

:   Indicates that a mitigation request is conflicting with another
    mitigation request. This optional attribute has the following
    structure:[¶](#section-4.4.1-35.2.1){.pilcrow}

    conflict-cause:

    :   Indicates the cause of the conflict. The following values are
        defined:[¶](#section-4.4.1-35.2.2.2.1){.pilcrow}

        1:
        :   Overlapping targets. \'conflict-scope\' provides more
            details about the conflicting target
            clauses.[¶](#section-4.4.1-35.2.2.2.2.2){.pilcrow}
        :   

    :   

    conflict-scope:
    :   Characterizes the exact conflict scope. It may include a list of
        IP addresses, a list of prefixes, a list of port numbers, a list
        of target protocols, a list of FQDNs, a list of URIs, a list of
        aliases, or a \'mid\'.[¶](#section-4.4.1-35.2.2.4){.pilcrow}
    :   

:   

If the DOTS server receives a mitigation request that overlaps with an
active mitigation request, but both have distinct \'trigger-mitigation\'
types, the DOTS server [SHOULD]{.bcp14} deactivate (absent explicit
policy/configuration otherwise) the mitigation request with
\'trigger-mitigation\' set to \'false\'. Particularly, if the mitigation
request with \'trigger-mitigation\' set to \'false\' is active, the DOTS
server withdraws the mitigation request (i.e., status code is set to
\'7\' as defined in [Table 3](#status){.xref}) and transitions the
status of the mitigation request to
\'8\'.[¶](#section-4.4.1-36){.pilcrow}

Upon DOTS signal channel session loss with a peer DOTS client, the DOTS
server [SHOULD]{.bcp14} withdraw (absent explicit policy/configuration
otherwise) any active mitigation requests that overlap with mitigation
requests having \'trigger-mitigation\' set to \'false\' from that DOTS
client, as the loss of the session implicitly activates these
preconfigured mitigation requests, and they take precedence. Note that
the active-but-terminating period is not observed for mitigations
withdrawn at the initiative of the DOTS
server.[¶](#section-4.4.1-37){.pilcrow}

DOTS clients may adopt various strategies for setting the scopes of
immediate and preconfigured mitigation requests to avoid potential
conflicts. For example, a DOTS client may tweak preconfigured scopes so
that the scope of any overlapping immediate mitigation request will be a
subset of the preconfigured scopes. Also, if an immediate mitigation
request overlaps with any of the preconfigured scopes, the DOTS client
sets the scope of the overlapping immediate mitigation request to be a
subset of the preconfigured scopes, so as to get a broad mitigation when
the DOTS signal channel collapses and to maximize the chance of
recovery.[¶](#section-4.4.1-38){.pilcrow}

If the request conflicts with an existing mitigation request from a
different DOTS client, the DOTS server may return 2.01 (Created) or 4.09
(Conflict) to the requesting DOTS client. If the DOTS server decides to
maintain the new mitigation request, the DOTS server returns 2.01
(Created) to the requesting DOTS client. If the DOTS server decides to
reject the new mitigation request, the DOTS server returns 4.09
(Conflict) to the requesting DOTS client. For both 2.01 (Created) and
4.09 (Conflict) responses, the response includes enough information for
a DOTS client to recognize the source of the conflict as described
below:[¶](#section-4.4.1-39){.pilcrow}

conflict-information:

:   Indicates that a mitigation request is conflicting with another
    mitigation request(s) from other DOTS client(s). This optional
    attribute has the following
    structure:[¶](#section-4.4.1-40.2.1){.pilcrow}

    conflict-status:

    :   Indicates the status of a conflicting mitigation request. The
        following values are
        defined:[¶](#section-4.4.1-40.2.2.2.1){.pilcrow}

        1:
        :   DOTS server has detected conflicting mitigation requests
            from different DOTS clients. This mitigation request is
            currently inactive until the conflicts are resolved. Another
            mitigation request is
            active.[¶](#section-4.4.1-40.2.2.2.2.2){.pilcrow}
        :   

        2:
        :   DOTS server has detected conflicting mitigation requests
            from different DOTS clients. This mitigation request is
            currently active.[¶](#section-4.4.1-40.2.2.2.2.4){.pilcrow}
        :   

        3:
        :   DOTS server has detected conflicting mitigation requests
            from different DOTS clients. All conflicting mitigation
            requests are
            inactive.[¶](#section-4.4.1-40.2.2.2.2.6){.pilcrow}
        :   

    :   

    conflict-cause:

    :   Indicates the cause of the conflict. The following values are
        defined:[¶](#section-4.4.1-40.2.2.4.1){.pilcrow}

        1:
        :   Overlapping targets. \'conflict-scope\' provides more
            details about the conflicting target
            clauses.[¶](#section-4.4.1-40.2.2.4.2.2){.pilcrow}
        :   

        2:
        :   Conflicts with an existing accept-list. This code is
            returned when the DDoS mitigation detects source
            addresses/prefixes in the accept-listed ACLs are attacking
            the target.[¶](#section-4.4.1-40.2.2.4.2.4){.pilcrow}
        :   

        3:
        :   CUID Collision. This code is returned when a DOTS client
            uses a \'cuid\' that is already used by another DOTS client.
            This code is an indication that the request has been
            rejected and a new request with a new \'cuid\' is to be
            re-sent by the DOTS client (see the example shown in [Figure
            11](#newcuid){.xref}). Note that \'conflict-status\',
            \'conflict-scope\', and \'retry-timer\' [MUST NOT]{.bcp14}
            be returned in the error
            response.[¶](#section-4.4.1-40.2.2.4.2.6){.pilcrow}
        :   

    :   

    conflict-scope:
    :   Characterizes the exact conflict scope. It may include a list of
        IP addresses, a list of prefixes, a list of port numbers, a list
        of target protocols, a list of FQDNs, a list of URIs, a list of
        aliases, or references to conflicting ACLs (by an \'acl-name\',
        typically
        \[[RFC8783](#RFC8783){.xref}\]).[¶](#section-4.4.1-40.2.2.6){.pilcrow}
    :   

    retry-timer:

    :   Indicates, in seconds, the time after which the DOTS client may
        reissue the same request. The DOTS server returns
        \'retry-timer\' only to DOTS client(s) for which a mitigation
        request is deactivated. Any retransmission of the same
        mitigation request before the expiry of this timer is likely to
        be rejected by the DOTS server for the same
        reasons.[¶](#section-4.4.1-40.2.2.8.1){.pilcrow}

        The \'retry-timer\' [SHOULD]{.bcp14} be equal to the lifetime of
        the active mitigation request resulting in the deactivation of
        the conflicting mitigation
        request.[¶](#section-4.4.1-40.2.2.8.2){.pilcrow}

        If the DOTS server decides to maintain a state for the
        deactivated mitigation request, the DOTS server updates the
        lifetime of the deactivated mitigation request to
        \'retry-timer + 45 seconds\' (that is, this mitigation request
        remains deactivated for the entire duration of \'retry-timer +
        45 seconds\') so that the DOTS client can refresh the
        deactivated mitigation request after \'retry-timer\' seconds,
        but before the expiry of the lifetime, and check if the conflict
        is resolved.[¶](#section-4.4.1-40.2.2.8.3){.pilcrow}

    :   

:   

[]{#name-example-of-generating-a-new}

::: {#newcuid}
::: {#section-4.4.1-41.1}
``` sourcecode
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=7eeaf349529eb55ed50113"
  Uri-Path: "mid=12"

  (1) Request with a conflicting 'cuid'

  {
    "ietf-dots-signal-channel:mitigation-scope": {
       "scope": [
          {
            "conflict-information": {
              "conflict-cause": "cuid-collision"
             }
          }
        ]
     }
  }

  (2) Message body of the 4.09 (Conflict) response
    from the DOTS server

  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=f30d281ce6b64fc5a0b91e"
  Uri-Path: "mid=12"

  (3) Request with a new 'cuid'
```
:::

[Figure 11](#figure-11){.selfRef}: [Example of Generating a New
\'cuid\'](#name-example-of-generating-a-new){.selfRef}
:::

As an active attack evolves, DOTS clients can adjust the scope of
requested mitigation as necessary, by refining the scope of resources
requiring mitigation. This can be achieved by sending a PUT request with
a new \'mid\' value that will override the existing one with overlapping
mitigation scopes.[¶](#section-4.4.1-42){.pilcrow}

For a mitigation request to continue beyond the initial negotiated
lifetime, the DOTS client has to refresh the current mitigation request
by sending a new PUT request. This PUT request [MUST]{.bcp14} use the
same \'mid\' value, and it [MUST]{.bcp14} repeat all the other
parameters as sent in the original mitigation request apart from a
possible change to the \'lifetime\' parameter value. In such a case, the
DOTS server [MAY]{.bcp14} update the mitigation request, and a 2.04
(Changed) response is returned to indicate a successful update of the
mitigation request. If this is not the case, the DOTS server
[MUST]{.bcp14} reject the request with a 4.00 (Bad
Request).[¶](#section-4.4.1-43){.pilcrow}
:::
:::

::: {#get}
::: {#section-4.4.2 .section}
#### [4.4.2.](#section-4.4.2){.section-number .selfRef} [Retrieve Information Related to a Mitigation](#name-retrieve-information-relate){.section-name .selfRef} {#name-retrieve-information-relate}

A GET request is used by a DOTS client to retrieve information
(including status) of DOTS mitigations from a DOTS
server.[¶](#section-4.4.2-1){.pilcrow}

\'cuid\' is a mandatory Uri-Path parameter for GET
requests.[¶](#section-4.4.2-2){.pilcrow}

Uri-Path parameters with empty values [MUST NOT]{.bcp14} be present in a
request.[¶](#section-4.4.2-3){.pilcrow}

The same considerations for manipulating the \'cdid\' parameter by
server-domain DOTS gateways specified in [Section 4.4.1](#post){.xref}
[MUST]{.bcp14} be followed for GET
requests.[¶](#section-4.4.2-4){.pilcrow}

The \'c\' Uri-Query option is used to control selection of configuration
and non-configuration data nodes. Concretely, the \'c\' (content)
parameter and its permitted values defined in [Table
2](#tab-option-controls){.xref} \[[COMI](#I-D.ietf-core-comi){.xref}\]
can be used to retrieve non-configuration data (attack mitigation
status), configuration data, or both. The DOTS server [MAY]{.bcp14}
support this optional filtering capability. It can safely ignore it if
not supported. If the DOTS client supports the optional filtering
capability, it [SHOULD]{.bcp14} use \"c=n\" query (to get back only the
dynamically changing data) or \"c=c\" query (to get back the static
configuration values) when the DDoS attack is active to limit the size
of the response.[¶](#section-4.4.2-5){.pilcrow}

[]{#name-permitted-values-of-the-c-p}

::: {#tab-option-controls}
  Value   Description
  ------- -----------------------------------------------------
  c       Return only configuration descendant data nodes
  n       Return only non-configuration descendant data nodes
  a       Return all descendant data nodes

  : [Table 2](#table-2){.selfRef}: [Permitted Values of the \'c\'
  Parameter](#name-permitted-values-of-the-c-p){.selfRef}
:::

The DOTS client can use block-wise transfer
\[[RFC7959](#RFC7959){.xref}\] to get the list of all its mitigations
maintained by a DOTS server, it can send a Block2 Option in a GET
request with NUM = 0 to aid in limiting the size of the response. If the
representation of all the active mitigation requests associated with the
DOTS client does not fit within a single datagram, the DOTS server
[MUST]{.bcp14} use the Block2 Option with NUM = 0 in the GET response.
The Size2 Option may be conveyed in the response to indicate the total
size of the resource representation. The DOTS client retrieves the rest
of the representation by sending additional GET requests with Block2
Options containing NUM values greater than zero. The DOTS client
[MUST]{.bcp14} adhere to the block size preferences indicated by the
DOTS server in the response. If the DOTS server uses the Block2 Option
in the GET response, and the response is for a dynamically changing
resource (e.g., \"c=n\" or \"c=a\" query), the DOTS server
[MUST]{.bcp14} include the ETag Option in the response. The DOTS client
[MUST]{.bcp14} include the same ETag value in subsequent GET requests to
retrieve the rest of the representation.[¶](#section-4.4.2-7){.pilcrow}

The following examples illustrate how a DOTS client retrieves active
mitigation requests from a DOTS server. In
particular:[¶](#section-4.4.2-8){.pilcrow}

-   [[Figure 12](#Figure4){.xref} shows the example of a GET request to
    retrieve all DOTS mitigation requests signaled by a DOTS
    client.[¶](#section-4.4.2-9.1){.pilcrow}]{#section-4.4.2-9.1}
-   [[Figure 13](#Figure4a){.xref} shows the example of a GET request to
    retrieve a specific DOTS mitigation request signaled by a DOTS
    client. The configuration data to be reported in the response is
    formatted in the same order as it was processed by the DOTS server
    in the original mitigation
    request.[¶](#section-4.4.2-9.2){.pilcrow}]{#section-4.4.2-9.2}

These two examples assume the default of \"c=a\"; that is, the DOTS
client asks for all data to be reported by the DOTS
server.[¶](#section-4.4.2-10){.pilcrow}

[]{#name-get-to-retrieve-all-dots-mi}

::: {#Figure4}
::: {#section-4.4.2-11.1}
``` sourcecode
  Header: GET (Code=0.01)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Observe: 0
```
:::

[Figure 12](#figure-12){.selfRef}: [GET to Retrieve All DOTS Mitigation
Requests](#name-get-to-retrieve-all-dots-mi){.selfRef}
:::

[]{#name-get-to-retrieve-a-specific-}

::: {#Figure4a}
::: {#section-4.4.2-12.1}
``` sourcecode
  Header: GET (Code=0.01)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=12332"
  Observe: 0
```
:::

[Figure 13](#figure-13){.selfRef}: [GET to Retrieve a Specific DOTS
Mitigation Request](#name-get-to-retrieve-a-specific-){.selfRef}
:::

If the DOTS server does not find the \'mid\' Uri-Path value conveyed in
the GET request in its configuration data for the requesting DOTS
client, it [MUST]{.bcp14} respond with a 4.04 (Not Found) error Response
Code. Likewise, the same error [MUST]{.bcp14} be returned as a response
to a request to retrieve all mitigation records (i.e., \'mid\' Uri-Path
is not defined) of a given DOTS client if the DOTS server does not find
any mitigation record for that DOTS client. As a reminder, a DOTS client
is identified by its identity (e.g., client certificate, \'cuid\') and
optionally the \'cdid\'.[¶](#section-4.4.2-13){.pilcrow}

[Figure 14](#Figure5){.xref} shows a response example of all active
mitigation requests associated with the DOTS client as maintained by the
DOTS server. The response indicates the mitigation status of each
mitigation request.[¶](#section-4.4.2-14){.pilcrow}

[]{#name-response-body-to-a-get-requ}

::: {#Figure5}
::: {#section-4.4.2-15.1}
``` sourcecode
{
  "ietf-dots-signal-channel:mitigation-scope": {
    "scope": [
      {
        "mid": 12332,
        "mitigation-start": "1507818434",
        "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
        ],
        "target-protocol": [
          17
        ],
        "lifetime": 1756,
        "status": "attack-successfully-mitigated",
        "bytes-dropped": "134334555",
        "bps-dropped": "43344",
        "pkts-dropped": "333334444",
        "pps-dropped": "432432"
      },
      {
        "mid": 12333,
        "mitigation-start": "1507818393",
        "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
        ],
        "target-protocol": [
          6
        ],
        "lifetime": 1755,
        "status": "attack-stopped",
        "bytes-dropped": "0",
        "bps-dropped": "0",
        "pkts-dropped": "0",
        "pps-dropped": "0"
      }
    ]
  }
}
```
:::

[Figure 14](#figure-14){.selfRef}: [Response Body to a GET
Request](#name-response-body-to-a-get-requ){.selfRef}
:::

The mitigation status parameters are described
below:[¶](#section-4.4.2-16){.pilcrow}

mitigation-start:

:   Mitigation start time is expressed in seconds relative to
    1970-01-01T00:00Z in UTC time ([Section
    2.4.1](https://www.rfc-editor.org/rfc/rfc7049#section-2.4.1){.relref}
    of \[[RFC7049](#RFC7049){.xref}\]). The CBOR encoding is modified so
    that the leading tag 1 (epoch-based date/time) [MUST]{.bcp14} be
    omitted.[¶](#section-4.4.2-17.2.1){.pilcrow}

    This is a mandatory attribute when an attack mitigation is active.
    Particularly, \'mitigation-start\' is not returned for a mitigation
    with \'status\' code set to 8.[¶](#section-4.4.2-17.2.2){.pilcrow}

:   

lifetime:

:   The remaining lifetime of the mitigation request, in
    seconds.[¶](#section-4.4.2-17.4.1){.pilcrow}

    This is a mandatory attribute.[¶](#section-4.4.2-17.4.2){.pilcrow}

:   

status:

:   Status of attack mitigation. The various possible values of
    \'status\' parameter are explained in [Table
    3](#status){.xref}.[¶](#section-4.4.2-17.6.1){.pilcrow}

    This is a mandatory attribute.[¶](#section-4.4.2-17.6.2){.pilcrow}

:   

bytes-dropped:

:   The total dropped byte count for the mitigation request since the
    attack mitigation was triggered. The count wraps around when it
    reaches the maximum value of unsigned
    integer64.[¶](#section-4.4.2-17.8.1){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.2-17.8.2){.pilcrow}

:   

bps-dropped:

:   The average number of dropped bytes per second for the mitigation
    request since the attack mitigation was triggered. This average
    [SHOULD]{.bcp14} be over five-minute intervals (that is, measuring
    bytes into five-minute buckets and then averaging these buckets over
    the time since the mitigation was
    triggered).[¶](#section-4.4.2-17.10.1){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.2-17.10.2){.pilcrow}

:   

pkts-dropped:

:   The total number of dropped packet count for the mitigation request
    since the attack mitigation was triggered. The count wraps around
    when it reaches the maximum value of unsigned
    integer64.[¶](#section-4.4.2-17.12.1){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.2-17.12.2){.pilcrow}

:   

pps-dropped:

:   The average number of dropped packets per second for the mitigation
    request since the attack mitigation was triggered. This average
    [SHOULD]{.bcp14} be over five-minute intervals (that is, measuring
    packets into five-minute buckets and then averaging these buckets
    over the time since the mitigation was
    triggered).[¶](#section-4.4.2-17.14.1){.pilcrow}

    This is an optional attribute.[¶](#section-4.4.2-17.14.2){.pilcrow}

:   

[]{#name-values-of-status-parameter}

::: {#status}
  Parameter Value   Description
  ----------------- -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  1                 Attack mitigation setup is in progress (e.g., changing the network path to redirect the inbound traffic to a DOTS mitigator).
  2                 Attack is being successfully mitigated (e.g., traffic is redirected to a DDoS mitigator and attack traffic is dropped).
  3                 Attack has stopped and the DOTS client can withdraw the mitigation request. This status code will be transmitted for immediate mitigation requests till the mitigation is withdrawn or the lifetime expires. For mitigation requests with preconfigured scopes (i.e., \'trigger-mitigation\' set to \'false\'), this status code will be transmitted four times and then transition to \"8\".
  4                 Attack has exceeded the mitigation provider capability.
  5                 DOTS client has withdrawn the mitigation request and the mitigation is active but terminating.
  6                 Attack mitigation is now terminated.
  7                 Attack mitigation is withdrawn (by the DOTS server). If a mitigation request with \'trigger-mitigation\' set to \'false\' is withdrawn because it overlaps with an immediate mitigation request, this status code will be transmitted four times and then transition to \"8\" for the mitigation request with preconfigured scopes.
  8                 Attack mitigation will be triggered for the mitigation request only when the DOTS signal channel session is lost.

  : [Table 3](#table-3){.selfRef}: [Values of \'status\'
  Parameter](#name-values-of-status-parameter){.selfRef}
:::

::: {#section-4.4.2.1 .section}
##### [4.4.2.1.](#section-4.4.2.1){.section-number .selfRef} [DOTS Servers Sending Mitigation Status](#name-dots-servers-sending-mitiga){.section-name .selfRef} {#name-dots-servers-sending-mitiga}

The Observe Option defined in \[[RFC7641](#RFC7641){.xref}\] extends the
CoAP core protocol with a mechanism for a CoAP client to \"observe\" a
resource on a CoAP server: the client retrieves a representation of the
resource and requests this representation be updated by the server as
long as the client is interested in the resource. DOTS implementations
[MUST]{.bcp14} use the Observe Option for both \'mitigate\' and
\'config\' ([Section
4.2](#uri-path){.xref}).[¶](#section-4.4.2.1-1){.pilcrow}

A DOTS client conveys the Observe Option set to \'0\' in the GET request
to receive asynchronous notifications of attack mitigation status from
the DOTS server.[¶](#section-4.4.2.1-2){.pilcrow}

Unidirectional mitigation notifications within the bidirectional signal
channel enables asynchronous notifications between the agents.
\[[RFC7641](#RFC7641){.xref}\] indicates that (1) a notification can be
sent in a Confirmable or a Non-confirmable message, and (2) the message
type used is typically application dependent and may be determined by
the server for each notification individually. For the DOTS server
application, the message type [MUST]{.bcp14} always be set to
Non-confirmable even if the underlying COAP library elects a
notification to be sent in a Confirmable message. This overrides the
behavior defined in [Section
4.5](https://www.rfc-editor.org/rfc/rfc7641#section-4.5){.relref} of
\[[RFC7641](#RFC7641){.xref}\] to send a Confirmable message instead of
a Non-confirmable message at least every 24 hours for the following
reasons: First, the DOTS signal channel uses a heartbeat mechanism to
determine if the DOTS client is alive. Second, Confirmable messages are
not suitable during an attack.[¶](#section-4.4.2.1-3){.pilcrow}

Due to the higher likelihood of packet loss during a DDoS attack, the
DOTS server periodically sends attack mitigation status to the DOTS
client and also notifies the DOTS client whenever the status of the
attack mitigation changes. If the DOTS server cannot maintain an RTT
estimate, it [MUST NOT]{.bcp14} send more than one asynchronous
notification every 3 seconds, and [SHOULD]{.bcp14} use an even less
aggressive rate whenever possible (case 2 in [Section
3.1.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.3){.relref} of
\[[RFC8085](#RFC8085){.xref}\]).[¶](#section-4.4.2.1-4){.pilcrow}

When conflicting requests are detected, the DOTS server enforces the
corresponding policy (e.g., accept all requests, reject all requests,
accept only one request but reject all the others, etc.). It is assumed
that this policy is supplied by the DOTS server administrator or that it
is a default behavior of the DOTS server implementation. Then, the DOTS
server sends a notification message(s) to the DOTS client(s) at the
origin of the conflict (refer to the conflict parameters defined in
[Section 4.4.1](#post){.xref}). A conflict notification message includes
information about the conflict cause, scope, and the status of the
mitigation request(s). For example:[¶](#section-4.4.2.1-5){.pilcrow}

-   [A notification message with \'status\' code set to \'7 (Attack
    mitigation is withdrawn)\' and \'conflict-status\' set to \'1\' is
    sent to a DOTS client to indicate that an active mitigation request
    is deactivated because a conflict is
    detected.[¶](#section-4.4.2.1-6.1){.pilcrow}]{#section-4.4.2.1-6.1}
-   [A notification message with \'status\' code set to \'1 (Attack
    mitigation is in progress)\' and \'conflict-status\' set to \'2\' is
    sent to a DOTS client to indicate that this mitigation request is in
    progress, but a conflict is
    detected.[¶](#section-4.4.2.1-6.2){.pilcrow}]{#section-4.4.2.1-6.2}

Upon receipt of a conflict notification message indicating that a
mitigation request is deactivated because of a conflict, a DOTS client
[MUST NOT]{.bcp14} resend the same mitigation request before the expiry
of \'retry-timer\'. It is also recommended that DOTS clients support the
means to alert administrators about mitigation
conflicts.[¶](#section-4.4.2.1-7){.pilcrow}

A DOTS client that is no longer interested in receiving notifications
from the DOTS server can simply \"forget\" the observation. When the
DOTS server sends the next notification, the DOTS client will not
recognize the token in the message and, thus, will return a Reset
message. This causes the DOTS server to remove the associated entry.
Alternatively, the DOTS client can explicitly de-register itself by
issuing a GET request that has the Token field set to the token of the
observation to be canceled and includes an Observe Option with the value
set to \'1\' (de-register). The latter is more deterministic and, thus,
is [RECOMMENDED]{.bcp14}.[¶](#section-4.4.2.1-8){.pilcrow}

[Figure 15](#Figure6){.xref} shows an example of a DOTS client
requesting a DOTS server to send notifications related to a mitigation
request. Note that for mitigations with preconfigured scopes (i.e.,
\'trigger-mitigation\' set to \'false\'), the state will need to
transition from 3 (attack-stopped) to 8
(attack-mitigation-signal-loss).[¶](#section-4.4.2.1-9){.pilcrow}

[]{#name-notifications-of-attack-mit}

::: {#Figure6}
::: {#section-4.4.2.1-10.1 .artwork .art-text .alignCenter}
    +-----------+                              +-----------+
    |DOTS Client|                              |DOTS Server|
    +-----------+                              +-----------+
          |                                          |
          |  GET /<mid>                              |
          |  Token: 0x4a                             | Registration
          |  Observe: 0                              |
          +----------------------------------------->|
          |                                          |
          |  2.05 Content                            |
          |  Token: 0x4a                             | Notification of
          |  Observe: 12                             | the current state
          |  status: "attack-mitigation-in-progress" |
          |<-----------------------------------------+
          |                                          |
          |  2.05 Content                            |
          |  Token: 0x4a                             | Notification upon
          |  Observe: 44                             | a state change
          |  status: "attack-successfully-mitigated" |
          |<-----------------------------------------+
          |                                          |
          |  2.05 Content                            |
          |  Token: 0x4a                             | Notification upon
          |  Observe: 60                             | a state change
          |  status: "attack-stopped"                |
          |<-----------------------------------------+
          |                                          |
                             ...
:::

[Figure 15](#figure-15){.selfRef}: [Notifications of Attack Mitigation
Status](#name-notifications-of-attack-mit){.selfRef}
:::
:::

::: {#section-4.4.2.2 .section}
##### [4.4.2.2.](#section-4.4.2.2){.section-number .selfRef} [DOTS Clients Polling for Mitigation Status](#name-dots-clients-polling-for-mi){.section-name .selfRef} {#name-dots-clients-polling-for-mi}

The DOTS client can send the GET request at frequent intervals without
the Observe Option to retrieve the configuration data of the mitigation
request and non-configuration data (i.e., the attack status). DOTS
clients [MAY]{.bcp14} be configured with a policy indicating the
frequency of polling DOTS servers to get the mitigation status. This
frequency [MUST NOT]{.bcp14} be more than one UDP datagram per RTT as
discussed in [Section
3.1.3](https://www.rfc-editor.org/rfc/rfc8085#section-3.1.3){.relref} of
\[[RFC8085](#RFC8085){.xref}\].[¶](#section-4.4.2.2-1){.pilcrow}

If the DOTS server has been able to mitigate the attack and the attack
has stopped, the DOTS server indicates as such in the status. In such
case, the DOTS client recalls the mitigation request by issuing a DELETE
request for this mitigation request ([Section
4.4.4](#del){.xref}).[¶](#section-4.4.2.2-2){.pilcrow}

A DOTS client [SHOULD]{.bcp14} react to the status of the attack per the
information sent by the DOTS server rather than performing its own
detection that the attack has been mitigated. This ensures that the DOTS
client does not recall a mitigation request prematurely because it is
possible that the DOTS client does not sense the DDoS attack on its
resources, but the DOTS server could be actively mitigating the attack
because the attack is not completely
averted.[¶](#section-4.4.2.2-3){.pilcrow}
:::
:::
:::

::: {#put}
::: {#section-4.4.3 .section}
#### [4.4.3.](#section-4.4.3){.section-number .selfRef} [Efficacy Update from DOTS Clients](#name-efficacy-update-from-dots-c){.section-name .selfRef} {#name-efficacy-update-from-dots-c}

While DDoS mitigation is in progress, due to the likelihood of packet
loss, a DOTS client [MAY]{.bcp14} periodically transmit DOTS mitigation
efficacy updates to the relevant DOTS server. A PUT request is used to
convey the mitigation efficacy update to the DOTS server. This PUT
request is treated as a refresh of the current
mitigation.[¶](#section-4.4.3-1){.pilcrow}

The PUT request used for the efficacy update [MUST]{.bcp14} include all
the parameters used in the PUT request to carry the DOTS mitigation
request ([Section 4.4.1](#post){.xref}) unchanged apart from the
\'lifetime\' parameter value. If this is not the case, the DOTS server
[MUST]{.bcp14} reject the request with a 4.00 (Bad
Request).[¶](#section-4.4.3-2){.pilcrow}

The If-Match Option ([Section
5.10.8.1](https://www.rfc-editor.org/rfc/rfc7252#section-5.10.8.1){.relref}
of \[[RFC7252](#RFC7252){.xref}\]) with an empty value is used to make
the PUT request conditional on the current existence of the mitigation
request. If UDP is used as transport, CoAP requests may arrive out of
order. For example, the DOTS client may send a PUT request to convey an
efficacy update to the DOTS server followed by a DELETE request to
withdraw the mitigation request, but the DELETE request arrives at the
DOTS server before the PUT request. To handle out-of-order delivery of
requests, if an If-Match Option is present in the PUT request and the
\'mid\' in the request matches a mitigation request from that DOTS
client, the request is processed by the DOTS server. If no match is
found, the PUT request is silently ignored by the DOTS
server.[¶](#section-4.4.3-3){.pilcrow}

An example of an efficacy update message, which includes an If-Match
Option with an empty value, is depicted in [Figure
16](#Figure7){.xref}.[¶](#section-4.4.3-4){.pilcrow}

[]{#name-an-example-of-efficacy-upda}

::: {#Figure7}
::: {#section-4.4.3-5.1}
``` sourcecode
   Header: PUT (Code=0.03)
   Uri-Path: ".well-known"
   Uri-Path: "dots"
   Uri-Path: "mitigate"
   Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
   Uri-Path: "mid=123"
   If-Match:
   Content-Format: "application/dots+cbor"

   {
    "ietf-dots-signal-channel:mitigation-scope": {
      "scope": [
        {
          "target-prefix": [
             "2001:db8:6401::1/128",
             "2001:db8:6401::2/128"
           ],
          "target-port-range": [
            {
              "lower-port": 80
            },
            {
              "lower-port": 443
            },
            {
               "lower-port": 8080
            }
          ],
          "target-protocol": [
             6
          ],
          "attack-status": "under-attack"
        }
      ]
    }
   }
```
:::

[Figure 16](#figure-16){.selfRef}: [An Example of Efficacy
Update](#name-an-example-of-efficacy-upda){.selfRef}
:::

The \'attack-status\' parameter is a mandatory attribute when performing
an efficacy update. The various possible values contained in the
\'attack-status\' parameter are described in [Table
4](#astatus){.xref}.[¶](#section-4.4.3-6){.pilcrow}

[]{#name-values-of-attack-status-par}

::: {#astatus}
  Parameter Value   Description
  ----------------- ----------------------------------------------------------------------------------------------------------
  1                 The DOTS client determines that it is still under attack.
  2                 The DOTS client determines that the attack is successfully mitigated (e.g., attack traffic is not seen).

  : [Table 4](#table-4){.selfRef}: [Values of \'attack-status\'
  Parameter](#name-values-of-attack-status-par){.selfRef}
:::

The DOTS server indicates the result of processing a PUT request using
CoAP Response Codes. The Response Code 2.04 (Changed) is returned if the
DOTS server has accepted the mitigation efficacy update. The error
Response Code 5.03 (Service Unavailable) is returned if the DOTS server
has erred or is incapable of performing the mitigation. As specified in
\[[RFC7252](#RFC7252){.xref}\], 5.03 uses Max-Age Option to indicate the
number of seconds after which to retry.[¶](#section-4.4.3-8){.pilcrow}
:::
:::

::: {#del}
::: {#section-4.4.4 .section}
#### [4.4.4.](#section-4.4.4){.section-number .selfRef} [Withdraw a Mitigation](#name-withdraw-a-mitigation){.section-name .selfRef} {#name-withdraw-a-mitigation}

DELETE requests are used to withdraw DOTS mitigation requests from DOTS
servers ([Figure 17](#Figure3){.xref}).[¶](#section-4.4.4-1){.pilcrow}

\'cuid\' and \'mid\' are mandatory Uri-Path parameters for DELETE
requests.[¶](#section-4.4.4-2){.pilcrow}

The same considerations for manipulating \'cdid\' parameter by DOTS
gateways, as specified in [Section 4.4.1](#post){.xref}, [MUST]{.bcp14}
be followed for DELETE requests. Uri-Path parameters with empty values
[MUST NOT]{.bcp14} be present in a
request.[¶](#section-4.4.4-3){.pilcrow}

[]{#name-withdraw-a-dots-mitigation}

::: {#Figure3}
::: {#section-4.4.4-4.1}
``` sourcecode
  Header: DELETE (Code=0.04)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "mitigate"
  Uri-Path: "cuid=dz6pHjaADkaFTbjr0JGBpw"
  Uri-Path: "mid=123"
```
:::

[Figure 17](#figure-17){.selfRef}: [Withdraw a DOTS
Mitigation](#name-withdraw-a-dots-mitigation){.selfRef}
:::

If the DELETE request does not include \'cuid\' and \'mid\' parameters,
the DOTS server [MUST]{.bcp14} reply with a 4.00 (Bad
Request).[¶](#section-4.4.4-5){.pilcrow}

Once the request is validated, the DOTS server immediately acknowledges
a DOTS client\'s request to withdraw the DOTS signal using 2.02
(Deleted) Response Code with no response payload. A 2.02 (Deleted)
Response Code is returned even if the \'mid\' parameter value conveyed
in the DELETE request does not exist in its configuration data before
the request.[¶](#section-4.4.4-6){.pilcrow}

If the DOTS server finds the \'mid\' parameter value conveyed in the
DELETE request in its configuration data for the DOTS client, then to
protect against route or DNS flapping caused by a DOTS client rapidly
removing a mitigation, and to dampen the effect of oscillating attacks,
the DOTS server [MAY]{.bcp14} allow mitigation to continue for a limited
period after acknowledging a DOTS client\'s withdrawal of a mitigation
request. During this period, the DOTS server status messages
[SHOULD]{.bcp14} indicate that mitigation is active but terminating
([Section 4.4.2](#get){.xref}).[¶](#section-4.4.4-7){.pilcrow}

The initial active-but-terminating period [SHOULD]{.bcp14} be
sufficiently long to absorb latency incurred by route propagation. The
active-but-terminating period [SHOULD]{.bcp14} be set by default to 120
seconds. If the client requests mitigation again before the initial
active-but-terminating period elapses, the DOTS server [MAY]{.bcp14}
exponentially increase (the base of the exponent is 2) the
active-but-terminating period up to a maximum of 300 seconds (5
minutes).[¶](#section-4.4.4-8){.pilcrow}

Once the active-but-terminating period elapses, the DOTS server
[MUST]{.bcp14} treat the mitigation as terminated, as the DOTS client is
no longer responsible for the mitigation.[¶](#section-4.4.4-9){.pilcrow}

If a mitigation is triggered due to a signal channel loss, the DOTS
server relies upon normal triggers to stop that mitigation (typically,
receipt of a valid DELETE request, expiry of the mitigation lifetime, or
scrubbing the traffic to the attack target). In particular, the DOTS
server [MUST NOT]{.bcp14} consider the signal channel recovery as a
trigger to stop the mitigation.[¶](#section-4.4.4-10){.pilcrow}
:::
:::
:::
:::

::: {#sigconfig}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [DOTS Signal Channel Session Configuration](#name-dots-signal-channel-session){.section-name .selfRef} {#name-dots-signal-channel-session}

A DOTS client can negotiate, configure, and retrieve the DOTS signal
channel session behavior with its DOTS peers. The DOTS signal channel
can be used, for example, to configure the
following:[¶](#section-4.5-1){.pilcrow}

a.  [Heartbeat interval (heartbeat-interval): DOTS agents regularly send
    heartbeats to each other after mutual authentication is successfully
    completed in order to keep the DOTS signal channel open. Heartbeat
    messages are exchanged between DOTS agents every
    \'heartbeat-interval\' seconds to detect the current status of the
    DOTS signal channel
    session.[¶](#section-4.5-2.1){.pilcrow}]{#section-4.5-2.1}
b.  [Missing heartbeats allowed (missing-hb-allowed): This variable
    indicates the maximum number of consecutive heartbeat messages for
    which a DOTS agent did not receive a response before concluding that
    the session is disconnected or
    defunct.[¶](#section-4.5-2.2){.pilcrow}]{#section-4.5-2.2}
c.  [Acceptable probing rate (probing-rate): This parameter indicates
    the average data rate that must not be exceeded by a DOTS agent in
    sending to a peer DOTS agent that does not
    respond.[¶](#section-4.5-2.3){.pilcrow}]{#section-4.5-2.3}
d.  [Acceptable signal loss ratio: Maximum retransmissions,
    retransmission timeout value, and other message transmission
    parameters for Confirmable messages over the DOTS signal
    channel.[¶](#section-4.5-2.4){.pilcrow}]{#section-4.5-2.4}

When the DOTS signal channel is established over a reliable transport
(e.g., TCP), there is no need for the reliability mechanisms provided by
CoAP over UDP since the underlying TCP connection provides
retransmissions and deduplication \[[RFC8323](#RFC8323){.xref}\]. As a
reminder, CoAP over reliable transports does not support Confirmable or
Non-confirmable message types. As such, the transmission-related
parameters (\'missing-hb-allowed\' and acceptable signal loss ratio) are
negotiated only for DOTS over unreliable
transports.[¶](#section-4.5-3){.pilcrow}

The same or distinct configuration sets may be used during times when a
mitigation is active (\'mitigating-config\') and when no mitigation is
active (\'idle-config\'). This is particularly useful for DOTS servers
that might want to reduce heartbeat frequency or cease heartbeat
exchanges when an active DOTS client has not requested mitigation. If
distinct configurations are used, DOTS agents [MUST]{.bcp14} follow the
appropriate configuration set as a function of the mitigation activity
(e.g., if no mitigation request is active (also referred to as \'idle\'
time), values related to \'idle-config\' must be followed).
Additionally, DOTS agents [MUST]{.bcp14} automatically switch to the
other configuration upon a change in the mitigation activity (e.g., if
an attack mitigation is launched after an \'idle\' time, the DOTS agent
switches from values related to \'idle-config\' to values related to
\'mitigating-config\').[¶](#section-4.5-4){.pilcrow}

CoAP requests and responses are indicated for reliable delivery by
marking them as Confirmable messages. DOTS signal channel session
configuration requests and responses are marked as Confirmable messages.
As explained in [Section
2.1](https://www.rfc-editor.org/rfc/rfc7252#section-2.1){.relref} of
\[[RFC7252](#RFC7252){.xref}\], a Confirmable message is retransmitted
using a default timeout and exponential backoff between retransmissions,
until the DOTS server sends an Acknowledgement message (ACK) with the
same Message ID conveyed from the DOTS
client.[¶](#section-4.5-5){.pilcrow}

Message transmission parameters are defined in [Section
4.8](https://www.rfc-editor.org/rfc/rfc7252#section-4.8){.relref} of
\[[RFC7252](#RFC7252){.xref}\]. The DOTS server can either piggyback the
response in the Acknowledgement message or, if the DOTS server cannot
respond immediately to a request carried in a Confirmable message, it
simply responds with an Empty Acknowledgement message so that the DOTS
client can stop retransmitting the request. Empty Acknowledgement
messages are explained in [Section
2.2](https://www.rfc-editor.org/rfc/rfc7252#section-2.2){.relref} of
\[[RFC7252](#RFC7252){.xref}\]. When the response is ready, the server
sends it in a new Confirmable message, which, in turn, needs to be
acknowledged by the DOTS client (see Sections
[5.2.1](https://www.rfc-editor.org/rfc/rfc7252#section-5.2.1){.relref}
and
[5.2.2](https://www.rfc-editor.org/rfc/rfc7252#section-5.2.2){.relref}
of \[[RFC7252](#RFC7252){.xref}\]). Requests and responses exchanged
between DOTS agents during \'idle\' time, except heartbeat messages, are
marked as Confirmable messages.[¶](#section-4.5-6){.pilcrow}

Implementation Note: A DOTS client that receives a response in a
Confirmable message may want to clean up the message state right after
sending the ACK. If that ACK is lost and the DOTS server retransmits the
Confirmable message, the DOTS client may no longer have any state that
would help it correlate this response: from the DOTS client\'s
standpoint, the retransmission message is unexpected. The DOTS client
will send a Reset message so it does not receive any more
retransmissions. This behavior is normal and not an indication of an
error (see [Section
5.3.2](https://www.rfc-editor.org/rfc/rfc7252#section-5.3.2){.relref} of
\[[RFC7252](#RFC7252){.xref}\] for more
details).[¶](#section-4.5-7.1){.pilcrow}

::: {#discovery}
::: {#section-4.5.1 .section}
#### [4.5.1.](#section-4.5.1){.section-number .selfRef} [Discover Configuration Parameters](#name-discover-configuration-para){.section-name .selfRef} {#name-discover-configuration-para}

A GET request is used to obtain acceptable (e.g., minimum and maximum
values) and current configuration parameters on the DOTS server for DOTS
signal channel session configuration. This procedure occurs between a
DOTS client and its immediate peer DOTS server. As such, this GET
request [MUST NOT]{.bcp14} be relayed by a DOTS
gateway.[¶](#section-4.5.1-1){.pilcrow}

[Figure 18](#Figure18){.xref} shows how to obtain configuration
parameters that the DOTS server will find
acceptable.[¶](#section-4.5.1-2){.pilcrow}

[]{#name-get-to-retrieve-configurati}

::: {#Figure18}
::: {#section-4.5.1-3.1}
``` sourcecode
  Header: GET (Code=0.01)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
```
:::

[Figure 18](#figure-18){.selfRef}: [GET to Retrieve
Configuration](#name-get-to-retrieve-configurati){.selfRef}
:::

The DOTS server in the 2.05 (Content) response conveys the current,
minimum, and maximum attribute values acceptable by the DOTS server
([Figure 19](#Figure19){.xref}).[¶](#section-4.5.1-4){.pilcrow}

[]{#name-get-configuration-response-}

::: {#Figure19}
::: {#section-4.5.1-5.1}
``` sourcecode
{
  "ietf-dots-signal-channel:signal-config": {
    "mitigating-config": {
      "heartbeat-interval": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "missing-hb-allowed": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "probing-rate": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "max-retransmit": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "ack-timeout": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      },
      "ack-random-factor": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      }
    },
    "idle-config": {
      "heartbeat-interval": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "missing-hb-allowed": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "probing-rate": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "max-retransmit": {
        "max-value": number,
        "min-value": number,
        "current-value": number
      },
      "ack-timeout": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      },
      "ack-random-factor": {
        "max-value-decimal": "string",
        "min-value-decimal": "string",
        "current-value-decimal": "string"
      }
    }
  }
}
```
:::

[Figure 19](#figure-19){.selfRef}: [GET Configuration Response Body
Schema](#name-get-configuration-response-){.selfRef}
:::

The parameters in [Figure 19](#Figure19){.xref} are described
below:[¶](#section-4.5.1-6){.pilcrow}

mitigating-config:

:   Set of configuration parameters to use when a mitigation is active.
    The following parameters may be
    included:[¶](#section-4.5.1-7.2.1){.pilcrow}

    heartbeat-interval:

    :   Time interval in seconds between two consecutive heartbeat
        messages.[¶](#section-4.5.1-7.2.2.2.1){.pilcrow}

        \'0\' is used to disable the heartbeat
        mechanism.[¶](#section-4.5.1-7.2.2.2.2){.pilcrow}

        This is an optional
        attribute.[¶](#section-4.5.1-7.2.2.2.3){.pilcrow}

    :   

    missing-hb-allowed:

    :   Maximum number of consecutive heartbeat messages for which the
        DOTS agent did not receive a response before concluding that the
        session is disconnected.[¶](#section-4.5.1-7.2.2.4.1){.pilcrow}

        This is an optional
        attribute.[¶](#section-4.5.1-7.2.2.4.2){.pilcrow}

    :   

    probing-rate:

    :   The average data rate that must not be exceeded by a DOTS agent
        in sending to a peer DOTS agent that does not respond (referred
        to as PROBING_RATE parameter in
        CoAP).[¶](#section-4.5.1-7.2.2.6.1){.pilcrow}

        This is an optional
        attribute.[¶](#section-4.5.1-7.2.2.6.2){.pilcrow}

    :   

    max-retransmit:

    :   Maximum number of retransmissions for a message (referred to as
        MAX_RETRANSMIT parameter in
        CoAP).[¶](#section-4.5.1-7.2.2.8.1){.pilcrow}

        This is an optional
        attribute.[¶](#section-4.5.1-7.2.2.8.2){.pilcrow}

    :   

    ack-timeout:

    :   Timeout value in seconds used to calculate the initial
        retransmission timeout value (referred to as ACK_TIMEOUT
        parameter in CoAP).[¶](#section-4.5.1-7.2.2.10.1){.pilcrow}

        This is an optional
        attribute.[¶](#section-4.5.1-7.2.2.10.2){.pilcrow}

    :   

    ack-random-factor:

    :   Random factor used to influence the timing of retransmissions
        (referred to as ACK_RANDOM_FACTOR parameter in
        CoAP).[¶](#section-4.5.1-7.2.2.12.1){.pilcrow}

        This is an optional
        attribute.[¶](#section-4.5.1-7.2.2.12.2){.pilcrow}

    :   

:   

idle-config:
:   Set of configuration parameters to use when no mitigation is active.
    This attribute has the same structure as
    \'mitigating-config\'.[¶](#section-4.5.1-7.4){.pilcrow}
:   

[Figure 20](#Figure17){.xref} shows an example of acceptable and current
configuration parameters on a DOTS server for DOTS signal channel
session configuration. The same acceptable configuration is used during
mitigation and idle times.[¶](#section-4.5.1-8){.pilcrow}

[]{#name-example-of-a-configuration-}

::: {#Figure17}
::: {#section-4.5.1-9.1}
``` sourcecode
{
  "ietf-dots-signal-channel:signal-config": {
    "mitigating-config": {
      "heartbeat-interval": {
        "max-value": 240,
        "min-value": 15,
        "current-value": 30
      },
      "missing-hb-allowed": {
        "max-value": 20,
        "min-value": 3,
        "current-value": 15
      },
      "probing-rate": {
        "max-value": 20,
        "min-value": 5,
        "current-value": 15
      },
      "max-retransmit": {
        "max-value": 15,
        "min-value": 2,
        "current-value": 3
      },
      "ack-timeout": {
        "max-value-decimal": "30.00",
        "min-value-decimal": "1.00",
        "current-value-decimal": "2.00"
      },
      "ack-random-factor": {
        "max-value-decimal": "4.00",
        "min-value-decimal": "1.10",
        "current-value-decimal": "1.50"
      }
    },
    "idle-config": {
      "heartbeat-interval": {
        "max-value": 240,
        "min-value": 15,
        "current-value": 30
      },
      "missing-hb-allowed": {
        "max-value": 20,
        "min-value": 3,
        "current-value": 15
      },
      "probing-rate": {
        "max-value": 20,
        "min-value": 5,
        "current-value": 15
      },
      "max-retransmit": {
        "max-value": 15,
        "min-value": 2,
        "current-value": 3
      },
      "ack-timeout": {
        "max-value-decimal": "30.00",
        "min-value-decimal": "1.00",
        "current-value-decimal": "2.00"
      },
      "ack-random-factor": {
        "max-value-decimal": "4.00",
        "min-value-decimal": "1.10",
        "current-value-decimal": "1.50"
      }
    }
  }
}
```
:::

[Figure 20](#figure-20){.selfRef}: [Example of a Configuration Response
Body](#name-example-of-a-configuration-){.selfRef}
:::
:::
:::

::: {#convey}
::: {#section-4.5.2 .section}
#### [4.5.2.](#section-4.5.2){.section-number .selfRef} [Convey DOTS Signal Channel Session Configuration](#name-convey-dots-signal-channel-){.section-name .selfRef} {#name-convey-dots-signal-channel-}

A PUT request (Figures [21](#Figure13){.xref} and
[22](#Figure13a){.xref}) is used to convey the configuration parameters
for the signal channel (e.g., heartbeat interval, maximum
retransmissions). Message transmission parameters for CoAP are defined
in [Section
4.8](https://www.rfc-editor.org/rfc/rfc7252#section-4.8){.relref} of
\[[RFC7252](#RFC7252){.xref}\]. The [RECOMMENDED]{.bcp14} values of
transmission parameter values are \'ack-timeout\' (2 seconds),
\'max-retransmit\' (3), and \'ack-random-factor\' (1.5). In addition to
those parameters, the [RECOMMENDED]{.bcp14} specific DOTS transmission
parameter values are \'heartbeat-interval\' (30 seconds) and
\'missing-hb-allowed\' (15).[¶](#section-4.5.2-1){.pilcrow}

Note: \'heartbeat-interval\' should be tweaked to also assist DOTS
messages for NAT traversal (SIG-011 of \[[RFC8612](#RFC8612){.xref}\]).
According to \[[RFC8085](#RFC8085){.xref}\], heartbeat messages must not
be sent more frequently than once every 15 seconds and should use longer
intervals when possible. Furthermore, \[[RFC4787](#RFC4787){.xref}\]
recommends that NATs use a state timeout of 2 minutes or longer, but
experience shows that sending packets every 15 to 30 seconds is
necessary to prevent the majority of middleboxes from losing state for
UDP flows. From that standpoint, the [RECOMMENDED]{.bcp14} minimum
\'heartbeat-interval\' is 15 seconds and the [RECOMMENDED]{.bcp14}
maximum \'heartbeat-interval\' is 240 seconds. The recommended value of
30 seconds is selected to anticipate the expiry of NAT
state.[¶](#section-4.5.2-2.1){.pilcrow}

A \'heartbeat-interval\' of 30 seconds may be considered to be too
chatty in some deployments. For such deployments, DOTS agents may
negotiate longer \'heartbeat-interval\' values to prevent any network
overload with too frequent heartbeats.[¶](#section-4.5.2-2.2){.pilcrow}

Different heartbeat intervals can be defined for \'mitigating-config\'
and \'idle-config\' to reduce being too chatty during idle times. If
there is an on-path translator between the DOTS client (standalone or
part of a DOTS gateway) and the DOTS server, the \'mitigating-config\'
\'heartbeat-interval\' has to be smaller than the translator session
timeout. It is recommended that the \'idle-config\'
\'heartbeat-interval\' also be smaller than the translator session
timeout to prevent translator traversal issues or that it be disabled
entirely. Means to discover the lifetime assigned by a translator are
out of scope.[¶](#section-4.5.2-2.3){.pilcrow}

Given that the size of the heartbeat request cannot exceed
(\'heartbeat-interval\' \* \'probing-rate\') bytes, \'probing-rate\'
should be set appropriately to avoid slowing down heartbeat exchanges.
For example, \'probing-rate\' may be set to 2 \* (\"size of encrypted
DOTS heartbeat request\"/\'heartbeat-interval\') or ((\"size of
encrypted DOTS heartbeat request\" + \"average size of an encrypted
mitigation request\")/\'heartbeat-interval\'). Absent any explicit
configuration or inability to dynamically adjust \'probing-rate\' values
([Section
4.8.1](https://www.rfc-editor.org/rfc/rfc7252#section-4.8.1){.relref} of
\[[RFC7252](#RFC7252){.xref}\]), DOTS agents use 5 bytes/second as a
default \'probing-rate\' value.[¶](#section-4.5.2-2.4){.pilcrow}

If the DOTS agent wishes to change the default values of message
transmission parameters, it [SHOULD]{.bcp14} follow the guidance given
in [Section
4.8.1](https://www.rfc-editor.org/rfc/rfc7252#section-4.8.1){.relref} of
\[[RFC7252](#RFC7252){.xref}\]. The DOTS agents [MUST]{.bcp14} use the
negotiated values for message transmission parameters and default values
for non-negotiated message transmission
parameters.[¶](#section-4.5.2-3){.pilcrow}

The signal channel session configuration is applicable to a single DOTS
signal channel session between DOTS agents, so the \'cuid\' Uri-Path
[MUST NOT]{.bcp14} be used.[¶](#section-4.5.2-4){.pilcrow}

[]{#name-put-to-convey-the-dots-sign}

::: {#Figure13}
::: {#section-4.5.2-5.1}
``` sourcecode
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
  Uri-Path: "sid=123"
  Content-Format: "application/dots+cbor"

  {
   ...
  }
```
:::

[Figure 21](#figure-21){.selfRef}: [PUT to Convey the DOTS Signal
Channel Session Configuration
Data](#name-put-to-convey-the-dots-sign){.selfRef}
:::

The additional Uri-Path parameter to those defined in [Table
1](#uris){.xref} is as follows:[¶](#section-4.5.2-6){.pilcrow}

sid:

:   Session Identifier is an identifier for the DOTS signal channel
    session configuration data represented as an integer. This
    identifier [MUST]{.bcp14} be generated by DOTS clients. \'sid\'
    values [MUST]{.bcp14} increase monotonically (when a new PUT is
    generated by a DOTS client to convey the configuration parameters
    for the signal channel).[¶](#section-4.5.2-7.2.1){.pilcrow}

    This is a mandatory attribute.[¶](#section-4.5.2-7.2.2){.pilcrow}

:   

[]{#name-put-to-convey-the-dots-signa}

::: {#Figure13a}
::: {#section-4.5.2-8.1}
``` sourcecode
  {
    "ietf-dots-signal-channel:signal-config": {
      "mitigating-config": {
        "heartbeat-interval": {
          "current-value": number
        },
        "missing-hb-allowed": {
          "current-value": number
        },
        "probing-rate": {
          "current-value": number
        },
        "max-retransmit": {
          "current-value": number
        },
        "ack-timeout": {
          "current-value-decimal": "string"
        },
        "ack-random-factor": {
          "current-value-decimal": "string"
        }
      },
      "idle-config": {
        "heartbeat-interval": {
          "current-value": number
        },
        "missing-hb-allowed": {
          "current-value": number
        },
        "probing-rate": {
          "current-value": number
        },
        "max-retransmit": {
          "current-value": number
        },
        "ack-timeout": {
          "current-value-decimal": "string"
        },
        "ack-random-factor": {
          "current-value-decimal": "string"
        }
      }
    }
  }
```
:::

[Figure 22](#figure-22){.selfRef}: [PUT to Convey the DOTS Signal
Channel Session Configuration Data (Message Body
Schema)](#name-put-to-convey-the-dots-signa){.selfRef}
:::

The meaning of the parameters in the CBOR body ([Figure
22](#Figure13a){.xref}) is defined in [Section
4.5.1](#discovery){.xref}.[¶](#section-4.5.2-9){.pilcrow}

At least one of the attributes \'heartbeat-interval\',
\'missing-hb-allowed\', \'probing-rate\', \'max-retransmit\',
\'ack-timeout\', and \'ack-random-factor\' [MUST]{.bcp14} be present in
the PUT request. Note that \'heartbeat-interval\',
\'missing-hb-allowed\', \'probing-rate\', \'max-retransmit\',
\'ack-timeout\', and \'ack-random-factor\', if present, do not need to
be provided for both \'mitigating-config\', and \'idle-config\' in a PUT
request.[¶](#section-4.5.2-10){.pilcrow}

The PUT request with a higher numeric \'sid\' value overrides the DOTS
signal channel session configuration data installed by a PUT request
with a lower numeric \'sid\' value. To avoid maintaining a long list of
\'sid\' requests from a DOTS client, the lower numeric \'sid\'
[MUST]{.bcp14} be automatically deleted and no longer available at the
DOTS server.[¶](#section-4.5.2-11){.pilcrow}

[Figure 23](#Figure14){.xref} shows a PUT request example to convey the
configuration parameters for the DOTS signal channel. In this example,
the heartbeat mechanism is disabled when no mitigation is active, while
the heartbeat interval is set to \'30\' when a mitigation is
active.[¶](#section-4.5.2-12){.pilcrow}

[]{#name-put-to-convey-the-configura}

::: {#Figure14}
::: {#section-4.5.2-13.1}
``` sourcecode
  Header: PUT (Code=0.03)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
  Uri-Path: "sid=123"
  Content-Format: "application/dots+cbor"

  {
    "ietf-dots-signal-channel:signal-config": {
      "mitigating-config": {
        "heartbeat-interval": {
          "current-value": 30
        },
        "missing-hb-allowed": {
          "current-value": 15
        },
        "probing-rate": {
          "current-value": 15
        },
        "max-retransmit": {
          "current-value": 3
        },
        "ack-timeout": {
          "current-value-decimal": "2.00"
        },
        "ack-random-factor": {
          "current-value-decimal": "1.50"
        }
      },
      "idle-config": {
        "heartbeat-interval": {
          "current-value": 0
        },
        "max-retransmit": {
          "current-value": 3
        },
        "ack-timeout": {
          "current-value-decimal": "2.00"
        },
        "ack-random-factor": {
          "current-value-decimal": "1.50"
        }
      }
    }
  }
```
:::

[Figure 23](#figure-23){.selfRef}: [PUT to Convey the Configuration
Parameters](#name-put-to-convey-the-configura){.selfRef}
:::

The DOTS server indicates the result of processing the PUT request using
CoAP Response Codes:[¶](#section-4.5.2-14){.pilcrow}

-   [If the request is missing a mandatory attribute, does not include a
    \'sid\' Uri-Path, or contains one or more invalid or unknown
    parameters, 4.00 (Bad Request) [MUST]{.bcp14} be returned in the
    response.[¶](#section-4.5.2-15.1){.pilcrow}]{#section-4.5.2-15.1}

-   [If the DOTS server does not find the \'sid\' parameter value
    conveyed in the PUT request in its configuration data and if the
    DOTS server has accepted the configuration parameters, then a
    Response Code 2.01 (Created) [MUST]{.bcp14} be returned in the
    response.[¶](#section-4.5.2-15.2){.pilcrow}]{#section-4.5.2-15.2}

-   [If the DOTS server finds the \'sid\' parameter value conveyed in
    the PUT request in its configuration data and if the DOTS server has
    accepted the updated configuration parameters, 2.04 (Changed)
    [MUST]{.bcp14} be returned in the
    response.[¶](#section-4.5.2-15.3){.pilcrow}]{#section-4.5.2-15.3}

-   ::: {#section-4.5.2-15.4}
    If any of the \'heartbeat-interval\', \'missing-hb-allowed\',
    \'probing-rate\', \'max-retransmit\', \'target-protocol\',
    \'ack-timeout\', and \'ack-random-factor\' attribute values are not
    acceptable to the DOTS server, 4.22 (Unprocessable Entity)
    [MUST]{.bcp14} be returned in the response. Upon receipt of this
    error code, the DOTS client [SHOULD]{.bcp14} retrieve the maximum
    and minimum attribute values acceptable to the DOTS server ([Section
    4.5.1](#discovery){.xref}).[¶](#section-4.5.2-15.4.1){.pilcrow}

    The DOTS client may retry and send the PUT request with updated
    attribute values acceptable to the DOTS
    server.[¶](#section-4.5.2-15.4.2){.pilcrow}
    :::

A DOTS client may issue a GET message with a \'sid\' Uri-Path parameter
to retrieve the negotiated configuration. The response does not need to
include \'sid\' in its message body.[¶](#section-4.5.2-16){.pilcrow}
:::
:::

::: {#section-4.5.3 .section}
#### [4.5.3.](#section-4.5.3){.section-number .selfRef} [Configuration Freshness and Notifications](#name-configuration-freshness-and){.section-name .selfRef} {#name-configuration-freshness-and}

Max-Age Option ([Section
5.10.5](https://www.rfc-editor.org/rfc/rfc7252#section-5.10.5){.relref}
of \[[RFC7252](#RFC7252){.xref}\]) [SHOULD]{.bcp14} be returned by a
DOTS server to associate a validity time with a configuration it sends.
This feature allows the update of the configuration data if a change
occurs at the DOTS server side. For example, the new configuration may
instruct a DOTS client to cease heartbeats or reduce heartbeat
frequency.[¶](#section-4.5.3-1){.pilcrow}

It is [NOT RECOMMENDED]{.bcp14} to return a Max-Age Option set to
0.[¶](#section-4.5.3-2){.pilcrow}

Returning a Max-Age Option set to 2^32^-1 is equivalent to associating
an infinite lifetime with the
configuration.[¶](#section-4.5.3-3){.pilcrow}

If a non-zero value of Max-Age Option is received by a DOTS client, it
[MUST]{.bcp14} issue a GET request with a \'sid\' Uri-Path parameter to
retrieve the current and acceptable configuration before the expiry of
the value enclosed in the Max-Age Option. This request is considered by
the client and the server to be a means to refresh the configuration
parameters for the signal channel. When a DDoS attack is active, refresh
requests [MUST NOT]{.bcp14} be sent by DOTS clients, and the DOTS server
[MUST NOT]{.bcp14} terminate the (D)TLS session after the expiry of the
value returned in Max-Age Option.[¶](#section-4.5.3-4){.pilcrow}

If Max-Age Option is not returned in a response, the DOTS client
initiates GET requests to refresh the configuration parameters each 60
seconds ([Section
5.10.5](https://www.rfc-editor.org/rfc/rfc7252#section-5.10.5){.relref}
of \[[RFC7252](#RFC7252){.xref}\]). To prevent such overload, it is
[RECOMMENDED]{.bcp14} that DOTS servers return a Max-Age Option in GET
responses. Considerations related to which value to use and how such a
value is set are implementation and deployment
specific.[¶](#section-4.5.3-5){.pilcrow}

If an Observe Option set to 0 is included in the configuration request,
the DOTS server sends notifications of any configuration change
([Section
4.2](https://www.rfc-editor.org/rfc/rfc7641#section-4.2){.relref} of
\[[RFC7641](#RFC7641){.xref}\]).[¶](#section-4.5.3-6){.pilcrow}

If a DOTS server detects that a misbehaving DOTS client does not contact
the DOTS server after the expiry of Max-Age to retrieve the signal
channel configuration data, it [MAY]{.bcp14} terminate the (D)TLS
session. A (D)TLS session is terminated by the receipt of an
authenticated message that closes the connection (e.g., a fatal alert
([Section 6](https://www.rfc-editor.org/rfc/rfc8446#section-6){.relref}
of \[[RFC8446](#RFC8446){.xref}\])).[¶](#section-4.5.3-7){.pilcrow}
:::

::: {#section-4.5.4 .section}
#### [4.5.4.](#section-4.5.4){.section-number .selfRef} [Delete DOTS Signal Channel Session Configuration](#name-delete-dots-signal-channel-){.section-name .selfRef} {#name-delete-dots-signal-channel-}

A DELETE request is used to delete the installed DOTS signal channel
session configuration data ([Figure
24](#Figure15){.xref}).[¶](#section-4.5.4-1){.pilcrow}

[]{#name-delete-configuration}

::: {#Figure15}
::: {#section-4.5.4-2.1}
``` sourcecode
  Header: DELETE (Code=0.04)
  Uri-Path: ".well-known"
  Uri-Path: "dots"
  Uri-Path: "config"
  Uri-Path: "sid=123"
```
:::

[Figure 24](#figure-24){.selfRef}: [Delete
Configuration](#name-delete-configuration){.selfRef}
:::

The DOTS server resets the DOTS signal channel session configuration
back to the default values and acknowledges a DOTS client\'s request to
remove the DOTS signal channel session configuration using 2.02
(Deleted) Response Code.[¶](#section-4.5.4-3){.pilcrow}

Upon bootstrapping or reboot, a DOTS client [MAY]{.bcp14} send a DELETE
request to set the configuration parameters to default values. Such a
request does not include any \'sid\'.[¶](#section-4.5.4-4){.pilcrow}
:::
:::
:::

::: {#redirect}
::: {#section-4.6 .section}
### [4.6.](#section-4.6){.section-number .selfRef} [Redirected Signaling](#name-redirected-signaling){.section-name .selfRef} {#name-redirected-signaling}

Redirected DOTS signaling is discussed in detail in [Section
3.2.2](https://tools.ietf.org/html/draft-ietf-dots-architecture-18#section-3.2.2){.relref}
of
\[[DOTS-ARCH](#I-D.ietf-dots-architecture){.xref}\].[¶](#section-4.6-1){.pilcrow}

If a DOTS server wants to redirect a DOTS client to an alternative DOTS
server for a signal session, then the Response Code 5.03 (Service
Unavailable) will be returned in the response to the DOTS
client.[¶](#section-4.6-2){.pilcrow}

The DOTS server can return the error Response Code 5.03 in response to a
request from the DOTS client or convey the error Response Code 5.03 in a
unidirectional notification response from the DOTS
server.[¶](#section-4.6-3){.pilcrow}

The DOTS server in the error response conveys the alternate DOTS
server\'s FQDN, and the alternate DOTS server\'s IP address(es) values
in the CBOR body ([Figure
25](#Figure20){.xref}).[¶](#section-4.6-4){.pilcrow}

[]{#name-redirected-server-error-res}

::: {#Figure20}
::: {#section-4.6-5.1}
``` sourcecode
{
  "ietf-dots-signal-channel:redirected-signal": {
    "alt-server": "string",
    "alt-server-record": [
       "string"
    ]
  }
}
```
:::

[Figure 25](#figure-25){.selfRef}: [Redirected Server Error Response
Body Schema](#name-redirected-server-error-res){.selfRef}
:::

The parameters are described below:[¶](#section-4.6-6){.pilcrow}

alt-server:

:   FQDN of an alternate DOTS server.[¶](#section-4.6-7.2.1){.pilcrow}

    This is a mandatory attribute.[¶](#section-4.6-7.2.2){.pilcrow}

:   

alt-server-record:

:   A list of IP addresses of an alternate DOTS
    server.[¶](#section-4.6-7.4.1){.pilcrow}

    This is an optional attribute.[¶](#section-4.6-7.4.2){.pilcrow}

:   

The DOTS server returns the Time to Live (TTL) of the alternate DOTS
server in a Max-Age Option. That is, the time interval that the
alternate DOTS server may be cached for use by a DOTS client. A Max-Age
Option set to 2^32^-1 is equivalent to receiving an infinite TTL. This
value means that the alternate DOTS server is to be used until the
alternate DOTS server redirects the traffic with another 5.03 response
that conveys an alternate server\'s FQDN.[¶](#section-4.6-8){.pilcrow}

A Max-Age Option set to \'0\' may be returned for redirecting mitigation
requests. Such a value means that the redirection applies only for the
mitigation request in progress. Returning short TTL in a Max-Age Option
may adversely impact DOTS clients on slow links. Returning short values
should be avoided under such conditions.[¶](#section-4.6-9){.pilcrow}

If the alternate DOTS server TTL has expired, the DOTS client
[MUST]{.bcp14} use the DOTS server(s) that was provisioned using means
discussed in [Section 4.1](#discover){.xref}. This fallback mechanism is
triggered immediately upon expiry of the TTL, except when a DDoS attack
is active.[¶](#section-4.6-10){.pilcrow}

Requests issued by misbehaving DOTS clients that do not honor the TTL
conveyed in the Max-Age Option or react to explicit redirect messages
can be rejected by DOTS servers.[¶](#section-4.6-11){.pilcrow}

[Figure 26](#Figure21){.xref} shows a 5.03 response example to convey
the DOTS alternate server \'alt-server.example\' together with its IP
addresses 2001:db8:6401::1 and
2001:db8:6401::2.[¶](#section-4.6-12){.pilcrow}

[]{#name-example-of-redirected-serve}

::: {#Figure21}
::: {#section-4.6-13.1}
``` sourcecode
{
  "ietf-dots-signal-channel:redirected-signal": {
    "alt-server": "alt-server.example",
    "alt-server-record": [
       "2001:db8:6401::1",
       "2001:db8:6401::2"
    ]
  }
}
```
:::

[Figure 26](#figure-26){.selfRef}: [Example of Redirected Server Error
Response Body](#name-example-of-redirected-serve){.selfRef}
:::

When the DOTS client receives a 5.03 response with an alternate server
included, it considers the current request to have failed, but it
[SHOULD]{.bcp14} try resending the request to the alternate DOTS server.
During a DDoS attack, the DNS server may be the target of another DDoS
attack, the alternate DOTS server\'s IP addresses conveyed in the 5.03
response help the DOTS client skip the DNS lookup of the alternate DOTS
server, at the cost of trusting the first DOTS server to provide
accurate information. The DOTS client can then try to establish a UDP or
a TCP session with the alternate DOTS server. The DOTS client
[MAY]{.bcp14} implement a method to construct IPv4-embedded IPv6
addresses \[[RFC6052](#RFC6052){.xref}\]; this is required to handle the
scenario where an IPv6-only DOTS client communicates with an IPv4-only
alternate DOTS server.[¶](#section-4.6-14){.pilcrow}

If the DOTS client has been redirected to a DOTS server with which it
has already communicated within the last five (5) minutes, it
[MUST]{.bcp14} ignore the redirection and try to contact other DOTS
servers listed in the local configuration or discovered using dynamic
means such as DHCP or SRV procedures
\[[DOTS-SERVER-DISC](#I-D.ietf-dots-server-discovery){.xref}\]. It is
[RECOMMENDED]{.bcp14} that DOTS clients support the means to alert
administrators about redirect loops.[¶](#section-4.6-15){.pilcrow}
:::
:::

::: {#hb}
::: {#section-4.7 .section}
### [4.7.](#section-4.7){.section-number .selfRef} [Heartbeat Mechanism](#name-heartbeat-mechanism){.section-name .selfRef} {#name-heartbeat-mechanism}

To provide an indication of signal health and to distinguish an \'idle\'
signal channel from a \'disconnected\' or \'defunct\' session, the DOTS
agent sends a heartbeat over the signal channel to maintain its half of
the channel (also, aligned with the \"consents\" recommendation in
[Section 6](https://www.rfc-editor.org/rfc/rfc8085#section-6){.relref}
of \[[RFC8085](#RFC8085){.xref}\]). The DOTS agent similarly expects a
heartbeat from its peer DOTS agent, and it may consider a session
terminated in the prolonged absence of a peer agent heartbeat.
Concretely, while the communication between the DOTS agents is otherwise
quiescent, the DOTS client will probe the DOTS server to ensure it has
maintained cryptographic state and vice versa. Such probes can also keep
the bindings of firewalls and/or stateful translators alive. This
probing reduces the frequency of establishing a new handshake when a
DOTS signal needs to be conveyed to the DOTS
server.[¶](#section-4.7-1){.pilcrow}

Implementation Note: Given that CoAP roles can be multiplexed over the
same session as discussed in \[[RFC7252](#RFC7252){.xref}\] and are
already supported by CoAP implementations, both the DOTS client and
server can send DOTS heartbeat requests.[¶](#section-4.7-2.1){.pilcrow}

The DOTS heartbeat mechanism uses Non-confirmable PUT requests ([Figure
27](#hbreq){.xref}) with an expected 2.04 (Changed) Response Code
([Figure 28](#hbrep){.xref}). This procedure occurs between a DOTS agent
and its immediate peer DOTS agent. As such, this PUT request [MUST
NOT]{.bcp14} be relayed by a DOTS gateway. The PUT request used for DOTS
heartbeat [MUST NOT]{.bcp14} have a \'cuid\', \'cdid\', or \'mid\'
Uri-Path.[¶](#section-4.7-3){.pilcrow}

[]{#name-put-to-check-peer-dots-agen}

::: {#hbreq}
::: {#section-4.7-4.1}
``` sourcecode
     Header: PUT (Code=0.03)
     Uri-Path: ".well-known"
     Uri-Path: "dots"
     Uri-Path: "hb"
     Content-Format: "application/dots+cbor"

     {
       "ietf-dots-signal-channel:heartbeat": {
          "peer-hb-status": true
        }
     }
```
:::

[Figure 27](#figure-27){.selfRef}: [PUT to Check Peer DOTS Agent Is
Responding](#name-put-to-check-peer-dots-agen){.selfRef}
:::

The mandatory \'peer-hb-status\' attribute is set to \'true\' (or
\'false\') to indicate that a DOTS agent is (or is not) receiving
heartbeat messages from its peer in the last (2 \*
\'heartbeat-interval\') period. Such information can be used by a peer
DOTS agent to detect or confirm connectivity issues and react
accordingly. For example, if a DOTS client receives a 2.04 response for
its heartbeat messages but no server-initiated heartbeat messages, the
DOTS client sets \'peer-hb-status\' to \'false\'. The DOTS server then
will need to try another strategy for sending the heartbeats (e.g.,
adjust the heartbeat interval or send a server-initiated heartbeat
immediately after receiving a client-initiated heartbeat
message).[¶](#section-4.7-5){.pilcrow}

[]{#name-response-to-a-dots-heartbea}

::: {#hbrep}
::: {#section-4.7-6.1}
``` sourcecode
     Header: (Code=2.04)
```
:::

[Figure 28](#figure-28){.selfRef}: [Response to a DOTS Heartbeat
Request](#name-response-to-a-dots-heartbea){.selfRef}
:::

DOTS servers [MAY]{.bcp14} trigger their heartbeat requests immediately
after receiving heartbeat probes from peer DOTS clients. As a reminder,
it is the responsibility of DOTS clients to ensure that on-path
translators/firewalls are maintaining a binding so that the same
external IP address and/or port number is retained for the DOTS signal
channel session.[¶](#section-4.7-7){.pilcrow}

Under normal traffic conditions (i.e., no attack is ongoing), if a DOTS
agent does not receive any response from the peer DOTS agent for
\'missing-hb-allowed\' number of consecutive heartbeat messages, it
concludes that the DOTS signal channel session is disconnected. The DOTS
client [MUST]{.bcp14} then try to reestablish the DOTS signal channel
session, preferably by resuming the (D)TLS
session.[¶](#section-4.7-8){.pilcrow}

Note: If a new DOTS signal channel session cannot be established, the
DOTS client [SHOULD NOT]{.bcp14} retry to establish the DOTS signal
channel session more frequently than every 300 seconds (5 minutes) and
[MUST NOT]{.bcp14} retry more frequently than every 60 seconds (1
minute). It is recommended that DOTS clients support the means to alert
administrators about the failure to establish a (D)TLS
session.[¶](#section-4.7-9.1){.pilcrow}

In case of a massive DDoS attack that saturates the incoming link(s) to
the DOTS client, all traffic from the DOTS server to the DOTS client
will likely be dropped, although the DOTS server receives heartbeat
requests in addition to DOTS messages sent by the DOTS client. In this
scenario, DOTS clients [MUST]{.bcp14} behave differently to handle
message transmission and DOTS signal channel session liveliness during
link saturation:[¶](#section-4.7-10){.pilcrow}

-   ::: {#section-4.7-11.1}
    The DOTS client [MUST NOT]{.bcp14} consider the DOTS signal channel
    session terminated even after a maximum \'missing-hb-allowed\'
    threshold is reached. The DOTS client [SHOULD]{.bcp14} keep on using
    the current DOTS signal channel session to send heartbeat requests
    over it, so that the DOTS server knows the DOTS client has not
    disconnected the DOTS signal channel
    session.[¶](#section-4.7-11.1.1){.pilcrow}

    After the maximum \'missing-hb-allowed\' threshold is reached, the
    DOTS client [SHOULD]{.bcp14} try to establish a new DOTS signal
    channel session. The DOTS client [SHOULD]{.bcp14} send mitigation
    requests over the current DOTS signal channel session and, in
    parallel, send the mitigation requests over the new DOTS signal
    channel session. This may be handled, for example, by resumption of
    the (D)TLS session or using 0-RTT mode in DTLS 1.3 to piggyback the
    mitigation request in the ClientHello
    message.[¶](#section-4.7-11.1.2){.pilcrow}

    As soon as the link is no longer saturated, if traffic from the DOTS
    server reaches the DOTS client over the current DOTS signal channel
    session, the DOTS client can stop the new DOTS signal channel
    session attempt or if a new DOTS signal channel session is
    successful then disconnect the current DOTS signal channel
    session.[¶](#section-4.7-11.1.3){.pilcrow}
    :::

If the DOTS server receives traffic from the peer DOTS client (e.g.,
peer DOTS client-initiated heartbeats) but the maximum
\'missing-hb-allowed\' threshold is reached, the DOTS server [MUST
NOT]{.bcp14} consider the DOTS signal channel session disconnected. The
DOTS server [MUST]{.bcp14} keep on using the current DOTS signal channel
session so that the DOTS client can send mitigation requests over the
current DOTS signal channel session. In this case, the DOTS server can
identify that the DOTS client is under attack and that the inbound link
to the DOTS client (domain) is saturated. Furthermore, if the DOTS
server does not receive a mitigation request from the DOTS client, it
implies that the DOTS client has not detected the attack or, if an
attack mitigation is in progress, it implies that the applied DDoS
mitigation actions are not yet effectively handling the DDoS attack
volume.[¶](#section-4.7-12){.pilcrow}

If the DOTS server does not receive any traffic from the peer DOTS
client during the time span required to exhaust the maximum
\'missing-hb-allowed\' threshold, the DOTS server concludes the session
is disconnected. The DOTS server can then trigger preconfigured
mitigation requests for this DOTS client (if
any).[¶](#section-4.7-13){.pilcrow}

In DOTS over TCP, the sender of a DOTS heartbeat message has to allow up
to \'heartbeat-interval\' seconds when waiting for a heartbeat reply.
When a failure is detected by a DOTS client, it proceeds with the
session recovery, following the same approach as the one used for
unreliable transports.[¶](#section-4.7-14){.pilcrow}
:::
:::
:::

::: {#YANG}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [DOTS Signal Channel YANG Modules](#name-dots-signal-channel-yang-mo){.section-name .selfRef} {#name-dots-signal-channel-yang-mo}

This document defines a YANG module \[[RFC7950](#RFC7950){.xref}\] for
DOTS mitigation scope, DOTS signal channel session configuration data,
DOTS redirection signaling, and DOTS
heartbeats.[¶](#section-5-1){.pilcrow}

This YANG module (ietf-dots-signal-channel) defines the DOTS client
interaction with the DOTS server as seen by the DOTS client. A DOTS
server is allowed to update the non-configurable \'ro\' entities in the
responses. This YANG module is not intended to be used via
NETCONF/RESTCONF for DOTS server management purposes; such a module is
out of the scope of this document. It serves only to provide a data
model and encoding, but not a management data
model.[¶](#section-5-2){.pilcrow}

A companion YANG module is defined to include a collection of types
defined by IANA: \"iana-dots-signal-channel\" ([Section
5.2](#iana-yang){.xref}).[¶](#section-5-3){.pilcrow}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Tree Structure](#name-tree-structure){.section-name .selfRef} {#name-tree-structure}

This document defines the YANG module \"ietf-dots-signal-channel\"
([Section 5.3](#yrequest){.xref}), which has the following tree
structure. A DOTS signal message can be a mitigation, a configuration, a
redirect, or a heartbeat message.[¶](#section-5.1-1){.pilcrow}

::: {#section-5.1-2}
``` {.sourcecode .lang-yangtree}
module: ietf-dots-signal-channel
  +--rw dots-signal
     +--rw (message-type)?
        +--:(mitigation-scope)
        |  +--rw scope* [cuid mid]
        |     +--rw cdid?                   string
        |     +--rw cuid                    string
        |     +--rw mid                     uint32
        |     +--rw target-prefix*          inet:ip-prefix
        |     +--rw target-port-range*      [lower-port]
        |     |  +--rw lower-port    inet:port-number
        |     |  +--rw upper-port?   inet:port-number
        |     +--rw target-protocol*        uint8
        |     +--rw target-fqdn*            inet:domain-name
        |     +--rw target-uri*             inet:uri
        |     +--rw alias-name*             string
        |     +--rw lifetime?               int32
        |     +--rw trigger-mitigation?     boolean
        |     +--ro mitigation-start?       uint64
        |     +--ro status?                 iana-signal:status
        |     +--ro conflict-information
        |     |  +--ro conflict-status?   iana-signal:conflict-status
        |     |  +--ro conflict-cause?    iana-signal:conflict-cause
        |     |  +--ro retry-timer?       uint32
        |     |  +--ro conflict-scope
        |     |     +--ro target-prefix*       inet:ip-prefix
        |     |     +--ro target-port-range*   [lower-port]
        |     |     |  +--ro lower-port      inet:port-number
        |     |     |  +--ro upper-port?     inet:port-number
        |     |     +--ro target-protocol*     uint8
        |     |     +--ro target-fqdn*         inet:domain-name
        |     |     +--ro target-uri*          inet:uri
        |     |     +--ro alias-name*          string
        |     |     +--ro acl-list* [acl-name]
        |     |     |  +--ro acl-name
        |     |     |  |   -> /ietf-data:dots-data/dots-client/acls/
        |     |     |  |      acl/name
        |     |     |  +--ro acl-type?
        |     |     |      -> /ietf-data:dots-data/dots-client/acls/
        |     |     |         acl/type
        |     |     +--ro mid?                 -> ../../../mid
        |     +--ro bytes-dropped?          yang:zero-based-counter64
        |     +--ro bps-dropped?            yang:gauge64
        |     +--ro pkts-dropped?           yang:zero-based-counter64
        |     +--ro pps-dropped?            yang:gauge64
        |     +--rw attack-status?          iana-signal:attack-status
        +--:(signal-config)
        |  +--rw sid                   uint32
        |  +--rw mitigating-config
        |  |  +--rw heartbeat-interval
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw missing-hb-allowed
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw probing-rate
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw max-retransmit
        |  |  |  +--ro max-value?       uint16
        |  |  |  +--ro min-value?       uint16
        |  |  |  +--rw current-value?   uint16
        |  |  +--rw ack-timeout
        |  |  |  +--ro max-value-decimal?       decimal64
        |  |  |  +--ro min-value-decimal?       decimal64
        |  |  |  +--rw current-value-decimal?   decimal64
        |  |  +--rw ack-random-factor
        |  |     +--ro max-value-decimal?       decimal64
        |  |     +--ro min-value-decimal?       decimal64
        |  |     +--rw current-value-decimal?   decimal64
        |  +--rw idle-config
        |     +--rw heartbeat-interval
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw missing-hb-allowed
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw probing-rate
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw max-retransmit
        |     |  +--ro max-value?       uint16
        |     |  +--ro min-value?       uint16
        |     |  +--rw current-value?   uint16
        |     +--rw ack-timeout
        |     |  +--ro max-value-decimal?       decimal64
        |     |  +--ro min-value-decimal?       decimal64
        |     |  +--rw current-value-decimal?   decimal64
        |     +--rw ack-random-factor
        |        +--ro max-value-decimal?       decimal64
        |        +--ro min-value-decimal?       decimal64
        |        +--rw current-value-decimal?   decimal64
        +--:(redirected-signal)
        |  +--ro alt-server            string
        |  +--ro alt-server-record*    inet:ip-address
        +--:(heartbeat)
           +--rw peer-hb-status              boolean
```

[¶](#section-5.1-2){.pilcrow}
:::
:::

::: {#iana-yang}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [IANA DOTS Signal Channel YANG Module](#name-iana-dots-signal-channel-ya){.section-name .selfRef} {#name-iana-dots-signal-channel-ya}

::: {#section-5.2-1}
``` {.sourcecode .lang-yang}
<CODE BEGINS> file "iana-dots-signal-channel@2020-05-28.yang"

module iana-dots-signal-channel {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:iana-dots-signal-channel";
  prefix iana-signal;

  organization
    "IANA";
  contact
    "Internet Assigned Numbers Authority

     Postal: ICANN
          12025 Waterfront Drive, Suite 300
          Los Angeles, CA  90094-2536
          United States of America
     Tel:    +1 310 301 5800
     <mailto:iana@iana.org>";
  description
    "This module contains a collection of YANG data types defined
     by IANA and used for DOTS signal channel protocol.

     Copyright (c) 2020 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 8782; see
     the RFC itself for full legal notices.";

  revision 2020-05-28 {
    description
      "Initial revision.";
    reference
      "RFC 8782: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }

  typedef status {
    type enumeration {
      enum attack-mitigation-in-progress {
        value 1;
        description
          "Attack mitigation setup is in progress (e.g., changing
           the network path to reroute the inbound traffic
           to DOTS mitigator).";
      }
      enum attack-successfully-mitigated {
        value 2;
        description
          "Attack is being successfully mitigated (e.g., traffic
           is redirected to a DDoS mitigator and attack
           traffic is dropped or blackholed).";
      }
      enum attack-stopped {
        value 3;
        description
          "Attack has stopped and the DOTS client can
           withdraw the mitigation request.";
      }
      enum attack-exceeded-capability {
        value 4;
        description
          "Attack has exceeded the mitigation provider
           capability.";
      }
      enum dots-client-withdrawn-mitigation {
        value 5;
        description
          "DOTS client has withdrawn the mitigation
           request and the mitigation is active but
           terminating.";
      }
      enum attack-mitigation-terminated {
        value 6;
        description
          "Attack mitigation is now terminated.";
      }
      enum attack-mitigation-withdrawn {
        value 7;
        description
          "Attack mitigation is withdrawn.";
      }
      enum attack-mitigation-signal-loss {
        value 8;
        description
          "Attack mitigation will be triggered
           for the mitigation request only when
           the DOTS signal channel session is lost.";
      }
    }
    description
      "Enumeration for status reported by the DOTS server.";
  }

  typedef conflict-status {
    type enumeration {
      enum request-inactive-other-active {
        value 1;
        description
          "DOTS Server has detected conflicting mitigation
           requests from different DOTS clients.
           This mitigation request is currently inactive
           until the conflicts are resolved. Another
           mitigation request is active.";
      }
      enum request-active {
        value 2;
        description
          "DOTS Server has detected conflicting mitigation
           requests from different DOTS clients.
           This mitigation request is currently active.";
      }
      enum all-requests-inactive {
        value 3;
        description
          "DOTS Server has detected conflicting mitigation
           requests from different DOTS clients.  All
           conflicting mitigation requests are inactive.";
      }
    }
    description
      "Enumeration for conflict status.";
  }

  typedef conflict-cause {
    type enumeration {
      enum overlapping-targets {
        value 1;
        description
          "Overlapping targets. conflict-scope provides
           more details about the exact conflict.";
      }
      enum conflict-with-acceptlist {
        value 2;
        description
          "Conflicts with an existing accept-list.

           This code is returned when the DDoS mitigation
           detects that some of the source addresses/prefixes
           listed in the accept-list ACLs are actually
           attacking the target.";
      }
      enum cuid-collision {
        value 3;
        description
          "Conflicts with the cuid used by another
           DOTS client.";
      }
    }
    description
      "Enumeration for conflict causes.";
  }

  typedef attack-status {
    type enumeration {
      enum under-attack {
        value 1;
        description
          "The DOTS client determines that it is still under
           attack.";
      }
      enum attack-successfully-mitigated {
        value 2;
        description
          "The DOTS client determines that the attack is
           successfully mitigated.";
      }
    }
    description
      "Enumeration for attack status codes.";
  }
}

<CODE ENDS>
```

[¶](#section-5.2-1){.pilcrow}
:::
:::
:::

::: {#yrequest}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [IETF DOTS Signal Channel YANG Module](#name-ietf-dots-signal-channel-ya){.section-name .selfRef} {#name-ietf-dots-signal-channel-ya}

This module uses the common YANG types defined in
\[[RFC6991](#RFC6991){.xref}\] and types defined in
\[[RFC8783](#RFC8783){.xref}\].[¶](#section-5.3-1){.pilcrow}

::: {#section-5.3-2}
``` {.sourcecode .lang-yang}
<CODE BEGINS> file "ietf-dots-signal-channel@2020-05-28.yang"

module ietf-dots-signal-channel {
  yang-version 1.1;
  namespace "urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel";
  prefix signal;

  import ietf-inet-types {
    prefix inet;
    reference
      "Section 4 of RFC 6991";
  }
  import ietf-yang-types {
    prefix yang;
    reference
      "Section 3 of RFC 6991";
  }
  import ietf-dots-data-channel {
    prefix ietf-data;
    reference
      "RFC 8783: Distributed Denial-of-Service Open Threat Signaling
                 (DOTS) Data Channel Specification";
  }
  import iana-dots-signal-channel {
    prefix iana-signal;
  }

  organization
    "IETF DDoS Open Threat Signaling (DOTS) Working Group";
  contact
    "WG Web:   <https://datatracker.ietf.org/wg/dots/>
     WG List:  <mailto:dots@ietf.org>

     Editor:  Konda, Tirumaleswar Reddy.K
              <mailto:TirumaleswarReddy_Konda@McAfee.com>

     Editor:  Mohamed Boucadair
              <mailto:mohamed.boucadair@orange.com>

     Author:  Prashanth Patil
              <mailto:praspati@cisco.com>

     Author:  Andrew Mortensen
              <mailto:amortensen@arbor.net>

     Author:  Nik Teague
              <mailto:nteague@ironmountain.co.uk>";
  description
    "This module contains YANG definition for the signaling
     messages exchanged between a DOTS client and a DOTS server.

     Copyright (c) 2020 IETF Trust and the persons identified as
     authors of the code.  All rights reserved.

     Redistribution and use in source and binary forms, with or
     without modification, is permitted pursuant to, and subject
     to the license terms contained in, the Simplified BSD License
     set forth in Section 4.c of the IETF Trust's Legal Provisions
     Relating to IETF Documents
     (http://trustee.ietf.org/license-info).

     This version of this YANG module is part of RFC 8782; see
     the RFC itself for full legal notices.";

  revision 2020-05-28 {
    description
      "Initial revision.";
    reference
      "RFC 8782: Distributed Denial-of-Service Open Threat
                 Signaling (DOTS) Signal Channel Specification";
  }

  /*
   * Groupings
   */

  grouping mitigation-scope {
    description
      "Specifies the scope of the mitigation request.";
    list scope {
      key "cuid mid";
      description
        "The scope of the request.";
      leaf cdid {
        type string;
        description
          "The cdid should be included by a server-domain
           DOTS gateway to propagate the client domain
           identification information from the
           gateway's client-facing side to the gateway's
           server-facing side, and from the gateway's
           server-facing side to the DOTS server.

           It may be used by the final DOTS server
           for policy enforcement purposes.";
      }
      leaf cuid {
        type string;
        description
          "A unique identifier that is
           generated by a DOTS client to prevent
           request collisions.  It is expected that the
           cuid will remain consistent throughout the
           lifetime of the DOTS client.";
      }
      leaf mid {
        type uint32;
        description
          "Mitigation request identifier.

           This identifier must be unique for each mitigation
           request bound to the DOTS client.";
      }
      uses ietf-data:target;
      leaf-list alias-name {
        type string;
        description
          "An alias name that points to a resource.";
      }
      leaf lifetime {
        type int32;
        units "seconds";
        default "3600";
        description
          "Indicates the lifetime of the mitigation request.

           A lifetime of '0' in a mitigation request is an
           invalid value.

           A lifetime of negative one (-1) indicates indefinite
           lifetime for the mitigation request.";
      }
      leaf trigger-mitigation {
        type boolean;
        default "true";
        description
          "If set to 'false', DDoS mitigation will not be
           triggered unless the DOTS signal channel
           session is lost.";
      }
      leaf mitigation-start {
        type uint64;
        config false;
        description
          "Mitigation start time is represented in seconds
           relative to 1970-01-01T00:00:00Z in UTC time.";
      }
      leaf status {
        type iana-signal:status;
        config false;
        description
          "Indicates the status of a mitigation request.
           It must be included in responses only.";
      }
      container conflict-information {
        config false;
        description
          "Indicates that a conflict is detected.
           Must only be used for responses.";
        leaf conflict-status {
          type iana-signal:conflict-status;
          description
            "Indicates the conflict status.";
        }
        leaf conflict-cause {
          type iana-signal:conflict-cause;
          description
            "Indicates the cause of the conflict.";
        }
        leaf retry-timer {
          type uint32;
          units "seconds";
          description
            "The DOTS client must not resend the
             same request that has a conflict before the expiry of
             this timer.";
        }
        container conflict-scope {
          description
            "Provides more information about the conflict scope.";
          uses ietf-data:target {
            when "/dots-signal/scope/conflict-information/"
               + "conflict-cause = 'overlapping-targets'";
          }
          leaf-list alias-name {
            when "../../conflict-cause = 'overlapping-targets'";
            type string;
            description
              "Conflicting alias-name.";
          }
          list acl-list {
            when "../../conflict-cause = 'conflict-with-acceptlist'";
            key "acl-name";
            description
              "List of conflicting ACLs as defined in the DOTS data
               channel.  These ACLs are uniquely defined by
               cuid and acl-name.";
            leaf acl-name {
              type leafref {
                path "/ietf-data:dots-data/ietf-data:dots-client/"
                   + "ietf-data:acls/ietf-data:acl/ietf-data:name";
              }
              description
                "Reference to the conflicting ACL name bound to
                 a DOTS client.";
            }
            leaf acl-type {
              type leafref {
                path "/ietf-data:dots-data/ietf-data:dots-client/"
                   + "ietf-data:acls/ietf-data:acl/ietf-data:type";
              }
              description
                "Reference to the conflicting ACL type bound to
                 a DOTS client.";
            }
          }
          leaf mid {
            when "../../conflict-cause = 'overlapping-targets'";
            type leafref {
              path "../../../mid";
            }
            description
              "Reference to the conflicting 'mid' bound to
               the same DOTS client.";
          }
        }
      }
      leaf bytes-dropped {
        type yang:zero-based-counter64;
        units "bytes";
        config false;
        description
          "The total dropped byte count for the mitigation
           request since the attack mitigation was triggered.
           The count wraps around when it reaches the maximum value
           of counter64 for dropped bytes.";
      }
      leaf bps-dropped {
        type yang:gauge64;
        config false;
        description
          "The average number of dropped bits per second for
           the mitigation request since the attack
           mitigation was triggered.  This should be over
           five-minute intervals (that is, measuring bytes
           into five-minute buckets and then averaging these
           buckets over the time since the mitigation was
           triggered).";
      }
      leaf pkts-dropped {
        type yang:zero-based-counter64;
        config false;
        description
          "The total number of dropped packet count for the
           mitigation request since the attack mitigation was
           triggered.  The count wraps around when it reaches
           the maximum value of counter64 for dropped packets.";
      }
      leaf pps-dropped {
        type yang:gauge64;
        config false;
        description
          "The average number of dropped packets per second
           for the mitigation request since the attack
           mitigation was triggered.  This should be over
           five-minute intervals (that is, measuring packets
           into five-minute buckets and then averaging these
           buckets over the time since the mitigation was
           triggered).";
      }
      leaf attack-status {
        type iana-signal:attack-status;
        description
          "Indicates the status of an attack as seen by the
           DOTS client.";
      }
    }
  }

  grouping config-parameters {
    description
      "Subset of DOTS signal channel session configuration.";
    container heartbeat-interval {
      description
        "DOTS agents regularly send heartbeats to each other
         after mutual authentication is successfully
         completed in order to keep the DOTS signal channel
         open.";
      leaf max-value {
        type uint16;
        units "seconds";
        config false;
        description
          "Maximum acceptable heartbeat-interval value.";
      }
      leaf min-value {
        type uint16;
        units "seconds";
        config false;
        description
          "Minimum acceptable heartbeat-interval value.";
      }
      leaf current-value {
        type uint16;
        units "seconds";
        default "30";
        description
          "Current heartbeat-interval value.

           '0' means that heartbeat mechanism is deactivated.";
      }
    }
    container missing-hb-allowed {
      description
        "Maximum number of missing heartbeats allowed.";
      leaf max-value {
        type uint16;
        config false;
        description
          "Maximum acceptable missing-hb-allowed value.";
      }
      leaf min-value {
        type uint16;
        config false;
        description
          "Minimum acceptable missing-hb-allowed value.";
      }
      leaf current-value {
        type uint16;
        default "15";
        description
          "Current missing-hb-allowed value.";
      }
    }
    container probing-rate {
      description
        "The limit for sending Non-confirmable messages with
         no response.";
      leaf max-value {
        type uint16;
        units "byte/second";
        config false;
        description
          "Maximum acceptable probing-rate value.";
      }
      leaf min-value {
        type uint16;
        units "byte/second";
        config false;
        description
          "Minimum acceptable probing-rate value.";
      }
      leaf current-value {
        type uint16;
        units "byte/second";
        default "5";
        description
          "Current probing-rate value.";
      }
    }
    container max-retransmit {
      description
        "Maximum number of retransmissions of a Confirmable
         message.";
      leaf max-value {
        type uint16;
        config false;
        description
          "Maximum acceptable max-retransmit value.";
      }
      leaf min-value {
        type uint16;
        config false;
        description
          "Minimum acceptable max-retransmit value.";
      }
      leaf current-value {
        type uint16;
        default "3";
        description
          "Current max-retransmit value.";
      }
    }
    container ack-timeout {
      description
        "Initial retransmission timeout value.";
      leaf max-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        units "seconds";
        config false;
        description
          "Maximum ack-timeout value.";
      }
      leaf min-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        units "seconds";
        config false;
        description
          "Minimum ack-timeout value.";
      }
      leaf current-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        units "seconds";
        default "2";
        description
          "Current ack-timeout value.";
      }
    }
    container ack-random-factor {
      description
        "Random factor used to influence the timing of
         retransmissions.";
      leaf max-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        config false;
        description
          "Maximum acceptable ack-random-factor value.";
      }
      leaf min-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        config false;
        description
          "Minimum acceptable ack-random-factor value.";
      }
      leaf current-value-decimal {
        type decimal64 {
          fraction-digits 2;
        }
        default "1.5";
        description
          "Current ack-random-factor value.";
      }
    }
  }

  grouping signal-config {
    description
      "DOTS signal channel session configuration.";
    leaf sid {
      type uint32;
      mandatory true;
      description
        "An identifier for the DOTS signal channel
         session configuration data.";
    }
    container mitigating-config {
      description
        "Configuration parameters to use when a mitigation
         is active.";
      uses config-parameters;
    }
    container idle-config {
      description
        "Configuration parameters to use when no mitigation
         is active.";
      uses config-parameters;
    }
  }

  grouping redirected-signal {
    description
      "Grouping for the redirected signaling.";
    leaf alt-server {
      type string;
      config false;
      mandatory true;
      description
        "FQDN of an alternate server.";
    }
    leaf-list alt-server-record {
      type inet:ip-address;
      config false;
      description
        "List of records for the alternate server.";
    }
  }

  /*
   * Main Container for DOTS Signal Channel
   */

  container dots-signal {
    description
      "Main container for DOTS signal message.

       A DOTS signal message can be a mitigation, a configuration,
       or a redirected signal message.";
    choice message-type {
      description
        "Can be a mitigation, a configuration, or a redirect
         message.";
      case mitigation-scope {
        description
          "Mitigation scope of a mitigation message.";
        uses mitigation-scope;
      }
      case signal-config {
        description
          "Configuration message.";
        uses signal-config;
      }
      case redirected-signal {
        description
          "Redirected signaling.";
        uses redirected-signal;
      }
      case heartbeat {
        description
          "DOTS heartbeats.";
        leaf peer-hb-status {
          type boolean;
          mandatory true;
          description
            "Indicates whether a DOTS agent receives heartbeats
             from its peer.  The value is set to 'true' if the
             DOTS agent is receiving heartbeat messages
             from its peer.";
        }
      }
    }
  }
}

<CODE ENDS>
```

[¶](#section-5.3-2){.pilcrow}
:::
:::
:::
:::
:::

::: {#mapping}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [YANG/JSON Mapping Parameters to CBOR](#name-yang-json-mapping-parameter){.section-name .selfRef} {#name-yang-json-mapping-parameter}

All parameters in the payload of the DOTS signal channel [MUST]{.bcp14}
be mapped to CBOR types as shown in [Table 5](#cbor-key-values){.xref}
and are assigned an integer key to save
space.[¶](#section-6-1){.pilcrow}

-   [Note: Implementers must check that the mapping output provided by
    their YANG-to-CBOR encoding schemes is aligned with the content of
    [Table 5](#cbor-key-values){.xref}. For example, some CBOR and JSON
    types for enumerations and the 64-bit quantities can differ
    depending on the encoder
    used.[¶](#section-6-2.1){.pilcrow}]{#section-6-2.1}

The CBOR key values are divided into two types: comprehension-required
and comprehension-optional. DOTS agents can safely ignore
comprehension-optional values they don\'t understand, but they cannot
successfully process a request if it contains comprehension-required
values that are not understood. The 4.00 response [SHOULD]{.bcp14}
include a diagnostic payload describing the unknown
comprehension-required CBOR key values. The initial set of CBOR key
values defined in this specification are of type
comprehension-required.[¶](#section-6-3){.pilcrow}

[]{#name-cbor-key-values-used-in-dot}

::: {#cbor-key-values}
  Parameter Name                                                                   YANG Type                                                       CBOR Key   CBOR Major Type & Information   JSON Type
  -------------------------------------------------------------------------------- --------------------------------------------------------------- ---------- ------------------------------- -----------
  ietf-dots-signal-channel:mitigation-scope[¶](#section-6-4.2.1.1.1){.pilcrow}     container                                                       1          5 map                           Object
  scope                                                                            list                                                            2          4 array                         Array
  cdid                                                                             string                                                          3          3 text string                   String
  cuid                                                                             string                                                          4          3 text string                   String
  mid                                                                              uint32                                                          5          0 unsigned                      Number
  target-prefix                                                                    leaf-list                                                       6          4 array                         Array
                                                                                   inet:ip-prefix                                                             3 text string                   String
  target-port-range                                                                list                                                            7          4 array                         Array
  lower-port                                                                       inet:port-number                                                8          0 unsigned                      Number
  upper-port                                                                       inet:port-number                                                9          0 unsigned                      Number
  target-protocol                                                                  leaf-list                                                       10         4 array                         Array
                                                                                   uint8                                                                      0 unsigned                      Number
  target-fqdn                                                                      leaf-list                                                       11         4 array                         Array
                                                                                   inet:domain-name                                                           3 text string                   String
  target-uri                                                                       leaf-list                                                       12         4 array                         Array
                                                                                   inet:uri                                                                   3 text string                   String
  alias-name                                                                       leaf-list                                                       13         4 array                         Array
                                                                                   string                                                                     3 text string                   String
  lifetime                                                                         int32                                                           14         0 unsigned                      Number
                                                                                                                                                              1 negative                      Number
  mitigation-start                                                                 uint64                                                          15         0 unsigned                      String
  status                                                                           enumeration                                                     16         0 unsigned                      String
  conflict-information                                                             container                                                       17         5 map                           Object
  conflict-status                                                                  enumeration                                                     18         0 unsigned                      String
  conflict-cause                                                                   enumeration                                                     19         0 unsigned                      String
  retry-timer                                                                      uint32                                                          20         0 unsigned                      String
  conflict-scope                                                                   container                                                       21         5 map                           Object
  acl-list                                                                         list                                                            22         4 array                         Array
  acl-name                                                                         leafref                                                         23         3 text string                   String
  acl-type                                                                         leafref                                                         24         3 text string                   String
  bytes-dropped                                                                    yang:zero-based-counter64[¶](#section-6-4.2.31.2.1){.pilcrow}   25         0 unsigned                      String
  bps-dropped                                                                      yang:gauge64                                                    26         0 unsigned                      String
  pkts-dropped                                                                     yang:zero-based-counter64[¶](#section-6-4.2.33.2.1){.pilcrow}   27         0 unsigned                      String
  pps-dropped                                                                      yang:gauge64                                                    28         0 unsigned                      String
  attack-status                                                                    enumeration                                                     29         0 unsigned                      String
  ietf-dots-signal-channel:signal-config[¶](#section-6-4.2.36.1.1){.pilcrow}       container                                                       30         5 map                           Object
  sid                                                                              uint32                                                          31         0 unsigned                      Number
  mitigating-config                                                                container                                                       32         5 map                           Object
  heartbeat-interval                                                               container                                                       33         5 map                           Object
  max-value                                                                        uint16                                                          34         0 unsigned                      Number
  min-value                                                                        uint16                                                          35         0 unsigned                      Number
  current-value                                                                    uint16                                                          36         0 unsigned                      Number
  missing-hb-allowed                                                               container                                                       37         5 map                           Object
  max-retransmit                                                                   container                                                       38         5 map                           Object
  ack-timeout                                                                      container                                                       39         5 map                           Object
  ack-random-factor                                                                container                                                       40         5 map                           Object
  max-value-decimal                                                                decimal64                                                       41         6 tag 4 \[-2, integer\]         String
  min-value-decimal                                                                decimal64                                                       42         6 tag 4 \[-2, integer\]         String
  current-value-decimal                                                            decimal64                                                       43         6 tag 4 \[-2, integer\]         String
  idle-config                                                                      container                                                       44         5 map                           Object
  trigger-mitigation                                                               boolean                                                         45         7 bits 20                       False
                                                                                                                                                              7 bits 21                       True
  ietf-dots-signal-channel:redirected-signal[¶](#section-6-4.2.53.1.1){.pilcrow}   container                                                       46         5 map                           Object
  alt-server                                                                       string                                                          47         3 text string                   String
  alt-server-record                                                                leaf-list                                                       48         4 array                         Array
                                                                                   inet:ip-address                                                            3 text string                   String
  ietf-dots-signal-channel:heartbeat[¶](#section-6-4.2.57.1.1){.pilcrow}           container                                                       49         5 map                           Object
  probing-rate                                                                     container                                                       50         5 map                           Object
  peer-hb-status                                                                   boolean                                                         51         7 bits 20                       False
                                                                                                                                                              7 bits 21                       True

  : [Table 5](#table-5){.selfRef}: [CBOR Key Values Used in DOTS Signal
  Channel Messages & Their Mappings to JSON and
  YANG](#name-cbor-key-values-used-in-dot){.selfRef}
:::
:::
:::

::: {#profile}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [(D)TLS Protocol Profile and Performance Considerations](#name-dtls-protocol-profile-and-p){.section-name .selfRef} {#name-dtls-protocol-profile-and-p}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [(D)TLS Protocol Profile](#name-dtls-protocol-profile){.section-name .selfRef} {#name-dtls-protocol-profile}

This section defines the (D)TLS protocol profile of DOTS signal channel
over (D)TLS and DOTS data channel over TLS.[¶](#section-7.1-1){.pilcrow}

There are known attacks on (D)TLS, such as man-in-the-middle and
protocol downgrade attacks. These are general attacks on (D)TLS and, as
such, they are not specific to DOTS over (D)TLS; refer to the (D)TLS
RFCs for discussion of these security issues. DOTS agents [MUST]{.bcp14}
adhere to the (D)TLS implementation recommendations and security
considerations of \[[RFC7525](#RFC7525){.xref}\] except with respect to
(D)TLS version. Because DOTS signal channel encryption relying upon
(D)TLS is virtually a greenfield deployment, DOTS agents [MUST]{.bcp14}
implement only (D)TLS 1.2 or later.[¶](#section-7.1-2){.pilcrow}

When a DOTS client is configured with a domain name of the DOTS server,
and it connects to its configured DOTS server, the server may present it
with a PKIX certificate. In order to ensure proper authentication, a
DOTS client [MUST]{.bcp14} verify the entire certification path per
\[[RFC5280](#RFC5280){.xref}\]. Additionally, the DOTS client
[MUST]{.bcp14} use \[[RFC6125](#RFC6125){.xref}\] validation techniques
to compare the domain name with the certificate provided. Certification
authorities that issue DOTS server certificates [SHOULD]{.bcp14} support
the DNS-ID and SRV-ID identifier types. DOTS servers [SHOULD]{.bcp14}
prefer the use of DNS-ID and SRV-ID over CN-ID identifier types in
certificate requests (as described in [Section
2.3](https://www.rfc-editor.org/rfc/rfc6125#section-2.3){.relref} of
\[[RFC6125](#RFC6125){.xref}\]), and the wildcard character \'\*\'
[SHOULD NOT]{.bcp14} be included in the presented identifier. DOTS
doesn\'t use URI-IDs for server identity
verification.[¶](#section-7.1-3){.pilcrow}

A key challenge to deploying DOTS is the provisioning of DOTS clients,
including the distribution of keying material to DOTS clients to enable
the required mutual authentication of DOTS agents. Enrollment over
Secure Transport (EST) \[[RFC7030](#RFC7030){.xref}\] defines a method
of certificate enrollment by which domains operating DOTS servers may
provide DOTS clients with all the necessary cryptographic keying
material, including a private key and a certificate, to authenticate
themselves. One deployment option is to have DOTS clients behave as EST
clients for certificate enrollment from an EST server provisioned by the
mitigation provider. This document does not specify which EST or other
mechanism the DOTS client uses to achieve initial
enrollment.[¶](#section-7.1-4){.pilcrow}

The Server Name Indication (SNI) extension
\[[RFC6066](#RFC6066){.xref}\] i defines a mechanism for a client to
tell a (D)TLS server the name of the server it wants to contact. This is
a useful extension for hosting environments where multiple virtual
servers are reachable over a single IP address. The DOTS client may or
may not know if it is interacting with a DOTS server in a virtual server
hosting environment, so the DOTS client [SHOULD]{.bcp14} include the
DOTS server FQDN in the SNI extension.[¶](#section-7.1-5){.pilcrow}

Implementations compliant with this profile [MUST]{.bcp14} implement all
of the following items:[¶](#section-7.1-6){.pilcrow}

-   [DTLS record replay detection ([Section
    3.3](https://www.rfc-editor.org/rfc/rfc6347#section-3.3){.relref} of
    \[[RFC6347](#RFC6347){.xref}\]) or an equivalent mechanism to
    protect against replay
    attacks.[¶](#section-7.1-7.1){.pilcrow}]{#section-7.1-7.1}
-   [DTLS session resumption without server-side state to resume session
    and convey the DOTS
    signal.[¶](#section-7.1-7.2){.pilcrow}]{#section-7.1-7.2}
-   [At least one of raw public keys \[[RFC7250](#RFC7250){.xref}\] or
    PSK handshake \[[RFC4279](#RFC4279){.xref}\] with (EC)DHE key
    exchange. This reduces the size of the ServerHello. Also, this can
    be used by DOTS agents that cannot obtain
    certificates.[¶](#section-7.1-7.3){.pilcrow}]{#section-7.1-7.3}

Implementations compliant with this profile [SHOULD]{.bcp14} implement
all of the following items to reduce the delay required to deliver a
DOTS signal channel message:[¶](#section-7.1-8){.pilcrow}

-   [TLS False Start \[[RFC7918](#RFC7918){.xref}\], which reduces
    round-trips by allowing the TLS client\'s second flight of messages
    (ChangeCipherSpec) to also contain the DOTS signal. TLS False Start
    is formally defined for use with TLS, but the same technique is
    applicable to DTLS as
    well.[¶](#section-7.1-9.1){.pilcrow}]{#section-7.1-9.1}
-   [Cached Information Extension \[[RFC7924](#RFC7924){.xref}\] which
    avoids transmitting the server\'s certificate and certificate chain
    if the client has cached that information from a previous TLS
    handshake.[¶](#section-7.1-9.2){.pilcrow}]{#section-7.1-9.2}

Compared to UDP, DOTS signal channel over TCP requires an additional
round-trip time (RTT) of latency to establish a TCP connection. DOTS
implementations are encouraged to implement TCP Fast Open
\[[RFC7413](#RFC7413){.xref}\] to eliminate that
RTT.[¶](#section-7.1-10){.pilcrow}
:::

::: {#DTLS}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [(D)TLS 1.3 Considerations](#name-dtls-13-considerations){.section-name .selfRef} {#name-dtls-13-considerations}

TLS 1.3 provides critical latency improvements for connection
establishment over TLS 1.2. The DTLS 1.3 protocol
\[[DTLS](#I-D.ietf-tls-dtls13){.xref}\] is based upon the TLS 1.3
protocol and provides equivalent security guarantees. (D)TLS 1.3
provides two basic handshake modes the DOTS signal channel can take
advantage of:[¶](#section-7.2-1){.pilcrow}

-   [A full handshake mode in which a DOTS client can send a DOTS
    mitigation request message after one round trip and the DOTS server
    immediately responds with a DOTS mitigation response. This assumes
    no packet loss is
    experienced.[¶](#section-7.2-2.1){.pilcrow}]{#section-7.2-2.1}
-   [0-RTT mode in which the DOTS client can authenticate itself and
    send DOTS mitigation request messages in the first message, thus
    reducing handshake latency. 0-RTT only works if the DOTS client has
    previously communicated with that DOTS server, which is very likely
    with the DOTS signal
    channel.[¶](#section-7.2-2.2){.pilcrow}]{#section-7.2-2.2}

The DOTS client has to establish a (D)TLS session with the DOTS server
during \'idle\' time and share a PSK.[¶](#section-7.2-3){.pilcrow}

During a DDoS attack, the DOTS client can use the (D)TLS session to
convey the DOTS mitigation request message and, if there is no response
from the server after multiple retries, the DOTS client can resume the
(D)TLS session in 0-RTT mode using PSK.[¶](#section-7.2-4){.pilcrow}

DOTS servers that support (D)TLS 1.3 [MAY]{.bcp14} allow DOTS clients to
send early data (0-RTT). DOTS clients [MUST NOT]{.bcp14} send \"CoAP
Ping\" as early data; such messages [MUST]{.bcp14} be rejected by DOTS
servers. [Section
8](https://www.rfc-editor.org/rfc/rfc8446#section-8){.relref} of
\[[RFC8446](#RFC8446){.xref}\] discusses some mechanisms to implement in
order to limit the impact of replay attacks on 0-RTT data. If the DOTS
server accepts 0-RTT, it [MUST]{.bcp14} implement one of these
mechanisms to prevent replay at the TLS layer. A DOTS server can reject
0-RTT by sending a TLS HelloRetryRequest.[¶](#section-7.2-5){.pilcrow}

The DOTS signal channel messages sent as early data by the DOTS client
are idempotent requests. As a reminder, the Message ID ([Section
3](https://www.rfc-editor.org/rfc/rfc7252#section-3){.relref} of
\[[RFC7252](#RFC7252){.xref}\]) is changed each time a new CoAP request
is sent, and the Token ([Section
5.3.1](https://www.rfc-editor.org/rfc/rfc7252#section-5.3.1){.relref} of
\[[RFC7252](#RFC7252){.xref}\]) is randomized in each CoAP request. The
DOTS server(s) [MUST]{.bcp14} use the Message ID and the Token in the
DOTS signal channel message to detect replay of early data at the
application layer and accept 0-RTT data at most once from the same DOTS
client. This anti-replay defense requires sharing the Message ID and the
Token in the 0-RTT data between DOTS servers in the DOTS server domain.
DOTS servers do not rely on transport coordinates to identify DOTS
peers. As specified in [Section 4.4.1](#post){.xref}, DOTS servers
couple the DOTS signal channel sessions using the DOTS client identity
and optionally the \'cdid\' parameter value. Furthermore, the \'mid\'
value is monotonically increased by the DOTS client for each mitigation
request, thus attackers that replay mitigation requests with lower
numeric \'mid\' values and overlapping scopes with mitigation requests
having higher numeric \'mid\' values will be rejected systematically by
the DOTS server. Likewise, the \'sid\' value is monotonically increased
by the DOTS client for each configuration request ([Section
4.5.2](#convey){.xref}); attackers replaying configuration requests with
lower numeric \'sid\' values will be rejected by the DOTS server if it
maintains a higher numeric \'sid\' value for this DOTS
client.[¶](#section-7.2-6){.pilcrow}

Owing to the aforementioned protections, all DOTS signal channel
requests are safe to transmit in TLS 1.3 as early data. Refer to
\[[DOTS-EARLYDATA](#I-D.boucadair-dots-earlydata){.xref}\] for more
details.[¶](#section-7.2-7){.pilcrow}

A simplified TLS 1.3 handshake with 0-RTT DOTS mitigation request
message exchange is shown in [Figure
29](#Figure24){.xref}.[¶](#section-7.2-8){.pilcrow}

[]{#name-a-simplified-tls-13-handsha}

::: {#Figure24}
::: {#section-7.2-9.1 .artwork .art-text .alignLeft}
        DOTS Client                                    DOTS Server

        ClientHello
        (0-RTT DOTS signal message)
                                  -------->
                                                        ServerHello
                                              {EncryptedExtensions}
                                                         {Finished}
                                  <--------   [DOTS signal message]
        (end_of_early_data)
        {Finished}                -------->
        [DOTS signal message]     <------->   [DOTS signal message]

    Note that:
        () Indicates messages protected 0-RTT keys
        {} Indicates messages protected using handshake keys
        [] Indicates messages protected using 1-RTT keys
:::

[Figure 29](#figure-29){.selfRef}: [A Simplified TLS 1.3 Handshake with
0-RTT](#name-a-simplified-tls-13-handsha){.selfRef}
:::
:::
:::

::: {#mtu}
::: {#section-7.3 .section}
### [7.3.](#section-7.3){.section-number .selfRef} [DTLS MTU and Fragmentation](#name-dtls-mtu-and-fragmentation){.section-name .selfRef} {#name-dtls-mtu-and-fragmentation}

To avoid DOTS signal message fragmentation and the subsequent decreased
probability of message delivery, DOTS agents [MUST]{.bcp14} ensure that
the DTLS record fits within a single datagram. As a reminder, DTLS
handles fragmentation and reassembly only for handshake messages and not
for the application data ([Section
4.1.1](https://www.rfc-editor.org/rfc/rfc6347#section-4.1.1){.relref} of
\[[RFC6347](#RFC6347){.xref}\]). If the path MTU (PMTU) cannot be
discovered, DOTS agents [MUST]{.bcp14} assume a PMTU of 1280 bytes, as
IPv6 requires that every link in the Internet have an MTU of 1280 octets
or greater as specified in \[[RFC8200](#RFC8200){.xref}\]. If IPv4
support on legacy or otherwise unusual networks is a consideration and
the PMTU is unknown, DOTS implementations [MAY]{.bcp14} assume a PMTU of
576 bytes for IPv4 datagrams, as every IPv4 host must be capable of
receiving a packet whose length is equal to 576 bytes as discussed in
\[[RFC0791](#RFC0791){.xref}\] and
\[[RFC1122](#RFC1122){.xref}\].[¶](#section-7.3-1){.pilcrow}

The DOTS client must consider the amount of record expansion expected by
the DTLS processing when calculating the size of the CoAP message that
fits within the PMTU. PMTU [MUST]{.bcp14} be greater than or equal to
\[CoAP message size + DTLS 1.2 overhead of 13 octets + authentication
overhead of the negotiated DTLS cipher suite + block padding\] ([Section
4.1.1.1](https://www.rfc-editor.org/rfc/rfc6347#section-4.1.1.1){.relref}
of \[[RFC6347](#RFC6347){.xref}\]). If the total request size exceeds
the PMTU, then the DOTS client [MUST]{.bcp14} split the DOTS signal into
separate messages; for example, the list of addresses in the
\'target-prefix\' parameter could be split into multiple lists and each
list conveyed in a new PUT request.[¶](#section-7.3-2){.pilcrow}

Implementation Note: DOTS choice of message size parameters works well
with IPv6 and with most of today\'s IPv4 paths. However, with IPv4, it
is harder to safely make sure that there is no IP fragmentation. If the
IPv4 PMTU is unknown, implementations may want to limit themselves to
more conservative IPv4 datagram sizes such as 576 bytes, per
\[[RFC0791](#RFC0791){.xref}\].[¶](#section-7.3-3.1){.pilcrow}
:::
:::
:::
:::

::: {#mutauth}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Mutual Authentication of DOTS Agents & Authorization of DOTS Clients](#name-mutual-authentication-of-do){.section-name .selfRef} {#name-mutual-authentication-of-do}

(D)TLS based upon client certificates can be used for mutual
authentication between DOTS agents. If, for example, a DOTS gateway is
involved, DOTS clients and DOTS gateways must perform mutual
authentication; only authorized DOTS clients are allowed to send DOTS
signals to a DOTS gateway. The DOTS gateway and the DOTS server must
perform mutual authentication; a DOTS server only allows DOTS signal
channel messages from an authorized DOTS gateway, thereby creating a
two-link chain of transitive authentication between the DOTS client and
the DOTS server.[¶](#section-8-1){.pilcrow}

The DOTS server should support certificate-based client authentication.
The DOTS client should respond to the DOTS server\'s TLS
CertificateRequest message with the PKIX certificate held by the DOTS
client. DOTS client certificate validation must be performed per
\[[RFC5280](#RFC5280){.xref}\], and the DOTS client certificate must
conform to the \[[RFC5280](#RFC5280){.xref}\] certificate profile. If a
DOTS client does not support TLS client certificate authentication, it
must support client authentication based on pre-shared key or raw public
key.[¶](#section-8-2){.pilcrow}

[]{#name-example-of-authentication-a}

::: {#Figure12}
::: {#section-8-3.1 .artwork .art-text .alignCenter}
    +---------------------------------------------+
    |       example.com domain       +---------+  |
    |                                | AAA     |  |
    | +---------------+              | Server  |  |
    | | Application   |              +------+--+  |
    | | server        +<---------------+    ^     |
    | | (DOTS client) |                |    |     |
    | +---------------+                |    |     |
    |                                  V    V     |   example.net domain
    |                            +-----+----+--+  |    +---------------+
    | +--------------+           |             |  |    |               |
    | |   Guest      +<----x---->+    DOTS     +<----->+    DOTS       |
    | | (DOTS client)|           |    gateway  |  |    |    server     |
    | +--------------+           |             |  |    |               |
    |                            +----+--------+  |    +---------------+
    |                                 ^           |
    |                                 |           |
    | +----------------+              |           |
    | | DDoS detector  |              |           |
    | | (DOTS client)  +<-------------+           |
    | +----------------+                          |
    +---------------------------------------------+
:::

[Figure 30](#figure-30){.selfRef}: [Example of Authentication and
Authorization of DOTS
Agents](#name-example-of-authentication-a){.selfRef}
:::

In the example depicted in [Figure 30](#Figure12){.xref}, the DOTS
gateway and DOTS clients within the \'example.com\' domain mutually
authenticate. After the DOTS gateway validates the identity of a DOTS
client, it communicates with the AAA server in the \'example.com\'
domain to determine if the DOTS client is authorized to request DDoS
mitigation. If the DOTS client is not authorized, a 4.01 (Unauthorized)
is returned in the response to the DOTS client. In this example, the
DOTS gateway only allows the application server and DDoS attack detector
to request DDoS mitigation, but does not permit the user of type
\'guest\' to request DDoS mitigation.[¶](#section-8-4){.pilcrow}

Also, DOTS gateways and servers located in different domains must
perform mutual authentication (e.g., using certificates). A DOTS server
will only allow a DOTS gateway with a certificate for a particular
domain to request mitigation for that domain. In reference to [Figure
30](#Figure12){.xref}, the DOTS server only allows the DOTS gateway to
request mitigation for the \'example.com\' domain and not for other
domains.[¶](#section-8-5){.pilcrow}
:::
:::

::: {#IANA}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#port}
::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [DOTS Signal Channel UDP and TCP Port Number](#name-dots-signal-channel-udp-and){.section-name .selfRef} {#name-dots-signal-channel-udp-and}

IANA has assigned the port number 4646 (the ASCII decimal value for
\"..\" (DOTS)) to the DOTS signal channel protocol for both UDP and TCP
from the \"Service Name and Transport Protocol Port Number Registry\"
available at
\<<https://www.iana.org/assignments/service-names-port-numbers/>\>.[¶](#section-9.1-1){.pilcrow}

-   ::: {#section-9.1-2.1}

    Service Name:
    :   dots-signal[¶](#section-9.1-2.1.1.2){.pilcrow}
    :   

    Port Number:
    :   4646[¶](#section-9.1-2.1.1.4){.pilcrow}
    :   

    Transport Protocol:
    :   TCP[¶](#section-9.1-2.1.1.6){.pilcrow}
    :   

    Description:
    :   Distributed Denial-of-Service Open Threat Signaling (DOTS)
        Signal Channel[¶](#section-9.1-2.1.1.8){.pilcrow}
    :   

    Assignee:
    :   IESG[¶](#section-9.1-2.1.1.10){.pilcrow}
    :   

    Contact:
    :   IETF Chair[¶](#section-9.1-2.1.1.12){.pilcrow}
    :   

    Registration Date:
    :   2020-01-16[¶](#section-9.1-2.1.1.14){.pilcrow}
    :   

    Reference:
    :   \[RFC8782\][¶](#section-9.1-2.1.1.16){.pilcrow}
    :   
    :::

-   ::: {#section-9.1-2.2}

    Service Name:
    :   dots-signal[¶](#section-9.1-2.2.1.2){.pilcrow}
    :   

    Port Number:
    :   4646[¶](#section-9.1-2.2.1.4){.pilcrow}
    :   

    Transport Protocol:
    :   UDP[¶](#section-9.1-2.2.1.6){.pilcrow}
    :   

    Description:
    :   Distributed Denial-of-Service Open Threat Signaling (DOTS)
        Signal Channel[¶](#section-9.1-2.2.1.8){.pilcrow}
    :   

    Assignee:
    :   IESG[¶](#section-9.1-2.2.1.10){.pilcrow}
    :   

    Contact:
    :   IETF Chair[¶](#section-9.1-2.2.1.12){.pilcrow}
    :   

    Registration Date:
    :   2020-01-16[¶](#section-9.1-2.2.1.14){.pilcrow}
    :   

    Reference:
    :   \[RFC8782\][¶](#section-9.1-2.2.1.16){.pilcrow}
    :   
    :::
:::
:::

::: {#uri}
::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Well-Known \'dots\' URI](#name-well-known-dots-uri){.section-name .selfRef} {#name-well-known-dots-uri}

IANA has registered the \'dots\' well-known URI ([Table
6](#tab-dots-uri){.xref}) in the Well-Known URIs registry
(\<<https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml>\>)
as defined by
\[[RFC8615](#RFC8615){.xref}\]:[¶](#section-9.2-1){.pilcrow}

[]{#name-dots-well-known-uri}

::: {#tab-dots-uri}
  URI Suffix   Change Controller   Reference     Status      Related information
  ------------ ------------------- ------------- ----------- ---------------------
  dots         IETF                \[RFC8782\]   permanent   None

  : [Table 6](#table-6){.selfRef}: [\'dots\' Well-Known
  URI](#name-dots-well-known-uri){.selfRef}
:::
:::
:::

::: {#MediaReg}
::: {#section-9.3 .section}
### [9.3.](#section-9.3){.section-number .selfRef} [Media Type Registration](#name-media-type-registration){.section-name .selfRef} {#name-media-type-registration}

IANA has registered the \"application/dots+cbor\" media type in the
\"Media Types\" registry \[[IANA-MediaTypes](#IANA-MediaTypes){.xref}\]
in the manner described in \[[RFC6838](#RFC6838){.xref}\], which can be
used to indicate that the content is a DOTS signal channel
object:[¶](#section-9.3-1){.pilcrow}

Type name: application[¶](#section-9.3-2){.pilcrow}

Subtype name: dots+cbor[¶](#section-9.3-3){.pilcrow}

Required parameters: N/A[¶](#section-9.3-4){.pilcrow}

Optional parameters: N/A[¶](#section-9.3-5){.pilcrow}

Encoding considerations: binary[¶](#section-9.3-6){.pilcrow}

Security considerations: See the Security Considerations section of
\[RFC8782\].[¶](#section-9.3-7){.pilcrow}

Interoperability considerations: N/A[¶](#section-9.3-8){.pilcrow}

Published specification: \[RFC8782\][¶](#section-9.3-9){.pilcrow}

Applications that use this media type: DOTS agents sending DOTS messages
over CoAP over (D)TLS.[¶](#section-9.3-10){.pilcrow}

Fragment identifier considerations: N/A[¶](#section-9.3-11){.pilcrow}

Additional information:[¶](#section-9.3-12){.pilcrow}

-   [Deprecated alias names for this type:
    N/A[¶](#section-9.3-13.1){.pilcrow}]{#section-9.3-13.1}
-   [Magic number(s):
    N/A[¶](#section-9.3-13.2){.pilcrow}]{#section-9.3-13.2}
-   [File extension(s):
    N/A[¶](#section-9.3-13.3){.pilcrow}]{#section-9.3-13.3}
-   [Macintosh file type code(s):
    N/A[¶](#section-9.3-13.4){.pilcrow}]{#section-9.3-13.4}

Person & email address to contact for further information: IESG,
iesg\@ietf.org[¶](#section-9.3-14){.pilcrow}

Intended usage: COMMON[¶](#section-9.3-15){.pilcrow}

Restrictions on usage: none[¶](#section-9.3-16){.pilcrow}

Author: See Authors\' Addresses section.[¶](#section-9.3-17){.pilcrow}

Change controller: IESG[¶](#section-9.3-18){.pilcrow}

Provisional registration? No[¶](#section-9.3-19){.pilcrow}
:::
:::

::: {#IANACoAPContentFormatRegistration}
::: {#section-9.4 .section}
### [9.4.](#section-9.4){.section-number .selfRef} [CoAP Content-Formats Registration](#name-coap-content-formats-regist){.section-name .selfRef} {#name-coap-content-formats-regist}

IANA has registered the CoAP Content-Format ID for the
\"application/dots+cbor\" media type in the \"CoAP Content-Formats\"
registry
\[[IANA-CoAP-Content-Formats](#IANA-CoAP-Content-Formats){.xref}\]:[¶](#section-9.4-1){.pilcrow}

-   [Media Type:
    application/dots+cbor[¶](#section-9.4-2.1){.pilcrow}]{#section-9.4-2.1}
-   [Encoding: -[¶](#section-9.4-2.2){.pilcrow}]{#section-9.4-2.2}
-   [ID: 271[¶](#section-9.4-2.3){.pilcrow}]{#section-9.4-2.3}
-   [Reference:
    \[RFC8782\][¶](#section-9.4-2.4){.pilcrow}]{#section-9.4-2.4}
:::
:::

::: {#IANACBORTagAssignment}
::: {#section-9.5 .section}
### [9.5.](#section-9.5){.section-number .selfRef} [CBOR Tag Registration](#name-cbor-tag-registration){.section-name .selfRef} {#name-cbor-tag-registration}

This section defines the DOTS CBOR tag as another means for applications
to declare that a CBOR data structure is a DOTS signal channel object.
Its use is optional and is intended for use in cases in which this
information would not otherwise be known. The DOTS CBOR tag is not
required for DOTS signal channel protocol version specified in this
document. If present, the DOTS tag [MUST]{.bcp14} prefix a DOTS signal
channel object.[¶](#section-9.5-1){.pilcrow}

IANA has registered the DOTS signal channel CBOR tag in the \"CBOR
Tags\" registry
\[[IANA-CBOR-Tags](#IANA-CBOR-Tags){.xref}\]:[¶](#section-9.5-2){.pilcrow}

-   [Tag: 271[¶](#section-9.5-3.1){.pilcrow}]{#section-9.5-3.1}
-   [Data Item: DDoS Open Threat Signaling (DOTS) signal channel
    object[¶](#section-9.5-3.2){.pilcrow}]{#section-9.5-3.2}
-   [Semantics: DDoS Open Threat Signaling (DOTS) signal channel object,
    as defined in
    \[RFC8782\][¶](#section-9.5-3.3){.pilcrow}]{#section-9.5-3.3}
-   [Reference:
    \[RFC8782\][¶](#section-9.5-3.4){.pilcrow}]{#section-9.5-3.4}
:::
:::

::: {#reg}
::: {#section-9.6 .section}
### [9.6.](#section-9.6){.section-number .selfRef} [DOTS Signal Channel Protocol Registry](#name-dots-signal-channel-protoco){.section-name .selfRef} {#name-dots-signal-channel-protoco}

IANA has created a new registry titled the \"Distributed
Denial-of-Service Open Threat Signaling (DOTS) Signal Channel\"
registry. The following sections define
subregistries.[¶](#section-9.6-1){.pilcrow}

::: {#map}
::: {#section-9.6.1 .section}
#### [9.6.1.](#section-9.6.1){.section-number .selfRef} [DOTS Signal Channel CBOR Key Values Subregistry](#name-dots-signal-channel-cbor-ke){.section-name .selfRef} {#name-dots-signal-channel-cbor-ke}

IANA has created a new subregistry titled \"DOTS Signal Channel CBOR Key
Values\".[¶](#section-9.6.1-1){.pilcrow}

The structure of this subregistry is provided in [Section
9.6.1.1](#format){.xref}. [Section 9.6.1.2](#initial){.xref} provides
the registry as initially populated with the values in [Table
7](#tab-cbor-key-reg){.xref}.[¶](#section-9.6.1-2){.pilcrow}

::: {#format}
::: {#section-9.6.1.1 .section}
##### [9.6.1.1.](#section-9.6.1.1){.section-number .selfRef} [Registration Template](#name-registration-template){.section-name .selfRef} {#name-registration-template}

Parameter name:
:   Parameter name as used in the DOTS signal
    channel.[¶](#section-9.6.1.1-1.2){.pilcrow}
:   

CBOR Key Value:

:   Key value for the parameter. The key value [MUST]{.bcp14} be an
    integer in the 1-65535 range. The key values of the
    comprehension-required range (0x0001 - 0x3FFF) and of the
    comprehension-optional range (0x8000 - 0xBFFF) are assigned by IETF
    Review ([Section
    4.8](https://www.rfc-editor.org/rfc/rfc8126#section-4.8){.relref} of
    \[[RFC8126](#RFC8126){.xref}\]). The key values of the
    comprehension-optional range (0x4000 - 0x7FFF) are assigned by
    Specification Required ([Section
    4.6](https://www.rfc-editor.org/rfc/rfc8126#section-4.6){.relref} of
    \[[RFC8126](#RFC8126){.xref}\]) and of the comprehension-optional
    range (0xC000 - 0xFFFF) are reserved for Private Use ([Section
    4.1](https://www.rfc-editor.org/rfc/rfc8126#section-4.1){.relref} of
    \[[RFC8126](#RFC8126){.xref}\]).[¶](#section-9.6.1.1-1.4.1){.pilcrow}

    Registration requests for the 0x4000 - 0x7FFF range are evaluated
    after a three-week review period on the
    dots-signal-reg-review\@ietf.org mailing list, on the advice of one
    or more Designated Experts. However, to allow for the allocation of
    values prior to publication, the Designated Experts may approve
    registration once they are satisfied that such a specification will
    be published. New registration requests should be sent in the form
    of an email to the review mailing list; the request should use an
    appropriate subject (e.g., \"Request to register CBOR Key Value for
    DOTS: example\"). IANA will only accept new registrations from the
    Designated Experts, and it will check that review was requested on
    the mailing list in accordance with these
    procedures.[¶](#section-9.6.1.1-1.4.2){.pilcrow}

    Within the review period, the Designated Experts will either approve
    or deny the registration request, communicating this decision to the
    review list and IANA. Denials should include an explanation and, if
    applicable, suggestions as to how to make the request successful.
    Registration requests that are undetermined for a period longer than
    21 days can be brought to the IESG\'s attention (using the
    iesg\@ietf.org mailing list) for
    resolution.[¶](#section-9.6.1.1-1.4.3){.pilcrow}

    Criteria that should be applied by the Designated Experts include
    determining whether the proposed registration duplicates existing
    functionality, whether it is likely to be of general applicability
    or whether it is useful only for a single use case, and whether the
    registration description is clear. IANA must only accept registry
    updates to the 0x4000 - 0x7FFF range from the Designated Experts and
    should direct all requests for registration to the review mailing
    list. It is suggested that multiple Designated Experts be appointed.
    In cases where a registration decision could be perceived as
    creating a conflict of interest for a particular Expert, that Expert
    should defer to the judgment of the other
    Experts.[¶](#section-9.6.1.1-1.4.4){.pilcrow}

:   

CBOR Major Type:
:   CBOR Major type and optional tag for the
    parameter.[¶](#section-9.6.1.1-1.6){.pilcrow}
:   

Change Controller:
:   For Standards Track RFCs, list the \"IESG\". For others, give the
    name of the responsible party. Other details (e.g., email address)
    may also be included.[¶](#section-9.6.1.1-1.8){.pilcrow}
:   

Specification Document(s):
:   Reference to the document or documents that specify the parameter,
    preferably including URIs that can be used to retrieve copies of the
    documents. An indication of the relevant sections may also be
    included but is not required.[¶](#section-9.6.1.1-1.10){.pilcrow}
:   
:::
:::

::: {#initial}
::: {#section-9.6.1.2 .section}
##### [9.6.1.2.](#section-9.6.1.2){.section-number .selfRef} [Initial Subregistry Content](#name-initial-subregistry-content){.section-name .selfRef} {#name-initial-subregistry-content}

[]{#name-initial-dots-signal-channel}

::: {#tab-cbor-key-reg}
  Parameter Name                                                                         CBOR Key Value   CBOR Major Type   Change Controller   Specification Document(s)
  -------------------------------------------------------------------------------------- ---------------- ----------------- ------------------- ---------------------------
  Reserved                                                                               0                                                      \[RFC8782\]
  ietf-dots-signal-channel:mitigation-scope[¶](#section-9.6.1.2-1.2.2.1.1){.pilcrow}     1                5                 IESG                \[RFC8782\]
  scope                                                                                  2                4                 IESG                \[RFC8782\]
  cdid                                                                                   3                3                 IESG                \[RFC8782\]
  cuid                                                                                   4                3                 IESG                \[RFC8782\]
  mid                                                                                    5                0                 IESG                \[RFC8782\]
  target-prefix                                                                          6                4                 IESG                \[RFC8782\]
  target-port-range                                                                      7                4                 IESG                \[RFC8782\]
  lower-port                                                                             8                0                 IESG                \[RFC8782\]
  upper-port                                                                             9                0                 IESG                \[RFC8782\]
  target-protocol                                                                        10               4                 IESG                \[RFC8782\]
  target-fqdn                                                                            11               4                 IESG                \[RFC8782\]
  target-uri                                                                             12               4                 IESG                \[RFC8782\]
  alias-name                                                                             13               4                 IESG                \[RFC8782\]
  lifetime                                                                               14               0/1               IESG                \[RFC8782\]
  mitigation-start                                                                       15               0                 IESG                \[RFC8782\]
  status                                                                                 16               0                 IESG                \[RFC8782\]
  conflict-information                                                                   17               5                 IESG                \[RFC8782\]
  conflict-status                                                                        18               0                 IESG                \[RFC8782\]
  conflict-cause                                                                         19               0                 IESG                \[RFC8782\]
  retry-timer                                                                            20               0                 IESG                \[RFC8782\]
  conflict-scope                                                                         21               5                 IESG                \[RFC8782\]
  acl-list                                                                               22               4                 IESG                \[RFC8782\]
  acl-name                                                                               23               3                 IESG                \[RFC8782\]
  acl-type                                                                               24               3                 IESG                \[RFC8782\]
  bytes-dropped                                                                          25               0                 IESG                \[RFC8782\]
  bps-dropped                                                                            26               0                 IESG                \[RFC8782\]
  pkts-dropped                                                                           27               0                 IESG                \[RFC8782\]
  pps-dropped                                                                            28               0                 IESG                \[RFC8782\]
  attack-status                                                                          29               0                 IESG                \[RFC8782\]
  ietf-dots-signal-channel:signal-config[¶](#section-9.6.1.2-1.2.31.1.1){.pilcrow}       30               5                 IESG                \[RFC8782\]
  sid                                                                                    31               0                 IESG                \[RFC8782\]
  mitigating-config                                                                      32               5                 IESG                \[RFC8782\]
  heartbeat-interval                                                                     33               5                 IESG                \[RFC8782\]
  min-value                                                                              34               0                 IESG                \[RFC8782\]
  max-value                                                                              35               0                 IESG                \[RFC8782\]
  current-value                                                                          36               0                 IESG                \[RFC8782\]
  missing-hb-allowed                                                                     37               5                 IESG                \[RFC8782\]
  max-retransmit                                                                         38               5                 IESG                \[RFC8782\]
  ack-timeout                                                                            39               5                 IESG                \[RFC8782\]
  ack-random-factor                                                                      40               5                 IESG                \[RFC8782\]
  min-value-decimal                                                                      41               6tag4             IESG                \[RFC8782\]
  max-value-decimal                                                                      42               6tag4             IESG                \[RFC8782\]
  current-value-decimal                                                                  43               6tag4             IESG                \[RFC8782\]
  idle-config                                                                            44               5                 IESG                \[RFC8782\]
  trigger-mitigation                                                                     45               7                 IESG                \[RFC8782\]
  ietf-dots-signal-channel:redirected-signal[¶](#section-9.6.1.2-1.2.47.1.1){.pilcrow}   46               5                 IESG                \[RFC8782\]
  alt-server                                                                             47               3                 IESG                \[RFC8782\]
  alt-server-record                                                                      48               4                 IESG                \[RFC8782\]
  ietf-dots-signal-channel:heartbeat[¶](#section-9.6.1.2-1.2.50.1.1){.pilcrow}           49               5                 IESG                \[RFC8782\]
  probing-rate                                                                           50               5                 IESG                \[RFC8782\]
  peer-hb-status                                                                         51               7                 IESG                \[RFC8782\]
  Unassigned                                                                             52-49151                                               
  Reserved for Private Use                                                               49152-65535                                            \[RFC8782\]

  : [Table 7](#table-7){.selfRef}: [Initial DOTS Signal Channel CBOR Key
  Values Registry](#name-initial-dots-signal-channel){.selfRef}
:::
:::
:::
:::
:::

::: {#sc}
::: {#section-9.6.2 .section}
#### [9.6.2.](#section-9.6.2){.section-number .selfRef} [Status Codes Subregistry](#name-status-codes-subregistry){.section-name .selfRef} {#name-status-codes-subregistry}

IANA has created a new subregistry titled \"DOTS Signal Channel Status
Codes\". Codes in this registry are used as valid values of \'status\'
parameter.[¶](#section-9.6.2-1){.pilcrow}

The registry is initially populated with the following
values:[¶](#section-9.6.2-2){.pilcrow}

[]{#name-initial-dots-signal-channel-}

  Code                                                   Label                                                                     Description                                                                                                                                                            Reference
  ------------------------------------------------------ ------------------------------------------------------------------------- ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- ----------------------------------------------------
  0[¶](#section-9.6.2-3.2.1.1.1){.pilcrow}               Reserved[¶](#section-9.6.2-3.2.1.2.1){.pilcrow}                                                                                                                                                                                                  \[RFC8782\][¶](#section-9.6.2-3.2.1.4.1){.pilcrow}
  1[¶](#section-9.6.2-3.2.2.1.1){.pilcrow}               attack-mitigation-in-progress[¶](#section-9.6.2-3.2.2.2.1){.pilcrow}      Attack mitigation setup is in progress (e.g., changing the network path to redirect the inbound traffic to a DOTS mitigator).[¶](#section-9.6.2-3.2.2.3.1){.pilcrow}   \[RFC8782\][¶](#section-9.6.2-3.2.2.4.1){.pilcrow}
  2[¶](#section-9.6.2-3.2.3.1.1){.pilcrow}               attack-successfully-mitigated[¶](#section-9.6.2-3.2.3.2.1){.pilcrow}      Attack is being successfully mitigated (e.g., traffic is redirected to a DDoS mitigator and attack traffic is dropped).[¶](#section-9.6.2-3.2.3.3.1){.pilcrow}         \[RFC8782\][¶](#section-9.6.2-3.2.3.4.1){.pilcrow}
  3[¶](#section-9.6.2-3.2.4.1.1){.pilcrow}               attack-stopped[¶](#section-9.6.2-3.2.4.2.1){.pilcrow}                     Attack has stopped and the DOTS client can withdraw the mitigation request.[¶](#section-9.6.2-3.2.4.3.1){.pilcrow}                                                     \[RFC8782\][¶](#section-9.6.2-3.2.4.4.1){.pilcrow}
  4[¶](#section-9.6.2-3.2.5.1.1){.pilcrow}               attack-exceeded-capability[¶](#section-9.6.2-3.2.5.2.1){.pilcrow}         Attack has exceeded the mitigation provider capability.[¶](#section-9.6.2-3.2.5.3.1){.pilcrow}                                                                         \[RFC8782\][¶](#section-9.6.2-3.2.5.4.1){.pilcrow}
  5[¶](#section-9.6.2-3.2.6.1.1){.pilcrow}               dots-client-withdrawn-mitigation[¶](#section-9.6.2-3.2.6.2.1){.pilcrow}   DOTS client has withdrawn the mitigation request and the mitigation is active but terminating.[¶](#section-9.6.2-3.2.6.3.1){.pilcrow}                                  \[RFC8782\][¶](#section-9.6.2-3.2.6.4.1){.pilcrow}
  6[¶](#section-9.6.2-3.2.7.1.1){.pilcrow}               attack-mitigation-terminated[¶](#section-9.6.2-3.2.7.2.1){.pilcrow}       Attack mitigation is now terminated.[¶](#section-9.6.2-3.2.7.3.1){.pilcrow}                                                                                            \[RFC8782\][¶](#section-9.6.2-3.2.7.4.1){.pilcrow}
  7[¶](#section-9.6.2-3.2.8.1.1){.pilcrow}               attack-mitigation-withdrawn[¶](#section-9.6.2-3.2.8.2.1){.pilcrow}        Attack mitigation is withdrawn.[¶](#section-9.6.2-3.2.8.3.1){.pilcrow}                                                                                                 \[RFC8782\][¶](#section-9.6.2-3.2.8.4.1){.pilcrow}
  8[¶](#section-9.6.2-3.2.9.1.1){.pilcrow}               attack-mitigation-signal-loss[¶](#section-9.6.2-3.2.9.2.1){.pilcrow}      Attack mitigation will be triggered for the mitigation request only when the DOTS signal channel session is lost.[¶](#section-9.6.2-3.2.9.3.1){.pilcrow}               \[RFC8782\][¶](#section-9.6.2-3.2.9.4.1){.pilcrow}
  9-2147483647[¶](#section-9.6.2-3.2.10.1.1){.pilcrow}   Unassigned[¶](#section-9.6.2-3.2.10.2.1){.pilcrow}                                                                                                                                                                                               

  : [Table 8](#table-8){.selfRef}: [Initial DOTS Signal Channel Status
  Codes](#name-initial-dots-signal-channel-){.selfRef}

New codes can be assigned via Standards Action
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-9.6.2-4){.pilcrow}
:::
:::

::: {#cs}
::: {#section-9.6.3 .section}
#### [9.6.3.](#section-9.6.3){.section-number .selfRef} [Conflict Status Codes Subregistry](#name-conflict-status-codes-subre){.section-name .selfRef} {#name-conflict-status-codes-subre}

IANA has created a new subregistry titled \"DOTS Signal Channel Conflict
Status Codes\". Codes in this registry are used as valid values of
\'conflict-status\' parameter.[¶](#section-9.6.3-1){.pilcrow}

The registry is initially populated with the following
values:[¶](#section-9.6.3-2){.pilcrow}

[]{#name-initial-dots-signal-channel-c}

  Code           Label                            Description                                                                                                                                                                                                   Reference
  -------------- -------------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -------------
  0              Reserved                                                                                                                                                                                                                                       \[RFC8782\]
  1              request-inactive-​other-active   DOTS server has detected conflicting mitigation requests from different DOTS clients. This mitigation request is currently inactive until the conflicts are resolved. Another mitigation request is active.   \[RFC8782\]
  2              request-active                   DOTS server has detected conflicting mitigation requests from different DOTS clients. This mitigation request is currently active.                                                                            \[RFC8782\]
  3              all-requests-​inactive           DOTS server has detected conflicting mitigation requests from different DOTS clients. All conflicting mitigation requests are inactive.                                                                       \[RFC8782\]
  4-2147483647   Unassigned                                                                                                                                                                                                                                     

  : [Table 9](#table-9){.selfRef}: [Initial DOTS Signal Channel Conflict
  Status Codes](#name-initial-dots-signal-channel-c){.selfRef}

New codes can be assigned via Standards Action
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-9.6.3-4){.pilcrow}
:::
:::

::: {#cc}
::: {#section-9.6.4 .section}
#### [9.6.4.](#section-9.6.4){.section-number .selfRef} [Conflict Cause Codes Subregistry](#name-conflict-cause-codes-subreg){.section-name .selfRef} {#name-conflict-cause-codes-subreg}

IANA has created a new subregistry titled \"DOTS Signal Channel Conflict
Cause Codes\". Codes in this registry are used as valid values of
\'conflict-cause\' parameter.[¶](#section-9.6.4-1){.pilcrow}

The registry is initially populated with the following
values:[¶](#section-9.6.4-2){.pilcrow}

[]{#name-initial-dots-signal-channel-co}

  Code           Label                       Description                                                                                                                                                                    Reference
  -------------- --------------------------- ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ -------------
  0              Reserved                                                                                                                                                                                                   \[RFC8782\]
  1              overlapping-targets         Overlapping targets.                                                                                                                                                           \[RFC8782\]
  2              conflict-with-​acceptlist   Conflicts with an existing accept-list. This code is returned when the DDoS mitigation detects source addresses/prefixes in the accept-listed ACLs are attacking the target.   \[RFC8782\]
  3              cuid-collision              CUID Collision. This code is returned when a DOTS client uses a \'cuid\' that is already used by another DOTS client.                                                          \[RFC8782\]
  4-2147483647   Unassigned                                                                                                                                                                                                 

  : [Table 10](#table-10){.selfRef}: [Initial DOTS Signal Channel
  Conflict Cause Codes](#name-initial-dots-signal-channel-co){.selfRef}

New codes can be assigned via Standards Action
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-9.6.4-4){.pilcrow}
:::
:::

::: {#as}
::: {#section-9.6.5 .section}
#### [9.6.5.](#section-9.6.5){.section-number .selfRef} [Attack Status Codes Subregistry](#name-attack-status-codes-subregi){.section-name .selfRef} {#name-attack-status-codes-subregi}

IANA has created a new subregistry titled \"DOTS Signal Channel Attack
Status Codes\". Codes in this registry are used as valid values of
\'attack-status\' parameter.[¶](#section-9.6.5-1){.pilcrow}

The registry is initially populated with the following
values:[¶](#section-9.6.5-2){.pilcrow}

[]{#name-initial-dots-signal-channel-a}

  Code           Label                            Description                                                             Reference
  -------------- -------------------------------- ----------------------------------------------------------------------- -------------
  0              Reserved                                                                                                 \[RFC8782\]
  1              under-attack                     The DOTS client determines that it is still under attack.               \[RFC8782\]
  2              attack-successfully-​mitigated   The DOTS client determines that the attack is successfully mitigated.   \[RFC8782\]
  3-2147483647   Unassigned                                                                                               

  : [Table 11](#table-11){.selfRef}: [Initial DOTS Signal Channel Attack
  Status Codes](#name-initial-dots-signal-channel-a){.selfRef}

New codes can be assigned via Standards Action
\[[RFC8126](#RFC8126){.xref}\].[¶](#section-9.6.5-4){.pilcrow}
:::
:::
:::
:::

::: {#yang}
::: {#section-9.7 .section}
### [9.7.](#section-9.7){.section-number .selfRef} [DOTS Signal Channel YANG Modules](#name-dots-signal-channel-yang-mod){.section-name .selfRef} {#name-dots-signal-channel-yang-mod}

IANA has registered the following URIs in the \"ns\" subregistry within
the \"IETF XML Registry\"
\[[RFC3688](#RFC3688){.xref}\]:[¶](#section-9.7-1){.pilcrow}

-   ::: {#section-9.7-2.1}

    URI:
    :   urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel[¶](#section-9.7-2.1.1.2){.pilcrow}
    :   

    Registrant Contact:
    :   The IESG.[¶](#section-9.7-2.1.1.4){.pilcrow}
    :   

    XML:
    :   N/A; the requested URI is an XML
        namespace.[¶](#section-9.7-2.1.1.6){.pilcrow}
    :   
    :::

-   ::: {#section-9.7-2.2}

    URI:
    :   urn:ietf:params:xml:ns:yang:iana-dots-signal-channel[¶](#section-9.7-2.2.1.2){.pilcrow}
    :   

    Registrant Contact:
    :   IANA.[¶](#section-9.7-2.2.1.4){.pilcrow}
    :   

    XML:
    :   N/A; the requested URI is an XML
        namespace.[¶](#section-9.7-2.2.1.6){.pilcrow}
    :   
    :::

IANA has registered the following YANG modules in the \"YANG Module
Names\" subregistry \[[RFC7950](#RFC7950){.xref}\] within the \"YANG
Parameters\" registry.[¶](#section-9.7-3){.pilcrow}

-   ::: {#section-9.7-4.1}

    Name:
    :   ietf-dots-signal-channel[¶](#section-9.7-4.1.1.2){.pilcrow}
    :   

    Maintained by IANA:
    :   N[¶](#section-9.7-4.1.1.4){.pilcrow}
    :   

    Namespace:
    :   urn:ietf:params:xml:ns:yang:ietf-dots-signal-channel[¶](#section-9.7-4.1.1.6){.pilcrow}
    :   

    Prefix:
    :   signal[¶](#section-9.7-4.1.1.8){.pilcrow}
    :   

    Reference:
    :   RFC8782[¶](#section-9.7-4.1.1.10){.pilcrow}
    :   
    :::

-   ::: {#section-9.7-4.2}

    Name:
    :   iana-dots-signal-channel[¶](#section-9.7-4.2.1.2){.pilcrow}
    :   

    Maintained by IANA:
    :   Y[¶](#section-9.7-4.2.1.4){.pilcrow}
    :   

    Namespace:
    :   urn:ietf:params:xml:ns:yang:iana-dots-signal-channel[¶](#section-9.7-4.2.1.6){.pilcrow}
    :   

    Prefix:
    :   iana-signal[¶](#section-9.7-4.2.1.8){.pilcrow}
    :   

    Reference:
    :   RFC8782[¶](#section-9.7-4.2.1.10){.pilcrow}
    :   
    :::

This document defines the initial version of the IANA-maintained
iana-dots-signal-channel YANG module. IANA has added this
note:[¶](#section-9.7-5){.pilcrow}

-   [Status, conflict status, conflict cause, and attack status values
    must not be directly added to the iana-dots-signal-channel YANG
    module. They must instead be respectively added to the \"DOTS Status
    Codes\", \"DOTS Conflict Status Codes\", \"DOTS Conflict Cause
    Codes\", and \"DOTS Attack Status Codes\"
    registries.[¶](#section-9.7-6.1){.pilcrow}]{#section-9.7-6.1}

When a \'status\', \'conflict-status\', \'conflict-cause\', or
\'attack-status\' value is respectively added to the \"DOTS Status
Codes\", \"DOTS Conflict Status Codes\", \"DOTS Conflict Cause Codes\",
or \"DOTS Attack Status Codes\" registry, a new \"enum\" statement must
be added to the iana-dots-signal-channel YANG module. The following
\"enum\" statement, and substatements thereof, should be
defined:[¶](#section-9.7-7){.pilcrow}

\"enum\":
:   Replicates the label from the
    registry.[¶](#section-9.7-8.2){.pilcrow}
:   

\"value\":
:   Contains the IANA-assigned value corresponding to the \'status\',
    \'conflict-status\', \'conflict-cause\', or
    \'attack-status\'.[¶](#section-9.7-8.4){.pilcrow}
:   

\"description\":
:   Replicates the description from the
    registry.[¶](#section-9.7-8.6){.pilcrow}
:   

\"reference\":
:   Replicates the reference from the registry and adds the title of the
    document.[¶](#section-9.7-8.8){.pilcrow}
:   

When the iana-dots-signal-channel YANG module is updated, a new
\"revision\" statement must be added in front of the existing revision
statements.[¶](#section-9.7-9){.pilcrow}

IANA added this note to \"DOTS Status Codes\", \"DOTS Conflict Status
Codes\", \"DOTS Conflict Cause Codes\", and \"DOTS Attack Status Codes\"
registries:[¶](#section-9.7-10){.pilcrow}

-   [When this registry is modified, the YANG module
    iana-dots-signal-channel must be updated as defined in
    \[RFC8782\].[¶](#section-9.7-11.1){.pilcrow}]{#section-9.7-11.1}
:::
:::
:::
:::

::: {#security}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

High-level DOTS security considerations are documented in
\[[RFC8612](#RFC8612){.xref}\] and
\[[DOTS-ARCH](#I-D.ietf-dots-architecture){.xref}\].[¶](#section-10-1){.pilcrow}

Authenticated encryption [MUST]{.bcp14} be used for data confidentiality
and message integrity. The interaction between the DOTS agents requires
Datagram Transport Layer Security (DTLS) or Transport Layer Security
(TLS) with a cipher suite offering confidentiality protection, and the
guidance given in \[[RFC7525](#RFC7525){.xref}\] [MUST]{.bcp14} be
followed to avoid attacks on (D)TLS. The (D)TLS protocol profile used
for the DOTS signal channel is specified in [Section
7](#profile){.xref}.[¶](#section-10-2){.pilcrow}

If TCP is used between DOTS agents, an attacker may be able to inject
RST packets, bogus application segments, etc., regardless of whether TLS
authentication is used. Because the application data is TLS protected,
this will not result in the application receiving bogus data, but it
will constitute a DoS on the connection. This attack can be countered by
using TCP Authentication Option (TCP-AO) \[[RFC5925](#RFC5925){.xref}\].
Although not widely adopted, if TCP-AO is used, then any bogus packets
injected by an attacker will be rejected by the TCP-AO integrity check
and therefore will never reach the TLS
layer.[¶](#section-10-3){.pilcrow}

If the \'cuid\' is guessable, a misbehaving DOTS client from within the
client\'s domain can use the \'cuid\' of another DOTS client of the
domain to delete or alter active mitigations. For this attack vector to
happen, the misbehaving client needs to pass the security validation
checks by the DOTS server, and eventually the checks of a client-domain
DOTS gateway.[¶](#section-10-4){.pilcrow}

A similar attack can be achieved by a compromised DOTS client that can
sniff the TLS 1.2 handshake, use the client certificate to identify the
\'cuid\' used by another DOTS client. This attack is not possible if
algorithms such as version 4 Universally Unique IDentifiers (UUIDs) in
[Section
4.4](https://www.rfc-editor.org/rfc/rfc4122#section-4.4){.relref} of
\[[RFC4122](#RFC4122){.xref}\] are used to generate the \'cuid\' because
such UUIDs are not a deterministic function of the client certificate.
Likewise, this attack is not possible with TLS 1.3 because most of the
TLS handshake is encrypted and the client certificate is not visible to
eavesdroppers.[¶](#section-10-5){.pilcrow}

A compromised DOTS client can collude with a DDoS attacker to send
mitigation request for a target resource, get the mitigation efficacy
from the DOTS server, and convey the mitigation efficacy to the DDoS
attacker to possibly change the DDoS attack strategy. Obviously,
signaling an attack by the compromised DOTS client to the DOTS server
will trigger attack mitigation. This attack can be prevented by
monitoring and auditing DOTS clients to detect misbehavior and to deter
misuse, and by only authorizing the DOTS client to request mitigation
for specific target resources (e.g., an application server is authorized
to request mitigation for its IP addresses, but a DDoS mitigator can
request mitigation for any target resource in the network). Furthermore,
DOTS clients are typically co-located on network security services
(e.g., firewall), and a compromised security service potentially can do
a lot more damage to the network.[¶](#section-10-6){.pilcrow}

Rate-limiting DOTS requests, including those with new \'cuid\' values,
from the same DOTS client defend against DoS attacks that would result
in varying the \'cuid\' to exhaust DOTS server resources. Rate-limit
policies [SHOULD]{.bcp14} be enforced on DOTS gateways (if deployed) and
DOTS servers.[¶](#section-10-7){.pilcrow}

In order to prevent leaking internal information outside a client\'s
domain, DOTS gateways located in the client domain [SHOULD NOT]{.bcp14}
reveal the identification information that pertains to internal DOTS
clients (e.g., source IP address, client\'s hostname) unless explicitly
configured to do so.[¶](#section-10-8){.pilcrow}

DOTS servers [MUST]{.bcp14} verify that requesting DOTS clients are
entitled to trigger actions on a given IP prefix. That is, only actions
on IP resources that belong to the DOTS client\'s domain [MUST]{.bcp14}
be authorized by a DOTS server. The exact mechanism for the DOTS servers
to validate that the target prefixes are within the scope of the DOTS
client domain is deployment specific.[¶](#section-10-9){.pilcrow}

The presence of DOTS gateways may lead to infinite forwarding loops,
which is undesirable. To prevent and detect such loops, this document
uses the Hop-Limit option.[¶](#section-10-10){.pilcrow}

When FQDNs are used as targets, the DOTS server [MUST]{.bcp14} rely upon
DNS privacy-enabling protocols (e.g., DNS over TLS
\[[RFC7858](#RFC7858){.xref}\] or DNS over HTTPS (DoH)
\[[RFC8484](#RFC8484){.xref}\]) to prevent eavesdroppers from possibly
identifying the target resources protected by the DDoS mitigation
service to ensure the target FQDN resolution is authentic (e.g., DNSSEC
\[[RFC4034](#RFC4034){.xref}\]).[¶](#section-10-11){.pilcrow}

CoAP-specific security considerations are discussed in [Section
11](https://www.rfc-editor.org/rfc/rfc7252#section-11){.relref} of
\[[RFC7252](#RFC7252){.xref}\], while CBOR-related security
considerations are discussed in [Section
8](https://www.rfc-editor.org/rfc/rfc7049#section-8){.relref} of
\[[RFC7049](#RFC7049){.xref}\].[¶](#section-10-12){.pilcrow}
:::
:::

::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-11.1 .section}
### [11.1.](#section-11.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0791\]
:   [Postel, J.]{.refAuthor}, [\"Internet Protocol\"]{.refTitle}, [STD
    5]{.seriesInfo}, [RFC 791]{.seriesInfo}, [DOI
    10.17487/RFC0791]{.seriesInfo}, September 1981,
    \<<https://www.rfc-editor.org/info/rfc791>\>.
:   

\[RFC1122\]
:   [Braden, R., Ed.]{.refAuthor}, [\"Requirements for Internet Hosts -
    Communication Layers\"]{.refTitle}, [STD 3]{.seriesInfo}, [RFC
    1122]{.seriesInfo}, [DOI 10.17487/RFC1122]{.seriesInfo}, October
    1989, \<<https://www.rfc-editor.org/info/rfc1122>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3688\]
:   [Mealling, M.]{.refAuthor}, [\"The IETF XML Registry\"]{.refTitle},
    [BCP 81]{.seriesInfo}, [RFC 3688]{.seriesInfo}, [DOI
    10.17487/RFC3688]{.seriesInfo}, January 2004,
    \<<https://www.rfc-editor.org/info/rfc3688>\>.
:   

\[RFC3986\]
:   [Berners-Lee, T.]{.refAuthor}[, Fielding, R.]{.refAuthor}[, and L.
    Masinter]{.refAuthor}, [\"Uniform Resource Identifier (URI): Generic
    Syntax\"]{.refTitle}, [STD 66]{.seriesInfo}, [RFC
    3986]{.seriesInfo}, [DOI 10.17487/RFC3986]{.seriesInfo}, January
    2005, \<<https://www.rfc-editor.org/info/rfc3986>\>.
:   

\[RFC4279\]
:   [Eronen, P., Ed.]{.refAuthor}[ and H. Tschofenig, Ed.]{.refAuthor},
    [\"Pre-Shared Key Ciphersuites for Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 4279]{.seriesInfo}, [DOI
    10.17487/RFC4279]{.seriesInfo}, December 2005,
    \<<https://www.rfc-editor.org/info/rfc4279>\>.
:   

\[RFC4632\]
:   [Fuller, V.]{.refAuthor}[ and T. Li]{.refAuthor}, [\"Classless
    Inter-domain Routing (CIDR): The Internet Address Assignment and
    Aggregation Plan\"]{.refTitle}, [BCP 122]{.seriesInfo}, [RFC
    4632]{.seriesInfo}, [DOI 10.17487/RFC4632]{.seriesInfo}, August
    2006, \<<https://www.rfc-editor.org/info/rfc4632>\>.
:   

\[RFC4648\]
:   [Josefsson, S.]{.refAuthor}, [\"The Base16, Base32, and Base64 Data
    Encodings\"]{.refTitle}, [RFC 4648]{.seriesInfo}, [DOI
    10.17487/RFC4648]{.seriesInfo}, October 2006,
    \<<https://www.rfc-editor.org/info/rfc4648>\>.
:   

\[RFC5246\]
:   [Dierks, T.]{.refAuthor}[ and E. Rescorla]{.refAuthor}, [\"The
    Transport Layer Security (TLS) Protocol Version 1.2\"]{.refTitle},
    [RFC 5246]{.seriesInfo}, [DOI 10.17487/RFC5246]{.seriesInfo}, August
    2008, \<<https://www.rfc-editor.org/info/rfc5246>\>.
:   

\[RFC5280\]
:   [Cooper, D.]{.refAuthor}[, Santesson, S.]{.refAuthor}[,
    Farrell, S.]{.refAuthor}[, Boeyen, S.]{.refAuthor}[,
    Housley, R.]{.refAuthor}[, and W. Polk]{.refAuthor}, [\"Internet
    X.509 Public Key Infrastructure Certificate and Certificate
    Revocation List (CRL) Profile\"]{.refTitle}, [RFC
    5280]{.seriesInfo}, [DOI 10.17487/RFC5280]{.seriesInfo}, May 2008,
    \<<https://www.rfc-editor.org/info/rfc5280>\>.
:   

\[RFC6066\]
:   [Eastlake 3rd, D.]{.refAuthor}, [\"Transport Layer Security (TLS)
    Extensions: Extension Definitions\"]{.refTitle}, [RFC
    6066]{.seriesInfo}, [DOI 10.17487/RFC6066]{.seriesInfo}, January
    2011, \<<https://www.rfc-editor.org/info/rfc6066>\>.
:   

\[RFC6125\]
:   [Saint-Andre, P.]{.refAuthor}[ and J. Hodges]{.refAuthor},
    [\"Representation and Verification of Domain-Based Application
    Service Identity within Internet Public Key Infrastructure Using
    X.509 (PKIX) Certificates in the Context of Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 6125]{.seriesInfo}, [DOI
    10.17487/RFC6125]{.seriesInfo}, March 2011,
    \<<https://www.rfc-editor.org/info/rfc6125>\>.
:   

\[RFC6347\]
:   [Rescorla, E.]{.refAuthor}[ and N. Modadugu]{.refAuthor},
    [\"Datagram Transport Layer Security Version 1.2\"]{.refTitle}, [RFC
    6347]{.seriesInfo}, [DOI 10.17487/RFC6347]{.seriesInfo}, January
    2012, \<<https://www.rfc-editor.org/info/rfc6347>\>.
:   

\[RFC6991\]
:   [Schoenwaelder, J., Ed.]{.refAuthor}, [\"Common YANG Data
    Types\"]{.refTitle}, [RFC 6991]{.seriesInfo}, [DOI
    10.17487/RFC6991]{.seriesInfo}, July 2013,
    \<<https://www.rfc-editor.org/info/rfc6991>\>.
:   

\[RFC7049\]
:   [Bormann, C.]{.refAuthor}[ and P. Hoffman]{.refAuthor}, [\"Concise
    Binary Object Representation (CBOR)\"]{.refTitle}, [RFC
    7049]{.seriesInfo}, [DOI 10.17487/RFC7049]{.seriesInfo}, October
    2013, \<<https://www.rfc-editor.org/info/rfc7049>\>.
:   

\[RFC7250\]
:   [Wouters, P., Ed.]{.refAuthor}[, Tschofenig, H., Ed.]{.refAuthor}[,
    Gilmore, J.]{.refAuthor}[, Weiler, S.]{.refAuthor}[, and T.
    Kivinen]{.refAuthor}, [\"Using Raw Public Keys in Transport Layer
    Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [RFC 7250]{.seriesInfo}, [DOI
    10.17487/RFC7250]{.seriesInfo}, June 2014,
    \<<https://www.rfc-editor.org/info/rfc7250>\>.
:   

\[RFC7252\]
:   [Shelby, Z.]{.refAuthor}[, Hartke, K.]{.refAuthor}[, and C.
    Bormann]{.refAuthor}, [\"The Constrained Application Protocol
    (CoAP)\"]{.refTitle}, [RFC 7252]{.seriesInfo}, [DOI
    10.17487/RFC7252]{.seriesInfo}, June 2014,
    \<<https://www.rfc-editor.org/info/rfc7252>\>.
:   

\[RFC7525\]
:   [Sheffer, Y.]{.refAuthor}[, Holz, R.]{.refAuthor}[, and P.
    Saint-Andre]{.refAuthor}, [\"Recommendations for Secure Use of
    Transport Layer Security (TLS) and Datagram Transport Layer Security
    (DTLS)\"]{.refTitle}, [BCP 195]{.seriesInfo}, [RFC
    7525]{.seriesInfo}, [DOI 10.17487/RFC7525]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7525>\>.
:   

\[RFC7641\]
:   [Hartke, K.]{.refAuthor}, [\"Observing Resources in the Constrained
    Application Protocol (CoAP)\"]{.refTitle}, [RFC 7641]{.seriesInfo},
    [DOI 10.17487/RFC7641]{.seriesInfo}, September 2015,
    \<<https://www.rfc-editor.org/info/rfc7641>\>.
:   

\[RFC7918\]
:   [Langley, A.]{.refAuthor}[, Modadugu, N.]{.refAuthor}[, and B.
    Moeller]{.refAuthor}, [\"Transport Layer Security (TLS) False
    Start\"]{.refTitle}, [RFC 7918]{.seriesInfo}, [DOI
    10.17487/RFC7918]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7918>\>.
:   

\[RFC7924\]
:   [Santesson, S.]{.refAuthor}[ and H. Tschofenig]{.refAuthor},
    [\"Transport Layer Security (TLS) Cached Information
    Extension\"]{.refTitle}, [RFC 7924]{.seriesInfo}, [DOI
    10.17487/RFC7924]{.seriesInfo}, July 2016,
    \<<https://www.rfc-editor.org/info/rfc7924>\>.
:   

\[RFC7950\]
:   [Bjorklund, M., Ed.]{.refAuthor}, [\"The YANG 1.1 Data Modeling
    Language\"]{.refTitle}, [RFC 7950]{.seriesInfo}, [DOI
    10.17487/RFC7950]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7950>\>.
:   

\[RFC7959\]
:   [Bormann, C.]{.refAuthor}[ and Z. Shelby, Ed.]{.refAuthor},
    [\"Block-Wise Transfers in the Constrained Application Protocol
    (CoAP)\"]{.refTitle}, [RFC 7959]{.seriesInfo}, [DOI
    10.17487/RFC7959]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7959>\>.
:   

\[RFC8085\]
:   [Eggert, L.]{.refAuthor}[, Fairhurst, G.]{.refAuthor}[, and G.
    Shepherd]{.refAuthor}, [\"UDP Usage Guidelines\"]{.refTitle}, [BCP
    145]{.seriesInfo}, [RFC 8085]{.seriesInfo}, [DOI
    10.17487/RFC8085]{.seriesInfo}, March 2017,
    \<<https://www.rfc-editor.org/info/rfc8085>\>.
:   

\[RFC8126\]
:   [Cotton, M.]{.refAuthor}[, Leiba, B.]{.refAuthor}[, and T.
    Narten]{.refAuthor}, [\"Guidelines for Writing an IANA
    Considerations Section in RFCs\"]{.refTitle}, [BCP 26]{.seriesInfo},
    [RFC 8126]{.seriesInfo}, [DOI 10.17487/RFC8126]{.seriesInfo}, June
    2017, \<<https://www.rfc-editor.org/info/rfc8126>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8200\]
:   [Deering, S.]{.refAuthor}[ and R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [STD
    86]{.seriesInfo}, [RFC 8200]{.seriesInfo}, [DOI
    10.17487/RFC8200]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8200>\>.
:   

\[RFC8305\]
:   [Schinazi, D.]{.refAuthor}[ and T. Pauly]{.refAuthor}, [\"Happy
    Eyeballs Version 2: Better Connectivity Using
    Concurrency\"]{.refTitle}, [RFC 8305]{.seriesInfo}, [DOI
    10.17487/RFC8305]{.seriesInfo}, December 2017,
    \<<https://www.rfc-editor.org/info/rfc8305>\>.
:   

\[RFC8323\]
:   [Bormann, C.]{.refAuthor}[, Lemay, S.]{.refAuthor}[,
    Tschofenig, H.]{.refAuthor}[, Hartke, K.]{.refAuthor}[,
    Silverajan, B.]{.refAuthor}[, and B. Raymor, Ed.]{.refAuthor},
    [\"CoAP (Constrained Application Protocol) over TCP, TLS, and
    WebSockets\"]{.refTitle}, [RFC 8323]{.seriesInfo}, [DOI
    10.17487/RFC8323]{.seriesInfo}, February 2018,
    \<<https://www.rfc-editor.org/info/rfc8323>\>.
:   

\[RFC8446\]
:   [Rescorla, E.]{.refAuthor}, [\"The Transport Layer Security (TLS)
    Protocol Version 1.3\"]{.refTitle}, [RFC 8446]{.seriesInfo}, [DOI
    10.17487/RFC8446]{.seriesInfo}, August 2018,
    \<<https://www.rfc-editor.org/info/rfc8446>\>.
:   

\[RFC8615\]
:   [Nottingham, M.]{.refAuthor}, [\"Well-Known Uniform Resource
    Identifiers (URIs)\"]{.refTitle}, [RFC 8615]{.seriesInfo}, [DOI
    10.17487/RFC8615]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8615>\>.
:   

\[RFC8768\]
:   [Boucadair, M.]{.refAuthor}[, Reddy.K, T.]{.refAuthor}[, and J.
    Shallow]{.refAuthor}, [\"Constrained Application Protocol (CoAP)
    Hop-Limit Option\"]{.refTitle}, [RFC 8768]{.seriesInfo}, [DOI
    10.17487/RFC8768]{.seriesInfo}, March 2020,
    \<<https://www.rfc-editor.org/info/rfc8768>\>.
:   
:::

::: {#section-11.2 .section}
### [11.2.](#section-11.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[COMI\]
:   [Veillette, M.]{.refAuthor}[, Stok, P.]{.refAuthor}[,
    Pelov, A.]{.refAuthor}[, Bierman, A.]{.refAuthor}[, and I.
    Petrov]{.refAuthor}, [\"CoAP Management Interface\"]{.refTitle},
    [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-core-comi-09]{.seriesInfo}, 9 March 2020,
    \<<https://tools.ietf.org/html/draft-ietf-core-comi-09>\>.
:   

\[CORE-YANG-CBOR\]
:   [Veillette, M.]{.refAuthor}[, Petrov, I.]{.refAuthor}[, and A.
    Pelov]{.refAuthor}, [\"CBOR Encoding of Data Modeled with
    YANG\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-core-yang-cbor-12]{.seriesInfo}, 9 March
    2020,
    \<<https://tools.ietf.org/html/draft-ietf-core-yang-cbor-12>\>.
:   

\[DOTS-ARCH\]
:   [Mortensen, A.]{.refAuthor}[, Reddy.K, T.]{.refAuthor}[,
    Andreasen, F.]{.refAuthor}[, Teague, N.]{.refAuthor}[, and R.
    Compton]{.refAuthor}, [\"Distributed-Denial-of-Service Open Threat
    Signaling (DOTS) Architecture\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-dots-architecture-18]{.seriesInfo}, 6 March 2020,
    \<<https://tools.ietf.org/html/draft-ietf-dots-architecture-18>\>.
:   

\[DOTS-EARLYDATA\]
:   [Boucadair, M.]{.refAuthor}[ and T. Reddy.K]{.refAuthor}, [\"Using
    Early Data in DOTS\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-boucadair-dots-earlydata-00]{.seriesInfo}, 29
    January 2019,
    \<<https://tools.ietf.org/html/draft-boucadair-dots-earlydata-00>\>.
:   

\[DOTS-MH\]
:   [Boucadair, M.]{.refAuthor}[, Reddy.K, T.]{.refAuthor}[, and W.
    Pan]{.refAuthor}, [\"Multi-homing Deployment Considerations for
    Distributed-Denial-of-Service Open Threat Signaling
    (DOTS)\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-dots-multihoming-03]{.seriesInfo}, 22
    January 2020,
    \<<https://tools.ietf.org/html/draft-ietf-dots-multihoming-03>\>.
:   

\[DOTS-SERVER-DISC\]
:   [Boucadair, M.]{.refAuthor}[ and T. Reddy.K]{.refAuthor},
    [\"Distributed-Denial-of-Service Open Threat Signaling (DOTS) Agent
    Discovery\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-dots-server-discovery-10]{.seriesInfo},
    7 February 2020,
    \<<https://tools.ietf.org/html/draft-ietf-dots-server-discovery-10>\>.
:   

\[DOTS-USE-CASES\]
:   [Dobbins, R.]{.refAuthor}[, Migault, D.]{.refAuthor}[,
    Moskowitz, R.]{.refAuthor}[, Teague, N.]{.refAuthor}[,
    Xia, L.]{.refAuthor}[, and K. Nishizuka]{.refAuthor}, [\"Use cases
    for DDoS Open Threat Signaling\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-dots-use-cases-21]{.seriesInfo}, 15 May 2020,
    \<<https://tools.ietf.org/html/draft-ietf-dots-use-cases-21>\>.
:   

\[DTLS\]
:   [Rescorla, E.]{.refAuthor}[, Tschofenig, H.]{.refAuthor}[, and N.
    Modadugu]{.refAuthor}, [\"The Datagram Transport Layer Security
    (DTLS) Protocol Version 1.3\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-tls-dtls13-37]{.seriesInfo}, 9 March 2020,
    \<<https://tools.ietf.org/html/draft-ietf-tls-dtls13-37>\>.
:   

\[IANA-CBOR-Tags\]
:   [IANA]{.refAuthor}, [\"Concise Binary Object Representation (CBOR)
    Tags\"]{.refTitle},
    \<[http://www.iana.org/assignments/cbor-tags/cbor-tags.xhtml](https://www.iana.org/assignments/cbor-tags/cbor-tags.xhtml)\>.
:   

\[IANA-CoAP-Content-Formats\]
:   [IANA]{.refAuthor}, [\"CoAP Content-Formats\"]{.refTitle},
    \<[http://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats](https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#content-formats)\>.
:   

\[IANA-MediaTypes\]
:   [IANA]{.refAuthor}, [\"Media Types\"]{.refTitle},
    \<[http://www.iana.org/assignments/media-types](https://www.iana.org/assignments/media-types)\>.
:   

\[IANA-Proto\]
:   [IANA]{.refAuthor}, [\"Protocol Numbers\"]{.refTitle}, 2011,
    \<[http://www.iana.org/assignments/protocol-numbers](https://www.iana.org/assignments/protocol-numbers)\>.
:   

\[RFC3022\]
:   [Srisuresh, P.]{.refAuthor}[ and K. Egevang]{.refAuthor},
    [\"Traditional IP Network Address Translator (Traditional
    NAT)\"]{.refTitle}, [RFC 3022]{.seriesInfo}, [DOI
    10.17487/RFC3022]{.seriesInfo}, January 2001,
    \<<https://www.rfc-editor.org/info/rfc3022>\>.
:   

\[RFC4034\]
:   [Arends, R.]{.refAuthor}[, Austein, R.]{.refAuthor}[,
    Larson, M.]{.refAuthor}[, Massey, D.]{.refAuthor}[, and S.
    Rose]{.refAuthor}, [\"Resource Records for the DNS Security
    Extensions\"]{.refTitle}, [RFC 4034]{.seriesInfo}, [DOI
    10.17487/RFC4034]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc4034>\>.
:   

\[RFC4122\]
:   [Leach, P.]{.refAuthor}[, Mealling, M.]{.refAuthor}[, and R.
    Salz]{.refAuthor}, [\"A Universally Unique IDentifier (UUID) URN
    Namespace\"]{.refTitle}, [RFC 4122]{.seriesInfo}, [DOI
    10.17487/RFC4122]{.seriesInfo}, July 2005,
    \<<https://www.rfc-editor.org/info/rfc4122>\>.
:   

\[RFC4340\]
:   [Kohler, E.]{.refAuthor}[, Handley, M.]{.refAuthor}[, and S.
    Floyd]{.refAuthor}, [\"Datagram Congestion Control Protocol
    (DCCP)\"]{.refTitle}, [RFC 4340]{.seriesInfo}, [DOI
    10.17487/RFC4340]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4340>\>.
:   

\[RFC4732\]
:   [Handley, M., Ed.]{.refAuthor}[, Rescorla, E., Ed.]{.refAuthor}[,
    and IAB]{.refAuthor}, [\"Internet Denial-of-Service
    Considerations\"]{.refTitle}, [RFC 4732]{.seriesInfo}, [DOI
    10.17487/RFC4732]{.seriesInfo}, December 2006,
    \<<https://www.rfc-editor.org/info/rfc4732>\>.
:   

\[RFC4787\]
:   [Audet, F., Ed.]{.refAuthor}[ and C. Jennings]{.refAuthor},
    [\"Network Address Translation (NAT) Behavioral Requirements for
    Unicast UDP\"]{.refTitle}, [BCP 127]{.seriesInfo}, [RFC
    4787]{.seriesInfo}, [DOI 10.17487/RFC4787]{.seriesInfo}, January
    2007, \<<https://www.rfc-editor.org/info/rfc4787>\>.
:   

\[RFC4960\]
:   [Stewart, R., Ed.]{.refAuthor}, [\"Stream Control Transmission
    Protocol\"]{.refTitle}, [RFC 4960]{.seriesInfo}, [DOI
    10.17487/RFC4960]{.seriesInfo}, September 2007,
    \<<https://www.rfc-editor.org/info/rfc4960>\>.
:   

\[RFC4987\]
:   [Eddy, W.]{.refAuthor}, [\"TCP SYN Flooding Attacks and Common
    Mitigations\"]{.refTitle}, [RFC 4987]{.seriesInfo}, [DOI
    10.17487/RFC4987]{.seriesInfo}, August 2007,
    \<<https://www.rfc-editor.org/info/rfc4987>\>.
:   

\[RFC5925\]
:   [Touch, J.]{.refAuthor}[, Mankin, A.]{.refAuthor}[, and R.
    Bonica]{.refAuthor}, [\"The TCP Authentication Option\"]{.refTitle},
    [RFC 5925]{.seriesInfo}, [DOI 10.17487/RFC5925]{.seriesInfo}, June
    2010, \<<https://www.rfc-editor.org/info/rfc5925>\>.
:   

\[RFC6052\]
:   [Bao, C.]{.refAuthor}[, Huitema, C.]{.refAuthor}[,
    Bagnulo, M.]{.refAuthor}[, Boucadair, M.]{.refAuthor}[, and X.
    Li]{.refAuthor}, [\"IPv6 Addressing of IPv4/IPv6
    Translators\"]{.refTitle}, [RFC 6052]{.seriesInfo}, [DOI
    10.17487/RFC6052]{.seriesInfo}, October 2010,
    \<<https://www.rfc-editor.org/info/rfc6052>\>.
:   

\[RFC6146\]
:   [Bagnulo, M.]{.refAuthor}[, Matthews, P.]{.refAuthor}[, and I. van
    Beijnum]{.refAuthor}, [\"Stateful NAT64: Network Address and
    Protocol Translation from IPv6 Clients to IPv4
    Servers\"]{.refTitle}, [RFC 6146]{.seriesInfo}, [DOI
    10.17487/RFC6146]{.seriesInfo}, April 2011,
    \<<https://www.rfc-editor.org/info/rfc6146>\>.
:   

\[RFC6234\]
:   [Eastlake 3rd, D.]{.refAuthor}[ and T. Hansen]{.refAuthor}, [\"US
    Secure Hash Algorithms (SHA and SHA-based HMAC and
    HKDF)\"]{.refTitle}, [RFC 6234]{.seriesInfo}, [DOI
    10.17487/RFC6234]{.seriesInfo}, May 2011,
    \<<https://www.rfc-editor.org/info/rfc6234>\>.
:   

\[RFC6296\]
:   [Wasserman, M.]{.refAuthor}[ and F. Baker]{.refAuthor},
    [\"IPv6-to-IPv6 Network Prefix Translation\"]{.refTitle}, [RFC
    6296]{.seriesInfo}, [DOI 10.17487/RFC6296]{.seriesInfo}, June 2011,
    \<<https://www.rfc-editor.org/info/rfc6296>\>.
:   

\[RFC6724\]
:   [Thaler, D., Ed.]{.refAuthor}[, Draves, R.]{.refAuthor}[,
    Matsumoto, A.]{.refAuthor}[, and T. Chown]{.refAuthor}, [\"Default
    Address Selection for Internet Protocol Version 6
    (IPv6)\"]{.refTitle}, [RFC 6724]{.seriesInfo}, [DOI
    10.17487/RFC6724]{.seriesInfo}, September 2012,
    \<<https://www.rfc-editor.org/info/rfc6724>\>.
:   

\[RFC6838\]
:   [Freed, N.]{.refAuthor}[, Klensin, J.]{.refAuthor}[, and T.
    Hansen]{.refAuthor}, [\"Media Type Specifications and Registration
    Procedures\"]{.refTitle}, [BCP 13]{.seriesInfo}, [RFC
    6838]{.seriesInfo}, [DOI 10.17487/RFC6838]{.seriesInfo}, January
    2013, \<<https://www.rfc-editor.org/info/rfc6838>\>.
:   

\[RFC6887\]
:   [Wing, D., Ed.]{.refAuthor}[, Cheshire, S.]{.refAuthor}[,
    Boucadair, M.]{.refAuthor}[, Penno, R.]{.refAuthor}[, and P.
    Selkirk]{.refAuthor}, [\"Port Control Protocol (PCP)\"]{.refTitle},
    [RFC 6887]{.seriesInfo}, [DOI 10.17487/RFC6887]{.seriesInfo}, April
    2013, \<<https://www.rfc-editor.org/info/rfc6887>\>.
:   

\[RFC6888\]
:   [Perreault, S., Ed.]{.refAuthor}[, Yamagata, I.]{.refAuthor}[,
    Miyakawa, S.]{.refAuthor}[, Nakagawa, A.]{.refAuthor}[, and H.
    Ashida]{.refAuthor}, [\"Common Requirements for Carrier-Grade NATs
    (CGNs)\"]{.refTitle}, [BCP 127]{.seriesInfo}, [RFC
    6888]{.seriesInfo}, [DOI 10.17487/RFC6888]{.seriesInfo}, April 2013,
    \<<https://www.rfc-editor.org/info/rfc6888>\>.
:   

\[RFC7030\]
:   [Pritikin, M., Ed.]{.refAuthor}[, Yee, P., Ed.]{.refAuthor}[, and D.
    Harkins, Ed.]{.refAuthor}, [\"Enrollment over Secure
    Transport\"]{.refTitle}, [RFC 7030]{.seriesInfo}, [DOI
    10.17487/RFC7030]{.seriesInfo}, October 2013,
    \<<https://www.rfc-editor.org/info/rfc7030>\>.
:   

\[RFC7413\]
:   [Cheng, Y.]{.refAuthor}[, Chu, J.]{.refAuthor}[,
    Radhakrishnan, S.]{.refAuthor}[, and A. Jain]{.refAuthor}, [\"TCP
    Fast Open\"]{.refTitle}, [RFC 7413]{.seriesInfo}, [DOI
    10.17487/RFC7413]{.seriesInfo}, December 2014,
    \<<https://www.rfc-editor.org/info/rfc7413>\>.
:   

\[RFC7452\]
:   [Tschofenig, H.]{.refAuthor}[, Arkko, J.]{.refAuthor}[,
    Thaler, D.]{.refAuthor}[, and D. McPherson]{.refAuthor},
    [\"Architectural Considerations in Smart Object
    Networking\"]{.refTitle}, [RFC 7452]{.seriesInfo}, [DOI
    10.17487/RFC7452]{.seriesInfo}, March 2015,
    \<<https://www.rfc-editor.org/info/rfc7452>\>.
:   

\[RFC7589\]
:   [Badra, M.]{.refAuthor}[, Luchuk, A.]{.refAuthor}[, and J.
    Schoenwaelder]{.refAuthor}, [\"Using the NETCONF Protocol over
    Transport Layer Security (TLS) with Mutual X.509
    Authentication\"]{.refTitle}, [RFC 7589]{.seriesInfo}, [DOI
    10.17487/RFC7589]{.seriesInfo}, June 2015,
    \<<https://www.rfc-editor.org/info/rfc7589>\>.
:   

\[RFC7858\]
:   [Hu, Z.]{.refAuthor}[, Zhu, L.]{.refAuthor}[,
    Heidemann, J.]{.refAuthor}[, Mankin, A.]{.refAuthor}[,
    Wessels, D.]{.refAuthor}[, and P. Hoffman]{.refAuthor},
    [\"Specification for DNS over Transport Layer Security
    (TLS)\"]{.refTitle}, [RFC 7858]{.seriesInfo}, [DOI
    10.17487/RFC7858]{.seriesInfo}, May 2016,
    \<<https://www.rfc-editor.org/info/rfc7858>\>.
:   

\[RFC7951\]
:   [Lhotka, L.]{.refAuthor}, [\"JSON Encoding of Data Modeled with
    YANG\"]{.refTitle}, [RFC 7951]{.seriesInfo}, [DOI
    10.17487/RFC7951]{.seriesInfo}, August 2016,
    \<<https://www.rfc-editor.org/info/rfc7951>\>.
:   

\[RFC8340\]
:   [Bjorklund, M.]{.refAuthor}[ and L. Berger, Ed.]{.refAuthor},
    [\"YANG Tree Diagrams\"]{.refTitle}, [BCP 215]{.seriesInfo}, [RFC
    8340]{.seriesInfo}, [DOI 10.17487/RFC8340]{.seriesInfo}, March 2018,
    \<<https://www.rfc-editor.org/info/rfc8340>\>.
:   

\[RFC8484\]
:   [Hoffman, P.]{.refAuthor}[ and P. McManus]{.refAuthor}, [\"DNS
    Queries over HTTPS (DoH)\"]{.refTitle}, [RFC 8484]{.seriesInfo},
    [DOI 10.17487/RFC8484]{.seriesInfo}, October 2018,
    \<<https://www.rfc-editor.org/info/rfc8484>\>.
:   

\[RFC8489\]
:   [Petit-Huguenin, M.]{.refAuthor}[, Salgueiro, G.]{.refAuthor}[,
    Rosenberg, J.]{.refAuthor}[, Wing, D.]{.refAuthor}[,
    Mahy, R.]{.refAuthor}[, and P. Matthews]{.refAuthor}, [\"Session
    Traversal Utilities for NAT (STUN)\"]{.refTitle}, [RFC
    8489]{.seriesInfo}, [DOI 10.17487/RFC8489]{.seriesInfo}, February
    2020, \<<https://www.rfc-editor.org/info/rfc8489>\>.
:   

\[RFC8499\]
:   [Hoffman, P.]{.refAuthor}[, Sullivan, A.]{.refAuthor}[, and K.
    Fujiwara]{.refAuthor}, [\"DNS Terminology\"]{.refTitle}, [BCP
    219]{.seriesInfo}, [RFC 8499]{.seriesInfo}, [DOI
    10.17487/RFC8499]{.seriesInfo}, January 2019,
    \<<https://www.rfc-editor.org/info/rfc8499>\>.
:   

\[RFC8612\]
:   [Mortensen, A.]{.refAuthor}[, Reddy, T.]{.refAuthor}[, and R.
    Moskowitz]{.refAuthor}, [\"DDoS Open Threat Signaling (DOTS)
    Requirements\"]{.refTitle}, [RFC 8612]{.seriesInfo}, [DOI
    10.17487/RFC8612]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8612>\>.
:   

\[RFC8783\]
:   [Boucadair, M., Ed.]{.refAuthor}[ and T. Reddy.K, Ed.]{.refAuthor},
    [\"Distributed Denial-of-Service Open Threat Signaling (DOTS) Data
    Channel Specification\"]{.refTitle}, [RFC 8783]{.seriesInfo}, [DOI
    10.17487/RFC8783]{.seriesInfo}, May 2020,
    \<<https://www.rfc-editor.org/info/rfc8783>\>.
:   
:::
:::

::: {#motiv}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [CUID Generation](#name-cuid-generation){.section-name .selfRef} {#name-cuid-generation}

The document recommends the use of SPKI to generate the \'cuid\'. This
design choice is motivated by the following
reasons:[¶](#section-appendix.a-1){.pilcrow}

-   [SPKI is globally
    unique.[¶](#section-appendix.a-2.1){.pilcrow}]{#section-appendix.a-2.1}
-   [It is
    deterministic.[¶](#section-appendix.a-2.2){.pilcrow}]{#section-appendix.a-2.2}
-   [It allows the avoidance of extra cycles that may be induced by
    \'cuid\'
    collision.[¶](#section-appendix.a-2.3){.pilcrow}]{#section-appendix.a-2.3}
-   [DOTS clients do not need to store the \'cuid\' in a persistent
    storage.[¶](#section-appendix.a-2.4){.pilcrow}]{#section-appendix.a-2.4}
-   [It allows the detection of compromised DOTS clients that do not
    adhere to the \'cuid\' generation
    algorithm.[¶](#section-appendix.a-2.5){.pilcrow}]{#section-appendix.a-2.5}
:::
:::

::: {#ack}
::: {#section-appendix.b .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

Thanks to [Christian Jacquenet]{.contact-name}, [Roland
Dobbins]{.contact-name}, [Roman Danyliw]{.contact-name}, [Michael
Richardson]{.contact-name}, [Ehud Doron]{.contact-name}, [Kaname
Nishizuka]{.contact-name}, [Dave Dolson]{.contact-name}, [Liang
Xia]{.contact-name}, [Gilbert Clark]{.contact-name}, [Xialiang
Frank]{.contact-name}, [Jim Schaad]{.contact-name}, [Klaus
Hartke]{.contact-name}, [Nesredien Suleiman]{.contact-name}, [Stephen
Farrell]{.contact-name}, and [Yoshifumi Nishida]{.contact-name} for the
discussion and comments.[¶](#section-appendix.b-1){.pilcrow}

The authors would like to give special thanks to [Kaname
Nishizuka]{.contact-name} and [Jon Shallow]{.contact-name} for their
efforts in implementing the protocol and performing interop testing at
IETF Hackathons.[¶](#section-appendix.b-2){.pilcrow}

Thanks to the core WG for the recommendations on Hop-Limit and redirect
signaling.[¶](#section-appendix.b-3){.pilcrow}

Special thanks to [Benjamin Kaduk]{.contact-name} for the detailed AD
review.[¶](#section-appendix.b-4){.pilcrow}

Thanks to [Alexey Melnikov]{.contact-name}, [Adam Roach]{.contact-name},
[Suresh Krishnan]{.contact-name}, [Mirja Kühlewind]{.contact-name}, and
[Alissa Cooper]{.contact-name} for the
review.[¶](#section-appendix.b-5){.pilcrow}

Thanks to [Carsten Bormann]{.contact-name} for his review of the DOTS
heartbeat mechanism.[¶](#section-appendix.b-6){.pilcrow}
:::
:::

::: {#contr}
::: {#section-appendix.c .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The following individuals have contributed to this
document:[¶](#section-appendix.c-1){.pilcrow}

::: {.left dir="auto"}
[Jon Shallow]{.fn .nameRole}
:::

::: {.left dir="auto"}
[NCC Group]{.org}
:::

::: email
Email: <jon.shallow@nccgroup.trust>
:::

::: {.left dir="auto"}
[Mike Geller]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc.]{.org}
:::

::: {.left dir="auto"}
[FL]{.region} [33309]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <mgeller@cisco.com>
:::

::: {.left dir="auto"}
[Robert Moskowitz]{.fn .nameRole}
:::

::: {.left dir="auto"}
[HTT Consulting]{.org}
:::

::: {.left dir="auto"}
[Oak Park]{.locality}, [MI]{.region} [42837]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <rgm@htt-consult.com>
:::

::: {.left dir="auto"}
[Dan Wing]{.fn .nameRole}
:::

::: email
Email: <dwing-ietf@fuggles.com>
:::
:::
:::

::: {#authors-addresses}
::: {#section-appendix.d .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Tirumaleswar Reddy.K ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[McAfee, Inc.]{.org}
:::

::: {.left dir="auto"}
[Embassy Golf Link Business Park]{.street-address}
:::

::: {.left dir="auto"}
[Bangalore]{.locality} [560071]{.postal-code}
:::

::: {.left dir="auto"}
[Karnataka]{.region}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <kondtir@gmail.com>
:::

::: {.left dir="auto"}
[Mohamed Boucadair ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Orange]{.org}
:::

::: {.left dir="auto"}
[35000]{.postal-code} [Rennes]{.locality}
:::

::: {.left dir="auto"}
[France]{.country-name}
:::

::: email
Email: <mohamed.boucadair@orange.com>
:::

::: {.left dir="auto"}
[Prashanth Patil]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc.]{.org}
:::

::: email
Email: <praspati@cisco.com>
:::

::: {.left dir="auto"}
[Andrew Mortensen]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Arbor Networks, Inc.]{.org}
:::

::: {.left dir="auto"}
[2727 S. State Street]{.street-address}
:::

::: {.left dir="auto"}
[Ann Arbor]{.locality}, [MI]{.region} [48104]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <andrew@moretension.com>
:::

::: {.left dir="auto"}
[Nik Teague]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Iron Mountain Data Centers]{.org}
:::

::: {.left dir="auto"}
[United Kingdom]{.country-name}
:::

::: email
Email: <nteague@ironmountain.co.uk>
:::
:::
:::
