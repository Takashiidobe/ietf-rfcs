  RFC 8907       TACACS+         September 2020
  -------------- --------------- ----------------
  Dahm, et al.   Informational   \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [8907](https://www.rfc-editor.org/rfc/rfc8907){.eref}

Category:
:   Informational

Published:
:   September 2020

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    T. Dahm
    :::

    ::: org
    Google Inc.
    :::
    :::

    ::: author
    ::: author-name
    A. Ota
    :::

    ::: org
    Google Inc.
    :::
    :::

    ::: author
    ::: author-name
    D.C. Medway Gash
    :::

    ::: org
    Cisco Systems, Inc.
    :::
    :::

    ::: author
    ::: author-name
    D. Carrel
    :::

    ::: org
    IPsec Research
    :::
    :::

    ::: author
    ::: author-name
    L. Grant
    :::
    :::
:::

# RFC 8907 {#rfcnum}

# The Terminal Access Controller Access-Control System Plus (TACACS+) Protocol {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document describes the Terminal Access Controller Access-Control
System Plus (TACACS+) protocol, which is widely deployed today to
provide Device Administration for routers, network access servers, and
other networked computing devices via one or more centralized
servers.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This document is not an Internet Standards Track specification; it is
published for informational
purposes.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Not all documents approved
by the IESG are candidates for any level of Internet Standard; see
Section 2 of RFC 7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc8907>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2020 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}

This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November 10,
2008. The person(s) controlling the copyright in some of this material
may not have granted the IETF Trust the right to allow modifications of
such material outside the IETF Standards Process. Without obtaining an
adequate license from the person(s) controlling the copyright in such
materials, this document may not be modified outside the IETF Standards
Process, and derivative works of it may not be created outside the IETF
Standards Process, except to format it for publication as an RFC or to
translate it into languages other than
English.[¶](#section-boilerplate.2-3){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}[¶](#section-toc.1-1.1.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions](#name-conventions){.xref}[¶](#section-toc.1-1.2.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [Technical
    Definitions](#name-technical-definitions){.xref}[¶](#section-toc.1-1.3.1){.pilcrow}

    -   ::: {#section-toc.1-1.3.2.1}
        [3.1](#section-3.1){.xref}.  [Client](#name-client){.xref}[¶](#section-toc.1-1.3.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.2}
        [3.2](#section-3.2){.xref}.  [Server](#name-server){.xref}[¶](#section-toc.1-1.3.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.3}
        [3.3](#section-3.3){.xref}.  [Packet](#name-packet){.xref}[¶](#section-toc.1-1.3.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.4}
        [3.4](#section-3.4){.xref}.  [Connection](#name-connection){.xref}[¶](#section-toc.1-1.3.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.5}
        [3.5](#section-3.5){.xref}.  [Session](#name-session){.xref}[¶](#section-toc.1-1.3.2.5.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.6}
        [3.6](#section-3.6){.xref}.  [Treatment of Enumerated Protocol
        Values](#name-treatment-of-enumerated-pro){.xref}[¶](#section-toc.1-1.3.2.6.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.3.2.7}
        [3.7](#section-3.7){.xref}.  [Treatment of Text
        Strings](#name-treatment-of-text-strings){.xref}[¶](#section-toc.1-1.3.2.7.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [TACACS+ Packets and
    Sessions](#name-tacacs-packets-and-sessions){.xref}[¶](#section-toc.1-1.4.1){.pilcrow}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [The TACACS+ Packet
        Header](#name-the-tacacs-packet-header){.xref}[¶](#section-toc.1-1.4.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [The TACACS+ Packet
        Body](#name-the-tacacs-packet-body){.xref}[¶](#section-toc.1-1.4.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Single Connection
        Mode](#name-single-connection-mode){.xref}[¶](#section-toc.1-1.4.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Session
        Completion](#name-session-completion){.xref}[¶](#section-toc.1-1.4.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [Data
        Obfuscation](#name-data-obfuscation){.xref}[¶](#section-toc.1-1.4.2.5.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Authentication](#name-authentication){.xref}[¶](#section-toc.1-1.5.1){.pilcrow}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [The Authentication START Packet
        Body](#name-the-authentication-start-pa){.xref}[¶](#section-toc.1-1.5.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [The Authentication REPLY Packet
        Body](#name-the-authentication-reply-pa){.xref}[¶](#section-toc.1-1.5.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [The Authentication CONTINUE Packet
        Body](#name-the-authentication-continue){.xref}[¶](#section-toc.1-1.5.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Description of Authentication
        Process](#name-description-of-authenticati){.xref}[¶](#section-toc.1-1.5.2.4.1){.pilcrow}

        -   ::: {#section-toc.1-1.5.2.4.2.1}
            [5.4.1](#section-5.4.1){.xref}.  [Version
            Behavior](#name-version-behavior){.xref}[¶](#section-toc.1-1.5.2.4.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.4.2.2}
            [5.4.2](#section-5.4.2){.xref}.  [Common Authentication
            Flows](#name-common-authentication-flows){.xref}[¶](#section-toc.1-1.5.2.4.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.5.2.4.2.3}
            [5.4.3](#section-5.4.3){.xref}.  [Aborting an Authentication
            Session](#name-aborting-an-authentication-){.xref}[¶](#section-toc.1-1.5.2.4.2.3.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Authorization](#name-authorization){.xref}[¶](#section-toc.1-1.6.1){.pilcrow}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [The Authorization REQUEST Packet
        Body](#name-the-authorization-request-p){.xref}[¶](#section-toc.1-1.6.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [The Authorization REPLY Packet
        Body](#name-the-authorization-reply-pac){.xref}[¶](#section-toc.1-1.6.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [Accounting](#name-accounting){.xref}[¶](#section-toc.1-1.7.1){.pilcrow}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [The Account REQUEST Packet
        Body](#name-the-account-request-packet-){.xref}[¶](#section-toc.1-1.7.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [The Accounting REPLY Packet
        Body](#name-the-accounting-reply-packet){.xref}[¶](#section-toc.1-1.7.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Argument-Value
    Pairs](#name-argument-value-pairs){.xref}[¶](#section-toc.1-1.8.1){.pilcrow}

    -   ::: {#section-toc.1-1.8.2.1}
        [8.1](#section-8.1){.xref}.  [Value
        Encoding](#name-value-encoding){.xref}[¶](#section-toc.1-1.8.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.2}
        [8.2](#section-8.2){.xref}.  [Authorization
        Arguments](#name-authorization-arguments){.xref}[¶](#section-toc.1-1.8.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.8.2.3}
        [8.3](#section-8.3){.xref}.  [Accounting
        Arguments](#name-accounting-arguments){.xref}[¶](#section-toc.1-1.8.2.3.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Privilege
    Levels](#name-privilege-levels){.xref}[¶](#section-toc.1-1.9.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [Security
    Considerations](#name-security-considerations){.xref}[¶](#section-toc.1-1.10.1){.pilcrow}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [General Security of the
        Protocol](#name-general-security-of-the-pro){.xref}[¶](#section-toc.1-1.10.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Security of Authentication
        Sessions](#name-security-of-authentication-){.xref}[¶](#section-toc.1-1.10.2.2.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.3}
        [10.3](#section-10.3){.xref}.  [Security of Authorization
        Sessions](#name-security-of-authorization-s){.xref}[¶](#section-toc.1-1.10.2.3.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.4}
        [10.4](#section-10.4){.xref}.  [Security of Accounting
        Sessions](#name-security-of-accounting-sess){.xref}[¶](#section-toc.1-1.10.2.4.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.10.2.5}
        [10.5](#section-10.5){.xref}.  [TACACS+ Best
        Practices](#name-tacacs-best-practices){.xref}[¶](#section-toc.1-1.10.2.5.1){.pilcrow}

        -   ::: {#section-toc.1-1.10.2.5.2.1}
            [10.5.1](#section-10.5.1){.xref}.  [Shared
            Secrets](#name-shared-secrets){.xref}[¶](#section-toc.1-1.10.2.5.2.1.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.10.2.5.2.2}
            [10.5.2](#section-10.5.2){.xref}.  [Connections and
            Obfuscation](#name-connections-and-obfuscation){.xref}[¶](#section-toc.1-1.10.2.5.2.2.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.10.2.5.2.3}
            [10.5.3](#section-10.5.3){.xref}.  [Authentication](#name-authentication-2){.xref}[¶](#section-toc.1-1.10.2.5.2.3.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.10.2.5.2.4}
            [10.5.4](#section-10.5.4){.xref}.  [Authorization](#name-authorization-2){.xref}[¶](#section-toc.1-1.10.2.5.2.4.1){.pilcrow}
            :::

        -   ::: {#section-toc.1-1.10.2.5.2.5}
            [10.5.5](#section-10.5.5){.xref}.  [Redirection
            Mechanism](#name-redirection-mechanism){.xref}[¶](#section-toc.1-1.10.2.5.2.5.1){.pilcrow}
            :::
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [11](#section-11){.xref}. [IANA
    Considerations](#name-iana-considerations){.xref}[¶](#section-toc.1-1.11.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.12}
    [12](#section-12){.xref}. [References](#name-references){.xref}[¶](#section-toc.1-1.12.1){.pilcrow}

    -   ::: {#section-toc.1-1.12.2.1}
        [12.1](#section-12.1){.xref}.  [Normative
        References](#name-normative-references){.xref}[¶](#section-toc.1-1.12.2.1.1){.pilcrow}
        :::

    -   ::: {#section-toc.1-1.12.2.2}
        [12.2](#section-12.2){.xref}.  [Informative
        References](#name-informative-references){.xref}[¶](#section-toc.1-1.12.2.2.1){.pilcrow}
        :::
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.a){.xref}[Acknowledgements](#name-acknowledgements){.xref}[¶](#section-toc.1-1.13.1){.pilcrow}
    :::

-   ::: {#section-toc.1-1.14}
    [](#section-appendix.b){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}[¶](#section-toc.1-1.14.1){.pilcrow}
    :::
:::
:::

::: {#Introduction}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

This document describes the Terminal Access Controller Access-Control
System Plus (TACACS+) protocol. It was conceived initially as a general
Authentication, Authorization, and Accounting (AAA) protocol. It is
widely deployed today but is mainly confined for a specific subset of
AAA called Device Administration, which includes authenticating access
to network devices, providing central authorization of operations, and
auditing of those operations.[¶](#section-1-1){.pilcrow}

A wide range of TACACS+ clients and servers is already deployed in the
field. The TACACS+ protocol they are based on is defined in a document
that was originally intended for IETF publication, but was never
standardized. The document is known as \"The Draft\"
\[[THE-DRAFT](#THE-DRAFT){.xref}\].[¶](#section-1-2){.pilcrow}

This Draft was a product of its time and did not address all of the key
security concerns that are considered when designing modern standards.
Therefore, deployment must be executed with care. These concerns are
addressed in [Section
10](#TACACSSecurity){.xref}.[¶](#section-1-3){.pilcrow}

The primary intent of this informational document is to clarify the
subset of \"The Draft\", which is common to implementations supporting
Device Administration. It is intended that all implementations that
conform to this document will conform to \"The Draft\". However, it is
not intended that all implementations that conform to \"The Draft\" will
conform to this document. The following features from \"The Draft\" have
been removed:[¶](#section-1-4){.pilcrow}

-   [This document officially removes SENDPASS for security
    reasons.[¶](#section-1-5.1){.pilcrow}]{#section-1-5.1}
-   [The normative description of legacy features such as the Apple
    Remote Access Protocol (ARAP) and outbound authentication has been
    removed.[¶](#section-1-5.2){.pilcrow}]{#section-1-5.2}
-   [The Support for forwarding to an alternative daemon
    (TAC_PLUS_AUTHEN_STATUS_FOLLOW) has been
    deprecated.[¶](#section-1-5.3){.pilcrow}]{#section-1-5.3}

The TACACS+ protocol allows for arbitrary length and content
authentication exchanges to support alternative authentication
mechanisms. It is extensible to provide for site customization and
future development features, and it uses TCP to ensure reliable
delivery. The protocol allows the TACACS+ client to request fine-grained
access control and allows the server to respond to each component of
that request.[¶](#section-1-6){.pilcrow}

The separation of authentication, authorization, and accounting is a key
element of the design of TACACS+ protocol. Essentially, it makes TACACS+
a suite of three protocols. This document will address each one in
separate sections. Although TACACS+ defines all three, an implementation
or deployment is not required to employ all three. Separating the
elements is useful for the Device Administration use case, specifically,
for authorization and accounting of individual commands in a session.
Note that there is no provision made at the protocol level to associate
authentication requests with authorization
requests.[¶](#section-1-7){.pilcrow}
:::
:::

::: {#Conventions}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions](#name-conventions){.section-name .selfRef} {#name-conventions}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}
:::
:::

::: {#TechnicalDefinitions}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [Technical Definitions](#name-technical-definitions){.section-name .selfRef} {#name-technical-definitions}

This section provides a few basic definitions that are applicable to
this document.[¶](#section-3-1){.pilcrow}

::: {#Client}
::: {#section-3.1 .section}
### [3.1.](#section-3.1){.section-number .selfRef} [Client](#name-client){.section-name .selfRef} {#name-client}

The client is any device that initiates TACACS+ protocol requests to
mediate access, mainly for the Device Administration use
case.[¶](#section-3.1-1){.pilcrow}
:::
:::

::: {#Server}
::: {#section-3.2 .section}
### [3.2.](#section-3.2){.section-number .selfRef} [Server](#name-server){.section-name .selfRef} {#name-server}

The server receives TACACS+ protocol requests and replies according to
its business model in accordance with the flows defined in this
document.[¶](#section-3.2-1){.pilcrow}
:::
:::

::: {#Packet}
::: {#section-3.3 .section}
### [3.3.](#section-3.3){.section-number .selfRef} [Packet](#name-packet){.section-name .selfRef} {#name-packet}

All uses of the word packet in this document refer to TACACS+ protocol
data units unless explicitly noted otherwise. The informal term
\"packet\" has become an established part of the
definition.[¶](#section-3.3-1){.pilcrow}
:::
:::

::: {#Connection}
::: {#section-3.4 .section}
### [3.4.](#section-3.4){.section-number .selfRef} [Connection](#name-connection){.section-name .selfRef} {#name-connection}

TACACS+ uses TCP for its transport. TCP Server port 49 is allocated by
IANA for TACACS+ traffic.[¶](#section-3.4-1){.pilcrow}
:::
:::

::: {#Session}
::: {#section-3.5 .section}
### [3.5.](#section-3.5){.section-number .selfRef} [Session](#name-session){.section-name .selfRef} {#name-session}

The concept of a session is used throughout this document. A TACACS+
session is a single authentication sequence, a single authorization
exchange, or a single accounting exchange.[¶](#section-3.5-1){.pilcrow}

An accounting and authorization session will consist of a single pair of
packets (the request and its reply). An authentication session may
involve an arbitrary number of packets being exchanged. The session is
an operational concept that is maintained between the TACACS+ client and
server. It does not necessarily correspond to a given user or user
action.[¶](#section-3.5-2){.pilcrow}
:::
:::

::: {#TreatmentOfEnumeratedValues}
::: {#section-3.6 .section}
### [3.6.](#section-3.6){.section-number .selfRef} [Treatment of Enumerated Protocol Values](#name-treatment-of-enumerated-pro){.section-name .selfRef} {#name-treatment-of-enumerated-pro}

This document describes various enumerated values in the packet header
and the headers for specific packet types. For example, in the
authentication start packet type, this document defines the action field
with three values: TAC_PLUS_AUTHEN_LOGIN, TAC_PLUS_AUTHEN_CHPASS, and
TAC_PLUS_AUTHEN_SENDAUTH.[¶](#section-3.6-1){.pilcrow}

If the server does not implement one of the defined options in a packet
that it receives, or it encounters an option that is not listed in this
document for a header field, then it should respond with an ERROR and
terminate the session. This will allow the client to try a different
option.[¶](#section-3.6-2){.pilcrow}

If an error occurs but the type of the incoming packet cannot be
determined, a packet with the identical cleartext header but with a
sequence number incremented by one and the length set to zero
[MUST]{.bcp14} be returned to indicate an
error.[¶](#section-3.6-3){.pilcrow}
:::
:::

::: {#TextEncoding}
::: {#section-3.7 .section}
### [3.7.](#section-3.7){.section-number .selfRef} [Treatment of Text Strings](#name-treatment-of-text-strings){.section-name .selfRef} {#name-treatment-of-text-strings}

The TACACS+ protocol makes extensive use of text strings. \"The Draft\"
intended that these strings would be treated as byte arrays where each
byte would represent a US-ASCII character.[¶](#section-3.7-1){.pilcrow}

More recently, server implementations have been extended to interwork
with external identity services, and so a more nuanced approach is
needed. Usernames [MUST]{.bcp14} be encoded and handled using the
UsernameCasePreserved Profile specified in
\[[RFC8265](#RFC8265){.xref}\]. The security considerations in [Section
8](https://www.rfc-editor.org/rfc/rfc8265#section-8){.relref} of
\[[RFC8265](#RFC8265){.xref}\] apply.[¶](#section-3.7-2){.pilcrow}

Where specifically mentioned, data fields contain arrays of arbitrary
bytes as required for protocol processing. These are not intended to be
made visible through user interface to
users.[¶](#section-3.7-3){.pilcrow}

All other text fields in TACACS+ [MUST]{.bcp14} be treated as printable
byte arrays of US-ASCII as defined by \[[RFC0020](#RFC0020){.xref}\].
The term \"printable\" used here means the fields [MUST]{.bcp14} exclude
the \"Control Characters\" defined in [Section
5.2](https://www.rfc-editor.org/rfc/rfc20#section-5.2){.relref} of
\[[RFC0020](#RFC0020){.xref}\].[¶](#section-3.7-4){.pilcrow}
:::
:::
:::
:::

::: {#TACACSPacketsSessions}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [TACACS+ Packets and Sessions](#name-tacacs-packets-and-sessions){.section-name .selfRef} {#name-tacacs-packets-and-sessions}

::: {#TheTACACSPacketHeader}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [The TACACS+ Packet Header](#name-the-tacacs-packet-header){.section-name .selfRef} {#name-the-tacacs-packet-header}

All TACACS+ packets begin with the following 12-byte header. The header
describes the remainder of the packet:[¶](#section-4.1-1){.pilcrow}

::: {#section-4.1-2 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |major  | minor  |                |                |                |
    |version| version|      type      |     seq_no     |   flags        |
    +----------------+----------------+----------------+----------------+
    |                                                                   |
    |                            session_id                             |
    +----------------+----------------+----------------+----------------+
    |                                                                   |
    |                              length                               |
    +----------------+----------------+----------------+----------------+

[¶](#section-4.1-2){.pilcrow}
:::

The following general rules apply to all TACACS+ packet
types:[¶](#section-4.1-3){.pilcrow}

-   [To signal that any variable-length data fields are unused, the
    corresponding length values are set to zero. Such fields
    [MUST]{.bcp14} be ignored, and treated as if not
    present.[¶](#section-4.1-4.1){.pilcrow}]{#section-4.1-4.1}
-   [The lengths of data and message fields in a packet are specified by
    their corresponding length field (and are not null
    terminated).[¶](#section-4.1-4.2){.pilcrow}]{#section-4.1-4.2}
-   [All length values are unsigned and in network byte
    order.[¶](#section-4.1-4.3){.pilcrow}]{#section-4.1-4.3}

major_version[¶](#section-4.1-5){.pilcrow}

-   ::: {#section-4.1-6.1}
    This is the major TACACS+ version
    number.[¶](#section-4.1-6.1.1){.pilcrow}
    :::

```{=html}
<!-- -->
```
-   [TAC_PLUS_MAJOR_VER :=
    0xc[¶](#section-4.1-7.1){.pilcrow}]{#section-4.1-7.1}

minor_version[¶](#section-4.1-8){.pilcrow}

-   ::: {#section-4.1-9.1}
    This is the minor TACACS+ version
    number.[¶](#section-4.1-9.1.1){.pilcrow}
    :::

-   [TAC_PLUS_MINOR_VER_DEFAULT :=
    0x0[¶](#section-4.1-9.2){.pilcrow}]{#section-4.1-9.2}

-   [TAC_PLUS_MINOR_VER_ONE :=
    0x1[¶](#section-4.1-9.3){.pilcrow}]{#section-4.1-9.3}

type[¶](#section-4.1-10){.pilcrow}

-   ::: {#section-4.1-11.1}
    This is the packet type.[¶](#section-4.1-11.1.1){.pilcrow}
    :::

-   [Options are:[¶](#section-4.1-11.2){.pilcrow}]{#section-4.1-11.2}

-   [TAC_PLUS_AUTHEN := 0x01
    (Authentication)[¶](#section-4.1-11.3){.pilcrow}]{#section-4.1-11.3}

-   [TAC_PLUS_AUTHOR := 0x02
    (Authorization)[¶](#section-4.1-11.4){.pilcrow}]{#section-4.1-11.4}

-   [TAC_PLUS_ACCT := 0x03
    (Accounting)[¶](#section-4.1-11.5){.pilcrow}]{#section-4.1-11.5}

seq_no[¶](#section-4.1-12){.pilcrow}

-   ::: {#section-4.1-13.1}
    This is the sequence number of the current packet. The first packet
    in a session [MUST]{.bcp14} have the sequence number 1, and each
    subsequent packet will increment the sequence number by one. TACACS+
    clients only send packets containing odd sequence numbers, and
    TACACS+ servers only send packets containing even sequence
    numbers.[¶](#section-4.1-13.1.1){.pilcrow}
    :::

-   ::: {#section-4.1-13.2}
    The sequence number must never wrap, i.e., if the sequence number
    2^8^-1 is ever reached, that session must terminate and be restarted
    with a sequence number of 1.[¶](#section-4.1-13.2.1){.pilcrow}
    :::

flags[¶](#section-4.1-14){.pilcrow}

-   ::: {#section-4.1-15.1}
    This field contains various bitmapped
    flags.[¶](#section-4.1-15.1.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.2}
    The flag bit:[¶](#section-4.1-15.2.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.3}
    TAC_PLUS_UNENCRYPTED_FLAG := 0x01[¶](#section-4.1-15.3.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.4}
    This flag indicates that the sender did not obfuscate the body of
    the packet. This option [MUST NOT]{.bcp14} be used in production.
    The application of this flag will be covered in \"Security
    Considerations\" ([Section
    10](#TACACSSecurity){.xref}).[¶](#section-4.1-15.4.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.5}
    This flag [SHOULD]{.bcp14} be clear in all deployments. Modern
    network traffic tools support encrypted traffic when configured with
    the shared secret (see \"Shared Secrets\" ([Section
    10.5.1](#SharedSecrets){.xref})), so obfuscated mode can and
    [SHOULD]{.bcp14} be used even during
    test.[¶](#section-4.1-15.5.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.6}
    The single-connection flag:[¶](#section-4.1-15.6.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.7}
    TAC_PLUS_SINGLE_CONNECT_FLAG :=
    0x04[¶](#section-4.1-15.7.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.8}
    This flag is used to allow a client and server to negotiate \"Single
    Connection Mode\" ([Section
    4.3](#SingleConnectMode){.xref}).[¶](#section-4.1-15.8.1){.pilcrow}
    :::

-   ::: {#section-4.1-15.9}
    All other bits [MUST]{.bcp14} be ignored when reading, and
    [SHOULD]{.bcp14} be set to zero when
    writing.[¶](#section-4.1-15.9.1){.pilcrow}
    :::

session_id[¶](#section-4.1-16){.pilcrow}

-   ::: {#section-4.1-17.1}
    The Id for this TACACS+ session. This field does not change for the
    duration of the TACACS+ session. This number [MUST]{.bcp14} be
    generated by a cryptographically strong random number generation
    method. Failure to do so will compromise security of the session.
    For more details, refer to
    \[[RFC4086](#RFC4086){.xref}\].[¶](#section-4.1-17.1.1){.pilcrow}
    :::

length[¶](#section-4.1-18){.pilcrow}

-   ::: {#section-4.1-19.1}
    The total length of the packet body (not including the header).
    Implementations [MUST]{.bcp14} allow control over maximum packet
    sizes accepted by TACACS+ Servers. The recommended maximum packet
    size is 2^16^.[¶](#section-4.1-19.1.1){.pilcrow}
    :::
:::
:::

::: {#TheTACACSPacketBody}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [The TACACS+ Packet Body](#name-the-tacacs-packet-body){.section-name .selfRef} {#name-the-tacacs-packet-body}

The TACACS+ body types are defined in the packet header. The next
sections of this document will address the contents of the different
TACACS+ bodies.[¶](#section-4.2-1){.pilcrow}
:::
:::

::: {#SingleConnectMode}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Single Connection Mode](#name-single-connection-mode){.section-name .selfRef} {#name-single-connection-mode}

Single Connection Mode is intended to improve performance where there is
a lot of traffic between a client and a server by allowing the client to
multiplex multiple sessions on a single TCP
connection.[¶](#section-4.3-1){.pilcrow}

The packet header contains the TAC_PLUS_SINGLE_CONNECT_FLAG used by the
client and server to negotiate the use of Single Connection
Mode.[¶](#section-4.3-2){.pilcrow}

The client sets this flag to indicate that it supports multiplexing
TACACS+ sessions over a single TCP connection. The client [MUST
NOT]{.bcp14} send a second packet on a connection until single-connect
status has been established.[¶](#section-4.3-3){.pilcrow}

To indicate it will support Single Connection Mode, the server sets this
flag in the first reply packet in response to the first request from a
client. The server may set this flag even if the client does not set it,
but the client may ignore the flag and close the connection after the
session completes.[¶](#section-4.3-4){.pilcrow}

The flag is only relevant for the first two packets on a connection, to
allow the client and server to establish Single Connection Mode. No
provision is made for changing Single Connection Mode after the first
two packets; the client and server [MUST]{.bcp14} ignore the flag after
the second packet on a connection.[¶](#section-4.3-5){.pilcrow}

If Single Connection Mode has not been established in the first two
packets of a TCP connection, then both the client and the server close
the connection at the end of the first
session.[¶](#section-4.3-6){.pilcrow}

The client negotiates Single Connection Mode to improve efficiency. The
server may refuse to allow Single Connection Mode for the client. For
example, it may not be appropriate to allocate a long-lasting TCP
connection to a specific client in some deployments. Even if the server
is configured to permit Single Connection Mode for a specific client,
the server may close the connection. For example, a server
[MUST]{.bcp14} be configured to time out a Single Connection Mode TCP
connection after a specific period of inactivity to preserve its
resources. The client [MUST]{.bcp14} accommodate such closures on a TCP
session even after Single Connection Mode has been
established.[¶](#section-4.3-7){.pilcrow}

The TCP connection underlying the Single Connection Mode will close
eventually either because of the timeout from the server or from an
intermediate link. If a session is in progress when the client detects
disconnect, then the client should handle it as described in \"Session
Completion\" ([Section 4.4](#SessionCompletion){.xref}). If a session is
not in progress, then the client will need to detect this and restart
the Single Connection Mode when it initiates the next
session.[¶](#section-4.3-8){.pilcrow}
:::
:::

::: {#SessionCompletion}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Session Completion](#name-session-completion){.section-name .selfRef} {#name-session-completion}

The REPLY packets defined for the packet types in the sections below
(Authentication, Authorization, and Accounting) contain a status field.
The complete set of options for this field depend upon the packet type,
but all three REPLY packet types define values representing PASS, ERROR,
and FAIL, which indicate the last packet of a regular session (one that
is not aborted).[¶](#section-4.4-1){.pilcrow}

The server responds with a PASS or a FAIL to indicate that the
processing of the request completed and that the client can apply the
result (PASS or FAIL) to control the execution of the action that
prompted the request to be sent to the
server.[¶](#section-4.4-2){.pilcrow}

The server responds with an ERROR to indicate that the processing of the
request did not complete. The client cannot apply the result, and it
[MUST]{.bcp14} behave as if the server could not be connected to. For
example, the client tries alternative methods, if they are available,
such as sending the request to a backup server or using local
configuration to determine whether the action that prompted the request
should be executed.[¶](#section-4.4-3){.pilcrow}

Refer to \"Aborting an Authentication Session\" ([Section
5.4.3](#AbortinganAuthenticationSession){.xref}) for details on handling
additional status options.[¶](#section-4.4-4){.pilcrow}

When the session is complete, the TCP connection should be handled as
follows, according to whether Single Connection Mode was
negotiated:[¶](#section-4.4-5){.pilcrow}

-   ::: {#section-4.4-6.1}
    If Single Connection Mode was not negotiated, then the connection
    should be closed.[¶](#section-4.4-6.1.1){.pilcrow}
    :::

-   ::: {#section-4.4-6.2}
    If Single Connection Mode was enabled, then the connection
    [SHOULD]{.bcp14} be left open (see \"Single Connection Mode\"
    ([Section 4.3](#SingleConnectMode){.xref})) but may still be closed
    after a timeout period to preserve deployment
    resources.[¶](#section-4.4-6.2.1){.pilcrow}
    :::

-   ::: {#section-4.4-6.3}
    If Single Connection Mode was enabled, but an ERROR occurred due to
    connection issues (such as an incorrect secret (see [Section
    4.5](#Obfuscation){.xref})), then any further new sessions [MUST
    NOT]{.bcp14} be accepted on the connection. If there are any
    sessions that have already been established, then they [MAY]{.bcp14}
    be completed. Once all active sessions are completed, then the
    connection [MUST]{.bcp14} be
    closed.[¶](#section-4.4-6.3.1){.pilcrow}
    :::

It is recommended that client implementations provide robust schemes for
dealing with servers that cannot be connected to. Options include
providing a list of servers for redundancy and an option for a local
fallback configuration if no servers can be reached. Details will be
implementation specific.[¶](#section-4.4-7){.pilcrow}

The client should manage connections and handle the case of a server
that establishes a connection but does not respond. The exact behavior
is implementation specific. It is recommended that the client close the
connection after a configurable timeout.[¶](#section-4.4-8){.pilcrow}
:::
:::

::: {#Obfuscation}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [Data Obfuscation](#name-data-obfuscation){.section-name .selfRef} {#name-data-obfuscation}

The body of packets may be obfuscated. The following sections describe
the obfuscation method that is supported in the protocol. In \"The
Draft\", this process was actually referred to as Encryption, but the
algorithm would not meet modern standards and so will not be termed as
encryption in this document.[¶](#section-4.5-1){.pilcrow}

The obfuscation mechanism relies on a secret key, a shared secret value
that is known to both the client and the server. The secret keys
[MUST]{.bcp14} remain secret.[¶](#section-4.5-2){.pilcrow}

Server implementations [MUST]{.bcp14} allow a unique secret key to be
associated with each client. It is a site-dependent decision as to
whether or not the use of separate keys is
appropriate.[¶](#section-4.5-3){.pilcrow}

The flag field [MUST]{.bcp14} be configured with
TAC_PLUS_UNENCRYPTED_FLAG set to 0 so that the packet body is obfuscated
by XORing it bytewise with a pseudo-random
pad:[¶](#section-4.5-4){.pilcrow}

-   ::: {#section-4.5-5.1}
    ENCRYPTED {data} = data
    ^pseudo_pad^[¶](#section-4.5-5.1.1){.pilcrow}
    :::

The packet body can then be de-obfuscated by XORing it bytewise with a
pseudo-random pad.[¶](#section-4.5-6){.pilcrow}

-   ::: {#section-4.5-7.1}
    data = ENCRYPTED {data}
    ^pseudo_pad^[¶](#section-4.5-7.1.1){.pilcrow}
    :::

The pad is generated by concatenating a series of MD5 hashes (each 16
bytes long) and truncating it to the length of the input data. Whenever
used in this document, MD5 refers to the \"RSA Data Security, Inc.  MD5
Message-Digest Algorithm\" as specified in
\[[RFC1321](#RFC1321){.xref}\].[¶](#section-4.5-8){.pilcrow}

-   ::: {#section-4.5-9.1}
    pseudo_pad = {MD5_1 \[,MD5_2 \[ \... ,MD5_n\]\]} truncated to
    len(data)[¶](#section-4.5-9.1.1){.pilcrow}
    :::

The first MD5 hash is generated by concatenating the session_id, the
secret key, the version number, and the sequence number, and then
running MD5 over that stream. All of those input values are available in
the packet header, except for the secret key, which is a shared secret
between the TACACS+ client and server.[¶](#section-4.5-10){.pilcrow}

The version number and session_id are extracted from the
header.[¶](#section-4.5-11){.pilcrow}

Subsequent hashes are generated by using the same input stream but
concatenating the previous hash value at the end of the input
stream.[¶](#section-4.5-12){.pilcrow}

-   ::: {#section-4.5-13.1}
    MD5_1 = MD5{session_id, key, version, seq_no} MD5_2 =
    MD5{session_id, key, version, seq_no, MD5_1} \.... MD5_n =
    MD5{session_id, key, version, seq_no,
    MD5_n-1}[¶](#section-4.5-13.1.1){.pilcrow}
    :::

When a server detects that the secrets it has configured for the device
do not match, it [MUST]{.bcp14} return ERROR. For details of TCP
connection handling on ERROR, refer to \"Session Completion\" ([Section
4.4](#SessionCompletion){.xref}).[¶](#section-4.5-14){.pilcrow}

-   ::: {#section-4.5-15.1}
    TAC_PLUS_UNENCRYPTED_FLAG == 0x1[¶](#section-4.5-15.1.1){.pilcrow}
    :::

This option is deprecated and [MUST NOT]{.bcp14} be used in production.
In this case, the entire packet body is in cleartext. A request
[MUST]{.bcp14} be dropped if TAC_PLUS_UNENCRYPTED_FLAG is set to
true.[¶](#section-4.5-16){.pilcrow}

After a packet body is de-obfuscated, the lengths of the component
values in the packet are summed. If the sum is not identical to the
cleartext datalength value from the header, the packet [MUST]{.bcp14} be
discarded and an ERROR signaled. For details of TCP connection handling
on ERROR, refer to \"Session Completion\" ([Section
4.4](#SessionCompletion){.xref}).[¶](#section-4.5-17){.pilcrow}

Commonly, such failures are seen when the keys are mismatched between
the client and the TACACS+ server.[¶](#section-4.5-18){.pilcrow}
:::
:::
:::
:::

::: {#Authentication}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Authentication](#name-authentication){.section-name .selfRef} {#name-authentication}

Authentication is the action of determining who a user (or entity) is.
Authentication can take many forms. Traditional authentication employs a
name and a fixed password. However, fixed passwords are vulnerable
security, so many modern authentication mechanisms utilize \"one-time\"
passwords or a challenge-response query. TACACS+ is designed to support
all of these and be flexible enough to handle any future mechanisms.
Authentication generally takes place when the user first logs in to a
machine or requests a service of it.[¶](#section-5-1){.pilcrow}

Authentication is not mandatory; it is a site-configured option. Some
sites do not require it. Others require it only for certain services
(see \"Authorization\" ([Section 6](#Authorization){.xref})).
Authentication may also take place when a user attempts to gain extra
privileges and must identify himself or herself as someone who possesses
the required information (passwords, etc.) for those
privileges.[¶](#section-5-2){.pilcrow}

::: {#TheAuthenticationSTARTPacketBody}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [The Authentication START Packet Body](#name-the-authentication-start-pa){.section-name .selfRef} {#name-the-authentication-start-pa}

::: {#section-5.1-1 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |    action      |    priv_lvl    |  authen_type   | authen_service |
    +----------------+----------------+----------------+----------------+
    |    user_len    |    port_len    |  rem_addr_len  |    data_len    |
    +----------------+----------------+----------------+----------------+
    |    user ...
    +----------------+----------------+----------------+----------------+
    |    port ...
    +----------------+----------------+----------------+----------------+
    |    rem_addr ...
    +----------------+----------------+----------------+----------------+
    |    data...
    +----------------+----------------+----------------+----------------+

[¶](#section-5.1-1){.pilcrow}
:::

Packet fields are as follows:[¶](#section-5.1-2){.pilcrow}

action[¶](#section-5.1-3){.pilcrow}

-   ::: {#section-5.1-4.1}
    This indicates the authentication
    action.[¶](#section-5.1-4.1.1){.pilcrow}

    Valid values are:[¶](#section-5.1-4.1.2){.pilcrow}
    :::

-   [TAC_PLUS_AUTHEN_LOGIN :=
    0x01[¶](#section-5.1-4.2){.pilcrow}]{#section-5.1-4.2}

-   [TAC_PLUS_AUTHEN_CHPASS :=
    0x02[¶](#section-5.1-4.3){.pilcrow}]{#section-5.1-4.3}

-   [TAC_PLUS_AUTHEN_SENDAUTH :=
    0x04[¶](#section-5.1-4.4){.pilcrow}]{#section-5.1-4.4}

priv_lvl[¶](#section-5.1-5){.pilcrow}

-   ::: {#section-5.1-6.1}
    This indicates the privilege level that the user is authenticating
    as. Please refer to \"Privilege Levels\" ([Section
    9](#PrivilegeLevel){.xref}).[¶](#section-5.1-6.1.1){.pilcrow}
    :::

authen_type[¶](#section-5.1-7){.pilcrow}

-   ::: {#section-5.1-8.1}
    The type of authentication. Please see \"Common Authentication
    Flows\" ([Section
    5.4.2](#CommonAuthenticationFlows){.xref}).[¶](#section-5.1-8.1.1){.pilcrow}
    :::

-   ::: {#section-5.1-8.2}
    Valid values are:[¶](#section-5.1-8.2.1){.pilcrow}
    :::

-   [TAC_PLUS_AUTHEN_TYPE_ASCII :=
    0x01[¶](#section-5.1-8.3){.pilcrow}]{#section-5.1-8.3}

-   [TAC_PLUS_AUTHEN_TYPE_PAP :=
    0x02[¶](#section-5.1-8.4){.pilcrow}]{#section-5.1-8.4}

-   [TAC_PLUS_AUTHEN_TYPE_CHAP :=
    0x03[¶](#section-5.1-8.5){.pilcrow}]{#section-5.1-8.5}

-   [TAC_PLUS_AUTHEN_TYPE_MSCHAP :=
    0x05[¶](#section-5.1-8.6){.pilcrow}]{#section-5.1-8.6}

-   [TAC_PLUS_AUTHEN_TYPE_MSCHAPV2 :=
    0x06[¶](#section-5.1-8.7){.pilcrow}]{#section-5.1-8.7}

authen_service[¶](#section-5.1-9){.pilcrow}

-   ::: {#section-5.1-10.1}
    This is the service that is requesting the
    authentication.[¶](#section-5.1-10.1.1){.pilcrow}
    :::

-   ::: {#section-5.1-10.2}
    Valid values are:[¶](#section-5.1-10.2.1){.pilcrow}
    :::

-   [TAC_PLUS_AUTHEN_SVC_NONE :=
    0x00[¶](#section-5.1-10.3){.pilcrow}]{#section-5.1-10.3}

-   [TAC_PLUS_AUTHEN_SVC_LOGIN :=
    0x01[¶](#section-5.1-10.4){.pilcrow}]{#section-5.1-10.4}

-   [TAC_PLUS_AUTHEN_SVC_ENABLE :=
    0x02[¶](#section-5.1-10.5){.pilcrow}]{#section-5.1-10.5}

-   [TAC_PLUS_AUTHEN_SVC_PPP :=
    0x03[¶](#section-5.1-10.6){.pilcrow}]{#section-5.1-10.6}

-   [TAC_PLUS_AUTHEN_SVC_PT :=
    0x05[¶](#section-5.1-10.7){.pilcrow}]{#section-5.1-10.7}

-   [TAC_PLUS_AUTHEN_SVC_RCMD :=
    0x06[¶](#section-5.1-10.8){.pilcrow}]{#section-5.1-10.8}

-   [TAC_PLUS_AUTHEN_SVC_X25 :=
    0x07[¶](#section-5.1-10.9){.pilcrow}]{#section-5.1-10.9}

-   [TAC_PLUS_AUTHEN_SVC_NASI :=
    0x08[¶](#section-5.1-10.10){.pilcrow}]{#section-5.1-10.10}

-   [TAC_PLUS_AUTHEN_SVC_FWPROXY :=
    0x09[¶](#section-5.1-10.11){.pilcrow}]{#section-5.1-10.11}

-   ::: {#section-5.1-10.12}
    The TAC_PLUS_AUTHEN_SVC_NONE option is intended for the
    authorization application of this field that indicates that no
    authentication was performed by the
    device.[¶](#section-5.1-10.12.1){.pilcrow}

    The TAC_PLUS_AUTHEN_SVC_LOGIN option indicates regular login (as
    opposed to ENABLE) to a client
    device.[¶](#section-5.1-10.12.2){.pilcrow}
    :::

-   ::: {#section-5.1-10.13}
    The TAC_PLUS_AUTHEN_SVC_ENABLE option identifies the ENABLE
    authen_service, which refers to a service requesting authentication
    in order to grant the user different privileges. This is comparable
    to the Unix \"su(1)\" command, which substitutes the current user\'s
    identity with another. An authen_service value of NONE is only to be
    used when none of the other authen_service values are appropriate.
    ENABLE may be requested independently; no requirements for previous
    authentications or authorizations are imposed by the
    protocol.[¶](#section-5.1-10.13.1){.pilcrow}
    :::

-   ::: {#section-5.1-10.14}
    Other options are included for legacy/backwards
    compatibility.[¶](#section-5.1-10.14.1){.pilcrow}
    :::

user, user_len[¶](#section-5.1-11){.pilcrow}

-   ::: {#section-5.1-12.1}
    The username is optional in this packet, depending upon the class of
    authentication. If it is absent, the client [MUST]{.bcp14} set
    user_len to 0. If included, the user_len indicates the length of the
    user field, in bytes.[¶](#section-5.1-12.1.1){.pilcrow}
    :::

port, port_len[¶](#section-5.1-13){.pilcrow}

-   ::: {#section-5.1-14.1}
    The name of the client port on which the authentication is taking
    place. The value of this field is free-format text and is client
    specific. Examples of this argument include \"tty10\" to denote the
    tenth tty line, and \"async10\" to denote the tenth async interface.
    The client documentation [SHOULD]{.bcp14} define the values and
    their meanings for this field. For details of text encoding, see
    \"Treatment of Text Strings\" ([Section 3.7](#TextEncoding){.xref}).
    The port_len indicates the length of the port field, in
    bytes.[¶](#section-5.1-14.1.1){.pilcrow}
    :::

rem_addr, rem_addr_len[¶](#section-5.1-15){.pilcrow}

-   ::: {#section-5.1-16.1}
    A string indicating the remote location from which the user has
    connected to the client. For details of text encoding, see
    \"Treatment of Text Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-5.1-16.1.1){.pilcrow}
    :::

-   ::: {#section-5.1-16.2}
    When TACACS+ was used for dial-up services, this value contained the
    caller ID.[¶](#section-5.1-16.2.1){.pilcrow}
    :::

-   ::: {#section-5.1-16.3}
    When TACACS+ is used for Device Administration, the user is normally
    connected via a network, and in this case, the value is intended to
    hold a network address, IPv4 or IPv6. For IPv6 address text
    representation defined, please see
    \[[RFC5952](#RFC5952){.xref}\].[¶](#section-5.1-16.3.1){.pilcrow}
    :::

-   ::: {#section-5.1-16.4}
    This field is optional (since the information may not be available).
    The rem_addr_len indicates the length of the user field, in
    bytes.[¶](#section-5.1-16.4.1){.pilcrow}
    :::

data, data_len[¶](#section-5.1-17){.pilcrow}

-   ::: {#section-5.1-18.1}
    The data field is used to send data appropriate for the action and
    authen_type. It is described in more detail in \"Common
    Authentication Flows\" ([Section
    5.4.2](#CommonAuthenticationFlows){.xref}). The data_len field
    indicates the length of the data field, in
    bytes.[¶](#section-5.1-18.1.1){.pilcrow}
    :::
:::
:::

::: {#TheAuthenticationREPLYPacketBody}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [The Authentication REPLY Packet Body](#name-the-authentication-reply-pa){.section-name .selfRef} {#name-the-authentication-reply-pa}

The TACACS+ server sends only one type of authentication packet (a REPLY
packet) to the client.[¶](#section-5.2-1){.pilcrow}

::: {#section-5.2-2 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |     status     |      flags     |        server_msg_len           |
    +----------------+----------------+----------------+----------------+
    |           data_len              |        server_msg ...
    +----------------+----------------+----------------+----------------+
    |           data ...
    +----------------+----------------+

[¶](#section-5.2-2){.pilcrow}
:::

status[¶](#section-5.2-3){.pilcrow}

-   ::: {#section-5.2-4.1}
    The current status of the
    authentication.[¶](#section-5.2-4.1.1){.pilcrow}
    :::

-   [Valid values are:[¶](#section-5.2-4.2){.pilcrow}]{#section-5.2-4.2}

```{=html}
<!-- -->
```
-   [TAC_PLUS_AUTHEN_STATUS_PASS :=
    0x01[¶](#section-5.2-5.1){.pilcrow}]{#section-5.2-5.1}
-   [TAC_PLUS_AUTHEN_STATUS_FAIL :=
    0x02[¶](#section-5.2-5.2){.pilcrow}]{#section-5.2-5.2}
-   [TAC_PLUS_AUTHEN_STATUS_GETDATA :=
    0x03[¶](#section-5.2-5.3){.pilcrow}]{#section-5.2-5.3}
-   [TAC_PLUS_AUTHEN_STATUS_GETUSER :=
    0x04[¶](#section-5.2-5.4){.pilcrow}]{#section-5.2-5.4}
-   [TAC_PLUS_AUTHEN_STATUS_GETPASS :=
    0x05[¶](#section-5.2-5.5){.pilcrow}]{#section-5.2-5.5}
-   [TAC_PLUS_AUTHEN_STATUS_RESTART :=
    0x06[¶](#section-5.2-5.6){.pilcrow}]{#section-5.2-5.6}
-   [TAC_PLUS_AUTHEN_STATUS_ERROR :=
    0x07[¶](#section-5.2-5.7){.pilcrow}]{#section-5.2-5.7}
-   [TAC_PLUS_AUTHEN_STATUS_FOLLOW :=
    0x21[¶](#section-5.2-5.8){.pilcrow}]{#section-5.2-5.8}

flags[¶](#section-5.2-6){.pilcrow}

-   ::: {#section-5.2-7.1}
    Bitmapped flags that modify the action to be
    taken.[¶](#section-5.2-7.1.1){.pilcrow}
    :::

-   [The following values are
    defined:[¶](#section-5.2-7.2){.pilcrow}]{#section-5.2-7.2}

```{=html}
<!-- -->
```
-   [TAC_PLUS_REPLY_FLAG_NOECHO :=
    0x01[¶](#section-5.2-8.1){.pilcrow}]{#section-5.2-8.1}

server_msg, server_msg_len[¶](#section-5.2-9){.pilcrow}

-   ::: {#section-5.2-10.1}
    A message to be displayed to the user. This field is optional. The
    server_msg_len indicates the length of the server_msg field, in
    bytes. For details of text encoding, see \"Treatment of Text
    Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-5.2-10.1.1){.pilcrow}
    :::

data, data_len[¶](#section-5.2-11){.pilcrow}

-   ::: {#section-5.2-12.1}
    A field that holds data that is a part of the authentication
    exchange and is intended for client processing, not the user. It is
    not a printable text encoding. Examples of its use are shown in
    \"Common Authentication Flows\" ([Section
    5.4.2](#CommonAuthenticationFlows){.xref}). The data_len indicates
    the length of the data field, in
    bytes.[¶](#section-5.2-12.1.1){.pilcrow}
    :::
:::
:::

::: {#TheAuthenticationCONTINUEPacketBody}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [The Authentication CONTINUE Packet Body](#name-the-authentication-continue){.section-name .selfRef} {#name-the-authentication-continue}

This packet is sent from the client to the server following the receipt
of a REPLY packet.[¶](#section-5.3-1){.pilcrow}

::: {#section-5.3-2 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |          user_msg len           |            data_len             |
    +----------------+----------------+----------------+----------------+
    |     flags      |  user_msg ...
    +----------------+----------------+----------------+----------------+
    |    data ...
    +----------------+

[¶](#section-5.3-2){.pilcrow}
:::

user_msg, user_msg_len[¶](#section-5.3-3){.pilcrow}

-   ::: {#section-5.3-4.1}
    A field that is the string that the user entered, or the client
    provided on behalf of the user, in response to the server_msg from a
    REPLY packet. The user_len indicates the length of the user field,
    in bytes.[¶](#section-5.3-4.1.1){.pilcrow}
    :::

data, data_len[¶](#section-5.3-5){.pilcrow}

-   ::: {#section-5.3-6.1}
    This field carries information that is specific to the action and
    the authen_type for this session. Valid uses of this field are
    described below. It is not a printable text encoding. The data_len
    indicates the length of the data field, in
    bytes.[¶](#section-5.3-6.1.1){.pilcrow}
    :::

flags[¶](#section-5.3-7){.pilcrow}

-   ::: {#section-5.3-8.1}
    This holds the bitmapped flags that modify the action to be
    taken.[¶](#section-5.3-8.1.1){.pilcrow}
    :::

-   ::: {#section-5.3-8.2}
    The following values are defined:[¶](#section-5.3-8.2.1){.pilcrow}
    :::

-   [TAC_PLUS_CONTINUE_FLAG_ABORT :=
    0x01[¶](#section-5.3-8.3){.pilcrow}]{#section-5.3-8.3}
:::
:::

::: {#DescriptionofAuthenticationProcess}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Description of Authentication Process](#name-description-of-authenticati){.section-name .selfRef} {#name-description-of-authenticati}

The action, authen_type, and authen_service fields (described above)
combine to indicate what kind of authentication is to be performed.
Every authentication START, REPLY, and CONTINUE packet includes a data
field. The use of this field is dependent upon the kind of
authentication.[¶](#section-5.4-1){.pilcrow}

This document defines a core set of authentication flows to be supported
by TACACS+. Each authentication flow consists of a START packet. The
server responds either with a request for more information (GETDATA,
GETUSER, or GETPASS) or a termination PASS, FAIL, ERROR, or RESTART. The
actions and meanings when the server sends a RESTART or ERROR are common
and are described further below.[¶](#section-5.4-2){.pilcrow}

When the REPLY status equals TAC_PLUS_AUTHEN_STATUS_GETDATA,
TAC_PLUS_AUTHEN_STATUS_GETUSER, or TAC_PLUS_AUTHEN_STATUS_GETPASS,
authentication continues and the server [SHOULD]{.bcp14} provide
server_msg content for the client to prompt the user for more
information. The client [MUST]{.bcp14} then return a CONTINUE packet
containing the requested information in the user_msg
field.[¶](#section-5.4-3){.pilcrow}

The client should interpret TAC_PLUS_AUTHEN_STATUS_GETUSER as a request
for a username and TAC_PLUS_AUTHEN_STATUS_GETPASS as a request for a
password. The TAC_PLUS_AUTHEN_STATUS_GETDATA is the generic request for
more information to flexibly support future
requirements.[¶](#section-5.4-4){.pilcrow}

If the information being requested by the server from the client is
sensitive, then the server should set the TAC_PLUS_REPLY_FLAG_NOECHO
flag. When the client queries the user for the information, the response
[MUST NOT]{.bcp14} be reflected in the user interface as it is
entered.[¶](#section-5.4-5){.pilcrow}

The data field is only used in the REPLY where explicitly defined
below.[¶](#section-5.4-6){.pilcrow}

::: {#VersionBehaviour}
::: {#section-5.4.1 .section}
#### [5.4.1.](#section-5.4.1){.section-number .selfRef} [Version Behavior](#name-version-behavior){.section-name .selfRef} {#name-version-behavior}

The TACACS+ protocol is versioned to allow revisions while maintaining
backwards compatibility. The version number is in every packet header.
The changes between minor_version 0 and 1 apply only to the
authentication process, and all deal with the way that Challenge
Handshake Authentication Protocol (CHAP) and Password Authentication
Protocol (PAP) authentications are handled. minor_version 1 may only be
used for authentication kinds that explicitly call for it in the table
below:[¶](#section-5.4.1-1){.pilcrow}

[]{#name-tacacs-protocol-versioning}

::: {#table_1}
  ------------- ------- -------- ----------
                LOGIN   CHPASS   SENDAUTH
  ASCII         v0      v0       \-
  PAP           v1      \-       v1
  CHAP          v1      \-       v1
  MS-CHAPv1/2   v1      \-       v1
  ------------- ------- -------- ----------

  : [Table 1](#table-1){.selfRef}: [TACACS+ Protocol
  Versioning](#name-tacacs-protocol-versioning){.selfRef}
:::

The \'-\' symbol represents that the option is not
valid.[¶](#section-5.4.1-3){.pilcrow}

All authorization and accounting and ASCII authentication use
minor_version 0.[¶](#section-5.4.1-4){.pilcrow}

PAP, CHAP, and MS-CHAP login use minor_version 1. The normal exchange is
a single START packet from the client and a single REPLY from the
server.[¶](#section-5.4.1-5){.pilcrow}

The removal of SENDPASS was prompted by security concerns and is no
longer considered part of the TACACS+
protocol.[¶](#section-5.4.1-6){.pilcrow}
:::
:::

::: {#CommonAuthenticationFlows}
::: {#section-5.4.2 .section}
#### [5.4.2.](#section-5.4.2){.section-number .selfRef} [Common Authentication Flows](#name-common-authentication-flows){.section-name .selfRef} {#name-common-authentication-flows}

This section describes common authentication flows. If the server does
not implement an option, it [MUST]{.bcp14} respond with
TAC_PLUS_AUTHEN_STATUS_FAIL.[¶](#section-5.4.2-1){.pilcrow}

::: {#ASCIILogin}
::: {#section-5.4.2.1 .section}
##### [5.4.2.1.](#section-5.4.2.1){.section-number .selfRef} [ASCII Login](#name-ascii-login){.section-name .selfRef} {#name-ascii-login}

::: {#section-5.4.2.1-1 .artwork .art-text .alignLeft}
        action = TAC_PLUS_AUTHEN_LOGIN
        authen_type = TAC_PLUS_AUTHEN_TYPE_ASCII
        minor_version = 0x0

[¶](#section-5.4.2.1-1){.pilcrow}
:::

This is a standard ASCII authentication. The START packet [MAY]{.bcp14}
contain the username. If the user does not include the username, then
the server [MUST]{.bcp14} obtain it from the client with a CONTINUE
TAC_PLUS_AUTHEN_STATUS_GETUSER. If the user does not provide a username,
then the server can send another TAC_PLUS_AUTHEN_STATUS_GETUSER request,
but the server [MUST]{.bcp14} limit the number of retries that are
permitted; the recommended limit is three attempts. When the server has
the username, it will obtain the password using a continue with
TAC_PLUS_AUTHEN_STATUS_GETPASS. ASCII login uses the user_msg field for
both the username and password. The data fields in both the START and
CONTINUE packets are not used for ASCII logins; any content
[MUST]{.bcp14} be ignored. The session is composed of a single START
followed by zero or more pairs of REPLYs and CONTINUEs, followed by a
final REPLY indicating PASS, FAIL, or
ERROR.[¶](#section-5.4.2.1-2){.pilcrow}
:::
:::

::: {#PAPLogin}
::: {#section-5.4.2.2 .section}
##### [5.4.2.2.](#section-5.4.2.2){.section-number .selfRef} [PAP Login](#name-pap-login){.section-name .selfRef} {#name-pap-login}

::: {#section-5.4.2.2-1 .artwork .art-text .alignLeft}
        action = TAC_PLUS_AUTHEN_LOGIN
        authen_type = TAC_PLUS_AUTHEN_TYPE_PAP
        minor_version = 0x1

[¶](#section-5.4.2.2-1){.pilcrow}
:::

The entire exchange [MUST]{.bcp14} consist of a single START packet and
a single REPLY. The START packet [MUST]{.bcp14} contain a username and
the data field [MUST]{.bcp14} contain the PAP ASCII password. A PAP
authentication only consists of a username and password
\[[RFC1334](#RFC1334){.xref}\] (Obsolete). The REPLY from the server
[MUST]{.bcp14} be either a PASS, FAIL, or
ERROR.[¶](#section-5.4.2.2-2){.pilcrow}
:::
:::

::: {#CHAPlogin}
::: {#section-5.4.2.3 .section}
##### [5.4.2.3.](#section-5.4.2.3){.section-number .selfRef} [CHAP Login](#name-chap-login){.section-name .selfRef} {#name-chap-login}

::: {#section-5.4.2.3-1 .artwork .art-text .alignLeft}
        action = TAC_PLUS_AUTHEN_LOGIN
        authen_type = TAC_PLUS_AUTHEN_TYPE_CHAP
        minor_version = 0x1

[¶](#section-5.4.2.3-1){.pilcrow}
:::

The entire exchange [MUST]{.bcp14} consist of a single START packet and
a single REPLY. The START packet [MUST]{.bcp14} contain the username in
the user field, and the data field is a concatenation of the PPP id, the
challenge, and the response.[¶](#section-5.4.2.3-2){.pilcrow}

The length of the challenge value can be determined from the length of
the data field minus the length of the id (always 1 octet) and the
length of the response field (always 16
octets).[¶](#section-5.4.2.3-3){.pilcrow}

To perform the authentication, the server calculates the PPP hash as
defined in PPP Authentication \[[RFC1334](#RFC1334){.xref}\] and then
compares that value with the response. The MD5 algorithm option is
always used. The REPLY from the server [MUST]{.bcp14} be a PASS, FAIL,
or ERROR.[¶](#section-5.4.2.3-4){.pilcrow}

The selection of the challenge and its length are not an aspect of the
TACACS+ protocol. However, it is strongly recommended that the
client/endstation interaction be configured with a secure challenge. The
TACACS+ server can help by rejecting authentications where the challenge
is below a minimum length (minimum recommended is 8
bytes).[¶](#section-5.4.2.3-5){.pilcrow}
:::
:::

::: {#MS-CHAPv1login}
::: {#section-5.4.2.4 .section}
##### [5.4.2.4.](#section-5.4.2.4){.section-number .selfRef} [MS-CHAP v1 Login](#name-ms-chap-v1-login){.section-name .selfRef} {#name-ms-chap-v1-login}

::: {#section-5.4.2.4-1 .artwork .art-text .alignLeft}
        action = TAC_PLUS_AUTHEN_LOGIN
        authen_type = TAC_PLUS_AUTHEN_TYPE_MSCHAP
        minor_version = 0x1

[¶](#section-5.4.2.4-1){.pilcrow}
:::

The entire exchange [MUST]{.bcp14} consist of a single START packet and
a single REPLY. The START packet [MUST]{.bcp14} contain the username in
the user field, and the data field will be a concatenation of the PPP
id, the MS-CHAP challenge, and the MS-CHAP
response.[¶](#section-5.4.2.4-2){.pilcrow}

The length of the challenge value can be determined from the length of
the data field minus the length of the id (always 1 octet) and the
length of the response field (always 49
octets).[¶](#section-5.4.2.4-3){.pilcrow}

To perform the authentication, the server will use a combination of MD4
and DES on the user\'s secret and the challenge, as defined in
\[[RFC2433](#RFC2433){.xref}\], and then compare the resulting value
with the response. The REPLY from the server [MUST]{.bcp14} be a PASS or
FAIL.[¶](#section-5.4.2.4-4){.pilcrow}

For best practices, please refer to \[[RFC2433](#RFC2433){.xref}\]. The
TACACS+ server [MUST]{.bcp14} reject authentications where the challenge
deviates from 8 bytes as defined in the
RFC.[¶](#section-5.4.2.4-5){.pilcrow}
:::
:::

::: {#MS-CHAPv2login}
::: {#section-5.4.2.5 .section}
##### [5.4.2.5.](#section-5.4.2.5){.section-number .selfRef} [MS-CHAP v2 Login](#name-ms-chap-v2-login){.section-name .selfRef} {#name-ms-chap-v2-login}

::: {#section-5.4.2.5-1 .artwork .art-text .alignLeft}
        action = TAC_PLUS_AUTHEN_LOGIN
        authen_type = TAC_PLUS_AUTHEN_TYPE_MSCHAPV2
        minor_version = 0x1

[¶](#section-5.4.2.5-1){.pilcrow}
:::

The entire exchange [MUST]{.bcp14} consist of a single START packet and
a single REPLY. The START packet [MUST]{.bcp14} contain the username in
the user field, and the data field will be a concatenation of the PPP
id, the MS-CHAP challenge, and the MS-CHAP
response.[¶](#section-5.4.2.5-2){.pilcrow}

The length of the challenge value can be determined from the length of
the data field minus the length of the id (always 1 octet) and the
length of the response field (always 49
octets).[¶](#section-5.4.2.5-3){.pilcrow}

To perform the authentication, the server will use the algorithm
specified \[[RFC2759](#RFC2759){.xref}\] on the user\'s secret and
challenge, and then compare the resulting value with the response. The
REPLY from the server [MUST]{.bcp14} be a PASS or
FAIL.[¶](#section-5.4.2.5-4){.pilcrow}

For best practices for MS-CHAP v2, please refer to
\[[RFC2759](#RFC2759){.xref}\]. The TACACS+ server [MUST]{.bcp14} reject
authentications where the challenge deviates from 16 bytes as defined in
the RFC.[¶](#section-5.4.2.5-5){.pilcrow}
:::
:::

::: {#EnableRequests}
::: {#section-5.4.2.6 .section}
##### [5.4.2.6.](#section-5.4.2.6){.section-number .selfRef} [Enable Requests](#name-enable-requests){.section-name .selfRef} {#name-enable-requests}

::: {#section-5.4.2.6-1 .artwork .art-text .alignLeft}
        action = TAC_PLUS_AUTHEN_LOGIN
        priv_lvl = implementation dependent
        authen_type = not used
        service = TAC_PLUS_AUTHEN_SVC_ENABLE

[¶](#section-5.4.2.6-1){.pilcrow}
:::

This is an \"ENABLE\" request, used to change the current running
privilege level of a user. The exchange [MAY]{.bcp14} consist of
multiple messages while the server collects the information it requires
in order to allow changing the principal\'s privilege level. This
exchange is very similar to an ASCII login ([Section
5.4.2.1](#ASCIILogin){.xref}).[¶](#section-5.4.2.6-2){.pilcrow}

In order to readily distinguish \"ENABLE\" requests from other types of
request, the value of the authen_service field [MUST]{.bcp14} be set to
TAC_PLUS_AUTHEN_SVC_ENABLE when requesting an ENABLE. It [MUST
NOT]{.bcp14} be set to this value when requesting any other
operation.[¶](#section-5.4.2.6-3){.pilcrow}
:::
:::

::: {#ASCIIchangepasswordrequest}
::: {#section-5.4.2.7 .section}
##### [5.4.2.7.](#section-5.4.2.7){.section-number .selfRef} [ASCII Change Password Request](#name-ascii-change-password-reque){.section-name .selfRef} {#name-ascii-change-password-reque}

::: {#section-5.4.2.7-1 .artwork .art-text .alignLeft}
    action = TAC_PLUS_AUTHEN_CHPASS
    authen_type = TAC_PLUS_AUTHEN_TYPE_ASCII

[¶](#section-5.4.2.7-1){.pilcrow}
:::

This exchange consists of multiple messages while the server collects
the information it requires in order to change the user\'s password. It
is very similar to an ASCII login. The status value
TAC_PLUS_AUTHEN_STATUS_GETPASS [MUST]{.bcp14} only be used when
requesting the \"new\" password. It [MAY]{.bcp14} be sent multiple
times. When requesting the \"old\" password, the status value
[MUST]{.bcp14} be set to
TAC_PLUS_AUTHEN_STATUS_GETDATA.[¶](#section-5.4.2.7-2){.pilcrow}
:::
:::
:::
:::

::: {#AbortinganAuthenticationSession}
::: {#section-5.4.3 .section}
#### [5.4.3.](#section-5.4.3){.section-number .selfRef} [Aborting an Authentication Session](#name-aborting-an-authentication-){.section-name .selfRef} {#name-aborting-an-authentication-}

The client may prematurely terminate a session by setting the
TAC_PLUS_CONTINUE_FLAG_ABORT flag in the CONTINUE message. If this flag
is set, the data portion of the message may contain a text explaining
the reason for the abort. This text will be handled by the server
according to the requirements of the deployment. For details of text
encoding, see \"Treatment of Text Strings\" ([Section
3.7](#TextEncoding){.xref}). For more details about session termination,
refer to \"Session Completion\" ([Section
4.4](#SessionCompletion){.xref}).[¶](#section-5.4.3-1){.pilcrow}

In cases of PASS, FAIL, or ERROR, the server can insert a message into
server_msg to be displayed to the user.[¶](#section-5.4.3-2){.pilcrow}

\"The Draft\" \[[THE-DRAFT](#THE-DRAFT){.xref}\] defined a mechanism to
direct authentication requests to an alternative server. This mechanism
is regarded as insecure, is deprecated, and is not covered here. The
client should treat TAC_PLUS_AUTHEN_STATUS_FOLLOW as
TAC_PLUS_AUTHEN_STATUS_FAIL.[¶](#section-5.4.3-3){.pilcrow}

If the status equals TAC_PLUS_AUTHEN_STATUS_ERROR, then the host is
indicating that it is experiencing an unrecoverable error and the
authentication will proceed as if that host could not be contacted. The
data field may contain a message to be printed on an administrative
console or log.[¶](#section-5.4.3-4){.pilcrow}

If the status equals TAC_PLUS_AUTHEN_STATUS_RESTART, then the
authentication sequence is restarted with a new START packet from the
client, with a new session Id and seq_no set to 1. This REPLY packet
indicates that the current authen_type value (as specified in the START
packet) is not acceptable for this session. The client may try an
alternative authen_type.[¶](#section-5.4.3-5){.pilcrow}

If a client does not implement the TAC_PLUS_AUTHEN_STATUS_RESTART
option, then it [MUST]{.bcp14} process the response as if the status was
TAC_PLUS_AUTHEN_STATUS_FAIL.[¶](#section-5.4.3-6){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#Authorization}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Authorization](#name-authorization){.section-name .selfRef} {#name-authorization}

In the TACACS+ protocol, authorization is the action of determining what
a user is allowed to do. Generally, authentication precedes
authorization, though it is not mandatory that a client use the same
service for authentication that it will use for authorization. An
authorization request may indicate that the user is not authenticated
(we don\'t know who they are). In this case, it is up to the server to
determine, according to its configuration, if an unauthenticated user is
allowed the services in question.[¶](#section-6-1){.pilcrow}

Authorization does not merely provide yes or no answers, but it may also
customize the service for the particular user. A common use of
authorization is to provision a shell session when a user first logs
into a device to administer it. The TACACS+ server might respond to the
request by allowing the service, but placing a time restriction on the
login shell. For a list of common arguments used in authorization, see
\"Authorization Arguments\" ([Section
8.2](#AuthorizationAttributes){.xref}).[¶](#section-6-2){.pilcrow}

In the TACACS+ protocol, an authorization is always a single pair of
messages: a REQUEST from the client followed by a REPLY from the
server.[¶](#section-6-3){.pilcrow}

The authorization REQUEST message contains a fixed set of fields that
indicate how the user was authenticated and a variable set of arguments
that describe the services and options for which authorization is
requested.[¶](#section-6-4){.pilcrow}

The REPLY contains a variable set of response arguments (argument-value
pairs) that can restrict or modify the client\'s
actions.[¶](#section-6-5){.pilcrow}

::: {#TheAuthorizationREQUESTPacketBody}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [The Authorization REQUEST Packet Body](#name-the-authorization-request-p){.section-name .selfRef} {#name-the-authorization-request-p}

::: {#section-6.1-1 .artwork .art-text .alignLeft}
      1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |  authen_method |    priv_lvl    |  authen_type   | authen_service |
    +----------------+----------------+----------------+----------------+
    |    user_len    |    port_len    |  rem_addr_len  |    arg_cnt     |
    +----------------+----------------+----------------+----------------+
    |   arg_1_len    |   arg_2_len    |      ...       |   arg_N_len    |
    +----------------+----------------+----------------+----------------+
    |   user ...
    +----------------+----------------+----------------+----------------+
    |   port ...
    +----------------+----------------+----------------+----------------+
    |   rem_addr ...
    +----------------+----------------+----------------+----------------+
    |   arg_1 ...
    +----------------+----------------+----------------+----------------+
    |   arg_2 ...
    +----------------+----------------+----------------+----------------+
    |   ...
    +----------------+----------------+----------------+----------------+
    |   arg_N ...
    +----------------+----------------+----------------+----------------+

[¶](#section-6.1-1){.pilcrow}
:::

authen_method[¶](#section-6.1-2){.pilcrow}

-   ::: {#section-6.1-3.1}
    This field allows the client to indicate the authentication method
    used to acquire user information.[¶](#section-6.1-3.1.1){.pilcrow}
    :::

-   [TAC_PLUS_AUTHEN_METH_NOT_SET :=
    0x00[¶](#section-6.1-3.2){.pilcrow}]{#section-6.1-3.2}

-   [TAC_PLUS_AUTHEN_METH_NONE :=
    0x01[¶](#section-6.1-3.3){.pilcrow}]{#section-6.1-3.3}

-   [TAC_PLUS_AUTHEN_METH_KRB5 :=
    0x02[¶](#section-6.1-3.4){.pilcrow}]{#section-6.1-3.4}

-   [TAC_PLUS_AUTHEN_METH_LINE :=
    0x03[¶](#section-6.1-3.5){.pilcrow}]{#section-6.1-3.5}

-   [TAC_PLUS_AUTHEN_METH_ENABLE :=
    0x04[¶](#section-6.1-3.6){.pilcrow}]{#section-6.1-3.6}

-   [TAC_PLUS_AUTHEN_METH_LOCAL :=
    0x05[¶](#section-6.1-3.7){.pilcrow}]{#section-6.1-3.7}

-   [TAC_PLUS_AUTHEN_METH_TACACSPLUS :=
    0x06[¶](#section-6.1-3.8){.pilcrow}]{#section-6.1-3.8}

-   [TAC_PLUS_AUTHEN_METH_GUEST :=
    0x08[¶](#section-6.1-3.9){.pilcrow}]{#section-6.1-3.9}

-   [TAC_PLUS_AUTHEN_METH_RADIUS :=
    0x10[¶](#section-6.1-3.10){.pilcrow}]{#section-6.1-3.10}

-   [TAC_PLUS_AUTHEN_METH_KRB4 :=
    0x11[¶](#section-6.1-3.11){.pilcrow}]{#section-6.1-3.11}

-   [TAC_PLUS_AUTHEN_METH_RCMD :=
    0x20[¶](#section-6.1-3.12){.pilcrow}]{#section-6.1-3.12}

-   ::: {#section-6.1-3.13}
    As this information is not always subject to verification, it [MUST
    NOT]{.bcp14} be used in policy evaluation. LINE refers to a fixed
    password associated with the terminal line used to gain access.
    LOCAL is a client local user database. ENABLE is a command that
    authenticates in order to grant new privileges. TACACSPLUS is, of
    course, TACACS+. GUEST is an unqualified guest authentication.
    RADIUS is the RADIUS authentication protocol. RCMD refers to
    authentication provided via the R-command protocols from Berkeley
    Unix. KRB5 \[[RFC4120](#RFC4120){.xref}\] and KRB4
    \[[KRB4](#KRB4){.xref}\] are Kerberos versions 5 and
    4.[¶](#section-6.1-3.13.1){.pilcrow}
    :::

-   ::: {#section-6.1-3.14}
    As mentioned above, this field is used by the client to indicate how
    it performed the authentication. One of the options
    (TAC_PLUS_AUTHEN_METH_TACACSPLUS := 0x06) is TACACS+ itself, and so
    the detail of how the client performed this option is given in
    \"Authentication\" ([Section 5](#Authentication){.xref}). For all
    other options, such as KRB and RADIUS, the TACACS+ protocol did not
    play any part in the authentication phase; as those interactions
    were not conducted using the TACACS+ protocol, they will not be
    documented here. For implementers of clients who need details of the
    other protocols, please refer to the respective Kerberos
    \[[RFC4120](#RFC4120){.xref}\] and RADIUS
    \[[RFC3579](#RFC3579){.xref}\]
    RFCs.[¶](#section-6.1-3.14.1){.pilcrow}
    :::

priv_lvl[¶](#section-6.1-4){.pilcrow}

-   ::: {#section-6.1-5.1}
    This field is used in the same way as the priv_lvl field in
    authentication request and is described in \"Privilege Levels\"
    ([Section 9](#PrivilegeLevel){.xref}). It indicates the user\'s
    current privilege level.[¶](#section-6.1-5.1.1){.pilcrow}
    :::

authen_type[¶](#section-6.1-6){.pilcrow}

-   ::: {#section-6.1-7.1}
    This field corresponds to the authen_type field in
    \"Authentication\" ([Section 5](#Authentication){.xref}). It
    indicates the type of authentication that was performed. If this
    information is not available, then the client will set authen_type
    to TAC_PLUS_AUTHEN_TYPE_NOT_SET := 0x00. This value is valid only in
    authorization and accounting
    requests.[¶](#section-6.1-7.1.1){.pilcrow}
    :::

authen_service[¶](#section-6.1-8){.pilcrow}

-   ::: {#section-6.1-9.1}
    This field is the same as the authen_service field in
    \"Authentication\" ([Section 5](#Authentication){.xref}). It
    indicates the service through which the user
    authenticated.[¶](#section-6.1-9.1.1){.pilcrow}
    :::

user, user_len[¶](#section-6.1-10){.pilcrow}

-   ::: {#section-6.1-11.1}
    This field contains the user\'s account name. The user_len
    [MUST]{.bcp14} indicate the length of the user field, in
    bytes.[¶](#section-6.1-11.1.1){.pilcrow}
    :::

port, port_len[¶](#section-6.1-12){.pilcrow}

-   ::: {#section-6.1-13.1}
    This field matches the port field in \"Authentication\" ([Section
    5](#Authentication){.xref}). The port_len indicates the length of
    the port field, in bytes.[¶](#section-6.1-13.1.1){.pilcrow}
    :::

rem_addr, rem_addr_len[¶](#section-6.1-14){.pilcrow}

-   ::: {#section-6.1-15.1}
    This field matches the rem_addr field in \"Authentication\"
    ([Section 5](#Authentication){.xref}). The rem_addr_len indicates
    the length of the port field, in
    bytes.[¶](#section-6.1-15.1.1){.pilcrow}
    :::

arg_cnt[¶](#section-6.1-16){.pilcrow}

-   ::: {#section-6.1-17.1}
    This represents the number of authorization arguments to
    follow.[¶](#section-6.1-17.1.1){.pilcrow}
    :::

arg_1 \... arg_N, arg_1\_len \....
arg_N\_len[¶](#section-6.1-18){.pilcrow}

-   ::: {#section-6.1-19.1}
    These arguments are the primary elements of the authorization
    interaction. In the request packet, they describe the specifics of
    the authorization that is being requested. Each argument is encoded
    in the packet as a single arg field (arg_1\... arg_N) with a
    corresponding length field (which indicates the length of each
    argument in bytes).[¶](#section-6.1-19.1.1){.pilcrow}
    :::

-   ::: {#section-6.1-19.2}
    The authorization arguments in both the REQUEST and the REPLY are
    argument-value pairs. The argument and the value are in a single
    string and are separated by either a \"=\" (0X3D) or a \"\*\"
    (0X2A). The equals sign indicates a mandatory argument. The asterisk
    indicates an optional one. For details of text encoding, see
    \"Treatment of Text Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-6.1-19.2.1){.pilcrow}
    :::

-   ::: {#section-6.1-19.3}
    An argument name [MUST NOT]{.bcp14} contain either of the
    separators. An argument value [MAY]{.bcp14} contain the separators.
    This means that the arguments must be parsed until the first
    separator is encountered; all characters in the argument, after this
    separator, are interpreted as the argument
    value.[¶](#section-6.1-19.3.1){.pilcrow}
    :::

-   ::: {#section-6.1-19.4}
    Optional arguments are ones that may be disregarded by either client
    or server. Mandatory arguments require that the receiving side can
    handle the argument, that is, its implementation and configuration
    includes the details of how to act on it. If the client receives a
    mandatory argument that it cannot handle, it [MUST]{.bcp14} consider
    the authorization to have failed. The value part of an
    argument-value pair may be empty, that is, the length of the value
    may be zero.[¶](#section-6.1-19.4.1){.pilcrow}
    :::

-   ::: {#section-6.1-19.5}
    Argument-value strings are not NULL terminated; rather, their length
    value indicates their end. The maximum length of an argument-value
    string is 255 characters. The minimum is two characters (one
    name-value character and the
    separator).[¶](#section-6.1-19.5.1){.pilcrow}
    :::

-   ::: {#section-6.1-19.6}
    Though the arguments allow extensibility, a common core set of
    authorization arguments [SHOULD]{.bcp14} be supported by clients and
    servers; these are listed in \"Authorization Arguments\" ([Section
    8.2](#AuthorizationAttributes){.xref}).[¶](#section-6.1-19.6.1){.pilcrow}
    :::
:::
:::

::: {#TheAuthorizationREPLYPacketBody}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [The Authorization REPLY Packet Body](#name-the-authorization-reply-pac){.section-name .selfRef} {#name-the-authorization-reply-pac}

::: {#section-6.2-1 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |    status      |     arg_cnt    |         server_msg len          |
    +----------------+----------------+----------------+----------------+
    +            data_len             |    arg_1_len   |    arg_2_len   |
    +----------------+----------------+----------------+----------------+
    |      ...       |   arg_N_len    |         server_msg ...
    +----------------+----------------+----------------+----------------+
    |   data ...
    +----------------+----------------+----------------+----------------+
    |   arg_1 ...
    +----------------+----------------+----------------+----------------+
    |   arg_2 ...
    +----------------+----------------+----------------+----------------+
    |   ...
    +----------------+----------------+----------------+----------------+
    |   arg_N ...
    +----------------+----------------+----------------+----------------+

[¶](#section-6.2-1){.pilcrow}
:::

status[¶](#section-6.2-2){.pilcrow}

-   ::: {#section-6.2-3.1}
    This field indicates the authorization
    status.[¶](#section-6.2-3.1.1){.pilcrow}
    :::

-   ::: {#section-6.2-3.2}
    TAC_PLUS_AUTHOR_STATUS_PASS_ADD :=
    0x01[¶](#section-6.2-3.2.1){.pilcrow}

    If the status equals TAC_PLUS_AUTHOR_STATUS_PASS_ADD, then the
    arguments specified in the request are authorized and the arguments
    in the response [MUST]{.bcp14} be applied according to the rules
    described above.[¶](#section-6.2-3.2.2){.pilcrow}

    To approve the authorization with no modifications, the server sets
    the status to TAC_PLUS_AUTHOR_STATUS_PASS_ADD and the arg_cnt to
    0.[¶](#section-6.2-3.2.3){.pilcrow}
    :::

-   ::: {#section-6.2-3.3}
    TAC_PLUS_AUTHOR_STATUS_PASS_REPL :=
    0x02[¶](#section-6.2-3.3.1){.pilcrow}

    If the status equals TAC_PLUS_AUTHOR_STATUS_PASS_REPL, then the
    client [MUST]{.bcp14} use the authorization argument-value pairs (if
    any) in the response instead of the authorization argument-value
    pairs from the request.[¶](#section-6.2-3.3.2){.pilcrow}
    :::

-   ::: {#section-6.2-3.4}
    TAC_PLUS_AUTHOR_STATUS_FAIL := 0x10[¶](#section-6.2-3.4.1){.pilcrow}

    If the status equals TAC_PLUS_AUTHOR_STATUS_FAIL, then the requested
    authorization [MUST]{.bcp14} be
    denied.[¶](#section-6.2-3.4.2){.pilcrow}
    :::

-   ::: {#section-6.2-3.5}
    TAC_PLUS_AUTHOR_STATUS_ERROR :=
    0x11[¶](#section-6.2-3.5.1){.pilcrow}

    A status of TAC_PLUS_AUTHOR_STATUS_ERROR indicates an error occurred
    on the server. For the differences between ERROR and FAIL, refer to
    \"Session Completion\" ([Section 4.4](#SessionCompletion){.xref}).
    None of the arg values have any relevance if an ERROR is set and
    must be ignored.[¶](#section-6.2-3.5.2){.pilcrow}
    :::

-   ::: {#section-6.2-3.6}
    TAC_PLUS_AUTHOR_STATUS_FOLLOW :=
    0x21[¶](#section-6.2-3.6.1){.pilcrow}

    When the status equals TAC_PLUS_AUTHOR_STATUS_FOLLOW, the arg_cnt
    [MUST]{.bcp14} be 0. In that case, the actions to be taken and the
    contents of the data field are identical to the
    TAC_PLUS_AUTHEN_STATUS_FOLLOW status for
    authentication.[¶](#section-6.2-3.6.2){.pilcrow}
    :::

server_msg, server_msg_len[¶](#section-6.2-4){.pilcrow}

-   ::: {#section-6.2-5.1}
    This is a string that may be presented to the user. The
    server_msg_len indicates the length of the server_msg field, in
    bytes. For details of text encoding, see \"Treatment of Text
    Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-6.2-5.1.1){.pilcrow}
    :::

data, data_len[¶](#section-6.2-6){.pilcrow}

-   ::: {#section-6.2-7.1}
    This is a string that may be presented on an administrative display,
    console, or log. The decision to present this message is client
    specific. The data_len indicates the length of the data field, in
    bytes. For details of text encoding, see \"Treatment of Text
    Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-6.2-7.1.1){.pilcrow}
    :::

arg_cnt[¶](#section-6.2-8){.pilcrow}

-   ::: {#section-6.2-9.1}
    This represents the number of authorization arguments to
    follow.[¶](#section-6.2-9.1.1){.pilcrow}
    :::

arg_1 \... arg_N, arg_1\_len \....
arg_N\_len[¶](#section-6.2-10){.pilcrow}

-   ::: {#section-6.2-11.1}
    The arguments describe the specifics of the authorization that is
    being requested. For details of the content of the args, refer to
    \"Authorization Arguments\" ([Section
    8.2](#AuthorizationAttributes){.xref}). Each argument is encoded in
    the packet as a single arg field (arg_1\... arg_N) with a
    corresponding length field (which indicates the length of each
    argument in bytes).[¶](#section-6.2-11.1.1){.pilcrow}
    :::
:::
:::
:::
:::

::: {#Accounting}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [Accounting](#name-accounting){.section-name .selfRef} {#name-accounting}

Accounting is typically the third action after authentication and
authorization. But again, neither authentication nor authorization is
required. Accounting is the action of recording what a user is doing
and/or has done. Accounting in TACACS+ can serve two purposes: it may be
used as an auditing tool for security services, and it may also be used
to account for services used such as in a billing environment. To this
end, TACACS+ supports three types of accounting records: Start records
indicate that a service is about to begin, Stop records indicate that a
service has just terminated, and Update records are intermediate notices
that indicate that a service is still being performed. TACACS+
accounting records contain all the information used in the authorization
records and also contain accounting-specific information such as start
and stop times (when appropriate) and resource usage information. A list
of accounting arguments is defined in \"Accounting Arguments\" ([Section
8.3](#AccountingAttributes){.xref}).[¶](#section-7-1){.pilcrow}

::: {#TheAccountREQUESTPacketBody}
::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [The Account REQUEST Packet Body](#name-the-account-request-packet-){.section-name .selfRef} {#name-the-account-request-packet-}

::: {#section-7.1-1 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |      flags     |  authen_method |    priv_lvl    |  authen_type   |
    +----------------+----------------+----------------+----------------+
    | authen_service |    user_len    |    port_len    |  rem_addr_len  |
    +----------------+----------------+----------------+----------------+
    |    arg_cnt     |   arg_1_len    |   arg_2_len    |      ...       |
    +----------------+----------------+----------------+----------------+
    |   arg_N_len    |    user ...
    +----------------+----------------+----------------+----------------+
    |   port ...
    +----------------+----------------+----------------+----------------+
    |   rem_addr ...
    +----------------+----------------+----------------+----------------+
    |   arg_1 ...
    +----------------+----------------+----------------+----------------+
    |   arg_2 ...
    +----------------+----------------+----------------+----------------+
    |   ...
    +----------------+----------------+----------------+----------------+
    |   arg_N ...
    +----------------+----------------+----------------+----------------+

[¶](#section-7.1-1){.pilcrow}
:::

flags[¶](#section-7.1-2){.pilcrow}

-   ::: {#section-7.1-3.1}
    This holds bitmapped flags.[¶](#section-7.1-3.1.1){.pilcrow}
    :::

-   ::: {#section-7.1-3.2}
    Valid values are:[¶](#section-7.1-3.2.1){.pilcrow}
    :::

-   [TAC_PLUS_ACCT_FLAG_START :=
    0x02[¶](#section-7.1-3.3){.pilcrow}]{#section-7.1-3.3}

-   [TAC_PLUS_ACCT_FLAG_STOP :=
    0x04[¶](#section-7.1-3.4){.pilcrow}]{#section-7.1-3.4}

-   [TAC_PLUS_ACCT_FLAG_WATCHDOG :=
    0x08[¶](#section-7.1-3.5){.pilcrow}]{#section-7.1-3.5}

All other fields are defined in \"Authentication\" ([Section
5](#Authentication){.xref}) and \"Authorization\" ([Section
6](#Authorization){.xref}) and have the same semantics. They provide
details for the conditions on the client, and authentication context, so
that these details may be logged for accounting
purposes.[¶](#section-7.1-4){.pilcrow}

See \"Accounting Arguments\" ([Section
8.3](#AccountingAttributes){.xref}) for the dictionary of arguments
relevant to accounting.[¶](#section-7.1-5){.pilcrow}
:::
:::

::: {#TheAccountingREPLYPacketBody}
::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [The Accounting REPLY Packet Body](#name-the-accounting-reply-packet){.section-name .selfRef} {#name-the-accounting-reply-packet}

The purpose of accounting is to record the action that has occurred on
the client. The server [MUST]{.bcp14} reply with success only when the
accounting request has been recorded. If the server did not record the
accounting request, then it [MUST]{.bcp14} reply with
ERROR.[¶](#section-7.2-1){.pilcrow}

::: {#section-7.2-2 .artwork .art-text .alignLeft}
     1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8  1 2 3 4 5 6 7 8
    +----------------+----------------+----------------+----------------+
    |         server_msg len          |            data_len             |
    +----------------+----------------+----------------+----------------+
    |     status     |         server_msg ...
    +----------------+----------------+----------------+----------------+
    |     data ...
    +----------------+

[¶](#section-7.2-2){.pilcrow}
:::

status[¶](#section-7.2-3){.pilcrow}

-   ::: {#section-7.2-4.1}
    This is the return status.[¶](#section-7.2-4.1.1){.pilcrow}
    :::

-   ::: {#section-7.2-4.2}
    Values are:[¶](#section-7.2-4.2.1){.pilcrow}
    :::

-   [TAC_PLUS_ACCT_STATUS_SUCCESS :=
    0x01[¶](#section-7.2-4.3){.pilcrow}]{#section-7.2-4.3}

-   [TAC_PLUS_ACCT_STATUS_ERROR :=
    0x02[¶](#section-7.2-4.4){.pilcrow}]{#section-7.2-4.4}

-   ::: {#section-7.2-4.5}
    TAC_PLUS_ACCT_STATUS_FOLLOW := 0x21[¶](#section-7.2-4.5.1){.pilcrow}

    When the status equals TAC_PLUS_ACCT_STATUS_FOLLOW, the actions to
    be taken and the contents of the data field are identical to the
    TAC_PLUS_AUTHEN_STATUS_FOLLOW status for
    authentication.[¶](#section-7.2-4.5.2){.pilcrow}
    :::

server_msg, server_msg_len[¶](#section-7.2-5){.pilcrow}

-   ::: {#section-7.2-6.1}
    This is a string that may be presented to the user. The
    server_msg_len indicates the length of the server_msg field, in
    bytes. For details of text encoding, see \"Treatment of Text
    Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-7.2-6.1.1){.pilcrow}
    :::

data, data_len[¶](#section-7.2-7){.pilcrow}

-   ::: {#section-7.2-8.1}
    This is a string that may be presented on an administrative display,
    console, or log. The decision to present this message is client
    specific. The data_len indicates the length of the data field, in
    bytes. For details of text encoding, see \"Treatment of Text
    Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-7.2-8.1.1){.pilcrow}
    :::

TACACS+ accounting is intended to record various types of events on
clients, for example: login sessions, command entry, and others as
required by the client implementation. These events are collectively
referred to in \"The Draft\" \[[THE-DRAFT](#THE-DRAFT){.xref}\] as
\"tasks\".[¶](#section-7.2-9){.pilcrow}

The TAC_PLUS_ACCT_FLAG_START flag indicates that this is a start
accounting message. Start messages will only be sent once when a task is
started. The TAC_PLUS_ACCT_FLAG_STOP indicates that this is a stop
record and that the task has terminated. The TAC_PLUS_ACCT_FLAG_WATCHDOG
flag means that this is an update record.[¶](#section-7.2-10){.pilcrow}

[]{#name-summary-of-accounting-packe}

::: {#accounting-packets}
  Watchdog   Stop   Start   Flags & 0xE   Meaning
  ---------- ------ ------- ------------- -------------------------
  0          0      0       0             INVALID
  0          0      1       2             Start Accounting Record
  0          1      0       4             Stop Accounting Record
  0          1      1       6             INVALID
  1          0      0       8             Watchdog, no update
  1          0      1       A             Watchdog, with update
  1          1      0       C             INVALID
  1          1      1       E             INVALID

  : [Table 2](#table-2){.selfRef}: [Summary of Accounting
  Packets](#name-summary-of-accounting-packe){.selfRef}
:::

The START and STOP flags are mutually
exclusive.[¶](#section-7.2-12){.pilcrow}

The WATCHDOG flag is used by the client to communicate ongoing status of
a long-running task. Update records are sent at the client\'s
discretion. The frequency of the update depends upon the intended
application: a watchdog to provide progress indication will require
higher frequency than a daily keep-alive. When the WATCHDOG flag is set
along with the START flag, it indicates that the update record provides
additional or updated arguments from the original START record. If the
START flag is not set, then this indicates only that task is still
running, and no new information is provided (servers [MUST]{.bcp14}
ignore any arguments). The STOP flag [MUST NOT]{.bcp14} be set in
conjunction with the WATCHDOG flag.[¶](#section-7.2-13){.pilcrow}

The server [MUST]{.bcp14} respond with TAC_PLUS_ACCT_STATUS_ERROR if the
client requests an INVALID option.[¶](#section-7.2-14){.pilcrow}
:::
:::
:::
:::

::: {#AttributeValuePairs}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Argument-Value Pairs](#name-argument-value-pairs){.section-name .selfRef} {#name-argument-value-pairs}

TACACS+ is intended to be an extensible protocol. The arguments used in
Authorization and Accounting are not limited by this document. Some
arguments are defined below for common use cases. Clients [MUST]{.bcp14}
use these arguments when supporting the corresponding use
cases.[¶](#section-8-1){.pilcrow}

::: {#ValueEncoding}
::: {#section-8.1 .section}
### [8.1.](#section-8.1){.section-number .selfRef} [Value Encoding](#name-value-encoding){.section-name .selfRef} {#name-value-encoding}

All argument values are encoded as strings. For details of text
encoding, see \"Treatment of Text Strings\" ([Section
3.7](#TextEncoding){.xref}). The following type representations
[SHOULD]{.bcp14} be followed.[¶](#section-8.1-1){.pilcrow}

Numeric[¶](#section-8.1-2){.pilcrow}

-   ::: {#section-8.1-3.1}
    All numeric values in an argument-value string are provided as
    decimal numbers, unless otherwise stated. All arguments include a
    length field, and TACACS+ implementations [MUST]{.bcp14} verify that
    they can accommodate the lengths of numeric arguments before
    attempting to process them. If the length cannot be accommodated,
    then the argument [MUST]{.bcp14} be regarded as not handled and the
    logic in \"Authorization\" ([Section
    6.1](#TheAuthorizationREQUESTPacketBody){.xref}) regarding the
    processing of arguments [MUST]{.bcp14} be
    applied.[¶](#section-8.1-3.1.1){.pilcrow}
    :::

Boolean[¶](#section-8.1-4){.pilcrow}

-   ::: {#section-8.1-5.1}
    All Boolean arguments are encoded with values \"true\" or
    \"false\".[¶](#section-8.1-5.1.1){.pilcrow}
    :::

IP-Address[¶](#section-8.1-6){.pilcrow}

-   ::: {#section-8.1-7.1}
    It is recommended that hosts be specified as an IP address so as to
    avoid any ambiguities. For details of text encoding, see \"Treatment
    of Text Strings\" ([Section 3.7](#TextEncoding){.xref}). IPv4
    addresses are specified as octet numerics separated by dots (\'.\').
    IPv6 address text representation is defined in
    \[[RFC5952](#RFC5952){.xref}\].[¶](#section-8.1-7.1.1){.pilcrow}
    :::

Date Time[¶](#section-8.1-8){.pilcrow}

-   ::: {#section-8.1-9.1}
    Absolute date/times are specified in seconds since the epoch,
    12:00am, January 1, 1970. The time zone [MUST]{.bcp14} be UTC unless
    a time zone argument is specified.[¶](#section-8.1-9.1.1){.pilcrow}
    :::

String[¶](#section-8.1-10){.pilcrow}

-   ::: {#section-8.1-11.1}
    Many values have no specific type representation and are interpreted
    as plain strings.[¶](#section-8.1-11.1.1){.pilcrow}
    :::

Empty Values[¶](#section-8.1-12){.pilcrow}

-   ::: {#section-8.1-13.1}
    Arguments may be submitted with no value, in which case they consist
    of the name and the mandatory or optional separator. For example,
    the argument \"cmd\", which has no value, is transmitted as a string
    of four characters \"cmd=\".[¶](#section-8.1-13.1.1){.pilcrow}
    :::
:::
:::

::: {#AuthorizationAttributes}
::: {#section-8.2 .section}
### [8.2.](#section-8.2){.section-number .selfRef} [Authorization Arguments](#name-authorization-arguments){.section-name .selfRef} {#name-authorization-arguments}

service (String)[¶](#section-8.2-1){.pilcrow}

-   ::: {#section-8.2-2.1}
    The primary service. Specifying a service argument indicates that
    this is a request for authorization or accounting of that service.
    For example: \"shell\", \"tty-server\", \"connection\", \"system\"
    and \"firewall\"; others may be chosen for the required application.
    This argument [MUST]{.bcp14} always be
    included.[¶](#section-8.2-2.1.1){.pilcrow}
    :::

protocol (String)[¶](#section-8.2-3){.pilcrow}

-   ::: {#section-8.2-4.1}
    A field that may be used to indicate a subset of a
    service.[¶](#section-8.2-4.1.1){.pilcrow}
    :::

cmd (String)[¶](#section-8.2-5){.pilcrow}

-   ::: {#section-8.2-6.1}
    A shell (exec) command. This indicates the command name of the
    command that is to be run. The \"cmd\" argument [MUST]{.bcp14} be
    specified if service equals
    \"shell\".[¶](#section-8.2-6.1.1){.pilcrow}
    :::

-   ::: {#section-8.2-6.2}
    Authorization of shell commands is a common use case for the TACACS+
    protocol. Command Authorization generally takes one of two forms:
    session based or command based.[¶](#section-8.2-6.2.1){.pilcrow}
    :::

-   ::: {#section-8.2-6.3}
    For session-based shell authorization, the \"cmd\" argument will
    have an empty value. The client determines which commands are
    allowed in a session according to the arguments present in the
    authorization.[¶](#section-8.2-6.3.1){.pilcrow}
    :::

-   ::: {#section-8.2-6.4}
    In command-based authorization, the client requests that the server
    determine whether a command is allowed by making an authorization
    request for each command. The \"cmd\" argument will have the command
    name as its value.[¶](#section-8.2-6.4.1){.pilcrow}
    :::

cmd-arg (String)[¶](#section-8.2-7){.pilcrow}

-   ::: {#section-8.2-8.1}
    An argument to a shell (exec) command. This indicates an argument
    for the shell command that is to be run. Multiple cmd-arg arguments
    may be specified, and they are order
    dependent.[¶](#section-8.2-8.1.1){.pilcrow}
    :::

acl (Numeric)[¶](#section-8.2-9){.pilcrow}

-   ::: {#section-8.2-10.1}
    A number representing a connection access list. Applicable only to
    session-based shell authorization. For details of text encoding, see
    \"Treatment of Text Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-8.2-10.1.1){.pilcrow}
    :::

inacl (String)[¶](#section-8.2-11){.pilcrow}

-   ::: {#section-8.2-12.1}
    The identifier (name) of an interface input access list. For details
    of text encoding, see \"Treatment of Text Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-8.2-12.1.1){.pilcrow}
    :::

outacl (String)[¶](#section-8.2-13){.pilcrow}

-   ::: {#section-8.2-14.1}
    The identifier (name) of an interface output access list. For
    details of text encoding, see \"Treatment of Text Strings\"
    ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-8.2-14.1.1){.pilcrow}
    :::

addr (IP-Address)[¶](#section-8.2-15){.pilcrow}

-   ::: {#section-8.2-16.1}
    A network address.[¶](#section-8.2-16.1.1){.pilcrow}
    :::

addr-pool (String)[¶](#section-8.2-17){.pilcrow}

-   ::: {#section-8.2-18.1}
    The identifier of an address pool from which the client can assign
    an address.[¶](#section-8.2-18.1.1){.pilcrow}
    :::

timeout (Numeric)[¶](#section-8.2-19){.pilcrow}

-   ::: {#section-8.2-20.1}
    An absolute timer for the connection (in minutes). A value of zero
    indicates no timeout.[¶](#section-8.2-20.1.1){.pilcrow}
    :::

idletime (Numeric)[¶](#section-8.2-21){.pilcrow}

-   ::: {#section-8.2-22.1}
    An idle-timeout for the connection (in minutes). A value of zero
    indicates no timeout.[¶](#section-8.2-22.1.1){.pilcrow}
    :::

autocmd (String)[¶](#section-8.2-23){.pilcrow}

-   ::: {#section-8.2-24.1}
    An auto-command to run. Applicable only to session-based shell
    authorization.[¶](#section-8.2-24.1.1){.pilcrow}
    :::

noescape (Boolean)[¶](#section-8.2-25){.pilcrow}

-   ::: {#section-8.2-26.1}
    Prevents the user from using an escape character. Applicable only to
    session-based shell authorization.[¶](#section-8.2-26.1.1){.pilcrow}
    :::

nohangup (Boolean)[¶](#section-8.2-27){.pilcrow}

-   ::: {#section-8.2-28.1}
    Boolean. Do not disconnect after an automatic command. Applicable
    only to session-based shell
    authorization.[¶](#section-8.2-28.1.1){.pilcrow}
    :::

priv-lvl (Numeric)[¶](#section-8.2-29){.pilcrow}

-   ::: {#section-8.2-30.1}
    The privilege level to be assigned. Please refer to \"Privilege
    Levels\" ([Section
    9](#PrivilegeLevel){.xref}).[¶](#section-8.2-30.1.1){.pilcrow}
    :::
:::
:::

::: {#AccountingAttributes}
::: {#section-8.3 .section}
### [8.3.](#section-8.3){.section-number .selfRef} [Accounting Arguments](#name-accounting-arguments){.section-name .selfRef} {#name-accounting-arguments}

The following arguments are defined for TACACS+ accounting only. They
[MUST]{.bcp14} precede any argument-value pairs that are defined in
\"Authorization\" ([Section
6](#Authorization){.xref}).[¶](#section-8.3-1){.pilcrow}

task_id (String)[¶](#section-8.3-2){.pilcrow}

-   ::: {#section-8.3-3.1}
    Start and stop records for the same event [MUST]{.bcp14} have
    matching task_id argument values. The client [MUST]{.bcp14} ensure
    that active task_ids are not duplicated; a client [MUST NOT]{.bcp14}
    reuse a task_id in a start record until it has sent a stop record
    for that task_id. Servers [MUST NOT]{.bcp14} make assumptions about
    the format of a task_id.[¶](#section-8.3-3.1.1){.pilcrow}
    :::

start_time (Date Time)[¶](#section-8.3-4){.pilcrow}

-   ::: {#section-8.3-5.1}
    The time the action started (in seconds since the
    epoch).[¶](#section-8.3-5.1.1){.pilcrow}
    :::

stop_time (Date Time)[¶](#section-8.3-6){.pilcrow}

-   ::: {#section-8.3-7.1}
    The time the action stopped (in seconds since the
    epoch).[¶](#section-8.3-7.1.1){.pilcrow}
    :::

elapsed_time (Numeric)[¶](#section-8.3-8){.pilcrow}

-   ::: {#section-8.3-9.1}
    The elapsed time in seconds for the
    action.[¶](#section-8.3-9.1.1){.pilcrow}
    :::

timezone (String)[¶](#section-8.3-10){.pilcrow}

-   ::: {#section-8.3-11.1}
    The time zone abbreviation for all timestamps included in this
    packet. A database of time zones is maintained in
    \[[TZDB](#TZDB){.xref}\].[¶](#section-8.3-11.1.1){.pilcrow}
    :::

event (String)[¶](#section-8.3-12){.pilcrow}

-   ::: {#section-8.3-13.1}
    Used only when \"service=system\". Current values are \"net_acct\",
    \"cmd_acct\", \"conn_acct\", \"shell_acct\", \"sys_acct\", and
    \"clock_change\". These indicate system-level changes. The flags
    field [SHOULD]{.bcp14} indicate whether the service started or
    stopped.[¶](#section-8.3-13.1.1){.pilcrow}
    :::

reason (String)[¶](#section-8.3-14){.pilcrow}

-   ::: {#section-8.3-15.1}
    Accompanies an event argument. It describes why the event
    occurred.[¶](#section-8.3-15.1.1){.pilcrow}
    :::

bytes (Numeric)[¶](#section-8.3-16){.pilcrow}

-   ::: {#section-8.3-17.1}
    The number of bytes transferred by this
    action.[¶](#section-8.3-17.1.1){.pilcrow}
    :::

bytes_in (Numeric)[¶](#section-8.3-18){.pilcrow}

-   ::: {#section-8.3-19.1}
    The number of bytes transferred by this action from the endstation
    to the client port.[¶](#section-8.3-19.1.1){.pilcrow}
    :::

bytes_out (Numeric)[¶](#section-8.3-20){.pilcrow}

-   ::: {#section-8.3-21.1}
    The number of bytes transferred by this action from the client to
    the endstation port.[¶](#section-8.3-21.1.1){.pilcrow}
    :::

paks (Numeric)[¶](#section-8.3-22){.pilcrow}

-   ::: {#section-8.3-23.1}
    The number of packets transferred by this
    action.[¶](#section-8.3-23.1.1){.pilcrow}
    :::

paks_in (Numeric)[¶](#section-8.3-24){.pilcrow}

-   ::: {#section-8.3-25.1}
    The number of input packets transferred by this action from the
    endstation to the client port.[¶](#section-8.3-25.1.1){.pilcrow}
    :::

paks_out (Numeric)[¶](#section-8.3-26){.pilcrow}

-   ::: {#section-8.3-27.1}
    The number of output packets transferred by this action from the
    client port to the endstation.[¶](#section-8.3-27.1.1){.pilcrow}
    :::

err_msg (String)[¶](#section-8.3-28){.pilcrow}

-   ::: {#section-8.3-29.1}
    A string describing the status of the action. For details of text
    encoding, see \"Treatment of Text Strings\" ([Section
    3.7](#TextEncoding){.xref}).[¶](#section-8.3-29.1.1){.pilcrow}
    :::

Where the TACACS+ deployment is used to support the Device
Administration use case, it is often required to log all commands
entered into client devices. To support this mode of operation, TACACS+
client devices [MUST]{.bcp14} be configured to send an accounting start
packet for every command entered, irrespective of how the commands were
authorized. These \"Command Accounting\" packets [MUST]{.bcp14} include
the \"service\" and \"cmd\" arguments, and if needed, the \"cmd-arg\"
arguments detailed in [Section
8.2](#AuthorizationAttributes){.xref}.[¶](#section-8.3-30){.pilcrow}
:::
:::
:::
:::

::: {#PrivilegeLevel}
::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Privilege Levels](#name-privilege-levels){.section-name .selfRef} {#name-privilege-levels}

The TACACS+ protocol supports flexible authorization schemes through the
extensible arguments.[¶](#section-9-1){.pilcrow}

The privilege levels scheme is built into the protocol and has been
extensively used as an option for Session-based shell authorization.
Privilege levels are ordered values from 0 to 15 with each level being a
superset of the next lower value. Configuration and implementation of
the client will map actions (such as the permission to execute specific
commands) to different privilege levels. The allocation of commands to
privilege levels is highly dependent upon the deployment. Common
allocations are as follows:[¶](#section-9-2){.pilcrow}

-   [TAC_PLUS_PRIV_LVL_MIN := 0x00. The level normally allocated to an
    unauthenticated
    session.[¶](#section-9-3.1){.pilcrow}]{#section-9-3.1}
-   [TAC_PLUS_PRIV_LVL_USER := 0x01. The level normally allocated to a
    regular authenticated
    session.[¶](#section-9-3.2){.pilcrow}]{#section-9-3.2}
-   [TAC_PLUS_PRIV_LVL_ROOT := 0x0f. The level normally allocated to a
    session authenticated by a highly privileged user to allow commands
    with significant system
    impact.[¶](#section-9-3.3){.pilcrow}]{#section-9-3.3}
-   [TAC_PLUS_PRIV_LVL_MAX := 0x0f. The highest privilege
    level.[¶](#section-9-3.4){.pilcrow}]{#section-9-3.4}

A privilege level can be assigned to a shell (exec) session when it
starts. The client will permit the actions associated with this level to
be executed. This privilege level is returned by the server in a
session-based shell authorization (when \"service\" equals \"shell\" and
\"cmd\" is empty). When a user is required to perform actions that are
mapped to a higher privilege level, an ENABLE-type reauthentication can
be initiated by the client. The client will insert the required
privilege level into the authentication header for ENABLE authentication
requests.[¶](#section-9-4){.pilcrow}

The use of privilege levels to determine session-based access to
commands and resources is not mandatory for clients. Although the
privilege-level scheme is widely supported, its lack of flexibility in
requiring a single monotonic hierarchy of permissions means that other
session-based command authorization schemes have evolved. However, it is
still common enough that it [SHOULD]{.bcp14} be supported by
servers.[¶](#section-9-5){.pilcrow}
:::
:::

::: {#TACACSSecurity}
::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

\"The Draft\" \[[THE-DRAFT](#THE-DRAFT){.xref}\] from 1998 did not
address all of the key security concerns that are considered when
designing modern standards. This section addresses known limitations and
concerns that will impact overall security of the protocol and systems
where this protocol is deployed to manage central authentication,
authorization, or accounting for network Device
Administration.[¶](#section-10-1){.pilcrow}

Multiple implementations of the protocol described in \"The Draft\"
\[[THE-DRAFT](#THE-DRAFT){.xref}\] have been deployed. As the protocol
was never standardized, current implementations may be incompatible in
non-obvious ways, giving rise to additional security risks. This section
does not claim to enumerate all possible security
vulnerabilities.[¶](#section-10-2){.pilcrow}

::: {#SecurityofTheProtocol}
::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [General Security of the Protocol](#name-general-security-of-the-pro){.section-name .selfRef} {#name-general-security-of-the-pro}

The TACACS+ protocol does not include a security mechanism that would
meet modern-day requirements. These security mechanisms would be best
referred to as \"obfuscation\" and not \"encryption\", since they
provide no meaningful integrity, privacy, or replay protection. An
attacker with access to the data stream should be assumed to be able to
read and modify all TACACS+ packets. Without mitigation, a range of
risks such as the following are possible:[¶](#section-10.1-1){.pilcrow}

-   [Accounting information may be modified by the man-in-the-middle
    attacker, making such logs unsuitable and not trustable for auditing
    purposes.[¶](#section-10.1-2.1){.pilcrow}]{#section-10.1-2.1}
-   [Invalid or misleading values may be inserted by the
    man-in-the-middle attacker in various fields at known offsets to try
    and circumvent the authentication or authorization checks even
    inside the obfuscated
    body.[¶](#section-10.1-2.2){.pilcrow}]{#section-10.1-2.2}

While the protocol provides some measure of transport privacy, it is
vulnerable to at least the following
attacks:[¶](#section-10.1-3){.pilcrow}

-   [Brute-force attacks exploiting increased efficiency of MD5 digest
    computation.[¶](#section-10.1-4.1){.pilcrow}]{#section-10.1-4.1}
-   [Known plaintext attacks that may decrease the cost of brute-force
    attacks.[¶](#section-10.1-4.2){.pilcrow}]{#section-10.1-4.2}
-   [Chosen plaintext attacks that may decrease the cost of a
    brute-force
    attacks.[¶](#section-10.1-4.3){.pilcrow}]{#section-10.1-4.3}
-   [No forward
    secrecy.[¶](#section-10.1-4.4){.pilcrow}]{#section-10.1-4.4}

Even though, to the best knowledge of the authors, this method of
encryption wasn\'t rigorously tested, enough information is available
that it is best referred to as \"obfuscation\" and not
\"encryption\".[¶](#section-10.1-5){.pilcrow}

For these reasons, users deploying the TACACS+ protocol in their
environments [MUST]{.bcp14} limit access to known clients and
[MUST]{.bcp14} control the security of the entire transmission path.
Attackers who can guess the key or otherwise break the obfuscation will
gain unrestricted and undetected access to all TACACS+ traffic. Ensuring
that a centralized AAA system like TACACS+ is deployed on a secured
transport is essential to managing the security risk of such an
attack.[¶](#section-10.1-6){.pilcrow}

The following parts of this section enumerate only the session-specific
risks that are in addition to general risk associated with bare
obfuscation and lack of integrity
checking.[¶](#section-10.1-7){.pilcrow}
:::
:::

::: {#SecurityofAuthenticationSessions}
::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Security of Authentication Sessions](#name-security-of-authentication-){.section-name .selfRef} {#name-security-of-authentication-}

Authentication sessions [SHOULD]{.bcp14} be used via a secure transport
(see \"TACACS+ Best Practices\" ([Section 10.5](#Bestpractices){.xref}))
as the man-in-the-middle attack may completely subvert them. Even CHAP,
which may be considered resistant to password interception, is unsafe as
it does not protect the username from a trivial man-in-the-middle
attack.[¶](#section-10.2-1){.pilcrow}

This document deprecates the redirection mechanism using the
TAC_PLUS_AUTHEN_STATUS_FOLLOW option, which was included in \"The
Draft\". As part of this process, the secret key for a new server was
sent to the client. This public exchange of secret keys means that once
one session is broken, it may be possible to leverage that key to
attacking connections to other servers.  This mechanism [MUST
NOT]{.bcp14} be used in modern deployments. It [MUST NOT]{.bcp14} be
used outside a secured deployment.[¶](#section-10.2-2){.pilcrow}
:::
:::

::: {#SecurityofAuthorizationSessions}
::: {#section-10.3 .section}
### [10.3.](#section-10.3){.section-number .selfRef} [Security of Authorization Sessions](#name-security-of-authorization-s){.section-name .selfRef} {#name-security-of-authorization-s}

Authorization sessions [SHOULD]{.bcp14} be used via a secure transport
(see \"TACACS+ Best Practices\" ([Section 10.5](#Bestpractices){.xref}))
as it\'s trivial to execute a successful man-in-the-middle attack that
changes well-known plaintext in either requests or
responses.[¶](#section-10.3-1){.pilcrow}

As an example, take the field \"authen_method\". It\'s not unusual in
actual deployments to authorize all commands received via the device
local serial port (a console port), as that one is usually considered
secure by virtue of the device located in a physically secure location.
If an administrator would configure the authorization system to allow
all commands entered by the user on a local console to aid in
troubleshooting, that would give all access to all commands to any
attacker that would be able to change the \"authen_method\" from
TAC_PLUS_AUTHEN_METH_TACACSPLUS to TAC_PLUS_AUTHEN_METH_LINE. In this
regard, the obfuscation provided by the protocol itself wouldn\'t help
much, because:[¶](#section-10.3-2){.pilcrow}

-   [A lack of integrity means that any byte in the payload may be
    changed without either side detecting the
    change.[¶](#section-10.3-3.1){.pilcrow}]{#section-10.3-3.1}
-   [Known plaintext means that an attacker would know with certainty
    which octet is the target of the attack (in this case, first octet
    after the
    header).[¶](#section-10.3-3.2){.pilcrow}]{#section-10.3-3.2}
-   [In combination with known plaintext, the attacker can determine
    with certainty the value of the crypto-pad octet used to obfuscate
    the original
    octet.[¶](#section-10.3-3.3){.pilcrow}]{#section-10.3-3.3}
:::
:::

::: {#SecurityofAccountingSessions}
::: {#section-10.4 .section}
### [10.4.](#section-10.4){.section-number .selfRef} [Security of Accounting Sessions](#name-security-of-accounting-sess){.section-name .selfRef} {#name-security-of-accounting-sess}

Accounting sessions [SHOULD]{.bcp14} be used via a secure transport (see
\"TACACS+ Best Practices\" ([Section 10.5](#Bestpractices){.xref})).
Although Accounting sessions are not directly involved in authentication
or authorizing operations on the device, man-in-the-middle attackers may
do any of the following:[¶](#section-10.4-1){.pilcrow}

-   [Replace accounting data with new valid values or garbage that can
    confuse auditors or hide information related to their authentication
    and/or authorization attack
    attempts.[¶](#section-10.4-2.1){.pilcrow}]{#section-10.4-2.1}
-   [Try and poison an accounting log with entries designed to make
    systems behave in unintended ways (these systems could be TACACS+
    servers and any other systems that would manage accounting
    entries).[¶](#section-10.4-2.2){.pilcrow}]{#section-10.4-2.2}

In addition to these direct manipulations, different client
implementations pass a different fidelity of accounting data. Some
vendors have been observed in the wild that pass sensitive data like
passwords, encryption keys, and the like as part of the accounting log.
Due to a lack of strong encryption with perfect forward secrecy, this
data may be revealed in the future, leading to a security
incident.[¶](#section-10.4-3){.pilcrow}
:::
:::

::: {#Bestpractices}
::: {#section-10.5 .section}
### [10.5.](#section-10.5){.section-number .selfRef} [TACACS+ Best Practices](#name-tacacs-best-practices){.section-name .selfRef} {#name-tacacs-best-practices}

With respect to the observations about the security issues described
above, a network administrator [MUST NOT]{.bcp14} rely on the
obfuscation of the TACACS+ protocol. TACACS+ [MUST]{.bcp14} be used
within a secure deployment; TACACS+ [MUST]{.bcp14} be deployed over
networks that ensure privacy and integrity of the communication and
[MUST]{.bcp14} be deployed over a network that is separated from other
traffic. Failure to do so will impact overall network
security.[¶](#section-10.5-1){.pilcrow}

The following recommendations impose restrictions on how the protocol is
applied. These restrictions were not imposed in \"The Draft\". New
implementations, and upgrades of current implementations, [MUST]{.bcp14}
implement these recommendations. Vendors [SHOULD]{.bcp14} provide
mechanisms to assist the administrator to achieve these best
practices.[¶](#section-10.5-2){.pilcrow}

::: {#SharedSecrets}
::: {#section-10.5.1 .section}
#### [10.5.1.](#section-10.5.1){.section-number .selfRef} [Shared Secrets](#name-shared-secrets){.section-name .selfRef} {#name-shared-secrets}

TACACS+ servers and clients [MUST]{.bcp14} treat shared secrets as
sensitive data to be managed securely, as would be expected for other
sensitive data such as identity credential information. TACACS+ servers
[MUST NOT]{.bcp14} leak sensitive data.[¶](#section-10.5.1-1){.pilcrow}

For example:[¶](#section-10.5.1-2){.pilcrow}

-   ::: {#section-10.5.1-3.1}
    TACACS+ servers [MUST NOT]{.bcp14} expose shared secrets in
    logs.[¶](#section-10.5.1-3.1.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.2}
    TACACS+ servers [MUST]{.bcp14} allow a dedicated secret key to be
    defined for each client.[¶](#section-10.5.1-3.2.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.3}
    TACACS+ server management systems [MUST]{.bcp14} provide a mechanism
    to track secret key lifetimes and notify administrators to update
    them periodically. TACACS+ server administrators [SHOULD]{.bcp14}
    change secret keys at regular
    intervals.[¶](#section-10.5.1-3.3.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.4}
    TACACS+ servers [SHOULD]{.bcp14} warn administrators if secret keys
    are not unique per client.[¶](#section-10.5.1-3.4.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.5}
    TACACS+ server administrators [SHOULD]{.bcp14} always define a
    secret for each client.[¶](#section-10.5.1-3.5.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.6}
    TACACS+ servers and clients [MUST]{.bcp14} support shared keys that
    are at least 32 characters long.[¶](#section-10.5.1-3.6.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.7}
    TACACS+ servers [MUST]{.bcp14} support policy to define minimum
    complexity for shared keys.[¶](#section-10.5.1-3.7.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.8}
    TACACS+ clients [SHOULD NOT]{.bcp14} allow servers to be configured
    without a shared secret key or shared key that is less than 16
    characters long.[¶](#section-10.5.1-3.8.1){.pilcrow}
    :::

-   ::: {#section-10.5.1-3.9}
    TACACS+ server administrators [SHOULD]{.bcp14} configure secret keys
    of a minimum of 16 characters in
    length.[¶](#section-10.5.1-3.9.1){.pilcrow}
    :::
:::
:::

::: {#Connections}
::: {#section-10.5.2 .section}
#### [10.5.2.](#section-10.5.2){.section-number .selfRef} [Connections and Obfuscation](#name-connections-and-obfuscation){.section-name .selfRef} {#name-connections-and-obfuscation}

TACACS+ servers [MUST]{.bcp14} allow the definition of individual
clients. The servers [MUST]{.bcp14} only accept network connection
attempts from these defined known
clients.[¶](#section-10.5.2-1){.pilcrow}

TACACS+ servers [MUST]{.bcp14} reject connections that have
TAC_PLUS_UNENCRYPTED_FLAG set. There [MUST]{.bcp14} always be a shared
secret set on the server for the client requesting the
connection.[¶](#section-10.5.2-2){.pilcrow}

If an invalid shared secret is detected when processing packets for a
client, TACACS+ servers [MUST NOT]{.bcp14} accept any new sessions on
that connection. TACACS+ servers [MUST]{.bcp14} terminate the connection
on completion of any sessions that were previously established with a
valid shared secret on that connection.[¶](#section-10.5.2-3){.pilcrow}

TACACS+ clients [MUST NOT]{.bcp14} set TAC_PLUS_UNENCRYPTED_FLAG.
Clients [MUST]{.bcp14} be implemented in a way that requires explicit
configuration to enable the use of TAC_PLUS_UNENCRYPTED_FLAG. This
option [MUST NOT]{.bcp14} be used when the client is in
production.[¶](#section-10.5.2-4){.pilcrow}

When a TACACS+ client receives responses from servers
where:[¶](#section-10.5.2-5){.pilcrow}

-   [the response packet was received from the server configured with a
    shared key, but the packet has TAC_PLUS_UNENCRYPTED_FLAG set,
    and[¶](#section-10.5.2-6.1){.pilcrow}]{#section-10.5.2-6.1}
-   [the response packet was received from the server configured not to
    use obfuscation, but the packet has TAC_PLUS_UNENCRYPTED_FLAG not
    set,[¶](#section-10.5.2-6.2){.pilcrow}]{#section-10.5.2-6.2}

the TACACS+ client [MUST]{.bcp14} close the TCP session, and process the
response in the same way that a TAC_PLUS_AUTHEN_STATUS_FAIL
(authentication sessions) or TAC_PLUS_AUTHOR_STATUS_FAIL (authorization
sessions) was received.[¶](#section-10.5.2-7){.pilcrow}
:::
:::

::: {#AuthenticationRecommendations}
::: {#section-10.5.3 .section}
#### [10.5.3.](#section-10.5.3){.section-number .selfRef} [Authentication](#name-authentication-2){.section-name .selfRef} {#name-authentication-2}

To help TACACS+ administrators select stronger authentication options,
TACACS+ servers [MUST]{.bcp14} allow the administrator to configure the
server to only accept challenge/response options for authentication
(TAC_PLUS_AUTHEN_TYPE_CHAP or TAC_PLUS_AUTHEN_TYPE_MSCHAP or
TAC_PLUS_AUTHEN_TYPE_MSCHAPV2 for
authen_type).[¶](#section-10.5.3-1){.pilcrow}

TACACS+ server administrators [SHOULD]{.bcp14} enable the option
mentioned in the previous paragraph. TACACS+ server deployments
[SHOULD]{.bcp14} only enable other options (such as
TAC_PLUS_AUTHEN_TYPE_ASCII or TAC_PLUS_AUTHEN_TYPE_PAP) when unavoidable
due to requirements of identity/password
systems.[¶](#section-10.5.3-2){.pilcrow}

TACACS+ server administrators [SHOULD NOT]{.bcp14} allow the same
credentials to be applied in challenge-based (TAC_PLUS_AUTHEN_TYPE_CHAP
or TAC_PLUS_AUTHEN_TYPE_MSCHAP or TAC_PLUS_AUTHEN_TYPE_MSCHAPV2) and
non-challenge-based authen_type options, as the insecurity of the latter
will compromise the security of the
former.[¶](#section-10.5.3-3){.pilcrow}

TAC_PLUS_AUTHEN_SENDAUTH and TAC_PLUS_AUTHEN_SENDPASS options mentioned
in \"The Draft\" [SHOULD NOT]{.bcp14} be used due to their security
implications. TACACS+ servers [SHOULD NOT]{.bcp14} implement them. If
they must be implemented, the servers [MUST]{.bcp14} default to the
options being disabled and [MUST]{.bcp14} warn the administrator that
these options are not secure.[¶](#section-10.5.3-4){.pilcrow}
:::
:::

::: {#AuthorizationRecommendations}
::: {#section-10.5.4 .section}
#### [10.5.4.](#section-10.5.4){.section-number .selfRef} [Authorization](#name-authorization-2){.section-name .selfRef} {#name-authorization-2}

The authorization and accounting features are intended to provide
extensibility and flexibility. There is a base dictionary defined in
this document, but it may be extended in deployments by using new
argument names. The cost of the flexibility is that administrators and
implementers [MUST]{.bcp14} ensure that the argument and value pairs
shared between the clients and servers have consistent
interpretation.[¶](#section-10.5.4-1){.pilcrow}

TACACS+ clients that receive an unrecognized mandatory argument
[MUST]{.bcp14} evaluate server response as if they received
TAC_PLUS_AUTHOR_STATUS_FAIL.[¶](#section-10.5.4-2){.pilcrow}
:::
:::

::: {#RedirectionMechanism}
::: {#section-10.5.5 .section}
#### [10.5.5.](#section-10.5.5){.section-number .selfRef} [Redirection Mechanism](#name-redirection-mechanism){.section-name .selfRef} {#name-redirection-mechanism}

\"The Draft\" described a redirection mechanism
(TAC_PLUS_AUTHEN_STATUS_FOLLOW). This feature is difficult to secure.
The option to send secret keys in the server list is particularly
insecure, as it can reveal client shared
secrets.[¶](#section-10.5.5-1){.pilcrow}

TACACS+ servers [MUST]{.bcp14} deprecate the redirection
mechanism.[¶](#section-10.5.5-2){.pilcrow}

If the redirection mechanism is implemented, then TACACS+ servers
[MUST]{.bcp14} disable it by default and [MUST]{.bcp14} warn TACACS+
server administrators that it must only be enabled within a secure
deployment due to the risks of revealing shared
secrets.[¶](#section-10.5.5-3){.pilcrow}

TACACS+ clients [SHOULD]{.bcp14} deprecate this feature by treating
TAC_PLUS_AUTHEN_STATUS_FOLLOW as
TAC_PLUS_AUTHEN_STATUS_FAIL.[¶](#section-10.5.5-4){.pilcrow}
:::
:::
:::
:::
:::
:::

::: {#IANAConsiderations}
::: {#section-11 .section}
## [11.](#section-11){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document has no IANA actions.[¶](#section-11-1){.pilcrow}
:::
:::

::: {#section-12 .section}
## [12.](#section-12){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-12.1 .section}
### [12.1.](#section-12.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC0020\]
:   [Cerf, V.]{.refAuthor}, [\"ASCII format for network
    interchange\"]{.refTitle}, [STD 80]{.seriesInfo}, [RFC
    20]{.seriesInfo}, [DOI 10.17487/RFC0020]{.seriesInfo}, October 1969,
    \<<https://www.rfc-editor.org/info/rfc20>\>.
:   

\[RFC1321\]
:   [Rivest, R.]{.refAuthor}, [\"The MD5 Message-Digest
    Algorithm\"]{.refTitle}, [RFC 1321]{.seriesInfo}, [DOI
    10.17487/RFC1321]{.seriesInfo}, April 1992,
    \<<https://www.rfc-editor.org/info/rfc1321>\>.
:   

\[RFC1334\]
:   [Lloyd, B.]{.refAuthor}[ and W. Simpson]{.refAuthor}, [\"PPP
    Authentication Protocols\"]{.refTitle}, [RFC 1334]{.seriesInfo},
    [DOI 10.17487/RFC1334]{.seriesInfo}, October 1992,
    \<<https://www.rfc-editor.org/info/rfc1334>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC2433\]
:   [Zorn, G.]{.refAuthor}[ and S. Cobb]{.refAuthor}, [\"Microsoft PPP
    CHAP Extensions\"]{.refTitle}, [RFC 2433]{.seriesInfo}, [DOI
    10.17487/RFC2433]{.seriesInfo}, October 1998,
    \<<https://www.rfc-editor.org/info/rfc2433>\>.
:   

\[RFC2759\]
:   [Zorn, G.]{.refAuthor}, [\"Microsoft PPP CHAP Extensions, Version
    2\"]{.refTitle}, [RFC 2759]{.seriesInfo}, [DOI
    10.17487/RFC2759]{.seriesInfo}, January 2000,
    \<<https://www.rfc-editor.org/info/rfc2759>\>.
:   

\[RFC3579\]
:   [Aboba, B.]{.refAuthor}[ and P. Calhoun]{.refAuthor}, [\"RADIUS
    (Remote Authentication Dial In User Service) Support For Extensible
    Authentication Protocol (EAP)\"]{.refTitle}, [RFC
    3579]{.seriesInfo}, [DOI 10.17487/RFC3579]{.seriesInfo}, September
    2003, \<<https://www.rfc-editor.org/info/rfc3579>\>.
:   

\[RFC4086\]
:   [Eastlake 3rd, D.]{.refAuthor}[, Schiller, J.]{.refAuthor}[, and S.
    Crocker]{.refAuthor}, [\"Randomness Requirements for
    Security\"]{.refTitle}, [BCP 106]{.seriesInfo}, [RFC
    4086]{.seriesInfo}, [DOI 10.17487/RFC4086]{.seriesInfo}, June 2005,
    \<<https://www.rfc-editor.org/info/rfc4086>\>.
:   

\[RFC4120\]
:   [Neuman, C.]{.refAuthor}[, Yu, T.]{.refAuthor}[,
    Hartman, S.]{.refAuthor}[, and K. Raeburn]{.refAuthor}, [\"The
    Kerberos Network Authentication Service (V5)\"]{.refTitle}, [RFC
    4120]{.seriesInfo}, [DOI 10.17487/RFC4120]{.seriesInfo}, July 2005,
    \<<https://www.rfc-editor.org/info/rfc4120>\>.
:   

\[RFC5952\]
:   [Kawamura, S.]{.refAuthor}[ and M. Kawashima]{.refAuthor}, [\"A
    Recommendation for IPv6 Address Text Representation\"]{.refTitle},
    [RFC 5952]{.seriesInfo}, [DOI 10.17487/RFC5952]{.seriesInfo}, August
    2010, \<<https://www.rfc-editor.org/info/rfc5952>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8265\]
:   [Saint-Andre, P.]{.refAuthor}[ and A. Melnikov]{.refAuthor},
    [\"Preparation, Enforcement, and Comparison of Internationalized
    Strings Representing Usernames and Passwords\"]{.refTitle}, [RFC
    8265]{.seriesInfo}, [DOI 10.17487/RFC8265]{.seriesInfo}, October
    2017, \<<https://www.rfc-editor.org/info/rfc8265>\>.
:   
:::

::: {#section-12.2 .section}
### [12.2.](#section-12.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[KRB4\]
:   [Miller, S.]{.refAuthor}[, Neuman, C.]{.refAuthor}[,
    Schiller, J.]{.refAuthor}[, and J. Saltzer]{.refAuthor}, [\"Section
    E.2.1: Kerberos Authentication and Authorization
    System\"]{.refTitle}, [MIT Project Athena]{.refContent}, [Cambridge,
    Massachusetts]{.refContent}, December 1987.
:   

\[THE-DRAFT\]
:   [Carrel, D.]{.refAuthor}[ and L. Grant]{.refAuthor}, [\"The TACACS+
    Protocol Version 1.78\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-grant-tacacs-02]{.seriesInfo}, January 1997,
    \<<https://tools.ietf.org/html/draft-grant-tacacs-02>\>.
:   

\[TZDB\]
:   [Eggert, P.]{.refAuthor}[ and A. Olson]{.refAuthor}, [\"Sources for
    Time Zone and Daylight Saving Time Data\"]{.refTitle}, 1987,
    \<<https://www.iana.org/time-zones>\>.
:   
:::
:::

::: {#Acknowledgements}
::: {#section-appendix.a .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The authors would like to thank the following reviewers whose comments
and contributions made considerable improvements to this document: [Alan
DeKok]{.contact-name}, [Alexander Clouter]{.contact-name}, [Chris
Janicki]{.contact-name}, [Tom Petch]{.contact-name}, [Robert
Drake]{.contact-name}, and [John Heasley]{.contact-name}, among many
others.[¶](#section-appendix.a-1){.pilcrow}

The authors would particularly like to thank [Alan
DeKok]{.contact-name}, who provided significant insights and
recommendations on all aspects of the document and the protocol. [Alan
DeKok]{.contact-name} has dedicated considerable time and effort to help
improve the document, identifying weaknesses and providing
remediation.[¶](#section-appendix.a-2){.pilcrow}

The authors would also like to thank the support from the OPSAWG Chairs
and advisors, especially [Joe
Clarke]{.contact-name}.[¶](#section-appendix.a-3){.pilcrow}
:::
:::

::: {#authors-addresses}
::: {#section-appendix.b .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Thorsten Dahm]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Google Inc.]{.org}
:::

::: {.left dir="auto"}
[1600 Amphitheatre Parkway]{.street-address}
:::

::: {.left dir="auto"}
[Mountain View]{.locality}, [CA]{.region} [94043]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <thorstendlux@google.com>
:::

::: {.left dir="auto"}
[Andrej Ota]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Google Inc.]{.org}
:::

::: {.left dir="auto"}
[1600 Amphitheatre Parkway]{.street-address}
:::

::: {.left dir="auto"}
[Mountain View]{.locality}, [CA]{.region} [94043]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <andrej@ota.si>
:::

::: {.left dir="auto"}
[Douglas C. Medway Gash]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco Systems, Inc.]{.org}
:::

::: {.left dir="auto"}
[170 West Tasman Dr.]{.street-address}
:::

::: {.left dir="auto"}
[San Jose]{.locality}, [CA]{.region} [95134]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <dcmgash@cisco.com>
:::

::: {.left dir="auto"}
[David Carrel]{.fn .nameRole}
:::

::: {.left dir="auto"}
[IPsec Research]{.org}
:::

::: email
Email: <carrel@ipsec.org>
:::

::: {.left dir="auto"}
[Lol Grant]{.fn .nameRole}
:::

::: email
Email: <lol.grant@gmail.com>
:::
:::
:::
