  RFC 9270     GMPLS Extensions for SMP   August 2022
  ------------ -------------------------- -------------
  He, et al.   Standards Track            \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9270](https://www.rfc-editor.org/rfc/rfc9270){.eref}

Updates:
:   [4872](https://www.rfc-editor.org/rfc/rfc4872){.eref},
    [4873](https://www.rfc-editor.org/rfc/rfc4873){.eref}

Category:
:   Standards Track

Published:
:   August 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    J. He
    :::

    ::: org
    Huawei Technologies
    :::
    :::

    ::: author
    ::: author-name
    I. Busi
    :::

    ::: org
    Huawei Technologies
    :::
    :::

    ::: author
    ::: author-name
    J. Ryoo
    :::

    ::: org
    ETRI
    :::
    :::

    ::: author
    ::: author-name
    B. Yoon
    :::

    ::: org
    ETRI
    :::
    :::

    ::: author
    ::: author-name
    P. Park
    :::

    ::: org
    KT
    :::
    :::
:::

# RFC 9270 {#rfcnum}

# GMPLS Signaling Extensions for Shared Mesh Protection {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

ITU-T Recommendation G.808.3 defines the generic aspects of a Shared
Mesh Protection (SMP) mechanism, where the difference between SMP and
Shared Mesh Restoration (SMR) is also identified. ITU-T Recommendation
G.873.3 defines the protection switching operation and associated
protocol for SMP at the Optical Data Unit (ODU) layer. RFC 7412 provides
requirements for any mechanism that would be used to implement SMP in a
Multi-Protocol Label Switching - Transport Profile (MPLS-TP)
network.[¶](#section-abstract-1){.pilcrow}

This document updates RFCs 4872 and 4873 to provide extensions for
Generalized Multi-Protocol Label Switching (GMPLS) signaling to support
the control of the SMP mechanism.[¶](#section-abstract-2){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9270>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}

This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November 10,
2008. The person(s) controlling the copyright in some of this material
may not have granted the IETF Trust the right to allow modifications of
such material outside the IETF Standards Process. Without obtaining an
adequate license from the person(s) controlling the copyright in such
materials, this document may not be modified outside the IETF Standards
Process, and derivative works of it may not be created outside the IETF
Standards Process, except to format it for publication as an RFC or to
translate it into languages other than
English.[¶](#section-boilerplate.2-3){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions Used in This
    Document](#name-conventions-used-in-this-do){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [SMP
    Definition](#name-smp-definition){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Operation of SMP with GMPLS Signaling
    Extensions](#name-operation-of-smp-with-gmpls){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [GMPLS Signaling Extensions for
    SMP](#name-gmpls-signaling-extensions-){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Identifiers](#name-identifiers){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Signaling Primary
        LSPs](#name-signaling-primary-lsps){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Signaling Secondary
        LSPs](#name-signaling-secondary-lsps){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [SMP Preemption
        Priority](#name-smp-preemption-priority){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Availability of Shared Resources:
        The Notify Message](#name-availability-of-shared-reso){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [SMP APS
        Configuration](#name-smp-aps-configuration){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Updates to PROTECTION
    Object](#name-updates-to-protection-objec){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [New Protection
        Type](#name-new-protection-type){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Updates to Definitions of
        Notification and Operational
        Bits](#name-updates-to-definitions-of-n){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Preemption
        Priority](#name-preemption-priority){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.9.2.1}
        [9.1](#section-9.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.9.2.2}
        [9.2](#section-9.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.10}
    [](#appendix-A){.xref}[Acknowledgements](#name-acknowledgements){.xref}
    :::

-   ::: {#section-toc.1-1.11}
    [](#appendix-B){.xref}[Contributors](#name-contributors){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [](#appendix-C){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

RFC 4872 \[[RFC4872](#RFC4872){.xref}\] defines extensions for Resource
Reservation Protocol - Traffic Engineering (RSVP-TE) to support Shared
Mesh Restoration (SMR) mechanisms. SMR can be seen as a particular case
of preplanned Label Switched Path (LSP) rerouting that reduces the
recovery resource requirements by allowing multiple protecting LSPs to
share common link and node resources. The recovery resources for the
protecting LSPs are pre-reserved during the provisioning phase, and
explicit restoration signaling is required to activate (i.e., commit
resource allocation at the data plane) a specific protecting LSP that
was instantiated during the provisioning phase. RFC 4873
\[[RFC4873](#RFC4873){.xref}\] details the encoding of the last 32-bit
Reserved field of the PROTECTION object defined in
\[[RFC4872](#RFC4872){.xref}\].[¶](#section-1-1){.pilcrow}

ITU-T Recommendation G.808.3 \[[G808.3](#G808.3){.xref}\] defines the
generic aspects of a Shared Mesh Protection (SMP) mechanism, which are
not specific to a particular network technology in terms of architecture
types, preemption principle, path monitoring methods, etc. ITU-T
Recommendation G.873.3 \[[G873.3](#G873.3){.xref}\] defines the
protection switching operation and associated protocol for SMP at the
Optical Data Unit (ODU) layer. RFC 7412 \[[RFC7412](#RFC7412){.xref}\]
provides requirements for any mechanism that would be used to implement
SMP in a Multi-Protocol Label Switching - Transport Profile (MPLS-TP)
network.[¶](#section-1-2){.pilcrow}

SMP differs from SMR in the activation/protection switching operation.
The former activates a protecting LSP via the Automatic Protection
Switching (APS) protocol in the data plane when the working LSP fails,
while the latter does it via control plane signaling. It is therefore
necessary to distinguish SMP from SMR during provisioning so that each
node involved behaves appropriately in the recovery phase when
activation of a protecting LSP is done. SMP has advantages with regard
to the recovery speed compared with SMR.[¶](#section-1-3){.pilcrow}

This document updates \[[RFC4872](#RFC4872){.xref}\] and
\[[RFC4873](#RFC4873){.xref}\] to provide extensions for Generalized
Multi-Protocol Label Switching (GMPLS) signaling to support the control
of the SMP mechanism. Specifically, it[¶](#section-1-4){.pilcrow}

-   [defines a new LSP Protection Type, \"Shared Mesh Protection\", for
    the LSP Flags field \[[RFC4872](#RFC4872){.xref}\] of the PROTECTION
    object (see [Section
    6.1](#secUpPt){.xref}),[¶](#section-1-5.1){.pilcrow}]{#section-1-5.1}
-   [updates the definitions of the Notification (N) and Operational (O)
    fields \[[RFC4872](#RFC4872){.xref}\] of the PROTECTION object to
    take the new SMP type into account (see [Section
    6.2](#secUpNO){.xref}),
    and[¶](#section-1-5.2){.pilcrow}]{#section-1-5.2}
-   [updates the definition of the 16-bit Reserved field
    \[[RFC4873](#RFC4873){.xref}\] of the PROTECTION object to allocate
    8 bits to signal the SMP preemption priority (see [Section
    6.3](#secUpPP){.xref}).[¶](#section-1-5.3){.pilcrow}]{#section-1-5.3}

Only the generic aspects for signaling SMP are addressed by this
document. The technology-specific aspects are expected to be addressed
by other documents.[¶](#section-1-6){.pilcrow}

RFC 8776 \[[RFC8776](#RFC8776){.xref}\] defines a collection of common
YANG data types for Traffic Engineering (TE) configuration and state
capabilities. It defines several identities for LSP Protection Types. As
this document introduces a new LSP Protection Type,
\[[RFC8776](#RFC8776){.xref}\] is expected to be updated to support the
SMP mechanism specified in this document. \[[YANG-TE](#YANG-TE){.xref}\]
defines a YANG data model for the provisioning and management of TE
tunnels, LSPs, and interfaces. It includes some protection and
restoration data nodes relevant to this document. Management aspects of
the SMP mechanism are outside the scope of this document, and they are
expected to be addressed by other documents.[¶](#section-1-7){.pilcrow}
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions Used in This Document](#name-conventions-used-in-this-do){.section-name .selfRef} {#name-conventions-used-in-this-do}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

In addition, the reader is assumed to be familiar with the terminology
used in \[[RFC4872](#RFC4872){.xref}\], RFC 4426
\[[RFC4426](#RFC4426){.xref}\], and RFC 6372
\[[RFC6372](#RFC6372){.xref}\].[¶](#section-2-2){.pilcrow}
:::

::: {#secDef}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [SMP Definition](#name-smp-definition){.section-name .selfRef} {#name-smp-definition}

\[[G808.3](#G808.3){.xref}\] defines the generic aspects of an SMP
mechanism. \[[G873.3](#G873.3){.xref}\] defines the protection switching
operation and associated protocol for SMP at the ODU layer.
\[[RFC7412](#RFC7412){.xref}\] provides requirements for any mechanism
that would be used to implement SMP in an MPLS-TP
network.[¶](#section-3-1){.pilcrow}

The SMP mechanism is based on precomputed protecting LSPs that are
preconfigured into the network elements. Preconfiguration here means
pre-reserving resources for the protecting LSPs without activating a
particular protecting LSP (e.g., in circuit networks, the cross-connects
in the intermediate nodes of the protecting LSP are not preestablished).
Preconfiguring but not activating protecting LSPs allows link and node
resources to be shared by the protecting LSPs of multiple working LSPs
(which are themselves disjoint and thus unlikely to fail
simultaneously). Protecting LSPs are activated in response to failures
of working LSPs or operator commands by means of the APS protocol, which
operates in the data plane. The APS protocol messages are exchanged
along the protecting LSP. SMP is always
revertive.[¶](#section-3-2){.pilcrow}

SMP is very similar to SMR, except that activation in the case of SMR is
achieved by control plane signaling during the recovery operation, while
the same is done for SMP by the APS protocol in the data
plane.[¶](#section-3-3){.pilcrow}
:::
:::

::: {#secSmpOper}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Operation of SMP with GMPLS Signaling Extensions](#name-operation-of-smp-with-gmpls){.section-name .selfRef} {#name-operation-of-smp-with-gmpls}

Consider the network topology shown in [Figure
1](#figEx){.xref}:[¶](#section-4-1){.pilcrow}

[]{#name-an-example-of-an-smp-topolo}

::: {#figEx}
::: {#section-4-2.1 .alignLeft .art-text .artwork}
                              A---B---C---D
                               \         /
                                E---F---G
                               /         \
                              H---I---J---K
:::

[Figure 1](#figure-1){.selfRef}: [An Example of an SMP
Topology](#name-an-example-of-an-smp-topolo){.selfRef}
:::

The working LSPs \[A,B,C,D\] and \[H,I,J,K\] could be protected by the
protecting LSPs \[A,E,F,G,D\] and \[H,E,F,G,K\], respectively. Per RFC
3209 \[[RFC3209](#RFC3209){.xref}\], in order to achieve resource
sharing during the signaling of these protecting LSPs, they have the
same Tunnel Endpoint Address (as part of their SESSION object). However,
these addresses are not the same in this example. Similar to SMR, this
document defines a new LSP Protection Type of the secondary LSP as
\"Shared Mesh Protection\" (see [Section 6.1](#secUpPt){.xref}) to allow
resource sharing along nodes E, F, and G. Examples of shared resources
include the capacity of a link and the cross-connects in a node. In this
case, the protecting LSPs are not merged (which is useful, since the
paths diverge at G), but the resources along E, F, and G can be
shared.[¶](#section-4-3){.pilcrow}

When a failure, such as Signal Fail (SF) or Signal Degrade (SD), occurs
on one of the working LSPs (say, working LSP \[A,B,C,D\]), the end node
(say, node A) that detects the failure initiates the protection
switching operation. End node A will send a protection switching request
APS message (for example, SF) to its adjacent (downstream) intermediate
node (say, node E) to activate the corresponding protecting LSP and will
wait for a confirmation message from node E.[¶](#section-4-4){.pilcrow}

If the protection resource is available, node E will send the
confirmation APS message to the end node (node A) and forward the
switching request APS message to its adjacent (downstream) node (say,
node F). When the confirmation APS message is received by node A, the
cross-connection on node A is established. At this time, traffic is
bridged to and selected from the protecting LSP at node A. After
forwarding the switching request APS message, node E will wait for a
confirmation APS message from node F, which triggers node E to set up
the cross-connection for the protecting LSP being
activated.[¶](#section-4-5){.pilcrow}

If the protection resource is not available (due to failure or being
used by higher-priority connections), the switching will not be
successful; the intermediate node (node E) [MUST]{.bcp14} send a message
to notify the end node (node A) (see [Section
5.5](#secGmplsNotify){.xref}). If the resource is in use by a
lower-priority protecting LSP, the lower-priority service will be
removed, and the intermediate node will then follow the procedure as
described for the case when the protection resource is available for the
higher-priority protecting LSP.[¶](#section-4-6){.pilcrow}

If node E fails to allocate the protection resource, it [MUST]{.bcp14}
send a message to notify node A (see [Section
5.5](#secGmplsNotify){.xref}). Then, node A will stop bridging and
selecting traffic to/from the protecting LSP and proceed with the
procedure of removing the protection allocation according to the APS
protocol.[¶](#section-4-7){.pilcrow}
:::
:::

::: {#secGmpls}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [GMPLS Signaling Extensions for SMP](#name-gmpls-signaling-extensions-){.section-name .selfRef} {#name-gmpls-signaling-extensions-}

The following subsections detail how LSPs using SMP can be signaled in
an interoperable fashion using GMPLS RSVP-TE extensions (see RFC 3473
\[[RFC3473](#RFC3473){.xref}\]). This signaling
enables:[¶](#section-5-1){.pilcrow}

[]{.break}

\(1\)
:   the ability to identify a \"secondary protecting LSP\" (LSP
    \[A,E,F,G,D\] or LSP \[H,E,F,G,K\] from [Figure 1](#figEx){.xref},
    here called the \"secondary LSP\") used to recover another \"primary
    working LSP\" (LSP \[A,B,C,D\] or LSP \[H,I,J,K\] from [Figure
    1](#figEx){.xref}, here called the \"protected
    LSP\"),[¶](#section-5-2.1){.pilcrow}
:   

\(2\)
:   the ability to associate the secondary LSP with the protected
    LSP,[¶](#section-5-2.2){.pilcrow}
:   

\(3\)
:   the capability to include information about the resources used by
    the protected LSP while instantiating the secondary
    LSP,[¶](#section-5-2.3){.pilcrow}
:   

\(4\)
:   the capability to instantiate several secondary LSPs efficiently
    during the provisioning phase, and[¶](#section-5-2.4){.pilcrow}
:   

\(5\)
:   the capability to support activation of a secondary LSP via the APS
    protocol in the data plane if a failure
    occurs.[¶](#section-5-2.5){.pilcrow}
:   

::: {#secGmplsId}
::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Identifiers](#name-identifiers){.section-name .selfRef} {#name-identifiers}

To simplify association operations, both LSPs (i.e., the protected LSP
and the secondary LSP) belong to the same session. Thus, the SESSION
object [MUST]{.bcp14} be the same for both LSPs. The LSP ID, however,
[MUST]{.bcp14} be different to distinguish between the protected LSP and
the secondary LSP.[¶](#section-5.1-1){.pilcrow}

A new LSP Protection Type, \"Shared Mesh Protection\", is defined (see
[Section 6.1](#secUpPt){.xref}) for the LSP Flags field of the
PROTECTION object (see \[[RFC4872](#RFC4872){.xref}\]) to set up the two
LSPs. This LSP Protection Type value is only applicable to bidirectional
LSPs as required in
\[[G808.3](#G808.3){.xref}\].[¶](#section-5.1-2){.pilcrow}
:::
:::

::: {#secGmplsPrim}
::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Signaling Primary LSPs](#name-signaling-primary-lsps){.section-name .selfRef} {#name-signaling-primary-lsps}

The PROTECTION object (see \[[RFC4872](#RFC4872){.xref}\]) is included
in the Path message during signaling of the primary working LSPs, with
the LSP Protection Type value set to \"Shared Mesh
Protection\".[¶](#section-5.2-1){.pilcrow}

Primary working LSPs are signaled by setting in the PROTECTION object
the S bit to 0, the P bit to 0, and the N bit to 1; and setting in the
ASSOCIATION object the Association ID to the associated secondary
protecting LSP_ID.[¶](#section-5.2-2){.pilcrow}

Note: The N bit is set to indicate that the protection switching
signaling is done via the data plane.[¶](#section-5.2-3.1){.pilcrow}
:::
:::

::: {#secGmplsSecd}
::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Signaling Secondary LSPs](#name-signaling-secondary-lsps){.section-name .selfRef} {#name-signaling-secondary-lsps}

The PROTECTION object (see \[[RFC4872](#RFC4872){.xref}\]) is included
in the Path message during signaling of the secondary protecting LSPs,
with the LSP Protection Type value set to \"Shared Mesh
Protection\".[¶](#section-5.3-1){.pilcrow}

Secondary protecting LSPs are signaled by setting in the PROTECTION
object the S bit, the P bit, and the N bit to 1; and setting in the
ASSOCIATION object the Association ID to the associated primary working
LSP_ID, which [MUST]{.bcp14} be known before signaling of the secondary
LSP. Moreover, the Path message used to instantiate the secondary LSP
[MUST]{.bcp14} include at least one PRIMARY_PATH_ROUTE object (see
\[[RFC4872](#RFC4872){.xref}\]) that further allows for recovery
resource sharing at each intermediate node along the secondary
path.[¶](#section-5.3-2){.pilcrow}

With this setting, the resources for the secondary LSP [MUST]{.bcp14} be
pre-reserved but not committed at the data plane level, meaning that the
internals of the switch need not be established until explicit action is
taken to activate this LSP. Activation of a secondary LSP and protection
switching to the activated protecting LSP is done using the APS protocol
in the data plane.[¶](#section-5.3-3){.pilcrow}

After protection switching completes, the protecting LSP [MUST]{.bcp14}
be signaled by setting the S bit to 0 and the O bit to 1 in the
PROTECTION object. At this point, the link and node resources
[MUST]{.bcp14} be allocated for this LSP, which becomes a primary LSP
(ready to carry traffic). The formerly working LSP [MAY]{.bcp14} be
signaled with the A bit set in the ADMIN_STATUS object (see
\[[RFC3473](#RFC3473){.xref}\]).[¶](#section-5.3-4){.pilcrow}

Support for extra traffic in SMP is left for further study. Therefore,
mechanisms to set up LSPs for extra traffic are outside the scope of
this document.[¶](#section-5.3-5){.pilcrow}
:::
:::

::: {#secGmplsPrio}
::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [SMP Preemption Priority](#name-smp-preemption-priority){.section-name .selfRef} {#name-smp-preemption-priority}

The SMP preemption priority of a protecting LSP is used by the APS
protocol to resolve competition for shared resources among multiple
protecting LSPs and is indicated in the Preemption Priority field of the
PROTECTION object in the Path message of the protecting
LSP.[¶](#section-5.4-1){.pilcrow}

The Setup and Holding priorities in the SESSION_ATTRIBUTE object can be
used by GMPLS to control LSP preemption, but they are not used by the
APS to resolve competition among multiple protecting LSPs. This avoids
the need to define a complex policy for defining Setup and Holding
priorities when used for both GMPLS control plane LSP preemption and SMP
shared resource competition resolution.[¶](#section-5.4-2){.pilcrow}

When an intermediate node on the protecting LSP receives the Path
message, the priority value in the Preemption Priority field
[MUST]{.bcp14} be stored for that protecting LSP. When resource
competition among multiple protecting LSPs occurs, the APS protocol will
use their priority values to resolve this competition. A lower value has
a higher priority.[¶](#section-5.4-3){.pilcrow}

In SMP, a preempted LSP [MUST NOT]{.bcp14} be terminated even after its
resources have been deallocated. Once the working LSP and the protecting
LSP are configured or preconfigured, the end node [MUST]{.bcp14} keep
refreshing both working and protecting LSPs, regardless of failure or
preemption status.[¶](#section-5.4-4){.pilcrow}
:::
:::

::: {#secGmplsNotify}
::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Availability of Shared Resources: The Notify Message](#name-availability-of-shared-reso){.section-name .selfRef} {#name-availability-of-shared-reso}

When a lower-priority protecting LSP is preempted, the intermediate node
that performed the preemption [MUST]{.bcp14} send a Notify message with
error code \"Notify Error\" (25) (see \[[RFC4872](#RFC4872){.xref}\])
and error sub-code \"Shared resources unavailable\" (17) to the end
nodes of that protecting LSP. Upon receipt of this Notify message, the
end node [MUST]{.bcp14} stop sending and selecting traffic to/from its
protecting LSP and try switching the traffic to another protecting LSP,
if available.[¶](#section-5.5-1){.pilcrow}

When a protecting LSP occupies the shared resources and they become
unavailable, the same Notify message [MUST]{.bcp14} be generated by the
intermediate node to all the end nodes of the protecting LSPs that have
lower SMP preemption priorities than the one that has occupied the
shared resources. If the shared resources become unavailable due to a
failure in the shared resources, the same Notify message [MUST]{.bcp14}
be generated by the intermediate node to all the end nodes of the
protecting LSPs that have been configured to use the shared resources.
In the case of a failure of the working LSP, these end nodes
[MUST]{.bcp14} avoid trying to switch traffic to these protecting LSPs
that have been configured to use the shared resources and try switching
the traffic to other protecting LSPs, if
available.[¶](#section-5.5-2){.pilcrow}

When the shared resources become available, a Notify message with error
code \"Notify Error\" (25) and error sub-code \"Shared resources
available\" (18) [MUST]{.bcp14} be generated by the intermediate node.
The recipients of this Notify message are the end nodes of the
lower-priority protecting LSPs that have been preempted and/or all the
end nodes of the protecting LSPs that have lower SMP preemption
priorities than the one that does not need the shared resources anymore.
Upon receipt of this Notify message, the end node is allowed to
reinitiate the protection switching operation as described in [Section
4](#secSmpOper){.xref}, if it still needs the protection
resource.[¶](#section-5.5-3){.pilcrow}
:::
:::

::: {#secGmplsAps}
::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [SMP APS Configuration](#name-smp-aps-configuration){.section-name .selfRef} {#name-smp-aps-configuration}

SMP relies on APS protocol messages being exchanged between the nodes
along the path to activate a protecting
LSP.[¶](#section-5.6-1){.pilcrow}

In order to allow the exchange of APS protocol messages, an APS channel
has to be configured between adjacent nodes along the path of the
protecting LSP. This is done by means other than GMPLS signaling, before
any protecting LSP has been set up. Therefore, there are likely
additional requirements for APS configuration that are outside the scope
of this document.[¶](#section-5.6-2){.pilcrow}

Depending on the APS protocol message format, the APS protocol may use
different identifiers than GMPLS signaling to identify the protecting
LSP.[¶](#section-5.6-3){.pilcrow}

Since the APS protocol is left for further study per
\[[G808.3](#G808.3){.xref}\], it can be assumed that the APS message
format and identifiers are technology specific and/or vendor specific.
Therefore, additional requirements for APS configuration are outside the
scope of this document.[¶](#section-5.6-4){.pilcrow}
:::
:::
:::
:::

::: {#secUp}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Updates to PROTECTION Object](#name-updates-to-protection-objec){.section-name .selfRef} {#name-updates-to-protection-objec}

GMPLS extension requirements for SMP introduce several updates to the
PROTECTION object (see \[[RFC4872](#RFC4872){.xref}\]), as detailed
below.[¶](#section-6-1){.pilcrow}

::: {#secUpPt}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [New Protection Type](#name-new-protection-type){.section-name .selfRef} {#name-new-protection-type}

A new LSP Protection Type, \"Shared Mesh Protection\", is added in the
PROTECTION object. This LSP Protection Type value is only applicable to
bidirectional LSPs.[¶](#section-6.1-1){.pilcrow}

LSP (Protection Type) Flags:[¶](#section-6.1-2){.pilcrow}

0x20: Shared Mesh Protection[¶](#section-6.1-3){.pilcrow}

The rules defined in [Section
14.2](https://www.rfc-editor.org/rfc/rfc4872#section-14.2){.relref} of
\[[RFC4872](#RFC4872){.xref}\] ensure that all the nodes along an SMP
LSP are SMP aware. Therefore, there are no backward-compatibility
issues.[¶](#section-6.1-4){.pilcrow}
:::
:::

::: {#secUpNO}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Updates to Definitions of Notification and Operational Bits](#name-updates-to-definitions-of-n){.section-name .selfRef} {#name-updates-to-definitions-of-n}

The definitions of the N and O bits in [Section
14.1](https://www.rfc-editor.org/rfc/rfc4872#section-14.1){.relref} of
\[[RFC4872](#RFC4872){.xref}\] are replaced as
follows:[¶](#section-6.2-1){.pilcrow}

Notification (N): 1 bit[¶](#section-6.2-2){.pilcrow}

When set to 1, this bit indicates that the control plane message
exchange is only used for notification during protection switching. When
set to 0 (default), it indicates that the control plane message
exchanges are used for purposes of protection switching. The N bit is
only applicable when the LSP Protection Type Flag is set to 0x04 (1:N
Protection with Extra-Traffic), 0x08 (1+1 Unidirectional Protection),
0x10 (1+1 Bidirectional Protection), or 0x20 (Shared Mesh Protection).
The N bit [MUST]{.bcp14} be set to 0 in any other case. If 0x20 (SMP),
the N bit [MUST]{.bcp14} be set to 1.[¶](#section-6.2-3){.pilcrow}

Operational (O): 1 bit[¶](#section-6.2-4){.pilcrow}

When set to 1, this bit indicates that the protecting LSP is carrying
traffic after protection switching. The O bit is only applicable when
(1) the P bit is set to 1 and (2) the LSP Protection Type Flag is set to
0x04 (1:N Protection with Extra-Traffic), 0x08 (1+1 Unidirectional
Protection), 0x10 (1+1 Bidirectional Protection), or 0x20 (Shared Mesh
Protection). The O bit [MUST]{.bcp14} be set to 0 in any other
case.[¶](#section-6.2-5){.pilcrow}
:::
:::

::: {#secUpPP}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Preemption Priority](#name-preemption-priority){.section-name .selfRef} {#name-preemption-priority}

\[[RFC4872](#RFC4872){.xref}\] reserved a 32-bit field in the PROTECTION
object header. Subsequently, \[[RFC4873](#RFC4873){.xref}\] allocated
several bits from that field and left the remainder of the bits
reserved. This specification further allocates the Preemption Priority
field from the remaining formerly reserved bits. The 32-bit field in the
PROTECTION object as defined in \[[RFC4872](#RFC4872){.xref}\] and
modified by \[[RFC4873](#RFC4873){.xref}\] is updated by this document
as follows:[¶](#section-6.3-1){.pilcrow}

::: {#section-6.3-2 .alignLeft .art-text .artwork}
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |I|R|   Reserved    | Seg.Flags |   Reserved    | Preempt Prio  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

[¶](#section-6.3-2){.pilcrow}
:::

Preemption Priority (Preempt Prio): 8 bits[¶](#section-6.3-3){.pilcrow}

This field indicates the SMP preemption priority of a protecting LSP,
when the LSP Protection Type field indicates \"Shared Mesh Protection\".
The SMP preemption priority value is configured at the end nodes of the
protecting LSP by a network operator. A lower value has a higher
priority. The decision regarding how many priority levels should be
implemented in an SMP network is left to network
operators.[¶](#section-6.3-4){.pilcrow}

See \[[RFC4873](#RFC4873){.xref}\] for the definitions of the other
fields.[¶](#section-6.3-5){.pilcrow}
:::
:::
:::
:::

::: {#secIANA}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

IANA maintains a group of registries called \"Resource Reservation
Protocol (RSVP) Parameters\", which includes the \"Error Codes and
Globally-Defined Error Value Sub-Codes\" registry. IANA has added the
following values to the \"Sub-Codes - 25 Notify Error\" subregistry,
which lists error value sub-codes that may be used with error code 25.
IANA has allocated the following error value sub-codes ([Table
1](#tab-1){.xref}) for use with this error code as described in this
document.[¶](#section-7-1){.pilcrow}

[]{#name-new-error-sub-codes}

::: {#tab-1}
  Value   Description                    Reference
  ------- ------------------------------ -----------
  17      Shared resources unavailable   RFC 9270
  18      Shared resources available     RFC 9270

  : [Table 1](#table-1){.selfRef}: [New Error
  Sub-Codes](#name-new-error-sub-codes){.selfRef}
:::
:::
:::

::: {#secSec}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

Since this document makes use of the exchange of RSVP messages that
include a Notify message, the security threats discussed in
\[[RFC4872](#RFC4872){.xref}\] also apply to this
document.[¶](#section-8-1){.pilcrow}

Additionally, it may be possible to cause disruption to traffic on one
protecting LSP by targeting a link used by the primary LSP of another,
higher-priority LSP somewhere completely different in the network. For
example, in [Figure 1](#figEx){.xref}, assume that the preemption
priority of LSP \[A,E,F,G,D\] is higher than that of LSP \[H,E,F,G,K\]
and the protecting LSP \[H,E,F,G,K\] is being used to transport traffic.
If link B-C is attacked, traffic on LSP \[H,E,F,G,K\] can be disrupted.
For this reason, it is important not only to use security mechanisms as
discussed in \[[RFC4872](#RFC4872){.xref}\] but also to acknowledge that
detailed knowledge of a network\'s topology, including routes and
priorities of LSPs, can help an attacker better target or improve the
efficacy of an attack.[¶](#section-8-2){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-9.1 .section}
### [9.1.](#section-9.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[G808.3\]
:   [International Telecommunication Union]{.refAuthor}, [\"Generic
    protection switching - Shared mesh protection\"]{.refTitle}, [ITU-T
    Recommendation G.808.3]{.refContent}, October 2012,
    \<<https://www.itu.int/rec/T-REC-G.808.3>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3209\]
:   [Awduche, D.]{.refAuthor}, [Berger, L.]{.refAuthor},
    [Gan, D.]{.refAuthor}, [Li, T.]{.refAuthor},
    [Srinivasan, V.]{.refAuthor}, and [G. Swallow]{.refAuthor},
    [\"RSVP-TE: Extensions to RSVP for LSP Tunnels\"]{.refTitle}, [RFC
    3209]{.seriesInfo}, [DOI 10.17487/RFC3209]{.seriesInfo}, December
    2001, \<<https://www.rfc-editor.org/info/rfc3209>\>.
:   

\[RFC3473\]
:   [Berger, L., Ed.]{.refAuthor}, [\"Generalized Multi-Protocol Label
    Switching (GMPLS) Signaling Resource ReserVation Protocol-Traffic
    Engineering (RSVP-TE) Extensions\"]{.refTitle}, [RFC
    3473]{.seriesInfo}, [DOI 10.17487/RFC3473]{.seriesInfo}, January
    2003, \<<https://www.rfc-editor.org/info/rfc3473>\>.
:   

\[RFC4426\]
:   [Lang, J., Ed.]{.refAuthor}, [Rajagopalan, B., Ed.]{.refAuthor}, and
    [D. Papadimitriou, Ed.]{.refAuthor}, [\"Generalized Multi-Protocol
    Label Switching (GMPLS) Recovery Functional
    Specification\"]{.refTitle}, [RFC 4426]{.seriesInfo}, [DOI
    10.17487/RFC4426]{.seriesInfo}, March 2006,
    \<<https://www.rfc-editor.org/info/rfc4426>\>.
:   

\[RFC4872\]
:   [Lang, J P., Ed.]{.refAuthor}, [Rekhter, Y., Ed.]{.refAuthor}, and
    [D. Papadimitriou, Ed.]{.refAuthor}, [\"RSVP-TE Extensions in
    Support of End-to-End Generalized Multi-Protocol Label Switching
    (GMPLS) Recovery\"]{.refTitle}, [RFC 4872]{.seriesInfo}, [DOI
    10.17487/RFC4872]{.seriesInfo}, May 2007,
    \<<https://www.rfc-editor.org/info/rfc4872>\>.
:   

\[RFC4873\]
:   [Berger, L.]{.refAuthor}, [Bryskin, I.]{.refAuthor},
    [Papadimitriou, D.]{.refAuthor}, and [A. Farrel]{.refAuthor},
    [\"GMPLS Segment Recovery\"]{.refTitle}, [RFC 4873]{.seriesInfo},
    [DOI 10.17487/RFC4873]{.seriesInfo}, May 2007,
    \<<https://www.rfc-editor.org/info/rfc4873>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   
:::

::: {#section-9.2 .section}
### [9.2.](#section-9.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[G873.3\]
:   [International Telecommunication Union]{.refAuthor}, [\"Optical
    transport network - Shared mesh protection\"]{.refTitle}, [ITU-T
    Recommendation G.873.3]{.refContent}, September 2017,
    \<<https://www.itu.int/rec/T-REC-G.873.3-201709-I/en>\>.
:   

\[RFC6372\]
:   [Sprecher, N., Ed.]{.refAuthor} and [A. Farrel, Ed.]{.refAuthor},
    [\"MPLS Transport Profile (MPLS-TP) Survivability
    Framework\"]{.refTitle}, [RFC 6372]{.seriesInfo}, [DOI
    10.17487/RFC6372]{.seriesInfo}, September 2011,
    \<<https://www.rfc-editor.org/info/rfc6372>\>.
:   

\[RFC7412\]
:   [Weingarten, Y.]{.refAuthor}, [Aldrin, S.]{.refAuthor},
    [Pan, P.]{.refAuthor}, [Ryoo, J.]{.refAuthor}, and [G.
    Mirsky]{.refAuthor}, [\"Requirements for MPLS Transport Profile
    (MPLS-TP) Shared Mesh Protection\"]{.refTitle}, [RFC
    7412]{.seriesInfo}, [DOI 10.17487/RFC7412]{.seriesInfo}, December
    2014, \<<https://www.rfc-editor.org/info/rfc7412>\>.
:   

\[RFC8776\]
:   [Saad, T.]{.refAuthor}, [Gandhi, R.]{.refAuthor},
    [Liu, X.]{.refAuthor}, [Beeram, V.]{.refAuthor}, and [I.
    Bryskin]{.refAuthor}, [\"Common YANG Data Types for Traffic
    Engineering\"]{.refTitle}, [RFC 8776]{.seriesInfo}, [DOI
    10.17487/RFC8776]{.seriesInfo}, June 2020,
    \<<https://www.rfc-editor.org/info/rfc8776>\>.
:   

\[YANG-TE\]
:   [Saad, T.]{.refAuthor}, [Gandhi, R.]{.refAuthor},
    [Liu, X.]{.refAuthor}, [Beeram, V.P.]{.refAuthor},
    [Bryskin, I.]{.refAuthor}, and [O. Gonzalez de Dios]{.refAuthor},
    [\"A YANG Data Model for Traffic Engineering Tunnels, Label Switched
    Paths and Interfaces\"]{.refTitle}, [Work in Progress]{.refContent},
    [Internet-Draft, draft-ietf-teas-yang-te-30]{.seriesInfo}, 11 July
    2022,
    \<<https://datatracker.ietf.org/doc/html/draft-ietf-teas-yang-te-30>\>.
:   
:::
:::

::: {#Acknowledgements}
::: {#appendix-A .section}
## [Acknowledgements](#name-acknowledgements){.section-name .selfRef} {#name-acknowledgements}

The authors would like to thank [Adrian Farrel]{.contact-name}, [Vishnu
Pavan Beeram]{.contact-name}, [Tom Petch]{.contact-name}, [Ines
Robles]{.contact-name}, [John Scudder]{.contact-name}, [Dale
Worley]{.contact-name}, [Dan Romascanu]{.contact-name}, [Éric
Vyncke]{.contact-name}, [Roman Danyliw]{.contact-name}, [Paul
Wouters]{.contact-name}, [Lars Eggert]{.contact-name}, [Francesca
Palombini]{.contact-name}, and [Robert Wilton]{.contact-name} for their
valuable comments and suggestions on this
document.[¶](#appendix-A-1){.pilcrow}
:::
:::

::: {#secCon}
::: {#appendix-B .section}
## [Contributors](#name-contributors){.section-name .selfRef} {#name-contributors}

The following person contributed significantly to the content of this
document and should be considered a
coauthor.[¶](#appendix-B-1){.pilcrow}

::: {.left dir="auto"}
[Yuji Tochio]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Fujitsu]{.org}
:::

::: email
Email: <tochio@fujitsu.com>
:::
:::
:::

::: {#authors-addresses}
::: {#appendix-C .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Jia He]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: {.left dir="auto"}
[F3-1B, R&D Center, Huawei Industrial Base\
Bantian, Longgang District]{.street-address}
:::

::: {.left dir="auto"}
[Shenzhen]{.locality}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <hejia@huawei.com>
:::

::: {.left dir="auto"}
[Italo Busi]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Huawei Technologies]{.org}
:::

::: email
Email: <italo.busi@huawei.com>
:::

::: {.left dir="auto"}
[Jeong-dong Ryoo]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ETRI]{.org}
:::

::: {.left dir="auto"}
[218 Gajeongno]{.street-address}
:::

::: {.left dir="auto"}
[Yuseong-gu]{.locality}
:::

::: {.left dir="auto"}
[Daejeon]{.region}
:::

::: {.left dir="auto"}
[34129]{.postal-code}
:::

::: {.left dir="auto"}
[South Korea]{.country-name}
:::

::: tel
Phone: [+82-42-860-5384](tel:+82-42-860-5384){.tel}
:::

::: email
Email: <ryoo@etri.re.kr>
:::

::: {.left dir="auto"}
[Bin Yeong Yoon]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ETRI]{.org}
:::

::: email
Email: <byyun@etri.re.kr>
:::

::: {.left dir="auto"}
[Peter Park]{.fn .nameRole}
:::

::: {.left dir="auto"}
[KT]{.org}
:::

::: email
Email: <peter.park@kt.com>
:::
:::
:::
