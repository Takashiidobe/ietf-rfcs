  RFC 9034         6lo Delivery Deadline Time   June 2021
  ---------------- ---------------------------- -----------
  Thomas, et al.   Standards Track              \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9034](https://www.rfc-editor.org/rfc/rfc9034){.eref}

Category:
:   Standards Track

Published:
:   June 2021

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    L. Thomas
    :::

    ::: org
    C-DAC
    :::
    :::

    ::: author
    ::: author-name
    S. Anamalamudi
    :::

    ::: org
    SRM University-AP
    :::
    :::

    ::: author
    ::: author-name
    S.V.R. Anand
    :::

    ::: org
    Indian Institute of Science
    :::
    :::

    ::: author
    ::: author-name
    M. Hegde
    :::

    ::: org
    Indian Institute of Science
    :::
    :::

    ::: author
    ::: author-name
    C. Perkins
    :::

    ::: org
    Lupin Lodge
    :::
    :::
:::

# RFC 9034 {#rfcnum}

# Packet Delivery Deadline Time in the Routing Header for IPv6 over Low‑Power Wireless Personal Area Networks (6LoWPANs) {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

This document specifies a new type for the 6LoWPAN routing header
containing the deadline time for data packets, designed for use over
constrained networks. The deadline time enables forwarding and
scheduling decisions for time-critical machine-to-machine (M2M)
applications running on Internet-enabled devices that operate within
time-synchronized networks. This document also specifies a
representation for the deadline time values in such
networks.[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9034>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2021 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Simplified BSD License text as described in Section 4.e of the Trust
Legal Provisions and are provided without warranty as described in the
Simplified BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Terminology](#name-terminology){.xref}
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [6LoRHE Generic
    Format](#name-6lorhe-generic-format){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [Deadline-6LoRHE](#name-deadline-6lorhe){.xref}
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Deadline-6LoRHE
    Format](#name-deadline-6lorhe-format){.xref}
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [Deadline-6LoRHE in Three Network
    Scenarios](#name-deadline-6lorhe-in-three-ne){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [Scenario 1: Endpoints in the Same
        DODAG (N1)](#name-scenario-1-endpoints-in-the){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Scenario 2: Endpoints in Networks
        with Dissimilar L2
        Technologies](#name-scenario-2-endpoints-in-net){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Scenario 3: Packet Transmission
        across Different DODAGs (N1 to
        N2)](#name-scenario-3-packet-transmiss){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.8}
    [8](#section-8){.xref}.  [Synchronization
    Aspects](#name-synchronization-aspects){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [9](#section-9){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}
    :::

-   ::: {#section-toc.1-1.10}
    [10](#section-10){.xref}. [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.10.2.1}
        [10.1](#section-10.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.10.2.2}
        [10.2](#section-10.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.11}
    [Appendix A](#section-appendix.a){.xref}.  [Modular Arithmetic
    Considerations](#name-modular-arithmetic-consider){.xref}
    :::

-   ::: {#section-toc.1-1.12}
    [](#section-appendix.b){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.13}
    [](#section-appendix.c){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#Intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

Low-Power and Lossy Networks (LLNs) are likely to be deployed for
real-time industrial applications requiring end-to-end delay guarantees
\[[RFC8578](#RFC8578){.xref}\]. A Deterministic Network (\"DetNet\")
typically requires some data packets to reach their receivers within
strict time bounds. Intermediate nodes use the deadline information to
make appropriate packet forwarding and scheduling decisions to meet the
time bounds.[¶](#section-1-1){.pilcrow}

This document specifies a new type for the Elective 6LoWPAN Routing
Header (6LoRHE), Deadline-6LoRHE, so that the deadline time (i.e., the
time of latest acceptable delivery) of data packets can be included
within the 6LoRHE. \[[RFC8138](#RFC8138){.xref}\] specifies the 6LoWPAN
Routing Header (6LoRH), compression schemes for RPL (Routing Protocol
for Low-Power and Lossy Networks) source routing
\[[RFC6554](#RFC6554){.xref}\], header compression of RPL packet
information \[[RFC6553](#RFC6553){.xref}\], and IP-in-IP encapsulation.
This document also specifies the handling of the deadline time when
packets traverse time-synchronized networks operating in different time
zones or distinct reference clocks. Time-synchronization techniques are
outside the scope of this document. There are a number of standards
available for this purpose, including IEEE 1588
\[[IEEE.1588.2008](#IEEE.1588.2008){.xref}\], IEEE 802.1AS
\[[IEEE.802.1AS.2011](#IEEE.802.1AS.2011){.xref}\], IEEE 802.15.4-2015
Time-Slotted Channel Hopping (TSCH)
\[[IEEE.802.15.4](#IEEE.802.15.4){.xref}\], and
more.[¶](#section-1-2){.pilcrow}

The Deadline-6LoRHE can be used in any time-synchronized 6LoWPAN
network. A 6TiSCH (IPv6 over the TSCH mode of IEEE 802.15.4) network is
used to describe the implementation of the Deadline-6LoRHE, but this
does not preclude its use in scenarios other than 6TiSCH. For instance,
there is a growing interest in using 6LoWPAN over a Bluetooth Low Energy
(BLE) mesh network \[[6LO-BLEMESH](#I-D.ietf-6lo-blemesh){.xref}\] in
industrial IoT (Internet of Things)
\[[IEEE-BLE-MESH](#IEEE-BLE-MESH){.xref}\]. BLE mesh time
synchronization is being explored by the Bluetooth community. There are
also cases under consideration in Wi-SUN
\[[PHY-SPEC](#PHY-SPEC){.xref}\]
\[[Wi-SUN](#Wi-SUN){.xref}\].[¶](#section-1-3){.pilcrow}
:::
:::

::: {#acronyms_terms}
::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2-1){.pilcrow}

This document uses the terminology defined in
\[[RFC6550](#RFC6550){.xref}\] and
\[[RFC9030](#RFC9030){.xref}\].[¶](#section-2-2){.pilcrow}
:::
:::

::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [6LoRHE Generic Format](#name-6lorhe-generic-format){.section-name .selfRef} {#name-6lorhe-generic-format}

Note: this section is not normative and is included for convenience. The
generic header format of the 6LoRHE is specified in
\[[RFC8138](#RFC8138){.xref}\]. [Figure 1](#fig1){.xref} illustrates the
6LoRHE generic format.[¶](#section-3-1){.pilcrow}

[]{#name-6lorhe-format}

::: {#fig1}
::: {#section-3-2.1 .artwork .art-text .alignLeft}
       0                   1
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-        ...              -+
      |1|0|1| Length  |      Type     |        Options            |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-        ...              -+
                                       <---    length         --->
:::

[Figure 1](#figure-1){.selfRef}: [6LoRHE
Format](#name-6lorhe-format){.selfRef}
:::

[]{.break}

Length:
:   Length of the 6LoRHE expressed in bytes, excluding the first 2
    bytes. This enables a node to skip a 6LoRHE if the Type is not
    recognized or supported.[¶](#section-3-3.2){.pilcrow}
:   

Type (variable length):
:   Type of the 6LoRHE (see [Section
    7](#iana){.xref}).[¶](#section-3-3.4){.pilcrow}
:   
:::

::: {#Description}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [Deadline-6LoRHE](#name-deadline-6lorhe){.section-name .selfRef} {#name-deadline-6lorhe}

The Deadline-6LoRHE (see [Figure 3](#fig2){.xref}) is a 6LoRHE
\[[RFC8138](#RFC8138){.xref}\] that provides the Deadline Time (DT) for
an IPv6 datagram in a compressed form. Along with the DT, the header can
include the Origination Time Delta (OTD) packet, which contains the time
when the packet was enqueued for transmission (expressed as a value to
be subtracted from DT); this enables a close estimate of the total delay
incurred by a packet. The OTD field is initialized by the sender based
on the current time at the outgoing network interface through which the
packet is forwarded. Since the OTD is a delta, the length of the OTD
field (i.e., OTL) will require fewer bits than the length of the DT
field (i.e., DTL).[¶](#section-4-1){.pilcrow}

The DT field contains the value of the deadline time for the packet \--
in other words, the time by which the application expects the packet to
be delivered to the receiver.[¶](#section-4-2){.pilcrow}

packet_deadline_time = packet_origination_time +
max_delay[¶](#section-4-3){.pilcrow}

In order to support delay-sensitive, deterministic applications, all
nodes within the network should process the Deadline-6LoRHE. The DT and
OTD packets are represented in time units determined by a scaling
parameter in the Routing Header. The Network ASN (Absolute Slot Number)
can be used as a time unit in a time-slotted synchronized network (for
instance, a 6TiSCH network, where global time is maintained in the units
of slot lengths of a certain resolution).[¶](#section-4-4){.pilcrow}

The delay experienced by packets in the network is a useful metric for
network diagnostics and performance monitoring. Whenever a packet
crosses into a network using a different reference clock, the DT field
is updated to represent the same deadline time, but expressed using the
reference clock of the interface into the new network. Then the
origination time is the same as the current time when the packet is
transmitted into the new network, minus the delay already experienced by
the packet, say \'current_dly\'. In this way, within the newly entered
network, the packet will appear to have originated \'current_dly\' time
units earlier with respect to the reference clock of the new
network.[¶](#section-4-5){.pilcrow}

new_network_origin_time = time_now_in_new_network -
current_dly[¶](#section-4-6){.pilcrow}

The following example illustrates these calculations when a packet
travels between three networks, each in a different time zone (TZ).
\'x\' can be 1, 2, or 3. Suppose that the deadline time as measured in
TZ1 is 1050, and the origination time is 50. Suppose that the difference
between TZ2 and TZ1 is 900, and the difference between TZ2 and TZ3 is
3600. In the figure, OT is the origination time as measured in the
current time zone, and is equal to DT - OTD, that is, DT - 1000. [Figure
2](#time-update){.xref} uses the following
abbreviations:[¶](#section-4-7){.pilcrow}

[]{.break}

TxA:
:   Time of arrival of packet in the network
    \'x\'[¶](#section-4-8.2){.pilcrow}
:   

TxD:
:   Departure time of packet from the network
    \'x\'[¶](#section-4-8.4){.pilcrow}
:   

dlyx:
:   Delay experienced by the packet in the previous
    network(s)[¶](#section-4-8.6){.pilcrow}
:   

TZx:
:   The time zone of network \'x\'[¶](#section-4-8.8){.pilcrow}
:   

[]{#name-deadline-time-update-exampl}

::: {#time-update}
::: {#section-4-9.1 .artwork .art-text .alignLeft}
                TZ1                      TZ2                    TZ3
      T1A=50|                 |                             |
            |----  dly1=50    |                             |
            |     \           |                             |
            |      \          |                             |
            |       \ T1D=100 |T2A=1000                     |
            |        -------->|-----           dly2=450     |
            |                 |     \                       |
            |                 |      \                      |
            |                 |       \          T2D=1400   | T3A=5000
            |                 |         ------------------->|---------->
            |                 |                             |
            v                 v                             v

       dly0 = 0          dly1 = T1D-OT1      dly2 = T2D-OT2
                              = 100-50            = 1400 - 950
                              = 50                = 450

       OT1 = T1A-dly0     OT2 = T2A-dly1     OT3 = T3A-dly2
           = 50               = 1000-50          = 5000 - 450
                              = 950              = 4550
:::

[Figure 2](#figure-2){.selfRef}: [Deadline Time Update
Example](#name-deadline-time-update-exampl){.selfRef}
:::

There are multiple ways that a packet can be delayed, including queuing
delay, Media Access Control (MAC) layer contention delay, serialization
delay, and propagation delay. Sometimes there are processing delays as
well. For the purpose of determining whether or not the deadline has
already passed, these various delays are not
distinguished.[¶](#section-4-10){.pilcrow}
:::
:::

::: {#Format}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Deadline-6LoRHE Format](#name-deadline-6lorhe-format){.section-name .selfRef} {#name-deadline-6lorhe-format}

[]{#name-deadline-6lorhe-format-2}

::: {#fig2}
::: {#section-5-1.1 .artwork .art-text .alignLeft}
         0                   1                   2                   3
         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |1|0|1| Length  |  6LoRH Type   |D| TU|  DTL  | OTL | BinaryPt  |
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
        |      DT (variable length)     | OTD(variable length)(optional)|
        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 3](#figure-3){.selfRef}: [Deadline-6LoRHE
Format](#name-deadline-6lorhe-format-2){.selfRef}
:::

[]{.break}

Length (5 bits):
:   Length represents the total length of the Deadline-6LoRHE Type
    measured in octets.[¶](#section-5-2.2){.pilcrow}
:   

6LoRH Type:
:   7 (See [Section 7](#iana){.xref}.)[¶](#section-5-2.4){.pilcrow}
:   

D flag (1 bit):

:   The \'D\' flag, set by the sender, qualifies the action to be taken
    when a 6LoWPAN Router (6LR) detects that the deadline time has
    elapsed.[¶](#section-5-2.6.1){.pilcrow}

    If \'D\' bit is 1, then the 6LR [MUST]{.bcp14} drop the packet if
    the deadline time is elapsed.[¶](#section-5-2.6.2){.pilcrow}

    If \'D\' bit is 0, the packet [MAY]{.bcp14} be forwarded on an
    exception basis, if the forwarding node is NOT in a situation of
    constrained resource, and if there are reasons to suspect that
    downstream nodes might find it useful (delay measurements,
    interpolations, etc.).[¶](#section-5-2.6.3){.pilcrow}

:   

TU (2 bits):

:   Indicates the time units for DT and OTD fields. The encodings for
    the DT and OTD fields use the same time units and
    precision.[¶](#section-5-2.8.1){.pilcrow}

    []{.break}

    00
    :   Time represented in seconds and fractional
        seconds[¶](#section-5-2.8.2.2){.pilcrow}
    :   

    01
    :   Reserved[¶](#section-5-2.8.2.4){.pilcrow}
    :   

    10
    :   Network ASN[¶](#section-5-2.8.2.6){.pilcrow}
    :   

    11
    :   Reserved[¶](#section-5-2.8.2.8){.pilcrow}
    :   

:   

DTL (4 bits):
:   Length of the DT field as an unsigned 4-bit integer, encoding the
    length of the field in hex digits, minus
    one.[¶](#section-5-2.10){.pilcrow}
:   

OTL (3 bits):

:   Length of the OTD field as an unsigned 3-bit integer, encoding the
    length of the field in hex digits. If OTL == 0, the OTD field is not
    present. The value of OTL [MUST NOT]{.bcp14} exceed the value of DTL
    plus one.[¶](#section-5-2.12.1){.pilcrow}

    For example, DTL = 0b0000 means the DT field in the 6LoRHE is 1 hex
    digit (4 bits) long. OTL = 0b111 means the OTD field is 7 hex digits
    (28 bits) long.[¶](#section-5-2.12.2){.pilcrow}

:   

BinaryPt (6 bits):

:   If zero, the number of bits of the integer part the DT is equal to
    the number of bits of the fractional part of the DT. If nonzero, the
    BinaryPt is a (2\'s complement) signed integer determining the
    position of the binary point within the value for the DT. This
    allows BinaryPt to be within the range
    \[-32,31\].[¶](#section-5-2.14.1){.pilcrow}

    -   [If BinaryPt value is positive, then the number of bits for the
        integer part of the DT is increased by the value of BinaryPt,
        and the number of bits for the fractional part of the DT is
        correspondingly reduced. This increases the range of
        DT.[¶](#section-5-2.14.2.1){.pilcrow}]{#section-5-2.14.2.1}
    -   [If BinaryPt value is negative, then the number of bits for the
        integer part of the DT is decreased by the value of BinaryPt,
        and the number of bits for the fractional part of the DT is
        correspondingly increased. This increases the precision of the
        fractional seconds part of
        DT.[¶](#section-5-2.14.2.2){.pilcrow}]{#section-5-2.14.2.2}

:   

DT Value (4..64 bits):
:   An unsigned integer of DTL+1 hex digits giving the DT
    value.[¶](#section-5-2.16){.pilcrow}
:   

OTD Value (4..28 bits):
:   If present, an unsigned integer of OTL hex digits giving the
    origination time as a negative offset from the DT
    value.[¶](#section-5-2.18){.pilcrow}
:   

Whenever a sender initiates the IP datagram, it includes the
Deadline-6LoRHE along with other 6LoRH information. For information
about the time-synchronization requirements between sender and receiver,
see [Section 8](#sync){.xref}.[¶](#section-5-3){.pilcrow}

For the chosen time unit, a compressed time representation is available
as follows. First, the application on the originating node determines
how many time bits are needed to represent the difference between the
time at which the packet is launched and the deadline time, including
the representation of fractional time units. That number of bits (say,
N_bits) determines DTL as follows:[¶](#section-5-4){.pilcrow}

DTL = ((N_bits - 1) / 4)[¶](#section-5-5){.pilcrow}

The number of bits determined by DTL allows the counting of any number
of fractional time units in the range of interest determined by DT and
the OT. Denote this number of fractional time units to be
Epoch_Range(DTL) (i.e., Epoch_Range is a function of
DTL):[¶](#section-5-6){.pilcrow}

Epoch_Range(DTL) = 2^4\*(DTL+1)^[¶](#section-5-7){.pilcrow}

Each point of time between OT and DT is represented by a time unit and a
fractional time unit; in this section, this combined representation is
called a rational time unit (RTU). 1 RTU measures the smallest
fractional time that can be represented between two points of time in
the epoch (i.e., within the range of
interest).[¶](#section-5-8){.pilcrow}

DT - OT cannot exceed 2^4\*(DTL+1)^ == 16^DTL+1^. A low value of DTL
leads to a small Epoch_Range; if DTL = 0, there will only be 16 RTUs
within the Epoch_Range (i.e., Epoch_Range(DTL) = 16^1^) for any TU. The
values that can be represented in the current epoch are in the range
\[0, (Epoch_Range(DTL) - 1)\].[¶](#section-5-9){.pilcrow}

Assuming wraparound does not occur, OT is represented by the value (OT
mod Epoch_Range), and DT is represented by the value (DT mod
Epoch_Range). All arithmetic is to be performed modulo
(Epoch_Range(DTL)), yielding only positive values for DT -
OT.[¶](#section-5-10){.pilcrow}

In order to allow fine-grained control over the setting of the deadline
time, the fields for DT and OTD use fractional seconds. This is done by
specifying a binary point, which allocates some of the bits for
fractional times. Thus, all such fractions are restricted to be negative
powers of 2. Each point of time between OT and DT is then represented by
a time unit (either seconds or ASNs) and a fractional time
unit.[¶](#section-5-11){.pilcrow}

Let OT_abs, DT_abs, and CT_abs denote the true (absolute) values (on the
synchronized timelines) for OT, DT, and current time. Let N be the
number of bits to be used to represent the integer parts of OT_abs,
DT_abs, and CT_abs:[¶](#section-5-12){.pilcrow}

N = {4\*(DTL+1)/2} + BinaryPt[¶](#section-5-13){.pilcrow}

The originating node has to pick a segment size (2\^N) so that DT_abs -
OT_abs \< 2\^N, and so that intermediate network nodes can detect
whether or not CT_abs \> DT_abs.[¶](#section-5-14){.pilcrow}

Given a value for N, the value for DT is represented in the
deadline-time format by DT = (DT_abs mod 2\^N). DT is typically
represented as a positive value (even though negative modular values
make sense). Also, let OT = OT_abs mod 2\^N and CT = CT_abs mod 2\^N,
where both OT and CT are also considered as non-negative
values.[¶](#section-5-15){.pilcrow}

When the packet is launched by the originating node, CT_abs == OT_abs
and CT == OT. Given a particular value for N, then in order for
downstream nodes to detect whether or not the deadline has expired
(i.e., whether DT_abs \> CT_abs), the following is
required:[¶](#section-5-16){.pilcrow}

::: {#assumption}
Assumption 1: DT_abs - OT_abs \< 2\^N.[¶](#section-5-17){.pilcrow}
:::

Otherwise the ambiguity inherent in the modulus arithmetic yielding OT
and DT will cause failure: one cannot measure time differences greater
than 2\^N using numbers in a time segment of length less than
2\^N.[¶](#section-5-18){.pilcrow}

Under [Assumption 1](#assumption){.xref}, downstream nodes must
effectively check whether or not their current time is later than the DT
\-- but the value of the DT has to be inferred from the value of DT in
the 6LoRHE, which is a number less than 2\^N. This inference cannot be
expected to reliably succeed unless [Assumption 1](#assumption){.xref}
is valid, which means that the originating node has to be careful to
pick proper values for DTL and for BinaryPt.[¶](#section-5-19){.pilcrow}

Since OT is not necessarily provided in the 6loRHE, there may be a
danger of ambiguity. Surely, when DT = CT, the deadline time is expiring
and the packet should be dropped. However, what if an intermediate node
measures that CT = DT+1? Was the packet launched a short time before
arrival at the intermediate node, or has the current time wrapped around
so that CT_abs - OT_abs \> 2\^N?[¶](#section-5-20){.pilcrow}

In order to solve this problem, a safety margin has to be provided, in
addition to requiring that DT_abs - OT_abs \< 2\^N. The value of this
safety margin is proportional to 2\^N and is determined by a new
parameter, called the \"SAFETY_FACTOR\". Then, for safety the
originating node MUST further ensure that (DT_abs - OT_abs) \<
2\^N\*(1-SAFETY_FACTOR).[¶](#section-5-21){.pilcrow}

Each intermediate node that receives the packet with the Deadline-6LoRHE
must determine whether ((CT - DT) mod 2\^N) \> SAFETY_FACTOR\*2\^N. If
this test condition is not satisfied, the deadline time has expired. See
[Appendix A](#modular){.xref} for more explanation about the test
condition. All nodes that receive a packet with a Deadline-6LoRHE
included MUST use the same value for the SAFETY_FACTOR. The
SAFETY_FACTOR is to be chosen so that a packet with the Deadline-6LoRHE
included will be tested against the current time at least once during
every subinterval of length SAFETY_FACTOR\*2\^N. In this way, it can be
guaranteed that the packet will be tested often enough to make sure it
can be dropped whenever CT_abs \> DT_abs. The value of SAFETY_FACTOR is
specified in this document to be 20%.[¶](#section-5-22){.pilcrow}

Example: Consider a 6TiSCH network with time-slot length of 10 ms. Let
the time units be ASNs (TU == (binary)0b10). Let the current ASN when
the packet is originated be 54400, and the maximum allowable delay
(max_delay) for the packet delivery be 1 second from the packet
origination, then:[¶](#section-5-23){.pilcrow}

deadline_time = packet_origination_time +
max_delay[¶](#section-5-24){.pilcrow}

= 0xD480 + 0x64 (Network ASNs)[¶](#section-5-25){.pilcrow}

= 0xD4E4 (Network ASNs)[¶](#section-5-26){.pilcrow}

Then, the Deadline-6LoRHE encoding with nonzero OTL
is:[¶](#section-5-27){.pilcrow}

DTL = 3, OTL = 2, TU = 0b10, BinaryPt = 8, DT = 0xD4E4,
OTD = 0x64[¶](#section-5-28){.pilcrow}
:::
:::

::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [Deadline-6LoRHE in Three Network Scenarios](#name-deadline-6lorhe-in-three-ne){.section-name .selfRef} {#name-deadline-6lorhe-in-three-ne}

In this section, the Deadline-6LoRHE operation is described for three
network scenarios. [Figure 4](#fig3){.xref} depicts a constrained
time-synchronized LLN that has two subnets, N1 and N2, connected through
6LoWPAN Border Routers (6LBRs) \[[RFC8929](#RFC8929){.xref}\] with
different reference clock times, T1 and T2.[¶](#section-6-1){.pilcrow}

[]{#name-intra-network-time-zone-sce}

::: {#fig3}
::: {#section-6-2.1 .artwork .art-text .alignLeft}
                           +-------------------+
                           | Time-Synchronized |
                           |      Network      |
                           +---------+---------+
                                     |
                                     |
                                     |
                      +--------------+--------------+
                      |                             |
                   +-----+                       +-----+
                   |     | Backbone              |     | Backbone
              o    |     | router                |     | router
                   +-----+                       +-----+
              o                  o               o
                  o    o   o               o  o   o  o   o  o
             o      LLN    o                 o  LLN   o  o
                o   o    o      o             o o o     o  o
          6LoWPAN Network (subnet N1)   6LoWPAN Network (subnet N2)
:::

[Figure 4](#figure-4){.selfRef}: [Intra-Network Time Zone
Scenario](#name-intra-network-time-zone-sce){.selfRef}
:::

::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [Scenario 1: Endpoints in the Same DODAG (N1)](#name-scenario-1-endpoints-in-the){.section-name .selfRef} {#name-scenario-1-endpoints-in-the}

In Scenario 1, shown in [Figure 5](#fig4){.xref}, the Sender \'S\' has
an IP datagram to be routed to a Receiver \'R\' within the same
Destination-Oriented Directed Acyclic Graph (DODAG). For the route
segment from the sender to the 6LBR, the sender includes a
Deadline-6LoRHE by encoding the deadline time contained in the packet.
Subsequently, each 6LR will perform hop-by-hop routing to forward the
packet towards the 6LBR. Once the 6LBR receives the IP datagram, it
sends the packet downstream towards \'R\'.[¶](#section-6.1-1){.pilcrow}

In the case of a network running in RPL non-storing mode, the 6LBR
generates an IPv6-in-IPv6 encapsulated packet when sending the packet
downwards to the receiver \[[RFC9008](#RFC9008){.xref}\]. The 6LBR
copies the Deadline-6LoRHE from the sender-originated IP header to the
outer IP header. The Deadline-6LoRHE contained in the inner IP header is
removed.[¶](#section-6.1-2){.pilcrow}

[]{#name-endpoints-within-the-same-d}

::: {#fig4}
::: {#section-6.1-3.1 .artwork .art-text .alignLeft}
                               +-------+
                    ^          | 6LBR  |       |
                    |          |       |       |
                    |          +-------+       |
            Upward  |         /      /| \      | Downward
            routing |      (F)      / |  \     | routing
                    |     /  \    (C) |  (D)   |
                    |    /    \    |  | / |\   |
                    |  (A)    (B)  : (E)  : R  |
                    |  /|\     | \   / \       |
                    | S : :    : :  :  :       v
:::

[Figure 5](#figure-5){.selfRef}: [Endpoints within the Same DODAG
(Subnet N1)](#name-endpoints-within-the-same-d){.selfRef}
:::

At the tunnel endpoint of the encapsulation, the Deadline-6LoRHE is
copied back from the outer header to inner header, and the inner IP
packet is delivered to \'R\'.[¶](#section-6.1-4){.pilcrow}
:::

::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Scenario 2: Endpoints in Networks with Dissimilar L2 Technologies](#name-scenario-2-endpoints-in-net){.section-name .selfRef} {#name-scenario-2-endpoints-in-net}

In Scenario 2, shown in [Figure 6](#fig5){.xref}, the Sender \'S\'
(belonging to DODAG 1) has an IP datagram to be routed to a Receiver
\'R\' over a time-synchronized IPv6 network. For the route segment from
\'S\' to 6LBR, \'S\' includes a Deadline-6LoRHE. Subsequently, each 6LR
will perform hop-by-hop routing to forward the packet towards the 6LBR.
Once the deadline time information reaches the 6LBR, the packet will be
encoded according to the mechanism prescribed in the other
time-synchronized network depicted as \"Time-Synchronized Network\" in
[Figure 6](#fig5){.xref}. The specific data encapsulation mechanisms
followed in the new network are beyond the scope of this
document.[¶](#section-6.2-1){.pilcrow}

[]{#name-packet-transmission-in-diss}

::: {#fig5}
::: {#section-6.2-2.1 .artwork .art-text .alignLeft}
                               +----------------+
                               | Time-          |
                               | Synchronized   |------R
                               | Network        |
                               +----------------+
                                       |
                                       |
                             ----------+-----------
                      ^                |
                      |            +---+---+
                      |            | 6LBR  |
             Upward   |            |       |
             routing  |            +------++
                      |        (F)/      /| \
                      |       /  \      / |  \
                      |      /    \   (C) |  (D)
                      |    (A)    (B)  |  | / |\
                      |    /|\     |\  : (E)  : :
                      |   S : :    : :   / \
                                        :   :
:::

[Figure 6](#figure-6){.selfRef}: [Packet Transmission in Dissimilar L2
Technologies or Internet](#name-packet-transmission-in-diss){.selfRef}
:::

For instance, the IP datagram could be routed to another
time-synchronized, deterministic network using the mechanism specified
in In-situ Operations, Administration, and Maintenance (IOAM)
\[[IOAM-DATA](#I-D.ietf-ippm-ioam-data){.xref}\], and then the deadline
time would be updated according to the measurement of the current time
in the new network.[¶](#section-6.2-3){.pilcrow}
:::

::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Scenario 3: Packet Transmission across Different DODAGs (N1 to N2)](#name-scenario-3-packet-transmiss){.section-name .selfRef} {#name-scenario-3-packet-transmiss}

Consider the scenario depicted in [Figure 7](#fig6){.xref}, in which the
Sender \'S\' (belonging to DODAG 1) has an IP datagram to be sent to
Receiver \'R\' belonging to another DODAG (DODAG 2). The operation of
this scenario can be decomposed into a combination of Scenarios 1 and 2.
For the route segment from \'S\' to 6LBR1, \'S\' includes the
Deadline-6LoRHE. Subsequently, each 6LR will perform hop-by-hop
operations to forward the packet towards 6LBR1. Once the IP datagram
reaches 6LBR1 of DODAG1, 6LBR1 applies the same rule as described in
Scenario 2 while routing the packet to 6LBR2 over a (likely)
time-synchronized wired backhaul. The wired side of 6LBR2 can be mapped
to the receiver of Scenario 2. Once the packet reaches 6LBR2, it updates
the Deadline-6LoRHE by adding or subtracting the difference of time of
DODAG2 and sends the packet downstream towards
\'R\'.[¶](#section-6.3-1){.pilcrow}

[]{#name-packet-transmission-in-diff}

::: {#fig6}
::: {#section-6.3-2.1 .artwork .art-text .alignLeft}
                     Time-Synchronized Network
                   -+---------------------------+-
                    |                           |
       DODAG1   +---+---+                   +---+---+   DODAG2
                | 6LBR1 |                   | 6LBR2 |
                |       |                   |       |
                +-------+                   +-------+
            (F)/      /| \              (F)/      /| \
           /  \      / |  \            /  \      / |  \
          /    \   (C) |  (D)         /    \   (C) |  (D)
        (A)    (B)  |  | / |\       (A)    (B)  |  |   |\
        /|\     |\  : (E)  : :      /|\     |\  : (E)  : :
       S : :    : :   / \          : : :    : :   / \
                     :   :                       :   R
    Network N1, time zone T1      Network N2, time zone T2
:::

[Figure 7](#figure-7){.selfRef}: [Packet Transmission in Different
DODAGs (N1 to N2)](#name-packet-transmission-in-diff){.selfRef}
:::

Consider an example of a 6TiSCH network in which S in DODAG1 generates
the packet at ASN 20000 to R in DODAG2. Let the maximum allowable delay
be 1 second. The time-slot length in DODAG1 and DODAG2 is assumed to be
10 ms. Once the deadline time is encoded in Deadline-6LoRHE, the packet
is forwarded to 6LBR1 of DODAG1. Suppose the packet reaches 6LBR1 of
DODAG1 at ASN 20030.[¶](#section-6.3-3){.pilcrow}

current_time = ASN at 6LBR \*
slot_length_value[¶](#section-6.3-4){.pilcrow}

remaining_time = deadline_time -
current_time[¶](#section-6.3-5){.pilcrow}

= ((packet_origination_time + max_delay) - current
time)[¶](#section-6.3-6){.pilcrow}

= (20000 + 100) - 20030[¶](#section-6.3-7){.pilcrow}

= 30 (in Network ASNs)[¶](#section-6.3-8){.pilcrow}

= 30 \* 10^3^ milliseconds[¶](#section-6.3-9){.pilcrow}

Once the deadline time information reaches 6LBR2, the packet will be
encoded according to the mechanism prescribed in the other
time-synchronized network.[¶](#section-6.3-10){.pilcrow}
:::
:::

::: {#iana}
::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

This document defines a new Elective 6LoWPAN Routing Header Type, and
IANA has assigned the value 7 from the 6LoWPAN Dispatch Page 1 number
space for this purpose.[¶](#section-7-1){.pilcrow}

[]{#name-entry-in-the-elective-6lowp}

::: {#iana_reg}
  Value   Description       Reference
  ------- ----------------- -----------
  7       Deadline-6LoRHE   RFC 9034

  : [Table 1](#table-1){.selfRef}: [Entry in the \"Elective 6LoWPAN
  Routing Header Type\"
  Registry](#name-entry-in-the-elective-6lowp){.selfRef}
:::
:::
:::

::: {#sync}
::: {#section-8 .section}
## [8.](#section-8){.section-number .selfRef} [Synchronization Aspects](#name-synchronization-aspects){.section-name .selfRef} {#name-synchronization-aspects}

The document supports time representation of the deadline and
origination times carried in the packets traversing networks of
different time zones having different time-synchronization mechanisms.
For instance, in a 6TiSCH network where the time is maintained as ASN
time slots, the time synchronization is achieved through beaconing among
the nodes as described in \[[RFC7554](#RFC7554){.xref}\]. There could be
6lo networks that employ NTP where the nodes are synchronized with an
external reference clock from an NTP server. The specification of the
time-synchronization method that needs to be followed by a network is
beyond the scope of the document.[¶](#section-8-1){.pilcrow}

The number of hex digits chosen to represent DT, and the portion of that
field allocated to represent the integer number of seconds, determines
the meaning of t~0~, i.e., the meaning of DT == 0 in the chosen
representation. If DTL == 0, then there are only 4 bits that can be used
to count the time units, so that DT == 0 can never be more than 16 time
units (or fractional time units) in the past. This then requires that
the time synchronization between sender and receiver has to be tighter
than 16 units. If the binary point were moved so that all the bits were
used for fractional time units (e.g., fractional seconds or fractional
ASNs), the time-synchronization requirement would be correspondingly
tighter.[¶](#section-8-2){.pilcrow}

A 4-bit field for DT allows up to 16 hex digits, which is 64 bits. That
is enough to represent the NTP 64-bit timestamp format
\[[RFC5905](#RFC5905){.xref}\], which is more than enough for the
purposes of establishing deadline times. Unless the binary point is
moved, this is enough to represent time since year
1900.[¶](#section-8-3){.pilcrow}

For example, suppose that DTL = 0b0000 and the DT bits are split evenly;
then we can count up to 3.75 seconds by
quarter-seconds.[¶](#section-8-4){.pilcrow}

If DTL = 3 and the DT bits are again split evenly, then we can count up
to 256 seconds (in steps of 1/256 of a
second).[¶](#section-8-5){.pilcrow}

In all cases, t~0~ is defined as specified in [Section
5](#Format){.xref}.[¶](#section-8-6){.pilcrow}

t~0~ = \[current_time - (current_time mod
(2^4\*(DTL+1)^))\][¶](#section-8-7){.pilcrow}

regardless of the choice of TU.[¶](#section-8-8){.pilcrow}

For TU = 0b00, the time units are seconds. With DTL == 15, and BinaryPt
== 0, the epoch is (by default) January 1, 1900, at 00:00 UTC. The
resolution is then 2^-32^ seconds, which is the maximum possible. This
time format wraps around every 2^32^ seconds, which is roughly 136
years.[¶](#section-8-9){.pilcrow}

For TU = 0b10, the time units are ASNs. The start time is relative, and
updated by a mechanism that is out of scope for this document. With 10
ms slots, DTL = 15, and BinaryPt == 0, it would take over a year for the
ASN to wrap around. Typically, the number of hex digits allocated for TU
= 0b10 would be less than 15.[¶](#section-8-10){.pilcrow}
:::
:::

::: {#section-9 .section}
## [9.](#section-9){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

The security considerations of \[[RFC4944](#RFC4944){.xref}\] ([Section
13](https://www.rfc-editor.org/rfc/rfc4944#section-13){.relref}),
\[[RFC6282](#RFC6282){.xref}\] ([Section
6](https://www.rfc-editor.org/rfc/rfc6282#section-6){.relref}), and
\[[RFC6553](#RFC6553){.xref}\] ([Section
5](https://www.rfc-editor.org/rfc/rfc6553#section-5){.relref}) apply.
Using a compressed format as opposed to the full inline format is
logically equivalent and does not create an opening for a new threat
when compared to \[[RFC6550](#RFC6550){.xref}\],
\[[RFC6553](#RFC6553){.xref}\], and
\[[RFC6554](#RFC6554){.xref}\].[¶](#section-9-1){.pilcrow}

The protocol elements specified in this document are designed to work in
controlled operational environments (e.g., industrial process control
and automation). In order to avoid misuse of the deadline information
that could potentially result in a Denial of Service (DoS) attack,
proper functioning of this deadline time mechanism requires the
provisioning and management of network resources for supporting traffic
flows with deadlines, performance monitoring, and admission control
policy enforcement. The network provisioning can be done either
centrally or in a distributed fashion. For example, tracks in a 6TiSCH
network could be established by a centralized Path Computation Element
(PCE), as described in the 6TiSCH architecture
\[[RFC9030](#RFC9030){.xref}\].[¶](#section-9-2){.pilcrow}

The security considerations of DetNet architecture
\[[RFC8655](#RFC8655){.xref}\] ([Section
5](https://www.rfc-editor.org/rfc/rfc8655#section-5){.relref}) mostly
apply to this document as well, as follows. To secure the request and
control of resources allocated for tracks, authentication and
authorization can be used for each device and network controller
devices. In the case of distributed control protocols, security is
expected to be provided by the security properties of the protocols in
use.[¶](#section-9-3){.pilcrow}

The identification of deadline-bearing flows on a per-flow basis may
provide attackers with additional information about the data flows
compared to networks that do not include per-flow identification. The
security implications of disclosing that additional information deserve
consideration when implementing this deadline
specification.[¶](#section-9-4){.pilcrow}

Because of the requirement of precise time synchronization, the
accuracy, availability, and integrity of time synchronization is of
critical importance. Extensive discussion of this topic can be found in
\[[RFC7384](#RFC7384){.xref}\].[¶](#section-9-5){.pilcrow}
:::

::: {#section-10 .section}
## [10.](#section-10){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-10.1 .section}
### [10.1.](#section-10.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC4944\]
:   [Montenegro, G.]{.refAuthor}, [Kushalnagar, N.]{.refAuthor},
    [Hui, J.]{.refAuthor}, and [D. Culler]{.refAuthor}, [\"Transmission
    of IPv6 Packets over IEEE 802.15.4 Networks\"]{.refTitle}, [RFC
    4944]{.seriesInfo}, [DOI 10.17487/RFC4944]{.seriesInfo}, September
    2007, \<<https://www.rfc-editor.org/info/rfc4944>\>.
:   

\[RFC5905\]
:   [Mills, D.]{.refAuthor}, [Martin, J., Ed.]{.refAuthor},
    [Burbank, J.]{.refAuthor}, and [W. Kasch]{.refAuthor}, [\"Network
    Time Protocol Version 4: Protocol and Algorithms
    Specification\"]{.refTitle}, [RFC 5905]{.seriesInfo}, [DOI
    10.17487/RFC5905]{.seriesInfo}, June 2010,
    \<<https://www.rfc-editor.org/info/rfc5905>\>.
:   

\[RFC6282\]
:   [Hui, J., Ed.]{.refAuthor} and [P. Thubert]{.refAuthor},
    [\"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based
    Networks\"]{.refTitle}, [RFC 6282]{.seriesInfo}, [DOI
    10.17487/RFC6282]{.seriesInfo}, September 2011,
    \<<https://www.rfc-editor.org/info/rfc6282>\>.
:   

\[RFC6550\]
:   [Winter, T., Ed.]{.refAuthor}, [Thubert, P., Ed.]{.refAuthor},
    [Brandt, A.]{.refAuthor}, [Hui, J.]{.refAuthor},
    [Kelsey, R.]{.refAuthor}, [Levis, P.]{.refAuthor},
    [Pister, K.]{.refAuthor}, [Struik, R.]{.refAuthor}, [Vasseur,
    JP.]{.refAuthor}, and [R. Alexander]{.refAuthor}, [\"RPL: IPv6
    Routing Protocol for Low-Power and Lossy Networks\"]{.refTitle},
    [RFC 6550]{.seriesInfo}, [DOI 10.17487/RFC6550]{.seriesInfo}, March
    2012, \<<https://www.rfc-editor.org/info/rfc6550>\>.
:   

\[RFC6553\]
:   [Hui, J.]{.refAuthor} and [JP. Vasseur]{.refAuthor}, [\"The Routing
    Protocol for Low-Power and Lossy Networks (RPL) Option for Carrying
    RPL Information in Data-Plane Datagrams\"]{.refTitle}, [RFC
    6553]{.seriesInfo}, [DOI 10.17487/RFC6553]{.seriesInfo}, March 2012,
    \<<https://www.rfc-editor.org/info/rfc6553>\>.
:   

\[RFC6554\]
:   [Hui, J.]{.refAuthor}, [Vasseur, JP.]{.refAuthor},
    [Culler, D.]{.refAuthor}, and [V. Manral]{.refAuthor}, [\"An IPv6
    Routing Header for Source Routes with the Routing Protocol for
    Low-Power and Lossy Networks (RPL)\"]{.refTitle}, [RFC
    6554]{.seriesInfo}, [DOI 10.17487/RFC6554]{.seriesInfo}, March 2012,
    \<<https://www.rfc-editor.org/info/rfc6554>\>.
:   

\[RFC7384\]
:   [Mizrahi, T.]{.refAuthor}, [\"Security Requirements of Time
    Protocols in Packet Switched Networks\"]{.refTitle}, [RFC
    7384]{.seriesInfo}, [DOI 10.17487/RFC7384]{.seriesInfo}, October
    2014, \<<https://www.rfc-editor.org/info/rfc7384>\>.
:   

\[RFC7554\]
:   [Watteyne, T., Ed.]{.refAuthor}, [Palattella, M.]{.refAuthor}, and
    [L. Grieco]{.refAuthor}, [\"Using IEEE 802.15.4e Time-Slotted
    Channel Hopping (TSCH) in the Internet of Things (IoT): Problem
    Statement\"]{.refTitle}, [RFC 7554]{.seriesInfo}, [DOI
    10.17487/RFC7554]{.seriesInfo}, May 2015,
    \<<https://www.rfc-editor.org/info/rfc7554>\>.
:   

\[RFC8138\]
:   [Thubert, P., Ed.]{.refAuthor}, [Bormann, C.]{.refAuthor},
    [Toutain, L.]{.refAuthor}, and [R. Cragie]{.refAuthor}, [\"IPv6 over
    Low-Power Wireless Personal Area Network (6LoWPAN) Routing
    Header\"]{.refTitle}, [RFC 8138]{.seriesInfo}, [DOI
    10.17487/RFC8138]{.seriesInfo}, April 2017,
    \<<https://www.rfc-editor.org/info/rfc8138>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8655\]
:   [Finn, N.]{.refAuthor}, [Thubert, P.]{.refAuthor},
    [Varga, B.]{.refAuthor}, and [J. Farkas]{.refAuthor},
    [\"Deterministic Networking Architecture\"]{.refTitle}, [RFC
    8655]{.seriesInfo}, [DOI 10.17487/RFC8655]{.seriesInfo}, October
    2019, \<<https://www.rfc-editor.org/info/rfc8655>\>.
:   

\[RFC9030\]
:   [Thubert, P., Ed.]{.refAuthor}, [\"An Architecture for IPv6 over the
    Time-Slotted Channel Hopping Mode of IEEE 802.15.4
    (6TiSCH)\"]{.refTitle}, [RFC 9030]{.seriesInfo}, [DOI
    10.17487/RFC9030]{.seriesInfo}, May 2021,
    \<<https://www.rfc-editor.org/info/rfc9030>\>.
:   
:::

::: {#section-10.2 .section}
### [10.2.](#section-10.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[6LO-BLEMESH\]
:   [Gomez, C.]{.refAuthor}, [Darroudi, S. M.]{.refAuthor},
    [Savolainen, T.]{.refAuthor}, and [M. Spoerk]{.refAuthor}, [\"IPv6
    Mesh over BLUETOOTH(R) Low Energy using IPSP\"]{.refTitle}, [Work in
    Progress]{.refContent}, [Internet-Draft,
    draft-ietf-6lo-blemesh-10]{.seriesInfo}, 22 April 2021,
    \<<https://tools.ietf.org/html/draft-ietf-6lo-blemesh-10>\>.
:   

\[IEEE-BLE-MESH\]
:   [Leonardi, L.]{.refAuthor}, [Patti, G.]{.refAuthor}, and [L. Lo
    Bello]{.refAuthor}, [\"Multi-Hop Real-Time Communications Over
    Bluetooth Low Energy Industrial Wireless Mesh
    Networks\"]{.refTitle}, [IEEE Access, Vol 6, pp.
    26505-26519]{.refContent}, [DOI
    10.1109/ACCESS.2018.2834479]{.seriesInfo}, May 2018,
    \<<https://doi.org/10.1109/ACCESS.2018.2834479>\>.
:   

\[IEEE.1588.2008\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for a Precision Clock
    Synchronization Protocol for Networked Measurement and Control
    Systems\"]{.refTitle}, [DOI
    10.1109/IEEESTD.2008.4579760]{.seriesInfo}, July 2008,
    \<<https://doi.org/10.1109/IEEESTD.2008.4579760>\>.
:   

\[IEEE.802.15.4\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Low-Rate Wireless
    Networks\"]{.refTitle}, [IEEE Standard 802.15.4-2015]{.seriesInfo},
    [DOI 10.1109/IEEESTD.2016.7460875]{.seriesInfo}, April 2016,
    \<<https://ieeexplore.ieee.org/document/7460875>\>.
:   

\[IEEE.802.1AS.2011\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Local and Metropolitan Area
    Networks - Timing and Synchronization for Time-Sensitive
    Applications in Bridged Local Area Networks\"]{.refTitle}, [IEEE Std
    802.1AS-2011]{.refContent}, [DOI
    10.1109/IEEESTD.2011.5741898]{.seriesInfo}, March 2011,
    \<<https://doi.org/10.1109/IEEESTD.2011.5741898>\>.
:   

\[IOAM-DATA\]
:   [Brockners, F., Ed.]{.refAuthor}, [Bhandari, S., Ed.]{.refAuthor},
    and [T. Mizrahi, Ed.]{.refAuthor}, [\"Data Fields for In-situ
    OAM\"]{.refTitle}, [Work in Progress]{.refContent}, [Internet-Draft,
    draft-ietf-ippm-ioam-data-12]{.seriesInfo}, 21 February 2021,
    \<<https://tools.ietf.org/html/draft-ietf-ippm-ioam-data-12>\>.
:   

\[PHY-SPEC\]
:   [Wi-SUN Alliance]{.refAuthor}, [\"Wi-SUN PHY Specification
    V1.0\"]{.refTitle}, March 2016, \<<http://wi-sun.org>\>.
:   

\[RFC8578\]
:   [Grossman, E., Ed.]{.refAuthor}, [\"Deterministic Networking Use
    Cases\"]{.refTitle}, [RFC 8578]{.seriesInfo}, [DOI
    10.17487/RFC8578]{.seriesInfo}, May 2019,
    \<<https://www.rfc-editor.org/info/rfc8578>\>.
:   

\[RFC8929\]
:   [Thubert, P., Ed.]{.refAuthor}, [Perkins, C.E.]{.refAuthor}, and [E.
    Levy-Abegnoli]{.refAuthor}, [\"IPv6 Backbone Router\"]{.refTitle},
    [RFC 8929]{.seriesInfo}, [DOI 10.17487/RFC8929]{.seriesInfo},
    November 2020, \<<https://www.rfc-editor.org/info/rfc8929>\>.
:   

\[RFC9008\]
:   [Robles, M.I.]{.refAuthor}, [Richardson, M.]{.refAuthor}, and [P.
    Thubert]{.refAuthor}, [\"Using RPI Option Type, Routing Header for
    Source Routes, and IPv6-in-IPv6 Encapsulation in the RPL Data
    Plane\"]{.refTitle}, [RFC 9008]{.seriesInfo}, [DOI
    10.17487/RFC9008]{.seriesInfo}, April 2021,
    \<<https://www.rfc-editor.org/info/rfc9008>\>.
:   

\[Wi-SUN\]
:   [Harada, H.]{.refAuthor}, [Mizutani, K.]{.refAuthor},
    [Fujiwara, J.]{.refAuthor}, [Mochizuki, K.]{.refAuthor},
    [Obata, K.]{.refAuthor}, and [R. Okumura]{.refAuthor}, [\"IEEE
    802.15.4g Based Wi-SUN Communication Systems\"]{.refTitle}, [IEICE
    Transactions on Communications]{.refContent}, [Volume E100.B, Issue
    7, pp. 1032-1043]{.refContent}, [DOI
    10.1587/transcom.2016SCI0002]{.seriesInfo}, January 2017,
    \<<https://doi.org/10.1587/transcom.2016SCI0002>\>.
:   
:::
:::

::: {#modular}
::: {#section-appendix.a .section}
## [Appendix A.](#section-appendix.a){.section-number .selfRef} [Modular Arithmetic Considerations](#name-modular-arithmetic-consider){.section-name .selfRef} {#name-modular-arithmetic-consider}

Graphically, one might visualize the timeline as
follows:[¶](#section-appendix.a-1){.pilcrow}

[]{#name-absolute-timeline-represent}

::: {#fig7}
::: {#section-appendix.a-2.1 .artwork .art-text .alignLeft}
               OT_abs        CT_abs        DT_abs
          -------|-------------|-------------|------------------>
:::

[Figure 8](#figure-8){.selfRef}: [Absolute Timeline
Representation](#name-absolute-timeline-represent){.selfRef}
:::

In [Figure 8](#fig7){.xref}, the value of CT_abs is envisioned as
traveling to the right as time progresses, getting farther away from
OT_abs and getting closer to DT_abs. The timeline is considered to be
subdivided into time subintervals \[i,j\] starting and ending at
absolute times equal to k\*(2\^N), for integer values of k. Let I_k =
k\*(2\^N) and I\_(k+1) = (k+1)\*2\^N. Intervals starting at I_k and
I\_(k+1) may occur at various placements in the above timeline. Even
though OT_abs is *always* less than DT_abs, it could be that DT \< OT
because of the way that DT and OT are represented within the range \[0,
2\^N) and similarly for CT_abs and CT compared to OT and
DT.[¶](#section-appendix.a-3){.pilcrow}

Representing the above situation in time segments of length 2\^N (and
values OT, CT, DT) results in several cases where the deadline time has
not elapsed:[¶](#section-appendix.a-4){.pilcrow}

[]{.break}

1\) OT \< CT \< DT
:   (e.g., I_k \< OT_abs \< CT_abs \< DT_abs \< I\_(k+1)
    )[¶](#section-appendix.a-5.2){.pilcrow}
:   

2\) DT \< OT \< CT
:   (e.g., I_k \< OT_abs \< CT_abs \< I\_(k+1) \< DT_abs
    )[¶](#section-appendix.a-5.4){.pilcrow}
:   

3\) CT \< DT \< OT
:   (e.g., I_k \< OT_abs \< I\_(k+1) \< CT_abs \< DT_abs
    )[¶](#section-appendix.a-5.6){.pilcrow}
:   

In the following cases, the deadline time has elapsed and the packet
should be dropped.[¶](#section-appendix.a-6){.pilcrow}

[]{.break}

4\) DT \< CT \< OT

:   

:   

5\) OT \< DT \< CT

:   

:   

6\) CT \< OT \< DT

:   

:   

Again in [Figure 8](#fig7){.xref}, consider CT_abs as time moving away
from OT_abs and towards DT_abs. For times CT_abs before the expiration
of the deadline time, we also have CT_abs - OT_abs == CT - OT mod 2\^N
and similarly for DT_abs - CT_abs.[¶](#section-appendix.a-8){.pilcrow}

As time proceeds, DT_abs - CT_abs gets smaller. When the deadline time
expires, DT_abs - CT_abs begins to grow negative. A proper selection for
SAFETY_FACTOR allows it to go *slightly negative* but for an
intermediate point to *detect* that it has gone negative. Note that in
modular arithmetic, \"slightly negative\" means *exactly* the same as
\"almost as large as the modulus (i.e., 2\^N)\". Now consider the test
condition ((CT - DT) mod 2\^N) \>
SAFETY_FACTOR\*2\^N.[¶](#section-appendix.a-9){.pilcrow}

(DT_abs - OT_abs) \< 2\^N\*(1-SAFETY_FACTOR) satisfies the test
condition when CT_abs == OT_abs (i.e., when the packet is launched). In
modular arithmetic, 2\^N\*(1-SAFETY_FACTOR) == 2\^N -
2\^N\*SAFETY_FACTOR == -2\^N\*(SAFETY_FACTOR). Then DT_abs - OT_abs \<
-2\^N\*(1-SAFETY_FACTOR). Inverting the inequality, OT_abs - DT_abs \>
2\^N\*(1-SAFETY_FACTOR), and thus at launch CT_abs - DT_abs \>
2\^N\*(1-SAFETY_FACTOR).[¶](#section-appendix.a-10){.pilcrow}

As CT_abs grows larger, CT_abs - DT_abs gets LARGER in (non-negative)
modular arithmetic until the time at which CT_ABS == DT_ABS, and
suddenly CT_ABS - DT_abs becomes zero. Also suddenly, the test condition
is no longer fulfilled.[¶](#section-appendix.a-11){.pilcrow}

As CT_abs grows still larger, CT_abs \> DT_abs, and we need to detect
this condition as soon as possible. Requiring the SAFETY_FACTOR enables
this detection until CT_abs exceeds DT_abs by an amount equal to
SAFETY_FACTOR\*2\^N.[¶](#section-appendix.a-12){.pilcrow}

A note about \"inverting the inequality\". Observe that a \< b implies
that -a \> -b on the real number line. Also, (a - b) == -(b - a). These
facts hold also for modular
arithmetic.[¶](#section-appendix.a-13){.pilcrow}

During the times prior to the expiration of the deadline, for Safe =
2\^N\*SAFETY_FACTOR we have:[¶](#section-appendix.a-14){.pilcrow}

(DT_abs - 2\^N) \< OT_abs \< CT_abs \< DT_abs \<
DT_abs+Safe[¶](#section-appendix.a-15){.pilcrow}

Naturally, DT_abs - 2\^N == DT_abs mod 2\^N ==
DT.[¶](#section-appendix.a-16){.pilcrow}

Again considering [Figure 8](#fig7){.xref}, it is easy to see that
{CT_abs - (DT_abs - 2\^N)} gets larger and larger until the time at
which CT_abs = DT_abs, which is the first time at which CT - DT == 0 mod
2\^N. As CT_abs increases past the deadline time, 0 \< CT_abs - DT_abs
\< Safe. In this range, any intermediate node can detect that the
deadline has expired. As CT_abs increases past DT_abs+Safe, it is no
longer possible for an intermediate node to determine with certainty
whether or not the deadline time has expired. These statements also
apply when reduced to modular arithmetic in the modulus
2\^N.[¶](#section-appendix.a-17){.pilcrow}

In particular, the test condition no longer allows detection of deadline
expiration when the current time becomes later than (DT_abs+Safe). In
order to maintain correctness even for packets that are forwarded after
expiration (i.e., the \'D\' flag), N has to be chosen to be so large
that the test condition will not fail \-- i.e., that in all scenarios of
interest, the packet will be dropped before the current time becomes
equal to
DT_abs+2\^N\*SAFETY_FACTOR.[¶](#section-appendix.a-18){.pilcrow}
:::
:::

::: {#section-appendix.b .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors thank [Pascal Thubert]{.contact-name} for suggesting the
idea and encouraging the work. Thanks to [Shwetha
Bhandari]{.contact-name}\'s suggestions, which were instrumental in
extending the timing information to heterogeneous networks. The authors
acknowledge the 6TiSCH WG members for their inputs on the mailing list.
Special thanks to [Jerry Daniel]{.contact-name}, [Dan
Frost]{.contact-name} (Routing Directorate), [Charlie
Kaufman]{.contact-name} (Security Directorate), [Seema
Kumar]{.contact-name}, [Tal Mizrahi]{.contact-name}, [Avinash
Mohan]{.contact-name}, [Shalu Rajendran]{.contact-name}, [Anita
Varghese]{.contact-name}, and [Dale Worley]{.contact-name} (General Area
Review Team (Gen-ART) review) for their support and valuable
feedback.[¶](#section-appendix.b-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#section-appendix.c .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Lijo Thomas]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Centre for Development of Advanced Computing]{.org}
:::

::: {.left dir="auto"}
[Vellayambalam]{.street-address}
:::

::: {.left dir="auto"}
[Trivandrum]{.locality} [695033]{.postal-code}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <lijo@cdac.in>
:::

::: {.left dir="auto"}
[Satish Anamalamudi]{.fn .nameRole}
:::

::: {.left dir="auto"}
[SRM University-AP]{.org}
:::

::: {.left dir="auto"}
[Amaravati Campus]{.street-address}
:::

::: {.left dir="auto"}
[Amaravati, Andhra Pradesh]{.locality} [522 502]{.postal-code}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <satishnaidu80@gmail.com>
:::

::: {.left dir="auto"}
[S.V.R. Anand]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Indian Institute of Science]{.org}
:::

::: {.left dir="auto"}
[Bangalore]{.locality} [560012]{.postal-code}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <anandsvr@iisc.ac.in>
:::

::: {.left dir="auto"}
[Malati Hegde]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Indian Institute of Science]{.org}
:::

::: {.left dir="auto"}
[Bangalore]{.locality} [560012]{.postal-code}
:::

::: {.left dir="auto"}
[India]{.country-name}
:::

::: email
Email: <malati@iisc.ac.in>
:::

::: {.left dir="auto"}
[Charles E. Perkins]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Lupin Lodge]{.org}
:::

::: {.left dir="auto"}
[20600 Aldercroft Heights Rd.]{.street-address}
:::

::: {.left dir="auto"}
[Los Gatos]{.locality}, [CA]{.region} [95033]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: email
Email: <charliep@computer.org>
:::
:::
:::
