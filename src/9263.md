  RFC 9263      NSH MD2 Context Headers   August 2022
  ------------- ------------------------- -------------
  Wei, et al.   Standards Track           \[Page\]

::: {#external-metadata .document-information}
:::

::: {#internal-metadata .document-information}

Stream:
:   Internet Engineering Task Force (IETF)

RFC:
:   [9263](https://www.rfc-editor.org/rfc/rfc9263){.eref}

Category:
:   Standards Track

Published:
:   August 2022

ISSN:
:   2070-1721

Authors:

:   ::: author
    ::: author-name
    Y. Wei, [Ed.]{.editor}
    :::

    ::: org
    ZTE Corporation
    :::
    :::

    ::: author
    ::: author-name
    U. Elzur
    :::

    ::: org
    Intel
    :::
    :::

    ::: author
    ::: author-name
    S. Majee
    :::

    ::: org
    Individual Contributor
    :::
    :::

    ::: author
    ::: author-name
    C. Pignataro
    :::

    ::: org
    Cisco
    :::
    :::

    ::: author
    ::: author-name
    D. Eastlake 3rd
    :::

    ::: org
    Futurewei Technologies
    :::
    :::
:::

# RFC 9263 {#rfcnum}

# Network Service Header (NSH) Metadata Type 2 Variable-Length Context Headers {#title}

::: {#section-abstract .section}
## [Abstract](#abstract){.selfRef}

Service Function Chaining (SFC) uses the Network Service Header (NSH)
(RFC 8300) to steer and provide context metadata (MD) with each packet.
Such metadata can be of various types, including MD Type 2, consisting
of Variable-Length Context Headers. This document specifies several such
Context Headers that can be used within a Service Function Path
(SFP).[¶](#section-abstract-1){.pilcrow}
:::

::: {#status-of-memo}
::: {#section-boilerplate.1 .section}
## [Status of This Memo](#name-status-of-this-memo){.section-name .selfRef} {#name-status-of-this-memo}

This is an Internet Standards Track
document.[¶](#section-boilerplate.1-1){.pilcrow}

This document is a product of the Internet Engineering Task Force
(IETF). It represents the consensus of the IETF community. It has
received public review and has been approved for publication by the
Internet Engineering Steering Group (IESG). Further information on
Internet Standards is available in Section 2 of RFC
7841.[¶](#section-boilerplate.1-2){.pilcrow}

Information about the current status of this document, any errata, and
how to provide feedback on it may be obtained at
<https://www.rfc-editor.org/info/rfc9263>.[¶](#section-boilerplate.1-3){.pilcrow}
:::
:::

::: {#copyright}
::: {#section-boilerplate.2 .section}
## [Copyright Notice](#name-copyright-notice){.section-name .selfRef} {#name-copyright-notice}

Copyright (c) 2022 IETF Trust and the persons identified as the document
authors. All rights reserved.[¶](#section-boilerplate.2-1){.pilcrow}

This document is subject to BCP 78 and the IETF Trust\'s Legal
Provisions Relating to IETF Documents
(<https://trustee.ietf.org/license-info>) in effect on the date of
publication of this document. Please review these documents carefully,
as they describe your rights and restrictions with respect to this
document. Code Components extracted from this document must include
Revised BSD License text as described in Section 4.e of the Trust Legal
Provisions and are provided without warranty as described in the Revised
BSD License.[¶](#section-boilerplate.2-2){.pilcrow}
:::
:::

::: {#toc}
::: {#section-toc.1 .section}
[▲](#){.toplink}

## [Table of Contents](#name-table-of-contents){.section-name .selfRef} {#name-table-of-contents}

-   ::: {#section-toc.1-1.1}
    [1](#section-1){.xref}.  [Introduction](#name-introduction){.xref}
    :::

-   ::: {#section-toc.1-1.2}
    [2](#section-2){.xref}.  [Conventions Used in This
    Document](#name-conventions-used-in-this-do){.xref}

    -   ::: {#section-toc.1-1.2.2.1}
        [2.1](#section-2.1){.xref}.  [Terminology](#name-terminology){.xref}
        :::

    -   ::: {#section-toc.1-1.2.2.2}
        [2.2](#section-2.2){.xref}.  [Requirements
        Language](#name-requirements-language){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.3}
    [3](#section-3){.xref}.  [NSH MD Type 2
    Format](#name-nsh-md-type-2-format){.xref}
    :::

-   ::: {#section-toc.1-1.4}
    [4](#section-4){.xref}.  [NSH MD Type 2 Context
    Headers](#name-nsh-md-type-2-context-heade){.xref}

    -   ::: {#section-toc.1-1.4.2.1}
        [4.1](#section-4.1){.xref}.  [Forwarding
        Context](#name-forwarding-context){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.2}
        [4.2](#section-4.2){.xref}.  [Tenant ID](#name-tenant-id){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.3}
        [4.3](#section-4.3){.xref}.  [Ingress Network Node
        Information](#name-ingress-network-node-inform){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.4}
        [4.4](#section-4.4){.xref}.  [Ingress Network Source
        Interface](#name-ingress-network-source-inte){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.5}
        [4.5](#section-4.5){.xref}.  [Flow ID](#name-flow-id){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.6}
        [4.6](#section-4.6){.xref}.  [Source and/or Destination
        Groups](#name-source-and-or-destination-g){.xref}
        :::

    -   ::: {#section-toc.1-1.4.2.7}
        [4.7](#section-4.7){.xref}.  [Policy ID](#name-policy-id){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.5}
    [5](#section-5){.xref}.  [Security
    Considerations](#name-security-considerations){.xref}

    -   ::: {#section-toc.1-1.5.2.1}
        [5.1](#section-5.1){.xref}.  [Forwarding
        Context](#name-forwarding-context-2){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.2}
        [5.2](#section-5.2){.xref}.  [Tenant
        ID](#name-tenant-id-2){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.3}
        [5.3](#section-5.3){.xref}.  [Ingress Network Node
        Information](#name-ingress-network-node-informa){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.4}
        [5.4](#section-5.4){.xref}.  [Ingress Node Source
        Interface](#name-ingress-node-source-interfa){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.5}
        [5.5](#section-5.5){.xref}.  [Flow ID](#name-flow-id-2){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.6}
        [5.6](#section-5.6){.xref}.  [Source and/or Destination
        Groups](#name-source-and-or-destination-gr){.xref}
        :::

    -   ::: {#section-toc.1-1.5.2.7}
        [5.7](#section-5.7){.xref}.  [Policy
        ID](#name-policy-id-3){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.6}
    [6](#section-6){.xref}.  [IANA
    Considerations](#name-iana-considerations){.xref}

    -   ::: {#section-toc.1-1.6.2.1}
        [6.1](#section-6.1){.xref}.  [MD Type 2 Context
        Types](#name-md-type-2-context-types){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.2}
        [6.2](#section-6.2){.xref}.  [Forwarding Context
        Types](#name-forwarding-context-types){.xref}
        :::

    -   ::: {#section-toc.1-1.6.2.3}
        [6.3](#section-6.3){.xref}.  [Flow ID Context
        Types](#name-flow-id-context-types){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.7}
    [7](#section-7){.xref}.  [References](#name-references){.xref}

    -   ::: {#section-toc.1-1.7.2.1}
        [7.1](#section-7.1){.xref}.  [Normative
        References](#name-normative-references){.xref}
        :::

    -   ::: {#section-toc.1-1.7.2.2}
        [7.2](#section-7.2){.xref}.  [Informative
        References](#name-informative-references){.xref}
        :::
    :::

-   ::: {#section-toc.1-1.8}
    [](#appendix-A){.xref}[Acknowledgments](#name-acknowledgments){.xref}
    :::

-   ::: {#section-toc.1-1.9}
    [](#appendix-B){.xref}[Authors\'
    Addresses](#name-authors-addresses){.xref}
    :::
:::
:::

::: {#intro}
::: {#section-1 .section}
## [1.](#section-1){.section-number .selfRef} [Introduction](#name-introduction){.section-name .selfRef} {#name-introduction}

The Network Service Header (NSH) \[[RFC8300](#RFC8300){.xref}\] is the
Service Function Chaining (SFC) encapsulation that supports the SFC
architecture \[[RFC7665](#RFC7665){.xref}\]. As such, the NSH provides
the following key elements:[¶](#section-1-1){.pilcrow}

1.  [Service Function Path (SFP)
    identification[¶](#section-1-2.1){.pilcrow}]{#section-1-2.1}
2.  [indication of location within an
    SFP[¶](#section-1-2.2){.pilcrow}]{#section-1-2.2}
3.  [optional, per-packet metadata (fixed-length or
    variable-length)[¶](#section-1-2.3){.pilcrow}]{#section-1-2.3}

\[[RFC8300](#RFC8300){.xref}\] further defines two metadata formats (MD
Types): 1 and 2. MD Type 1 defines the fixed-length, 16-octet metadata,
whereas MD Type 2 defines a variable-length context format for metadata.
This document defines several common metadata Context Headers for use
within NSH MD Type 2. These supplement the Subscriber Identifier and
Performance Policy MD Type 2 metadata Context Headers specified in
\[[RFC8979](#RFC8979){.xref}\].[¶](#section-1-3){.pilcrow}

This document does not address metadata usage, updating/chaining of
metadata, or other SFP functions. Those topics are described in
\[[RFC8300](#RFC8300){.xref}\].[¶](#section-1-4){.pilcrow}
:::
:::

::: {#section-2 .section}
## [2.](#section-2){.section-number .selfRef} [Conventions Used in This Document](#name-conventions-used-in-this-do){.section-name .selfRef} {#name-conventions-used-in-this-do}

::: {#section-2.1 .section}
### [2.1.](#section-2.1){.section-number .selfRef} [Terminology](#name-terminology){.section-name .selfRef} {#name-terminology}

This document uses the terminology defined in the SFC architecture
\[[RFC7665](#RFC7665){.xref}\] and the NSH
\[[RFC8300](#RFC8300){.xref}\].[¶](#section-2.1-1){.pilcrow}
:::

::: {#section-2.2 .section}
### [2.2.](#section-2.2){.section-number .selfRef} [Requirements Language](#name-requirements-language){.section-name .selfRef} {#name-requirements-language}

The key words \"[MUST]{.bcp14}\", \"[MUST NOT]{.bcp14}\",
\"[REQUIRED]{.bcp14}\", \"[SHALL]{.bcp14}\", \"[SHALL NOT]{.bcp14}\",
\"[SHOULD]{.bcp14}\", \"[SHOULD NOT]{.bcp14}\",
\"[RECOMMENDED]{.bcp14}\", \"[NOT RECOMMENDED]{.bcp14}\",
\"[MAY]{.bcp14}\", and \"[OPTIONAL]{.bcp14}\" in this document are to be
interpreted as described in BCP 14 \[[RFC2119](#RFC2119){.xref}\]
\[[RFC8174](#RFC8174){.xref}\] when, and only when, they appear in all
capitals, as shown here.[¶](#section-2.2-1){.pilcrow}
:::
:::

::: {#nsh-t2-format-sec}
::: {#section-3 .section}
## [3.](#section-3){.section-number .selfRef} [NSH MD Type 2 Format](#name-nsh-md-type-2-format){.section-name .selfRef} {#name-nsh-md-type-2-format}

An NSH is composed of a 4-octet Base Header, a 4-octet Service Path
Header, and optional Context Headers. The Base Header identifies the MD
Type in use:[¶](#section-3-1){.pilcrow}

[]{#name-nsh-base-header}

::: {#nsh-base-hdr-fig}
::: {#section-3-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Ver|O|U|    TTL    |   Length  |U|U|U|U|MD Type| Next Protocol |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 1](#figure-1){.selfRef}: [NSH Base
Header](#name-nsh-base-header){.selfRef}
:::

Please refer to the NSH \[[RFC8300](#RFC8300){.xref}\] for a detailed
header description.[¶](#section-3-3){.pilcrow}

When the Base Header specifies MD Type = 0x2, zero or more
Variable-Length Context Headers [MAY]{.bcp14} be added, immediately
following the Service Path Header. [Figure 2](#nsh-tlv-fig){.xref} below
depicts the format of the Context Header as defined in [Section
2.5.1](https://www.rfc-editor.org/rfc/rfc8300#section-2.5.1){.relref} of
\[[RFC8300](#RFC8300){.xref}\].[¶](#section-3-4){.pilcrow}

[]{#name-nsh-variable-length-context}

::: {#nsh-tlv-fig}
::: {#section-3-5.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Metadata Class       |      Type     |U|    Length   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   Variable-Length Metadata                    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 2](#figure-2){.selfRef}: [NSH Variable-Length Context
Headers](#name-nsh-variable-length-context){.selfRef}
:::
:::
:::

::: {#nsh-tlvs-sec}
::: {#section-4 .section}
## [4.](#section-4){.section-number .selfRef} [NSH MD Type 2 Context Headers](#name-nsh-md-type-2-context-heade){.section-name .selfRef} {#name-nsh-md-type-2-context-heade}

\[[RFC8300](#RFC8300){.xref}\] specifies Metadata Class 0x0000 as IETF
Base NSH MD Class. In this document, metadata types are defined for the
IETF Base NSH MD Class. The Context Headers specified in the subsections
below are as follows:[¶](#section-4-1){.pilcrow}

1.  [Forwarding Context[¶](#section-4-2.1){.pilcrow}]{#section-4-2.1}
2.  [Tenant ID[¶](#section-4-2.2){.pilcrow}]{#section-4-2.2}
3.  [Ingress Network Node
    Information[¶](#section-4-2.3){.pilcrow}]{#section-4-2.3}
4.  [Ingress Node Source
    Interface[¶](#section-4-2.4){.pilcrow}]{#section-4-2.4}
5.  [Flow ID[¶](#section-4-2.5){.pilcrow}]{#section-4-2.5}
6.  [Source and/or Destination
    Groups[¶](#section-4-2.6){.pilcrow}]{#section-4-2.6}
7.  [Policy ID[¶](#section-4-2.7){.pilcrow}]{#section-4-2.7}

::: {#fwd-context-sec}
::: {#section-4.1 .section}
### [4.1.](#section-4.1){.section-number .selfRef} [Forwarding Context](#name-forwarding-context){.section-name .selfRef} {#name-forwarding-context}

This metadata context carries a network forwarding context, used for
segregation and forwarding scope. Forwarding context can take several
forms depending on the network environment, for example, Virtual
eXtensible Local Area Network (VXLAN) / Generic Protocol Extension for
VXLAN (VXLAN-GPE) Virtual Network Identifier (VNID), VPN Routing and
Forwarding (VRF) identification, or VLAN.[¶](#section-4.1-1){.pilcrow}

[]{#name-vlan-forwarding-context}

::: {#fwd-context-fig1}
::: {#section-4.1-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x04  |U|  Length = 4 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x0 |             Reserved          |        VLAN ID        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 3](#figure-3){.selfRef}: [VLAN Forwarding
Context](#name-vlan-forwarding-context){.selfRef}
:::

[]{#name-qinq-forwarding-context}

::: {#fwd-context-fig2}
::: {#section-4.1-3.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x04  |U|  Length = 4 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x1 |Resv   |     Service VLAN ID   |    Customer VLAN ID   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 4](#figure-4){.selfRef}: [QinQ Forwarding
Context](#name-qinq-forwarding-context){.selfRef}
:::

[]{#name-mpls-vpn-forwarding-context}

::: {#fwd-context-fig3}
::: {#section-4.1-4.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x04  |U|  Length = 4 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x2 |   Reserved    |              MPLS VPN Label           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 5](#figure-5){.selfRef}: [MPLS VPN Forwarding
Context](#name-mpls-vpn-forwarding-context){.selfRef}
:::

[]{#name-vni-forwarding-context}

::: {#fwd-context-fig4}
::: {#section-4.1-5.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x04  |U|  Length = 4 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x3 | Resv  |            Virtual Network Identifier         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 6](#figure-6){.selfRef}: [VNI Forwarding
Context](#name-vni-forwarding-context){.selfRef}
:::

[]{#name-session-id-forwarding-conte}

::: {#fwd-context-fig5}
::: {#section-4.1-6.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x04  |U|  Length = 8 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x4 |             Reserved                                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                            Session ID                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 7](#figure-7){.selfRef}: [Session ID Forwarding
Context](#name-session-id-forwarding-conte){.selfRef}
:::

The fields are described as follows:[¶](#section-4.1-7){.pilcrow}

[]{.break}

Context Type (CT):

:   This 4-bit field that defines the interpretation of the Forwarding
    Context field. Please see the IANA considerations in [Section
    6.2](#iana-fc-type){.xref}. This document defines these CT
    values:[¶](#section-4.1-8.2.1){.pilcrow}

    []{.break}

    0x0:
    :   12-bit VLAN identifier
        \[[IEEE.802.1Q_2018](#IEEE.802.1Q_2018){.xref}\]. See [Figure
        3](#fwd-context-fig1){.xref}.[¶](#section-4.1-8.2.2.2){.pilcrow}
    :   

    0x1:
    :   24-bit double tagging identifiers. A service VLAN tag followed
        by a customer VLAN tag
        \[[IEEE.802.1Q_2018](#IEEE.802.1Q_2018){.xref}\]. The two VLAN
        IDs are concatenated and appear in the same order that they
        appeared in the payload. See [Figure
        4](#fwd-context-fig2){.xref}.[¶](#section-4.1-8.2.2.4){.pilcrow}
    :   

    0x2:
    :   20-bit MPLS VPN label \[[RFC3032](#RFC3032){.xref}\]
        \[[RFC4364](#RFC4364){.xref}\]. See [Figure
        5](#fwd-context-fig3){.xref}.[¶](#section-4.1-8.2.2.6){.pilcrow}
    :   

    0x3:
    :   24-bit virtual network identifier (VNI)
        \[[RFC8926](#RFC8926){.xref}\]. See [Figure
        6](#fwd-context-fig4){.xref}.[¶](#section-4.1-8.2.2.8){.pilcrow}
    :   

    0x4:
    :   32-bit Session ID \[[RFC3931](#RFC3931){.xref}\]. This is called
        Key in GRE \[[RFC2890](#RFC2890){.xref}\]. See [Figure
        7](#fwd-context-fig5){.xref}.[¶](#section-4.1-8.2.2.10){.pilcrow}
    :   

:   

Reserved (Resv):
:   These bits in the context fields [MUST]{.bcp14} be sent as zero and
    ignored on receipt.[¶](#section-4.1-8.4){.pilcrow}
:   
:::
:::

::: {#tenant-sec}
::: {#section-4.2 .section}
### [4.2.](#section-4.2){.section-number .selfRef} [Tenant ID](#name-tenant-id){.section-name .selfRef} {#name-tenant-id}

Tenant identification is often used for segregation within a
multi-tenant environment. Orchestration system-generated Tenant IDs are
an example of such data. This Context Header carries the value of the
Tenant ID. Virtual Tenant Network (VTN)
\[[OpenDaylight-VTN](#OpenDaylight-VTN){.xref}\] is an application that
provides multi-tenant virtual networks on a Software-Defined Networking
(SDN) controller.[¶](#section-4.2-1){.pilcrow}

[]{#name-tenant-id-list}

::: {#tenant-fig}
::: {#section-4.2-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x05  |U|    Length   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                         Tenant ID                             ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 8](#figure-8){.selfRef}: [Tenant ID
List](#name-tenant-id-list){.selfRef}
:::

The fields are described as follows:[¶](#section-4.2-3){.pilcrow}

[]{.break}

Length:
:   Indicates the length of the Tenant ID in octets (see [Section
    2.5.1](https://www.rfc-editor.org/rfc/rfc8300#section-2.5.1){.relref}
    of \[[RFC8300](#RFC8300){.xref}\]).[¶](#section-4.2-4.2){.pilcrow}
:   

Tenant ID:
:   Represents an opaque value pointing to orchestration
    system-generated Tenant ID. The structure and semantics of this
    field are specific to the operator\'s deployment across its
    operational domain and are specified and assigned by an
    orchestration function. The specifics of that orchestration-based
    assignment are outside the scope of this
    document.[¶](#section-4.2-4.4){.pilcrow}
:   
:::
:::

::: {#ingress-net-nodeid-sec}
::: {#section-4.3 .section}
### [4.3.](#section-4.3){.section-number .selfRef} [Ingress Network Node Information](#name-ingress-network-node-inform){.section-name .selfRef} {#name-ingress-network-node-inform}

This Context Header carries a Node ID of the network node at which the
packet entered the SFC-enabled domain. This node will necessarily be a
classifier \[[RFC7665](#RFC7665){.xref}\]. In cases where the Service
Path Identifier (SPI) identifies the ingress node, this Context Header
is superfluous.[¶](#section-4.3-1){.pilcrow}

[]{#name-ingress-network-node-id}

::: {#ingress-net-nodeid-fig}
::: {#section-4.3-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x06  |U|   Length    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                        Node ID                                ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 9](#figure-9){.selfRef}: [Ingress Network Node
ID](#name-ingress-network-node-id){.selfRef}
:::

The fields are described as follows:[¶](#section-4.3-3){.pilcrow}

[]{.break}

Length:
:   Indicates the length of the Node ID in octets (see [Section
    2.5.1](https://www.rfc-editor.org/rfc/rfc8300#section-2.5.1){.relref}
    of \[[RFC8300](#RFC8300){.xref}\]).[¶](#section-4.3-4.2){.pilcrow}
:   

Node ID:
:   Represents an opaque value of the ingress network Node ID. The
    structure and semantics of this field are deployment specific. For
    example, Node ID may be a 4-octet IPv4 address Node ID, a 16-octet
    IPv6 address Node ID, a 6-octet MAC address, an 8-octet MAC address
    (64-bit Extended Unique Identifier (EUI-64)),
    etc.[¶](#section-4.3-4.4){.pilcrow}
:   
:::
:::

::: {#ingress-net-sitf-sec}
::: {#section-4.4 .section}
### [4.4.](#section-4.4){.section-number .selfRef} [Ingress Network Source Interface](#name-ingress-network-source-inte){.section-name .selfRef} {#name-ingress-network-source-inte}

This context identifies the ingress interface of the ingress network
node. The l2vlan (135), l3ipvlan (136), ipForward (142), and mpls (166)
in \[[IANAifType](#IANAifType){.xref}\] are examples of source
interfaces.[¶](#section-4.4-1){.pilcrow}

[]{#name-ingress-network-source-inter}

::: {#ingress-net-sitf-fig}
::: {#section-4.4-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x07  |U|    Length   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                     Source Interface                          ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 10](#figure-10){.selfRef}: [Ingress Network Source
Interface](#name-ingress-network-source-inter){.selfRef}
:::

The fields are described as follows:[¶](#section-4.4-3){.pilcrow}

[]{.break}

Length:
:   Indicates the length of the Source Interface in octets (see [Section
    2.5.1](https://www.rfc-editor.org/rfc/rfc8300#section-2.5.1){.relref}
    of \[[RFC8300](#RFC8300){.xref}\]).[¶](#section-4.4-4.2){.pilcrow}
:   

Source Interface:
:   Represents an opaque value of the identifier of the ingress
    interface of the ingress network
    node.[¶](#section-4.4-4.4){.pilcrow}
:   
:::
:::

::: {#flow-id-sec}
::: {#section-4.5 .section}
### [4.5.](#section-4.5){.section-number .selfRef} [Flow ID](#name-flow-id){.section-name .selfRef} {#name-flow-id}

Flow ID provides a field in NSH MD Type 2 to label packets belonging to
the same flow. For example, \[[RFC8200](#RFC8200){.xref}\] defines IPv6
Flow Label as Flow ID. Another example of Flow ID is how
\[[RFC6790](#RFC6790){.xref}\] defines an entropy label that is
generated based on flow information in the MPLS network. Absence of this
field or a value of zero denotes that packets have not been labeled with
a Flow ID.[¶](#section-4.5-1){.pilcrow}

[]{#name-ipv6-flow-id}

::: {#flow-id-ipv6-fig1}
::: {#section-4.5-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x08  |U| Length = 4  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x0 |   Reserved    |           IPv6 Flow ID                |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 11](#figure-11){.selfRef}: [IPv6 Flow
ID](#name-ipv6-flow-id){.selfRef}
:::

[]{#name-mpls-entropy-label}

::: {#flow-id-mplse-fig2}
::: {#section-4.5-3.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x08  |U| Length = 4  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |CT=0x1 |   Reserved    |        MPLS entropy label             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 12](#figure-12){.selfRef}: [MPLS Entropy
Label](#name-mpls-entropy-label){.selfRef}
:::

The fields are described as follows:[¶](#section-4.5-4){.pilcrow}

[]{.break}

Length:
:   Indicates the length of the Flow ID in octets (see [Section
    2.5.1](https://www.rfc-editor.org/rfc/rfc8300#section-2.5.1){.relref}
    of \[[RFC8300](#RFC8300){.xref}\]). For example, the IPv6 Flow Label
    in \[[RFC8200](#RFC8200){.xref}\] is 20 bits long. An entropy label
    in the MPLS network in \[[RFC6790](#RFC6790){.xref}\] is also 20
    bits long.[¶](#section-4.5-5.2){.pilcrow}
:   

Context Type (CT):

:   This 4-bit field that defines the interpretation of the Flow ID
    field. Please see the IANA considerations in [Section
    6.3](#iana-tlv-flowid-type){.xref}. This document defines these CT
    values:[¶](#section-4.5-5.4.1){.pilcrow}

    []{.break}

    0x0:
    :   20-bit IPv6 Flow Label in \[[RFC8200](#RFC8200){.xref}\]. See
        [Figure
        11](#flow-id-ipv6-fig1){.xref}.[¶](#section-4.5-5.4.2.2){.pilcrow}
    :   

    0x1:
    :   20-bit entropy label in the MPLS network in
        \[[RFC6790](#RFC6790){.xref}\]. See [Figure
        12](#flow-id-mplse-fig2){.xref}.[¶](#section-4.5-5.4.2.4){.pilcrow}
    :   

:   

Reserved:
:   These bits in the context fields [MUST]{.bcp14} be sent as zero and
    ignored on receipt.[¶](#section-4.5-5.6){.pilcrow}
:   
:::
:::

::: {#src-dst-group-sec}
::: {#section-4.6 .section}
### [4.6.](#section-4.6){.section-number .selfRef} [Source and/or Destination Groups](#name-source-and-or-destination-g){.section-name .selfRef} {#name-source-and-or-destination-g}

Intent-based systems can use this data to express the logical grouping
of source and/or destination objects. \[[OpenStack](#OpenStack){.xref}\]
and \[[OpenDaylight](#OpenDaylight){.xref}\] provide examples of such a
system. Each is expressed as a 32-bit opaque
object.[¶](#section-4.6-1){.pilcrow}

[]{#name-source-destination-groups}

::: {#src-dst-group-fig}
::: {#section-4.6-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x09  |U|  Length=8   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Source Group                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Destination Group                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 13](#figure-13){.selfRef}: [Source/Destination
Groups](#name-source-destination-groups){.selfRef}
:::

If there is no group information specified for the Source Group or
Destination Group field, the field [MUST]{.bcp14} be sent as zero and
ignored on receipt.[¶](#section-4.6-3){.pilcrow}
:::
:::

::: {#policy-id-sec}
::: {#section-4.7 .section}
### [4.7.](#section-4.7){.section-number .selfRef} [Policy ID](#name-policy-id){.section-name .selfRef} {#name-policy-id}

Traffic handling policies are often referred to by a system-generated
identifier, which is then used by the devices to look up the policy\'s
content locally. For example, this identifier could be an index to an
array, a lookup key, or a database ID. The identifier allows enforcement
agents or services to look up the content of their part of the
policy.[¶](#section-4.7-1){.pilcrow}

[]{#name-policy-id-2}

::: {#policy-id-fig}
::: {#section-4.7-2.1 .alignCenter .art-text .artwork}
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Metadata Class = 0x0000    |  Type = 0x0A  |U|    Length   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    ~                           Policy ID                           ~
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
:::

[Figure 14](#figure-14){.selfRef}: [Policy
ID](#name-policy-id-2){.selfRef}
:::

The fields are described as follows:[¶](#section-4.7-3){.pilcrow}

[]{.break}

Length:
:   Indicates the length of the Policy ID in octets (see [Section
    2.5.1](https://www.rfc-editor.org/rfc/rfc8300#section-2.5.1){.relref}
    of \[[RFC8300](#RFC8300){.xref}\]).[¶](#section-4.7-4.2){.pilcrow}
:   

Policy ID:
:   Represents an opaque value of the Policy
    ID.[¶](#section-4.7-4.4){.pilcrow}
:   

This Policy ID is a general Policy ID, essentially a key to allow
Service Functions (SFs) to know which policies to apply to packets.
Those policies generally will not have much to do with performance but
rather with what specific treatment to apply. It may, for example,
select a URL filter data set for a URL filter or select a video
transcoding policy in a transcoding SF. The Performance Policy ID in
\[[RFC8979](#RFC8979){.xref}\] is described there as having very
specific use and, for example, says that fully controlled SFPs would not
use it. The Policy ID in this document is for cases not covered by
\[[RFC8979](#RFC8979){.xref}\].[¶](#section-4.7-5){.pilcrow}
:::
:::
:::
:::

::: {#security-sec}
::: {#section-5 .section}
## [5.](#section-5){.section-number .selfRef} [Security Considerations](#name-security-considerations){.section-name .selfRef} {#name-security-considerations}

A misbehaving node from within the SFC-enabled domain may alter the
content of the Context Headers, which may lead to service disruption.
Such an attack is not unique to the Context Headers defined in this
document. Measures discussed in [Section
8](https://www.rfc-editor.org/rfc/rfc8300#section-8){.relref} of
\[[RFC8300](#RFC8300){.xref}\] describes the general security
considerations for protecting the NSH. \[[RFC9145](#RFC9145){.xref}\]
specifies methods of protecting the integrity of the NSH metadata. If
the NSH includes the Message Authentication Code (MAC) and Encrypted
Metadata Context Header \[[RFC9145](#RFC9145){.xref}\], the
authentication of the packet [MUST]{.bcp14} be verified before using any
data. If the verification fails, the receiver [MUST]{.bcp14} stop
processing the Variable-Length Context Headers and notify an
operator.[¶](#section-5-1){.pilcrow}

The security and privacy considerations for the 7 types of Context
Headers specified above are discussed below. Since NSH-ignorant SFs will
never see the NSH, then even if they are malign, they cannot compromise
security or privacy based on the NSH or any of these Context Headers;
however, they could cause compromise based on the rest of the packet. To
the extent that any of these headers are included when they would be
unneeded or have no effect, they provide a covert channel for the entity
adding the Context Header to communicate a limited amount of arbitrary
information to downstream entities within the SFC-enabled
domain.[¶](#section-5-2){.pilcrow}

::: {#section-5.1 .section}
### [5.1.](#section-5.1){.section-number .selfRef} [Forwarding Context](#name-forwarding-context-2){.section-name .selfRef} {#name-forwarding-context-2}

All of the Forwarding Context variants specified in this document (those
with CT values between 0 and 4) merely repeat a field that is available
in the packet encapsulated by the NSH. These variants repeat that field
in the NSH for convenience. Thus, there are no special security or
privacy considerations in these cases. Any future new values of CT for
the Forwarding Context must specify the security and privacy
considerations for those extensions.[¶](#section-5.1-1){.pilcrow}
:::

::: {#section-5.2 .section}
### [5.2.](#section-5.2){.section-number .selfRef} [Tenant ID](#name-tenant-id-2){.section-name .selfRef} {#name-tenant-id-2}

The Tenant ID indicates the tenant to which traffic belongs and might be
used to tie together and correlate packets for a tenant that some
monitoring function could not otherwise group, especially if other
possible identifiers were being randomized. As such, it may reduce
security by facilitating traffic analysis but only within the
SFC-enabled domain where this Context Header is present in
packets.[¶](#section-5.2-1){.pilcrow}
:::

::: {#section-5.3 .section}
### [5.3.](#section-5.3){.section-number .selfRef} [Ingress Network Node Information](#name-ingress-network-node-informa){.section-name .selfRef} {#name-ingress-network-node-informa}

The SFC-enabled domain manager normally operates the initial
ingress/classifier node and is thus potentially aware of the information
provided by this Context Header. Furthermore, in many cases, the SPI
that will be present in the NSH identifies or closely constrains the
ingress node. Also, in most cases, it is anticipated that many entities
will be sending packets into an SFC-enabled domain through the same
ingress node. Thus, under most circumstances, this Context Header is
expected to weaken security and privacy to only a minor extent and only
within the SFC-enabled domain.[¶](#section-5.3-1){.pilcrow}
:::

::: {#section-5.4 .section}
### [5.4.](#section-5.4){.section-number .selfRef} [Ingress Node Source Interface](#name-ingress-node-source-interfa){.section-name .selfRef} {#name-ingress-node-source-interfa}

This Context Header is likely to be meaningless unless the Ingress
Network Node Information Context Header is also present. When that node
information header is present, this source interface header provides a
more fine-grained view of the source by identifying not just the initial
ingress/classifier node but also the port of that node on which the data
arrived. Thus, it is more likely to identify a specific source entity or
at least to more tightly constrain the set of possible source entities
than just the node information header. As a result, inclusion of this
Context Header with the node information Context Header is potentially a
greater threat to security and privacy than the node information header
alone, but this threat is still constrained to the SFC-enabled
domain.[¶](#section-5.4-1){.pilcrow}
:::

::: {#section-5.5 .section}
### [5.5.](#section-5.5){.section-number .selfRef} [Flow ID](#name-flow-id-2){.section-name .selfRef} {#name-flow-id-2}

The variations of this Context Header specified in this document simply
repeat fields already available in the packet and thus have no special
security or privacy considerations. Any future new values of CT for the
Flow ID must specify the security and privacy considerations for those
extensions.[¶](#section-5.5-1){.pilcrow}
:::

::: {#section-5.6 .section}
### [5.6.](#section-5.6){.section-number .selfRef} [Source and/or Destination Groups](#name-source-and-or-destination-gr){.section-name .selfRef} {#name-source-and-or-destination-gr}

This Context Header provides additional information that might help
identify the source and/or destination of packets. Depending on the
granularity of the groups, it could either (1) distinguish packets as
part of flows from and/or to objects where those flows could not
otherwise be easily distinguished but appear to be part of one or fewer
flows or (2) group packet flows that are from and/or to an object where
those flows could not otherwise be easily grouped for analysis or
another purpose. Thus, the presence of this Context Header with non-zero
source and/or destination groups can, within the SFC-enabled domain,
erode security and privacy to an extent that depends on the details of
the grouping.[¶](#section-5.6-1){.pilcrow}
:::

::: {#section-5.7 .section}
### [5.7.](#section-5.7){.section-number .selfRef} [Policy ID](#name-policy-id-3){.section-name .selfRef} {#name-policy-id-3}

This Context Header carries an identifier that nodes in the SFC-enabled
domain can use to look up policy to potentially influence their actions
with regard to the packet carrying this header. If there are no such
decisions regarding their actions, then the header should not be
included. If there are such decisions, the information on which they are
to be based needs to be included somewhere in the packet. There is no
reason for inclusion in this Context Header to have any security or
privacy considerations that would not apply to any other plaintext way
of including such information. It may provide additional information to
help identify a flow of data for analysis.[¶](#section-5.7-1){.pilcrow}
:::
:::
:::

::: {#iana-tlv-class-reg-sec}
::: {#section-6 .section}
## [6.](#section-6){.section-number .selfRef} [IANA Considerations](#name-iana-considerations){.section-name .selfRef} {#name-iana-considerations}

::: {#iana-tlv-class-context-type}
::: {#section-6.1 .section}
### [6.1.](#section-6.1){.section-number .selfRef} [MD Type 2 Context Types](#name-md-type-2-context-types){.section-name .selfRef} {#name-md-type-2-context-types}

IANA has assigned the following types ([Table
1](#type-values-tbl){.xref}) from the \"NSH IETF-Assigned Optional
Variable-Length Metadata Types\" registry available at
\[[IANA-NSH-MD2](#IANA-NSH-MD2){.xref}\].[¶](#section-6.1-1){.pilcrow}

[]{#name-type-values}

::: {#type-values-tbl}
  Value   Description                        Reference
  ------- ---------------------------------- -----------
  0x04    Forwarding Context                 RFC 9263
  0x05    Tenant ID                          RFC 9263
  0x06    Ingress Network Node ID            RFC 9263
  0x07    Ingress Network Interface          RFC 9263
  0x08    Flow ID                            RFC 9263
  0x09    Source and/or Destination Groups   RFC 9263
  0x0A    Policy ID                          RFC 9263

  : [Table 1](#table-1){.selfRef}: [Type
  Values](#name-type-values){.selfRef}
:::
:::
:::

::: {#iana-fc-type}
::: {#section-6.2 .section}
### [6.2.](#section-6.2){.section-number .selfRef} [Forwarding Context Types](#name-forwarding-context-types){.section-name .selfRef} {#name-forwarding-context-types}

IANA has created a new subregistry for \"Forwarding Context Types\" at
\[[IANA-NSH-MD2](#IANA-NSH-MD2){.xref}\] as
follows.[¶](#section-6.2-1){.pilcrow}

The registration policy is IETF Review.[¶](#section-6.2-2){.pilcrow}

[]{#name-forwarding-context-types-2}

::: {#Forwarding-CT-iana-tbl}
  Value     Description                               Reference
  --------- ----------------------------------------- -----------
  0x0       12-bit VLAN identifier                    RFC 9263
  0x1       24-bit double tagging identifiers         RFC 9263
  0x2       20-bit MPLS VPN label                     RFC 9263
  0x3       24-bit virtual network identifier (VNI)   RFC 9263
  0x4       32-bit Session ID                         RFC 9263
  0x5-0xE   Unassigned                                
  0xF       Reserved                                  RFC 9263

  : [Table 2](#table-2){.selfRef}: [Forwarding Context
  Types](#name-forwarding-context-types-2){.selfRef}
:::
:::
:::

::: {#iana-tlv-flowid-type}
::: {#section-6.3 .section}
### [6.3.](#section-6.3){.section-number .selfRef} [Flow ID Context Types](#name-flow-id-context-types){.section-name .selfRef} {#name-flow-id-context-types}

IANA has created a new subregistry for \"Flow ID Context Types\" at
\[[IANA-NSH-MD2](#IANA-NSH-MD2){.xref}\] as
follows.[¶](#section-6.3-1){.pilcrow}

The registration policy is IETF Review.[¶](#section-6.3-2){.pilcrow}

[]{#name-flow-id-context-types-2}

::: {#flow-id-CT-iana-tbl}
  Value     Description                                Reference
  --------- ------------------------------------------ -----------
  0x0       20-bit IPv6 Flow Label                     RFC 9263
  0x1       20-bit entropy label in the MPLS network   RFC 9263
  0x2-0xE   Unassigned                                 
  0xF       Reserved                                   RFC 9263

  : [Table 3](#table-3){.selfRef}: [Flow ID Context
  Types](#name-flow-id-context-types-2){.selfRef}
:::
:::
:::
:::
:::

::: {#section-7 .section}
## [7.](#section-7){.section-number .selfRef} [References](#name-references){.section-name .selfRef} {#name-references}

::: {#section-7.1 .section}
### [7.1.](#section-7.1){.section-number .selfRef} [Normative References](#name-normative-references){.section-name .selfRef} {#name-normative-references}

\[IANA-NSH-MD2\]
:   [IANA]{.refAuthor}, [\"Network Service Header (NSH)
    Parameters\"]{.refTitle},
    \<<https://www.iana.org/assignments/nsh>\>.
:   

\[IEEE.802.1Q_2018\]
:   [IEEE]{.refAuthor}, [\"IEEE Standard for Local and Metropolitan Area
    Network \-- Bridges and Bridged Networks\"]{.refTitle}, July 2018,
    \<<https://ieeexplore.ieee.org/document/8403927>\>.
:   

\[RFC2119\]
:   [Bradner, S.]{.refAuthor}, [\"Key words for use in RFCs to Indicate
    Requirement Levels\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    2119]{.seriesInfo}, [DOI 10.17487/RFC2119]{.seriesInfo}, March 1997,
    \<<https://www.rfc-editor.org/info/rfc2119>\>.
:   

\[RFC3931\]
:   [Lau, J., Ed.]{.refAuthor}, [Townsley, M., Ed.]{.refAuthor}, and [I.
    Goyret, Ed.]{.refAuthor}, [\"Layer Two Tunneling Protocol - Version
    3 (L2TPv3)\"]{.refTitle}, [RFC 3931]{.seriesInfo}, [DOI
    10.17487/RFC3931]{.seriesInfo}, March 2005,
    \<<https://www.rfc-editor.org/info/rfc3931>\>.
:   

\[RFC8174\]
:   [Leiba, B.]{.refAuthor}, [\"Ambiguity of Uppercase vs Lowercase in
    RFC 2119 Key Words\"]{.refTitle}, [BCP 14]{.seriesInfo}, [RFC
    8174]{.seriesInfo}, [DOI 10.17487/RFC8174]{.seriesInfo}, May 2017,
    \<<https://www.rfc-editor.org/info/rfc8174>\>.
:   

\[RFC8300\]
:   [Quinn, P., Ed.]{.refAuthor}, [Elzur, U., Ed.]{.refAuthor}, and [C.
    Pignataro, Ed.]{.refAuthor}, [\"Network Service Header
    (NSH)\"]{.refTitle}, [RFC 8300]{.seriesInfo}, [DOI
    10.17487/RFC8300]{.seriesInfo}, January 2018,
    \<<https://www.rfc-editor.org/info/rfc8300>\>.
:   

\[RFC9145\]
:   [Boucadair, M.]{.refAuthor}, [Reddy.K, T.]{.refAuthor}, and [D.
    Wing]{.refAuthor}, [\"Integrity Protection for the Network Service
    Header (NSH) and Encryption of Sensitive Context
    Headers\"]{.refTitle}, [RFC 9145]{.seriesInfo}, [DOI
    10.17487/RFC9145]{.seriesInfo}, December 2021,
    \<<https://www.rfc-editor.org/info/rfc9145>\>.
:   
:::

::: {#section-7.2 .section}
### [7.2.](#section-7.2){.section-number .selfRef} [Informative References](#name-informative-references){.section-name .selfRef} {#name-informative-references}

\[IANAifType\]
:   [IANA]{.refAuthor}, [\"IANAifType-MIB DEFINITIONS\"]{.refTitle},
    2021, \<<https://www.iana.org/assignments/ianaiftype-mib>\>.
:   

\[OpenDaylight\]
:   [OpenDaylight]{.refAuthor}, [\"Group Based Policy User
    Guide\"]{.refTitle}, 2021,
    \<<https://docs.opendaylight.org/en/stable-fluorine/user-guide/group-based-policy-user-guide.html?highlight=group%20policy#>\>.
:   

\[OpenDaylight-VTN\]
:   [OpenDaylight]{.refAuthor}, [\"OpenDaylight VTN\"]{.refTitle}, 2021,
    \<<https://nexus.opendaylight.org/content/sites/site/org.opendaylight.docs/master/userguide/manuals/userguide/bk-user-guide/content/_vtn.html>\>.
:   

\[OpenStack\]
:   [OpenStack]{.refAuthor}, [\"GroupBasedPolicy\"]{.refTitle}, 2021,
    \<<https://wiki.openstack.org/wiki/GroupBasedPolicy>\>.
:   

\[RFC2890\]
:   [Dommety, G.]{.refAuthor}, [\"Key and Sequence Number Extensions to
    GRE\"]{.refTitle}, [RFC 2890]{.seriesInfo}, [DOI
    10.17487/RFC2890]{.seriesInfo}, September 2000,
    \<<https://www.rfc-editor.org/info/rfc2890>\>.
:   

\[RFC3032\]
:   [Rosen, E.]{.refAuthor}, [Tappan, D.]{.refAuthor},
    [Fedorkow, G.]{.refAuthor}, [Rekhter, Y.]{.refAuthor},
    [Farinacci, D.]{.refAuthor}, [Li, T.]{.refAuthor}, and [A.
    Conta]{.refAuthor}, [\"MPLS Label Stack Encoding\"]{.refTitle}, [RFC
    3032]{.seriesInfo}, [DOI 10.17487/RFC3032]{.seriesInfo}, January
    2001, \<<https://www.rfc-editor.org/info/rfc3032>\>.
:   

\[RFC4364\]
:   [Rosen, E.]{.refAuthor} and [Y. Rekhter]{.refAuthor}, [\"BGP/MPLS IP
    Virtual Private Networks (VPNs)\"]{.refTitle}, [RFC
    4364]{.seriesInfo}, [DOI 10.17487/RFC4364]{.seriesInfo}, February
    2006, \<<https://www.rfc-editor.org/info/rfc4364>\>.
:   

\[RFC6790\]
:   [Kompella, K.]{.refAuthor}, [Drake, J.]{.refAuthor},
    [Amante, S.]{.refAuthor}, [Henderickx, W.]{.refAuthor}, and [L.
    Yong]{.refAuthor}, [\"The Use of Entropy Labels in MPLS
    Forwarding\"]{.refTitle}, [RFC 6790]{.seriesInfo}, [DOI
    10.17487/RFC6790]{.seriesInfo}, November 2012,
    \<<https://www.rfc-editor.org/info/rfc6790>\>.
:   

\[RFC7665\]
:   [Halpern, J., Ed.]{.refAuthor} and [C. Pignataro, Ed.]{.refAuthor},
    [\"Service Function Chaining (SFC) Architecture\"]{.refTitle}, [RFC
    7665]{.seriesInfo}, [DOI 10.17487/RFC7665]{.seriesInfo}, October
    2015, \<<https://www.rfc-editor.org/info/rfc7665>\>.
:   

\[RFC8200\]
:   [Deering, S.]{.refAuthor} and [R. Hinden]{.refAuthor}, [\"Internet
    Protocol, Version 6 (IPv6) Specification\"]{.refTitle}, [STD
    86]{.seriesInfo}, [RFC 8200]{.seriesInfo}, [DOI
    10.17487/RFC8200]{.seriesInfo}, July 2017,
    \<<https://www.rfc-editor.org/info/rfc8200>\>.
:   

\[RFC8926\]
:   [Gross, J., Ed.]{.refAuthor}, [Ganga, I., Ed.]{.refAuthor}, and [T.
    Sridhar, Ed.]{.refAuthor}, [\"Geneve: Generic Network Virtualization
    Encapsulation\"]{.refTitle}, [RFC 8926]{.seriesInfo}, [DOI
    10.17487/RFC8926]{.seriesInfo}, November 2020,
    \<<https://www.rfc-editor.org/info/rfc8926>\>.
:   

\[RFC8979\]
:   [Sarikaya, B.]{.refAuthor}, [von Hugo, D.]{.refAuthor}, and [M.
    Boucadair]{.refAuthor}, [\"Subscriber and Performance Policy
    Identifier Context Headers in the Network Service Header
    (NSH)\"]{.refTitle}, [RFC 8979]{.seriesInfo}, [DOI
    10.17487/RFC8979]{.seriesInfo}, February 2021,
    \<<https://www.rfc-editor.org/info/rfc8979>\>.
:   
:::
:::

::: {#appendix-A .section}
## [Acknowledgments](#name-acknowledgments){.section-name .selfRef} {#name-acknowledgments}

The authors would like to thank [Paul Quinn]{.contact-name}, [Behcet
Sarikaya]{.contact-name}, [Dirk von Hugo]{.contact-name}, [Mohamed
Boucadair]{.contact-name}, [Gregory Mirsky]{.contact-name}, and [Joel
Halpern]{.contact-name} for providing invaluable concepts and content
for this document.[¶](#appendix-A-1){.pilcrow}
:::

::: {#authors-addresses}
::: {#appendix-B .section}
## [Authors\' Addresses](#name-authors-addresses){.section-name .selfRef} {#name-authors-addresses}

::: {.left dir="auto"}
[Yuehua Wei ([editor]{.role})]{.fn .nameRole}
:::

::: {.left dir="auto"}
[ZTE Corporation]{.org}
:::

::: {.left dir="auto"}
[No.50, Software Avenue]{.street-address}
:::

::: {.left dir="auto"}
[Nanjing]{.locality}
:::

::: {.left dir="auto"}
[210012]{.postal-code}
:::

::: {.left dir="auto"}
[China]{.country-name}
:::

::: email
Email: <wei.yuehua@zte.com.cn>
:::

::: {.left dir="auto"}
[Uri Elzur]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Intel]{.org}
:::

::: email
Email: <uri.elzur@intel.com>
:::

::: {.left dir="auto"}
[Sumandra Majee]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Individual Contributor]{.org}
:::

::: email
Email: <Sum.majee@gmail.com>
:::

::: {.left dir="auto"}
[Carlos Pignataro]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Cisco]{.org}
:::

::: email
Email: <cpignata@cisco.com>
:::

::: {.left dir="auto"}
[Donald E. Eastlake, 3rd]{.fn .nameRole}
:::

::: {.left dir="auto"}
[Futurewei Technologies]{.org}
:::

::: {.left dir="auto"}
[2386 Panoramic Circle]{.street-address}
:::

::: {.left dir="auto"}
[Apopka]{.locality}, [FL]{.region} [32703]{.postal-code}
:::

::: {.left dir="auto"}
[United States of America]{.country-name}
:::

::: tel
Phone: [+1-508-333-2270](tel:+1-508-333-2270){.tel}
:::

::: email
Email: <d3e3e3@gmail.com>
:::
:::
:::
